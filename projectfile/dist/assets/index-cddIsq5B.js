function Cie(r,e){for(var n=0;n<e.length;n++){const i=e[n];if(typeof i!="string"&&!Array.isArray(i)){for(const s in i)if(s!=="default"&&!(s in r)){const o=Object.getOwnPropertyDescriptor(i,s);o&&Object.defineProperty(r,s,o.get?o:{enumerable:!0,get:()=>i[s]})}}}return Object.freeze(Object.defineProperty(r,Symbol.toStringTag,{value:"Module"}))}(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))i(s);new MutationObserver(s=>{for(const o of s)if(o.type==="childList")for(const a of o.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&i(a)}).observe(document,{childList:!0,subtree:!0});function n(s){const o={};return s.integrity&&(o.integrity=s.integrity),s.referrerPolicy&&(o.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?o.credentials="include":s.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function i(s){if(s.ep)return;s.ep=!0;const o=n(s);fetch(s.href,o)}})();var Y_=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function hn(r){return r&&r.__esModule&&Object.prototype.hasOwnProperty.call(r,"default")?r.default:r}function Pie(r){if(r.__esModule)return r;var e=r.default;if(typeof e=="function"){var n=function i(){return this instanceof i?Reflect.construct(e,arguments,this.constructor):e.apply(this,arguments)};n.prototype=e.prototype}else n={};return Object.defineProperty(n,"__esModule",{value:!0}),Object.keys(r).forEach(function(i){var s=Object.getOwnPropertyDescriptor(r,i);Object.defineProperty(n,i,s.get?s:{enumerable:!0,get:function(){return r[i]}})}),n}var QW={exports:{}},dM={},JW={exports:{}},an={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var qb=Symbol.for("react.element"),Rie=Symbol.for("react.portal"),Nie=Symbol.for("react.fragment"),Oie=Symbol.for("react.strict_mode"),Die=Symbol.for("react.profiler"),kie=Symbol.for("react.provider"),Iie=Symbol.for("react.context"),Lie=Symbol.for("react.forward_ref"),Fie=Symbol.for("react.suspense"),Bie=Symbol.for("react.memo"),Uie=Symbol.for("react.lazy"),eU=Symbol.iterator;function zie(r){return r===null||typeof r!="object"?null:(r=eU&&r[eU]||r["@@iterator"],typeof r=="function"?r:null)}var e9={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},t9=Object.assign,n9={};function ny(r,e,n){this.props=r,this.context=e,this.refs=n9,this.updater=n||e9}ny.prototype.isReactComponent={};ny.prototype.setState=function(r,e){if(typeof r!="object"&&typeof r!="function"&&r!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,r,e,"setState")};ny.prototype.forceUpdate=function(r){this.updater.enqueueForceUpdate(this,r,"forceUpdate")};function r9(){}r9.prototype=ny.prototype;function pI(r,e,n){this.props=r,this.context=e,this.refs=n9,this.updater=n||e9}var mI=pI.prototype=new r9;mI.constructor=pI;t9(mI,ny.prototype);mI.isPureReactComponent=!0;var tU=Array.isArray,i9=Object.prototype.hasOwnProperty,gI={current:null},s9={key:!0,ref:!0,__self:!0,__source:!0};function o9(r,e,n){var i,s={},o=null,a=null;if(e!=null)for(i in e.ref!==void 0&&(a=e.ref),e.key!==void 0&&(o=""+e.key),e)i9.call(e,i)&&!s9.hasOwnProperty(i)&&(s[i]=e[i]);var l=arguments.length-2;if(l===1)s.children=n;else if(1<l){for(var c=Array(l),u=0;u<l;u++)c[u]=arguments[u+2];s.children=c}if(r&&r.defaultProps)for(i in l=r.defaultProps,l)s[i]===void 0&&(s[i]=l[i]);return{$$typeof:qb,type:r,key:o,ref:a,props:s,_owner:gI.current}}function $ie(r,e){return{$$typeof:qb,type:r.type,key:e,ref:r.ref,props:r.props,_owner:r._owner}}function yI(r){return typeof r=="object"&&r!==null&&r.$$typeof===qb}function jie(r){var e={"=":"=0",":":"=2"};return"$"+r.replace(/[=:]/g,function(n){return e[n]})}var nU=/\/+/g;function TC(r,e){return typeof r=="object"&&r!==null&&r.key!=null?jie(""+r.key):e.toString(36)}function u1(r,e,n,i,s){var o=typeof r;(o==="undefined"||o==="boolean")&&(r=null);var a=!1;if(r===null)a=!0;else switch(o){case"string":case"number":a=!0;break;case"object":switch(r.$$typeof){case qb:case Rie:a=!0}}if(a)return a=r,s=s(a),r=i===""?"."+TC(a,0):i,tU(s)?(n="",r!=null&&(n=r.replace(nU,"$&/")+"/"),u1(s,e,n,"",function(u){return u})):s!=null&&(yI(s)&&(s=$ie(s,n+(!s.key||a&&a.key===s.key?"":(""+s.key).replace(nU,"$&/")+"/")+r)),e.push(s)),1;if(a=0,i=i===""?".":i+":",tU(r))for(var l=0;l<r.length;l++){o=r[l];var c=i+TC(o,l);a+=u1(o,e,n,c,s)}else if(c=zie(r),typeof c=="function")for(r=c.call(r),l=0;!(o=r.next()).done;)o=o.value,c=i+TC(o,l++),a+=u1(o,e,n,c,s);else if(o==="object")throw e=String(r),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(r).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return a}function Z_(r,e,n){if(r==null)return r;var i=[],s=0;return u1(r,i,"","",function(o){return e.call(n,o,s++)}),i}function Vie(r){if(r._status===-1){var e=r._result;e=e(),e.then(function(n){(r._status===0||r._status===-1)&&(r._status=1,r._result=n)},function(n){(r._status===0||r._status===-1)&&(r._status=2,r._result=n)}),r._status===-1&&(r._status=0,r._result=e)}if(r._status===1)return r._result.default;throw r._result}var Ls={current:null},h1={transition:null},Gie={ReactCurrentDispatcher:Ls,ReactCurrentBatchConfig:h1,ReactCurrentOwner:gI};function a9(){throw Error("act(...) is not supported in production builds of React.")}an.Children={map:Z_,forEach:function(r,e,n){Z_(r,function(){e.apply(this,arguments)},n)},count:function(r){var e=0;return Z_(r,function(){e++}),e},toArray:function(r){return Z_(r,function(e){return e})||[]},only:function(r){if(!yI(r))throw Error("React.Children.only expected to receive a single React element child.");return r}};an.Component=ny;an.Fragment=Nie;an.Profiler=Die;an.PureComponent=pI;an.StrictMode=Oie;an.Suspense=Fie;an.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=Gie;an.act=a9;an.cloneElement=function(r,e,n){if(r==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+r+".");var i=t9({},r.props),s=r.key,o=r.ref,a=r._owner;if(e!=null){if(e.ref!==void 0&&(o=e.ref,a=gI.current),e.key!==void 0&&(s=""+e.key),r.type&&r.type.defaultProps)var l=r.type.defaultProps;for(c in e)i9.call(e,c)&&!s9.hasOwnProperty(c)&&(i[c]=e[c]===void 0&&l!==void 0?l[c]:e[c])}var c=arguments.length-2;if(c===1)i.children=n;else if(1<c){l=Array(c);for(var u=0;u<c;u++)l[u]=arguments[u+2];i.children=l}return{$$typeof:qb,type:r.type,key:s,ref:o,props:i,_owner:a}};an.createContext=function(r){return r={$$typeof:Iie,_currentValue:r,_currentValue2:r,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},r.Provider={$$typeof:kie,_context:r},r.Consumer=r};an.createElement=o9;an.createFactory=function(r){var e=o9.bind(null,r);return e.type=r,e};an.createRef=function(){return{current:null}};an.forwardRef=function(r){return{$$typeof:Lie,render:r}};an.isValidElement=yI;an.lazy=function(r){return{$$typeof:Uie,_payload:{_status:-1,_result:r},_init:Vie}};an.memo=function(r,e){return{$$typeof:Bie,type:r,compare:e===void 0?null:e}};an.startTransition=function(r){var e=h1.transition;h1.transition={};try{r()}finally{h1.transition=e}};an.unstable_act=a9;an.useCallback=function(r,e){return Ls.current.useCallback(r,e)};an.useContext=function(r){return Ls.current.useContext(r)};an.useDebugValue=function(){};an.useDeferredValue=function(r){return Ls.current.useDeferredValue(r)};an.useEffect=function(r,e){return Ls.current.useEffect(r,e)};an.useId=function(){return Ls.current.useId()};an.useImperativeHandle=function(r,e,n){return Ls.current.useImperativeHandle(r,e,n)};an.useInsertionEffect=function(r,e){return Ls.current.useInsertionEffect(r,e)};an.useLayoutEffect=function(r,e){return Ls.current.useLayoutEffect(r,e)};an.useMemo=function(r,e){return Ls.current.useMemo(r,e)};an.useReducer=function(r,e,n){return Ls.current.useReducer(r,e,n)};an.useRef=function(r){return Ls.current.useRef(r)};an.useState=function(r){return Ls.current.useState(r)};an.useSyncExternalStore=function(r,e,n){return Ls.current.useSyncExternalStore(r,e,n)};an.useTransition=function(){return Ls.current.useTransition()};an.version="18.3.1";JW.exports=an;var te=JW.exports;const Z=hn(te),Hie=Cie({__proto__:null,default:Z},[te]);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Wie=te,qie=Symbol.for("react.element"),Xie=Symbol.for("react.fragment"),Kie=Object.prototype.hasOwnProperty,Yie=Wie.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,Zie={key:!0,ref:!0,__self:!0,__source:!0};function l9(r,e,n){var i,s={},o=null,a=null;n!==void 0&&(o=""+n),e.key!==void 0&&(o=""+e.key),e.ref!==void 0&&(a=e.ref);for(i in e)Kie.call(e,i)&&!Zie.hasOwnProperty(i)&&(s[i]=e[i]);if(r&&r.defaultProps)for(i in e=r.defaultProps,e)s[i]===void 0&&(s[i]=e[i]);return{$$typeof:qie,type:r,key:o,ref:a,props:s,_owner:Yie.current}}dM.Fragment=Xie;dM.jsx=l9;dM.jsxs=l9;QW.exports=dM;var N=QW.exports,c9={exports:{}},Bo={},u9={exports:{}},h9={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(r){function e(U,G){var H=U.length;U.push(G);e:for(;0<H;){var Y=H-1>>>1,ee=U[Y];if(0<s(ee,G))U[Y]=G,U[H]=ee,H=Y;else break e}}function n(U){return U.length===0?null:U[0]}function i(U){if(U.length===0)return null;var G=U[0],H=U.pop();if(H!==G){U[0]=H;e:for(var Y=0,ee=U.length,he=ee>>>1;Y<he;){var q=2*(Y+1)-1,J=U[q],se=q+1,oe=U[se];if(0>s(J,H))se<ee&&0>s(oe,J)?(U[Y]=oe,U[se]=H,Y=se):(U[Y]=J,U[q]=H,Y=q);else if(se<ee&&0>s(oe,H))U[Y]=oe,U[se]=H,Y=se;else break e}}return G}function s(U,G){var H=U.sortIndex-G.sortIndex;return H!==0?H:U.id-G.id}if(typeof performance=="object"&&typeof performance.now=="function"){var o=performance;r.unstable_now=function(){return o.now()}}else{var a=Date,l=a.now();r.unstable_now=function(){return a.now()-l}}var c=[],u=[],h=1,f=null,d=3,p=!1,m=!1,g=!1,v=typeof setTimeout=="function"?setTimeout:null,y=typeof clearTimeout=="function"?clearTimeout:null,x=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function b(U){for(var G=n(u);G!==null;){if(G.callback===null)i(u);else if(G.startTime<=U)i(u),G.sortIndex=G.expirationTime,e(c,G);else break;G=n(u)}}function w(U){if(g=!1,b(U),!m)if(n(c)!==null)m=!0,R(_);else{var G=n(u);G!==null&&z(w,G.startTime-U)}}function _(U,G){m=!1,g&&(g=!1,y(E),E=-1),p=!0;var H=d;try{for(b(G),f=n(c);f!==null&&(!(f.expirationTime>G)||U&&!P());){var Y=f.callback;if(typeof Y=="function"){f.callback=null,d=f.priorityLevel;var ee=Y(f.expirationTime<=G);G=r.unstable_now(),typeof ee=="function"?f.callback=ee:f===n(c)&&i(c),b(G)}else i(c);f=n(c)}if(f!==null)var he=!0;else{var q=n(u);q!==null&&z(w,q.startTime-G),he=!1}return he}finally{f=null,d=H,p=!1}}var S=!1,T=null,E=-1,M=5,A=-1;function P(){return!(r.unstable_now()-A<M)}function D(){if(T!==null){var U=r.unstable_now();A=U;var G=!0;try{G=T(!0,U)}finally{G?B():(S=!1,T=null)}}else S=!1}var B;if(typeof x=="function")B=function(){x(D)};else if(typeof MessageChannel<"u"){var C=new MessageChannel,O=C.port2;C.port1.onmessage=D,B=function(){O.postMessage(null)}}else B=function(){v(D,0)};function R(U){T=U,S||(S=!0,B())}function z(U,G){E=v(function(){U(r.unstable_now())},G)}r.unstable_IdlePriority=5,r.unstable_ImmediatePriority=1,r.unstable_LowPriority=4,r.unstable_NormalPriority=3,r.unstable_Profiling=null,r.unstable_UserBlockingPriority=2,r.unstable_cancelCallback=function(U){U.callback=null},r.unstable_continueExecution=function(){m||p||(m=!0,R(_))},r.unstable_forceFrameRate=function(U){0>U||125<U?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):M=0<U?Math.floor(1e3/U):5},r.unstable_getCurrentPriorityLevel=function(){return d},r.unstable_getFirstCallbackNode=function(){return n(c)},r.unstable_next=function(U){switch(d){case 1:case 2:case 3:var G=3;break;default:G=d}var H=d;d=G;try{return U()}finally{d=H}},r.unstable_pauseExecution=function(){},r.unstable_requestPaint=function(){},r.unstable_runWithPriority=function(U,G){switch(U){case 1:case 2:case 3:case 4:case 5:break;default:U=3}var H=d;d=U;try{return G()}finally{d=H}},r.unstable_scheduleCallback=function(U,G,H){var Y=r.unstable_now();switch(typeof H=="object"&&H!==null?(H=H.delay,H=typeof H=="number"&&0<H?Y+H:Y):H=Y,U){case 1:var ee=-1;break;case 2:ee=250;break;case 5:ee=1073741823;break;case 4:ee=1e4;break;default:ee=5e3}return ee=H+ee,U={id:h++,callback:G,priorityLevel:U,startTime:H,expirationTime:ee,sortIndex:-1},H>Y?(U.sortIndex=H,e(u,U),n(c)===null&&U===n(u)&&(g?(y(E),E=-1):g=!0,z(w,H-Y))):(U.sortIndex=ee,e(c,U),m||p||(m=!0,R(_))),U},r.unstable_shouldYield=P,r.unstable_wrapCallback=function(U){var G=d;return function(){var H=d;d=G;try{return U.apply(this,arguments)}finally{d=H}}}})(h9);u9.exports=h9;var Qie=u9.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Jie=te,Io=Qie;function Be(r){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+r,n=1;n<arguments.length;n++)e+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+r+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var f9=new Set,ex={};function Ad(r,e){jm(r,e),jm(r+"Capture",e)}function jm(r,e){for(ex[r]=e,r=0;r<e.length;r++)f9.add(e[r])}var tu=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),p2=Object.prototype.hasOwnProperty,ese=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,rU={},iU={};function tse(r){return p2.call(iU,r)?!0:p2.call(rU,r)?!1:ese.test(r)?iU[r]=!0:(rU[r]=!0,!1)}function nse(r,e,n,i){if(n!==null&&n.type===0)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return i?!1:n!==null?!n.acceptsBooleans:(r=r.toLowerCase().slice(0,5),r!=="data-"&&r!=="aria-");default:return!1}}function rse(r,e,n,i){if(e===null||typeof e>"u"||nse(r,e,n,i))return!0;if(i)return!1;if(n!==null)switch(n.type){case 3:return!e;case 4:return e===!1;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}function Fs(r,e,n,i,s,o,a){this.acceptsBooleans=e===2||e===3||e===4,this.attributeName=i,this.attributeNamespace=s,this.mustUseProperty=n,this.propertyName=r,this.type=e,this.sanitizeURL=o,this.removeEmptyString=a}var $i={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(r){$i[r]=new Fs(r,0,!1,r,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(r){var e=r[0];$i[e]=new Fs(e,1,!1,r[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(r){$i[r]=new Fs(r,2,!1,r.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(r){$i[r]=new Fs(r,2,!1,r,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(r){$i[r]=new Fs(r,3,!1,r.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(r){$i[r]=new Fs(r,3,!0,r,null,!1,!1)});["capture","download"].forEach(function(r){$i[r]=new Fs(r,4,!1,r,null,!1,!1)});["cols","rows","size","span"].forEach(function(r){$i[r]=new Fs(r,6,!1,r,null,!1,!1)});["rowSpan","start"].forEach(function(r){$i[r]=new Fs(r,5,!1,r.toLowerCase(),null,!1,!1)});var vI=/[\-:]([a-z])/g;function xI(r){return r[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(r){var e=r.replace(vI,xI);$i[e]=new Fs(e,1,!1,r,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(r){var e=r.replace(vI,xI);$i[e]=new Fs(e,1,!1,r,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(r){var e=r.replace(vI,xI);$i[e]=new Fs(e,1,!1,r,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(r){$i[r]=new Fs(r,1,!1,r.toLowerCase(),null,!1,!1)});$i.xlinkHref=new Fs("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(r){$i[r]=new Fs(r,1,!1,r.toLowerCase(),null,!0,!0)});function bI(r,e,n,i){var s=$i.hasOwnProperty(e)?$i[e]:null;(s!==null?s.type!==0:i||!(2<e.length)||e[0]!=="o"&&e[0]!=="O"||e[1]!=="n"&&e[1]!=="N")&&(rse(e,n,s,i)&&(n=null),i||s===null?tse(e)&&(n===null?r.removeAttribute(e):r.setAttribute(e,""+n)):s.mustUseProperty?r[s.propertyName]=n===null?s.type===3?!1:"":n:(e=s.attributeName,i=s.attributeNamespace,n===null?r.removeAttribute(e):(s=s.type,n=s===3||s===4&&n===!0?"":""+n,i?r.setAttributeNS(i,e,n):r.setAttribute(e,n))))}var pu=Jie.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,Q_=Symbol.for("react.element"),zp=Symbol.for("react.portal"),$p=Symbol.for("react.fragment"),_I=Symbol.for("react.strict_mode"),m2=Symbol.for("react.profiler"),d9=Symbol.for("react.provider"),p9=Symbol.for("react.context"),wI=Symbol.for("react.forward_ref"),g2=Symbol.for("react.suspense"),y2=Symbol.for("react.suspense_list"),SI=Symbol.for("react.memo"),qu=Symbol.for("react.lazy"),m9=Symbol.for("react.offscreen"),sU=Symbol.iterator;function zy(r){return r===null||typeof r!="object"?null:(r=sU&&r[sU]||r["@@iterator"],typeof r=="function"?r:null)}var vr=Object.assign,EC;function Yv(r){if(EC===void 0)try{throw Error()}catch(n){var e=n.stack.trim().match(/\n( *(at )?)/);EC=e&&e[1]||""}return`
`+EC+r}var MC=!1;function AC(r,e){if(!r||MC)return"";MC=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(e,[])}catch(u){var i=u}Reflect.construct(r,[],e)}else{try{e.call()}catch(u){i=u}r.call(e.prototype)}else{try{throw Error()}catch(u){i=u}r()}}catch(u){if(u&&i&&typeof u.stack=="string"){for(var s=u.stack.split(`
`),o=i.stack.split(`
`),a=s.length-1,l=o.length-1;1<=a&&0<=l&&s[a]!==o[l];)l--;for(;1<=a&&0<=l;a--,l--)if(s[a]!==o[l]){if(a!==1||l!==1)do if(a--,l--,0>l||s[a]!==o[l]){var c=`
`+s[a].replace(" at new "," at ");return r.displayName&&c.includes("<anonymous>")&&(c=c.replace("<anonymous>",r.displayName)),c}while(1<=a&&0<=l);break}}}finally{MC=!1,Error.prepareStackTrace=n}return(r=r?r.displayName||r.name:"")?Yv(r):""}function ise(r){switch(r.tag){case 5:return Yv(r.type);case 16:return Yv("Lazy");case 13:return Yv("Suspense");case 19:return Yv("SuspenseList");case 0:case 2:case 15:return r=AC(r.type,!1),r;case 11:return r=AC(r.type.render,!1),r;case 1:return r=AC(r.type,!0),r;default:return""}}function v2(r){if(r==null)return null;if(typeof r=="function")return r.displayName||r.name||null;if(typeof r=="string")return r;switch(r){case $p:return"Fragment";case zp:return"Portal";case m2:return"Profiler";case _I:return"StrictMode";case g2:return"Suspense";case y2:return"SuspenseList"}if(typeof r=="object")switch(r.$$typeof){case p9:return(r.displayName||"Context")+".Consumer";case d9:return(r._context.displayName||"Context")+".Provider";case wI:var e=r.render;return r=r.displayName,r||(r=e.displayName||e.name||"",r=r!==""?"ForwardRef("+r+")":"ForwardRef"),r;case SI:return e=r.displayName||null,e!==null?e:v2(r.type)||"Memo";case qu:e=r._payload,r=r._init;try{return v2(r(e))}catch{}}return null}function sse(r){var e=r.type;switch(r.tag){case 24:return"Cache";case 9:return(e.displayName||"Context")+".Consumer";case 10:return(e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return r=e.render,r=r.displayName||r.name||"",e.displayName||(r!==""?"ForwardRef("+r+")":"ForwardRef");case 7:return"Fragment";case 5:return e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return v2(e);case 8:return e===_I?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e}return null}function Sh(r){switch(typeof r){case"boolean":case"number":case"string":case"undefined":return r;case"object":return r;default:return""}}function g9(r){var e=r.type;return(r=r.nodeName)&&r.toLowerCase()==="input"&&(e==="checkbox"||e==="radio")}function ose(r){var e=g9(r)?"checked":"value",n=Object.getOwnPropertyDescriptor(r.constructor.prototype,e),i=""+r[e];if(!r.hasOwnProperty(e)&&typeof n<"u"&&typeof n.get=="function"&&typeof n.set=="function"){var s=n.get,o=n.set;return Object.defineProperty(r,e,{configurable:!0,get:function(){return s.call(this)},set:function(a){i=""+a,o.call(this,a)}}),Object.defineProperty(r,e,{enumerable:n.enumerable}),{getValue:function(){return i},setValue:function(a){i=""+a},stopTracking:function(){r._valueTracker=null,delete r[e]}}}}function J_(r){r._valueTracker||(r._valueTracker=ose(r))}function y9(r){if(!r)return!1;var e=r._valueTracker;if(!e)return!0;var n=e.getValue(),i="";return r&&(i=g9(r)?r.checked?"true":"false":r.value),r=i,r!==n?(e.setValue(r),!0):!1}function W1(r){if(r=r||(typeof document<"u"?document:void 0),typeof r>"u")return null;try{return r.activeElement||r.body}catch{return r.body}}function x2(r,e){var n=e.checked;return vr({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:n??r._wrapperState.initialChecked})}function oU(r,e){var n=e.defaultValue==null?"":e.defaultValue,i=e.checked!=null?e.checked:e.defaultChecked;n=Sh(e.value!=null?e.value:n),r._wrapperState={initialChecked:i,initialValue:n,controlled:e.type==="checkbox"||e.type==="radio"?e.checked!=null:e.value!=null}}function v9(r,e){e=e.checked,e!=null&&bI(r,"checked",e,!1)}function b2(r,e){v9(r,e);var n=Sh(e.value),i=e.type;if(n!=null)i==="number"?(n===0&&r.value===""||r.value!=n)&&(r.value=""+n):r.value!==""+n&&(r.value=""+n);else if(i==="submit"||i==="reset"){r.removeAttribute("value");return}e.hasOwnProperty("value")?_2(r,e.type,n):e.hasOwnProperty("defaultValue")&&_2(r,e.type,Sh(e.defaultValue)),e.checked==null&&e.defaultChecked!=null&&(r.defaultChecked=!!e.defaultChecked)}function aU(r,e,n){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var i=e.type;if(!(i!=="submit"&&i!=="reset"||e.value!==void 0&&e.value!==null))return;e=""+r._wrapperState.initialValue,n||e===r.value||(r.value=e),r.defaultValue=e}n=r.name,n!==""&&(r.name=""),r.defaultChecked=!!r._wrapperState.initialChecked,n!==""&&(r.name=n)}function _2(r,e,n){(e!=="number"||W1(r.ownerDocument)!==r)&&(n==null?r.defaultValue=""+r._wrapperState.initialValue:r.defaultValue!==""+n&&(r.defaultValue=""+n))}var Zv=Array.isArray;function xm(r,e,n,i){if(r=r.options,e){e={};for(var s=0;s<n.length;s++)e["$"+n[s]]=!0;for(n=0;n<r.length;n++)s=e.hasOwnProperty("$"+r[n].value),r[n].selected!==s&&(r[n].selected=s),s&&i&&(r[n].defaultSelected=!0)}else{for(n=""+Sh(n),e=null,s=0;s<r.length;s++){if(r[s].value===n){r[s].selected=!0,i&&(r[s].defaultSelected=!0);return}e!==null||r[s].disabled||(e=r[s])}e!==null&&(e.selected=!0)}}function w2(r,e){if(e.dangerouslySetInnerHTML!=null)throw Error(Be(91));return vr({},e,{value:void 0,defaultValue:void 0,children:""+r._wrapperState.initialValue})}function lU(r,e){var n=e.value;if(n==null){if(n=e.children,e=e.defaultValue,n!=null){if(e!=null)throw Error(Be(92));if(Zv(n)){if(1<n.length)throw Error(Be(93));n=n[0]}e=n}e==null&&(e=""),n=e}r._wrapperState={initialValue:Sh(n)}}function x9(r,e){var n=Sh(e.value),i=Sh(e.defaultValue);n!=null&&(n=""+n,n!==r.value&&(r.value=n),e.defaultValue==null&&r.defaultValue!==n&&(r.defaultValue=n)),i!=null&&(r.defaultValue=""+i)}function cU(r){var e=r.textContent;e===r._wrapperState.initialValue&&e!==""&&e!==null&&(r.value=e)}function b9(r){switch(r){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function S2(r,e){return r==null||r==="http://www.w3.org/1999/xhtml"?b9(e):r==="http://www.w3.org/2000/svg"&&e==="foreignObject"?"http://www.w3.org/1999/xhtml":r}var ew,_9=function(r){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(e,n,i,s){MSApp.execUnsafeLocalFunction(function(){return r(e,n,i,s)})}:r}(function(r,e){if(r.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in r)r.innerHTML=e;else{for(ew=ew||document.createElement("div"),ew.innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=ew.firstChild;r.firstChild;)r.removeChild(r.firstChild);for(;e.firstChild;)r.appendChild(e.firstChild)}});function tx(r,e){if(e){var n=r.firstChild;if(n&&n===r.lastChild&&n.nodeType===3){n.nodeValue=e;return}}r.textContent=e}var m0={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},ase=["Webkit","ms","Moz","O"];Object.keys(m0).forEach(function(r){ase.forEach(function(e){e=e+r.charAt(0).toUpperCase()+r.substring(1),m0[e]=m0[r]})});function w9(r,e,n){return e==null||typeof e=="boolean"||e===""?"":n||typeof e!="number"||e===0||m0.hasOwnProperty(r)&&m0[r]?(""+e).trim():e+"px"}function S9(r,e){r=r.style;for(var n in e)if(e.hasOwnProperty(n)){var i=n.indexOf("--")===0,s=w9(n,e[n],i);n==="float"&&(n="cssFloat"),i?r.setProperty(n,s):r[n]=s}}var lse=vr({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function T2(r,e){if(e){if(lse[r]&&(e.children!=null||e.dangerouslySetInnerHTML!=null))throw Error(Be(137,r));if(e.dangerouslySetInnerHTML!=null){if(e.children!=null)throw Error(Be(60));if(typeof e.dangerouslySetInnerHTML!="object"||!("__html"in e.dangerouslySetInnerHTML))throw Error(Be(61))}if(e.style!=null&&typeof e.style!="object")throw Error(Be(62))}}function E2(r,e){if(r.indexOf("-")===-1)return typeof e.is=="string";switch(r){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var M2=null;function TI(r){return r=r.target||r.srcElement||window,r.correspondingUseElement&&(r=r.correspondingUseElement),r.nodeType===3?r.parentNode:r}var A2=null,bm=null,_m=null;function uU(r){if(r=Yb(r)){if(typeof A2!="function")throw Error(Be(280));var e=r.stateNode;e&&(e=vM(e),A2(r.stateNode,r.type,e))}}function T9(r){bm?_m?_m.push(r):_m=[r]:bm=r}function E9(){if(bm){var r=bm,e=_m;if(_m=bm=null,uU(r),e)for(r=0;r<e.length;r++)uU(e[r])}}function M9(r,e){return r(e)}function A9(){}var CC=!1;function C9(r,e,n){if(CC)return r(e,n);CC=!0;try{return M9(r,e,n)}finally{CC=!1,(bm!==null||_m!==null)&&(A9(),E9())}}function nx(r,e){var n=r.stateNode;if(n===null)return null;var i=vM(n);if(i===null)return null;n=i[e];e:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(i=!i.disabled)||(r=r.type,i=!(r==="button"||r==="input"||r==="select"||r==="textarea")),r=!i;break e;default:r=!1}if(r)return null;if(n&&typeof n!="function")throw Error(Be(231,e,typeof n));return n}var C2=!1;if(tu)try{var $y={};Object.defineProperty($y,"passive",{get:function(){C2=!0}}),window.addEventListener("test",$y,$y),window.removeEventListener("test",$y,$y)}catch{C2=!1}function cse(r,e,n,i,s,o,a,l,c){var u=Array.prototype.slice.call(arguments,3);try{e.apply(n,u)}catch(h){this.onError(h)}}var g0=!1,q1=null,X1=!1,P2=null,use={onError:function(r){g0=!0,q1=r}};function hse(r,e,n,i,s,o,a,l,c){g0=!1,q1=null,cse.apply(use,arguments)}function fse(r,e,n,i,s,o,a,l,c){if(hse.apply(this,arguments),g0){if(g0){var u=q1;g0=!1,q1=null}else throw Error(Be(198));X1||(X1=!0,P2=u)}}function Cd(r){var e=r,n=r;if(r.alternate)for(;e.return;)e=e.return;else{r=e;do e=r,e.flags&4098&&(n=e.return),r=e.return;while(r)}return e.tag===3?n:null}function P9(r){if(r.tag===13){var e=r.memoizedState;if(e===null&&(r=r.alternate,r!==null&&(e=r.memoizedState)),e!==null)return e.dehydrated}return null}function hU(r){if(Cd(r)!==r)throw Error(Be(188))}function dse(r){var e=r.alternate;if(!e){if(e=Cd(r),e===null)throw Error(Be(188));return e!==r?null:r}for(var n=r,i=e;;){var s=n.return;if(s===null)break;var o=s.alternate;if(o===null){if(i=s.return,i!==null){n=i;continue}break}if(s.child===o.child){for(o=s.child;o;){if(o===n)return hU(s),r;if(o===i)return hU(s),e;o=o.sibling}throw Error(Be(188))}if(n.return!==i.return)n=s,i=o;else{for(var a=!1,l=s.child;l;){if(l===n){a=!0,n=s,i=o;break}if(l===i){a=!0,i=s,n=o;break}l=l.sibling}if(!a){for(l=o.child;l;){if(l===n){a=!0,n=o,i=s;break}if(l===i){a=!0,i=o,n=s;break}l=l.sibling}if(!a)throw Error(Be(189))}}if(n.alternate!==i)throw Error(Be(190))}if(n.tag!==3)throw Error(Be(188));return n.stateNode.current===n?r:e}function R9(r){return r=dse(r),r!==null?N9(r):null}function N9(r){if(r.tag===5||r.tag===6)return r;for(r=r.child;r!==null;){var e=N9(r);if(e!==null)return e;r=r.sibling}return null}var O9=Io.unstable_scheduleCallback,fU=Io.unstable_cancelCallback,pse=Io.unstable_shouldYield,mse=Io.unstable_requestPaint,Rr=Io.unstable_now,gse=Io.unstable_getCurrentPriorityLevel,EI=Io.unstable_ImmediatePriority,D9=Io.unstable_UserBlockingPriority,K1=Io.unstable_NormalPriority,yse=Io.unstable_LowPriority,k9=Io.unstable_IdlePriority,pM=null,Cl=null;function vse(r){if(Cl&&typeof Cl.onCommitFiberRoot=="function")try{Cl.onCommitFiberRoot(pM,r,void 0,(r.current.flags&128)===128)}catch{}}var Za=Math.clz32?Math.clz32:_se,xse=Math.log,bse=Math.LN2;function _se(r){return r>>>=0,r===0?32:31-(xse(r)/bse|0)|0}var tw=64,nw=4194304;function Qv(r){switch(r&-r){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return r&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return r&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return r}}function Y1(r,e){var n=r.pendingLanes;if(n===0)return 0;var i=0,s=r.suspendedLanes,o=r.pingedLanes,a=n&268435455;if(a!==0){var l=a&~s;l!==0?i=Qv(l):(o&=a,o!==0&&(i=Qv(o)))}else a=n&~s,a!==0?i=Qv(a):o!==0&&(i=Qv(o));if(i===0)return 0;if(e!==0&&e!==i&&!(e&s)&&(s=i&-i,o=e&-e,s>=o||s===16&&(o&4194240)!==0))return e;if(i&4&&(i|=n&16),e=r.entangledLanes,e!==0)for(r=r.entanglements,e&=i;0<e;)n=31-Za(e),s=1<<n,i|=r[n],e&=~s;return i}function wse(r,e){switch(r){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Sse(r,e){for(var n=r.suspendedLanes,i=r.pingedLanes,s=r.expirationTimes,o=r.pendingLanes;0<o;){var a=31-Za(o),l=1<<a,c=s[a];c===-1?(!(l&n)||l&i)&&(s[a]=wse(l,e)):c<=e&&(r.expiredLanes|=l),o&=~l}}function R2(r){return r=r.pendingLanes&-1073741825,r!==0?r:r&1073741824?1073741824:0}function I9(){var r=tw;return tw<<=1,!(tw&4194240)&&(tw=64),r}function PC(r){for(var e=[],n=0;31>n;n++)e.push(r);return e}function Xb(r,e,n){r.pendingLanes|=e,e!==536870912&&(r.suspendedLanes=0,r.pingedLanes=0),r=r.eventTimes,e=31-Za(e),r[e]=n}function Tse(r,e){var n=r.pendingLanes&~e;r.pendingLanes=e,r.suspendedLanes=0,r.pingedLanes=0,r.expiredLanes&=e,r.mutableReadLanes&=e,r.entangledLanes&=e,e=r.entanglements;var i=r.eventTimes;for(r=r.expirationTimes;0<n;){var s=31-Za(n),o=1<<s;e[s]=0,i[s]=-1,r[s]=-1,n&=~o}}function MI(r,e){var n=r.entangledLanes|=e;for(r=r.entanglements;n;){var i=31-Za(n),s=1<<i;s&e|r[i]&e&&(r[i]|=e),n&=~s}}var Mn=0;function L9(r){return r&=-r,1<r?4<r?r&268435455?16:536870912:4:1}var F9,AI,B9,U9,z9,N2=!1,rw=[],lh=null,ch=null,uh=null,rx=new Map,ix=new Map,Zu=[],Ese="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function dU(r,e){switch(r){case"focusin":case"focusout":lh=null;break;case"dragenter":case"dragleave":ch=null;break;case"mouseover":case"mouseout":uh=null;break;case"pointerover":case"pointerout":rx.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":ix.delete(e.pointerId)}}function jy(r,e,n,i,s,o){return r===null||r.nativeEvent!==o?(r={blockedOn:e,domEventName:n,eventSystemFlags:i,nativeEvent:o,targetContainers:[s]},e!==null&&(e=Yb(e),e!==null&&AI(e)),r):(r.eventSystemFlags|=i,e=r.targetContainers,s!==null&&e.indexOf(s)===-1&&e.push(s),r)}function Mse(r,e,n,i,s){switch(e){case"focusin":return lh=jy(lh,r,e,n,i,s),!0;case"dragenter":return ch=jy(ch,r,e,n,i,s),!0;case"mouseover":return uh=jy(uh,r,e,n,i,s),!0;case"pointerover":var o=s.pointerId;return rx.set(o,jy(rx.get(o)||null,r,e,n,i,s)),!0;case"gotpointercapture":return o=s.pointerId,ix.set(o,jy(ix.get(o)||null,r,e,n,i,s)),!0}return!1}function $9(r){var e=Uf(r.target);if(e!==null){var n=Cd(e);if(n!==null){if(e=n.tag,e===13){if(e=P9(n),e!==null){r.blockedOn=e,z9(r.priority,function(){B9(n)});return}}else if(e===3&&n.stateNode.current.memoizedState.isDehydrated){r.blockedOn=n.tag===3?n.stateNode.containerInfo:null;return}}}r.blockedOn=null}function f1(r){if(r.blockedOn!==null)return!1;for(var e=r.targetContainers;0<e.length;){var n=O2(r.domEventName,r.eventSystemFlags,e[0],r.nativeEvent);if(n===null){n=r.nativeEvent;var i=new n.constructor(n.type,n);M2=i,n.target.dispatchEvent(i),M2=null}else return e=Yb(n),e!==null&&AI(e),r.blockedOn=n,!1;e.shift()}return!0}function pU(r,e,n){f1(r)&&n.delete(e)}function Ase(){N2=!1,lh!==null&&f1(lh)&&(lh=null),ch!==null&&f1(ch)&&(ch=null),uh!==null&&f1(uh)&&(uh=null),rx.forEach(pU),ix.forEach(pU)}function Vy(r,e){r.blockedOn===e&&(r.blockedOn=null,N2||(N2=!0,Io.unstable_scheduleCallback(Io.unstable_NormalPriority,Ase)))}function sx(r){function e(s){return Vy(s,r)}if(0<rw.length){Vy(rw[0],r);for(var n=1;n<rw.length;n++){var i=rw[n];i.blockedOn===r&&(i.blockedOn=null)}}for(lh!==null&&Vy(lh,r),ch!==null&&Vy(ch,r),uh!==null&&Vy(uh,r),rx.forEach(e),ix.forEach(e),n=0;n<Zu.length;n++)i=Zu[n],i.blockedOn===r&&(i.blockedOn=null);for(;0<Zu.length&&(n=Zu[0],n.blockedOn===null);)$9(n),n.blockedOn===null&&Zu.shift()}var wm=pu.ReactCurrentBatchConfig,Z1=!0;function Cse(r,e,n,i){var s=Mn,o=wm.transition;wm.transition=null;try{Mn=1,CI(r,e,n,i)}finally{Mn=s,wm.transition=o}}function Pse(r,e,n,i){var s=Mn,o=wm.transition;wm.transition=null;try{Mn=4,CI(r,e,n,i)}finally{Mn=s,wm.transition=o}}function CI(r,e,n,i){if(Z1){var s=O2(r,e,n,i);if(s===null)UC(r,e,i,Q1,n),dU(r,i);else if(Mse(s,r,e,n,i))i.stopPropagation();else if(dU(r,i),e&4&&-1<Ese.indexOf(r)){for(;s!==null;){var o=Yb(s);if(o!==null&&F9(o),o=O2(r,e,n,i),o===null&&UC(r,e,i,Q1,n),o===s)break;s=o}s!==null&&i.stopPropagation()}else UC(r,e,i,null,n)}}var Q1=null;function O2(r,e,n,i){if(Q1=null,r=TI(i),r=Uf(r),r!==null)if(e=Cd(r),e===null)r=null;else if(n=e.tag,n===13){if(r=P9(e),r!==null)return r;r=null}else if(n===3){if(e.stateNode.current.memoizedState.isDehydrated)return e.tag===3?e.stateNode.containerInfo:null;r=null}else e!==r&&(r=null);return Q1=r,null}function j9(r){switch(r){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(gse()){case EI:return 1;case D9:return 4;case K1:case yse:return 16;case k9:return 536870912;default:return 16}default:return 16}}var rh=null,PI=null,d1=null;function V9(){if(d1)return d1;var r,e=PI,n=e.length,i,s="value"in rh?rh.value:rh.textContent,o=s.length;for(r=0;r<n&&e[r]===s[r];r++);var a=n-r;for(i=1;i<=a&&e[n-i]===s[o-i];i++);return d1=s.slice(r,1<i?1-i:void 0)}function p1(r){var e=r.keyCode;return"charCode"in r?(r=r.charCode,r===0&&e===13&&(r=13)):r=e,r===10&&(r=13),32<=r||r===13?r:0}function iw(){return!0}function mU(){return!1}function Uo(r){function e(n,i,s,o,a){this._reactName=n,this._targetInst=s,this.type=i,this.nativeEvent=o,this.target=a,this.currentTarget=null;for(var l in r)r.hasOwnProperty(l)&&(n=r[l],this[l]=n?n(o):o[l]);return this.isDefaultPrevented=(o.defaultPrevented!=null?o.defaultPrevented:o.returnValue===!1)?iw:mU,this.isPropagationStopped=mU,this}return vr(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var n=this.nativeEvent;n&&(n.preventDefault?n.preventDefault():typeof n.returnValue!="unknown"&&(n.returnValue=!1),this.isDefaultPrevented=iw)},stopPropagation:function(){var n=this.nativeEvent;n&&(n.stopPropagation?n.stopPropagation():typeof n.cancelBubble!="unknown"&&(n.cancelBubble=!0),this.isPropagationStopped=iw)},persist:function(){},isPersistent:iw}),e}var ry={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(r){return r.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},RI=Uo(ry),Kb=vr({},ry,{view:0,detail:0}),Rse=Uo(Kb),RC,NC,Gy,mM=vr({},Kb,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:NI,button:0,buttons:0,relatedTarget:function(r){return r.relatedTarget===void 0?r.fromElement===r.srcElement?r.toElement:r.fromElement:r.relatedTarget},movementX:function(r){return"movementX"in r?r.movementX:(r!==Gy&&(Gy&&r.type==="mousemove"?(RC=r.screenX-Gy.screenX,NC=r.screenY-Gy.screenY):NC=RC=0,Gy=r),RC)},movementY:function(r){return"movementY"in r?r.movementY:NC}}),gU=Uo(mM),Nse=vr({},mM,{dataTransfer:0}),Ose=Uo(Nse),Dse=vr({},Kb,{relatedTarget:0}),OC=Uo(Dse),kse=vr({},ry,{animationName:0,elapsedTime:0,pseudoElement:0}),Ise=Uo(kse),Lse=vr({},ry,{clipboardData:function(r){return"clipboardData"in r?r.clipboardData:window.clipboardData}}),Fse=Uo(Lse),Bse=vr({},ry,{data:0}),yU=Uo(Bse),Use={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},zse={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},$se={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function jse(r){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(r):(r=$se[r])?!!e[r]:!1}function NI(){return jse}var Vse=vr({},Kb,{key:function(r){if(r.key){var e=Use[r.key]||r.key;if(e!=="Unidentified")return e}return r.type==="keypress"?(r=p1(r),r===13?"Enter":String.fromCharCode(r)):r.type==="keydown"||r.type==="keyup"?zse[r.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:NI,charCode:function(r){return r.type==="keypress"?p1(r):0},keyCode:function(r){return r.type==="keydown"||r.type==="keyup"?r.keyCode:0},which:function(r){return r.type==="keypress"?p1(r):r.type==="keydown"||r.type==="keyup"?r.keyCode:0}}),Gse=Uo(Vse),Hse=vr({},mM,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),vU=Uo(Hse),Wse=vr({},Kb,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:NI}),qse=Uo(Wse),Xse=vr({},ry,{propertyName:0,elapsedTime:0,pseudoElement:0}),Kse=Uo(Xse),Yse=vr({},mM,{deltaX:function(r){return"deltaX"in r?r.deltaX:"wheelDeltaX"in r?-r.wheelDeltaX:0},deltaY:function(r){return"deltaY"in r?r.deltaY:"wheelDeltaY"in r?-r.wheelDeltaY:"wheelDelta"in r?-r.wheelDelta:0},deltaZ:0,deltaMode:0}),Zse=Uo(Yse),Qse=[9,13,27,32],OI=tu&&"CompositionEvent"in window,y0=null;tu&&"documentMode"in document&&(y0=document.documentMode);var Jse=tu&&"TextEvent"in window&&!y0,G9=tu&&(!OI||y0&&8<y0&&11>=y0),xU=" ",bU=!1;function H9(r,e){switch(r){case"keyup":return Qse.indexOf(e.keyCode)!==-1;case"keydown":return e.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function W9(r){return r=r.detail,typeof r=="object"&&"data"in r?r.data:null}var jp=!1;function eoe(r,e){switch(r){case"compositionend":return W9(e);case"keypress":return e.which!==32?null:(bU=!0,xU);case"textInput":return r=e.data,r===xU&&bU?null:r;default:return null}}function toe(r,e){if(jp)return r==="compositionend"||!OI&&H9(r,e)?(r=V9(),d1=PI=rh=null,jp=!1,r):null;switch(r){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return G9&&e.locale!=="ko"?null:e.data;default:return null}}var noe={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function _U(r){var e=r&&r.nodeName&&r.nodeName.toLowerCase();return e==="input"?!!noe[r.type]:e==="textarea"}function q9(r,e,n,i){T9(i),e=J1(e,"onChange"),0<e.length&&(n=new RI("onChange","change",null,n,i),r.push({event:n,listeners:e}))}var v0=null,ox=null;function roe(r){i7(r,0)}function gM(r){var e=Hp(r);if(y9(e))return r}function ioe(r,e){if(r==="change")return e}var X9=!1;if(tu){var DC;if(tu){var kC="oninput"in document;if(!kC){var wU=document.createElement("div");wU.setAttribute("oninput","return;"),kC=typeof wU.oninput=="function"}DC=kC}else DC=!1;X9=DC&&(!document.documentMode||9<document.documentMode)}function SU(){v0&&(v0.detachEvent("onpropertychange",K9),ox=v0=null)}function K9(r){if(r.propertyName==="value"&&gM(ox)){var e=[];q9(e,ox,r,TI(r)),C9(roe,e)}}function soe(r,e,n){r==="focusin"?(SU(),v0=e,ox=n,v0.attachEvent("onpropertychange",K9)):r==="focusout"&&SU()}function ooe(r){if(r==="selectionchange"||r==="keyup"||r==="keydown")return gM(ox)}function aoe(r,e){if(r==="click")return gM(e)}function loe(r,e){if(r==="input"||r==="change")return gM(e)}function coe(r,e){return r===e&&(r!==0||1/r===1/e)||r!==r&&e!==e}var el=typeof Object.is=="function"?Object.is:coe;function ax(r,e){if(el(r,e))return!0;if(typeof r!="object"||r===null||typeof e!="object"||e===null)return!1;var n=Object.keys(r),i=Object.keys(e);if(n.length!==i.length)return!1;for(i=0;i<n.length;i++){var s=n[i];if(!p2.call(e,s)||!el(r[s],e[s]))return!1}return!0}function TU(r){for(;r&&r.firstChild;)r=r.firstChild;return r}function EU(r,e){var n=TU(r);r=0;for(var i;n;){if(n.nodeType===3){if(i=r+n.textContent.length,r<=e&&i>=e)return{node:n,offset:e-r};r=i}e:{for(;n;){if(n.nextSibling){n=n.nextSibling;break e}n=n.parentNode}n=void 0}n=TU(n)}}function Y9(r,e){return r&&e?r===e?!0:r&&r.nodeType===3?!1:e&&e.nodeType===3?Y9(r,e.parentNode):"contains"in r?r.contains(e):r.compareDocumentPosition?!!(r.compareDocumentPosition(e)&16):!1:!1}function Z9(){for(var r=window,e=W1();e instanceof r.HTMLIFrameElement;){try{var n=typeof e.contentWindow.location.href=="string"}catch{n=!1}if(n)r=e.contentWindow;else break;e=W1(r.document)}return e}function DI(r){var e=r&&r.nodeName&&r.nodeName.toLowerCase();return e&&(e==="input"&&(r.type==="text"||r.type==="search"||r.type==="tel"||r.type==="url"||r.type==="password")||e==="textarea"||r.contentEditable==="true")}function uoe(r){var e=Z9(),n=r.focusedElem,i=r.selectionRange;if(e!==n&&n&&n.ownerDocument&&Y9(n.ownerDocument.documentElement,n)){if(i!==null&&DI(n)){if(e=i.start,r=i.end,r===void 0&&(r=e),"selectionStart"in n)n.selectionStart=e,n.selectionEnd=Math.min(r,n.value.length);else if(r=(e=n.ownerDocument||document)&&e.defaultView||window,r.getSelection){r=r.getSelection();var s=n.textContent.length,o=Math.min(i.start,s);i=i.end===void 0?o:Math.min(i.end,s),!r.extend&&o>i&&(s=i,i=o,o=s),s=EU(n,o);var a=EU(n,i);s&&a&&(r.rangeCount!==1||r.anchorNode!==s.node||r.anchorOffset!==s.offset||r.focusNode!==a.node||r.focusOffset!==a.offset)&&(e=e.createRange(),e.setStart(s.node,s.offset),r.removeAllRanges(),o>i?(r.addRange(e),r.extend(a.node,a.offset)):(e.setEnd(a.node,a.offset),r.addRange(e)))}}for(e=[],r=n;r=r.parentNode;)r.nodeType===1&&e.push({element:r,left:r.scrollLeft,top:r.scrollTop});for(typeof n.focus=="function"&&n.focus(),n=0;n<e.length;n++)r=e[n],r.element.scrollLeft=r.left,r.element.scrollTop=r.top}}var hoe=tu&&"documentMode"in document&&11>=document.documentMode,Vp=null,D2=null,x0=null,k2=!1;function MU(r,e,n){var i=n.window===n?n.document:n.nodeType===9?n:n.ownerDocument;k2||Vp==null||Vp!==W1(i)||(i=Vp,"selectionStart"in i&&DI(i)?i={start:i.selectionStart,end:i.selectionEnd}:(i=(i.ownerDocument&&i.ownerDocument.defaultView||window).getSelection(),i={anchorNode:i.anchorNode,anchorOffset:i.anchorOffset,focusNode:i.focusNode,focusOffset:i.focusOffset}),x0&&ax(x0,i)||(x0=i,i=J1(D2,"onSelect"),0<i.length&&(e=new RI("onSelect","select",null,e,n),r.push({event:e,listeners:i}),e.target=Vp)))}function sw(r,e){var n={};return n[r.toLowerCase()]=e.toLowerCase(),n["Webkit"+r]="webkit"+e,n["Moz"+r]="moz"+e,n}var Gp={animationend:sw("Animation","AnimationEnd"),animationiteration:sw("Animation","AnimationIteration"),animationstart:sw("Animation","AnimationStart"),transitionend:sw("Transition","TransitionEnd")},IC={},Q9={};tu&&(Q9=document.createElement("div").style,"AnimationEvent"in window||(delete Gp.animationend.animation,delete Gp.animationiteration.animation,delete Gp.animationstart.animation),"TransitionEvent"in window||delete Gp.transitionend.transition);function yM(r){if(IC[r])return IC[r];if(!Gp[r])return r;var e=Gp[r],n;for(n in e)if(e.hasOwnProperty(n)&&n in Q9)return IC[r]=e[n];return r}var J9=yM("animationend"),e7=yM("animationiteration"),t7=yM("animationstart"),n7=yM("transitionend"),r7=new Map,AU="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Ih(r,e){r7.set(r,e),Ad(e,[r])}for(var LC=0;LC<AU.length;LC++){var FC=AU[LC],foe=FC.toLowerCase(),doe=FC[0].toUpperCase()+FC.slice(1);Ih(foe,"on"+doe)}Ih(J9,"onAnimationEnd");Ih(e7,"onAnimationIteration");Ih(t7,"onAnimationStart");Ih("dblclick","onDoubleClick");Ih("focusin","onFocus");Ih("focusout","onBlur");Ih(n7,"onTransitionEnd");jm("onMouseEnter",["mouseout","mouseover"]);jm("onMouseLeave",["mouseout","mouseover"]);jm("onPointerEnter",["pointerout","pointerover"]);jm("onPointerLeave",["pointerout","pointerover"]);Ad("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));Ad("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));Ad("onBeforeInput",["compositionend","keypress","textInput","paste"]);Ad("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));Ad("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));Ad("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Jv="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),poe=new Set("cancel close invalid load scroll toggle".split(" ").concat(Jv));function CU(r,e,n){var i=r.type||"unknown-event";r.currentTarget=n,fse(i,e,void 0,r),r.currentTarget=null}function i7(r,e){e=(e&4)!==0;for(var n=0;n<r.length;n++){var i=r[n],s=i.event;i=i.listeners;e:{var o=void 0;if(e)for(var a=i.length-1;0<=a;a--){var l=i[a],c=l.instance,u=l.currentTarget;if(l=l.listener,c!==o&&s.isPropagationStopped())break e;CU(s,l,u),o=c}else for(a=0;a<i.length;a++){if(l=i[a],c=l.instance,u=l.currentTarget,l=l.listener,c!==o&&s.isPropagationStopped())break e;CU(s,l,u),o=c}}}if(X1)throw r=P2,X1=!1,P2=null,r}function Hn(r,e){var n=e[U2];n===void 0&&(n=e[U2]=new Set);var i=r+"__bubble";n.has(i)||(s7(e,r,2,!1),n.add(i))}function BC(r,e,n){var i=0;e&&(i|=4),s7(n,r,i,e)}var ow="_reactListening"+Math.random().toString(36).slice(2);function lx(r){if(!r[ow]){r[ow]=!0,f9.forEach(function(n){n!=="selectionchange"&&(poe.has(n)||BC(n,!1,r),BC(n,!0,r))});var e=r.nodeType===9?r:r.ownerDocument;e===null||e[ow]||(e[ow]=!0,BC("selectionchange",!1,e))}}function s7(r,e,n,i){switch(j9(e)){case 1:var s=Cse;break;case 4:s=Pse;break;default:s=CI}n=s.bind(null,e,n,r),s=void 0,!C2||e!=="touchstart"&&e!=="touchmove"&&e!=="wheel"||(s=!0),i?s!==void 0?r.addEventListener(e,n,{capture:!0,passive:s}):r.addEventListener(e,n,!0):s!==void 0?r.addEventListener(e,n,{passive:s}):r.addEventListener(e,n,!1)}function UC(r,e,n,i,s){var o=i;if(!(e&1)&&!(e&2)&&i!==null)e:for(;;){if(i===null)return;var a=i.tag;if(a===3||a===4){var l=i.stateNode.containerInfo;if(l===s||l.nodeType===8&&l.parentNode===s)break;if(a===4)for(a=i.return;a!==null;){var c=a.tag;if((c===3||c===4)&&(c=a.stateNode.containerInfo,c===s||c.nodeType===8&&c.parentNode===s))return;a=a.return}for(;l!==null;){if(a=Uf(l),a===null)return;if(c=a.tag,c===5||c===6){i=o=a;continue e}l=l.parentNode}}i=i.return}C9(function(){var u=o,h=TI(n),f=[];e:{var d=r7.get(r);if(d!==void 0){var p=RI,m=r;switch(r){case"keypress":if(p1(n)===0)break e;case"keydown":case"keyup":p=Gse;break;case"focusin":m="focus",p=OC;break;case"focusout":m="blur",p=OC;break;case"beforeblur":case"afterblur":p=OC;break;case"click":if(n.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":p=gU;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":p=Ose;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":p=qse;break;case J9:case e7:case t7:p=Ise;break;case n7:p=Kse;break;case"scroll":p=Rse;break;case"wheel":p=Zse;break;case"copy":case"cut":case"paste":p=Fse;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":p=vU}var g=(e&4)!==0,v=!g&&r==="scroll",y=g?d!==null?d+"Capture":null:d;g=[];for(var x=u,b;x!==null;){b=x;var w=b.stateNode;if(b.tag===5&&w!==null&&(b=w,y!==null&&(w=nx(x,y),w!=null&&g.push(cx(x,w,b)))),v)break;x=x.return}0<g.length&&(d=new p(d,m,null,n,h),f.push({event:d,listeners:g}))}}if(!(e&7)){e:{if(d=r==="mouseover"||r==="pointerover",p=r==="mouseout"||r==="pointerout",d&&n!==M2&&(m=n.relatedTarget||n.fromElement)&&(Uf(m)||m[nu]))break e;if((p||d)&&(d=h.window===h?h:(d=h.ownerDocument)?d.defaultView||d.parentWindow:window,p?(m=n.relatedTarget||n.toElement,p=u,m=m?Uf(m):null,m!==null&&(v=Cd(m),m!==v||m.tag!==5&&m.tag!==6)&&(m=null)):(p=null,m=u),p!==m)){if(g=gU,w="onMouseLeave",y="onMouseEnter",x="mouse",(r==="pointerout"||r==="pointerover")&&(g=vU,w="onPointerLeave",y="onPointerEnter",x="pointer"),v=p==null?d:Hp(p),b=m==null?d:Hp(m),d=new g(w,x+"leave",p,n,h),d.target=v,d.relatedTarget=b,w=null,Uf(h)===u&&(g=new g(y,x+"enter",m,n,h),g.target=b,g.relatedTarget=v,w=g),v=w,p&&m)t:{for(g=p,y=m,x=0,b=g;b;b=Vd(b))x++;for(b=0,w=y;w;w=Vd(w))b++;for(;0<x-b;)g=Vd(g),x--;for(;0<b-x;)y=Vd(y),b--;for(;x--;){if(g===y||y!==null&&g===y.alternate)break t;g=Vd(g),y=Vd(y)}g=null}else g=null;p!==null&&PU(f,d,p,g,!1),m!==null&&v!==null&&PU(f,v,m,g,!0)}}e:{if(d=u?Hp(u):window,p=d.nodeName&&d.nodeName.toLowerCase(),p==="select"||p==="input"&&d.type==="file")var _=ioe;else if(_U(d))if(X9)_=loe;else{_=ooe;var S=soe}else(p=d.nodeName)&&p.toLowerCase()==="input"&&(d.type==="checkbox"||d.type==="radio")&&(_=aoe);if(_&&(_=_(r,u))){q9(f,_,n,h);break e}S&&S(r,d,u),r==="focusout"&&(S=d._wrapperState)&&S.controlled&&d.type==="number"&&_2(d,"number",d.value)}switch(S=u?Hp(u):window,r){case"focusin":(_U(S)||S.contentEditable==="true")&&(Vp=S,D2=u,x0=null);break;case"focusout":x0=D2=Vp=null;break;case"mousedown":k2=!0;break;case"contextmenu":case"mouseup":case"dragend":k2=!1,MU(f,n,h);break;case"selectionchange":if(hoe)break;case"keydown":case"keyup":MU(f,n,h)}var T;if(OI)e:{switch(r){case"compositionstart":var E="onCompositionStart";break e;case"compositionend":E="onCompositionEnd";break e;case"compositionupdate":E="onCompositionUpdate";break e}E=void 0}else jp?H9(r,n)&&(E="onCompositionEnd"):r==="keydown"&&n.keyCode===229&&(E="onCompositionStart");E&&(G9&&n.locale!=="ko"&&(jp||E!=="onCompositionStart"?E==="onCompositionEnd"&&jp&&(T=V9()):(rh=h,PI="value"in rh?rh.value:rh.textContent,jp=!0)),S=J1(u,E),0<S.length&&(E=new yU(E,r,null,n,h),f.push({event:E,listeners:S}),T?E.data=T:(T=W9(n),T!==null&&(E.data=T)))),(T=Jse?eoe(r,n):toe(r,n))&&(u=J1(u,"onBeforeInput"),0<u.length&&(h=new yU("onBeforeInput","beforeinput",null,n,h),f.push({event:h,listeners:u}),h.data=T))}i7(f,e)})}function cx(r,e,n){return{instance:r,listener:e,currentTarget:n}}function J1(r,e){for(var n=e+"Capture",i=[];r!==null;){var s=r,o=s.stateNode;s.tag===5&&o!==null&&(s=o,o=nx(r,n),o!=null&&i.unshift(cx(r,o,s)),o=nx(r,e),o!=null&&i.push(cx(r,o,s))),r=r.return}return i}function Vd(r){if(r===null)return null;do r=r.return;while(r&&r.tag!==5);return r||null}function PU(r,e,n,i,s){for(var o=e._reactName,a=[];n!==null&&n!==i;){var l=n,c=l.alternate,u=l.stateNode;if(c!==null&&c===i)break;l.tag===5&&u!==null&&(l=u,s?(c=nx(n,o),c!=null&&a.unshift(cx(n,c,l))):s||(c=nx(n,o),c!=null&&a.push(cx(n,c,l)))),n=n.return}a.length!==0&&r.push({event:e,listeners:a})}var moe=/\r\n?/g,goe=/\u0000|\uFFFD/g;function RU(r){return(typeof r=="string"?r:""+r).replace(moe,`
`).replace(goe,"")}function aw(r,e,n){if(e=RU(e),RU(r)!==e&&n)throw Error(Be(425))}function eT(){}var I2=null,L2=null;function F2(r,e){return r==="textarea"||r==="noscript"||typeof e.children=="string"||typeof e.children=="number"||typeof e.dangerouslySetInnerHTML=="object"&&e.dangerouslySetInnerHTML!==null&&e.dangerouslySetInnerHTML.__html!=null}var B2=typeof setTimeout=="function"?setTimeout:void 0,yoe=typeof clearTimeout=="function"?clearTimeout:void 0,NU=typeof Promise=="function"?Promise:void 0,voe=typeof queueMicrotask=="function"?queueMicrotask:typeof NU<"u"?function(r){return NU.resolve(null).then(r).catch(xoe)}:B2;function xoe(r){setTimeout(function(){throw r})}function zC(r,e){var n=e,i=0;do{var s=n.nextSibling;if(r.removeChild(n),s&&s.nodeType===8)if(n=s.data,n==="/$"){if(i===0){r.removeChild(s),sx(e);return}i--}else n!=="$"&&n!=="$?"&&n!=="$!"||i++;n=s}while(n);sx(e)}function hh(r){for(;r!=null;r=r.nextSibling){var e=r.nodeType;if(e===1||e===3)break;if(e===8){if(e=r.data,e==="$"||e==="$!"||e==="$?")break;if(e==="/$")return null}}return r}function OU(r){r=r.previousSibling;for(var e=0;r;){if(r.nodeType===8){var n=r.data;if(n==="$"||n==="$!"||n==="$?"){if(e===0)return r;e--}else n==="/$"&&e++}r=r.previousSibling}return null}var iy=Math.random().toString(36).slice(2),bl="__reactFiber$"+iy,ux="__reactProps$"+iy,nu="__reactContainer$"+iy,U2="__reactEvents$"+iy,boe="__reactListeners$"+iy,_oe="__reactHandles$"+iy;function Uf(r){var e=r[bl];if(e)return e;for(var n=r.parentNode;n;){if(e=n[nu]||n[bl]){if(n=e.alternate,e.child!==null||n!==null&&n.child!==null)for(r=OU(r);r!==null;){if(n=r[bl])return n;r=OU(r)}return e}r=n,n=r.parentNode}return null}function Yb(r){return r=r[bl]||r[nu],!r||r.tag!==5&&r.tag!==6&&r.tag!==13&&r.tag!==3?null:r}function Hp(r){if(r.tag===5||r.tag===6)return r.stateNode;throw Error(Be(33))}function vM(r){return r[ux]||null}var z2=[],Wp=-1;function Lh(r){return{current:r}}function er(r){0>Wp||(r.current=z2[Wp],z2[Wp]=null,Wp--)}function $n(r,e){Wp++,z2[Wp]=r.current,r.current=e}var Th={},ls=Lh(Th),Js=Lh(!1),od=Th;function Vm(r,e){var n=r.type.contextTypes;if(!n)return Th;var i=r.stateNode;if(i&&i.__reactInternalMemoizedUnmaskedChildContext===e)return i.__reactInternalMemoizedMaskedChildContext;var s={},o;for(o in n)s[o]=e[o];return i&&(r=r.stateNode,r.__reactInternalMemoizedUnmaskedChildContext=e,r.__reactInternalMemoizedMaskedChildContext=s),s}function eo(r){return r=r.childContextTypes,r!=null}function tT(){er(Js),er(ls)}function DU(r,e,n){if(ls.current!==Th)throw Error(Be(168));$n(ls,e),$n(Js,n)}function o7(r,e,n){var i=r.stateNode;if(e=e.childContextTypes,typeof i.getChildContext!="function")return n;i=i.getChildContext();for(var s in i)if(!(s in e))throw Error(Be(108,sse(r)||"Unknown",s));return vr({},n,i)}function nT(r){return r=(r=r.stateNode)&&r.__reactInternalMemoizedMergedChildContext||Th,od=ls.current,$n(ls,r),$n(Js,Js.current),!0}function kU(r,e,n){var i=r.stateNode;if(!i)throw Error(Be(169));n?(r=o7(r,e,od),i.__reactInternalMemoizedMergedChildContext=r,er(Js),er(ls),$n(ls,r)):er(Js),$n(Js,n)}var _c=null,xM=!1,$C=!1;function a7(r){_c===null?_c=[r]:_c.push(r)}function woe(r){xM=!0,a7(r)}function Fh(){if(!$C&&_c!==null){$C=!0;var r=0,e=Mn;try{var n=_c;for(Mn=1;r<n.length;r++){var i=n[r];do i=i(!0);while(i!==null)}_c=null,xM=!1}catch(s){throw _c!==null&&(_c=_c.slice(r+1)),O9(EI,Fh),s}finally{Mn=e,$C=!1}}return null}var qp=[],Xp=0,rT=null,iT=0,Zo=[],Qo=0,ad=null,Rc=1,Nc="";function bf(r,e){qp[Xp++]=iT,qp[Xp++]=rT,rT=r,iT=e}function l7(r,e,n){Zo[Qo++]=Rc,Zo[Qo++]=Nc,Zo[Qo++]=ad,ad=r;var i=Rc;r=Nc;var s=32-Za(i)-1;i&=~(1<<s),n+=1;var o=32-Za(e)+s;if(30<o){var a=s-s%5;o=(i&(1<<a)-1).toString(32),i>>=a,s-=a,Rc=1<<32-Za(e)+s|n<<s|i,Nc=o+r}else Rc=1<<o|n<<s|i,Nc=r}function kI(r){r.return!==null&&(bf(r,1),l7(r,1,0))}function II(r){for(;r===rT;)rT=qp[--Xp],qp[Xp]=null,iT=qp[--Xp],qp[Xp]=null;for(;r===ad;)ad=Zo[--Qo],Zo[Qo]=null,Nc=Zo[--Qo],Zo[Qo]=null,Rc=Zo[--Qo],Zo[Qo]=null}var Co=null,Ao=null,sr=!1,za=null;function c7(r,e){var n=ia(5,null,null,0);n.elementType="DELETED",n.stateNode=e,n.return=r,e=r.deletions,e===null?(r.deletions=[n],r.flags|=16):e.push(n)}function IU(r,e){switch(r.tag){case 5:var n=r.type;return e=e.nodeType!==1||n.toLowerCase()!==e.nodeName.toLowerCase()?null:e,e!==null?(r.stateNode=e,Co=r,Ao=hh(e.firstChild),!0):!1;case 6:return e=r.pendingProps===""||e.nodeType!==3?null:e,e!==null?(r.stateNode=e,Co=r,Ao=null,!0):!1;case 13:return e=e.nodeType!==8?null:e,e!==null?(n=ad!==null?{id:Rc,overflow:Nc}:null,r.memoizedState={dehydrated:e,treeContext:n,retryLane:1073741824},n=ia(18,null,null,0),n.stateNode=e,n.return=r,r.child=n,Co=r,Ao=null,!0):!1;default:return!1}}function $2(r){return(r.mode&1)!==0&&(r.flags&128)===0}function j2(r){if(sr){var e=Ao;if(e){var n=e;if(!IU(r,e)){if($2(r))throw Error(Be(418));e=hh(n.nextSibling);var i=Co;e&&IU(r,e)?c7(i,n):(r.flags=r.flags&-4097|2,sr=!1,Co=r)}}else{if($2(r))throw Error(Be(418));r.flags=r.flags&-4097|2,sr=!1,Co=r}}}function LU(r){for(r=r.return;r!==null&&r.tag!==5&&r.tag!==3&&r.tag!==13;)r=r.return;Co=r}function lw(r){if(r!==Co)return!1;if(!sr)return LU(r),sr=!0,!1;var e;if((e=r.tag!==3)&&!(e=r.tag!==5)&&(e=r.type,e=e!=="head"&&e!=="body"&&!F2(r.type,r.memoizedProps)),e&&(e=Ao)){if($2(r))throw u7(),Error(Be(418));for(;e;)c7(r,e),e=hh(e.nextSibling)}if(LU(r),r.tag===13){if(r=r.memoizedState,r=r!==null?r.dehydrated:null,!r)throw Error(Be(317));e:{for(r=r.nextSibling,e=0;r;){if(r.nodeType===8){var n=r.data;if(n==="/$"){if(e===0){Ao=hh(r.nextSibling);break e}e--}else n!=="$"&&n!=="$!"&&n!=="$?"||e++}r=r.nextSibling}Ao=null}}else Ao=Co?hh(r.stateNode.nextSibling):null;return!0}function u7(){for(var r=Ao;r;)r=hh(r.nextSibling)}function Gm(){Ao=Co=null,sr=!1}function LI(r){za===null?za=[r]:za.push(r)}var Soe=pu.ReactCurrentBatchConfig;function Hy(r,e,n){if(r=n.ref,r!==null&&typeof r!="function"&&typeof r!="object"){if(n._owner){if(n=n._owner,n){if(n.tag!==1)throw Error(Be(309));var i=n.stateNode}if(!i)throw Error(Be(147,r));var s=i,o=""+r;return e!==null&&e.ref!==null&&typeof e.ref=="function"&&e.ref._stringRef===o?e.ref:(e=function(a){var l=s.refs;a===null?delete l[o]:l[o]=a},e._stringRef=o,e)}if(typeof r!="string")throw Error(Be(284));if(!n._owner)throw Error(Be(290,r))}return r}function cw(r,e){throw r=Object.prototype.toString.call(e),Error(Be(31,r==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":r))}function FU(r){var e=r._init;return e(r._payload)}function h7(r){function e(y,x){if(r){var b=y.deletions;b===null?(y.deletions=[x],y.flags|=16):b.push(x)}}function n(y,x){if(!r)return null;for(;x!==null;)e(y,x),x=x.sibling;return null}function i(y,x){for(y=new Map;x!==null;)x.key!==null?y.set(x.key,x):y.set(x.index,x),x=x.sibling;return y}function s(y,x){return y=mh(y,x),y.index=0,y.sibling=null,y}function o(y,x,b){return y.index=b,r?(b=y.alternate,b!==null?(b=b.index,b<x?(y.flags|=2,x):b):(y.flags|=2,x)):(y.flags|=1048576,x)}function a(y){return r&&y.alternate===null&&(y.flags|=2),y}function l(y,x,b,w){return x===null||x.tag!==6?(x=XC(b,y.mode,w),x.return=y,x):(x=s(x,b),x.return=y,x)}function c(y,x,b,w){var _=b.type;return _===$p?h(y,x,b.props.children,w,b.key):x!==null&&(x.elementType===_||typeof _=="object"&&_!==null&&_.$$typeof===qu&&FU(_)===x.type)?(w=s(x,b.props),w.ref=Hy(y,x,b),w.return=y,w):(w=_1(b.type,b.key,b.props,null,y.mode,w),w.ref=Hy(y,x,b),w.return=y,w)}function u(y,x,b,w){return x===null||x.tag!==4||x.stateNode.containerInfo!==b.containerInfo||x.stateNode.implementation!==b.implementation?(x=KC(b,y.mode,w),x.return=y,x):(x=s(x,b.children||[]),x.return=y,x)}function h(y,x,b,w,_){return x===null||x.tag!==7?(x=Yf(b,y.mode,w,_),x.return=y,x):(x=s(x,b),x.return=y,x)}function f(y,x,b){if(typeof x=="string"&&x!==""||typeof x=="number")return x=XC(""+x,y.mode,b),x.return=y,x;if(typeof x=="object"&&x!==null){switch(x.$$typeof){case Q_:return b=_1(x.type,x.key,x.props,null,y.mode,b),b.ref=Hy(y,null,x),b.return=y,b;case zp:return x=KC(x,y.mode,b),x.return=y,x;case qu:var w=x._init;return f(y,w(x._payload),b)}if(Zv(x)||zy(x))return x=Yf(x,y.mode,b,null),x.return=y,x;cw(y,x)}return null}function d(y,x,b,w){var _=x!==null?x.key:null;if(typeof b=="string"&&b!==""||typeof b=="number")return _!==null?null:l(y,x,""+b,w);if(typeof b=="object"&&b!==null){switch(b.$$typeof){case Q_:return b.key===_?c(y,x,b,w):null;case zp:return b.key===_?u(y,x,b,w):null;case qu:return _=b._init,d(y,x,_(b._payload),w)}if(Zv(b)||zy(b))return _!==null?null:h(y,x,b,w,null);cw(y,b)}return null}function p(y,x,b,w,_){if(typeof w=="string"&&w!==""||typeof w=="number")return y=y.get(b)||null,l(x,y,""+w,_);if(typeof w=="object"&&w!==null){switch(w.$$typeof){case Q_:return y=y.get(w.key===null?b:w.key)||null,c(x,y,w,_);case zp:return y=y.get(w.key===null?b:w.key)||null,u(x,y,w,_);case qu:var S=w._init;return p(y,x,b,S(w._payload),_)}if(Zv(w)||zy(w))return y=y.get(b)||null,h(x,y,w,_,null);cw(x,w)}return null}function m(y,x,b,w){for(var _=null,S=null,T=x,E=x=0,M=null;T!==null&&E<b.length;E++){T.index>E?(M=T,T=null):M=T.sibling;var A=d(y,T,b[E],w);if(A===null){T===null&&(T=M);break}r&&T&&A.alternate===null&&e(y,T),x=o(A,x,E),S===null?_=A:S.sibling=A,S=A,T=M}if(E===b.length)return n(y,T),sr&&bf(y,E),_;if(T===null){for(;E<b.length;E++)T=f(y,b[E],w),T!==null&&(x=o(T,x,E),S===null?_=T:S.sibling=T,S=T);return sr&&bf(y,E),_}for(T=i(y,T);E<b.length;E++)M=p(T,y,E,b[E],w),M!==null&&(r&&M.alternate!==null&&T.delete(M.key===null?E:M.key),x=o(M,x,E),S===null?_=M:S.sibling=M,S=M);return r&&T.forEach(function(P){return e(y,P)}),sr&&bf(y,E),_}function g(y,x,b,w){var _=zy(b);if(typeof _!="function")throw Error(Be(150));if(b=_.call(b),b==null)throw Error(Be(151));for(var S=_=null,T=x,E=x=0,M=null,A=b.next();T!==null&&!A.done;E++,A=b.next()){T.index>E?(M=T,T=null):M=T.sibling;var P=d(y,T,A.value,w);if(P===null){T===null&&(T=M);break}r&&T&&P.alternate===null&&e(y,T),x=o(P,x,E),S===null?_=P:S.sibling=P,S=P,T=M}if(A.done)return n(y,T),sr&&bf(y,E),_;if(T===null){for(;!A.done;E++,A=b.next())A=f(y,A.value,w),A!==null&&(x=o(A,x,E),S===null?_=A:S.sibling=A,S=A);return sr&&bf(y,E),_}for(T=i(y,T);!A.done;E++,A=b.next())A=p(T,y,E,A.value,w),A!==null&&(r&&A.alternate!==null&&T.delete(A.key===null?E:A.key),x=o(A,x,E),S===null?_=A:S.sibling=A,S=A);return r&&T.forEach(function(D){return e(y,D)}),sr&&bf(y,E),_}function v(y,x,b,w){if(typeof b=="object"&&b!==null&&b.type===$p&&b.key===null&&(b=b.props.children),typeof b=="object"&&b!==null){switch(b.$$typeof){case Q_:e:{for(var _=b.key,S=x;S!==null;){if(S.key===_){if(_=b.type,_===$p){if(S.tag===7){n(y,S.sibling),x=s(S,b.props.children),x.return=y,y=x;break e}}else if(S.elementType===_||typeof _=="object"&&_!==null&&_.$$typeof===qu&&FU(_)===S.type){n(y,S.sibling),x=s(S,b.props),x.ref=Hy(y,S,b),x.return=y,y=x;break e}n(y,S);break}else e(y,S);S=S.sibling}b.type===$p?(x=Yf(b.props.children,y.mode,w,b.key),x.return=y,y=x):(w=_1(b.type,b.key,b.props,null,y.mode,w),w.ref=Hy(y,x,b),w.return=y,y=w)}return a(y);case zp:e:{for(S=b.key;x!==null;){if(x.key===S)if(x.tag===4&&x.stateNode.containerInfo===b.containerInfo&&x.stateNode.implementation===b.implementation){n(y,x.sibling),x=s(x,b.children||[]),x.return=y,y=x;break e}else{n(y,x);break}else e(y,x);x=x.sibling}x=KC(b,y.mode,w),x.return=y,y=x}return a(y);case qu:return S=b._init,v(y,x,S(b._payload),w)}if(Zv(b))return m(y,x,b,w);if(zy(b))return g(y,x,b,w);cw(y,b)}return typeof b=="string"&&b!==""||typeof b=="number"?(b=""+b,x!==null&&x.tag===6?(n(y,x.sibling),x=s(x,b),x.return=y,y=x):(n(y,x),x=XC(b,y.mode,w),x.return=y,y=x),a(y)):n(y,x)}return v}var Hm=h7(!0),f7=h7(!1),sT=Lh(null),oT=null,Kp=null,FI=null;function BI(){FI=Kp=oT=null}function UI(r){var e=sT.current;er(sT),r._currentValue=e}function V2(r,e,n){for(;r!==null;){var i=r.alternate;if((r.childLanes&e)!==e?(r.childLanes|=e,i!==null&&(i.childLanes|=e)):i!==null&&(i.childLanes&e)!==e&&(i.childLanes|=e),r===n)break;r=r.return}}function Sm(r,e){oT=r,FI=Kp=null,r=r.dependencies,r!==null&&r.firstContext!==null&&(r.lanes&e&&(Xs=!0),r.firstContext=null)}function ha(r){var e=r._currentValue;if(FI!==r)if(r={context:r,memoizedValue:e,next:null},Kp===null){if(oT===null)throw Error(Be(308));Kp=r,oT.dependencies={lanes:0,firstContext:r}}else Kp=Kp.next=r;return e}var zf=null;function zI(r){zf===null?zf=[r]:zf.push(r)}function d7(r,e,n,i){var s=e.interleaved;return s===null?(n.next=n,zI(e)):(n.next=s.next,s.next=n),e.interleaved=n,ru(r,i)}function ru(r,e){r.lanes|=e;var n=r.alternate;for(n!==null&&(n.lanes|=e),n=r,r=r.return;r!==null;)r.childLanes|=e,n=r.alternate,n!==null&&(n.childLanes|=e),n=r,r=r.return;return n.tag===3?n.stateNode:null}var Xu=!1;function $I(r){r.updateQueue={baseState:r.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function p7(r,e){r=r.updateQueue,e.updateQueue===r&&(e.updateQueue={baseState:r.baseState,firstBaseUpdate:r.firstBaseUpdate,lastBaseUpdate:r.lastBaseUpdate,shared:r.shared,effects:r.effects})}function $c(r,e){return{eventTime:r,lane:e,tag:0,payload:null,callback:null,next:null}}function fh(r,e,n){var i=r.updateQueue;if(i===null)return null;if(i=i.shared,un&2){var s=i.pending;return s===null?e.next=e:(e.next=s.next,s.next=e),i.pending=e,ru(r,n)}return s=i.interleaved,s===null?(e.next=e,zI(i)):(e.next=s.next,s.next=e),i.interleaved=e,ru(r,n)}function m1(r,e,n){if(e=e.updateQueue,e!==null&&(e=e.shared,(n&4194240)!==0)){var i=e.lanes;i&=r.pendingLanes,n|=i,e.lanes=n,MI(r,n)}}function BU(r,e){var n=r.updateQueue,i=r.alternate;if(i!==null&&(i=i.updateQueue,n===i)){var s=null,o=null;if(n=n.firstBaseUpdate,n!==null){do{var a={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};o===null?s=o=a:o=o.next=a,n=n.next}while(n!==null);o===null?s=o=e:o=o.next=e}else s=o=e;n={baseState:i.baseState,firstBaseUpdate:s,lastBaseUpdate:o,shared:i.shared,effects:i.effects},r.updateQueue=n;return}r=n.lastBaseUpdate,r===null?n.firstBaseUpdate=e:r.next=e,n.lastBaseUpdate=e}function aT(r,e,n,i){var s=r.updateQueue;Xu=!1;var o=s.firstBaseUpdate,a=s.lastBaseUpdate,l=s.shared.pending;if(l!==null){s.shared.pending=null;var c=l,u=c.next;c.next=null,a===null?o=u:a.next=u,a=c;var h=r.alternate;h!==null&&(h=h.updateQueue,l=h.lastBaseUpdate,l!==a&&(l===null?h.firstBaseUpdate=u:l.next=u,h.lastBaseUpdate=c))}if(o!==null){var f=s.baseState;a=0,h=u=c=null,l=o;do{var d=l.lane,p=l.eventTime;if((i&d)===d){h!==null&&(h=h.next={eventTime:p,lane:0,tag:l.tag,payload:l.payload,callback:l.callback,next:null});e:{var m=r,g=l;switch(d=e,p=n,g.tag){case 1:if(m=g.payload,typeof m=="function"){f=m.call(p,f,d);break e}f=m;break e;case 3:m.flags=m.flags&-65537|128;case 0:if(m=g.payload,d=typeof m=="function"?m.call(p,f,d):m,d==null)break e;f=vr({},f,d);break e;case 2:Xu=!0}}l.callback!==null&&l.lane!==0&&(r.flags|=64,d=s.effects,d===null?s.effects=[l]:d.push(l))}else p={eventTime:p,lane:d,tag:l.tag,payload:l.payload,callback:l.callback,next:null},h===null?(u=h=p,c=f):h=h.next=p,a|=d;if(l=l.next,l===null){if(l=s.shared.pending,l===null)break;d=l,l=d.next,d.next=null,s.lastBaseUpdate=d,s.shared.pending=null}}while(!0);if(h===null&&(c=f),s.baseState=c,s.firstBaseUpdate=u,s.lastBaseUpdate=h,e=s.shared.interleaved,e!==null){s=e;do a|=s.lane,s=s.next;while(s!==e)}else o===null&&(s.shared.lanes=0);cd|=a,r.lanes=a,r.memoizedState=f}}function UU(r,e,n){if(r=e.effects,e.effects=null,r!==null)for(e=0;e<r.length;e++){var i=r[e],s=i.callback;if(s!==null){if(i.callback=null,i=n,typeof s!="function")throw Error(Be(191,s));s.call(i)}}}var Zb={},Pl=Lh(Zb),hx=Lh(Zb),fx=Lh(Zb);function $f(r){if(r===Zb)throw Error(Be(174));return r}function jI(r,e){switch($n(fx,e),$n(hx,r),$n(Pl,Zb),r=e.nodeType,r){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:S2(null,"");break;default:r=r===8?e.parentNode:e,e=r.namespaceURI||null,r=r.tagName,e=S2(e,r)}er(Pl),$n(Pl,e)}function Wm(){er(Pl),er(hx),er(fx)}function m7(r){$f(fx.current);var e=$f(Pl.current),n=S2(e,r.type);e!==n&&($n(hx,r),$n(Pl,n))}function VI(r){hx.current===r&&(er(Pl),er(hx))}var fr=Lh(0);function lT(r){for(var e=r;e!==null;){if(e.tag===13){var n=e.memoizedState;if(n!==null&&(n=n.dehydrated,n===null||n.data==="$?"||n.data==="$!"))return e}else if(e.tag===19&&e.memoizedProps.revealOrder!==void 0){if(e.flags&128)return e}else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===r)break;for(;e.sibling===null;){if(e.return===null||e.return===r)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var jC=[];function GI(){for(var r=0;r<jC.length;r++)jC[r]._workInProgressVersionPrimary=null;jC.length=0}var g1=pu.ReactCurrentDispatcher,VC=pu.ReactCurrentBatchConfig,ld=0,yr=null,oi=null,_i=null,cT=!1,b0=!1,dx=0,Toe=0;function Hi(){throw Error(Be(321))}function HI(r,e){if(e===null)return!1;for(var n=0;n<e.length&&n<r.length;n++)if(!el(r[n],e[n]))return!1;return!0}function WI(r,e,n,i,s,o){if(ld=o,yr=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,g1.current=r===null||r.memoizedState===null?Coe:Poe,r=n(i,s),b0){o=0;do{if(b0=!1,dx=0,25<=o)throw Error(Be(301));o+=1,_i=oi=null,e.updateQueue=null,g1.current=Roe,r=n(i,s)}while(b0)}if(g1.current=uT,e=oi!==null&&oi.next!==null,ld=0,_i=oi=yr=null,cT=!1,e)throw Error(Be(300));return r}function qI(){var r=dx!==0;return dx=0,r}function ml(){var r={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return _i===null?yr.memoizedState=_i=r:_i=_i.next=r,_i}function fa(){if(oi===null){var r=yr.alternate;r=r!==null?r.memoizedState:null}else r=oi.next;var e=_i===null?yr.memoizedState:_i.next;if(e!==null)_i=e,oi=r;else{if(r===null)throw Error(Be(310));oi=r,r={memoizedState:oi.memoizedState,baseState:oi.baseState,baseQueue:oi.baseQueue,queue:oi.queue,next:null},_i===null?yr.memoizedState=_i=r:_i=_i.next=r}return _i}function px(r,e){return typeof e=="function"?e(r):e}function GC(r){var e=fa(),n=e.queue;if(n===null)throw Error(Be(311));n.lastRenderedReducer=r;var i=oi,s=i.baseQueue,o=n.pending;if(o!==null){if(s!==null){var a=s.next;s.next=o.next,o.next=a}i.baseQueue=s=o,n.pending=null}if(s!==null){o=s.next,i=i.baseState;var l=a=null,c=null,u=o;do{var h=u.lane;if((ld&h)===h)c!==null&&(c=c.next={lane:0,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null}),i=u.hasEagerState?u.eagerState:r(i,u.action);else{var f={lane:h,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null};c===null?(l=c=f,a=i):c=c.next=f,yr.lanes|=h,cd|=h}u=u.next}while(u!==null&&u!==o);c===null?a=i:c.next=l,el(i,e.memoizedState)||(Xs=!0),e.memoizedState=i,e.baseState=a,e.baseQueue=c,n.lastRenderedState=i}if(r=n.interleaved,r!==null){s=r;do o=s.lane,yr.lanes|=o,cd|=o,s=s.next;while(s!==r)}else s===null&&(n.lanes=0);return[e.memoizedState,n.dispatch]}function HC(r){var e=fa(),n=e.queue;if(n===null)throw Error(Be(311));n.lastRenderedReducer=r;var i=n.dispatch,s=n.pending,o=e.memoizedState;if(s!==null){n.pending=null;var a=s=s.next;do o=r(o,a.action),a=a.next;while(a!==s);el(o,e.memoizedState)||(Xs=!0),e.memoizedState=o,e.baseQueue===null&&(e.baseState=o),n.lastRenderedState=o}return[o,i]}function g7(){}function y7(r,e){var n=yr,i=fa(),s=e(),o=!el(i.memoizedState,s);if(o&&(i.memoizedState=s,Xs=!0),i=i.queue,XI(b7.bind(null,n,i,r),[r]),i.getSnapshot!==e||o||_i!==null&&_i.memoizedState.tag&1){if(n.flags|=2048,mx(9,x7.bind(null,n,i,s,e),void 0,null),Mi===null)throw Error(Be(349));ld&30||v7(n,e,s)}return s}function v7(r,e,n){r.flags|=16384,r={getSnapshot:e,value:n},e=yr.updateQueue,e===null?(e={lastEffect:null,stores:null},yr.updateQueue=e,e.stores=[r]):(n=e.stores,n===null?e.stores=[r]:n.push(r))}function x7(r,e,n,i){e.value=n,e.getSnapshot=i,_7(e)&&w7(r)}function b7(r,e,n){return n(function(){_7(e)&&w7(r)})}function _7(r){var e=r.getSnapshot;r=r.value;try{var n=e();return!el(r,n)}catch{return!0}}function w7(r){var e=ru(r,1);e!==null&&Qa(e,r,1,-1)}function zU(r){var e=ml();return typeof r=="function"&&(r=r()),e.memoizedState=e.baseState=r,r={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:px,lastRenderedState:r},e.queue=r,r=r.dispatch=Aoe.bind(null,yr,r),[e.memoizedState,r]}function mx(r,e,n,i){return r={tag:r,create:e,destroy:n,deps:i,next:null},e=yr.updateQueue,e===null?(e={lastEffect:null,stores:null},yr.updateQueue=e,e.lastEffect=r.next=r):(n=e.lastEffect,n===null?e.lastEffect=r.next=r:(i=n.next,n.next=r,r.next=i,e.lastEffect=r)),r}function S7(){return fa().memoizedState}function y1(r,e,n,i){var s=ml();yr.flags|=r,s.memoizedState=mx(1|e,n,void 0,i===void 0?null:i)}function bM(r,e,n,i){var s=fa();i=i===void 0?null:i;var o=void 0;if(oi!==null){var a=oi.memoizedState;if(o=a.destroy,i!==null&&HI(i,a.deps)){s.memoizedState=mx(e,n,o,i);return}}yr.flags|=r,s.memoizedState=mx(1|e,n,o,i)}function $U(r,e){return y1(8390656,8,r,e)}function XI(r,e){return bM(2048,8,r,e)}function T7(r,e){return bM(4,2,r,e)}function E7(r,e){return bM(4,4,r,e)}function M7(r,e){if(typeof e=="function")return r=r(),e(r),function(){e(null)};if(e!=null)return r=r(),e.current=r,function(){e.current=null}}function A7(r,e,n){return n=n!=null?n.concat([r]):null,bM(4,4,M7.bind(null,e,r),n)}function KI(){}function C7(r,e){var n=fa();e=e===void 0?null:e;var i=n.memoizedState;return i!==null&&e!==null&&HI(e,i[1])?i[0]:(n.memoizedState=[r,e],r)}function P7(r,e){var n=fa();e=e===void 0?null:e;var i=n.memoizedState;return i!==null&&e!==null&&HI(e,i[1])?i[0]:(r=r(),n.memoizedState=[r,e],r)}function R7(r,e,n){return ld&21?(el(n,e)||(n=I9(),yr.lanes|=n,cd|=n,r.baseState=!0),e):(r.baseState&&(r.baseState=!1,Xs=!0),r.memoizedState=n)}function Eoe(r,e){var n=Mn;Mn=n!==0&&4>n?n:4,r(!0);var i=VC.transition;VC.transition={};try{r(!1),e()}finally{Mn=n,VC.transition=i}}function N7(){return fa().memoizedState}function Moe(r,e,n){var i=ph(r);if(n={lane:i,action:n,hasEagerState:!1,eagerState:null,next:null},O7(r))D7(e,n);else if(n=d7(r,e,n,i),n!==null){var s=Os();Qa(n,r,i,s),k7(n,e,i)}}function Aoe(r,e,n){var i=ph(r),s={lane:i,action:n,hasEagerState:!1,eagerState:null,next:null};if(O7(r))D7(e,s);else{var o=r.alternate;if(r.lanes===0&&(o===null||o.lanes===0)&&(o=e.lastRenderedReducer,o!==null))try{var a=e.lastRenderedState,l=o(a,n);if(s.hasEagerState=!0,s.eagerState=l,el(l,a)){var c=e.interleaved;c===null?(s.next=s,zI(e)):(s.next=c.next,c.next=s),e.interleaved=s;return}}catch{}finally{}n=d7(r,e,s,i),n!==null&&(s=Os(),Qa(n,r,i,s),k7(n,e,i))}}function O7(r){var e=r.alternate;return r===yr||e!==null&&e===yr}function D7(r,e){b0=cT=!0;var n=r.pending;n===null?e.next=e:(e.next=n.next,n.next=e),r.pending=e}function k7(r,e,n){if(n&4194240){var i=e.lanes;i&=r.pendingLanes,n|=i,e.lanes=n,MI(r,n)}}var uT={readContext:ha,useCallback:Hi,useContext:Hi,useEffect:Hi,useImperativeHandle:Hi,useInsertionEffect:Hi,useLayoutEffect:Hi,useMemo:Hi,useReducer:Hi,useRef:Hi,useState:Hi,useDebugValue:Hi,useDeferredValue:Hi,useTransition:Hi,useMutableSource:Hi,useSyncExternalStore:Hi,useId:Hi,unstable_isNewReconciler:!1},Coe={readContext:ha,useCallback:function(r,e){return ml().memoizedState=[r,e===void 0?null:e],r},useContext:ha,useEffect:$U,useImperativeHandle:function(r,e,n){return n=n!=null?n.concat([r]):null,y1(4194308,4,M7.bind(null,e,r),n)},useLayoutEffect:function(r,e){return y1(4194308,4,r,e)},useInsertionEffect:function(r,e){return y1(4,2,r,e)},useMemo:function(r,e){var n=ml();return e=e===void 0?null:e,r=r(),n.memoizedState=[r,e],r},useReducer:function(r,e,n){var i=ml();return e=n!==void 0?n(e):e,i.memoizedState=i.baseState=e,r={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:r,lastRenderedState:e},i.queue=r,r=r.dispatch=Moe.bind(null,yr,r),[i.memoizedState,r]},useRef:function(r){var e=ml();return r={current:r},e.memoizedState=r},useState:zU,useDebugValue:KI,useDeferredValue:function(r){return ml().memoizedState=r},useTransition:function(){var r=zU(!1),e=r[0];return r=Eoe.bind(null,r[1]),ml().memoizedState=r,[e,r]},useMutableSource:function(){},useSyncExternalStore:function(r,e,n){var i=yr,s=ml();if(sr){if(n===void 0)throw Error(Be(407));n=n()}else{if(n=e(),Mi===null)throw Error(Be(349));ld&30||v7(i,e,n)}s.memoizedState=n;var o={value:n,getSnapshot:e};return s.queue=o,$U(b7.bind(null,i,o,r),[r]),i.flags|=2048,mx(9,x7.bind(null,i,o,n,e),void 0,null),n},useId:function(){var r=ml(),e=Mi.identifierPrefix;if(sr){var n=Nc,i=Rc;n=(i&~(1<<32-Za(i)-1)).toString(32)+n,e=":"+e+"R"+n,n=dx++,0<n&&(e+="H"+n.toString(32)),e+=":"}else n=Toe++,e=":"+e+"r"+n.toString(32)+":";return r.memoizedState=e},unstable_isNewReconciler:!1},Poe={readContext:ha,useCallback:C7,useContext:ha,useEffect:XI,useImperativeHandle:A7,useInsertionEffect:T7,useLayoutEffect:E7,useMemo:P7,useReducer:GC,useRef:S7,useState:function(){return GC(px)},useDebugValue:KI,useDeferredValue:function(r){var e=fa();return R7(e,oi.memoizedState,r)},useTransition:function(){var r=GC(px)[0],e=fa().memoizedState;return[r,e]},useMutableSource:g7,useSyncExternalStore:y7,useId:N7,unstable_isNewReconciler:!1},Roe={readContext:ha,useCallback:C7,useContext:ha,useEffect:XI,useImperativeHandle:A7,useInsertionEffect:T7,useLayoutEffect:E7,useMemo:P7,useReducer:HC,useRef:S7,useState:function(){return HC(px)},useDebugValue:KI,useDeferredValue:function(r){var e=fa();return oi===null?e.memoizedState=r:R7(e,oi.memoizedState,r)},useTransition:function(){var r=HC(px)[0],e=fa().memoizedState;return[r,e]},useMutableSource:g7,useSyncExternalStore:y7,useId:N7,unstable_isNewReconciler:!1};function Da(r,e){if(r&&r.defaultProps){e=vr({},e),r=r.defaultProps;for(var n in r)e[n]===void 0&&(e[n]=r[n]);return e}return e}function G2(r,e,n,i){e=r.memoizedState,n=n(i,e),n=n==null?e:vr({},e,n),r.memoizedState=n,r.lanes===0&&(r.updateQueue.baseState=n)}var _M={isMounted:function(r){return(r=r._reactInternals)?Cd(r)===r:!1},enqueueSetState:function(r,e,n){r=r._reactInternals;var i=Os(),s=ph(r),o=$c(i,s);o.payload=e,n!=null&&(o.callback=n),e=fh(r,o,s),e!==null&&(Qa(e,r,s,i),m1(e,r,s))},enqueueReplaceState:function(r,e,n){r=r._reactInternals;var i=Os(),s=ph(r),o=$c(i,s);o.tag=1,o.payload=e,n!=null&&(o.callback=n),e=fh(r,o,s),e!==null&&(Qa(e,r,s,i),m1(e,r,s))},enqueueForceUpdate:function(r,e){r=r._reactInternals;var n=Os(),i=ph(r),s=$c(n,i);s.tag=2,e!=null&&(s.callback=e),e=fh(r,s,i),e!==null&&(Qa(e,r,i,n),m1(e,r,i))}};function jU(r,e,n,i,s,o,a){return r=r.stateNode,typeof r.shouldComponentUpdate=="function"?r.shouldComponentUpdate(i,o,a):e.prototype&&e.prototype.isPureReactComponent?!ax(n,i)||!ax(s,o):!0}function I7(r,e,n){var i=!1,s=Th,o=e.contextType;return typeof o=="object"&&o!==null?o=ha(o):(s=eo(e)?od:ls.current,i=e.contextTypes,o=(i=i!=null)?Vm(r,s):Th),e=new e(n,o),r.memoizedState=e.state!==null&&e.state!==void 0?e.state:null,e.updater=_M,r.stateNode=e,e._reactInternals=r,i&&(r=r.stateNode,r.__reactInternalMemoizedUnmaskedChildContext=s,r.__reactInternalMemoizedMaskedChildContext=o),e}function VU(r,e,n,i){r=e.state,typeof e.componentWillReceiveProps=="function"&&e.componentWillReceiveProps(n,i),typeof e.UNSAFE_componentWillReceiveProps=="function"&&e.UNSAFE_componentWillReceiveProps(n,i),e.state!==r&&_M.enqueueReplaceState(e,e.state,null)}function H2(r,e,n,i){var s=r.stateNode;s.props=n,s.state=r.memoizedState,s.refs={},$I(r);var o=e.contextType;typeof o=="object"&&o!==null?s.context=ha(o):(o=eo(e)?od:ls.current,s.context=Vm(r,o)),s.state=r.memoizedState,o=e.getDerivedStateFromProps,typeof o=="function"&&(G2(r,e,o,n),s.state=r.memoizedState),typeof e.getDerivedStateFromProps=="function"||typeof s.getSnapshotBeforeUpdate=="function"||typeof s.UNSAFE_componentWillMount!="function"&&typeof s.componentWillMount!="function"||(e=s.state,typeof s.componentWillMount=="function"&&s.componentWillMount(),typeof s.UNSAFE_componentWillMount=="function"&&s.UNSAFE_componentWillMount(),e!==s.state&&_M.enqueueReplaceState(s,s.state,null),aT(r,n,s,i),s.state=r.memoizedState),typeof s.componentDidMount=="function"&&(r.flags|=4194308)}function qm(r,e){try{var n="",i=e;do n+=ise(i),i=i.return;while(i);var s=n}catch(o){s=`
Error generating stack: `+o.message+`
`+o.stack}return{value:r,source:e,stack:s,digest:null}}function WC(r,e,n){return{value:r,source:null,stack:n??null,digest:e??null}}function W2(r,e){try{console.error(e.value)}catch(n){setTimeout(function(){throw n})}}var Noe=typeof WeakMap=="function"?WeakMap:Map;function L7(r,e,n){n=$c(-1,n),n.tag=3,n.payload={element:null};var i=e.value;return n.callback=function(){fT||(fT=!0,nO=i),W2(r,e)},n}function F7(r,e,n){n=$c(-1,n),n.tag=3;var i=r.type.getDerivedStateFromError;if(typeof i=="function"){var s=e.value;n.payload=function(){return i(s)},n.callback=function(){W2(r,e)}}var o=r.stateNode;return o!==null&&typeof o.componentDidCatch=="function"&&(n.callback=function(){W2(r,e),typeof i!="function"&&(dh===null?dh=new Set([this]):dh.add(this));var a=e.stack;this.componentDidCatch(e.value,{componentStack:a!==null?a:""})}),n}function GU(r,e,n){var i=r.pingCache;if(i===null){i=r.pingCache=new Noe;var s=new Set;i.set(e,s)}else s=i.get(e),s===void 0&&(s=new Set,i.set(e,s));s.has(n)||(s.add(n),r=Hoe.bind(null,r,e,n),e.then(r,r))}function HU(r){do{var e;if((e=r.tag===13)&&(e=r.memoizedState,e=e!==null?e.dehydrated!==null:!0),e)return r;r=r.return}while(r!==null);return null}function WU(r,e,n,i,s){return r.mode&1?(r.flags|=65536,r.lanes=s,r):(r===e?r.flags|=65536:(r.flags|=128,n.flags|=131072,n.flags&=-52805,n.tag===1&&(n.alternate===null?n.tag=17:(e=$c(-1,1),e.tag=2,fh(n,e,1))),n.lanes|=1),r)}var Ooe=pu.ReactCurrentOwner,Xs=!1;function bs(r,e,n,i){e.child=r===null?f7(e,null,n,i):Hm(e,r.child,n,i)}function qU(r,e,n,i,s){n=n.render;var o=e.ref;return Sm(e,s),i=WI(r,e,n,i,o,s),n=qI(),r!==null&&!Xs?(e.updateQueue=r.updateQueue,e.flags&=-2053,r.lanes&=~s,iu(r,e,s)):(sr&&n&&kI(e),e.flags|=1,bs(r,e,i,s),e.child)}function XU(r,e,n,i,s){if(r===null){var o=n.type;return typeof o=="function"&&!rL(o)&&o.defaultProps===void 0&&n.compare===null&&n.defaultProps===void 0?(e.tag=15,e.type=o,B7(r,e,o,i,s)):(r=_1(n.type,null,i,e,e.mode,s),r.ref=e.ref,r.return=e,e.child=r)}if(o=r.child,!(r.lanes&s)){var a=o.memoizedProps;if(n=n.compare,n=n!==null?n:ax,n(a,i)&&r.ref===e.ref)return iu(r,e,s)}return e.flags|=1,r=mh(o,i),r.ref=e.ref,r.return=e,e.child=r}function B7(r,e,n,i,s){if(r!==null){var o=r.memoizedProps;if(ax(o,i)&&r.ref===e.ref)if(Xs=!1,e.pendingProps=i=o,(r.lanes&s)!==0)r.flags&131072&&(Xs=!0);else return e.lanes=r.lanes,iu(r,e,s)}return q2(r,e,n,i,s)}function U7(r,e,n){var i=e.pendingProps,s=i.children,o=r!==null?r.memoizedState:null;if(i.mode==="hidden")if(!(e.mode&1))e.memoizedState={baseLanes:0,cachePool:null,transitions:null},$n(Zp,_o),_o|=n;else{if(!(n&1073741824))return r=o!==null?o.baseLanes|n:n,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:r,cachePool:null,transitions:null},e.updateQueue=null,$n(Zp,_o),_o|=r,null;e.memoizedState={baseLanes:0,cachePool:null,transitions:null},i=o!==null?o.baseLanes:n,$n(Zp,_o),_o|=i}else o!==null?(i=o.baseLanes|n,e.memoizedState=null):i=n,$n(Zp,_o),_o|=i;return bs(r,e,s,n),e.child}function z7(r,e){var n=e.ref;(r===null&&n!==null||r!==null&&r.ref!==n)&&(e.flags|=512,e.flags|=2097152)}function q2(r,e,n,i,s){var o=eo(n)?od:ls.current;return o=Vm(e,o),Sm(e,s),n=WI(r,e,n,i,o,s),i=qI(),r!==null&&!Xs?(e.updateQueue=r.updateQueue,e.flags&=-2053,r.lanes&=~s,iu(r,e,s)):(sr&&i&&kI(e),e.flags|=1,bs(r,e,n,s),e.child)}function KU(r,e,n,i,s){if(eo(n)){var o=!0;nT(e)}else o=!1;if(Sm(e,s),e.stateNode===null)v1(r,e),I7(e,n,i),H2(e,n,i,s),i=!0;else if(r===null){var a=e.stateNode,l=e.memoizedProps;a.props=l;var c=a.context,u=n.contextType;typeof u=="object"&&u!==null?u=ha(u):(u=eo(n)?od:ls.current,u=Vm(e,u));var h=n.getDerivedStateFromProps,f=typeof h=="function"||typeof a.getSnapshotBeforeUpdate=="function";f||typeof a.UNSAFE_componentWillReceiveProps!="function"&&typeof a.componentWillReceiveProps!="function"||(l!==i||c!==u)&&VU(e,a,i,u),Xu=!1;var d=e.memoizedState;a.state=d,aT(e,i,a,s),c=e.memoizedState,l!==i||d!==c||Js.current||Xu?(typeof h=="function"&&(G2(e,n,h,i),c=e.memoizedState),(l=Xu||jU(e,n,l,i,d,c,u))?(f||typeof a.UNSAFE_componentWillMount!="function"&&typeof a.componentWillMount!="function"||(typeof a.componentWillMount=="function"&&a.componentWillMount(),typeof a.UNSAFE_componentWillMount=="function"&&a.UNSAFE_componentWillMount()),typeof a.componentDidMount=="function"&&(e.flags|=4194308)):(typeof a.componentDidMount=="function"&&(e.flags|=4194308),e.memoizedProps=i,e.memoizedState=c),a.props=i,a.state=c,a.context=u,i=l):(typeof a.componentDidMount=="function"&&(e.flags|=4194308),i=!1)}else{a=e.stateNode,p7(r,e),l=e.memoizedProps,u=e.type===e.elementType?l:Da(e.type,l),a.props=u,f=e.pendingProps,d=a.context,c=n.contextType,typeof c=="object"&&c!==null?c=ha(c):(c=eo(n)?od:ls.current,c=Vm(e,c));var p=n.getDerivedStateFromProps;(h=typeof p=="function"||typeof a.getSnapshotBeforeUpdate=="function")||typeof a.UNSAFE_componentWillReceiveProps!="function"&&typeof a.componentWillReceiveProps!="function"||(l!==f||d!==c)&&VU(e,a,i,c),Xu=!1,d=e.memoizedState,a.state=d,aT(e,i,a,s);var m=e.memoizedState;l!==f||d!==m||Js.current||Xu?(typeof p=="function"&&(G2(e,n,p,i),m=e.memoizedState),(u=Xu||jU(e,n,u,i,d,m,c)||!1)?(h||typeof a.UNSAFE_componentWillUpdate!="function"&&typeof a.componentWillUpdate!="function"||(typeof a.componentWillUpdate=="function"&&a.componentWillUpdate(i,m,c),typeof a.UNSAFE_componentWillUpdate=="function"&&a.UNSAFE_componentWillUpdate(i,m,c)),typeof a.componentDidUpdate=="function"&&(e.flags|=4),typeof a.getSnapshotBeforeUpdate=="function"&&(e.flags|=1024)):(typeof a.componentDidUpdate!="function"||l===r.memoizedProps&&d===r.memoizedState||(e.flags|=4),typeof a.getSnapshotBeforeUpdate!="function"||l===r.memoizedProps&&d===r.memoizedState||(e.flags|=1024),e.memoizedProps=i,e.memoizedState=m),a.props=i,a.state=m,a.context=c,i=u):(typeof a.componentDidUpdate!="function"||l===r.memoizedProps&&d===r.memoizedState||(e.flags|=4),typeof a.getSnapshotBeforeUpdate!="function"||l===r.memoizedProps&&d===r.memoizedState||(e.flags|=1024),i=!1)}return X2(r,e,n,i,o,s)}function X2(r,e,n,i,s,o){z7(r,e);var a=(e.flags&128)!==0;if(!i&&!a)return s&&kU(e,n,!1),iu(r,e,o);i=e.stateNode,Ooe.current=e;var l=a&&typeof n.getDerivedStateFromError!="function"?null:i.render();return e.flags|=1,r!==null&&a?(e.child=Hm(e,r.child,null,o),e.child=Hm(e,null,l,o)):bs(r,e,l,o),e.memoizedState=i.state,s&&kU(e,n,!0),e.child}function $7(r){var e=r.stateNode;e.pendingContext?DU(r,e.pendingContext,e.pendingContext!==e.context):e.context&&DU(r,e.context,!1),jI(r,e.containerInfo)}function YU(r,e,n,i,s){return Gm(),LI(s),e.flags|=256,bs(r,e,n,i),e.child}var K2={dehydrated:null,treeContext:null,retryLane:0};function Y2(r){return{baseLanes:r,cachePool:null,transitions:null}}function j7(r,e,n){var i=e.pendingProps,s=fr.current,o=!1,a=(e.flags&128)!==0,l;if((l=a)||(l=r!==null&&r.memoizedState===null?!1:(s&2)!==0),l?(o=!0,e.flags&=-129):(r===null||r.memoizedState!==null)&&(s|=1),$n(fr,s&1),r===null)return j2(e),r=e.memoizedState,r!==null&&(r=r.dehydrated,r!==null)?(e.mode&1?r.data==="$!"?e.lanes=8:e.lanes=1073741824:e.lanes=1,null):(a=i.children,r=i.fallback,o?(i=e.mode,o=e.child,a={mode:"hidden",children:a},!(i&1)&&o!==null?(o.childLanes=0,o.pendingProps=a):o=TM(a,i,0,null),r=Yf(r,i,n,null),o.return=e,r.return=e,o.sibling=r,e.child=o,e.child.memoizedState=Y2(n),e.memoizedState=K2,r):YI(e,a));if(s=r.memoizedState,s!==null&&(l=s.dehydrated,l!==null))return Doe(r,e,a,i,l,s,n);if(o){o=i.fallback,a=e.mode,s=r.child,l=s.sibling;var c={mode:"hidden",children:i.children};return!(a&1)&&e.child!==s?(i=e.child,i.childLanes=0,i.pendingProps=c,e.deletions=null):(i=mh(s,c),i.subtreeFlags=s.subtreeFlags&14680064),l!==null?o=mh(l,o):(o=Yf(o,a,n,null),o.flags|=2),o.return=e,i.return=e,i.sibling=o,e.child=i,i=o,o=e.child,a=r.child.memoizedState,a=a===null?Y2(n):{baseLanes:a.baseLanes|n,cachePool:null,transitions:a.transitions},o.memoizedState=a,o.childLanes=r.childLanes&~n,e.memoizedState=K2,i}return o=r.child,r=o.sibling,i=mh(o,{mode:"visible",children:i.children}),!(e.mode&1)&&(i.lanes=n),i.return=e,i.sibling=null,r!==null&&(n=e.deletions,n===null?(e.deletions=[r],e.flags|=16):n.push(r)),e.child=i,e.memoizedState=null,i}function YI(r,e){return e=TM({mode:"visible",children:e},r.mode,0,null),e.return=r,r.child=e}function uw(r,e,n,i){return i!==null&&LI(i),Hm(e,r.child,null,n),r=YI(e,e.pendingProps.children),r.flags|=2,e.memoizedState=null,r}function Doe(r,e,n,i,s,o,a){if(n)return e.flags&256?(e.flags&=-257,i=WC(Error(Be(422))),uw(r,e,a,i)):e.memoizedState!==null?(e.child=r.child,e.flags|=128,null):(o=i.fallback,s=e.mode,i=TM({mode:"visible",children:i.children},s,0,null),o=Yf(o,s,a,null),o.flags|=2,i.return=e,o.return=e,i.sibling=o,e.child=i,e.mode&1&&Hm(e,r.child,null,a),e.child.memoizedState=Y2(a),e.memoizedState=K2,o);if(!(e.mode&1))return uw(r,e,a,null);if(s.data==="$!"){if(i=s.nextSibling&&s.nextSibling.dataset,i)var l=i.dgst;return i=l,o=Error(Be(419)),i=WC(o,i,void 0),uw(r,e,a,i)}if(l=(a&r.childLanes)!==0,Xs||l){if(i=Mi,i!==null){switch(a&-a){case 4:s=2;break;case 16:s=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:s=32;break;case 536870912:s=268435456;break;default:s=0}s=s&(i.suspendedLanes|a)?0:s,s!==0&&s!==o.retryLane&&(o.retryLane=s,ru(r,s),Qa(i,r,s,-1))}return nL(),i=WC(Error(Be(421))),uw(r,e,a,i)}return s.data==="$?"?(e.flags|=128,e.child=r.child,e=Woe.bind(null,r),s._reactRetry=e,null):(r=o.treeContext,Ao=hh(s.nextSibling),Co=e,sr=!0,za=null,r!==null&&(Zo[Qo++]=Rc,Zo[Qo++]=Nc,Zo[Qo++]=ad,Rc=r.id,Nc=r.overflow,ad=e),e=YI(e,i.children),e.flags|=4096,e)}function ZU(r,e,n){r.lanes|=e;var i=r.alternate;i!==null&&(i.lanes|=e),V2(r.return,e,n)}function qC(r,e,n,i,s){var o=r.memoizedState;o===null?r.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:i,tail:n,tailMode:s}:(o.isBackwards=e,o.rendering=null,o.renderingStartTime=0,o.last=i,o.tail=n,o.tailMode=s)}function V7(r,e,n){var i=e.pendingProps,s=i.revealOrder,o=i.tail;if(bs(r,e,i.children,n),i=fr.current,i&2)i=i&1|2,e.flags|=128;else{if(r!==null&&r.flags&128)e:for(r=e.child;r!==null;){if(r.tag===13)r.memoizedState!==null&&ZU(r,n,e);else if(r.tag===19)ZU(r,n,e);else if(r.child!==null){r.child.return=r,r=r.child;continue}if(r===e)break e;for(;r.sibling===null;){if(r.return===null||r.return===e)break e;r=r.return}r.sibling.return=r.return,r=r.sibling}i&=1}if($n(fr,i),!(e.mode&1))e.memoizedState=null;else switch(s){case"forwards":for(n=e.child,s=null;n!==null;)r=n.alternate,r!==null&&lT(r)===null&&(s=n),n=n.sibling;n=s,n===null?(s=e.child,e.child=null):(s=n.sibling,n.sibling=null),qC(e,!1,s,n,o);break;case"backwards":for(n=null,s=e.child,e.child=null;s!==null;){if(r=s.alternate,r!==null&&lT(r)===null){e.child=s;break}r=s.sibling,s.sibling=n,n=s,s=r}qC(e,!0,n,null,o);break;case"together":qC(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function v1(r,e){!(e.mode&1)&&r!==null&&(r.alternate=null,e.alternate=null,e.flags|=2)}function iu(r,e,n){if(r!==null&&(e.dependencies=r.dependencies),cd|=e.lanes,!(n&e.childLanes))return null;if(r!==null&&e.child!==r.child)throw Error(Be(153));if(e.child!==null){for(r=e.child,n=mh(r,r.pendingProps),e.child=n,n.return=e;r.sibling!==null;)r=r.sibling,n=n.sibling=mh(r,r.pendingProps),n.return=e;n.sibling=null}return e.child}function koe(r,e,n){switch(e.tag){case 3:$7(e),Gm();break;case 5:m7(e);break;case 1:eo(e.type)&&nT(e);break;case 4:jI(e,e.stateNode.containerInfo);break;case 10:var i=e.type._context,s=e.memoizedProps.value;$n(sT,i._currentValue),i._currentValue=s;break;case 13:if(i=e.memoizedState,i!==null)return i.dehydrated!==null?($n(fr,fr.current&1),e.flags|=128,null):n&e.child.childLanes?j7(r,e,n):($n(fr,fr.current&1),r=iu(r,e,n),r!==null?r.sibling:null);$n(fr,fr.current&1);break;case 19:if(i=(n&e.childLanes)!==0,r.flags&128){if(i)return V7(r,e,n);e.flags|=128}if(s=e.memoizedState,s!==null&&(s.rendering=null,s.tail=null,s.lastEffect=null),$n(fr,fr.current),i)break;return null;case 22:case 23:return e.lanes=0,U7(r,e,n)}return iu(r,e,n)}var G7,Z2,H7,W7;G7=function(r,e){for(var n=e.child;n!==null;){if(n.tag===5||n.tag===6)r.appendChild(n.stateNode);else if(n.tag!==4&&n.child!==null){n.child.return=n,n=n.child;continue}if(n===e)break;for(;n.sibling===null;){if(n.return===null||n.return===e)return;n=n.return}n.sibling.return=n.return,n=n.sibling}};Z2=function(){};H7=function(r,e,n,i){var s=r.memoizedProps;if(s!==i){r=e.stateNode,$f(Pl.current);var o=null;switch(n){case"input":s=x2(r,s),i=x2(r,i),o=[];break;case"select":s=vr({},s,{value:void 0}),i=vr({},i,{value:void 0}),o=[];break;case"textarea":s=w2(r,s),i=w2(r,i),o=[];break;default:typeof s.onClick!="function"&&typeof i.onClick=="function"&&(r.onclick=eT)}T2(n,i);var a;n=null;for(u in s)if(!i.hasOwnProperty(u)&&s.hasOwnProperty(u)&&s[u]!=null)if(u==="style"){var l=s[u];for(a in l)l.hasOwnProperty(a)&&(n||(n={}),n[a]="")}else u!=="dangerouslySetInnerHTML"&&u!=="children"&&u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&u!=="autoFocus"&&(ex.hasOwnProperty(u)?o||(o=[]):(o=o||[]).push(u,null));for(u in i){var c=i[u];if(l=s!=null?s[u]:void 0,i.hasOwnProperty(u)&&c!==l&&(c!=null||l!=null))if(u==="style")if(l){for(a in l)!l.hasOwnProperty(a)||c&&c.hasOwnProperty(a)||(n||(n={}),n[a]="");for(a in c)c.hasOwnProperty(a)&&l[a]!==c[a]&&(n||(n={}),n[a]=c[a])}else n||(o||(o=[]),o.push(u,n)),n=c;else u==="dangerouslySetInnerHTML"?(c=c?c.__html:void 0,l=l?l.__html:void 0,c!=null&&l!==c&&(o=o||[]).push(u,c)):u==="children"?typeof c!="string"&&typeof c!="number"||(o=o||[]).push(u,""+c):u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&(ex.hasOwnProperty(u)?(c!=null&&u==="onScroll"&&Hn("scroll",r),o||l===c||(o=[])):(o=o||[]).push(u,c))}n&&(o=o||[]).push("style",n);var u=o;(e.updateQueue=u)&&(e.flags|=4)}};W7=function(r,e,n,i){n!==i&&(e.flags|=4)};function Wy(r,e){if(!sr)switch(r.tailMode){case"hidden":e=r.tail;for(var n=null;e!==null;)e.alternate!==null&&(n=e),e=e.sibling;n===null?r.tail=null:n.sibling=null;break;case"collapsed":n=r.tail;for(var i=null;n!==null;)n.alternate!==null&&(i=n),n=n.sibling;i===null?e||r.tail===null?r.tail=null:r.tail.sibling=null:i.sibling=null}}function Wi(r){var e=r.alternate!==null&&r.alternate.child===r.child,n=0,i=0;if(e)for(var s=r.child;s!==null;)n|=s.lanes|s.childLanes,i|=s.subtreeFlags&14680064,i|=s.flags&14680064,s.return=r,s=s.sibling;else for(s=r.child;s!==null;)n|=s.lanes|s.childLanes,i|=s.subtreeFlags,i|=s.flags,s.return=r,s=s.sibling;return r.subtreeFlags|=i,r.childLanes=n,e}function Ioe(r,e,n){var i=e.pendingProps;switch(II(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Wi(e),null;case 1:return eo(e.type)&&tT(),Wi(e),null;case 3:return i=e.stateNode,Wm(),er(Js),er(ls),GI(),i.pendingContext&&(i.context=i.pendingContext,i.pendingContext=null),(r===null||r.child===null)&&(lw(e)?e.flags|=4:r===null||r.memoizedState.isDehydrated&&!(e.flags&256)||(e.flags|=1024,za!==null&&(sO(za),za=null))),Z2(r,e),Wi(e),null;case 5:VI(e);var s=$f(fx.current);if(n=e.type,r!==null&&e.stateNode!=null)H7(r,e,n,i,s),r.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!i){if(e.stateNode===null)throw Error(Be(166));return Wi(e),null}if(r=$f(Pl.current),lw(e)){i=e.stateNode,n=e.type;var o=e.memoizedProps;switch(i[bl]=e,i[ux]=o,r=(e.mode&1)!==0,n){case"dialog":Hn("cancel",i),Hn("close",i);break;case"iframe":case"object":case"embed":Hn("load",i);break;case"video":case"audio":for(s=0;s<Jv.length;s++)Hn(Jv[s],i);break;case"source":Hn("error",i);break;case"img":case"image":case"link":Hn("error",i),Hn("load",i);break;case"details":Hn("toggle",i);break;case"input":oU(i,o),Hn("invalid",i);break;case"select":i._wrapperState={wasMultiple:!!o.multiple},Hn("invalid",i);break;case"textarea":lU(i,o),Hn("invalid",i)}T2(n,o),s=null;for(var a in o)if(o.hasOwnProperty(a)){var l=o[a];a==="children"?typeof l=="string"?i.textContent!==l&&(o.suppressHydrationWarning!==!0&&aw(i.textContent,l,r),s=["children",l]):typeof l=="number"&&i.textContent!==""+l&&(o.suppressHydrationWarning!==!0&&aw(i.textContent,l,r),s=["children",""+l]):ex.hasOwnProperty(a)&&l!=null&&a==="onScroll"&&Hn("scroll",i)}switch(n){case"input":J_(i),aU(i,o,!0);break;case"textarea":J_(i),cU(i);break;case"select":case"option":break;default:typeof o.onClick=="function"&&(i.onclick=eT)}i=s,e.updateQueue=i,i!==null&&(e.flags|=4)}else{a=s.nodeType===9?s:s.ownerDocument,r==="http://www.w3.org/1999/xhtml"&&(r=b9(n)),r==="http://www.w3.org/1999/xhtml"?n==="script"?(r=a.createElement("div"),r.innerHTML="<script><\/script>",r=r.removeChild(r.firstChild)):typeof i.is=="string"?r=a.createElement(n,{is:i.is}):(r=a.createElement(n),n==="select"&&(a=r,i.multiple?a.multiple=!0:i.size&&(a.size=i.size))):r=a.createElementNS(r,n),r[bl]=e,r[ux]=i,G7(r,e,!1,!1),e.stateNode=r;e:{switch(a=E2(n,i),n){case"dialog":Hn("cancel",r),Hn("close",r),s=i;break;case"iframe":case"object":case"embed":Hn("load",r),s=i;break;case"video":case"audio":for(s=0;s<Jv.length;s++)Hn(Jv[s],r);s=i;break;case"source":Hn("error",r),s=i;break;case"img":case"image":case"link":Hn("error",r),Hn("load",r),s=i;break;case"details":Hn("toggle",r),s=i;break;case"input":oU(r,i),s=x2(r,i),Hn("invalid",r);break;case"option":s=i;break;case"select":r._wrapperState={wasMultiple:!!i.multiple},s=vr({},i,{value:void 0}),Hn("invalid",r);break;case"textarea":lU(r,i),s=w2(r,i),Hn("invalid",r);break;default:s=i}T2(n,s),l=s;for(o in l)if(l.hasOwnProperty(o)){var c=l[o];o==="style"?S9(r,c):o==="dangerouslySetInnerHTML"?(c=c?c.__html:void 0,c!=null&&_9(r,c)):o==="children"?typeof c=="string"?(n!=="textarea"||c!=="")&&tx(r,c):typeof c=="number"&&tx(r,""+c):o!=="suppressContentEditableWarning"&&o!=="suppressHydrationWarning"&&o!=="autoFocus"&&(ex.hasOwnProperty(o)?c!=null&&o==="onScroll"&&Hn("scroll",r):c!=null&&bI(r,o,c,a))}switch(n){case"input":J_(r),aU(r,i,!1);break;case"textarea":J_(r),cU(r);break;case"option":i.value!=null&&r.setAttribute("value",""+Sh(i.value));break;case"select":r.multiple=!!i.multiple,o=i.value,o!=null?xm(r,!!i.multiple,o,!1):i.defaultValue!=null&&xm(r,!!i.multiple,i.defaultValue,!0);break;default:typeof s.onClick=="function"&&(r.onclick=eT)}switch(n){case"button":case"input":case"select":case"textarea":i=!!i.autoFocus;break e;case"img":i=!0;break e;default:i=!1}}i&&(e.flags|=4)}e.ref!==null&&(e.flags|=512,e.flags|=2097152)}return Wi(e),null;case 6:if(r&&e.stateNode!=null)W7(r,e,r.memoizedProps,i);else{if(typeof i!="string"&&e.stateNode===null)throw Error(Be(166));if(n=$f(fx.current),$f(Pl.current),lw(e)){if(i=e.stateNode,n=e.memoizedProps,i[bl]=e,(o=i.nodeValue!==n)&&(r=Co,r!==null))switch(r.tag){case 3:aw(i.nodeValue,n,(r.mode&1)!==0);break;case 5:r.memoizedProps.suppressHydrationWarning!==!0&&aw(i.nodeValue,n,(r.mode&1)!==0)}o&&(e.flags|=4)}else i=(n.nodeType===9?n:n.ownerDocument).createTextNode(i),i[bl]=e,e.stateNode=i}return Wi(e),null;case 13:if(er(fr),i=e.memoizedState,r===null||r.memoizedState!==null&&r.memoizedState.dehydrated!==null){if(sr&&Ao!==null&&e.mode&1&&!(e.flags&128))u7(),Gm(),e.flags|=98560,o=!1;else if(o=lw(e),i!==null&&i.dehydrated!==null){if(r===null){if(!o)throw Error(Be(318));if(o=e.memoizedState,o=o!==null?o.dehydrated:null,!o)throw Error(Be(317));o[bl]=e}else Gm(),!(e.flags&128)&&(e.memoizedState=null),e.flags|=4;Wi(e),o=!1}else za!==null&&(sO(za),za=null),o=!0;if(!o)return e.flags&65536?e:null}return e.flags&128?(e.lanes=n,e):(i=i!==null,i!==(r!==null&&r.memoizedState!==null)&&i&&(e.child.flags|=8192,e.mode&1&&(r===null||fr.current&1?ai===0&&(ai=3):nL())),e.updateQueue!==null&&(e.flags|=4),Wi(e),null);case 4:return Wm(),Z2(r,e),r===null&&lx(e.stateNode.containerInfo),Wi(e),null;case 10:return UI(e.type._context),Wi(e),null;case 17:return eo(e.type)&&tT(),Wi(e),null;case 19:if(er(fr),o=e.memoizedState,o===null)return Wi(e),null;if(i=(e.flags&128)!==0,a=o.rendering,a===null)if(i)Wy(o,!1);else{if(ai!==0||r!==null&&r.flags&128)for(r=e.child;r!==null;){if(a=lT(r),a!==null){for(e.flags|=128,Wy(o,!1),i=a.updateQueue,i!==null&&(e.updateQueue=i,e.flags|=4),e.subtreeFlags=0,i=n,n=e.child;n!==null;)o=n,r=i,o.flags&=14680066,a=o.alternate,a===null?(o.childLanes=0,o.lanes=r,o.child=null,o.subtreeFlags=0,o.memoizedProps=null,o.memoizedState=null,o.updateQueue=null,o.dependencies=null,o.stateNode=null):(o.childLanes=a.childLanes,o.lanes=a.lanes,o.child=a.child,o.subtreeFlags=0,o.deletions=null,o.memoizedProps=a.memoizedProps,o.memoizedState=a.memoizedState,o.updateQueue=a.updateQueue,o.type=a.type,r=a.dependencies,o.dependencies=r===null?null:{lanes:r.lanes,firstContext:r.firstContext}),n=n.sibling;return $n(fr,fr.current&1|2),e.child}r=r.sibling}o.tail!==null&&Rr()>Xm&&(e.flags|=128,i=!0,Wy(o,!1),e.lanes=4194304)}else{if(!i)if(r=lT(a),r!==null){if(e.flags|=128,i=!0,n=r.updateQueue,n!==null&&(e.updateQueue=n,e.flags|=4),Wy(o,!0),o.tail===null&&o.tailMode==="hidden"&&!a.alternate&&!sr)return Wi(e),null}else 2*Rr()-o.renderingStartTime>Xm&&n!==1073741824&&(e.flags|=128,i=!0,Wy(o,!1),e.lanes=4194304);o.isBackwards?(a.sibling=e.child,e.child=a):(n=o.last,n!==null?n.sibling=a:e.child=a,o.last=a)}return o.tail!==null?(e=o.tail,o.rendering=e,o.tail=e.sibling,o.renderingStartTime=Rr(),e.sibling=null,n=fr.current,$n(fr,i?n&1|2:n&1),e):(Wi(e),null);case 22:case 23:return tL(),i=e.memoizedState!==null,r!==null&&r.memoizedState!==null!==i&&(e.flags|=8192),i&&e.mode&1?_o&1073741824&&(Wi(e),e.subtreeFlags&6&&(e.flags|=8192)):Wi(e),null;case 24:return null;case 25:return null}throw Error(Be(156,e.tag))}function Loe(r,e){switch(II(e),e.tag){case 1:return eo(e.type)&&tT(),r=e.flags,r&65536?(e.flags=r&-65537|128,e):null;case 3:return Wm(),er(Js),er(ls),GI(),r=e.flags,r&65536&&!(r&128)?(e.flags=r&-65537|128,e):null;case 5:return VI(e),null;case 13:if(er(fr),r=e.memoizedState,r!==null&&r.dehydrated!==null){if(e.alternate===null)throw Error(Be(340));Gm()}return r=e.flags,r&65536?(e.flags=r&-65537|128,e):null;case 19:return er(fr),null;case 4:return Wm(),null;case 10:return UI(e.type._context),null;case 22:case 23:return tL(),null;case 24:return null;default:return null}}var hw=!1,rs=!1,Foe=typeof WeakSet=="function"?WeakSet:Set,it=null;function Yp(r,e){var n=r.ref;if(n!==null)if(typeof n=="function")try{n(null)}catch(i){_r(r,e,i)}else n.current=null}function Q2(r,e,n){try{n()}catch(i){_r(r,e,i)}}var QU=!1;function Boe(r,e){if(I2=Z1,r=Z9(),DI(r)){if("selectionStart"in r)var n={start:r.selectionStart,end:r.selectionEnd};else e:{n=(n=r.ownerDocument)&&n.defaultView||window;var i=n.getSelection&&n.getSelection();if(i&&i.rangeCount!==0){n=i.anchorNode;var s=i.anchorOffset,o=i.focusNode;i=i.focusOffset;try{n.nodeType,o.nodeType}catch{n=null;break e}var a=0,l=-1,c=-1,u=0,h=0,f=r,d=null;t:for(;;){for(var p;f!==n||s!==0&&f.nodeType!==3||(l=a+s),f!==o||i!==0&&f.nodeType!==3||(c=a+i),f.nodeType===3&&(a+=f.nodeValue.length),(p=f.firstChild)!==null;)d=f,f=p;for(;;){if(f===r)break t;if(d===n&&++u===s&&(l=a),d===o&&++h===i&&(c=a),(p=f.nextSibling)!==null)break;f=d,d=f.parentNode}f=p}n=l===-1||c===-1?null:{start:l,end:c}}else n=null}n=n||{start:0,end:0}}else n=null;for(L2={focusedElem:r,selectionRange:n},Z1=!1,it=e;it!==null;)if(e=it,r=e.child,(e.subtreeFlags&1028)!==0&&r!==null)r.return=e,it=r;else for(;it!==null;){e=it;try{var m=e.alternate;if(e.flags&1024)switch(e.tag){case 0:case 11:case 15:break;case 1:if(m!==null){var g=m.memoizedProps,v=m.memoizedState,y=e.stateNode,x=y.getSnapshotBeforeUpdate(e.elementType===e.type?g:Da(e.type,g),v);y.__reactInternalSnapshotBeforeUpdate=x}break;case 3:var b=e.stateNode.containerInfo;b.nodeType===1?b.textContent="":b.nodeType===9&&b.documentElement&&b.removeChild(b.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(Be(163))}}catch(w){_r(e,e.return,w)}if(r=e.sibling,r!==null){r.return=e.return,it=r;break}it=e.return}return m=QU,QU=!1,m}function _0(r,e,n){var i=e.updateQueue;if(i=i!==null?i.lastEffect:null,i!==null){var s=i=i.next;do{if((s.tag&r)===r){var o=s.destroy;s.destroy=void 0,o!==void 0&&Q2(e,n,o)}s=s.next}while(s!==i)}}function wM(r,e){if(e=e.updateQueue,e=e!==null?e.lastEffect:null,e!==null){var n=e=e.next;do{if((n.tag&r)===r){var i=n.create;n.destroy=i()}n=n.next}while(n!==e)}}function J2(r){var e=r.ref;if(e!==null){var n=r.stateNode;switch(r.tag){case 5:r=n;break;default:r=n}typeof e=="function"?e(r):e.current=r}}function q7(r){var e=r.alternate;e!==null&&(r.alternate=null,q7(e)),r.child=null,r.deletions=null,r.sibling=null,r.tag===5&&(e=r.stateNode,e!==null&&(delete e[bl],delete e[ux],delete e[U2],delete e[boe],delete e[_oe])),r.stateNode=null,r.return=null,r.dependencies=null,r.memoizedProps=null,r.memoizedState=null,r.pendingProps=null,r.stateNode=null,r.updateQueue=null}function X7(r){return r.tag===5||r.tag===3||r.tag===4}function JU(r){e:for(;;){for(;r.sibling===null;){if(r.return===null||X7(r.return))return null;r=r.return}for(r.sibling.return=r.return,r=r.sibling;r.tag!==5&&r.tag!==6&&r.tag!==18;){if(r.flags&2||r.child===null||r.tag===4)continue e;r.child.return=r,r=r.child}if(!(r.flags&2))return r.stateNode}}function eO(r,e,n){var i=r.tag;if(i===5||i===6)r=r.stateNode,e?n.nodeType===8?n.parentNode.insertBefore(r,e):n.insertBefore(r,e):(n.nodeType===8?(e=n.parentNode,e.insertBefore(r,n)):(e=n,e.appendChild(r)),n=n._reactRootContainer,n!=null||e.onclick!==null||(e.onclick=eT));else if(i!==4&&(r=r.child,r!==null))for(eO(r,e,n),r=r.sibling;r!==null;)eO(r,e,n),r=r.sibling}function tO(r,e,n){var i=r.tag;if(i===5||i===6)r=r.stateNode,e?n.insertBefore(r,e):n.appendChild(r);else if(i!==4&&(r=r.child,r!==null))for(tO(r,e,n),r=r.sibling;r!==null;)tO(r,e,n),r=r.sibling}var Di=null,Ia=!1;function Su(r,e,n){for(n=n.child;n!==null;)K7(r,e,n),n=n.sibling}function K7(r,e,n){if(Cl&&typeof Cl.onCommitFiberUnmount=="function")try{Cl.onCommitFiberUnmount(pM,n)}catch{}switch(n.tag){case 5:rs||Yp(n,e);case 6:var i=Di,s=Ia;Di=null,Su(r,e,n),Di=i,Ia=s,Di!==null&&(Ia?(r=Di,n=n.stateNode,r.nodeType===8?r.parentNode.removeChild(n):r.removeChild(n)):Di.removeChild(n.stateNode));break;case 18:Di!==null&&(Ia?(r=Di,n=n.stateNode,r.nodeType===8?zC(r.parentNode,n):r.nodeType===1&&zC(r,n),sx(r)):zC(Di,n.stateNode));break;case 4:i=Di,s=Ia,Di=n.stateNode.containerInfo,Ia=!0,Su(r,e,n),Di=i,Ia=s;break;case 0:case 11:case 14:case 15:if(!rs&&(i=n.updateQueue,i!==null&&(i=i.lastEffect,i!==null))){s=i=i.next;do{var o=s,a=o.destroy;o=o.tag,a!==void 0&&(o&2||o&4)&&Q2(n,e,a),s=s.next}while(s!==i)}Su(r,e,n);break;case 1:if(!rs&&(Yp(n,e),i=n.stateNode,typeof i.componentWillUnmount=="function"))try{i.props=n.memoizedProps,i.state=n.memoizedState,i.componentWillUnmount()}catch(l){_r(n,e,l)}Su(r,e,n);break;case 21:Su(r,e,n);break;case 22:n.mode&1?(rs=(i=rs)||n.memoizedState!==null,Su(r,e,n),rs=i):Su(r,e,n);break;default:Su(r,e,n)}}function ez(r){var e=r.updateQueue;if(e!==null){r.updateQueue=null;var n=r.stateNode;n===null&&(n=r.stateNode=new Foe),e.forEach(function(i){var s=qoe.bind(null,r,i);n.has(i)||(n.add(i),i.then(s,s))})}}function va(r,e){var n=e.deletions;if(n!==null)for(var i=0;i<n.length;i++){var s=n[i];try{var o=r,a=e,l=a;e:for(;l!==null;){switch(l.tag){case 5:Di=l.stateNode,Ia=!1;break e;case 3:Di=l.stateNode.containerInfo,Ia=!0;break e;case 4:Di=l.stateNode.containerInfo,Ia=!0;break e}l=l.return}if(Di===null)throw Error(Be(160));K7(o,a,s),Di=null,Ia=!1;var c=s.alternate;c!==null&&(c.return=null),s.return=null}catch(u){_r(s,e,u)}}if(e.subtreeFlags&12854)for(e=e.child;e!==null;)Y7(e,r),e=e.sibling}function Y7(r,e){var n=r.alternate,i=r.flags;switch(r.tag){case 0:case 11:case 14:case 15:if(va(e,r),cl(r),i&4){try{_0(3,r,r.return),wM(3,r)}catch(g){_r(r,r.return,g)}try{_0(5,r,r.return)}catch(g){_r(r,r.return,g)}}break;case 1:va(e,r),cl(r),i&512&&n!==null&&Yp(n,n.return);break;case 5:if(va(e,r),cl(r),i&512&&n!==null&&Yp(n,n.return),r.flags&32){var s=r.stateNode;try{tx(s,"")}catch(g){_r(r,r.return,g)}}if(i&4&&(s=r.stateNode,s!=null)){var o=r.memoizedProps,a=n!==null?n.memoizedProps:o,l=r.type,c=r.updateQueue;if(r.updateQueue=null,c!==null)try{l==="input"&&o.type==="radio"&&o.name!=null&&v9(s,o),E2(l,a);var u=E2(l,o);for(a=0;a<c.length;a+=2){var h=c[a],f=c[a+1];h==="style"?S9(s,f):h==="dangerouslySetInnerHTML"?_9(s,f):h==="children"?tx(s,f):bI(s,h,f,u)}switch(l){case"input":b2(s,o);break;case"textarea":x9(s,o);break;case"select":var d=s._wrapperState.wasMultiple;s._wrapperState.wasMultiple=!!o.multiple;var p=o.value;p!=null?xm(s,!!o.multiple,p,!1):d!==!!o.multiple&&(o.defaultValue!=null?xm(s,!!o.multiple,o.defaultValue,!0):xm(s,!!o.multiple,o.multiple?[]:"",!1))}s[ux]=o}catch(g){_r(r,r.return,g)}}break;case 6:if(va(e,r),cl(r),i&4){if(r.stateNode===null)throw Error(Be(162));s=r.stateNode,o=r.memoizedProps;try{s.nodeValue=o}catch(g){_r(r,r.return,g)}}break;case 3:if(va(e,r),cl(r),i&4&&n!==null&&n.memoizedState.isDehydrated)try{sx(e.containerInfo)}catch(g){_r(r,r.return,g)}break;case 4:va(e,r),cl(r);break;case 13:va(e,r),cl(r),s=r.child,s.flags&8192&&(o=s.memoizedState!==null,s.stateNode.isHidden=o,!o||s.alternate!==null&&s.alternate.memoizedState!==null||(JI=Rr())),i&4&&ez(r);break;case 22:if(h=n!==null&&n.memoizedState!==null,r.mode&1?(rs=(u=rs)||h,va(e,r),rs=u):va(e,r),cl(r),i&8192){if(u=r.memoizedState!==null,(r.stateNode.isHidden=u)&&!h&&r.mode&1)for(it=r,h=r.child;h!==null;){for(f=it=h;it!==null;){switch(d=it,p=d.child,d.tag){case 0:case 11:case 14:case 15:_0(4,d,d.return);break;case 1:Yp(d,d.return);var m=d.stateNode;if(typeof m.componentWillUnmount=="function"){i=d,n=d.return;try{e=i,m.props=e.memoizedProps,m.state=e.memoizedState,m.componentWillUnmount()}catch(g){_r(i,n,g)}}break;case 5:Yp(d,d.return);break;case 22:if(d.memoizedState!==null){nz(f);continue}}p!==null?(p.return=d,it=p):nz(f)}h=h.sibling}e:for(h=null,f=r;;){if(f.tag===5){if(h===null){h=f;try{s=f.stateNode,u?(o=s.style,typeof o.setProperty=="function"?o.setProperty("display","none","important"):o.display="none"):(l=f.stateNode,c=f.memoizedProps.style,a=c!=null&&c.hasOwnProperty("display")?c.display:null,l.style.display=w9("display",a))}catch(g){_r(r,r.return,g)}}}else if(f.tag===6){if(h===null)try{f.stateNode.nodeValue=u?"":f.memoizedProps}catch(g){_r(r,r.return,g)}}else if((f.tag!==22&&f.tag!==23||f.memoizedState===null||f===r)&&f.child!==null){f.child.return=f,f=f.child;continue}if(f===r)break e;for(;f.sibling===null;){if(f.return===null||f.return===r)break e;h===f&&(h=null),f=f.return}h===f&&(h=null),f.sibling.return=f.return,f=f.sibling}}break;case 19:va(e,r),cl(r),i&4&&ez(r);break;case 21:break;default:va(e,r),cl(r)}}function cl(r){var e=r.flags;if(e&2){try{e:{for(var n=r.return;n!==null;){if(X7(n)){var i=n;break e}n=n.return}throw Error(Be(160))}switch(i.tag){case 5:var s=i.stateNode;i.flags&32&&(tx(s,""),i.flags&=-33);var o=JU(r);tO(r,o,s);break;case 3:case 4:var a=i.stateNode.containerInfo,l=JU(r);eO(r,l,a);break;default:throw Error(Be(161))}}catch(c){_r(r,r.return,c)}r.flags&=-3}e&4096&&(r.flags&=-4097)}function Uoe(r,e,n){it=r,Z7(r)}function Z7(r,e,n){for(var i=(r.mode&1)!==0;it!==null;){var s=it,o=s.child;if(s.tag===22&&i){var a=s.memoizedState!==null||hw;if(!a){var l=s.alternate,c=l!==null&&l.memoizedState!==null||rs;l=hw;var u=rs;if(hw=a,(rs=c)&&!u)for(it=s;it!==null;)a=it,c=a.child,a.tag===22&&a.memoizedState!==null?rz(s):c!==null?(c.return=a,it=c):rz(s);for(;o!==null;)it=o,Z7(o),o=o.sibling;it=s,hw=l,rs=u}tz(r)}else s.subtreeFlags&8772&&o!==null?(o.return=s,it=o):tz(r)}}function tz(r){for(;it!==null;){var e=it;if(e.flags&8772){var n=e.alternate;try{if(e.flags&8772)switch(e.tag){case 0:case 11:case 15:rs||wM(5,e);break;case 1:var i=e.stateNode;if(e.flags&4&&!rs)if(n===null)i.componentDidMount();else{var s=e.elementType===e.type?n.memoizedProps:Da(e.type,n.memoizedProps);i.componentDidUpdate(s,n.memoizedState,i.__reactInternalSnapshotBeforeUpdate)}var o=e.updateQueue;o!==null&&UU(e,o,i);break;case 3:var a=e.updateQueue;if(a!==null){if(n=null,e.child!==null)switch(e.child.tag){case 5:n=e.child.stateNode;break;case 1:n=e.child.stateNode}UU(e,a,n)}break;case 5:var l=e.stateNode;if(n===null&&e.flags&4){n=l;var c=e.memoizedProps;switch(e.type){case"button":case"input":case"select":case"textarea":c.autoFocus&&n.focus();break;case"img":c.src&&(n.src=c.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(e.memoizedState===null){var u=e.alternate;if(u!==null){var h=u.memoizedState;if(h!==null){var f=h.dehydrated;f!==null&&sx(f)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(Be(163))}rs||e.flags&512&&J2(e)}catch(d){_r(e,e.return,d)}}if(e===r){it=null;break}if(n=e.sibling,n!==null){n.return=e.return,it=n;break}it=e.return}}function nz(r){for(;it!==null;){var e=it;if(e===r){it=null;break}var n=e.sibling;if(n!==null){n.return=e.return,it=n;break}it=e.return}}function rz(r){for(;it!==null;){var e=it;try{switch(e.tag){case 0:case 11:case 15:var n=e.return;try{wM(4,e)}catch(c){_r(e,n,c)}break;case 1:var i=e.stateNode;if(typeof i.componentDidMount=="function"){var s=e.return;try{i.componentDidMount()}catch(c){_r(e,s,c)}}var o=e.return;try{J2(e)}catch(c){_r(e,o,c)}break;case 5:var a=e.return;try{J2(e)}catch(c){_r(e,a,c)}}}catch(c){_r(e,e.return,c)}if(e===r){it=null;break}var l=e.sibling;if(l!==null){l.return=e.return,it=l;break}it=e.return}}var zoe=Math.ceil,hT=pu.ReactCurrentDispatcher,ZI=pu.ReactCurrentOwner,aa=pu.ReactCurrentBatchConfig,un=0,Mi=null,Xr=null,zi=0,_o=0,Zp=Lh(0),ai=0,gx=null,cd=0,SM=0,QI=0,w0=null,Gs=null,JI=0,Xm=1/0,xc=null,fT=!1,nO=null,dh=null,fw=!1,ih=null,dT=0,S0=0,rO=null,x1=-1,b1=0;function Os(){return un&6?Rr():x1!==-1?x1:x1=Rr()}function ph(r){return r.mode&1?un&2&&zi!==0?zi&-zi:Soe.transition!==null?(b1===0&&(b1=I9()),b1):(r=Mn,r!==0||(r=window.event,r=r===void 0?16:j9(r.type)),r):1}function Qa(r,e,n,i){if(50<S0)throw S0=0,rO=null,Error(Be(185));Xb(r,n,i),(!(un&2)||r!==Mi)&&(r===Mi&&(!(un&2)&&(SM|=n),ai===4&&Qu(r,zi)),to(r,i),n===1&&un===0&&!(e.mode&1)&&(Xm=Rr()+500,xM&&Fh()))}function to(r,e){var n=r.callbackNode;Sse(r,e);var i=Y1(r,r===Mi?zi:0);if(i===0)n!==null&&fU(n),r.callbackNode=null,r.callbackPriority=0;else if(e=i&-i,r.callbackPriority!==e){if(n!=null&&fU(n),e===1)r.tag===0?woe(iz.bind(null,r)):a7(iz.bind(null,r)),voe(function(){!(un&6)&&Fh()}),n=null;else{switch(L9(i)){case 1:n=EI;break;case 4:n=D9;break;case 16:n=K1;break;case 536870912:n=k9;break;default:n=K1}n=sq(n,Q7.bind(null,r))}r.callbackPriority=e,r.callbackNode=n}}function Q7(r,e){if(x1=-1,b1=0,un&6)throw Error(Be(327));var n=r.callbackNode;if(Tm()&&r.callbackNode!==n)return null;var i=Y1(r,r===Mi?zi:0);if(i===0)return null;if(i&30||i&r.expiredLanes||e)e=pT(r,i);else{e=i;var s=un;un|=2;var o=eq();(Mi!==r||zi!==e)&&(xc=null,Xm=Rr()+500,Kf(r,e));do try{Voe();break}catch(l){J7(r,l)}while(!0);BI(),hT.current=o,un=s,Xr!==null?e=0:(Mi=null,zi=0,e=ai)}if(e!==0){if(e===2&&(s=R2(r),s!==0&&(i=s,e=iO(r,s))),e===1)throw n=gx,Kf(r,0),Qu(r,i),to(r,Rr()),n;if(e===6)Qu(r,i);else{if(s=r.current.alternate,!(i&30)&&!$oe(s)&&(e=pT(r,i),e===2&&(o=R2(r),o!==0&&(i=o,e=iO(r,o))),e===1))throw n=gx,Kf(r,0),Qu(r,i),to(r,Rr()),n;switch(r.finishedWork=s,r.finishedLanes=i,e){case 0:case 1:throw Error(Be(345));case 2:_f(r,Gs,xc);break;case 3:if(Qu(r,i),(i&130023424)===i&&(e=JI+500-Rr(),10<e)){if(Y1(r,0)!==0)break;if(s=r.suspendedLanes,(s&i)!==i){Os(),r.pingedLanes|=r.suspendedLanes&s;break}r.timeoutHandle=B2(_f.bind(null,r,Gs,xc),e);break}_f(r,Gs,xc);break;case 4:if(Qu(r,i),(i&4194240)===i)break;for(e=r.eventTimes,s=-1;0<i;){var a=31-Za(i);o=1<<a,a=e[a],a>s&&(s=a),i&=~o}if(i=s,i=Rr()-i,i=(120>i?120:480>i?480:1080>i?1080:1920>i?1920:3e3>i?3e3:4320>i?4320:1960*zoe(i/1960))-i,10<i){r.timeoutHandle=B2(_f.bind(null,r,Gs,xc),i);break}_f(r,Gs,xc);break;case 5:_f(r,Gs,xc);break;default:throw Error(Be(329))}}}return to(r,Rr()),r.callbackNode===n?Q7.bind(null,r):null}function iO(r,e){var n=w0;return r.current.memoizedState.isDehydrated&&(Kf(r,e).flags|=256),r=pT(r,e),r!==2&&(e=Gs,Gs=n,e!==null&&sO(e)),r}function sO(r){Gs===null?Gs=r:Gs.push.apply(Gs,r)}function $oe(r){for(var e=r;;){if(e.flags&16384){var n=e.updateQueue;if(n!==null&&(n=n.stores,n!==null))for(var i=0;i<n.length;i++){var s=n[i],o=s.getSnapshot;s=s.value;try{if(!el(o(),s))return!1}catch{return!1}}}if(n=e.child,e.subtreeFlags&16384&&n!==null)n.return=e,e=n;else{if(e===r)break;for(;e.sibling===null;){if(e.return===null||e.return===r)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}function Qu(r,e){for(e&=~QI,e&=~SM,r.suspendedLanes|=e,r.pingedLanes&=~e,r=r.expirationTimes;0<e;){var n=31-Za(e),i=1<<n;r[n]=-1,e&=~i}}function iz(r){if(un&6)throw Error(Be(327));Tm();var e=Y1(r,0);if(!(e&1))return to(r,Rr()),null;var n=pT(r,e);if(r.tag!==0&&n===2){var i=R2(r);i!==0&&(e=i,n=iO(r,i))}if(n===1)throw n=gx,Kf(r,0),Qu(r,e),to(r,Rr()),n;if(n===6)throw Error(Be(345));return r.finishedWork=r.current.alternate,r.finishedLanes=e,_f(r,Gs,xc),to(r,Rr()),null}function eL(r,e){var n=un;un|=1;try{return r(e)}finally{un=n,un===0&&(Xm=Rr()+500,xM&&Fh())}}function ud(r){ih!==null&&ih.tag===0&&!(un&6)&&Tm();var e=un;un|=1;var n=aa.transition,i=Mn;try{if(aa.transition=null,Mn=1,r)return r()}finally{Mn=i,aa.transition=n,un=e,!(un&6)&&Fh()}}function tL(){_o=Zp.current,er(Zp)}function Kf(r,e){r.finishedWork=null,r.finishedLanes=0;var n=r.timeoutHandle;if(n!==-1&&(r.timeoutHandle=-1,yoe(n)),Xr!==null)for(n=Xr.return;n!==null;){var i=n;switch(II(i),i.tag){case 1:i=i.type.childContextTypes,i!=null&&tT();break;case 3:Wm(),er(Js),er(ls),GI();break;case 5:VI(i);break;case 4:Wm();break;case 13:er(fr);break;case 19:er(fr);break;case 10:UI(i.type._context);break;case 22:case 23:tL()}n=n.return}if(Mi=r,Xr=r=mh(r.current,null),zi=_o=e,ai=0,gx=null,QI=SM=cd=0,Gs=w0=null,zf!==null){for(e=0;e<zf.length;e++)if(n=zf[e],i=n.interleaved,i!==null){n.interleaved=null;var s=i.next,o=n.pending;if(o!==null){var a=o.next;o.next=s,i.next=a}n.pending=i}zf=null}return r}function J7(r,e){do{var n=Xr;try{if(BI(),g1.current=uT,cT){for(var i=yr.memoizedState;i!==null;){var s=i.queue;s!==null&&(s.pending=null),i=i.next}cT=!1}if(ld=0,_i=oi=yr=null,b0=!1,dx=0,ZI.current=null,n===null||n.return===null){ai=1,gx=e,Xr=null;break}e:{var o=r,a=n.return,l=n,c=e;if(e=zi,l.flags|=32768,c!==null&&typeof c=="object"&&typeof c.then=="function"){var u=c,h=l,f=h.tag;if(!(h.mode&1)&&(f===0||f===11||f===15)){var d=h.alternate;d?(h.updateQueue=d.updateQueue,h.memoizedState=d.memoizedState,h.lanes=d.lanes):(h.updateQueue=null,h.memoizedState=null)}var p=HU(a);if(p!==null){p.flags&=-257,WU(p,a,l,o,e),p.mode&1&&GU(o,u,e),e=p,c=u;var m=e.updateQueue;if(m===null){var g=new Set;g.add(c),e.updateQueue=g}else m.add(c);break e}else{if(!(e&1)){GU(o,u,e),nL();break e}c=Error(Be(426))}}else if(sr&&l.mode&1){var v=HU(a);if(v!==null){!(v.flags&65536)&&(v.flags|=256),WU(v,a,l,o,e),LI(qm(c,l));break e}}o=c=qm(c,l),ai!==4&&(ai=2),w0===null?w0=[o]:w0.push(o),o=a;do{switch(o.tag){case 3:o.flags|=65536,e&=-e,o.lanes|=e;var y=L7(o,c,e);BU(o,y);break e;case 1:l=c;var x=o.type,b=o.stateNode;if(!(o.flags&128)&&(typeof x.getDerivedStateFromError=="function"||b!==null&&typeof b.componentDidCatch=="function"&&(dh===null||!dh.has(b)))){o.flags|=65536,e&=-e,o.lanes|=e;var w=F7(o,l,e);BU(o,w);break e}}o=o.return}while(o!==null)}nq(n)}catch(_){e=_,Xr===n&&n!==null&&(Xr=n=n.return);continue}break}while(!0)}function eq(){var r=hT.current;return hT.current=uT,r===null?uT:r}function nL(){(ai===0||ai===3||ai===2)&&(ai=4),Mi===null||!(cd&268435455)&&!(SM&268435455)||Qu(Mi,zi)}function pT(r,e){var n=un;un|=2;var i=eq();(Mi!==r||zi!==e)&&(xc=null,Kf(r,e));do try{joe();break}catch(s){J7(r,s)}while(!0);if(BI(),un=n,hT.current=i,Xr!==null)throw Error(Be(261));return Mi=null,zi=0,ai}function joe(){for(;Xr!==null;)tq(Xr)}function Voe(){for(;Xr!==null&&!pse();)tq(Xr)}function tq(r){var e=iq(r.alternate,r,_o);r.memoizedProps=r.pendingProps,e===null?nq(r):Xr=e,ZI.current=null}function nq(r){var e=r;do{var n=e.alternate;if(r=e.return,e.flags&32768){if(n=Loe(n,e),n!==null){n.flags&=32767,Xr=n;return}if(r!==null)r.flags|=32768,r.subtreeFlags=0,r.deletions=null;else{ai=6,Xr=null;return}}else if(n=Ioe(n,e,_o),n!==null){Xr=n;return}if(e=e.sibling,e!==null){Xr=e;return}Xr=e=r}while(e!==null);ai===0&&(ai=5)}function _f(r,e,n){var i=Mn,s=aa.transition;try{aa.transition=null,Mn=1,Goe(r,e,n,i)}finally{aa.transition=s,Mn=i}return null}function Goe(r,e,n,i){do Tm();while(ih!==null);if(un&6)throw Error(Be(327));n=r.finishedWork;var s=r.finishedLanes;if(n===null)return null;if(r.finishedWork=null,r.finishedLanes=0,n===r.current)throw Error(Be(177));r.callbackNode=null,r.callbackPriority=0;var o=n.lanes|n.childLanes;if(Tse(r,o),r===Mi&&(Xr=Mi=null,zi=0),!(n.subtreeFlags&2064)&&!(n.flags&2064)||fw||(fw=!0,sq(K1,function(){return Tm(),null})),o=(n.flags&15990)!==0,n.subtreeFlags&15990||o){o=aa.transition,aa.transition=null;var a=Mn;Mn=1;var l=un;un|=4,ZI.current=null,Boe(r,n),Y7(n,r),uoe(L2),Z1=!!I2,L2=I2=null,r.current=n,Uoe(n),mse(),un=l,Mn=a,aa.transition=o}else r.current=n;if(fw&&(fw=!1,ih=r,dT=s),o=r.pendingLanes,o===0&&(dh=null),vse(n.stateNode),to(r,Rr()),e!==null)for(i=r.onRecoverableError,n=0;n<e.length;n++)s=e[n],i(s.value,{componentStack:s.stack,digest:s.digest});if(fT)throw fT=!1,r=nO,nO=null,r;return dT&1&&r.tag!==0&&Tm(),o=r.pendingLanes,o&1?r===rO?S0++:(S0=0,rO=r):S0=0,Fh(),null}function Tm(){if(ih!==null){var r=L9(dT),e=aa.transition,n=Mn;try{if(aa.transition=null,Mn=16>r?16:r,ih===null)var i=!1;else{if(r=ih,ih=null,dT=0,un&6)throw Error(Be(331));var s=un;for(un|=4,it=r.current;it!==null;){var o=it,a=o.child;if(it.flags&16){var l=o.deletions;if(l!==null){for(var c=0;c<l.length;c++){var u=l[c];for(it=u;it!==null;){var h=it;switch(h.tag){case 0:case 11:case 15:_0(8,h,o)}var f=h.child;if(f!==null)f.return=h,it=f;else for(;it!==null;){h=it;var d=h.sibling,p=h.return;if(q7(h),h===u){it=null;break}if(d!==null){d.return=p,it=d;break}it=p}}}var m=o.alternate;if(m!==null){var g=m.child;if(g!==null){m.child=null;do{var v=g.sibling;g.sibling=null,g=v}while(g!==null)}}it=o}}if(o.subtreeFlags&2064&&a!==null)a.return=o,it=a;else e:for(;it!==null;){if(o=it,o.flags&2048)switch(o.tag){case 0:case 11:case 15:_0(9,o,o.return)}var y=o.sibling;if(y!==null){y.return=o.return,it=y;break e}it=o.return}}var x=r.current;for(it=x;it!==null;){a=it;var b=a.child;if(a.subtreeFlags&2064&&b!==null)b.return=a,it=b;else e:for(a=x;it!==null;){if(l=it,l.flags&2048)try{switch(l.tag){case 0:case 11:case 15:wM(9,l)}}catch(_){_r(l,l.return,_)}if(l===a){it=null;break e}var w=l.sibling;if(w!==null){w.return=l.return,it=w;break e}it=l.return}}if(un=s,Fh(),Cl&&typeof Cl.onPostCommitFiberRoot=="function")try{Cl.onPostCommitFiberRoot(pM,r)}catch{}i=!0}return i}finally{Mn=n,aa.transition=e}}return!1}function sz(r,e,n){e=qm(n,e),e=L7(r,e,1),r=fh(r,e,1),e=Os(),r!==null&&(Xb(r,1,e),to(r,e))}function _r(r,e,n){if(r.tag===3)sz(r,r,n);else for(;e!==null;){if(e.tag===3){sz(e,r,n);break}else if(e.tag===1){var i=e.stateNode;if(typeof e.type.getDerivedStateFromError=="function"||typeof i.componentDidCatch=="function"&&(dh===null||!dh.has(i))){r=qm(n,r),r=F7(e,r,1),e=fh(e,r,1),r=Os(),e!==null&&(Xb(e,1,r),to(e,r));break}}e=e.return}}function Hoe(r,e,n){var i=r.pingCache;i!==null&&i.delete(e),e=Os(),r.pingedLanes|=r.suspendedLanes&n,Mi===r&&(zi&n)===n&&(ai===4||ai===3&&(zi&130023424)===zi&&500>Rr()-JI?Kf(r,0):QI|=n),to(r,e)}function rq(r,e){e===0&&(r.mode&1?(e=nw,nw<<=1,!(nw&130023424)&&(nw=4194304)):e=1);var n=Os();r=ru(r,e),r!==null&&(Xb(r,e,n),to(r,n))}function Woe(r){var e=r.memoizedState,n=0;e!==null&&(n=e.retryLane),rq(r,n)}function qoe(r,e){var n=0;switch(r.tag){case 13:var i=r.stateNode,s=r.memoizedState;s!==null&&(n=s.retryLane);break;case 19:i=r.stateNode;break;default:throw Error(Be(314))}i!==null&&i.delete(e),rq(r,n)}var iq;iq=function(r,e,n){if(r!==null)if(r.memoizedProps!==e.pendingProps||Js.current)Xs=!0;else{if(!(r.lanes&n)&&!(e.flags&128))return Xs=!1,koe(r,e,n);Xs=!!(r.flags&131072)}else Xs=!1,sr&&e.flags&1048576&&l7(e,iT,e.index);switch(e.lanes=0,e.tag){case 2:var i=e.type;v1(r,e),r=e.pendingProps;var s=Vm(e,ls.current);Sm(e,n),s=WI(null,e,i,r,s,n);var o=qI();return e.flags|=1,typeof s=="object"&&s!==null&&typeof s.render=="function"&&s.$$typeof===void 0?(e.tag=1,e.memoizedState=null,e.updateQueue=null,eo(i)?(o=!0,nT(e)):o=!1,e.memoizedState=s.state!==null&&s.state!==void 0?s.state:null,$I(e),s.updater=_M,e.stateNode=s,s._reactInternals=e,H2(e,i,r,n),e=X2(null,e,i,!0,o,n)):(e.tag=0,sr&&o&&kI(e),bs(null,e,s,n),e=e.child),e;case 16:i=e.elementType;e:{switch(v1(r,e),r=e.pendingProps,s=i._init,i=s(i._payload),e.type=i,s=e.tag=Koe(i),r=Da(i,r),s){case 0:e=q2(null,e,i,r,n);break e;case 1:e=KU(null,e,i,r,n);break e;case 11:e=qU(null,e,i,r,n);break e;case 14:e=XU(null,e,i,Da(i.type,r),n);break e}throw Error(Be(306,i,""))}return e;case 0:return i=e.type,s=e.pendingProps,s=e.elementType===i?s:Da(i,s),q2(r,e,i,s,n);case 1:return i=e.type,s=e.pendingProps,s=e.elementType===i?s:Da(i,s),KU(r,e,i,s,n);case 3:e:{if($7(e),r===null)throw Error(Be(387));i=e.pendingProps,o=e.memoizedState,s=o.element,p7(r,e),aT(e,i,null,n);var a=e.memoizedState;if(i=a.element,o.isDehydrated)if(o={element:i,isDehydrated:!1,cache:a.cache,pendingSuspenseBoundaries:a.pendingSuspenseBoundaries,transitions:a.transitions},e.updateQueue.baseState=o,e.memoizedState=o,e.flags&256){s=qm(Error(Be(423)),e),e=YU(r,e,i,n,s);break e}else if(i!==s){s=qm(Error(Be(424)),e),e=YU(r,e,i,n,s);break e}else for(Ao=hh(e.stateNode.containerInfo.firstChild),Co=e,sr=!0,za=null,n=f7(e,null,i,n),e.child=n;n;)n.flags=n.flags&-3|4096,n=n.sibling;else{if(Gm(),i===s){e=iu(r,e,n);break e}bs(r,e,i,n)}e=e.child}return e;case 5:return m7(e),r===null&&j2(e),i=e.type,s=e.pendingProps,o=r!==null?r.memoizedProps:null,a=s.children,F2(i,s)?a=null:o!==null&&F2(i,o)&&(e.flags|=32),z7(r,e),bs(r,e,a,n),e.child;case 6:return r===null&&j2(e),null;case 13:return j7(r,e,n);case 4:return jI(e,e.stateNode.containerInfo),i=e.pendingProps,r===null?e.child=Hm(e,null,i,n):bs(r,e,i,n),e.child;case 11:return i=e.type,s=e.pendingProps,s=e.elementType===i?s:Da(i,s),qU(r,e,i,s,n);case 7:return bs(r,e,e.pendingProps,n),e.child;case 8:return bs(r,e,e.pendingProps.children,n),e.child;case 12:return bs(r,e,e.pendingProps.children,n),e.child;case 10:e:{if(i=e.type._context,s=e.pendingProps,o=e.memoizedProps,a=s.value,$n(sT,i._currentValue),i._currentValue=a,o!==null)if(el(o.value,a)){if(o.children===s.children&&!Js.current){e=iu(r,e,n);break e}}else for(o=e.child,o!==null&&(o.return=e);o!==null;){var l=o.dependencies;if(l!==null){a=o.child;for(var c=l.firstContext;c!==null;){if(c.context===i){if(o.tag===1){c=$c(-1,n&-n),c.tag=2;var u=o.updateQueue;if(u!==null){u=u.shared;var h=u.pending;h===null?c.next=c:(c.next=h.next,h.next=c),u.pending=c}}o.lanes|=n,c=o.alternate,c!==null&&(c.lanes|=n),V2(o.return,n,e),l.lanes|=n;break}c=c.next}}else if(o.tag===10)a=o.type===e.type?null:o.child;else if(o.tag===18){if(a=o.return,a===null)throw Error(Be(341));a.lanes|=n,l=a.alternate,l!==null&&(l.lanes|=n),V2(a,n,e),a=o.sibling}else a=o.child;if(a!==null)a.return=o;else for(a=o;a!==null;){if(a===e){a=null;break}if(o=a.sibling,o!==null){o.return=a.return,a=o;break}a=a.return}o=a}bs(r,e,s.children,n),e=e.child}return e;case 9:return s=e.type,i=e.pendingProps.children,Sm(e,n),s=ha(s),i=i(s),e.flags|=1,bs(r,e,i,n),e.child;case 14:return i=e.type,s=Da(i,e.pendingProps),s=Da(i.type,s),XU(r,e,i,s,n);case 15:return B7(r,e,e.type,e.pendingProps,n);case 17:return i=e.type,s=e.pendingProps,s=e.elementType===i?s:Da(i,s),v1(r,e),e.tag=1,eo(i)?(r=!0,nT(e)):r=!1,Sm(e,n),I7(e,i,s),H2(e,i,s,n),X2(null,e,i,!0,r,n);case 19:return V7(r,e,n);case 22:return U7(r,e,n)}throw Error(Be(156,e.tag))};function sq(r,e){return O9(r,e)}function Xoe(r,e,n,i){this.tag=r,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=i,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function ia(r,e,n,i){return new Xoe(r,e,n,i)}function rL(r){return r=r.prototype,!(!r||!r.isReactComponent)}function Koe(r){if(typeof r=="function")return rL(r)?1:0;if(r!=null){if(r=r.$$typeof,r===wI)return 11;if(r===SI)return 14}return 2}function mh(r,e){var n=r.alternate;return n===null?(n=ia(r.tag,e,r.key,r.mode),n.elementType=r.elementType,n.type=r.type,n.stateNode=r.stateNode,n.alternate=r,r.alternate=n):(n.pendingProps=e,n.type=r.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=r.flags&14680064,n.childLanes=r.childLanes,n.lanes=r.lanes,n.child=r.child,n.memoizedProps=r.memoizedProps,n.memoizedState=r.memoizedState,n.updateQueue=r.updateQueue,e=r.dependencies,n.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext},n.sibling=r.sibling,n.index=r.index,n.ref=r.ref,n}function _1(r,e,n,i,s,o){var a=2;if(i=r,typeof r=="function")rL(r)&&(a=1);else if(typeof r=="string")a=5;else e:switch(r){case $p:return Yf(n.children,s,o,e);case _I:a=8,s|=8;break;case m2:return r=ia(12,n,e,s|2),r.elementType=m2,r.lanes=o,r;case g2:return r=ia(13,n,e,s),r.elementType=g2,r.lanes=o,r;case y2:return r=ia(19,n,e,s),r.elementType=y2,r.lanes=o,r;case m9:return TM(n,s,o,e);default:if(typeof r=="object"&&r!==null)switch(r.$$typeof){case d9:a=10;break e;case p9:a=9;break e;case wI:a=11;break e;case SI:a=14;break e;case qu:a=16,i=null;break e}throw Error(Be(130,r==null?r:typeof r,""))}return e=ia(a,n,e,s),e.elementType=r,e.type=i,e.lanes=o,e}function Yf(r,e,n,i){return r=ia(7,r,i,e),r.lanes=n,r}function TM(r,e,n,i){return r=ia(22,r,i,e),r.elementType=m9,r.lanes=n,r.stateNode={isHidden:!1},r}function XC(r,e,n){return r=ia(6,r,null,e),r.lanes=n,r}function KC(r,e,n){return e=ia(4,r.children!==null?r.children:[],r.key,e),e.lanes=n,e.stateNode={containerInfo:r.containerInfo,pendingChildren:null,implementation:r.implementation},e}function Yoe(r,e,n,i,s){this.tag=e,this.containerInfo=r,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=PC(0),this.expirationTimes=PC(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=PC(0),this.identifierPrefix=i,this.onRecoverableError=s,this.mutableSourceEagerHydrationData=null}function iL(r,e,n,i,s,o,a,l,c){return r=new Yoe(r,e,n,l,c),e===1?(e=1,o===!0&&(e|=8)):e=0,o=ia(3,null,null,e),r.current=o,o.stateNode=r,o.memoizedState={element:i,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},$I(o),r}function Zoe(r,e,n){var i=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:zp,key:i==null?null:""+i,children:r,containerInfo:e,implementation:n}}function oq(r){if(!r)return Th;r=r._reactInternals;e:{if(Cd(r)!==r||r.tag!==1)throw Error(Be(170));var e=r;do{switch(e.tag){case 3:e=e.stateNode.context;break e;case 1:if(eo(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break e}}e=e.return}while(e!==null);throw Error(Be(171))}if(r.tag===1){var n=r.type;if(eo(n))return o7(r,n,e)}return e}function aq(r,e,n,i,s,o,a,l,c){return r=iL(n,i,!0,r,s,o,a,l,c),r.context=oq(null),n=r.current,i=Os(),s=ph(n),o=$c(i,s),o.callback=e??null,fh(n,o,s),r.current.lanes=s,Xb(r,s,i),to(r,i),r}function EM(r,e,n,i){var s=e.current,o=Os(),a=ph(s);return n=oq(n),e.context===null?e.context=n:e.pendingContext=n,e=$c(o,a),e.payload={element:r},i=i===void 0?null:i,i!==null&&(e.callback=i),r=fh(s,e,a),r!==null&&(Qa(r,s,a,o),m1(r,s,a)),a}function mT(r){if(r=r.current,!r.child)return null;switch(r.child.tag){case 5:return r.child.stateNode;default:return r.child.stateNode}}function oz(r,e){if(r=r.memoizedState,r!==null&&r.dehydrated!==null){var n=r.retryLane;r.retryLane=n!==0&&n<e?n:e}}function sL(r,e){oz(r,e),(r=r.alternate)&&oz(r,e)}function Qoe(){return null}var lq=typeof reportError=="function"?reportError:function(r){console.error(r)};function oL(r){this._internalRoot=r}MM.prototype.render=oL.prototype.render=function(r){var e=this._internalRoot;if(e===null)throw Error(Be(409));EM(r,e,null,null)};MM.prototype.unmount=oL.prototype.unmount=function(){var r=this._internalRoot;if(r!==null){this._internalRoot=null;var e=r.containerInfo;ud(function(){EM(null,r,null,null)}),e[nu]=null}};function MM(r){this._internalRoot=r}MM.prototype.unstable_scheduleHydration=function(r){if(r){var e=U9();r={blockedOn:null,target:r,priority:e};for(var n=0;n<Zu.length&&e!==0&&e<Zu[n].priority;n++);Zu.splice(n,0,r),n===0&&$9(r)}};function aL(r){return!(!r||r.nodeType!==1&&r.nodeType!==9&&r.nodeType!==11)}function AM(r){return!(!r||r.nodeType!==1&&r.nodeType!==9&&r.nodeType!==11&&(r.nodeType!==8||r.nodeValue!==" react-mount-point-unstable "))}function az(){}function Joe(r,e,n,i,s){if(s){if(typeof i=="function"){var o=i;i=function(){var u=mT(a);o.call(u)}}var a=aq(e,i,r,0,null,!1,!1,"",az);return r._reactRootContainer=a,r[nu]=a.current,lx(r.nodeType===8?r.parentNode:r),ud(),a}for(;s=r.lastChild;)r.removeChild(s);if(typeof i=="function"){var l=i;i=function(){var u=mT(c);l.call(u)}}var c=iL(r,0,!1,null,null,!1,!1,"",az);return r._reactRootContainer=c,r[nu]=c.current,lx(r.nodeType===8?r.parentNode:r),ud(function(){EM(e,c,n,i)}),c}function CM(r,e,n,i,s){var o=n._reactRootContainer;if(o){var a=o;if(typeof s=="function"){var l=s;s=function(){var c=mT(a);l.call(c)}}EM(e,a,r,s)}else a=Joe(n,e,r,s,i);return mT(a)}F9=function(r){switch(r.tag){case 3:var e=r.stateNode;if(e.current.memoizedState.isDehydrated){var n=Qv(e.pendingLanes);n!==0&&(MI(e,n|1),to(e,Rr()),!(un&6)&&(Xm=Rr()+500,Fh()))}break;case 13:ud(function(){var i=ru(r,1);if(i!==null){var s=Os();Qa(i,r,1,s)}}),sL(r,1)}};AI=function(r){if(r.tag===13){var e=ru(r,134217728);if(e!==null){var n=Os();Qa(e,r,134217728,n)}sL(r,134217728)}};B9=function(r){if(r.tag===13){var e=ph(r),n=ru(r,e);if(n!==null){var i=Os();Qa(n,r,e,i)}sL(r,e)}};U9=function(){return Mn};z9=function(r,e){var n=Mn;try{return Mn=r,e()}finally{Mn=n}};A2=function(r,e,n){switch(e){case"input":if(b2(r,n),e=n.name,n.type==="radio"&&e!=null){for(n=r;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<n.length;e++){var i=n[e];if(i!==r&&i.form===r.form){var s=vM(i);if(!s)throw Error(Be(90));y9(i),b2(i,s)}}}break;case"textarea":x9(r,n);break;case"select":e=n.value,e!=null&&xm(r,!!n.multiple,e,!1)}};M9=eL;A9=ud;var eae={usingClientEntryPoint:!1,Events:[Yb,Hp,vM,T9,E9,eL]},qy={findFiberByHostInstance:Uf,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},tae={bundleType:qy.bundleType,version:qy.version,rendererPackageName:qy.rendererPackageName,rendererConfig:qy.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:pu.ReactCurrentDispatcher,findHostInstanceByFiber:function(r){return r=R9(r),r===null?null:r.stateNode},findFiberByHostInstance:qy.findFiberByHostInstance||Qoe,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var dw=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!dw.isDisabled&&dw.supportsFiber)try{pM=dw.inject(tae),Cl=dw}catch{}}Bo.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=eae;Bo.createPortal=function(r,e){var n=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!aL(e))throw Error(Be(200));return Zoe(r,e,null,n)};Bo.createRoot=function(r,e){if(!aL(r))throw Error(Be(299));var n=!1,i="",s=lq;return e!=null&&(e.unstable_strictMode===!0&&(n=!0),e.identifierPrefix!==void 0&&(i=e.identifierPrefix),e.onRecoverableError!==void 0&&(s=e.onRecoverableError)),e=iL(r,1,!1,null,null,n,!1,i,s),r[nu]=e.current,lx(r.nodeType===8?r.parentNode:r),new oL(e)};Bo.findDOMNode=function(r){if(r==null)return null;if(r.nodeType===1)return r;var e=r._reactInternals;if(e===void 0)throw typeof r.render=="function"?Error(Be(188)):(r=Object.keys(r).join(","),Error(Be(268,r)));return r=R9(e),r=r===null?null:r.stateNode,r};Bo.flushSync=function(r){return ud(r)};Bo.hydrate=function(r,e,n){if(!AM(e))throw Error(Be(200));return CM(null,r,e,!0,n)};Bo.hydrateRoot=function(r,e,n){if(!aL(r))throw Error(Be(405));var i=n!=null&&n.hydratedSources||null,s=!1,o="",a=lq;if(n!=null&&(n.unstable_strictMode===!0&&(s=!0),n.identifierPrefix!==void 0&&(o=n.identifierPrefix),n.onRecoverableError!==void 0&&(a=n.onRecoverableError)),e=aq(e,null,r,1,n??null,s,!1,o,a),r[nu]=e.current,lx(r),i)for(r=0;r<i.length;r++)n=i[r],s=n._getVersion,s=s(n._source),e.mutableSourceEagerHydrationData==null?e.mutableSourceEagerHydrationData=[n,s]:e.mutableSourceEagerHydrationData.push(n,s);return new MM(e)};Bo.render=function(r,e,n){if(!AM(e))throw Error(Be(200));return CM(null,r,e,!1,n)};Bo.unmountComponentAtNode=function(r){if(!AM(r))throw Error(Be(40));return r._reactRootContainer?(ud(function(){CM(null,null,r,!1,function(){r._reactRootContainer=null,r[nu]=null})}),!0):!1};Bo.unstable_batchedUpdates=eL;Bo.unstable_renderSubtreeIntoContainer=function(r,e,n,i){if(!AM(n))throw Error(Be(200));if(r==null||r._reactInternals===void 0)throw Error(Be(38));return CM(r,e,n,!1,i)};Bo.version="18.3.1-next-f1338f8080-20240426";function cq(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(cq)}catch(r){console.error(r)}}cq(),c9.exports=Bo;var nae=c9.exports,uq,lz=nae;uq=lz.createRoot,lz.hydrateRoot;/**
 * @remix-run/router v1.23.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function yx(){return yx=Object.assign?Object.assign.bind():function(r){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(r[i]=n[i])}return r},yx.apply(this,arguments)}var sh;(function(r){r.Pop="POP",r.Push="PUSH",r.Replace="REPLACE"})(sh||(sh={}));const cz="popstate";function rae(r){r===void 0&&(r={});function e(i,s){let{pathname:o,search:a,hash:l}=i.location;return oO("",{pathname:o,search:a,hash:l},s.state&&s.state.usr||null,s.state&&s.state.key||"default")}function n(i,s){return typeof s=="string"?s:gT(s)}return sae(e,n,null,r)}function Yr(r,e){if(r===!1||r===null||typeof r>"u")throw new Error(e)}function hq(r,e){if(!r){typeof console<"u"&&console.warn(e);try{throw new Error(e)}catch{}}}function iae(){return Math.random().toString(36).substr(2,8)}function uz(r,e){return{usr:r.state,key:r.key,idx:e}}function oO(r,e,n,i){return n===void 0&&(n=null),yx({pathname:typeof r=="string"?r:r.pathname,search:"",hash:""},typeof e=="string"?sy(e):e,{state:n,key:e&&e.key||i||iae()})}function gT(r){let{pathname:e="/",search:n="",hash:i=""}=r;return n&&n!=="?"&&(e+=n.charAt(0)==="?"?n:"?"+n),i&&i!=="#"&&(e+=i.charAt(0)==="#"?i:"#"+i),e}function sy(r){let e={};if(r){let n=r.indexOf("#");n>=0&&(e.hash=r.substr(n),r=r.substr(0,n));let i=r.indexOf("?");i>=0&&(e.search=r.substr(i),r=r.substr(0,i)),r&&(e.pathname=r)}return e}function sae(r,e,n,i){i===void 0&&(i={});let{window:s=document.defaultView,v5Compat:o=!1}=i,a=s.history,l=sh.Pop,c=null,u=h();u==null&&(u=0,a.replaceState(yx({},a.state,{idx:u}),""));function h(){return(a.state||{idx:null}).idx}function f(){l=sh.Pop;let v=h(),y=v==null?null:v-u;u=v,c&&c({action:l,location:g.location,delta:y})}function d(v,y){l=sh.Push;let x=oO(g.location,v,y);u=h()+1;let b=uz(x,u),w=g.createHref(x);try{a.pushState(b,"",w)}catch(_){if(_ instanceof DOMException&&_.name==="DataCloneError")throw _;s.location.assign(w)}o&&c&&c({action:l,location:g.location,delta:1})}function p(v,y){l=sh.Replace;let x=oO(g.location,v,y);u=h();let b=uz(x,u),w=g.createHref(x);a.replaceState(b,"",w),o&&c&&c({action:l,location:g.location,delta:0})}function m(v){let y=s.location.origin!=="null"?s.location.origin:s.location.href,x=typeof v=="string"?v:gT(v);return x=x.replace(/ $/,"%20"),Yr(y,"No window.location.(origin|href) available to create URL for href: "+x),new URL(x,y)}let g={get action(){return l},get location(){return r(s,a)},listen(v){if(c)throw new Error("A history only accepts one active listener");return s.addEventListener(cz,f),c=v,()=>{s.removeEventListener(cz,f),c=null}},createHref(v){return e(s,v)},createURL:m,encodeLocation(v){let y=m(v);return{pathname:y.pathname,search:y.search,hash:y.hash}},push:d,replace:p,go(v){return a.go(v)}};return g}var hz;(function(r){r.data="data",r.deferred="deferred",r.redirect="redirect",r.error="error"})(hz||(hz={}));function oae(r,e,n){return n===void 0&&(n="/"),aae(r,e,n,!1)}function aae(r,e,n,i){let s=typeof e=="string"?sy(e):e,o=lL(s.pathname||"/",n);if(o==null)return null;let a=fq(r);lae(a);let l=null;for(let c=0;l==null&&c<a.length;++c){let u=xae(o);l=yae(a[c],u,i)}return l}function fq(r,e,n,i){e===void 0&&(e=[]),n===void 0&&(n=[]),i===void 0&&(i="");let s=(o,a,l)=>{let c={relativePath:l===void 0?o.path||"":l,caseSensitive:o.caseSensitive===!0,childrenIndex:a,route:o};c.relativePath.startsWith("/")&&(Yr(c.relativePath.startsWith(i),'Absolute route path "'+c.relativePath+'" nested under path '+('"'+i+'" is not valid. An absolute child route path ')+"must start with the combined path of all its parent routes."),c.relativePath=c.relativePath.slice(i.length));let u=gh([i,c.relativePath]),h=n.concat(c);o.children&&o.children.length>0&&(Yr(o.index!==!0,"Index routes must not have child routes. Please remove "+('all child routes from route path "'+u+'".')),fq(o.children,e,h,u)),!(o.path==null&&!o.index)&&e.push({path:u,score:mae(u,o.index),routesMeta:h})};return r.forEach((o,a)=>{var l;if(o.path===""||!((l=o.path)!=null&&l.includes("?")))s(o,a);else for(let c of dq(o.path))s(o,a,c)}),e}function dq(r){let e=r.split("/");if(e.length===0)return[];let[n,...i]=e,s=n.endsWith("?"),o=n.replace(/\?$/,"");if(i.length===0)return s?[o,""]:[o];let a=dq(i.join("/")),l=[];return l.push(...a.map(c=>c===""?o:[o,c].join("/"))),s&&l.push(...a),l.map(c=>r.startsWith("/")&&c===""?"/":c)}function lae(r){r.sort((e,n)=>e.score!==n.score?n.score-e.score:gae(e.routesMeta.map(i=>i.childrenIndex),n.routesMeta.map(i=>i.childrenIndex)))}const cae=/^:[\w-]+$/,uae=3,hae=2,fae=1,dae=10,pae=-2,fz=r=>r==="*";function mae(r,e){let n=r.split("/"),i=n.length;return n.some(fz)&&(i+=pae),e&&(i+=hae),n.filter(s=>!fz(s)).reduce((s,o)=>s+(cae.test(o)?uae:o===""?fae:dae),i)}function gae(r,e){return r.length===e.length&&r.slice(0,-1).every((i,s)=>i===e[s])?r[r.length-1]-e[e.length-1]:0}function yae(r,e,n){let{routesMeta:i}=r,s={},o="/",a=[];for(let l=0;l<i.length;++l){let c=i[l],u=l===i.length-1,h=o==="/"?e:e.slice(o.length)||"/",f=dz({path:c.relativePath,caseSensitive:c.caseSensitive,end:u},h),d=c.route;if(!f&&u&&n&&!i[i.length-1].route.index&&(f=dz({path:c.relativePath,caseSensitive:c.caseSensitive,end:!1},h)),!f)return null;Object.assign(s,f.params),a.push({params:s,pathname:gh([o,f.pathname]),pathnameBase:Sae(gh([o,f.pathnameBase])),route:d}),f.pathnameBase!=="/"&&(o=gh([o,f.pathnameBase]))}return a}function dz(r,e){typeof r=="string"&&(r={path:r,caseSensitive:!1,end:!0});let[n,i]=vae(r.path,r.caseSensitive,r.end),s=e.match(n);if(!s)return null;let o=s[0],a=o.replace(/(.)\/+$/,"$1"),l=s.slice(1);return{params:i.reduce((u,h,f)=>{let{paramName:d,isOptional:p}=h;if(d==="*"){let g=l[f]||"";a=o.slice(0,o.length-g.length).replace(/(.)\/+$/,"$1")}const m=l[f];return p&&!m?u[d]=void 0:u[d]=(m||"").replace(/%2F/g,"/"),u},{}),pathname:o,pathnameBase:a,pattern:r}}function vae(r,e,n){e===void 0&&(e=!1),n===void 0&&(n=!0),hq(r==="*"||!r.endsWith("*")||r.endsWith("/*"),'Route path "'+r+'" will be treated as if it were '+('"'+r.replace(/\*$/,"/*")+'" because the `*` character must ')+"always follow a `/` in the pattern. To get rid of this warning, "+('please change the route path to "'+r.replace(/\*$/,"/*")+'".'));let i=[],s="^"+r.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(a,l,c)=>(i.push({paramName:l,isOptional:c!=null}),c?"/?([^\\/]+)?":"/([^\\/]+)"));return r.endsWith("*")?(i.push({paramName:"*"}),s+=r==="*"||r==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):n?s+="\\/*$":r!==""&&r!=="/"&&(s+="(?:(?=\\/|$))"),[new RegExp(s,e?void 0:"i"),i]}function xae(r){try{return r.split("/").map(e=>decodeURIComponent(e).replace(/\//g,"%2F")).join("/")}catch(e){return hq(!1,'The URL path "'+r+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent '+("encoding ("+e+").")),r}}function lL(r,e){if(e==="/")return r;if(!r.toLowerCase().startsWith(e.toLowerCase()))return null;let n=e.endsWith("/")?e.length-1:e.length,i=r.charAt(n);return i&&i!=="/"?null:r.slice(n)||"/"}function bae(r,e){e===void 0&&(e="/");let{pathname:n,search:i="",hash:s=""}=typeof r=="string"?sy(r):r;return{pathname:n?n.startsWith("/")?n:_ae(n,e):e,search:Tae(i),hash:Eae(s)}}function _ae(r,e){let n=e.replace(/\/+$/,"").split("/");return r.split("/").forEach(s=>{s===".."?n.length>1&&n.pop():s!=="."&&n.push(s)}),n.length>1?n.join("/"):"/"}function YC(r,e,n,i){return"Cannot include a '"+r+"' character in a manually specified "+("`to."+e+"` field ["+JSON.stringify(i)+"].  Please separate it out to the ")+("`to."+n+"` field. Alternatively you may provide the full path as ")+'a string in <Link to="..."> and the router will parse it for you.'}function wae(r){return r.filter((e,n)=>n===0||e.route.path&&e.route.path.length>0)}function pq(r,e){let n=wae(r);return e?n.map((i,s)=>s===n.length-1?i.pathname:i.pathnameBase):n.map(i=>i.pathnameBase)}function mq(r,e,n,i){i===void 0&&(i=!1);let s;typeof r=="string"?s=sy(r):(s=yx({},r),Yr(!s.pathname||!s.pathname.includes("?"),YC("?","pathname","search",s)),Yr(!s.pathname||!s.pathname.includes("#"),YC("#","pathname","hash",s)),Yr(!s.search||!s.search.includes("#"),YC("#","search","hash",s)));let o=r===""||s.pathname==="",a=o?"/":s.pathname,l;if(a==null)l=n;else{let f=e.length-1;if(!i&&a.startsWith("..")){let d=a.split("/");for(;d[0]==="..";)d.shift(),f-=1;s.pathname=d.join("/")}l=f>=0?e[f]:"/"}let c=bae(s,l),u=a&&a!=="/"&&a.endsWith("/"),h=(o||a===".")&&n.endsWith("/");return!c.pathname.endsWith("/")&&(u||h)&&(c.pathname+="/"),c}const gh=r=>r.join("/").replace(/\/\/+/g,"/"),Sae=r=>r.replace(/\/+$/,"").replace(/^\/*/,"/"),Tae=r=>!r||r==="?"?"":r.startsWith("?")?r:"?"+r,Eae=r=>!r||r==="#"?"":r.startsWith("#")?r:"#"+r;function Mae(r){return r!=null&&typeof r.status=="number"&&typeof r.statusText=="string"&&typeof r.internal=="boolean"&&"data"in r}const gq=["post","put","patch","delete"];new Set(gq);const Aae=["get",...gq];new Set(Aae);/**
 * React Router v6.30.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function vx(){return vx=Object.assign?Object.assign.bind():function(r){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(r[i]=n[i])}return r},vx.apply(this,arguments)}const cL=te.createContext(null),Cae=te.createContext(null),Pd=te.createContext(null),PM=te.createContext(null),Rd=te.createContext({outlet:null,matches:[],isDataRoute:!1}),yq=te.createContext(null);function Pae(r,e){let{relative:n}=e===void 0?{}:e;Qb()||Yr(!1);let{basename:i,navigator:s}=te.useContext(Pd),{hash:o,pathname:a,search:l}=xq(r,{relative:n}),c=a;return i!=="/"&&(c=a==="/"?i:gh([i,a])),s.createHref({pathname:c,search:l,hash:o})}function Qb(){return te.useContext(PM)!=null}function Jb(){return Qb()||Yr(!1),te.useContext(PM).location}function vq(r){te.useContext(Pd).static||te.useLayoutEffect(r)}function oy(){let{isDataRoute:r}=te.useContext(Rd);return r?jae():Rae()}function Rae(){Qb()||Yr(!1);let r=te.useContext(cL),{basename:e,future:n,navigator:i}=te.useContext(Pd),{matches:s}=te.useContext(Rd),{pathname:o}=Jb(),a=JSON.stringify(pq(s,n.v7_relativeSplatPath)),l=te.useRef(!1);return vq(()=>{l.current=!0}),te.useCallback(function(u,h){if(h===void 0&&(h={}),!l.current)return;if(typeof u=="number"){i.go(u);return}let f=mq(u,JSON.parse(a),o,h.relative==="path");r==null&&e!=="/"&&(f.pathname=f.pathname==="/"?e:gh([e,f.pathname])),(h.replace?i.replace:i.push)(f,h.state,h)},[e,i,a,o,r])}function xq(r,e){let{relative:n}=e===void 0?{}:e,{future:i}=te.useContext(Pd),{matches:s}=te.useContext(Rd),{pathname:o}=Jb(),a=JSON.stringify(pq(s,i.v7_relativeSplatPath));return te.useMemo(()=>mq(r,JSON.parse(a),o,n==="path"),[r,a,o,n])}function Nae(r,e){return Oae(r,e)}function Oae(r,e,n,i){Qb()||Yr(!1);let{navigator:s}=te.useContext(Pd),{matches:o}=te.useContext(Rd),a=o[o.length-1],l=a?a.params:{};a&&a.pathname;let c=a?a.pathnameBase:"/";a&&a.route;let u=Jb(),h;if(e){var f;let v=typeof e=="string"?sy(e):e;c==="/"||(f=v.pathname)!=null&&f.startsWith(c)||Yr(!1),h=v}else h=u;let d=h.pathname||"/",p=d;if(c!=="/"){let v=c.replace(/^\//,"").split("/");p="/"+d.replace(/^\//,"").split("/").slice(v.length).join("/")}let m=oae(r,{pathname:p}),g=Fae(m&&m.map(v=>Object.assign({},v,{params:Object.assign({},l,v.params),pathname:gh([c,s.encodeLocation?s.encodeLocation(v.pathname).pathname:v.pathname]),pathnameBase:v.pathnameBase==="/"?c:gh([c,s.encodeLocation?s.encodeLocation(v.pathnameBase).pathname:v.pathnameBase])})),o,n,i);return e&&g?te.createElement(PM.Provider,{value:{location:vx({pathname:"/",search:"",hash:"",state:null,key:"default"},h),navigationType:sh.Pop}},g):g}function Dae(){let r=$ae(),e=Mae(r)?r.status+" "+r.statusText:r instanceof Error?r.message:JSON.stringify(r),n=r instanceof Error?r.stack:null,s={padding:"0.5rem",backgroundColor:"rgba(200,200,200, 0.5)"};return te.createElement(te.Fragment,null,te.createElement("h2",null,"Unexpected Application Error!"),te.createElement("h3",{style:{fontStyle:"italic"}},e),n?te.createElement("pre",{style:s},n):null,null)}const kae=te.createElement(Dae,null);class Iae extends te.Component{constructor(e){super(e),this.state={location:e.location,revalidation:e.revalidation,error:e.error}}static getDerivedStateFromError(e){return{error:e}}static getDerivedStateFromProps(e,n){return n.location!==e.location||n.revalidation!=="idle"&&e.revalidation==="idle"?{error:e.error,location:e.location,revalidation:e.revalidation}:{error:e.error!==void 0?e.error:n.error,location:n.location,revalidation:e.revalidation||n.revalidation}}componentDidCatch(e,n){console.error("React Router caught the following error during render",e,n)}render(){return this.state.error!==void 0?te.createElement(Rd.Provider,{value:this.props.routeContext},te.createElement(yq.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function Lae(r){let{routeContext:e,match:n,children:i}=r,s=te.useContext(cL);return s&&s.static&&s.staticContext&&(n.route.errorElement||n.route.ErrorBoundary)&&(s.staticContext._deepestRenderedBoundaryId=n.route.id),te.createElement(Rd.Provider,{value:e},i)}function Fae(r,e,n,i){var s;if(e===void 0&&(e=[]),n===void 0&&(n=null),i===void 0&&(i=null),r==null){var o;if(!n)return null;if(n.errors)r=n.matches;else if((o=i)!=null&&o.v7_partialHydration&&e.length===0&&!n.initialized&&n.matches.length>0)r=n.matches;else return null}let a=r,l=(s=n)==null?void 0:s.errors;if(l!=null){let h=a.findIndex(f=>f.route.id&&(l==null?void 0:l[f.route.id])!==void 0);h>=0||Yr(!1),a=a.slice(0,Math.min(a.length,h+1))}let c=!1,u=-1;if(n&&i&&i.v7_partialHydration)for(let h=0;h<a.length;h++){let f=a[h];if((f.route.HydrateFallback||f.route.hydrateFallbackElement)&&(u=h),f.route.id){let{loaderData:d,errors:p}=n,m=f.route.loader&&d[f.route.id]===void 0&&(!p||p[f.route.id]===void 0);if(f.route.lazy||m){c=!0,u>=0?a=a.slice(0,u+1):a=[a[0]];break}}}return a.reduceRight((h,f,d)=>{let p,m=!1,g=null,v=null;n&&(p=l&&f.route.id?l[f.route.id]:void 0,g=f.route.errorElement||kae,c&&(u<0&&d===0?(m=!0,v=null):u===d&&(m=!0,v=f.route.hydrateFallbackElement||null)));let y=e.concat(a.slice(0,d+1)),x=()=>{let b;return p?b=g:m?b=v:f.route.Component?b=te.createElement(f.route.Component,null):f.route.element?b=f.route.element:b=h,te.createElement(Lae,{match:f,routeContext:{outlet:h,matches:y,isDataRoute:n!=null},children:b})};return n&&(f.route.ErrorBoundary||f.route.errorElement||d===0)?te.createElement(Iae,{location:n.location,revalidation:n.revalidation,component:g,error:p,children:x(),routeContext:{outlet:null,matches:y,isDataRoute:!0}}):x()},null)}var bq=function(r){return r.UseBlocker="useBlocker",r.UseRevalidator="useRevalidator",r.UseNavigateStable="useNavigate",r}(bq||{}),yT=function(r){return r.UseBlocker="useBlocker",r.UseLoaderData="useLoaderData",r.UseActionData="useActionData",r.UseRouteError="useRouteError",r.UseNavigation="useNavigation",r.UseRouteLoaderData="useRouteLoaderData",r.UseMatches="useMatches",r.UseRevalidator="useRevalidator",r.UseNavigateStable="useNavigate",r.UseRouteId="useRouteId",r}(yT||{});function Bae(r){let e=te.useContext(cL);return e||Yr(!1),e}function Uae(r){let e=te.useContext(Cae);return e||Yr(!1),e}function zae(r){let e=te.useContext(Rd);return e||Yr(!1),e}function _q(r){let e=zae(),n=e.matches[e.matches.length-1];return n.route.id||Yr(!1),n.route.id}function $ae(){var r;let e=te.useContext(yq),n=Uae(yT.UseRouteError),i=_q(yT.UseRouteError);return e!==void 0?e:(r=n.errors)==null?void 0:r[i]}function jae(){let{router:r}=Bae(bq.UseNavigateStable),e=_q(yT.UseNavigateStable),n=te.useRef(!1);return vq(()=>{n.current=!0}),te.useCallback(function(s,o){o===void 0&&(o={}),n.current&&(typeof s=="number"?r.navigate(s):r.navigate(s,vx({fromRouteId:e},o)))},[r,e])}function Vae(r,e){r==null||r.v7_startTransition,r==null||r.v7_relativeSplatPath}function Fp(r){Yr(!1)}function Gae(r){let{basename:e="/",children:n=null,location:i,navigationType:s=sh.Pop,navigator:o,static:a=!1,future:l}=r;Qb()&&Yr(!1);let c=e.replace(/^\/*/,"/"),u=te.useMemo(()=>({basename:c,navigator:o,static:a,future:vx({v7_relativeSplatPath:!1},l)}),[c,l,o,a]);typeof i=="string"&&(i=sy(i));let{pathname:h="/",search:f="",hash:d="",state:p=null,key:m="default"}=i,g=te.useMemo(()=>{let v=lL(h,c);return v==null?null:{location:{pathname:v,search:f,hash:d,state:p,key:m},navigationType:s}},[c,h,f,d,p,m,s]);return g==null?null:te.createElement(Pd.Provider,{value:u},te.createElement(PM.Provider,{children:n,value:g}))}function Hae(r){let{children:e,location:n}=r;return Nae(aO(e),n)}new Promise(()=>{});function aO(r,e){e===void 0&&(e=[]);let n=[];return te.Children.forEach(r,(i,s)=>{if(!te.isValidElement(i))return;let o=[...e,s];if(i.type===te.Fragment){n.push.apply(n,aO(i.props.children,o));return}i.type!==Fp&&Yr(!1),!i.props.index||!i.props.children||Yr(!1);let a={id:i.props.id||o.join("-"),caseSensitive:i.props.caseSensitive,element:i.props.element,Component:i.props.Component,index:i.props.index,path:i.props.path,loader:i.props.loader,action:i.props.action,errorElement:i.props.errorElement,ErrorBoundary:i.props.ErrorBoundary,hasErrorBoundary:i.props.ErrorBoundary!=null||i.props.errorElement!=null,shouldRevalidate:i.props.shouldRevalidate,handle:i.props.handle,lazy:i.props.lazy};i.props.children&&(a.children=aO(i.props.children,o)),n.push(a)}),n}/**
 * React Router DOM v6.30.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function lO(){return lO=Object.assign?Object.assign.bind():function(r){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(r[i]=n[i])}return r},lO.apply(this,arguments)}function Wae(r,e){if(r==null)return{};var n={},i=Object.keys(r),s,o;for(o=0;o<i.length;o++)s=i[o],!(e.indexOf(s)>=0)&&(n[s]=r[s]);return n}function qae(r){return!!(r.metaKey||r.altKey||r.ctrlKey||r.shiftKey)}function Xae(r,e){return r.button===0&&(!e||e==="_self")&&!qae(r)}const Kae=["onClick","relative","reloadDocument","replace","state","target","to","preventScrollReset","viewTransition"],Yae="6";try{window.__reactRouterVersion=Yae}catch{}const Zae="startTransition",pz=Hie[Zae];function Qae(r){let{basename:e,children:n,future:i,window:s}=r,o=te.useRef();o.current==null&&(o.current=rae({window:s,v5Compat:!0}));let a=o.current,[l,c]=te.useState({action:a.action,location:a.location}),{v7_startTransition:u}=i||{},h=te.useCallback(f=>{u&&pz?pz(()=>c(f)):c(f)},[c,u]);return te.useLayoutEffect(()=>a.listen(h),[a,h]),te.useEffect(()=>Vae(i),[i]),te.createElement(Gae,{basename:e,children:n,location:l.location,navigationType:l.action,navigator:a,future:i})}const Jae=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",ele=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,wq=te.forwardRef(function(e,n){let{onClick:i,relative:s,reloadDocument:o,replace:a,state:l,target:c,to:u,preventScrollReset:h,viewTransition:f}=e,d=Wae(e,Kae),{basename:p}=te.useContext(Pd),m,g=!1;if(typeof u=="string"&&ele.test(u)&&(m=u,Jae))try{let b=new URL(window.location.href),w=u.startsWith("//")?new URL(b.protocol+u):new URL(u),_=lL(w.pathname,p);w.origin===b.origin&&_!=null?u=_+w.search+w.hash:g=!0}catch{}let v=Pae(u,{relative:s}),y=tle(u,{replace:a,state:l,target:c,preventScrollReset:h,relative:s,viewTransition:f});function x(b){i&&i(b),b.defaultPrevented||y(b)}return te.createElement("a",lO({},d,{href:m||v,onClick:g||o?i:x,ref:n,target:c}))});var mz;(function(r){r.UseScrollRestoration="useScrollRestoration",r.UseSubmit="useSubmit",r.UseSubmitFetcher="useSubmitFetcher",r.UseFetcher="useFetcher",r.useViewTransitionState="useViewTransitionState"})(mz||(mz={}));var gz;(function(r){r.UseFetcher="useFetcher",r.UseFetchers="useFetchers",r.UseScrollRestoration="useScrollRestoration"})(gz||(gz={}));function tle(r,e){let{target:n,replace:i,state:s,preventScrollReset:o,relative:a,viewTransition:l}=e===void 0?{}:e,c=oy(),u=Jb(),h=xq(r,{relative:a});return te.useCallback(f=>{if(Xae(f,n)){f.preventDefault();let d=i!==void 0?i:gT(u)===gT(h);c(r,{replace:d,state:s,preventScrollReset:o,relative:a,viewTransition:l})}},[u,c,h,i,s,n,r,o,a,l])}/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var nle={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const rle=r=>r.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase().trim(),e_=(r,e)=>{const n=te.forwardRef(({color:i="currentColor",size:s=24,strokeWidth:o=2,absoluteStrokeWidth:a,className:l="",children:c,...u},h)=>te.createElement("svg",{ref:h,...nle,width:s,height:s,stroke:i,strokeWidth:a?Number(o)*24/Number(s):o,className:["lucide",`lucide-${rle(r)}`,l].join(" "),...u},[...e.map(([f,d])=>te.createElement(f,d)),...Array.isArray(c)?c:[c]]));return n.displayName=`${r}`,n};/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Sq=e_("Activity",[["path",{d:"M22 12h-4l-3 9L9 3l-3 9H2",key:"d5dnw9"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ile=e_("BarChart3",[["path",{d:"M3 3v18h18",key:"1s2lah"}],["path",{d:"M18 17V9",key:"2bz60n"}],["path",{d:"M13 17V5",key:"1frdt8"}],["path",{d:"M8 17v-3",key:"17ska0"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const sle=e_("FileText",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Tq=e_("Settings",[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ole=e_("User",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]]),ale={BASE_URL:"/",DEV:!1,MODE:"production",PROD:!0,SSR:!1},yz=r=>{let e;const n=new Set,i=(h,f)=>{const d=typeof h=="function"?h(e):h;if(!Object.is(d,e)){const p=e;e=f??(typeof d!="object"||d===null)?d:Object.assign({},e,d),n.forEach(m=>m(e,p))}},s=()=>e,c={setState:i,getState:s,getInitialState:()=>u,subscribe:h=>(n.add(h),()=>n.delete(h)),destroy:()=>{(ale?"production":void 0)!=="production"&&console.warn("[DEPRECATED] The `destroy` method will be unsupported in a future version. Instead use unsubscribe function returned by subscribe. Everything will be garbage-collected if store is garbage-collected."),n.clear()}},u=e=r(i,s,c);return c},lle=r=>r?yz(r):yz;var Eq={exports:{}},Mq={},Aq={exports:{}},Cq={};/**
 * @license React
 * use-sync-external-store-shim.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Km=te;function cle(r,e){return r===e&&(r!==0||1/r===1/e)||r!==r&&e!==e}var ule=typeof Object.is=="function"?Object.is:cle,hle=Km.useState,fle=Km.useEffect,dle=Km.useLayoutEffect,ple=Km.useDebugValue;function mle(r,e){var n=e(),i=hle({inst:{value:n,getSnapshot:e}}),s=i[0].inst,o=i[1];return dle(function(){s.value=n,s.getSnapshot=e,ZC(s)&&o({inst:s})},[r,n,e]),fle(function(){return ZC(s)&&o({inst:s}),r(function(){ZC(s)&&o({inst:s})})},[r]),ple(n),n}function ZC(r){var e=r.getSnapshot;r=r.value;try{var n=e();return!ule(r,n)}catch{return!0}}function gle(r,e){return e()}var yle=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?gle:mle;Cq.useSyncExternalStore=Km.useSyncExternalStore!==void 0?Km.useSyncExternalStore:yle;Aq.exports=Cq;var vle=Aq.exports;/**
 * @license React
 * use-sync-external-store-shim/with-selector.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var RM=te,xle=vle;function ble(r,e){return r===e&&(r!==0||1/r===1/e)||r!==r&&e!==e}var _le=typeof Object.is=="function"?Object.is:ble,wle=xle.useSyncExternalStore,Sle=RM.useRef,Tle=RM.useEffect,Ele=RM.useMemo,Mle=RM.useDebugValue;Mq.useSyncExternalStoreWithSelector=function(r,e,n,i,s){var o=Sle(null);if(o.current===null){var a={hasValue:!1,value:null};o.current=a}else a=o.current;o=Ele(function(){function c(p){if(!u){if(u=!0,h=p,p=i(p),s!==void 0&&a.hasValue){var m=a.value;if(s(m,p))return f=m}return f=p}if(m=f,_le(h,p))return m;var g=i(p);return s!==void 0&&s(m,g)?(h=p,m):(h=p,f=g)}var u=!1,h,f,d=n===void 0?null:n;return[function(){return c(e())},d===null?void 0:function(){return c(d())}]},[e,n,i,s]);var l=wle(r,o[0],o[1]);return Tle(function(){a.hasValue=!0,a.value=l},[l]),Mle(l),l};Eq.exports=Mq;var Ale=Eq.exports;const Cle=hn(Ale),Pq={BASE_URL:"/",DEV:!1,MODE:"production",PROD:!0,SSR:!1},{useDebugValue:Ple}=Z,{useSyncExternalStoreWithSelector:Rle}=Cle;let vz=!1;const Nle=r=>r;function Ole(r,e=Nle,n){(Pq?"production":void 0)!=="production"&&n&&!vz&&(console.warn("[DEPRECATED] Use `createWithEqualityFn` instead of `create` or use `useStoreWithEqualityFn` instead of `useStore`. They can be imported from 'zustand/traditional'. https://github.com/pmndrs/zustand/discussions/1937"),vz=!0);const i=Rle(r.subscribe,r.getState,r.getServerState||r.getInitialState,e,n);return Ple(i),i}const xz=r=>{(Pq?"production":void 0)!=="production"&&typeof r!="function"&&console.warn("[DEPRECATED] Passing a vanilla store will be unsupported in a future version. Instead use `import { useStore } from 'zustand'`.");const e=typeof r=="function"?lle(r):r,n=(i,s)=>Ole(e,i,s);return Object.assign(n,e),n},Dle=r=>r?xz(r):xz;function Rq(r){var e,n,i="";if(typeof r=="string"||typeof r=="number")i+=r;else if(typeof r=="object")if(Array.isArray(r)){var s=r.length;for(e=0;e<s;e++)r[e]&&(n=Rq(r[e]))&&(i&&(i+=" "),i+=n)}else for(n in r)r[n]&&(i&&(i+=" "),i+=n);return i}function qt(){for(var r,e,n=0,i="",s=arguments.length;n<s;n++)(r=arguments[n])&&(e=Rq(r))&&(i&&(i+=" "),i+=e);return i}const uL="-",kle=r=>{const e=Lle(r),{conflictingClassGroups:n,conflictingClassGroupModifiers:i}=r;return{getClassGroupId:a=>{const l=a.split(uL);return l[0]===""&&l.length!==1&&l.shift(),Nq(l,e)||Ile(a)},getConflictingClassGroupIds:(a,l)=>{const c=n[a]||[];return l&&i[a]?[...c,...i[a]]:c}}},Nq=(r,e)=>{var a;if(r.length===0)return e.classGroupId;const n=r[0],i=e.nextPart.get(n),s=i?Nq(r.slice(1),i):void 0;if(s)return s;if(e.validators.length===0)return;const o=r.join(uL);return(a=e.validators.find(({validator:l})=>l(o)))==null?void 0:a.classGroupId},bz=/^\[(.+)\]$/,Ile=r=>{if(bz.test(r)){const e=bz.exec(r)[1],n=e==null?void 0:e.substring(0,e.indexOf(":"));if(n)return"arbitrary.."+n}},Lle=r=>{const{theme:e,prefix:n}=r,i={nextPart:new Map,validators:[]};return Ble(Object.entries(r.classGroups),n).forEach(([o,a])=>{cO(a,i,o,e)}),i},cO=(r,e,n,i)=>{r.forEach(s=>{if(typeof s=="string"){const o=s===""?e:_z(e,s);o.classGroupId=n;return}if(typeof s=="function"){if(Fle(s)){cO(s(i),e,n,i);return}e.validators.push({validator:s,classGroupId:n});return}Object.entries(s).forEach(([o,a])=>{cO(a,_z(e,o),n,i)})})},_z=(r,e)=>{let n=r;return e.split(uL).forEach(i=>{n.nextPart.has(i)||n.nextPart.set(i,{nextPart:new Map,validators:[]}),n=n.nextPart.get(i)}),n},Fle=r=>r.isThemeGetter,Ble=(r,e)=>e?r.map(([n,i])=>{const s=i.map(o=>typeof o=="string"?e+o:typeof o=="object"?Object.fromEntries(Object.entries(o).map(([a,l])=>[e+a,l])):o);return[n,s]}):r,Ule=r=>{if(r<1)return{get:()=>{},set:()=>{}};let e=0,n=new Map,i=new Map;const s=(o,a)=>{n.set(o,a),e++,e>r&&(e=0,i=n,n=new Map)};return{get(o){let a=n.get(o);if(a!==void 0)return a;if((a=i.get(o))!==void 0)return s(o,a),a},set(o,a){n.has(o)?n.set(o,a):s(o,a)}}},Oq="!",zle=r=>{const{separator:e,experimentalParseClassName:n}=r,i=e.length===1,s=e[0],o=e.length,a=l=>{const c=[];let u=0,h=0,f;for(let v=0;v<l.length;v++){let y=l[v];if(u===0){if(y===s&&(i||l.slice(v,v+o)===e)){c.push(l.slice(h,v)),h=v+o;continue}if(y==="/"){f=v;continue}}y==="["?u++:y==="]"&&u--}const d=c.length===0?l:l.substring(h),p=d.startsWith(Oq),m=p?d.substring(1):d,g=f&&f>h?f-h:void 0;return{modifiers:c,hasImportantModifier:p,baseClassName:m,maybePostfixModifierPosition:g}};return n?l=>n({className:l,parseClassName:a}):a},$le=r=>{if(r.length<=1)return r;const e=[];let n=[];return r.forEach(i=>{i[0]==="["?(e.push(...n.sort(),i),n=[]):n.push(i)}),e.push(...n.sort()),e},jle=r=>({cache:Ule(r.cacheSize),parseClassName:zle(r),...kle(r)}),Vle=/\s+/,Gle=(r,e)=>{const{parseClassName:n,getClassGroupId:i,getConflictingClassGroupIds:s}=e,o=[],a=r.trim().split(Vle);let l="";for(let c=a.length-1;c>=0;c-=1){const u=a[c],{modifiers:h,hasImportantModifier:f,baseClassName:d,maybePostfixModifierPosition:p}=n(u);let m=!!p,g=i(m?d.substring(0,p):d);if(!g){if(!m){l=u+(l.length>0?" "+l:l);continue}if(g=i(d),!g){l=u+(l.length>0?" "+l:l);continue}m=!1}const v=$le(h).join(":"),y=f?v+Oq:v,x=y+g;if(o.includes(x))continue;o.push(x);const b=s(g,m);for(let w=0;w<b.length;++w){const _=b[w];o.push(y+_)}l=u+(l.length>0?" "+l:l)}return l};function Hle(){let r=0,e,n,i="";for(;r<arguments.length;)(e=arguments[r++])&&(n=Dq(e))&&(i&&(i+=" "),i+=n);return i}const Dq=r=>{if(typeof r=="string")return r;let e,n="";for(let i=0;i<r.length;i++)r[i]&&(e=Dq(r[i]))&&(n&&(n+=" "),n+=e);return n};function Wle(r,...e){let n,i,s,o=a;function a(c){const u=e.reduce((h,f)=>f(h),r());return n=jle(u),i=n.cache.get,s=n.cache.set,o=l,l(c)}function l(c){const u=i(c);if(u)return u;const h=Gle(c,n);return s(c,h),h}return function(){return o(Hle.apply(null,arguments))}}const Gn=r=>{const e=n=>n[r]||[];return e.isThemeGetter=!0,e},kq=/^\[(?:([a-z-]+):)?(.+)\]$/i,qle=/^\d+\/\d+$/,Xle=new Set(["px","full","screen"]),Kle=/^(\d+(\.\d+)?)?(xs|sm|md|lg|xl)$/,Yle=/\d+(%|px|r?em|[sdl]?v([hwib]|min|max)|pt|pc|in|cm|mm|cap|ch|ex|r?lh|cq(w|h|i|b|min|max))|\b(calc|min|max|clamp)\(.+\)|^0$/,Zle=/^(rgba?|hsla?|hwb|(ok)?(lab|lch))\(.+\)$/,Qle=/^(inset_)?-?((\d+)?\.?(\d+)[a-z]+|0)_-?((\d+)?\.?(\d+)[a-z]+|0)/,Jle=/^(url|image|image-set|cross-fade|element|(repeating-)?(linear|radial|conic)-gradient)\(.+\)$/,Ql=r=>Em(r)||Xle.has(r)||qle.test(r),Tu=r=>ay(r,"length",ace),Em=r=>!!r&&!Number.isNaN(Number(r)),QC=r=>ay(r,"number",Em),Xy=r=>!!r&&Number.isInteger(Number(r)),ece=r=>r.endsWith("%")&&Em(r.slice(0,-1)),Kt=r=>kq.test(r),Eu=r=>Kle.test(r),tce=new Set(["length","size","percentage"]),nce=r=>ay(r,tce,Iq),rce=r=>ay(r,"position",Iq),ice=new Set(["image","url"]),sce=r=>ay(r,ice,cce),oce=r=>ay(r,"",lce),Ky=()=>!0,ay=(r,e,n)=>{const i=kq.exec(r);return i?i[1]?typeof e=="string"?i[1]===e:e.has(i[1]):n(i[2]):!1},ace=r=>Yle.test(r)&&!Zle.test(r),Iq=()=>!1,lce=r=>Qle.test(r),cce=r=>Jle.test(r),uce=()=>{const r=Gn("colors"),e=Gn("spacing"),n=Gn("blur"),i=Gn("brightness"),s=Gn("borderColor"),o=Gn("borderRadius"),a=Gn("borderSpacing"),l=Gn("borderWidth"),c=Gn("contrast"),u=Gn("grayscale"),h=Gn("hueRotate"),f=Gn("invert"),d=Gn("gap"),p=Gn("gradientColorStops"),m=Gn("gradientColorStopPositions"),g=Gn("inset"),v=Gn("margin"),y=Gn("opacity"),x=Gn("padding"),b=Gn("saturate"),w=Gn("scale"),_=Gn("sepia"),S=Gn("skew"),T=Gn("space"),E=Gn("translate"),M=()=>["auto","contain","none"],A=()=>["auto","hidden","clip","visible","scroll"],P=()=>["auto",Kt,e],D=()=>[Kt,e],B=()=>["",Ql,Tu],C=()=>["auto",Em,Kt],O=()=>["bottom","center","left","left-bottom","left-top","right","right-bottom","right-top","top"],R=()=>["solid","dashed","dotted","double","none"],z=()=>["normal","multiply","screen","overlay","darken","lighten","color-dodge","color-burn","hard-light","soft-light","difference","exclusion","hue","saturation","color","luminosity"],U=()=>["start","end","center","between","around","evenly","stretch"],G=()=>["","0",Kt],H=()=>["auto","avoid","all","avoid-page","page","left","right","column"],Y=()=>[Em,Kt];return{cacheSize:500,separator:":",theme:{colors:[Ky],spacing:[Ql,Tu],blur:["none","",Eu,Kt],brightness:Y(),borderColor:[r],borderRadius:["none","","full",Eu,Kt],borderSpacing:D(),borderWidth:B(),contrast:Y(),grayscale:G(),hueRotate:Y(),invert:G(),gap:D(),gradientColorStops:[r],gradientColorStopPositions:[ece,Tu],inset:P(),margin:P(),opacity:Y(),padding:D(),saturate:Y(),scale:Y(),sepia:G(),skew:Y(),space:D(),translate:D()},classGroups:{aspect:[{aspect:["auto","square","video",Kt]}],container:["container"],columns:[{columns:[Eu]}],"break-after":[{"break-after":H()}],"break-before":[{"break-before":H()}],"break-inside":[{"break-inside":["auto","avoid","avoid-page","avoid-column"]}],"box-decoration":[{"box-decoration":["slice","clone"]}],box:[{box:["border","content"]}],display:["block","inline-block","inline","flex","inline-flex","table","inline-table","table-caption","table-cell","table-column","table-column-group","table-footer-group","table-header-group","table-row-group","table-row","flow-root","grid","inline-grid","contents","list-item","hidden"],float:[{float:["right","left","none","start","end"]}],clear:[{clear:["left","right","both","none","start","end"]}],isolation:["isolate","isolation-auto"],"object-fit":[{object:["contain","cover","fill","none","scale-down"]}],"object-position":[{object:[...O(),Kt]}],overflow:[{overflow:A()}],"overflow-x":[{"overflow-x":A()}],"overflow-y":[{"overflow-y":A()}],overscroll:[{overscroll:M()}],"overscroll-x":[{"overscroll-x":M()}],"overscroll-y":[{"overscroll-y":M()}],position:["static","fixed","absolute","relative","sticky"],inset:[{inset:[g]}],"inset-x":[{"inset-x":[g]}],"inset-y":[{"inset-y":[g]}],start:[{start:[g]}],end:[{end:[g]}],top:[{top:[g]}],right:[{right:[g]}],bottom:[{bottom:[g]}],left:[{left:[g]}],visibility:["visible","invisible","collapse"],z:[{z:["auto",Xy,Kt]}],basis:[{basis:P()}],"flex-direction":[{flex:["row","row-reverse","col","col-reverse"]}],"flex-wrap":[{flex:["wrap","wrap-reverse","nowrap"]}],flex:[{flex:["1","auto","initial","none",Kt]}],grow:[{grow:G()}],shrink:[{shrink:G()}],order:[{order:["first","last","none",Xy,Kt]}],"grid-cols":[{"grid-cols":[Ky]}],"col-start-end":[{col:["auto",{span:["full",Xy,Kt]},Kt]}],"col-start":[{"col-start":C()}],"col-end":[{"col-end":C()}],"grid-rows":[{"grid-rows":[Ky]}],"row-start-end":[{row:["auto",{span:[Xy,Kt]},Kt]}],"row-start":[{"row-start":C()}],"row-end":[{"row-end":C()}],"grid-flow":[{"grid-flow":["row","col","dense","row-dense","col-dense"]}],"auto-cols":[{"auto-cols":["auto","min","max","fr",Kt]}],"auto-rows":[{"auto-rows":["auto","min","max","fr",Kt]}],gap:[{gap:[d]}],"gap-x":[{"gap-x":[d]}],"gap-y":[{"gap-y":[d]}],"justify-content":[{justify:["normal",...U()]}],"justify-items":[{"justify-items":["start","end","center","stretch"]}],"justify-self":[{"justify-self":["auto","start","end","center","stretch"]}],"align-content":[{content:["normal",...U(),"baseline"]}],"align-items":[{items:["start","end","center","baseline","stretch"]}],"align-self":[{self:["auto","start","end","center","stretch","baseline"]}],"place-content":[{"place-content":[...U(),"baseline"]}],"place-items":[{"place-items":["start","end","center","baseline","stretch"]}],"place-self":[{"place-self":["auto","start","end","center","stretch"]}],p:[{p:[x]}],px:[{px:[x]}],py:[{py:[x]}],ps:[{ps:[x]}],pe:[{pe:[x]}],pt:[{pt:[x]}],pr:[{pr:[x]}],pb:[{pb:[x]}],pl:[{pl:[x]}],m:[{m:[v]}],mx:[{mx:[v]}],my:[{my:[v]}],ms:[{ms:[v]}],me:[{me:[v]}],mt:[{mt:[v]}],mr:[{mr:[v]}],mb:[{mb:[v]}],ml:[{ml:[v]}],"space-x":[{"space-x":[T]}],"space-x-reverse":["space-x-reverse"],"space-y":[{"space-y":[T]}],"space-y-reverse":["space-y-reverse"],w:[{w:["auto","min","max","fit","svw","lvw","dvw",Kt,e]}],"min-w":[{"min-w":[Kt,e,"min","max","fit"]}],"max-w":[{"max-w":[Kt,e,"none","full","min","max","fit","prose",{screen:[Eu]},Eu]}],h:[{h:[Kt,e,"auto","min","max","fit","svh","lvh","dvh"]}],"min-h":[{"min-h":[Kt,e,"min","max","fit","svh","lvh","dvh"]}],"max-h":[{"max-h":[Kt,e,"min","max","fit","svh","lvh","dvh"]}],size:[{size:[Kt,e,"auto","min","max","fit"]}],"font-size":[{text:["base",Eu,Tu]}],"font-smoothing":["antialiased","subpixel-antialiased"],"font-style":["italic","not-italic"],"font-weight":[{font:["thin","extralight","light","normal","medium","semibold","bold","extrabold","black",QC]}],"font-family":[{font:[Ky]}],"fvn-normal":["normal-nums"],"fvn-ordinal":["ordinal"],"fvn-slashed-zero":["slashed-zero"],"fvn-figure":["lining-nums","oldstyle-nums"],"fvn-spacing":["proportional-nums","tabular-nums"],"fvn-fraction":["diagonal-fractions","stacked-fractions"],tracking:[{tracking:["tighter","tight","normal","wide","wider","widest",Kt]}],"line-clamp":[{"line-clamp":["none",Em,QC]}],leading:[{leading:["none","tight","snug","normal","relaxed","loose",Ql,Kt]}],"list-image":[{"list-image":["none",Kt]}],"list-style-type":[{list:["none","disc","decimal",Kt]}],"list-style-position":[{list:["inside","outside"]}],"placeholder-color":[{placeholder:[r]}],"placeholder-opacity":[{"placeholder-opacity":[y]}],"text-alignment":[{text:["left","center","right","justify","start","end"]}],"text-color":[{text:[r]}],"text-opacity":[{"text-opacity":[y]}],"text-decoration":["underline","overline","line-through","no-underline"],"text-decoration-style":[{decoration:[...R(),"wavy"]}],"text-decoration-thickness":[{decoration:["auto","from-font",Ql,Tu]}],"underline-offset":[{"underline-offset":["auto",Ql,Kt]}],"text-decoration-color":[{decoration:[r]}],"text-transform":["uppercase","lowercase","capitalize","normal-case"],"text-overflow":["truncate","text-ellipsis","text-clip"],"text-wrap":[{text:["wrap","nowrap","balance","pretty"]}],indent:[{indent:D()}],"vertical-align":[{align:["baseline","top","middle","bottom","text-top","text-bottom","sub","super",Kt]}],whitespace:[{whitespace:["normal","nowrap","pre","pre-line","pre-wrap","break-spaces"]}],break:[{break:["normal","words","all","keep"]}],hyphens:[{hyphens:["none","manual","auto"]}],content:[{content:["none",Kt]}],"bg-attachment":[{bg:["fixed","local","scroll"]}],"bg-clip":[{"bg-clip":["border","padding","content","text"]}],"bg-opacity":[{"bg-opacity":[y]}],"bg-origin":[{"bg-origin":["border","padding","content"]}],"bg-position":[{bg:[...O(),rce]}],"bg-repeat":[{bg:["no-repeat",{repeat:["","x","y","round","space"]}]}],"bg-size":[{bg:["auto","cover","contain",nce]}],"bg-image":[{bg:["none",{"gradient-to":["t","tr","r","br","b","bl","l","tl"]},sce]}],"bg-color":[{bg:[r]}],"gradient-from-pos":[{from:[m]}],"gradient-via-pos":[{via:[m]}],"gradient-to-pos":[{to:[m]}],"gradient-from":[{from:[p]}],"gradient-via":[{via:[p]}],"gradient-to":[{to:[p]}],rounded:[{rounded:[o]}],"rounded-s":[{"rounded-s":[o]}],"rounded-e":[{"rounded-e":[o]}],"rounded-t":[{"rounded-t":[o]}],"rounded-r":[{"rounded-r":[o]}],"rounded-b":[{"rounded-b":[o]}],"rounded-l":[{"rounded-l":[o]}],"rounded-ss":[{"rounded-ss":[o]}],"rounded-se":[{"rounded-se":[o]}],"rounded-ee":[{"rounded-ee":[o]}],"rounded-es":[{"rounded-es":[o]}],"rounded-tl":[{"rounded-tl":[o]}],"rounded-tr":[{"rounded-tr":[o]}],"rounded-br":[{"rounded-br":[o]}],"rounded-bl":[{"rounded-bl":[o]}],"border-w":[{border:[l]}],"border-w-x":[{"border-x":[l]}],"border-w-y":[{"border-y":[l]}],"border-w-s":[{"border-s":[l]}],"border-w-e":[{"border-e":[l]}],"border-w-t":[{"border-t":[l]}],"border-w-r":[{"border-r":[l]}],"border-w-b":[{"border-b":[l]}],"border-w-l":[{"border-l":[l]}],"border-opacity":[{"border-opacity":[y]}],"border-style":[{border:[...R(),"hidden"]}],"divide-x":[{"divide-x":[l]}],"divide-x-reverse":["divide-x-reverse"],"divide-y":[{"divide-y":[l]}],"divide-y-reverse":["divide-y-reverse"],"divide-opacity":[{"divide-opacity":[y]}],"divide-style":[{divide:R()}],"border-color":[{border:[s]}],"border-color-x":[{"border-x":[s]}],"border-color-y":[{"border-y":[s]}],"border-color-s":[{"border-s":[s]}],"border-color-e":[{"border-e":[s]}],"border-color-t":[{"border-t":[s]}],"border-color-r":[{"border-r":[s]}],"border-color-b":[{"border-b":[s]}],"border-color-l":[{"border-l":[s]}],"divide-color":[{divide:[s]}],"outline-style":[{outline:["",...R()]}],"outline-offset":[{"outline-offset":[Ql,Kt]}],"outline-w":[{outline:[Ql,Tu]}],"outline-color":[{outline:[r]}],"ring-w":[{ring:B()}],"ring-w-inset":["ring-inset"],"ring-color":[{ring:[r]}],"ring-opacity":[{"ring-opacity":[y]}],"ring-offset-w":[{"ring-offset":[Ql,Tu]}],"ring-offset-color":[{"ring-offset":[r]}],shadow:[{shadow:["","inner","none",Eu,oce]}],"shadow-color":[{shadow:[Ky]}],opacity:[{opacity:[y]}],"mix-blend":[{"mix-blend":[...z(),"plus-lighter","plus-darker"]}],"bg-blend":[{"bg-blend":z()}],filter:[{filter:["","none"]}],blur:[{blur:[n]}],brightness:[{brightness:[i]}],contrast:[{contrast:[c]}],"drop-shadow":[{"drop-shadow":["","none",Eu,Kt]}],grayscale:[{grayscale:[u]}],"hue-rotate":[{"hue-rotate":[h]}],invert:[{invert:[f]}],saturate:[{saturate:[b]}],sepia:[{sepia:[_]}],"backdrop-filter":[{"backdrop-filter":["","none"]}],"backdrop-blur":[{"backdrop-blur":[n]}],"backdrop-brightness":[{"backdrop-brightness":[i]}],"backdrop-contrast":[{"backdrop-contrast":[c]}],"backdrop-grayscale":[{"backdrop-grayscale":[u]}],"backdrop-hue-rotate":[{"backdrop-hue-rotate":[h]}],"backdrop-invert":[{"backdrop-invert":[f]}],"backdrop-opacity":[{"backdrop-opacity":[y]}],"backdrop-saturate":[{"backdrop-saturate":[b]}],"backdrop-sepia":[{"backdrop-sepia":[_]}],"border-collapse":[{border:["collapse","separate"]}],"border-spacing":[{"border-spacing":[a]}],"border-spacing-x":[{"border-spacing-x":[a]}],"border-spacing-y":[{"border-spacing-y":[a]}],"table-layout":[{table:["auto","fixed"]}],caption:[{caption:["top","bottom"]}],transition:[{transition:["none","all","","colors","opacity","shadow","transform",Kt]}],duration:[{duration:Y()}],ease:[{ease:["linear","in","out","in-out",Kt]}],delay:[{delay:Y()}],animate:[{animate:["none","spin","ping","pulse","bounce",Kt]}],transform:[{transform:["","gpu","none"]}],scale:[{scale:[w]}],"scale-x":[{"scale-x":[w]}],"scale-y":[{"scale-y":[w]}],rotate:[{rotate:[Xy,Kt]}],"translate-x":[{"translate-x":[E]}],"translate-y":[{"translate-y":[E]}],"skew-x":[{"skew-x":[S]}],"skew-y":[{"skew-y":[S]}],"transform-origin":[{origin:["center","top","top-right","right","bottom-right","bottom","bottom-left","left","top-left",Kt]}],accent:[{accent:["auto",r]}],appearance:[{appearance:["none","auto"]}],cursor:[{cursor:["auto","default","pointer","wait","text","move","help","not-allowed","none","context-menu","progress","cell","crosshair","vertical-text","alias","copy","no-drop","grab","grabbing","all-scroll","col-resize","row-resize","n-resize","e-resize","s-resize","w-resize","ne-resize","nw-resize","se-resize","sw-resize","ew-resize","ns-resize","nesw-resize","nwse-resize","zoom-in","zoom-out",Kt]}],"caret-color":[{caret:[r]}],"pointer-events":[{"pointer-events":["none","auto"]}],resize:[{resize:["none","y","x",""]}],"scroll-behavior":[{scroll:["auto","smooth"]}],"scroll-m":[{"scroll-m":D()}],"scroll-mx":[{"scroll-mx":D()}],"scroll-my":[{"scroll-my":D()}],"scroll-ms":[{"scroll-ms":D()}],"scroll-me":[{"scroll-me":D()}],"scroll-mt":[{"scroll-mt":D()}],"scroll-mr":[{"scroll-mr":D()}],"scroll-mb":[{"scroll-mb":D()}],"scroll-ml":[{"scroll-ml":D()}],"scroll-p":[{"scroll-p":D()}],"scroll-px":[{"scroll-px":D()}],"scroll-py":[{"scroll-py":D()}],"scroll-ps":[{"scroll-ps":D()}],"scroll-pe":[{"scroll-pe":D()}],"scroll-pt":[{"scroll-pt":D()}],"scroll-pr":[{"scroll-pr":D()}],"scroll-pb":[{"scroll-pb":D()}],"scroll-pl":[{"scroll-pl":D()}],"snap-align":[{snap:["start","end","center","align-none"]}],"snap-stop":[{snap:["normal","always"]}],"snap-type":[{snap:["none","x","y","both"]}],"snap-strictness":[{snap:["mandatory","proximity"]}],touch:[{touch:["auto","none","manipulation"]}],"touch-x":[{"touch-pan":["x","left","right"]}],"touch-y":[{"touch-pan":["y","up","down"]}],"touch-pz":["touch-pinch-zoom"],select:[{select:["none","text","all","auto"]}],"will-change":[{"will-change":["auto","scroll","contents","transform",Kt]}],fill:[{fill:[r,"none"]}],"stroke-w":[{stroke:[Ql,Tu,QC]}],stroke:[{stroke:[r,"none"]}],sr:["sr-only","not-sr-only"],"forced-color-adjust":[{"forced-color-adjust":["auto","none"]}]},conflictingClassGroups:{overflow:["overflow-x","overflow-y"],overscroll:["overscroll-x","overscroll-y"],inset:["inset-x","inset-y","start","end","top","right","bottom","left"],"inset-x":["right","left"],"inset-y":["top","bottom"],flex:["basis","grow","shrink"],gap:["gap-x","gap-y"],p:["px","py","ps","pe","pt","pr","pb","pl"],px:["pr","pl"],py:["pt","pb"],m:["mx","my","ms","me","mt","mr","mb","ml"],mx:["mr","ml"],my:["mt","mb"],size:["w","h"],"font-size":["leading"],"fvn-normal":["fvn-ordinal","fvn-slashed-zero","fvn-figure","fvn-spacing","fvn-fraction"],"fvn-ordinal":["fvn-normal"],"fvn-slashed-zero":["fvn-normal"],"fvn-figure":["fvn-normal"],"fvn-spacing":["fvn-normal"],"fvn-fraction":["fvn-normal"],"line-clamp":["display","overflow"],rounded:["rounded-s","rounded-e","rounded-t","rounded-r","rounded-b","rounded-l","rounded-ss","rounded-se","rounded-ee","rounded-es","rounded-tl","rounded-tr","rounded-br","rounded-bl"],"rounded-s":["rounded-ss","rounded-es"],"rounded-e":["rounded-se","rounded-ee"],"rounded-t":["rounded-tl","rounded-tr"],"rounded-r":["rounded-tr","rounded-br"],"rounded-b":["rounded-br","rounded-bl"],"rounded-l":["rounded-tl","rounded-bl"],"border-spacing":["border-spacing-x","border-spacing-y"],"border-w":["border-w-s","border-w-e","border-w-t","border-w-r","border-w-b","border-w-l"],"border-w-x":["border-w-r","border-w-l"],"border-w-y":["border-w-t","border-w-b"],"border-color":["border-color-s","border-color-e","border-color-t","border-color-r","border-color-b","border-color-l"],"border-color-x":["border-color-r","border-color-l"],"border-color-y":["border-color-t","border-color-b"],"scroll-m":["scroll-mx","scroll-my","scroll-ms","scroll-me","scroll-mt","scroll-mr","scroll-mb","scroll-ml"],"scroll-mx":["scroll-mr","scroll-ml"],"scroll-my":["scroll-mt","scroll-mb"],"scroll-p":["scroll-px","scroll-py","scroll-ps","scroll-pe","scroll-pt","scroll-pr","scroll-pb","scroll-pl"],"scroll-px":["scroll-pr","scroll-pl"],"scroll-py":["scroll-pt","scroll-pb"],touch:["touch-x","touch-y","touch-pz"],"touch-x":["touch"],"touch-y":["touch"],"touch-pz":["touch"]},conflictingClassGroupModifiers:{"font-size":["leading"]}}},hce=Wle(uce);function Vl(...r){return hce(qt(r))}function ys(){return Math.random().toString(36).substring(2,9)}const fce={Strategy:"#3B82F6",Structure:"#10B981",Systems:"#F59E0B","Shared Values":"#8B5CF6",Skills:"#EC4899",Style:"#EF4444",Staff:"#6366F1"};function Zf(r){return fce[r]||"#64748B"}function pw(r){if(r.length===0)return 0;const e=r.reduce((n,i)=>n+i,0);return Math.round(e/r.length*100)/100}function dce(r){return r.toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"})}const pce={strategy:{corporateLevel:"Stability",businessLevel:"Cost Leadership",functionalLevel:"Operational Excellence",alignmentScore:0},structure:{type:"Hybrid",centralization:.5,formalization:.5,complexity:.5,alignmentScore:0},systems:{financial:"Traditional budgeting and reporting",operational:"Standard operating procedures",hr:{talentAcquisition:"Traditional recruitment",trainingDevelopment:"Basic training programs",performanceManagement:"Annual performance reviews",compensationBenefits:"Market-based compensation"},information:"Legacy systems with some modern tools",alignmentScore:0},sharedValues:{values:["Integrity","Customer Focus","Excellence"],alignmentScore:0},skills:{coreCompetencies:["Industry Knowledge","Technical Expertise"],requiredSkills:["Communication","Problem Solving","Teamwork"],alignmentScore:0},style:{leadershipStyle:"Democratic",decisionMaking:"Consultative",alignmentScore:0},staff:{composition:"Balanced mix of experience levels",capabilities:"Adequate for current operations",changeReadiness:.6,alignmentScore:0},alignmentScore:0},wz={company:null,sevenSModel:null,scenarioId:1,decisions:[],tensions:[],kpiTracker:[]},ly=Dle((r,e)=>({simulation:wz,setCompany:n=>r(i=>({simulation:{...i.simulation,company:n,kpiTracker:n.kpis.map(s=>({name:s.name,history:[{date:new Date,value:s.current}]}))}})),initializeSevenSModel:()=>r(n=>{const i=n.simulation.company;if(!i)return n;const s={...pce};return s.structure.type=i.structure,s.sharedValues.values=i.coreValues,s.strategy.alignmentScore=.7,s.structure.alignmentScore=.7,s.systems.alignmentScore=.7,s.sharedValues.alignmentScore=.7,s.skills.alignmentScore=.7,s.style.alignmentScore=.7,s.staff.alignmentScore=.7,s.alignmentScore=pw([s.strategy.alignmentScore,s.structure.alignmentScore,s.systems.alignmentScore,s.sharedValues.alignmentScore,s.skills.alignmentScore,s.style.alignmentScore,s.staff.alignmentScore]),{simulation:{...n.simulation,sevenSModel:s}}}),updateSevenSElement:(n,i)=>r(s=>{if(!s.simulation.sevenSModel)return s;const o={...s.simulation.sevenSModel},a=n.charAt(0).toLowerCase()+n.slice(1).replace(" ","");return a in o&&(o[a]={...o[a],...i}),o.alignmentScore=pw([o.strategy.alignmentScore,o.structure.alignmentScore,o.systems.alignmentScore,o.sharedValues.alignmentScore,o.skills.alignmentScore,o.style.alignmentScore,o.staff.alignmentScore]),{simulation:{...s.simulation,sevenSModel:o}}}),addDecision:n=>r(i=>({simulation:{...i.simulation,decisions:[...i.simulation.decisions,{...n,id:ys()}]}})),makeDecision:(n,i)=>r(s=>{const o=[...s.simulation.decisions],a=o.findIndex(d=>d.id===n);if(a===-1)return s;const l=o[a],c={...l,selectedOption:i};o[a]=c;const u={...s.simulation.sevenSModel};if(!u)return s;const h=l.options.find(d=>d.id===i);return h?(l.impact.filter(d=>d.description.includes(h.description)).forEach(d=>{const p=d.element.charAt(0).toLowerCase()+d.element.slice(1).replace(" ","");if(p in u){const m=u[p];"alignmentScore"in m&&(m.alignmentScore=Math.max(0,Math.min(1,m.alignmentScore+d.value)))}}),u.alignmentScore=pw([u.strategy.alignmentScore,u.structure.alignmentScore,u.systems.alignmentScore,u.sharedValues.alignmentScore,u.skills.alignmentScore,u.style.alignmentScore,u.staff.alignmentScore]),{simulation:{...s.simulation,decisions:o,sevenSModel:u}}):s}),addTension:n=>r(i=>({simulation:{...i.simulation,tensions:[...i.simulation.tensions,{...n,id:ys(),resolved:!1}]}})),resolveTension:(n,i)=>r(s=>{const o=[...s.simulation.tensions],a=o.findIndex(h=>h.id===n);if(a===-1)return s;const l=o[a],c=l.resolutionOptions.find(h=>h.id===i);if(!c)return s;o[a]={...l,resolved:!0};const u={...s.simulation.sevenSModel};return u?(c.impacts.forEach(h=>{const f=h.element.charAt(0).toLowerCase()+h.element.slice(1).replace(" ","");if(f in u){const d=u[f];"alignmentScore"in d&&(d.alignmentScore=Math.max(0,Math.min(1,d.alignmentScore+h.value)))}}),u.alignmentScore=pw([u.strategy.alignmentScore,u.structure.alignmentScore,u.systems.alignmentScore,u.sharedValues.alignmentScore,u.skills.alignmentScore,u.style.alignmentScore,u.staff.alignmentScore]),{simulation:{...s.simulation,tensions:o,sevenSModel:u}}):s}),updateKPI:(n,i)=>r(s=>{const o=[...s.simulation.kpiTracker],a=o.findIndex(l=>l.name===n);return a===-1?s:(o[a]={...o[a],history:[...o[a].history,{date:new Date,value:i}]},{simulation:{...s.simulation,kpiTracker:o}})}),getAlignmentScore:()=>{const{sevenSModel:n}=e().simulation;return(n==null?void 0:n.alignmentScore)||0},resetSimulation:()=>r({simulation:wz})})),mce=()=>{const r=Jb(),{simulation:e}=ly();return N.jsx("header",{className:"bg-white border-b border-gray-200 dark:bg-gray-800 dark:border-gray-700",children:N.jsx("div",{className:"px-4 sm:px-6 lg:px-8 mx-auto",children:N.jsxs("div",{className:"flex h-16 items-center justify-between",children:[N.jsx("div",{className:"flex items-center",children:N.jsxs(wq,{to:"/",className:"flex items-center space-x-2",children:[N.jsx(Sq,{className:"h-6 w-6 text-blue-600 dark:text-blue-500"}),N.jsx("span",{className:"text-xl font-bold text-gray-900 dark:text-white",children:"7S Simulator"})]})}),N.jsxs("nav",{className:"hidden md:flex items-center space-x-1",children:[N.jsx(Yy,{href:"/",active:r.pathname==="/",children:"Home"}),N.jsx(Yy,{href:"/profile",active:r.pathname==="/profile",disabled:!e.company,children:"Company Profile"}),N.jsx(Yy,{href:"/simulation",active:r.pathname==="/simulation",disabled:!e.company,children:"7S Model"}),N.jsx(Yy,{href:"/decisions",active:r.pathname==="/decisions",disabled:!e.company,children:"Decisions"}),N.jsx(Yy,{href:"/results",active:r.pathname==="/results",disabled:!e.company,children:"Results"})]}),N.jsxs("div",{className:"flex items-center space-x-4",children:[e.company&&N.jsxs("div",{className:"hidden md:flex items-center",children:[N.jsx("div",{className:"h-8 w-8 rounded-full bg-blue-100 flex items-center justify-center text-blue-600 dark:bg-blue-900 dark:text-blue-300",children:N.jsx(ole,{className:"h-4 w-4"})}),N.jsx("span",{className:"ml-2 text-sm font-medium text-gray-700 dark:text-gray-300",children:e.company.name})]}),N.jsx("button",{className:"rounded-full h-8 w-8 flex items-center justify-center text-gray-500 hover:text-gray-700 hover:bg-gray-100 dark:text-gray-400 dark:hover:text-white dark:hover:bg-gray-700",children:N.jsx(Tq,{className:"h-5 w-5"})})]})]})})})},Yy=({href:r,active:e=!1,disabled:n=!1,children:i})=>n?N.jsx("span",{className:"inline-flex items-center px-3 py-2 text-sm font-medium rounded-md text-gray-400 cursor-not-allowed",children:i}):N.jsx(wq,{to:r,className:`inline-flex items-center px-3 py-2 text-sm font-medium rounded-md ${e?"bg-gray-100 text-gray-900 dark:bg-gray-700 dark:text-white":"text-gray-600 hover:bg-gray-50 hover:text-gray-900 dark:text-gray-300 dark:hover:bg-gray-700 dark:hover:text-white"}`,children:i}),Lq=te.createContext({});function gce(r){const e=te.useRef(null);return e.current===null&&(e.current=r()),e.current}const hL=te.createContext(null),Fq=te.createContext({transformPagePoint:r=>r,isStatic:!1,reducedMotion:"never"});function yce(r=!0){const e=te.useContext(hL);if(e===null)return[!0,null];const{isPresent:n,onExitComplete:i,register:s}=e,o=te.useId();te.useEffect(()=>{r&&s(o)},[r]);const a=te.useCallback(()=>r&&i&&i(o),[o,i,r]);return!n&&i?[!1,a]:[!0]}const fL=typeof window<"u",vce=fL?te.useLayoutEffect:te.useEffect,Po=r=>r;let uO=Po;function dL(r){let e;return()=>(e===void 0&&(e=r()),e)}const Ym=(r,e,n)=>{const i=e-r;return i===0?1:(n-r)/i},jc=r=>r*1e3,Vc=r=>r/1e3,xce={skipAnimations:!1,useManualTiming:!1};function bce(r){let e=new Set,n=new Set,i=!1,s=!1;const o=new WeakSet;let a={delta:0,timestamp:0,isProcessing:!1};function l(u){o.has(u)&&(c.schedule(u),r()),u(a)}const c={schedule:(u,h=!1,f=!1)=>{const p=f&&i?e:n;return h&&o.add(u),p.has(u)||p.add(u),u},cancel:u=>{n.delete(u),o.delete(u)},process:u=>{if(a=u,i){s=!0;return}i=!0,[e,n]=[n,e],e.forEach(l),e.clear(),i=!1,s&&(s=!1,c.process(u))}};return c}const mw=["read","resolveKeyframes","update","preRender","render","postRender"],_ce=40;function Bq(r,e){let n=!1,i=!0;const s={delta:0,timestamp:0,isProcessing:!1},o=()=>n=!0,a=mw.reduce((y,x)=>(y[x]=bce(o),y),{}),{read:l,resolveKeyframes:c,update:u,preRender:h,render:f,postRender:d}=a,p=()=>{const y=performance.now();n=!1,s.delta=i?1e3/60:Math.max(Math.min(y-s.timestamp,_ce),1),s.timestamp=y,s.isProcessing=!0,l.process(s),c.process(s),u.process(s),h.process(s),f.process(s),d.process(s),s.isProcessing=!1,n&&e&&(i=!1,r(p))},m=()=>{n=!0,i=!0,s.isProcessing||r(p)};return{schedule:mw.reduce((y,x)=>{const b=a[x];return y[x]=(w,_=!1,S=!1)=>(n||m(),b.schedule(w,_,S)),y},{}),cancel:y=>{for(let x=0;x<mw.length;x++)a[mw[x]].cancel(y)},state:s,steps:a}}const{schedule:tr,cancel:Eh,state:ki,steps:JC}=Bq(typeof requestAnimationFrame<"u"?requestAnimationFrame:Po,!0),Uq=te.createContext({strict:!1}),Sz={animation:["animate","variants","whileHover","whileTap","exit","whileInView","whileFocus","whileDrag"],exit:["exit"],drag:["drag","dragControls"],focus:["whileFocus"],hover:["whileHover","onHoverStart","onHoverEnd"],tap:["whileTap","onTap","onTapStart","onTapCancel"],pan:["onPan","onPanStart","onPanSessionStart","onPanEnd"],inView:["whileInView","onViewportEnter","onViewportLeave"],layout:["layout","layoutId"]},Zm={};for(const r in Sz)Zm[r]={isEnabled:e=>Sz[r].some(n=>!!e[n])};function wce(r){for(const e in r)Zm[e]={...Zm[e],...r[e]}}const Sce=new Set(["animate","exit","variants","initial","style","values","variants","transition","transformTemplate","custom","inherit","onBeforeLayoutMeasure","onAnimationStart","onAnimationComplete","onUpdate","onDragStart","onDrag","onDragEnd","onMeasureDragConstraints","onDirectionLock","onDragTransitionEnd","_dragX","_dragY","onHoverStart","onHoverEnd","onViewportEnter","onViewportLeave","globalTapTarget","ignoreStrict","viewport"]);function vT(r){return r.startsWith("while")||r.startsWith("drag")&&r!=="draggable"||r.startsWith("layout")||r.startsWith("onTap")||r.startsWith("onPan")||r.startsWith("onLayout")||Sce.has(r)}let zq=r=>!vT(r);function Tce(r){r&&(zq=e=>e.startsWith("on")?!vT(e):r(e))}try{Tce(require("@emotion/is-prop-valid").default)}catch{}function Ece(r,e,n){const i={};for(const s in r)s==="values"&&typeof r.values=="object"||(zq(s)||n===!0&&vT(s)||!e&&!vT(s)||r.draggable&&s.startsWith("onDrag"))&&(i[s]=r[s]);return i}function Mce(r){if(typeof Proxy>"u")return r;const e=new Map,n=(...i)=>r(...i);return new Proxy(n,{get:(i,s)=>s==="create"?r:(e.has(s)||e.set(s,r(s)),e.get(s))})}const NM=te.createContext({});function xx(r){return typeof r=="string"||Array.isArray(r)}function OM(r){return r!==null&&typeof r=="object"&&typeof r.start=="function"}const pL=["animate","whileInView","whileFocus","whileHover","whileTap","whileDrag","exit"],mL=["initial",...pL];function DM(r){return OM(r.animate)||mL.some(e=>xx(r[e]))}function $q(r){return!!(DM(r)||r.variants)}function Ace(r,e){if(DM(r)){const{initial:n,animate:i}=r;return{initial:n===!1||xx(n)?n:void 0,animate:xx(i)?i:void 0}}return r.inherit!==!1?e:{}}function Cce(r){const{initial:e,animate:n}=Ace(r,te.useContext(NM));return te.useMemo(()=>({initial:e,animate:n}),[Tz(e),Tz(n)])}function Tz(r){return Array.isArray(r)?r.join(" "):r}const Pce=Symbol.for("motionComponentSymbol");function Qp(r){return r&&typeof r=="object"&&Object.prototype.hasOwnProperty.call(r,"current")}function Rce(r,e,n){return te.useCallback(i=>{i&&r.onMount&&r.onMount(i),e&&(i?e.mount(i):e.unmount()),n&&(typeof n=="function"?n(i):Qp(n)&&(n.current=i))},[e])}const gL=r=>r.replace(/([a-z])([A-Z])/gu,"$1-$2").toLowerCase(),Nce="framerAppearId",jq="data-"+gL(Nce),{schedule:yL,cancel:Lct}=Bq(queueMicrotask,!1),Vq=te.createContext({});function Oce(r,e,n,i,s){var o,a;const{visualElement:l}=te.useContext(NM),c=te.useContext(Uq),u=te.useContext(hL),h=te.useContext(Fq).reducedMotion,f=te.useRef(null);i=i||c.renderer,!f.current&&i&&(f.current=i(r,{visualState:e,parent:l,props:n,presenceContext:u,blockInitialAnimation:u?u.initial===!1:!1,reducedMotionConfig:h}));const d=f.current,p=te.useContext(Vq);d&&!d.projection&&s&&(d.type==="html"||d.type==="svg")&&Dce(f.current,n,s,p);const m=te.useRef(!1);te.useInsertionEffect(()=>{d&&m.current&&d.update(n,u)});const g=n[jq],v=te.useRef(!!g&&!(!((o=window.MotionHandoffIsComplete)===null||o===void 0)&&o.call(window,g))&&((a=window.MotionHasOptimisedAnimation)===null||a===void 0?void 0:a.call(window,g)));return vce(()=>{d&&(m.current=!0,window.MotionIsMounted=!0,d.updateFeatures(),yL.render(d.render),v.current&&d.animationState&&d.animationState.animateChanges())}),te.useEffect(()=>{d&&(!v.current&&d.animationState&&d.animationState.animateChanges(),v.current&&(queueMicrotask(()=>{var y;(y=window.MotionHandoffMarkAsComplete)===null||y===void 0||y.call(window,g)}),v.current=!1))}),d}function Dce(r,e,n,i){const{layoutId:s,layout:o,drag:a,dragConstraints:l,layoutScroll:c,layoutRoot:u}=e;r.projection=new n(r.latestValues,e["data-framer-portal-id"]?void 0:Gq(r.parent)),r.projection.setOptions({layoutId:s,layout:o,alwaysMeasureLayout:!!a||l&&Qp(l),visualElement:r,animationType:typeof o=="string"?o:"both",initialPromotionConfig:i,layoutScroll:c,layoutRoot:u})}function Gq(r){if(r)return r.options.allowProjection!==!1?r.projection:Gq(r.parent)}function kce({preloadedFeatures:r,createVisualElement:e,useRender:n,useVisualState:i,Component:s}){var o,a;r&&wce(r);function l(u,h){let f;const d={...te.useContext(Fq),...u,layoutId:Ice(u)},{isStatic:p}=d,m=Cce(u),g=i(u,p);if(!p&&fL){Lce();const v=Fce(d);f=v.MeasureLayout,m.visualElement=Oce(s,g,d,e,v.ProjectionNode)}return N.jsxs(NM.Provider,{value:m,children:[f&&m.visualElement?N.jsx(f,{visualElement:m.visualElement,...d}):null,n(s,u,Rce(g,m.visualElement,h),g,p,m.visualElement)]})}l.displayName=`motion.${typeof s=="string"?s:`create(${(a=(o=s.displayName)!==null&&o!==void 0?o:s.name)!==null&&a!==void 0?a:""})`}`;const c=te.forwardRef(l);return c[Pce]=s,c}function Ice({layoutId:r}){const e=te.useContext(Lq).id;return e&&r!==void 0?e+"-"+r:r}function Lce(r,e){te.useContext(Uq).strict}function Fce(r){const{drag:e,layout:n}=Zm;if(!e&&!n)return{};const i={...e,...n};return{MeasureLayout:e!=null&&e.isEnabled(r)||n!=null&&n.isEnabled(r)?i.MeasureLayout:void 0,ProjectionNode:i.ProjectionNode}}const Bce=["animate","circle","defs","desc","ellipse","g","image","line","filter","marker","mask","metadata","path","pattern","polygon","polyline","rect","stop","switch","symbol","svg","text","tspan","use","view"];function vL(r){return typeof r!="string"||r.includes("-")?!1:!!(Bce.indexOf(r)>-1||/[A-Z]/u.test(r))}function Ez(r){const e=[{},{}];return r==null||r.values.forEach((n,i)=>{e[0][i]=n.get(),e[1][i]=n.getVelocity()}),e}function xL(r,e,n,i){if(typeof e=="function"){const[s,o]=Ez(i);e=e(n!==void 0?n:r.custom,s,o)}if(typeof e=="string"&&(e=r.variants&&r.variants[e]),typeof e=="function"){const[s,o]=Ez(i);e=e(n!==void 0?n:r.custom,s,o)}return e}const hO=r=>Array.isArray(r),Uce=r=>!!(r&&typeof r=="object"&&r.mix&&r.toValue),zce=r=>hO(r)?r[r.length-1]||0:r,as=r=>!!(r&&r.getVelocity);function w1(r){const e=as(r)?r.get():r;return Uce(e)?e.toValue():e}function $ce({scrapeMotionValuesFromProps:r,createRenderState:e,onUpdate:n},i,s,o){const a={latestValues:jce(i,s,o,r),renderState:e()};return n&&(a.onMount=l=>n({props:i,current:l,...a}),a.onUpdate=l=>n(l)),a}const Hq=r=>(e,n)=>{const i=te.useContext(NM),s=te.useContext(hL),o=()=>$ce(r,e,i,s);return n?o():gce(o)};function jce(r,e,n,i){const s={},o=i(r,{});for(const d in o)s[d]=w1(o[d]);let{initial:a,animate:l}=r;const c=DM(r),u=$q(r);e&&u&&!c&&r.inherit!==!1&&(a===void 0&&(a=e.initial),l===void 0&&(l=e.animate));let h=n?n.initial===!1:!1;h=h||a===!1;const f=h?l:a;if(f&&typeof f!="boolean"&&!OM(f)){const d=Array.isArray(f)?f:[f];for(let p=0;p<d.length;p++){const m=xL(r,d[p]);if(m){const{transitionEnd:g,transition:v,...y}=m;for(const x in y){let b=y[x];if(Array.isArray(b)){const w=h?b.length-1:0;b=b[w]}b!==null&&(s[x]=b)}for(const x in g)s[x]=g[x]}}}return s}const cy=["transformPerspective","x","y","z","translateX","translateY","translateZ","scale","scaleX","scaleY","rotate","rotateX","rotateY","rotateZ","skew","skewX","skewY"],Nd=new Set(cy),Wq=r=>e=>typeof e=="string"&&e.startsWith(r),qq=Wq("--"),Vce=Wq("var(--"),bL=r=>Vce(r)?Gce.test(r.split("/*")[0].trim()):!1,Gce=/var\(--(?:[\w-]+\s*|[\w-]+\s*,(?:\s*[^)(\s]|\s*\((?:[^)(]|\([^)(]*\))*\))+\s*)\)$/iu,Xq=(r,e)=>e&&typeof r=="number"?e.transform(r):r,su=(r,e,n)=>n>e?e:n<r?r:n,uy={test:r=>typeof r=="number",parse:parseFloat,transform:r=>r},bx={...uy,transform:r=>su(0,1,r)},gw={...uy,default:1},t_=r=>({test:e=>typeof e=="string"&&e.endsWith(r)&&e.split(" ").length===1,parse:parseFloat,transform:e=>`${e}${r}`}),Wu=t_("deg"),Rl=t_("%"),Rt=t_("px"),Hce=t_("vh"),Wce=t_("vw"),Mz={...Rl,parse:r=>Rl.parse(r)/100,transform:r=>Rl.transform(r*100)},qce={borderWidth:Rt,borderTopWidth:Rt,borderRightWidth:Rt,borderBottomWidth:Rt,borderLeftWidth:Rt,borderRadius:Rt,radius:Rt,borderTopLeftRadius:Rt,borderTopRightRadius:Rt,borderBottomRightRadius:Rt,borderBottomLeftRadius:Rt,width:Rt,maxWidth:Rt,height:Rt,maxHeight:Rt,top:Rt,right:Rt,bottom:Rt,left:Rt,padding:Rt,paddingTop:Rt,paddingRight:Rt,paddingBottom:Rt,paddingLeft:Rt,margin:Rt,marginTop:Rt,marginRight:Rt,marginBottom:Rt,marginLeft:Rt,backgroundPositionX:Rt,backgroundPositionY:Rt},Xce={rotate:Wu,rotateX:Wu,rotateY:Wu,rotateZ:Wu,scale:gw,scaleX:gw,scaleY:gw,scaleZ:gw,skew:Wu,skewX:Wu,skewY:Wu,distance:Rt,translateX:Rt,translateY:Rt,translateZ:Rt,x:Rt,y:Rt,z:Rt,perspective:Rt,transformPerspective:Rt,opacity:bx,originX:Mz,originY:Mz,originZ:Rt},Az={...uy,transform:Math.round},_L={...qce,...Xce,zIndex:Az,size:Rt,fillOpacity:bx,strokeOpacity:bx,numOctaves:Az},Kce={x:"translateX",y:"translateY",z:"translateZ",transformPerspective:"perspective"},Yce=cy.length;function Zce(r,e,n){let i="",s=!0;for(let o=0;o<Yce;o++){const a=cy[o],l=r[a];if(l===void 0)continue;let c=!0;if(typeof l=="number"?c=l===(a.startsWith("scale")?1:0):c=parseFloat(l)===0,!c||n){const u=Xq(l,_L[a]);if(!c){s=!1;const h=Kce[a]||a;i+=`${h}(${u}) `}n&&(e[a]=u)}}return i=i.trim(),n?i=n(e,s?"":i):s&&(i="none"),i}function wL(r,e,n){const{style:i,vars:s,transformOrigin:o}=r;let a=!1,l=!1;for(const c in e){const u=e[c];if(Nd.has(c)){a=!0;continue}else if(qq(c)){s[c]=u;continue}else{const h=Xq(u,_L[c]);c.startsWith("origin")?(l=!0,o[c]=h):i[c]=h}}if(e.transform||(a||n?i.transform=Zce(e,r.transform,n):i.transform&&(i.transform="none")),l){const{originX:c="50%",originY:u="50%",originZ:h=0}=o;i.transformOrigin=`${c} ${u} ${h}`}}const Qce={offset:"stroke-dashoffset",array:"stroke-dasharray"},Jce={offset:"strokeDashoffset",array:"strokeDasharray"};function eue(r,e,n=1,i=0,s=!0){r.pathLength=1;const o=s?Qce:Jce;r[o.offset]=Rt.transform(-i);const a=Rt.transform(e),l=Rt.transform(n);r[o.array]=`${a} ${l}`}function Cz(r,e,n){return typeof r=="string"?r:Rt.transform(e+n*r)}function tue(r,e,n){const i=Cz(e,r.x,r.width),s=Cz(n,r.y,r.height);return`${i} ${s}`}function SL(r,{attrX:e,attrY:n,attrScale:i,originX:s,originY:o,pathLength:a,pathSpacing:l=1,pathOffset:c=0,...u},h,f){if(wL(r,u,f),h){r.style.viewBox&&(r.attrs.viewBox=r.style.viewBox);return}r.attrs=r.style,r.style={};const{attrs:d,style:p,dimensions:m}=r;d.transform&&(m&&(p.transform=d.transform),delete d.transform),m&&(s!==void 0||o!==void 0||p.transform)&&(p.transformOrigin=tue(m,s!==void 0?s:.5,o!==void 0?o:.5)),e!==void 0&&(d.x=e),n!==void 0&&(d.y=n),i!==void 0&&(d.scale=i),a!==void 0&&eue(d,a,l,c,!1)}const TL=()=>({style:{},transform:{},transformOrigin:{},vars:{}}),Kq=()=>({...TL(),attrs:{}}),EL=r=>typeof r=="string"&&r.toLowerCase()==="svg";function Yq(r,{style:e,vars:n},i,s){Object.assign(r.style,e,s&&s.getProjectionStyles(i));for(const o in n)r.style.setProperty(o,n[o])}const Zq=new Set(["baseFrequency","diffuseConstant","kernelMatrix","kernelUnitLength","keySplines","keyTimes","limitingConeAngle","markerHeight","markerWidth","numOctaves","targetX","targetY","surfaceScale","specularConstant","specularExponent","stdDeviation","tableValues","viewBox","gradientTransform","pathLength","startOffset","textLength","lengthAdjust"]);function Qq(r,e,n,i){Yq(r,e,void 0,i);for(const s in e.attrs)r.setAttribute(Zq.has(s)?s:gL(s),e.attrs[s])}const xT={};function nue(r){Object.assign(xT,r)}function Jq(r,{layout:e,layoutId:n}){return Nd.has(r)||r.startsWith("origin")||(e||n!==void 0)&&(!!xT[r]||r==="opacity")}function ML(r,e,n){var i;const{style:s}=r,o={};for(const a in s)(as(s[a])||e.style&&as(e.style[a])||Jq(a,r)||((i=n==null?void 0:n.getValue(a))===null||i===void 0?void 0:i.liveStyle)!==void 0)&&(o[a]=s[a]);return o}function eX(r,e,n){const i=ML(r,e,n);for(const s in r)if(as(r[s])||as(e[s])){const o=cy.indexOf(s)!==-1?"attr"+s.charAt(0).toUpperCase()+s.substring(1):s;i[o]=r[s]}return i}function rue(r,e){try{e.dimensions=typeof r.getBBox=="function"?r.getBBox():r.getBoundingClientRect()}catch{e.dimensions={x:0,y:0,width:0,height:0}}}const Pz=["x","y","width","height","cx","cy","r"],iue={useVisualState:Hq({scrapeMotionValuesFromProps:eX,createRenderState:Kq,onUpdate:({props:r,prevProps:e,current:n,renderState:i,latestValues:s})=>{if(!n)return;let o=!!r.drag;if(!o){for(const l in s)if(Nd.has(l)){o=!0;break}}if(!o)return;let a=!e;if(e)for(let l=0;l<Pz.length;l++){const c=Pz[l];r[c]!==e[c]&&(a=!0)}a&&tr.read(()=>{rue(n,i),tr.render(()=>{SL(i,s,EL(n.tagName),r.transformTemplate),Qq(n,i)})})}})},sue={useVisualState:Hq({scrapeMotionValuesFromProps:ML,createRenderState:TL})};function tX(r,e,n){for(const i in e)!as(e[i])&&!Jq(i,n)&&(r[i]=e[i])}function oue({transformTemplate:r},e){return te.useMemo(()=>{const n=TL();return wL(n,e,r),Object.assign({},n.vars,n.style)},[e])}function aue(r,e){const n=r.style||{},i={};return tX(i,n,r),Object.assign(i,oue(r,e)),i}function lue(r,e){const n={},i=aue(r,e);return r.drag&&r.dragListener!==!1&&(n.draggable=!1,i.userSelect=i.WebkitUserSelect=i.WebkitTouchCallout="none",i.touchAction=r.drag===!0?"none":`pan-${r.drag==="x"?"y":"x"}`),r.tabIndex===void 0&&(r.onTap||r.onTapStart||r.whileTap)&&(n.tabIndex=0),n.style=i,n}function cue(r,e,n,i){const s=te.useMemo(()=>{const o=Kq();return SL(o,e,EL(i),r.transformTemplate),{...o.attrs,style:{...o.style}}},[e]);if(r.style){const o={};tX(o,r.style,r),s.style={...o,...s.style}}return s}function uue(r=!1){return(n,i,s,{latestValues:o},a)=>{const c=(vL(n)?cue:lue)(i,o,a,n),u=Ece(i,typeof n=="string",r),h=n!==te.Fragment?{...u,...c,ref:s}:{},{children:f}=i,d=te.useMemo(()=>as(f)?f.get():f,[f]);return te.createElement(n,{...h,children:d})}}function hue(r,e){return function(i,{forwardMotionProps:s}={forwardMotionProps:!1}){const a={...vL(i)?iue:sue,preloadedFeatures:r,useRender:uue(s),createVisualElement:e,Component:i};return kce(a)}}function nX(r,e){if(!Array.isArray(e))return!1;const n=e.length;if(n!==r.length)return!1;for(let i=0;i<n;i++)if(e[i]!==r[i])return!1;return!0}function kM(r,e,n){const i=r.getProps();return xL(i,e,n!==void 0?n:i.custom,r)}const fue=dL(()=>window.ScrollTimeline!==void 0);class due{constructor(e){this.stop=()=>this.runAll("stop"),this.animations=e.filter(Boolean)}get finished(){return Promise.all(this.animations.map(e=>"finished"in e?e.finished:e))}getAll(e){return this.animations[0][e]}setAll(e,n){for(let i=0;i<this.animations.length;i++)this.animations[i][e]=n}attachTimeline(e,n){const i=this.animations.map(s=>{if(fue()&&s.attachTimeline)return s.attachTimeline(e);if(typeof n=="function")return n(s)});return()=>{i.forEach((s,o)=>{s&&s(),this.animations[o].stop()})}}get time(){return this.getAll("time")}set time(e){this.setAll("time",e)}get speed(){return this.getAll("speed")}set speed(e){this.setAll("speed",e)}get startTime(){return this.getAll("startTime")}get duration(){let e=0;for(let n=0;n<this.animations.length;n++)e=Math.max(e,this.animations[n].duration);return e}runAll(e){this.animations.forEach(n=>n[e]())}flatten(){this.runAll("flatten")}play(){this.runAll("play")}pause(){this.runAll("pause")}cancel(){this.runAll("cancel")}complete(){this.runAll("complete")}}class pue extends due{then(e,n){return Promise.all(this.animations).then(e).catch(n)}}function AL(r,e){return r?r[e]||r.default||r:void 0}const fO=2e4;function rX(r){let e=0;const n=50;let i=r.next(e);for(;!i.done&&e<fO;)e+=n,i=r.next(e);return e>=fO?1/0:e}function CL(r){return typeof r=="function"}function Rz(r,e){r.timeline=e,r.onfinish=null}const PL=r=>Array.isArray(r)&&typeof r[0]=="number",mue={linearEasing:void 0};function gue(r,e){const n=dL(r);return()=>{var i;return(i=mue[e])!==null&&i!==void 0?i:n()}}const bT=gue(()=>{try{document.createElement("div").animate({opacity:0},{easing:"linear(0, 1)"})}catch{return!1}return!0},"linearEasing"),iX=(r,e,n=10)=>{let i="";const s=Math.max(Math.round(e/n),2);for(let o=0;o<s;o++)i+=r(Ym(0,s-1,o))+", ";return`linear(${i.substring(0,i.length-2)})`};function sX(r){return!!(typeof r=="function"&&bT()||!r||typeof r=="string"&&(r in dO||bT())||PL(r)||Array.isArray(r)&&r.every(sX))}const e0=([r,e,n,i])=>`cubic-bezier(${r}, ${e}, ${n}, ${i})`,dO={linear:"linear",ease:"ease",easeIn:"ease-in",easeOut:"ease-out",easeInOut:"ease-in-out",circIn:e0([0,.65,.55,1]),circOut:e0([.55,0,1,.45]),backIn:e0([.31,.01,.66,-.59]),backOut:e0([.33,1.53,.69,.99])};function oX(r,e){if(r)return typeof r=="function"&&bT()?iX(r,e):PL(r)?e0(r):Array.isArray(r)?r.map(n=>oX(n,e)||dO.easeOut):dO[r]}const Ra={x:!1,y:!1};function aX(){return Ra.x||Ra.y}function yue(r,e,n){var i;if(r instanceof Element)return[r];if(typeof r=="string"){let s=document;const o=(i=void 0)!==null&&i!==void 0?i:s.querySelectorAll(r);return o?Array.from(o):[]}return Array.from(r)}function lX(r,e){const n=yue(r),i=new AbortController,s={passive:!0,...e,signal:i.signal};return[n,s,()=>i.abort()]}function Nz(r){return e=>{e.pointerType==="touch"||aX()||r(e)}}function vue(r,e,n={}){const[i,s,o]=lX(r,n),a=Nz(l=>{const{target:c}=l,u=e(l);if(typeof u!="function"||!c)return;const h=Nz(f=>{u(f),c.removeEventListener("pointerleave",h)});c.addEventListener("pointerleave",h,s)});return i.forEach(l=>{l.addEventListener("pointerenter",a,s)}),o}const cX=(r,e)=>e?r===e?!0:cX(r,e.parentElement):!1,RL=r=>r.pointerType==="mouse"?typeof r.button!="number"||r.button<=0:r.isPrimary!==!1,xue=new Set(["BUTTON","INPUT","SELECT","TEXTAREA","A"]);function bue(r){return xue.has(r.tagName)||r.tabIndex!==-1}const t0=new WeakSet;function Oz(r){return e=>{e.key==="Enter"&&r(e)}}function eP(r,e){r.dispatchEvent(new PointerEvent("pointer"+e,{isPrimary:!0,bubbles:!0}))}const _ue=(r,e)=>{const n=r.currentTarget;if(!n)return;const i=Oz(()=>{if(t0.has(n))return;eP(n,"down");const s=Oz(()=>{eP(n,"up")}),o=()=>eP(n,"cancel");n.addEventListener("keyup",s,e),n.addEventListener("blur",o,e)});n.addEventListener("keydown",i,e),n.addEventListener("blur",()=>n.removeEventListener("keydown",i),e)};function Dz(r){return RL(r)&&!aX()}function wue(r,e,n={}){const[i,s,o]=lX(r,n),a=l=>{const c=l.currentTarget;if(!Dz(l)||t0.has(c))return;t0.add(c);const u=e(l),h=(p,m)=>{window.removeEventListener("pointerup",f),window.removeEventListener("pointercancel",d),!(!Dz(p)||!t0.has(c))&&(t0.delete(c),typeof u=="function"&&u(p,{success:m}))},f=p=>{h(p,n.useGlobalTarget||cX(c,p.target))},d=p=>{h(p,!1)};window.addEventListener("pointerup",f,s),window.addEventListener("pointercancel",d,s)};return i.forEach(l=>{!bue(l)&&l.getAttribute("tabindex")===null&&(l.tabIndex=0),(n.useGlobalTarget?window:l).addEventListener("pointerdown",a,s),l.addEventListener("focus",u=>_ue(u,s),s)}),o}function Sue(r){return r==="x"||r==="y"?Ra[r]?null:(Ra[r]=!0,()=>{Ra[r]=!1}):Ra.x||Ra.y?null:(Ra.x=Ra.y=!0,()=>{Ra.x=Ra.y=!1})}const uX=new Set(["width","height","top","left","right","bottom",...cy]);let S1;function Tue(){S1=void 0}const Nl={now:()=>(S1===void 0&&Nl.set(ki.isProcessing||xce.useManualTiming?ki.timestamp:performance.now()),S1),set:r=>{S1=r,queueMicrotask(Tue)}};function NL(r,e){r.indexOf(e)===-1&&r.push(e)}function OL(r,e){const n=r.indexOf(e);n>-1&&r.splice(n,1)}class DL{constructor(){this.subscriptions=[]}add(e){return NL(this.subscriptions,e),()=>OL(this.subscriptions,e)}notify(e,n,i){const s=this.subscriptions.length;if(s)if(s===1)this.subscriptions[0](e,n,i);else for(let o=0;o<s;o++){const a=this.subscriptions[o];a&&a(e,n,i)}}getSize(){return this.subscriptions.length}clear(){this.subscriptions.length=0}}function hX(r,e){return e?r*(1e3/e):0}const kz=30,Eue=r=>!isNaN(parseFloat(r));class Mue{constructor(e,n={}){this.version="11.18.2",this.canTrackVelocity=null,this.events={},this.updateAndNotify=(i,s=!0)=>{const o=Nl.now();this.updatedAt!==o&&this.setPrevFrameValue(),this.prev=this.current,this.setCurrent(i),this.current!==this.prev&&this.events.change&&this.events.change.notify(this.current),s&&this.events.renderRequest&&this.events.renderRequest.notify(this.current)},this.hasAnimated=!1,this.setCurrent(e),this.owner=n.owner}setCurrent(e){this.current=e,this.updatedAt=Nl.now(),this.canTrackVelocity===null&&e!==void 0&&(this.canTrackVelocity=Eue(this.current))}setPrevFrameValue(e=this.current){this.prevFrameValue=e,this.prevUpdatedAt=this.updatedAt}onChange(e){return this.on("change",e)}on(e,n){this.events[e]||(this.events[e]=new DL);const i=this.events[e].add(n);return e==="change"?()=>{i(),tr.read(()=>{this.events.change.getSize()||this.stop()})}:i}clearListeners(){for(const e in this.events)this.events[e].clear()}attach(e,n){this.passiveEffect=e,this.stopPassiveEffect=n}set(e,n=!0){!n||!this.passiveEffect?this.updateAndNotify(e,n):this.passiveEffect(e,this.updateAndNotify)}setWithVelocity(e,n,i){this.set(n),this.prev=void 0,this.prevFrameValue=e,this.prevUpdatedAt=this.updatedAt-i}jump(e,n=!0){this.updateAndNotify(e),this.prev=e,this.prevUpdatedAt=this.prevFrameValue=void 0,n&&this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}get(){return this.current}getPrevious(){return this.prev}getVelocity(){const e=Nl.now();if(!this.canTrackVelocity||this.prevFrameValue===void 0||e-this.updatedAt>kz)return 0;const n=Math.min(this.updatedAt-this.prevUpdatedAt,kz);return hX(parseFloat(this.current)-parseFloat(this.prevFrameValue),n)}start(e){return this.stop(),new Promise(n=>{this.hasAnimated=!0,this.animation=e(n),this.events.animationStart&&this.events.animationStart.notify()}).then(()=>{this.events.animationComplete&&this.events.animationComplete.notify(),this.clearAnimation()})}stop(){this.animation&&(this.animation.stop(),this.events.animationCancel&&this.events.animationCancel.notify()),this.clearAnimation()}isAnimating(){return!!this.animation}clearAnimation(){delete this.animation}destroy(){this.clearListeners(),this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}}function _x(r,e){return new Mue(r,e)}function Aue(r,e,n){r.hasValue(e)?r.getValue(e).set(n):r.addValue(e,_x(n))}function Cue(r,e){const n=kM(r,e);let{transitionEnd:i={},transition:s={},...o}=n||{};o={...o,...i};for(const a in o){const l=zce(o[a]);Aue(r,a,l)}}function Pue(r){return!!(as(r)&&r.add)}function pO(r,e){const n=r.getValue("willChange");if(Pue(n))return n.add(e)}function fX(r){return r.props[jq]}const dX=(r,e,n)=>(((1-3*n+3*e)*r+(3*n-6*e))*r+3*e)*r,Rue=1e-7,Nue=12;function Oue(r,e,n,i,s){let o,a,l=0;do a=e+(n-e)/2,o=dX(a,i,s)-r,o>0?n=a:e=a;while(Math.abs(o)>Rue&&++l<Nue);return a}function n_(r,e,n,i){if(r===e&&n===i)return Po;const s=o=>Oue(o,0,1,r,n);return o=>o===0||o===1?o:dX(s(o),e,i)}const pX=r=>e=>e<=.5?r(2*e)/2:(2-r(2*(1-e)))/2,mX=r=>e=>1-r(1-e),gX=n_(.33,1.53,.69,.99),kL=mX(gX),yX=pX(kL),vX=r=>(r*=2)<1?.5*kL(r):.5*(2-Math.pow(2,-10*(r-1))),IL=r=>1-Math.sin(Math.acos(r)),xX=mX(IL),bX=pX(IL),_X=r=>/^0[^.\s]+$/u.test(r);function Due(r){return typeof r=="number"?r===0:r!==null?r==="none"||r==="0"||_X(r):!0}const T0=r=>Math.round(r*1e5)/1e5,LL=/-?(?:\d+(?:\.\d+)?|\.\d+)/gu;function kue(r){return r==null}const Iue=/^(?:#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\))$/iu,FL=(r,e)=>n=>!!(typeof n=="string"&&Iue.test(n)&&n.startsWith(r)||e&&!kue(n)&&Object.prototype.hasOwnProperty.call(n,e)),wX=(r,e,n)=>i=>{if(typeof i!="string")return i;const[s,o,a,l]=i.match(LL);return{[r]:parseFloat(s),[e]:parseFloat(o),[n]:parseFloat(a),alpha:l!==void 0?parseFloat(l):1}},Lue=r=>su(0,255,r),tP={...uy,transform:r=>Math.round(Lue(r))},jf={test:FL("rgb","red"),parse:wX("red","green","blue"),transform:({red:r,green:e,blue:n,alpha:i=1})=>"rgba("+tP.transform(r)+", "+tP.transform(e)+", "+tP.transform(n)+", "+T0(bx.transform(i))+")"};function Fue(r){let e="",n="",i="",s="";return r.length>5?(e=r.substring(1,3),n=r.substring(3,5),i=r.substring(5,7),s=r.substring(7,9)):(e=r.substring(1,2),n=r.substring(2,3),i=r.substring(3,4),s=r.substring(4,5),e+=e,n+=n,i+=i,s+=s),{red:parseInt(e,16),green:parseInt(n,16),blue:parseInt(i,16),alpha:s?parseInt(s,16)/255:1}}const mO={test:FL("#"),parse:Fue,transform:jf.transform},Jp={test:FL("hsl","hue"),parse:wX("hue","saturation","lightness"),transform:({hue:r,saturation:e,lightness:n,alpha:i=1})=>"hsla("+Math.round(r)+", "+Rl.transform(T0(e))+", "+Rl.transform(T0(n))+", "+T0(bx.transform(i))+")"},es={test:r=>jf.test(r)||mO.test(r)||Jp.test(r),parse:r=>jf.test(r)?jf.parse(r):Jp.test(r)?Jp.parse(r):mO.parse(r),transform:r=>typeof r=="string"?r:r.hasOwnProperty("red")?jf.transform(r):Jp.transform(r)},Bue=/(?:#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\))/giu;function Uue(r){var e,n;return isNaN(r)&&typeof r=="string"&&(((e=r.match(LL))===null||e===void 0?void 0:e.length)||0)+(((n=r.match(Bue))===null||n===void 0?void 0:n.length)||0)>0}const SX="number",TX="color",zue="var",$ue="var(",Iz="${}",jue=/var\s*\(\s*--(?:[\w-]+\s*|[\w-]+\s*,(?:\s*[^)(\s]|\s*\((?:[^)(]|\([^)(]*\))*\))+\s*)\)|#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\)|-?(?:\d+(?:\.\d+)?|\.\d+)/giu;function wx(r){const e=r.toString(),n=[],i={color:[],number:[],var:[]},s=[];let o=0;const l=e.replace(jue,c=>(es.test(c)?(i.color.push(o),s.push(TX),n.push(es.parse(c))):c.startsWith($ue)?(i.var.push(o),s.push(zue),n.push(c)):(i.number.push(o),s.push(SX),n.push(parseFloat(c))),++o,Iz)).split(Iz);return{values:n,split:l,indexes:i,types:s}}function EX(r){return wx(r).values}function MX(r){const{split:e,types:n}=wx(r),i=e.length;return s=>{let o="";for(let a=0;a<i;a++)if(o+=e[a],s[a]!==void 0){const l=n[a];l===SX?o+=T0(s[a]):l===TX?o+=es.transform(s[a]):o+=s[a]}return o}}const Vue=r=>typeof r=="number"?0:r;function Gue(r){const e=EX(r);return MX(r)(e.map(Vue))}const Mh={test:Uue,parse:EX,createTransformer:MX,getAnimatableNone:Gue},Hue=new Set(["brightness","contrast","saturate","opacity"]);function Wue(r){const[e,n]=r.slice(0,-1).split("(");if(e==="drop-shadow")return r;const[i]=n.match(LL)||[];if(!i)return r;const s=n.replace(i,"");let o=Hue.has(e)?1:0;return i!==n&&(o*=100),e+"("+o+s+")"}const que=/\b([a-z-]*)\(.*?\)/gu,gO={...Mh,getAnimatableNone:r=>{const e=r.match(que);return e?e.map(Wue).join(" "):r}},Xue={..._L,color:es,backgroundColor:es,outlineColor:es,fill:es,stroke:es,borderColor:es,borderTopColor:es,borderRightColor:es,borderBottomColor:es,borderLeftColor:es,filter:gO,WebkitFilter:gO},BL=r=>Xue[r];function AX(r,e){let n=BL(r);return n!==gO&&(n=Mh),n.getAnimatableNone?n.getAnimatableNone(e):void 0}const Kue=new Set(["auto","none","0"]);function Yue(r,e,n){let i=0,s;for(;i<r.length&&!s;){const o=r[i];typeof o=="string"&&!Kue.has(o)&&wx(o).values.length&&(s=r[i]),i++}if(s&&n)for(const o of e)r[o]=AX(n,s)}const Lz=r=>r===uy||r===Rt,Fz=(r,e)=>parseFloat(r.split(", ")[e]),Bz=(r,e)=>(n,{transform:i})=>{if(i==="none"||!i)return 0;const s=i.match(/^matrix3d\((.+)\)$/u);if(s)return Fz(s[1],e);{const o=i.match(/^matrix\((.+)\)$/u);return o?Fz(o[1],r):0}},Zue=new Set(["x","y","z"]),Que=cy.filter(r=>!Zue.has(r));function Jue(r){const e=[];return Que.forEach(n=>{const i=r.getValue(n);i!==void 0&&(e.push([n,i.get()]),i.set(n.startsWith("scale")?1:0))}),e}const Qm={width:({x:r},{paddingLeft:e="0",paddingRight:n="0"})=>r.max-r.min-parseFloat(e)-parseFloat(n),height:({y:r},{paddingTop:e="0",paddingBottom:n="0"})=>r.max-r.min-parseFloat(e)-parseFloat(n),top:(r,{top:e})=>parseFloat(e),left:(r,{left:e})=>parseFloat(e),bottom:({y:r},{top:e})=>parseFloat(e)+(r.max-r.min),right:({x:r},{left:e})=>parseFloat(e)+(r.max-r.min),x:Bz(4,13),y:Bz(5,14)};Qm.translateX=Qm.x;Qm.translateY=Qm.y;const Qf=new Set;let yO=!1,vO=!1;function CX(){if(vO){const r=Array.from(Qf).filter(i=>i.needsMeasurement),e=new Set(r.map(i=>i.element)),n=new Map;e.forEach(i=>{const s=Jue(i);s.length&&(n.set(i,s),i.render())}),r.forEach(i=>i.measureInitialState()),e.forEach(i=>{i.render();const s=n.get(i);s&&s.forEach(([o,a])=>{var l;(l=i.getValue(o))===null||l===void 0||l.set(a)})}),r.forEach(i=>i.measureEndState()),r.forEach(i=>{i.suspendedScrollY!==void 0&&window.scrollTo(0,i.suspendedScrollY)})}vO=!1,yO=!1,Qf.forEach(r=>r.complete()),Qf.clear()}function PX(){Qf.forEach(r=>{r.readKeyframes(),r.needsMeasurement&&(vO=!0)})}function ehe(){PX(),CX()}class UL{constructor(e,n,i,s,o,a=!1){this.isComplete=!1,this.isAsync=!1,this.needsMeasurement=!1,this.isScheduled=!1,this.unresolvedKeyframes=[...e],this.onComplete=n,this.name=i,this.motionValue=s,this.element=o,this.isAsync=a}scheduleResolve(){this.isScheduled=!0,this.isAsync?(Qf.add(this),yO||(yO=!0,tr.read(PX),tr.resolveKeyframes(CX))):(this.readKeyframes(),this.complete())}readKeyframes(){const{unresolvedKeyframes:e,name:n,element:i,motionValue:s}=this;for(let o=0;o<e.length;o++)if(e[o]===null)if(o===0){const a=s==null?void 0:s.get(),l=e[e.length-1];if(a!==void 0)e[0]=a;else if(i&&n){const c=i.readValue(n,l);c!=null&&(e[0]=c)}e[0]===void 0&&(e[0]=l),s&&a===void 0&&s.set(e[0])}else e[o]=e[o-1]}setFinalKeyframe(){}measureInitialState(){}renderEndStyles(){}measureEndState(){}complete(){this.isComplete=!0,this.onComplete(this.unresolvedKeyframes,this.finalKeyframe),Qf.delete(this)}cancel(){this.isComplete||(this.isScheduled=!1,Qf.delete(this))}resume(){this.isComplete||this.scheduleResolve()}}const RX=r=>/^-?(?:\d+(?:\.\d+)?|\.\d+)$/u.test(r),the=/^var\(--(?:([\w-]+)|([\w-]+), ?([a-zA-Z\d ()%#.,-]+))\)/u;function nhe(r){const e=the.exec(r);if(!e)return[,];const[,n,i,s]=e;return[`--${n??i}`,s]}function NX(r,e,n=1){const[i,s]=nhe(r);if(!i)return;const o=window.getComputedStyle(e).getPropertyValue(i);if(o){const a=o.trim();return RX(a)?parseFloat(a):a}return bL(s)?NX(s,e,n+1):s}const OX=r=>e=>e.test(r),rhe={test:r=>r==="auto",parse:r=>r},DX=[uy,Rt,Rl,Wu,Wce,Hce,rhe],Uz=r=>DX.find(OX(r));class kX extends UL{constructor(e,n,i,s,o){super(e,n,i,s,o,!0)}readKeyframes(){const{unresolvedKeyframes:e,element:n,name:i}=this;if(!n||!n.current)return;super.readKeyframes();for(let c=0;c<e.length;c++){let u=e[c];if(typeof u=="string"&&(u=u.trim(),bL(u))){const h=NX(u,n.current);h!==void 0&&(e[c]=h),c===e.length-1&&(this.finalKeyframe=u)}}if(this.resolveNoneKeyframes(),!uX.has(i)||e.length!==2)return;const[s,o]=e,a=Uz(s),l=Uz(o);if(a!==l)if(Lz(a)&&Lz(l))for(let c=0;c<e.length;c++){const u=e[c];typeof u=="string"&&(e[c]=parseFloat(u))}else this.needsMeasurement=!0}resolveNoneKeyframes(){const{unresolvedKeyframes:e,name:n}=this,i=[];for(let s=0;s<e.length;s++)Due(e[s])&&i.push(s);i.length&&Yue(e,i,n)}measureInitialState(){const{element:e,unresolvedKeyframes:n,name:i}=this;if(!e||!e.current)return;i==="height"&&(this.suspendedScrollY=window.pageYOffset),this.measuredOrigin=Qm[i](e.measureViewportBox(),window.getComputedStyle(e.current)),n[0]=this.measuredOrigin;const s=n[n.length-1];s!==void 0&&e.getValue(i,s).jump(s,!1)}measureEndState(){var e;const{element:n,name:i,unresolvedKeyframes:s}=this;if(!n||!n.current)return;const o=n.getValue(i);o&&o.jump(this.measuredOrigin,!1);const a=s.length-1,l=s[a];s[a]=Qm[i](n.measureViewportBox(),window.getComputedStyle(n.current)),l!==null&&this.finalKeyframe===void 0&&(this.finalKeyframe=l),!((e=this.removedTransforms)===null||e===void 0)&&e.length&&this.removedTransforms.forEach(([c,u])=>{n.getValue(c).set(u)}),this.resolveNoneKeyframes()}}const zz=(r,e)=>e==="zIndex"?!1:!!(typeof r=="number"||Array.isArray(r)||typeof r=="string"&&(Mh.test(r)||r==="0")&&!r.startsWith("url("));function ihe(r){const e=r[0];if(r.length===1)return!0;for(let n=0;n<r.length;n++)if(r[n]!==e)return!0}function she(r,e,n,i){const s=r[0];if(s===null)return!1;if(e==="display"||e==="visibility")return!0;const o=r[r.length-1],a=zz(s,e),l=zz(o,e);return!a||!l?!1:ihe(r)||(n==="spring"||CL(n))&&i}const ohe=r=>r!==null;function IM(r,{repeat:e,repeatType:n="loop"},i){const s=r.filter(ohe),o=e&&n!=="loop"&&e%2===1?0:s.length-1;return!o||i===void 0?s[o]:i}const ahe=40;class IX{constructor({autoplay:e=!0,delay:n=0,type:i="keyframes",repeat:s=0,repeatDelay:o=0,repeatType:a="loop",...l}){this.isStopped=!1,this.hasAttemptedResolve=!1,this.createdAt=Nl.now(),this.options={autoplay:e,delay:n,type:i,repeat:s,repeatDelay:o,repeatType:a,...l},this.updateFinishedPromise()}calcStartTime(){return this.resolvedAt?this.resolvedAt-this.createdAt>ahe?this.resolvedAt:this.createdAt:this.createdAt}get resolved(){return!this._resolved&&!this.hasAttemptedResolve&&ehe(),this._resolved}onKeyframesResolved(e,n){this.resolvedAt=Nl.now(),this.hasAttemptedResolve=!0;const{name:i,type:s,velocity:o,delay:a,onComplete:l,onUpdate:c,isGenerator:u}=this.options;if(!u&&!she(e,i,s,o))if(a)this.options.duration=0;else{c&&c(IM(e,this.options,n)),l&&l(),this.resolveFinishedPromise();return}const h=this.initPlayback(e,n);h!==!1&&(this._resolved={keyframes:e,finalKeyframe:n,...h},this.onPostResolved())}onPostResolved(){}then(e,n){return this.currentFinishedPromise.then(e,n)}flatten(){this.options.type="keyframes",this.options.ease="linear"}updateFinishedPromise(){this.currentFinishedPromise=new Promise(e=>{this.resolveFinishedPromise=e})}}const pr=(r,e,n)=>r+(e-r)*n;function nP(r,e,n){return n<0&&(n+=1),n>1&&(n-=1),n<1/6?r+(e-r)*6*n:n<1/2?e:n<2/3?r+(e-r)*(2/3-n)*6:r}function lhe({hue:r,saturation:e,lightness:n,alpha:i}){r/=360,e/=100,n/=100;let s=0,o=0,a=0;if(!e)s=o=a=n;else{const l=n<.5?n*(1+e):n+e-n*e,c=2*n-l;s=nP(c,l,r+1/3),o=nP(c,l,r),a=nP(c,l,r-1/3)}return{red:Math.round(s*255),green:Math.round(o*255),blue:Math.round(a*255),alpha:i}}function _T(r,e){return n=>n>0?e:r}const rP=(r,e,n)=>{const i=r*r,s=n*(e*e-i)+i;return s<0?0:Math.sqrt(s)},che=[mO,jf,Jp],uhe=r=>che.find(e=>e.test(r));function $z(r){const e=uhe(r);if(!e)return!1;let n=e.parse(r);return e===Jp&&(n=lhe(n)),n}const jz=(r,e)=>{const n=$z(r),i=$z(e);if(!n||!i)return _T(r,e);const s={...n};return o=>(s.red=rP(n.red,i.red,o),s.green=rP(n.green,i.green,o),s.blue=rP(n.blue,i.blue,o),s.alpha=pr(n.alpha,i.alpha,o),jf.transform(s))},hhe=(r,e)=>n=>e(r(n)),r_=(...r)=>r.reduce(hhe),xO=new Set(["none","hidden"]);function fhe(r,e){return xO.has(r)?n=>n<=0?r:e:n=>n>=1?e:r}function dhe(r,e){return n=>pr(r,e,n)}function zL(r){return typeof r=="number"?dhe:typeof r=="string"?bL(r)?_T:es.test(r)?jz:ghe:Array.isArray(r)?LX:typeof r=="object"?es.test(r)?jz:phe:_T}function LX(r,e){const n=[...r],i=n.length,s=r.map((o,a)=>zL(o)(o,e[a]));return o=>{for(let a=0;a<i;a++)n[a]=s[a](o);return n}}function phe(r,e){const n={...r,...e},i={};for(const s in n)r[s]!==void 0&&e[s]!==void 0&&(i[s]=zL(r[s])(r[s],e[s]));return s=>{for(const o in i)n[o]=i[o](s);return n}}function mhe(r,e){var n;const i=[],s={color:0,var:0,number:0};for(let o=0;o<e.values.length;o++){const a=e.types[o],l=r.indexes[a][s[a]],c=(n=r.values[l])!==null&&n!==void 0?n:0;i[o]=c,s[a]++}return i}const ghe=(r,e)=>{const n=Mh.createTransformer(e),i=wx(r),s=wx(e);return i.indexes.var.length===s.indexes.var.length&&i.indexes.color.length===s.indexes.color.length&&i.indexes.number.length>=s.indexes.number.length?xO.has(r)&&!s.values.length||xO.has(e)&&!i.values.length?fhe(r,e):r_(LX(mhe(i,s),s.values),n):_T(r,e)};function FX(r,e,n){return typeof r=="number"&&typeof e=="number"&&typeof n=="number"?pr(r,e,n):zL(r)(r,e)}const yhe=5;function BX(r,e,n){const i=Math.max(e-yhe,0);return hX(n-r(i),e-i)}const br={stiffness:100,damping:10,mass:1,velocity:0,duration:800,bounce:.3,visualDuration:.3,restSpeed:{granular:.01,default:2},restDelta:{granular:.005,default:.5},minDuration:.01,maxDuration:10,minDamping:.05,maxDamping:1},iP=.001;function vhe({duration:r=br.duration,bounce:e=br.bounce,velocity:n=br.velocity,mass:i=br.mass}){let s,o,a=1-e;a=su(br.minDamping,br.maxDamping,a),r=su(br.minDuration,br.maxDuration,Vc(r)),a<1?(s=u=>{const h=u*a,f=h*r,d=h-n,p=bO(u,a),m=Math.exp(-f);return iP-d/p*m},o=u=>{const f=u*a*r,d=f*n+n,p=Math.pow(a,2)*Math.pow(u,2)*r,m=Math.exp(-f),g=bO(Math.pow(u,2),a);return(-s(u)+iP>0?-1:1)*((d-p)*m)/g}):(s=u=>{const h=Math.exp(-u*r),f=(u-n)*r+1;return-iP+h*f},o=u=>{const h=Math.exp(-u*r),f=(n-u)*(r*r);return h*f});const l=5/r,c=bhe(s,o,l);if(r=jc(r),isNaN(c))return{stiffness:br.stiffness,damping:br.damping,duration:r};{const u=Math.pow(c,2)*i;return{stiffness:u,damping:a*2*Math.sqrt(i*u),duration:r}}}const xhe=12;function bhe(r,e,n){let i=n;for(let s=1;s<xhe;s++)i=i-r(i)/e(i);return i}function bO(r,e){return r*Math.sqrt(1-e*e)}const _he=["duration","bounce"],whe=["stiffness","damping","mass"];function Vz(r,e){return e.some(n=>r[n]!==void 0)}function She(r){let e={velocity:br.velocity,stiffness:br.stiffness,damping:br.damping,mass:br.mass,isResolvedFromDuration:!1,...r};if(!Vz(r,whe)&&Vz(r,_he))if(r.visualDuration){const n=r.visualDuration,i=2*Math.PI/(n*1.2),s=i*i,o=2*su(.05,1,1-(r.bounce||0))*Math.sqrt(s);e={...e,mass:br.mass,stiffness:s,damping:o}}else{const n=vhe(r);e={...e,...n,mass:br.mass},e.isResolvedFromDuration=!0}return e}function UX(r=br.visualDuration,e=br.bounce){const n=typeof r!="object"?{visualDuration:r,keyframes:[0,1],bounce:e}:r;let{restSpeed:i,restDelta:s}=n;const o=n.keyframes[0],a=n.keyframes[n.keyframes.length-1],l={done:!1,value:o},{stiffness:c,damping:u,mass:h,duration:f,velocity:d,isResolvedFromDuration:p}=She({...n,velocity:-Vc(n.velocity||0)}),m=d||0,g=u/(2*Math.sqrt(c*h)),v=a-o,y=Vc(Math.sqrt(c/h)),x=Math.abs(v)<5;i||(i=x?br.restSpeed.granular:br.restSpeed.default),s||(s=x?br.restDelta.granular:br.restDelta.default);let b;if(g<1){const _=bO(y,g);b=S=>{const T=Math.exp(-g*y*S);return a-T*((m+g*y*v)/_*Math.sin(_*S)+v*Math.cos(_*S))}}else if(g===1)b=_=>a-Math.exp(-y*_)*(v+(m+y*v)*_);else{const _=y*Math.sqrt(g*g-1);b=S=>{const T=Math.exp(-g*y*S),E=Math.min(_*S,300);return a-T*((m+g*y*v)*Math.sinh(E)+_*v*Math.cosh(E))/_}}const w={calculatedDuration:p&&f||null,next:_=>{const S=b(_);if(p)l.done=_>=f;else{let T=0;g<1&&(T=_===0?jc(m):BX(b,_,S));const E=Math.abs(T)<=i,M=Math.abs(a-S)<=s;l.done=E&&M}return l.value=l.done?a:S,l},toString:()=>{const _=Math.min(rX(w),fO),S=iX(T=>w.next(_*T).value,_,30);return _+"ms "+S}};return w}function Gz({keyframes:r,velocity:e=0,power:n=.8,timeConstant:i=325,bounceDamping:s=10,bounceStiffness:o=500,modifyTarget:a,min:l,max:c,restDelta:u=.5,restSpeed:h}){const f=r[0],d={done:!1,value:f},p=E=>l!==void 0&&E<l||c!==void 0&&E>c,m=E=>l===void 0?c:c===void 0||Math.abs(l-E)<Math.abs(c-E)?l:c;let g=n*e;const v=f+g,y=a===void 0?v:a(v);y!==v&&(g=y-f);const x=E=>-g*Math.exp(-E/i),b=E=>y+x(E),w=E=>{const M=x(E),A=b(E);d.done=Math.abs(M)<=u,d.value=d.done?y:A};let _,S;const T=E=>{p(d.value)&&(_=E,S=UX({keyframes:[d.value,m(d.value)],velocity:BX(b,E,d.value),damping:s,stiffness:o,restDelta:u,restSpeed:h}))};return T(0),{calculatedDuration:null,next:E=>{let M=!1;return!S&&_===void 0&&(M=!0,w(E),T(E)),_!==void 0&&E>=_?S.next(E-_):(!M&&w(E),d)}}}const The=n_(.42,0,1,1),Ehe=n_(0,0,.58,1),zX=n_(.42,0,.58,1),Mhe=r=>Array.isArray(r)&&typeof r[0]!="number",Hz={linear:Po,easeIn:The,easeInOut:zX,easeOut:Ehe,circIn:IL,circInOut:bX,circOut:xX,backIn:kL,backInOut:yX,backOut:gX,anticipate:vX},Wz=r=>{if(PL(r)){uO(r.length===4);const[e,n,i,s]=r;return n_(e,n,i,s)}else if(typeof r=="string")return uO(Hz[r]!==void 0),Hz[r];return r};function Ahe(r,e,n){const i=[],s=n||FX,o=r.length-1;for(let a=0;a<o;a++){let l=s(r[a],r[a+1]);if(e){const c=Array.isArray(e)?e[a]||Po:e;l=r_(c,l)}i.push(l)}return i}function Che(r,e,{clamp:n=!0,ease:i,mixer:s}={}){const o=r.length;if(uO(o===e.length),o===1)return()=>e[0];if(o===2&&e[0]===e[1])return()=>e[1];const a=r[0]===r[1];r[0]>r[o-1]&&(r=[...r].reverse(),e=[...e].reverse());const l=Ahe(e,i,s),c=l.length,u=h=>{if(a&&h<r[0])return e[0];let f=0;if(c>1)for(;f<r.length-2&&!(h<r[f+1]);f++);const d=Ym(r[f],r[f+1],h);return l[f](d)};return n?h=>u(su(r[0],r[o-1],h)):u}function Phe(r,e){const n=r[r.length-1];for(let i=1;i<=e;i++){const s=Ym(0,e,i);r.push(pr(n,1,s))}}function Rhe(r){const e=[0];return Phe(e,r.length-1),e}function Nhe(r,e){return r.map(n=>n*e)}function Ohe(r,e){return r.map(()=>e||zX).splice(0,r.length-1)}function wT({duration:r=300,keyframes:e,times:n,ease:i="easeInOut"}){const s=Mhe(i)?i.map(Wz):Wz(i),o={done:!1,value:e[0]},a=Nhe(n&&n.length===e.length?n:Rhe(e),r),l=Che(a,e,{ease:Array.isArray(s)?s:Ohe(e,s)});return{calculatedDuration:r,next:c=>(o.value=l(c),o.done=c>=r,o)}}const Dhe=r=>{const e=({timestamp:n})=>r(n);return{start:()=>tr.update(e,!0),stop:()=>Eh(e),now:()=>ki.isProcessing?ki.timestamp:Nl.now()}},khe={decay:Gz,inertia:Gz,tween:wT,keyframes:wT,spring:UX},Ihe=r=>r/100;class $L extends IX{constructor(e){super(e),this.holdTime=null,this.cancelTime=null,this.currentTime=0,this.playbackSpeed=1,this.pendingPlayState="running",this.startTime=null,this.state="idle",this.stop=()=>{if(this.resolver.cancel(),this.isStopped=!0,this.state==="idle")return;this.teardown();const{onStop:c}=this.options;c&&c()};const{name:n,motionValue:i,element:s,keyframes:o}=this.options,a=(s==null?void 0:s.KeyframeResolver)||UL,l=(c,u)=>this.onKeyframesResolved(c,u);this.resolver=new a(o,l,n,i,s),this.resolver.scheduleResolve()}flatten(){super.flatten(),this._resolved&&Object.assign(this._resolved,this.initPlayback(this._resolved.keyframes))}initPlayback(e){const{type:n="keyframes",repeat:i=0,repeatDelay:s=0,repeatType:o,velocity:a=0}=this.options,l=CL(n)?n:khe[n]||wT;let c,u;l!==wT&&typeof e[0]!="number"&&(c=r_(Ihe,FX(e[0],e[1])),e=[0,100]);const h=l({...this.options,keyframes:e});o==="mirror"&&(u=l({...this.options,keyframes:[...e].reverse(),velocity:-a})),h.calculatedDuration===null&&(h.calculatedDuration=rX(h));const{calculatedDuration:f}=h,d=f+s,p=d*(i+1)-s;return{generator:h,mirroredGenerator:u,mapPercentToKeyframes:c,calculatedDuration:f,resolvedDuration:d,totalDuration:p}}onPostResolved(){const{autoplay:e=!0}=this.options;this.play(),this.pendingPlayState==="paused"||!e?this.pause():this.state=this.pendingPlayState}tick(e,n=!1){const{resolved:i}=this;if(!i){const{keyframes:E}=this.options;return{done:!0,value:E[E.length-1]}}const{finalKeyframe:s,generator:o,mirroredGenerator:a,mapPercentToKeyframes:l,keyframes:c,calculatedDuration:u,totalDuration:h,resolvedDuration:f}=i;if(this.startTime===null)return o.next(0);const{delay:d,repeat:p,repeatType:m,repeatDelay:g,onUpdate:v}=this.options;this.speed>0?this.startTime=Math.min(this.startTime,e):this.speed<0&&(this.startTime=Math.min(e-h/this.speed,this.startTime)),n?this.currentTime=e:this.holdTime!==null?this.currentTime=this.holdTime:this.currentTime=Math.round(e-this.startTime)*this.speed;const y=this.currentTime-d*(this.speed>=0?1:-1),x=this.speed>=0?y<0:y>h;this.currentTime=Math.max(y,0),this.state==="finished"&&this.holdTime===null&&(this.currentTime=h);let b=this.currentTime,w=o;if(p){const E=Math.min(this.currentTime,h)/f;let M=Math.floor(E),A=E%1;!A&&E>=1&&(A=1),A===1&&M--,M=Math.min(M,p+1),!!(M%2)&&(m==="reverse"?(A=1-A,g&&(A-=g/f)):m==="mirror"&&(w=a)),b=su(0,1,A)*f}const _=x?{done:!1,value:c[0]}:w.next(b);l&&(_.value=l(_.value));let{done:S}=_;!x&&u!==null&&(S=this.speed>=0?this.currentTime>=h:this.currentTime<=0);const T=this.holdTime===null&&(this.state==="finished"||this.state==="running"&&S);return T&&s!==void 0&&(_.value=IM(c,this.options,s)),v&&v(_.value),T&&this.finish(),_}get duration(){const{resolved:e}=this;return e?Vc(e.calculatedDuration):0}get time(){return Vc(this.currentTime)}set time(e){e=jc(e),this.currentTime=e,this.holdTime!==null||this.speed===0?this.holdTime=e:this.driver&&(this.startTime=this.driver.now()-e/this.speed)}get speed(){return this.playbackSpeed}set speed(e){const n=this.playbackSpeed!==e;this.playbackSpeed=e,n&&(this.time=Vc(this.currentTime))}play(){if(this.resolver.isScheduled||this.resolver.resume(),!this._resolved){this.pendingPlayState="running";return}if(this.isStopped)return;const{driver:e=Dhe,onPlay:n,startTime:i}=this.options;this.driver||(this.driver=e(o=>this.tick(o))),n&&n();const s=this.driver.now();this.holdTime!==null?this.startTime=s-this.holdTime:this.startTime?this.state==="finished"&&(this.startTime=s):this.startTime=i??this.calcStartTime(),this.state==="finished"&&this.updateFinishedPromise(),this.cancelTime=this.startTime,this.holdTime=null,this.state="running",this.driver.start()}pause(){var e;if(!this._resolved){this.pendingPlayState="paused";return}this.state="paused",this.holdTime=(e=this.currentTime)!==null&&e!==void 0?e:0}complete(){this.state!=="running"&&this.play(),this.pendingPlayState=this.state="finished",this.holdTime=null}finish(){this.teardown(),this.state="finished";const{onComplete:e}=this.options;e&&e()}cancel(){this.cancelTime!==null&&this.tick(this.cancelTime),this.teardown(),this.updateFinishedPromise()}teardown(){this.state="idle",this.stopDriver(),this.resolveFinishedPromise(),this.updateFinishedPromise(),this.startTime=this.cancelTime=null,this.resolver.cancel()}stopDriver(){this.driver&&(this.driver.stop(),this.driver=void 0)}sample(e){return this.startTime=0,this.tick(e,!0)}}const Lhe=new Set(["opacity","clipPath","filter","transform"]);function Fhe(r,e,n,{delay:i=0,duration:s=300,repeat:o=0,repeatType:a="loop",ease:l="easeInOut",times:c}={}){const u={[e]:n};c&&(u.offset=c);const h=oX(l,s);return Array.isArray(h)&&(u.easing=h),r.animate(u,{delay:i,duration:s,easing:Array.isArray(h)?"linear":h,fill:"both",iterations:o+1,direction:a==="reverse"?"alternate":"normal"})}const Bhe=dL(()=>Object.hasOwnProperty.call(Element.prototype,"animate")),ST=10,Uhe=2e4;function zhe(r){return CL(r.type)||r.type==="spring"||!sX(r.ease)}function $he(r,e){const n=new $L({...e,keyframes:r,repeat:0,delay:0,isGenerator:!0});let i={done:!1,value:r[0]};const s=[];let o=0;for(;!i.done&&o<Uhe;)i=n.sample(o),s.push(i.value),o+=ST;return{times:void 0,keyframes:s,duration:o-ST,ease:"linear"}}const $X={anticipate:vX,backInOut:yX,circInOut:bX};function jhe(r){return r in $X}class qz extends IX{constructor(e){super(e);const{name:n,motionValue:i,element:s,keyframes:o}=this.options;this.resolver=new kX(o,(a,l)=>this.onKeyframesResolved(a,l),n,i,s),this.resolver.scheduleResolve()}initPlayback(e,n){let{duration:i=300,times:s,ease:o,type:a,motionValue:l,name:c,startTime:u}=this.options;if(!l.owner||!l.owner.current)return!1;if(typeof o=="string"&&bT()&&jhe(o)&&(o=$X[o]),zhe(this.options)){const{onComplete:f,onUpdate:d,motionValue:p,element:m,...g}=this.options,v=$he(e,g);e=v.keyframes,e.length===1&&(e[1]=e[0]),i=v.duration,s=v.times,o=v.ease,a="keyframes"}const h=Fhe(l.owner.current,c,e,{...this.options,duration:i,times:s,ease:o});return h.startTime=u??this.calcStartTime(),this.pendingTimeline?(Rz(h,this.pendingTimeline),this.pendingTimeline=void 0):h.onfinish=()=>{const{onComplete:f}=this.options;l.set(IM(e,this.options,n)),f&&f(),this.cancel(),this.resolveFinishedPromise()},{animation:h,duration:i,times:s,type:a,ease:o,keyframes:e}}get duration(){const{resolved:e}=this;if(!e)return 0;const{duration:n}=e;return Vc(n)}get time(){const{resolved:e}=this;if(!e)return 0;const{animation:n}=e;return Vc(n.currentTime||0)}set time(e){const{resolved:n}=this;if(!n)return;const{animation:i}=n;i.currentTime=jc(e)}get speed(){const{resolved:e}=this;if(!e)return 1;const{animation:n}=e;return n.playbackRate}set speed(e){const{resolved:n}=this;if(!n)return;const{animation:i}=n;i.playbackRate=e}get state(){const{resolved:e}=this;if(!e)return"idle";const{animation:n}=e;return n.playState}get startTime(){const{resolved:e}=this;if(!e)return null;const{animation:n}=e;return n.startTime}attachTimeline(e){if(!this._resolved)this.pendingTimeline=e;else{const{resolved:n}=this;if(!n)return Po;const{animation:i}=n;Rz(i,e)}return Po}play(){if(this.isStopped)return;const{resolved:e}=this;if(!e)return;const{animation:n}=e;n.playState==="finished"&&this.updateFinishedPromise(),n.play()}pause(){const{resolved:e}=this;if(!e)return;const{animation:n}=e;n.pause()}stop(){if(this.resolver.cancel(),this.isStopped=!0,this.state==="idle")return;this.resolveFinishedPromise(),this.updateFinishedPromise();const{resolved:e}=this;if(!e)return;const{animation:n,keyframes:i,duration:s,type:o,ease:a,times:l}=e;if(n.playState==="idle"||n.playState==="finished")return;if(this.time){const{motionValue:u,onUpdate:h,onComplete:f,element:d,...p}=this.options,m=new $L({...p,keyframes:i,duration:s,type:o,ease:a,times:l,isGenerator:!0}),g=jc(this.time);u.setWithVelocity(m.sample(g-ST).value,m.sample(g).value,ST)}const{onStop:c}=this.options;c&&c(),this.cancel()}complete(){const{resolved:e}=this;e&&e.animation.finish()}cancel(){const{resolved:e}=this;e&&e.animation.cancel()}static supports(e){const{motionValue:n,name:i,repeatDelay:s,repeatType:o,damping:a,type:l}=e;if(!n||!n.owner||!(n.owner.current instanceof HTMLElement))return!1;const{onUpdate:c,transformTemplate:u}=n.owner.getProps();return Bhe()&&i&&Lhe.has(i)&&!c&&!u&&!s&&o!=="mirror"&&a!==0&&l!=="inertia"}}const Vhe={type:"spring",stiffness:500,damping:25,restSpeed:10},Ghe=r=>({type:"spring",stiffness:550,damping:r===0?2*Math.sqrt(550):30,restSpeed:10}),Hhe={type:"keyframes",duration:.8},Whe={type:"keyframes",ease:[.25,.1,.35,1],duration:.3},qhe=(r,{keyframes:e})=>e.length>2?Hhe:Nd.has(r)?r.startsWith("scale")?Ghe(e[1]):Vhe:Whe;function Xhe({when:r,delay:e,delayChildren:n,staggerChildren:i,staggerDirection:s,repeat:o,repeatType:a,repeatDelay:l,from:c,elapsed:u,...h}){return!!Object.keys(h).length}const jL=(r,e,n,i={},s,o)=>a=>{const l=AL(i,r)||{},c=l.delay||i.delay||0;let{elapsed:u=0}=i;u=u-jc(c);let h={keyframes:Array.isArray(n)?n:[null,n],ease:"easeOut",velocity:e.getVelocity(),...l,delay:-u,onUpdate:d=>{e.set(d),l.onUpdate&&l.onUpdate(d)},onComplete:()=>{a(),l.onComplete&&l.onComplete()},name:r,motionValue:e,element:o?void 0:s};Xhe(l)||(h={...h,...qhe(r,h)}),h.duration&&(h.duration=jc(h.duration)),h.repeatDelay&&(h.repeatDelay=jc(h.repeatDelay)),h.from!==void 0&&(h.keyframes[0]=h.from);let f=!1;if((h.type===!1||h.duration===0&&!h.repeatDelay)&&(h.duration=0,h.delay===0&&(f=!0)),f&&!o&&e.get()!==void 0){const d=IM(h.keyframes,l);if(d!==void 0)return tr.update(()=>{h.onUpdate(d),h.onComplete()}),new pue([])}return!o&&qz.supports(h)?new qz(h):new $L(h)};function Khe({protectedKeys:r,needsAnimating:e},n){const i=r.hasOwnProperty(n)&&e[n]!==!0;return e[n]=!1,i}function jX(r,e,{delay:n=0,transitionOverride:i,type:s}={}){var o;let{transition:a=r.getDefaultTransition(),transitionEnd:l,...c}=e;i&&(a=i);const u=[],h=s&&r.animationState&&r.animationState.getState()[s];for(const f in c){const d=r.getValue(f,(o=r.latestValues[f])!==null&&o!==void 0?o:null),p=c[f];if(p===void 0||h&&Khe(h,f))continue;const m={delay:n,...AL(a||{},f)};let g=!1;if(window.MotionHandoffAnimation){const y=fX(r);if(y){const x=window.MotionHandoffAnimation(y,f,tr);x!==null&&(m.startTime=x,g=!0)}}pO(r,f),d.start(jL(f,d,p,r.shouldReduceMotion&&uX.has(f)?{type:!1}:m,r,g));const v=d.animation;v&&u.push(v)}return l&&Promise.all(u).then(()=>{tr.update(()=>{l&&Cue(r,l)})}),u}function _O(r,e,n={}){var i;const s=kM(r,e,n.type==="exit"?(i=r.presenceContext)===null||i===void 0?void 0:i.custom:void 0);let{transition:o=r.getDefaultTransition()||{}}=s||{};n.transitionOverride&&(o=n.transitionOverride);const a=s?()=>Promise.all(jX(r,s,n)):()=>Promise.resolve(),l=r.variantChildren&&r.variantChildren.size?(u=0)=>{const{delayChildren:h=0,staggerChildren:f,staggerDirection:d}=o;return Yhe(r,e,h+u,f,d,n)}:()=>Promise.resolve(),{when:c}=o;if(c){const[u,h]=c==="beforeChildren"?[a,l]:[l,a];return u().then(()=>h())}else return Promise.all([a(),l(n.delay)])}function Yhe(r,e,n=0,i=0,s=1,o){const a=[],l=(r.variantChildren.size-1)*i,c=s===1?(u=0)=>u*i:(u=0)=>l-u*i;return Array.from(r.variantChildren).sort(Zhe).forEach((u,h)=>{u.notify("AnimationStart",e),a.push(_O(u,e,{...o,delay:n+c(h)}).then(()=>u.notify("AnimationComplete",e)))}),Promise.all(a)}function Zhe(r,e){return r.sortNodePosition(e)}function Qhe(r,e,n={}){r.notify("AnimationStart",e);let i;if(Array.isArray(e)){const s=e.map(o=>_O(r,o,n));i=Promise.all(s)}else if(typeof e=="string")i=_O(r,e,n);else{const s=typeof e=="function"?kM(r,e,n.custom):e;i=Promise.all(jX(r,s,n))}return i.then(()=>{r.notify("AnimationComplete",e)})}const Jhe=mL.length;function VX(r){if(!r)return;if(!r.isControllingVariants){const n=r.parent?VX(r.parent)||{}:{};return r.props.initial!==void 0&&(n.initial=r.props.initial),n}const e={};for(let n=0;n<Jhe;n++){const i=mL[n],s=r.props[i];(xx(s)||s===!1)&&(e[i]=s)}return e}const efe=[...pL].reverse(),tfe=pL.length;function nfe(r){return e=>Promise.all(e.map(({animation:n,options:i})=>Qhe(r,n,i)))}function rfe(r){let e=nfe(r),n=Xz(),i=!0;const s=c=>(u,h)=>{var f;const d=kM(r,h,c==="exit"?(f=r.presenceContext)===null||f===void 0?void 0:f.custom:void 0);if(d){const{transition:p,transitionEnd:m,...g}=d;u={...u,...g,...m}}return u};function o(c){e=c(r)}function a(c){const{props:u}=r,h=VX(r.parent)||{},f=[],d=new Set;let p={},m=1/0;for(let v=0;v<tfe;v++){const y=efe[v],x=n[y],b=u[y]!==void 0?u[y]:h[y],w=xx(b),_=y===c?x.isActive:null;_===!1&&(m=v);let S=b===h[y]&&b!==u[y]&&w;if(S&&i&&r.manuallyAnimateOnMount&&(S=!1),x.protectedKeys={...p},!x.isActive&&_===null||!b&&!x.prevProp||OM(b)||typeof b=="boolean")continue;const T=ife(x.prevProp,b);let E=T||y===c&&x.isActive&&!S&&w||v>m&&w,M=!1;const A=Array.isArray(b)?b:[b];let P=A.reduce(s(y),{});_===!1&&(P={});const{prevResolvedValues:D={}}=x,B={...D,...P},C=z=>{E=!0,d.has(z)&&(M=!0,d.delete(z)),x.needsAnimating[z]=!0;const U=r.getValue(z);U&&(U.liveStyle=!1)};for(const z in B){const U=P[z],G=D[z];if(p.hasOwnProperty(z))continue;let H=!1;hO(U)&&hO(G)?H=!nX(U,G):H=U!==G,H?U!=null?C(z):d.add(z):U!==void 0&&d.has(z)?C(z):x.protectedKeys[z]=!0}x.prevProp=b,x.prevResolvedValues=P,x.isActive&&(p={...p,...P}),i&&r.blockInitialAnimation&&(E=!1),E&&(!(S&&T)||M)&&f.push(...A.map(z=>({animation:z,options:{type:y}})))}if(d.size){const v={};d.forEach(y=>{const x=r.getBaseTarget(y),b=r.getValue(y);b&&(b.liveStyle=!0),v[y]=x??null}),f.push({animation:v})}let g=!!f.length;return i&&(u.initial===!1||u.initial===u.animate)&&!r.manuallyAnimateOnMount&&(g=!1),i=!1,g?e(f):Promise.resolve()}function l(c,u){var h;if(n[c].isActive===u)return Promise.resolve();(h=r.variantChildren)===null||h===void 0||h.forEach(d=>{var p;return(p=d.animationState)===null||p===void 0?void 0:p.setActive(c,u)}),n[c].isActive=u;const f=a(c);for(const d in n)n[d].protectedKeys={};return f}return{animateChanges:a,setActive:l,setAnimateFunction:o,getState:()=>n,reset:()=>{n=Xz(),i=!0}}}function ife(r,e){return typeof e=="string"?e!==r:Array.isArray(e)?!nX(e,r):!1}function ef(r=!1){return{isActive:r,protectedKeys:{},needsAnimating:{},prevResolvedValues:{}}}function Xz(){return{animate:ef(!0),whileInView:ef(),whileHover:ef(),whileTap:ef(),whileDrag:ef(),whileFocus:ef(),exit:ef()}}class Bh{constructor(e){this.isMounted=!1,this.node=e}update(){}}class sfe extends Bh{constructor(e){super(e),e.animationState||(e.animationState=rfe(e))}updateAnimationControlsSubscription(){const{animate:e}=this.node.getProps();OM(e)&&(this.unmountControls=e.subscribe(this.node))}mount(){this.updateAnimationControlsSubscription()}update(){const{animate:e}=this.node.getProps(),{animate:n}=this.node.prevProps||{};e!==n&&this.updateAnimationControlsSubscription()}unmount(){var e;this.node.animationState.reset(),(e=this.unmountControls)===null||e===void 0||e.call(this)}}let ofe=0;class afe extends Bh{constructor(){super(...arguments),this.id=ofe++}update(){if(!this.node.presenceContext)return;const{isPresent:e,onExitComplete:n}=this.node.presenceContext,{isPresent:i}=this.node.prevPresenceContext||{};if(!this.node.animationState||e===i)return;const s=this.node.animationState.setActive("exit",!e);n&&!e&&s.then(()=>n(this.id))}mount(){const{register:e}=this.node.presenceContext||{};e&&(this.unmount=e(this.id))}unmount(){}}const lfe={animation:{Feature:sfe},exit:{Feature:afe}};function Sx(r,e,n,i={passive:!0}){return r.addEventListener(e,n,i),()=>r.removeEventListener(e,n)}function i_(r){return{point:{x:r.pageX,y:r.pageY}}}const cfe=r=>e=>RL(e)&&r(e,i_(e));function E0(r,e,n,i){return Sx(r,e,cfe(n),i)}const Kz=(r,e)=>Math.abs(r-e);function ufe(r,e){const n=Kz(r.x,e.x),i=Kz(r.y,e.y);return Math.sqrt(n**2+i**2)}class GX{constructor(e,n,{transformPagePoint:i,contextWindow:s,dragSnapToOrigin:o=!1}={}){if(this.startEvent=null,this.lastMoveEvent=null,this.lastMoveEventInfo=null,this.handlers={},this.contextWindow=window,this.updatePoint=()=>{if(!(this.lastMoveEvent&&this.lastMoveEventInfo))return;const f=oP(this.lastMoveEventInfo,this.history),d=this.startEvent!==null,p=ufe(f.offset,{x:0,y:0})>=3;if(!d&&!p)return;const{point:m}=f,{timestamp:g}=ki;this.history.push({...m,timestamp:g});const{onStart:v,onMove:y}=this.handlers;d||(v&&v(this.lastMoveEvent,f),this.startEvent=this.lastMoveEvent),y&&y(this.lastMoveEvent,f)},this.handlePointerMove=(f,d)=>{this.lastMoveEvent=f,this.lastMoveEventInfo=sP(d,this.transformPagePoint),tr.update(this.updatePoint,!0)},this.handlePointerUp=(f,d)=>{this.end();const{onEnd:p,onSessionEnd:m,resumeAnimation:g}=this.handlers;if(this.dragSnapToOrigin&&g&&g(),!(this.lastMoveEvent&&this.lastMoveEventInfo))return;const v=oP(f.type==="pointercancel"?this.lastMoveEventInfo:sP(d,this.transformPagePoint),this.history);this.startEvent&&p&&p(f,v),m&&m(f,v)},!RL(e))return;this.dragSnapToOrigin=o,this.handlers=n,this.transformPagePoint=i,this.contextWindow=s||window;const a=i_(e),l=sP(a,this.transformPagePoint),{point:c}=l,{timestamp:u}=ki;this.history=[{...c,timestamp:u}];const{onSessionStart:h}=n;h&&h(e,oP(l,this.history)),this.removeListeners=r_(E0(this.contextWindow,"pointermove",this.handlePointerMove),E0(this.contextWindow,"pointerup",this.handlePointerUp),E0(this.contextWindow,"pointercancel",this.handlePointerUp))}updateHandlers(e){this.handlers=e}end(){this.removeListeners&&this.removeListeners(),Eh(this.updatePoint)}}function sP(r,e){return e?{point:e(r.point)}:r}function Yz(r,e){return{x:r.x-e.x,y:r.y-e.y}}function oP({point:r},e){return{point:r,delta:Yz(r,HX(e)),offset:Yz(r,hfe(e)),velocity:ffe(e,.1)}}function hfe(r){return r[0]}function HX(r){return r[r.length-1]}function ffe(r,e){if(r.length<2)return{x:0,y:0};let n=r.length-1,i=null;const s=HX(r);for(;n>=0&&(i=r[n],!(s.timestamp-i.timestamp>jc(e)));)n--;if(!i)return{x:0,y:0};const o=Vc(s.timestamp-i.timestamp);if(o===0)return{x:0,y:0};const a={x:(s.x-i.x)/o,y:(s.y-i.y)/o};return a.x===1/0&&(a.x=0),a.y===1/0&&(a.y=0),a}const WX=1e-4,dfe=1-WX,pfe=1+WX,qX=.01,mfe=0-qX,gfe=0+qX;function Lo(r){return r.max-r.min}function yfe(r,e,n){return Math.abs(r-e)<=n}function Zz(r,e,n,i=.5){r.origin=i,r.originPoint=pr(e.min,e.max,r.origin),r.scale=Lo(n)/Lo(e),r.translate=pr(n.min,n.max,r.origin)-r.originPoint,(r.scale>=dfe&&r.scale<=pfe||isNaN(r.scale))&&(r.scale=1),(r.translate>=mfe&&r.translate<=gfe||isNaN(r.translate))&&(r.translate=0)}function M0(r,e,n,i){Zz(r.x,e.x,n.x,i?i.originX:void 0),Zz(r.y,e.y,n.y,i?i.originY:void 0)}function Qz(r,e,n){r.min=n.min+e.min,r.max=r.min+Lo(e)}function vfe(r,e,n){Qz(r.x,e.x,n.x),Qz(r.y,e.y,n.y)}function Jz(r,e,n){r.min=e.min-n.min,r.max=r.min+Lo(e)}function A0(r,e,n){Jz(r.x,e.x,n.x),Jz(r.y,e.y,n.y)}function xfe(r,{min:e,max:n},i){return e!==void 0&&r<e?r=i?pr(e,r,i.min):Math.max(r,e):n!==void 0&&r>n&&(r=i?pr(n,r,i.max):Math.min(r,n)),r}function e$(r,e,n){return{min:e!==void 0?r.min+e:void 0,max:n!==void 0?r.max+n-(r.max-r.min):void 0}}function bfe(r,{top:e,left:n,bottom:i,right:s}){return{x:e$(r.x,n,s),y:e$(r.y,e,i)}}function t$(r,e){let n=e.min-r.min,i=e.max-r.max;return e.max-e.min<r.max-r.min&&([n,i]=[i,n]),{min:n,max:i}}function _fe(r,e){return{x:t$(r.x,e.x),y:t$(r.y,e.y)}}function wfe(r,e){let n=.5;const i=Lo(r),s=Lo(e);return s>i?n=Ym(e.min,e.max-i,r.min):i>s&&(n=Ym(r.min,r.max-s,e.min)),su(0,1,n)}function Sfe(r,e){const n={};return e.min!==void 0&&(n.min=e.min-r.min),e.max!==void 0&&(n.max=e.max-r.min),n}const wO=.35;function Tfe(r=wO){return r===!1?r=0:r===!0&&(r=wO),{x:n$(r,"left","right"),y:n$(r,"top","bottom")}}function n$(r,e,n){return{min:r$(r,e),max:r$(r,n)}}function r$(r,e){return typeof r=="number"?r:r[e]||0}const i$=()=>({translate:0,scale:1,origin:0,originPoint:0}),em=()=>({x:i$(),y:i$()}),s$=()=>({min:0,max:0}),Ar=()=>({x:s$(),y:s$()});function Xo(r){return[r("x"),r("y")]}function XX({top:r,left:e,right:n,bottom:i}){return{x:{min:e,max:n},y:{min:r,max:i}}}function Efe({x:r,y:e}){return{top:e.min,right:r.max,bottom:e.max,left:r.min}}function Mfe(r,e){if(!e)return r;const n=e({x:r.left,y:r.top}),i=e({x:r.right,y:r.bottom});return{top:n.y,left:n.x,bottom:i.y,right:i.x}}function aP(r){return r===void 0||r===1}function SO({scale:r,scaleX:e,scaleY:n}){return!aP(r)||!aP(e)||!aP(n)}function wf(r){return SO(r)||KX(r)||r.z||r.rotate||r.rotateX||r.rotateY||r.skewX||r.skewY}function KX(r){return o$(r.x)||o$(r.y)}function o$(r){return r&&r!=="0%"}function TT(r,e,n){const i=r-n,s=e*i;return n+s}function a$(r,e,n,i,s){return s!==void 0&&(r=TT(r,s,i)),TT(r,n,i)+e}function TO(r,e=0,n=1,i,s){r.min=a$(r.min,e,n,i,s),r.max=a$(r.max,e,n,i,s)}function YX(r,{x:e,y:n}){TO(r.x,e.translate,e.scale,e.originPoint),TO(r.y,n.translate,n.scale,n.originPoint)}const l$=.999999999999,c$=1.0000000000001;function Afe(r,e,n,i=!1){const s=n.length;if(!s)return;e.x=e.y=1;let o,a;for(let l=0;l<s;l++){o=n[l],a=o.projectionDelta;const{visualElement:c}=o.options;c&&c.props.style&&c.props.style.display==="contents"||(i&&o.options.layoutScroll&&o.scroll&&o!==o.root&&nm(r,{x:-o.scroll.offset.x,y:-o.scroll.offset.y}),a&&(e.x*=a.x.scale,e.y*=a.y.scale,YX(r,a)),i&&wf(o.latestValues)&&nm(r,o.latestValues))}e.x<c$&&e.x>l$&&(e.x=1),e.y<c$&&e.y>l$&&(e.y=1)}function tm(r,e){r.min=r.min+e,r.max=r.max+e}function u$(r,e,n,i,s=.5){const o=pr(r.min,r.max,s);TO(r,e,n,o,i)}function nm(r,e){u$(r.x,e.x,e.scaleX,e.scale,e.originX),u$(r.y,e.y,e.scaleY,e.scale,e.originY)}function ZX(r,e){return XX(Mfe(r.getBoundingClientRect(),e))}function Cfe(r,e,n){const i=ZX(r,n),{scroll:s}=e;return s&&(tm(i.x,s.offset.x),tm(i.y,s.offset.y)),i}const QX=({current:r})=>r?r.ownerDocument.defaultView:null,Pfe=new WeakMap;class Rfe{constructor(e){this.openDragLock=null,this.isDragging=!1,this.currentDirection=null,this.originPoint={x:0,y:0},this.constraints=!1,this.hasMutatedConstraints=!1,this.elastic=Ar(),this.visualElement=e}start(e,{snapToCursor:n=!1}={}){const{presenceContext:i}=this.visualElement;if(i&&i.isPresent===!1)return;const s=h=>{const{dragSnapToOrigin:f}=this.getProps();f?this.pauseAnimation():this.stopAnimation(),n&&this.snapToCursor(i_(h).point)},o=(h,f)=>{const{drag:d,dragPropagation:p,onDragStart:m}=this.getProps();if(d&&!p&&(this.openDragLock&&this.openDragLock(),this.openDragLock=Sue(d),!this.openDragLock))return;this.isDragging=!0,this.currentDirection=null,this.resolveConstraints(),this.visualElement.projection&&(this.visualElement.projection.isAnimationBlocked=!0,this.visualElement.projection.target=void 0),Xo(v=>{let y=this.getAxisMotionValue(v).get()||0;if(Rl.test(y)){const{projection:x}=this.visualElement;if(x&&x.layout){const b=x.layout.layoutBox[v];b&&(y=Lo(b)*(parseFloat(y)/100))}}this.originPoint[v]=y}),m&&tr.postRender(()=>m(h,f)),pO(this.visualElement,"transform");const{animationState:g}=this.visualElement;g&&g.setActive("whileDrag",!0)},a=(h,f)=>{const{dragPropagation:d,dragDirectionLock:p,onDirectionLock:m,onDrag:g}=this.getProps();if(!d&&!this.openDragLock)return;const{offset:v}=f;if(p&&this.currentDirection===null){this.currentDirection=Nfe(v),this.currentDirection!==null&&m&&m(this.currentDirection);return}this.updateAxis("x",f.point,v),this.updateAxis("y",f.point,v),this.visualElement.render(),g&&g(h,f)},l=(h,f)=>this.stop(h,f),c=()=>Xo(h=>{var f;return this.getAnimationState(h)==="paused"&&((f=this.getAxisMotionValue(h).animation)===null||f===void 0?void 0:f.play())}),{dragSnapToOrigin:u}=this.getProps();this.panSession=new GX(e,{onSessionStart:s,onStart:o,onMove:a,onSessionEnd:l,resumeAnimation:c},{transformPagePoint:this.visualElement.getTransformPagePoint(),dragSnapToOrigin:u,contextWindow:QX(this.visualElement)})}stop(e,n){const i=this.isDragging;if(this.cancel(),!i)return;const{velocity:s}=n;this.startAnimation(s);const{onDragEnd:o}=this.getProps();o&&tr.postRender(()=>o(e,n))}cancel(){this.isDragging=!1;const{projection:e,animationState:n}=this.visualElement;e&&(e.isAnimationBlocked=!1),this.panSession&&this.panSession.end(),this.panSession=void 0;const{dragPropagation:i}=this.getProps();!i&&this.openDragLock&&(this.openDragLock(),this.openDragLock=null),n&&n.setActive("whileDrag",!1)}updateAxis(e,n,i){const{drag:s}=this.getProps();if(!i||!yw(e,s,this.currentDirection))return;const o=this.getAxisMotionValue(e);let a=this.originPoint[e]+i[e];this.constraints&&this.constraints[e]&&(a=xfe(a,this.constraints[e],this.elastic[e])),o.set(a)}resolveConstraints(){var e;const{dragConstraints:n,dragElastic:i}=this.getProps(),s=this.visualElement.projection&&!this.visualElement.projection.layout?this.visualElement.projection.measure(!1):(e=this.visualElement.projection)===null||e===void 0?void 0:e.layout,o=this.constraints;n&&Qp(n)?this.constraints||(this.constraints=this.resolveRefConstraints()):n&&s?this.constraints=bfe(s.layoutBox,n):this.constraints=!1,this.elastic=Tfe(i),o!==this.constraints&&s&&this.constraints&&!this.hasMutatedConstraints&&Xo(a=>{this.constraints!==!1&&this.getAxisMotionValue(a)&&(this.constraints[a]=Sfe(s.layoutBox[a],this.constraints[a]))})}resolveRefConstraints(){const{dragConstraints:e,onMeasureDragConstraints:n}=this.getProps();if(!e||!Qp(e))return!1;const i=e.current,{projection:s}=this.visualElement;if(!s||!s.layout)return!1;const o=Cfe(i,s.root,this.visualElement.getTransformPagePoint());let a=_fe(s.layout.layoutBox,o);if(n){const l=n(Efe(a));this.hasMutatedConstraints=!!l,l&&(a=XX(l))}return a}startAnimation(e){const{drag:n,dragMomentum:i,dragElastic:s,dragTransition:o,dragSnapToOrigin:a,onDragTransitionEnd:l}=this.getProps(),c=this.constraints||{},u=Xo(h=>{if(!yw(h,n,this.currentDirection))return;let f=c&&c[h]||{};a&&(f={min:0,max:0});const d=s?200:1e6,p=s?40:1e7,m={type:"inertia",velocity:i?e[h]:0,bounceStiffness:d,bounceDamping:p,timeConstant:750,restDelta:1,restSpeed:10,...o,...f};return this.startAxisValueAnimation(h,m)});return Promise.all(u).then(l)}startAxisValueAnimation(e,n){const i=this.getAxisMotionValue(e);return pO(this.visualElement,e),i.start(jL(e,i,0,n,this.visualElement,!1))}stopAnimation(){Xo(e=>this.getAxisMotionValue(e).stop())}pauseAnimation(){Xo(e=>{var n;return(n=this.getAxisMotionValue(e).animation)===null||n===void 0?void 0:n.pause()})}getAnimationState(e){var n;return(n=this.getAxisMotionValue(e).animation)===null||n===void 0?void 0:n.state}getAxisMotionValue(e){const n=`_drag${e.toUpperCase()}`,i=this.visualElement.getProps(),s=i[n];return s||this.visualElement.getValue(e,(i.initial?i.initial[e]:void 0)||0)}snapToCursor(e){Xo(n=>{const{drag:i}=this.getProps();if(!yw(n,i,this.currentDirection))return;const{projection:s}=this.visualElement,o=this.getAxisMotionValue(n);if(s&&s.layout){const{min:a,max:l}=s.layout.layoutBox[n];o.set(e[n]-pr(a,l,.5))}})}scalePositionWithinConstraints(){if(!this.visualElement.current)return;const{drag:e,dragConstraints:n}=this.getProps(),{projection:i}=this.visualElement;if(!Qp(n)||!i||!this.constraints)return;this.stopAnimation();const s={x:0,y:0};Xo(a=>{const l=this.getAxisMotionValue(a);if(l&&this.constraints!==!1){const c=l.get();s[a]=wfe({min:c,max:c},this.constraints[a])}});const{transformTemplate:o}=this.visualElement.getProps();this.visualElement.current.style.transform=o?o({},""):"none",i.root&&i.root.updateScroll(),i.updateLayout(),this.resolveConstraints(),Xo(a=>{if(!yw(a,e,null))return;const l=this.getAxisMotionValue(a),{min:c,max:u}=this.constraints[a];l.set(pr(c,u,s[a]))})}addListeners(){if(!this.visualElement.current)return;Pfe.set(this.visualElement,this);const e=this.visualElement.current,n=E0(e,"pointerdown",c=>{const{drag:u,dragListener:h=!0}=this.getProps();u&&h&&this.start(c)}),i=()=>{const{dragConstraints:c}=this.getProps();Qp(c)&&c.current&&(this.constraints=this.resolveRefConstraints())},{projection:s}=this.visualElement,o=s.addEventListener("measure",i);s&&!s.layout&&(s.root&&s.root.updateScroll(),s.updateLayout()),tr.read(i);const a=Sx(window,"resize",()=>this.scalePositionWithinConstraints()),l=s.addEventListener("didUpdate",({delta:c,hasLayoutChanged:u})=>{this.isDragging&&u&&(Xo(h=>{const f=this.getAxisMotionValue(h);f&&(this.originPoint[h]+=c[h].translate,f.set(f.get()+c[h].translate))}),this.visualElement.render())});return()=>{a(),n(),o(),l&&l()}}getProps(){const e=this.visualElement.getProps(),{drag:n=!1,dragDirectionLock:i=!1,dragPropagation:s=!1,dragConstraints:o=!1,dragElastic:a=wO,dragMomentum:l=!0}=e;return{...e,drag:n,dragDirectionLock:i,dragPropagation:s,dragConstraints:o,dragElastic:a,dragMomentum:l}}}function yw(r,e,n){return(e===!0||e===r)&&(n===null||n===r)}function Nfe(r,e=10){let n=null;return Math.abs(r.y)>e?n="y":Math.abs(r.x)>e&&(n="x"),n}class Ofe extends Bh{constructor(e){super(e),this.removeGroupControls=Po,this.removeListeners=Po,this.controls=new Rfe(e)}mount(){const{dragControls:e}=this.node.getProps();e&&(this.removeGroupControls=e.subscribe(this.controls)),this.removeListeners=this.controls.addListeners()||Po}unmount(){this.removeGroupControls(),this.removeListeners()}}const h$=r=>(e,n)=>{r&&tr.postRender(()=>r(e,n))};class Dfe extends Bh{constructor(){super(...arguments),this.removePointerDownListener=Po}onPointerDown(e){this.session=new GX(e,this.createPanHandlers(),{transformPagePoint:this.node.getTransformPagePoint(),contextWindow:QX(this.node)})}createPanHandlers(){const{onPanSessionStart:e,onPanStart:n,onPan:i,onPanEnd:s}=this.node.getProps();return{onSessionStart:h$(e),onStart:h$(n),onMove:i,onEnd:(o,a)=>{delete this.session,s&&tr.postRender(()=>s(o,a))}}}mount(){this.removePointerDownListener=E0(this.node.current,"pointerdown",e=>this.onPointerDown(e))}update(){this.session&&this.session.updateHandlers(this.createPanHandlers())}unmount(){this.removePointerDownListener(),this.session&&this.session.end()}}const T1={hasAnimatedSinceResize:!0,hasEverUpdated:!1};function f$(r,e){return e.max===e.min?0:r/(e.max-e.min)*100}const Zy={correct:(r,e)=>{if(!e.target)return r;if(typeof r=="string")if(Rt.test(r))r=parseFloat(r);else return r;const n=f$(r,e.target.x),i=f$(r,e.target.y);return`${n}% ${i}%`}},kfe={correct:(r,{treeScale:e,projectionDelta:n})=>{const i=r,s=Mh.parse(r);if(s.length>5)return i;const o=Mh.createTransformer(r),a=typeof s[0]!="number"?1:0,l=n.x.scale*e.x,c=n.y.scale*e.y;s[0+a]/=l,s[1+a]/=c;const u=pr(l,c,.5);return typeof s[2+a]=="number"&&(s[2+a]/=u),typeof s[3+a]=="number"&&(s[3+a]/=u),o(s)}};class Ife extends te.Component{componentDidMount(){const{visualElement:e,layoutGroup:n,switchLayoutGroup:i,layoutId:s}=this.props,{projection:o}=e;nue(Lfe),o&&(n.group&&n.group.add(o),i&&i.register&&s&&i.register(o),o.root.didUpdate(),o.addEventListener("animationComplete",()=>{this.safeToRemove()}),o.setOptions({...o.options,onExitComplete:()=>this.safeToRemove()})),T1.hasEverUpdated=!0}getSnapshotBeforeUpdate(e){const{layoutDependency:n,visualElement:i,drag:s,isPresent:o}=this.props,a=i.projection;return a&&(a.isPresent=o,s||e.layoutDependency!==n||n===void 0?a.willUpdate():this.safeToRemove(),e.isPresent!==o&&(o?a.promote():a.relegate()||tr.postRender(()=>{const l=a.getStack();(!l||!l.members.length)&&this.safeToRemove()}))),null}componentDidUpdate(){const{projection:e}=this.props.visualElement;e&&(e.root.didUpdate(),yL.postRender(()=>{!e.currentAnimation&&e.isLead()&&this.safeToRemove()}))}componentWillUnmount(){const{visualElement:e,layoutGroup:n,switchLayoutGroup:i}=this.props,{projection:s}=e;s&&(s.scheduleCheckAfterUnmount(),n&&n.group&&n.group.remove(s),i&&i.deregister&&i.deregister(s))}safeToRemove(){const{safeToRemove:e}=this.props;e&&e()}render(){return null}}function JX(r){const[e,n]=yce(),i=te.useContext(Lq);return N.jsx(Ife,{...r,layoutGroup:i,switchLayoutGroup:te.useContext(Vq),isPresent:e,safeToRemove:n})}const Lfe={borderRadius:{...Zy,applyTo:["borderTopLeftRadius","borderTopRightRadius","borderBottomLeftRadius","borderBottomRightRadius"]},borderTopLeftRadius:Zy,borderTopRightRadius:Zy,borderBottomLeftRadius:Zy,borderBottomRightRadius:Zy,boxShadow:kfe};function Ffe(r,e,n){const i=as(r)?r:_x(r);return i.start(jL("",i,e,n)),i.animation}function Bfe(r){return r instanceof SVGElement&&r.tagName!=="svg"}const Ufe=(r,e)=>r.depth-e.depth;class zfe{constructor(){this.children=[],this.isDirty=!1}add(e){NL(this.children,e),this.isDirty=!0}remove(e){OL(this.children,e),this.isDirty=!0}forEach(e){this.isDirty&&this.children.sort(Ufe),this.isDirty=!1,this.children.forEach(e)}}function $fe(r,e){const n=Nl.now(),i=({timestamp:s})=>{const o=s-n;o>=e&&(Eh(i),r(o-e))};return tr.read(i,!0),()=>Eh(i)}const eK=["TopLeft","TopRight","BottomLeft","BottomRight"],jfe=eK.length,d$=r=>typeof r=="string"?parseFloat(r):r,p$=r=>typeof r=="number"||Rt.test(r);function Vfe(r,e,n,i,s,o){s?(r.opacity=pr(0,n.opacity!==void 0?n.opacity:1,Gfe(i)),r.opacityExit=pr(e.opacity!==void 0?e.opacity:1,0,Hfe(i))):o&&(r.opacity=pr(e.opacity!==void 0?e.opacity:1,n.opacity!==void 0?n.opacity:1,i));for(let a=0;a<jfe;a++){const l=`border${eK[a]}Radius`;let c=m$(e,l),u=m$(n,l);if(c===void 0&&u===void 0)continue;c||(c=0),u||(u=0),c===0||u===0||p$(c)===p$(u)?(r[l]=Math.max(pr(d$(c),d$(u),i),0),(Rl.test(u)||Rl.test(c))&&(r[l]+="%")):r[l]=u}(e.rotate||n.rotate)&&(r.rotate=pr(e.rotate||0,n.rotate||0,i))}function m$(r,e){return r[e]!==void 0?r[e]:r.borderRadius}const Gfe=tK(0,.5,xX),Hfe=tK(.5,.95,Po);function tK(r,e,n){return i=>i<r?0:i>e?1:n(Ym(r,e,i))}function g$(r,e){r.min=e.min,r.max=e.max}function $o(r,e){g$(r.x,e.x),g$(r.y,e.y)}function y$(r,e){r.translate=e.translate,r.scale=e.scale,r.originPoint=e.originPoint,r.origin=e.origin}function v$(r,e,n,i,s){return r-=e,r=TT(r,1/n,i),s!==void 0&&(r=TT(r,1/s,i)),r}function Wfe(r,e=0,n=1,i=.5,s,o=r,a=r){if(Rl.test(e)&&(e=parseFloat(e),e=pr(a.min,a.max,e/100)-a.min),typeof e!="number")return;let l=pr(o.min,o.max,i);r===o&&(l-=e),r.min=v$(r.min,e,n,l,s),r.max=v$(r.max,e,n,l,s)}function x$(r,e,[n,i,s],o,a){Wfe(r,e[n],e[i],e[s],e.scale,o,a)}const qfe=["x","scaleX","originX"],Xfe=["y","scaleY","originY"];function b$(r,e,n,i){x$(r.x,e,qfe,n?n.x:void 0,i?i.x:void 0),x$(r.y,e,Xfe,n?n.y:void 0,i?i.y:void 0)}function _$(r){return r.translate===0&&r.scale===1}function nK(r){return _$(r.x)&&_$(r.y)}function w$(r,e){return r.min===e.min&&r.max===e.max}function Kfe(r,e){return w$(r.x,e.x)&&w$(r.y,e.y)}function S$(r,e){return Math.round(r.min)===Math.round(e.min)&&Math.round(r.max)===Math.round(e.max)}function rK(r,e){return S$(r.x,e.x)&&S$(r.y,e.y)}function T$(r){return Lo(r.x)/Lo(r.y)}function E$(r,e){return r.translate===e.translate&&r.scale===e.scale&&r.originPoint===e.originPoint}class Yfe{constructor(){this.members=[]}add(e){NL(this.members,e),e.scheduleRender()}remove(e){if(OL(this.members,e),e===this.prevLead&&(this.prevLead=void 0),e===this.lead){const n=this.members[this.members.length-1];n&&this.promote(n)}}relegate(e){const n=this.members.findIndex(s=>e===s);if(n===0)return!1;let i;for(let s=n;s>=0;s--){const o=this.members[s];if(o.isPresent!==!1){i=o;break}}return i?(this.promote(i),!0):!1}promote(e,n){const i=this.lead;if(e!==i&&(this.prevLead=i,this.lead=e,e.show(),i)){i.instance&&i.scheduleRender(),e.scheduleRender(),e.resumeFrom=i,n&&(e.resumeFrom.preserveOpacity=!0),i.snapshot&&(e.snapshot=i.snapshot,e.snapshot.latestValues=i.animationValues||i.latestValues),e.root&&e.root.isUpdating&&(e.isLayoutDirty=!0);const{crossfade:s}=e.options;s===!1&&i.hide()}}exitAnimationComplete(){this.members.forEach(e=>{const{options:n,resumingFrom:i}=e;n.onExitComplete&&n.onExitComplete(),i&&i.options.onExitComplete&&i.options.onExitComplete()})}scheduleRender(){this.members.forEach(e=>{e.instance&&e.scheduleRender(!1)})}removeLeadSnapshot(){this.lead&&this.lead.snapshot&&(this.lead.snapshot=void 0)}}function Zfe(r,e,n){let i="";const s=r.x.translate/e.x,o=r.y.translate/e.y,a=(n==null?void 0:n.z)||0;if((s||o||a)&&(i=`translate3d(${s}px, ${o}px, ${a}px) `),(e.x!==1||e.y!==1)&&(i+=`scale(${1/e.x}, ${1/e.y}) `),n){const{transformPerspective:u,rotate:h,rotateX:f,rotateY:d,skewX:p,skewY:m}=n;u&&(i=`perspective(${u}px) ${i}`),h&&(i+=`rotate(${h}deg) `),f&&(i+=`rotateX(${f}deg) `),d&&(i+=`rotateY(${d}deg) `),p&&(i+=`skewX(${p}deg) `),m&&(i+=`skewY(${m}deg) `)}const l=r.x.scale*e.x,c=r.y.scale*e.y;return(l!==1||c!==1)&&(i+=`scale(${l}, ${c})`),i||"none"}const Sf={type:"projectionFrame",totalNodes:0,resolvedTargetDeltas:0,recalculatedProjection:0},n0=typeof window<"u"&&window.MotionDebug!==void 0,lP=["","X","Y","Z"],Qfe={visibility:"hidden"},M$=1e3;let Jfe=0;function cP(r,e,n,i){const{latestValues:s}=e;s[r]&&(n[r]=s[r],e.setStaticValue(r,0),i&&(i[r]=0))}function iK(r){if(r.hasCheckedOptimisedAppear=!0,r.root===r)return;const{visualElement:e}=r.options;if(!e)return;const n=fX(e);if(window.MotionHasOptimisedAnimation(n,"transform")){const{layout:s,layoutId:o}=r.options;window.MotionCancelOptimisedAnimation(n,"transform",tr,!(s||o))}const{parent:i}=r;i&&!i.hasCheckedOptimisedAppear&&iK(i)}function sK({attachResizeListener:r,defaultParent:e,measureScroll:n,checkIsScrollRoot:i,resetTransform:s}){return class{constructor(a={},l=e==null?void 0:e()){this.id=Jfe++,this.animationId=0,this.children=new Set,this.options={},this.isTreeAnimating=!1,this.isAnimationBlocked=!1,this.isLayoutDirty=!1,this.isProjectionDirty=!1,this.isSharedProjectionDirty=!1,this.isTransformDirty=!1,this.updateManuallyBlocked=!1,this.updateBlockedByResize=!1,this.isUpdating=!1,this.isSVG=!1,this.needsReset=!1,this.shouldResetTransform=!1,this.hasCheckedOptimisedAppear=!1,this.treeScale={x:1,y:1},this.eventHandlers=new Map,this.hasTreeAnimated=!1,this.updateScheduled=!1,this.scheduleUpdate=()=>this.update(),this.projectionUpdateScheduled=!1,this.checkUpdateFailed=()=>{this.isUpdating&&(this.isUpdating=!1,this.clearAllSnapshots())},this.updateProjection=()=>{this.projectionUpdateScheduled=!1,n0&&(Sf.totalNodes=Sf.resolvedTargetDeltas=Sf.recalculatedProjection=0),this.nodes.forEach(nde),this.nodes.forEach(ade),this.nodes.forEach(lde),this.nodes.forEach(rde),n0&&window.MotionDebug.record(Sf)},this.resolvedRelativeTargetAt=0,this.hasProjected=!1,this.isVisible=!0,this.animationProgress=0,this.sharedNodes=new Map,this.latestValues=a,this.root=l?l.root||l:this,this.path=l?[...l.path,l]:[],this.parent=l,this.depth=l?l.depth+1:0;for(let c=0;c<this.path.length;c++)this.path[c].shouldResetTransform=!0;this.root===this&&(this.nodes=new zfe)}addEventListener(a,l){return this.eventHandlers.has(a)||this.eventHandlers.set(a,new DL),this.eventHandlers.get(a).add(l)}notifyListeners(a,...l){const c=this.eventHandlers.get(a);c&&c.notify(...l)}hasListeners(a){return this.eventHandlers.has(a)}mount(a,l=this.root.hasTreeAnimated){if(this.instance)return;this.isSVG=Bfe(a),this.instance=a;const{layoutId:c,layout:u,visualElement:h}=this.options;if(h&&!h.current&&h.mount(a),this.root.nodes.add(this),this.parent&&this.parent.children.add(this),l&&(u||c)&&(this.isLayoutDirty=!0),r){let f;const d=()=>this.root.updateBlockedByResize=!1;r(a,()=>{this.root.updateBlockedByResize=!0,f&&f(),f=$fe(d,250),T1.hasAnimatedSinceResize&&(T1.hasAnimatedSinceResize=!1,this.nodes.forEach(C$))})}c&&this.root.registerSharedNode(c,this),this.options.animate!==!1&&h&&(c||u)&&this.addEventListener("didUpdate",({delta:f,hasLayoutChanged:d,hasRelativeTargetChanged:p,layout:m})=>{if(this.isTreeAnimationBlocked()){this.target=void 0,this.relativeTarget=void 0;return}const g=this.options.transition||h.getDefaultTransition()||dde,{onLayoutAnimationStart:v,onLayoutAnimationComplete:y}=h.getProps(),x=!this.targetLayout||!rK(this.targetLayout,m)||p,b=!d&&p;if(this.options.layoutRoot||this.resumeFrom&&this.resumeFrom.instance||b||d&&(x||!this.currentAnimation)){this.resumeFrom&&(this.resumingFrom=this.resumeFrom,this.resumingFrom.resumingFrom=void 0),this.setAnimationOrigin(f,b);const w={...AL(g,"layout"),onPlay:v,onComplete:y};(h.shouldReduceMotion||this.options.layoutRoot)&&(w.delay=0,w.type=!1),this.startAnimation(w)}else d||C$(this),this.isLead()&&this.options.onExitComplete&&this.options.onExitComplete();this.targetLayout=m})}unmount(){this.options.layoutId&&this.willUpdate(),this.root.nodes.remove(this);const a=this.getStack();a&&a.remove(this),this.parent&&this.parent.children.delete(this),this.instance=void 0,Eh(this.updateProjection)}blockUpdate(){this.updateManuallyBlocked=!0}unblockUpdate(){this.updateManuallyBlocked=!1}isUpdateBlocked(){return this.updateManuallyBlocked||this.updateBlockedByResize}isTreeAnimationBlocked(){return this.isAnimationBlocked||this.parent&&this.parent.isTreeAnimationBlocked()||!1}startUpdate(){this.isUpdateBlocked()||(this.isUpdating=!0,this.nodes&&this.nodes.forEach(cde),this.animationId++)}getTransformTemplate(){const{visualElement:a}=this.options;return a&&a.getProps().transformTemplate}willUpdate(a=!0){if(this.root.hasTreeAnimated=!0,this.root.isUpdateBlocked()){this.options.onExitComplete&&this.options.onExitComplete();return}if(window.MotionCancelOptimisedAnimation&&!this.hasCheckedOptimisedAppear&&iK(this),!this.root.isUpdating&&this.root.startUpdate(),this.isLayoutDirty)return;this.isLayoutDirty=!0;for(let h=0;h<this.path.length;h++){const f=this.path[h];f.shouldResetTransform=!0,f.updateScroll("snapshot"),f.options.layoutRoot&&f.willUpdate(!1)}const{layoutId:l,layout:c}=this.options;if(l===void 0&&!c)return;const u=this.getTransformTemplate();this.prevTransformTemplateValue=u?u(this.latestValues,""):void 0,this.updateSnapshot(),a&&this.notifyListeners("willUpdate")}update(){if(this.updateScheduled=!1,this.isUpdateBlocked()){this.unblockUpdate(),this.clearAllSnapshots(),this.nodes.forEach(A$);return}this.isUpdating||this.nodes.forEach(sde),this.isUpdating=!1,this.nodes.forEach(ode),this.nodes.forEach(ede),this.nodes.forEach(tde),this.clearAllSnapshots();const l=Nl.now();ki.delta=su(0,1e3/60,l-ki.timestamp),ki.timestamp=l,ki.isProcessing=!0,JC.update.process(ki),JC.preRender.process(ki),JC.render.process(ki),ki.isProcessing=!1}didUpdate(){this.updateScheduled||(this.updateScheduled=!0,yL.read(this.scheduleUpdate))}clearAllSnapshots(){this.nodes.forEach(ide),this.sharedNodes.forEach(ude)}scheduleUpdateProjection(){this.projectionUpdateScheduled||(this.projectionUpdateScheduled=!0,tr.preRender(this.updateProjection,!1,!0))}scheduleCheckAfterUnmount(){tr.postRender(()=>{this.isLayoutDirty?this.root.didUpdate():this.root.checkUpdateFailed()})}updateSnapshot(){this.snapshot||!this.instance||(this.snapshot=this.measure())}updateLayout(){if(!this.instance||(this.updateScroll(),!(this.options.alwaysMeasureLayout&&this.isLead())&&!this.isLayoutDirty))return;if(this.resumeFrom&&!this.resumeFrom.instance)for(let c=0;c<this.path.length;c++)this.path[c].updateScroll();const a=this.layout;this.layout=this.measure(!1),this.layoutCorrected=Ar(),this.isLayoutDirty=!1,this.projectionDelta=void 0,this.notifyListeners("measure",this.layout.layoutBox);const{visualElement:l}=this.options;l&&l.notify("LayoutMeasure",this.layout.layoutBox,a?a.layoutBox:void 0)}updateScroll(a="measure"){let l=!!(this.options.layoutScroll&&this.instance);if(this.scroll&&this.scroll.animationId===this.root.animationId&&this.scroll.phase===a&&(l=!1),l){const c=i(this.instance);this.scroll={animationId:this.root.animationId,phase:a,isRoot:c,offset:n(this.instance),wasRoot:this.scroll?this.scroll.isRoot:c}}}resetTransform(){if(!s)return;const a=this.isLayoutDirty||this.shouldResetTransform||this.options.alwaysMeasureLayout,l=this.projectionDelta&&!nK(this.projectionDelta),c=this.getTransformTemplate(),u=c?c(this.latestValues,""):void 0,h=u!==this.prevTransformTemplateValue;a&&(l||wf(this.latestValues)||h)&&(s(this.instance,u),this.shouldResetTransform=!1,this.scheduleRender())}measure(a=!0){const l=this.measurePageBox();let c=this.removeElementScroll(l);return a&&(c=this.removeTransform(c)),pde(c),{animationId:this.root.animationId,measuredBox:l,layoutBox:c,latestValues:{},source:this.id}}measurePageBox(){var a;const{visualElement:l}=this.options;if(!l)return Ar();const c=l.measureViewportBox();if(!(((a=this.scroll)===null||a===void 0?void 0:a.wasRoot)||this.path.some(mde))){const{scroll:h}=this.root;h&&(tm(c.x,h.offset.x),tm(c.y,h.offset.y))}return c}removeElementScroll(a){var l;const c=Ar();if($o(c,a),!((l=this.scroll)===null||l===void 0)&&l.wasRoot)return c;for(let u=0;u<this.path.length;u++){const h=this.path[u],{scroll:f,options:d}=h;h!==this.root&&f&&d.layoutScroll&&(f.wasRoot&&$o(c,a),tm(c.x,f.offset.x),tm(c.y,f.offset.y))}return c}applyTransform(a,l=!1){const c=Ar();$o(c,a);for(let u=0;u<this.path.length;u++){const h=this.path[u];!l&&h.options.layoutScroll&&h.scroll&&h!==h.root&&nm(c,{x:-h.scroll.offset.x,y:-h.scroll.offset.y}),wf(h.latestValues)&&nm(c,h.latestValues)}return wf(this.latestValues)&&nm(c,this.latestValues),c}removeTransform(a){const l=Ar();$o(l,a);for(let c=0;c<this.path.length;c++){const u=this.path[c];if(!u.instance||!wf(u.latestValues))continue;SO(u.latestValues)&&u.updateSnapshot();const h=Ar(),f=u.measurePageBox();$o(h,f),b$(l,u.latestValues,u.snapshot?u.snapshot.layoutBox:void 0,h)}return wf(this.latestValues)&&b$(l,this.latestValues),l}setTargetDelta(a){this.targetDelta=a,this.root.scheduleUpdateProjection(),this.isProjectionDirty=!0}setOptions(a){this.options={...this.options,...a,crossfade:a.crossfade!==void 0?a.crossfade:!0}}clearMeasurements(){this.scroll=void 0,this.layout=void 0,this.snapshot=void 0,this.prevTransformTemplateValue=void 0,this.targetDelta=void 0,this.target=void 0,this.isLayoutDirty=!1}forceRelativeParentToResolveTarget(){this.relativeParent&&this.relativeParent.resolvedRelativeTargetAt!==ki.timestamp&&this.relativeParent.resolveTargetDelta(!0)}resolveTargetDelta(a=!1){var l;const c=this.getLead();this.isProjectionDirty||(this.isProjectionDirty=c.isProjectionDirty),this.isTransformDirty||(this.isTransformDirty=c.isTransformDirty),this.isSharedProjectionDirty||(this.isSharedProjectionDirty=c.isSharedProjectionDirty);const u=!!this.resumingFrom||this!==c;if(!(a||u&&this.isSharedProjectionDirty||this.isProjectionDirty||!((l=this.parent)===null||l===void 0)&&l.isProjectionDirty||this.attemptToResolveRelativeTarget||this.root.updateBlockedByResize))return;const{layout:f,layoutId:d}=this.options;if(!(!this.layout||!(f||d))){if(this.resolvedRelativeTargetAt=ki.timestamp,!this.targetDelta&&!this.relativeTarget){const p=this.getClosestProjectingParent();p&&p.layout&&this.animationProgress!==1?(this.relativeParent=p,this.forceRelativeParentToResolveTarget(),this.relativeTarget=Ar(),this.relativeTargetOrigin=Ar(),A0(this.relativeTargetOrigin,this.layout.layoutBox,p.layout.layoutBox),$o(this.relativeTarget,this.relativeTargetOrigin)):this.relativeParent=this.relativeTarget=void 0}if(!(!this.relativeTarget&&!this.targetDelta)){if(this.target||(this.target=Ar(),this.targetWithTransforms=Ar()),this.relativeTarget&&this.relativeTargetOrigin&&this.relativeParent&&this.relativeParent.target?(this.forceRelativeParentToResolveTarget(),vfe(this.target,this.relativeTarget,this.relativeParent.target)):this.targetDelta?(this.resumingFrom?this.target=this.applyTransform(this.layout.layoutBox):$o(this.target,this.layout.layoutBox),YX(this.target,this.targetDelta)):$o(this.target,this.layout.layoutBox),this.attemptToResolveRelativeTarget){this.attemptToResolveRelativeTarget=!1;const p=this.getClosestProjectingParent();p&&!!p.resumingFrom==!!this.resumingFrom&&!p.options.layoutScroll&&p.target&&this.animationProgress!==1?(this.relativeParent=p,this.forceRelativeParentToResolveTarget(),this.relativeTarget=Ar(),this.relativeTargetOrigin=Ar(),A0(this.relativeTargetOrigin,this.target,p.target),$o(this.relativeTarget,this.relativeTargetOrigin)):this.relativeParent=this.relativeTarget=void 0}n0&&Sf.resolvedTargetDeltas++}}}getClosestProjectingParent(){if(!(!this.parent||SO(this.parent.latestValues)||KX(this.parent.latestValues)))return this.parent.isProjecting()?this.parent:this.parent.getClosestProjectingParent()}isProjecting(){return!!((this.relativeTarget||this.targetDelta||this.options.layoutRoot)&&this.layout)}calcProjection(){var a;const l=this.getLead(),c=!!this.resumingFrom||this!==l;let u=!0;if((this.isProjectionDirty||!((a=this.parent)===null||a===void 0)&&a.isProjectionDirty)&&(u=!1),c&&(this.isSharedProjectionDirty||this.isTransformDirty)&&(u=!1),this.resolvedRelativeTargetAt===ki.timestamp&&(u=!1),u)return;const{layout:h,layoutId:f}=this.options;if(this.isTreeAnimating=!!(this.parent&&this.parent.isTreeAnimating||this.currentAnimation||this.pendingAnimation),this.isTreeAnimating||(this.targetDelta=this.relativeTarget=void 0),!this.layout||!(h||f))return;$o(this.layoutCorrected,this.layout.layoutBox);const d=this.treeScale.x,p=this.treeScale.y;Afe(this.layoutCorrected,this.treeScale,this.path,c),l.layout&&!l.target&&(this.treeScale.x!==1||this.treeScale.y!==1)&&(l.target=l.layout.layoutBox,l.targetWithTransforms=Ar());const{target:m}=l;if(!m){this.prevProjectionDelta&&(this.createProjectionDeltas(),this.scheduleRender());return}!this.projectionDelta||!this.prevProjectionDelta?this.createProjectionDeltas():(y$(this.prevProjectionDelta.x,this.projectionDelta.x),y$(this.prevProjectionDelta.y,this.projectionDelta.y)),M0(this.projectionDelta,this.layoutCorrected,m,this.latestValues),(this.treeScale.x!==d||this.treeScale.y!==p||!E$(this.projectionDelta.x,this.prevProjectionDelta.x)||!E$(this.projectionDelta.y,this.prevProjectionDelta.y))&&(this.hasProjected=!0,this.scheduleRender(),this.notifyListeners("projectionUpdate",m)),n0&&Sf.recalculatedProjection++}hide(){this.isVisible=!1}show(){this.isVisible=!0}scheduleRender(a=!0){var l;if((l=this.options.visualElement)===null||l===void 0||l.scheduleRender(),a){const c=this.getStack();c&&c.scheduleRender()}this.resumingFrom&&!this.resumingFrom.instance&&(this.resumingFrom=void 0)}createProjectionDeltas(){this.prevProjectionDelta=em(),this.projectionDelta=em(),this.projectionDeltaWithTransform=em()}setAnimationOrigin(a,l=!1){const c=this.snapshot,u=c?c.latestValues:{},h={...this.latestValues},f=em();(!this.relativeParent||!this.relativeParent.options.layoutRoot)&&(this.relativeTarget=this.relativeTargetOrigin=void 0),this.attemptToResolveRelativeTarget=!l;const d=Ar(),p=c?c.source:void 0,m=this.layout?this.layout.source:void 0,g=p!==m,v=this.getStack(),y=!v||v.members.length<=1,x=!!(g&&!y&&this.options.crossfade===!0&&!this.path.some(fde));this.animationProgress=0;let b;this.mixTargetDelta=w=>{const _=w/1e3;P$(f.x,a.x,_),P$(f.y,a.y,_),this.setTargetDelta(f),this.relativeTarget&&this.relativeTargetOrigin&&this.layout&&this.relativeParent&&this.relativeParent.layout&&(A0(d,this.layout.layoutBox,this.relativeParent.layout.layoutBox),hde(this.relativeTarget,this.relativeTargetOrigin,d,_),b&&Kfe(this.relativeTarget,b)&&(this.isProjectionDirty=!1),b||(b=Ar()),$o(b,this.relativeTarget)),g&&(this.animationValues=h,Vfe(h,u,this.latestValues,_,x,y)),this.root.scheduleUpdateProjection(),this.scheduleRender(),this.animationProgress=_},this.mixTargetDelta(this.options.layoutRoot?1e3:0)}startAnimation(a){this.notifyListeners("animationStart"),this.currentAnimation&&this.currentAnimation.stop(),this.resumingFrom&&this.resumingFrom.currentAnimation&&this.resumingFrom.currentAnimation.stop(),this.pendingAnimation&&(Eh(this.pendingAnimation),this.pendingAnimation=void 0),this.pendingAnimation=tr.update(()=>{T1.hasAnimatedSinceResize=!0,this.currentAnimation=Ffe(0,M$,{...a,onUpdate:l=>{this.mixTargetDelta(l),a.onUpdate&&a.onUpdate(l)},onComplete:()=>{a.onComplete&&a.onComplete(),this.completeAnimation()}}),this.resumingFrom&&(this.resumingFrom.currentAnimation=this.currentAnimation),this.pendingAnimation=void 0})}completeAnimation(){this.resumingFrom&&(this.resumingFrom.currentAnimation=void 0,this.resumingFrom.preserveOpacity=void 0);const a=this.getStack();a&&a.exitAnimationComplete(),this.resumingFrom=this.currentAnimation=this.animationValues=void 0,this.notifyListeners("animationComplete")}finishAnimation(){this.currentAnimation&&(this.mixTargetDelta&&this.mixTargetDelta(M$),this.currentAnimation.stop()),this.completeAnimation()}applyTransformsToTarget(){const a=this.getLead();let{targetWithTransforms:l,target:c,layout:u,latestValues:h}=a;if(!(!l||!c||!u)){if(this!==a&&this.layout&&u&&oK(this.options.animationType,this.layout.layoutBox,u.layoutBox)){c=this.target||Ar();const f=Lo(this.layout.layoutBox.x);c.x.min=a.target.x.min,c.x.max=c.x.min+f;const d=Lo(this.layout.layoutBox.y);c.y.min=a.target.y.min,c.y.max=c.y.min+d}$o(l,c),nm(l,h),M0(this.projectionDeltaWithTransform,this.layoutCorrected,l,h)}}registerSharedNode(a,l){this.sharedNodes.has(a)||this.sharedNodes.set(a,new Yfe),this.sharedNodes.get(a).add(l);const u=l.options.initialPromotionConfig;l.promote({transition:u?u.transition:void 0,preserveFollowOpacity:u&&u.shouldPreserveFollowOpacity?u.shouldPreserveFollowOpacity(l):void 0})}isLead(){const a=this.getStack();return a?a.lead===this:!0}getLead(){var a;const{layoutId:l}=this.options;return l?((a=this.getStack())===null||a===void 0?void 0:a.lead)||this:this}getPrevLead(){var a;const{layoutId:l}=this.options;return l?(a=this.getStack())===null||a===void 0?void 0:a.prevLead:void 0}getStack(){const{layoutId:a}=this.options;if(a)return this.root.sharedNodes.get(a)}promote({needsReset:a,transition:l,preserveFollowOpacity:c}={}){const u=this.getStack();u&&u.promote(this,c),a&&(this.projectionDelta=void 0,this.needsReset=!0),l&&this.setOptions({transition:l})}relegate(){const a=this.getStack();return a?a.relegate(this):!1}resetSkewAndRotation(){const{visualElement:a}=this.options;if(!a)return;let l=!1;const{latestValues:c}=a;if((c.z||c.rotate||c.rotateX||c.rotateY||c.rotateZ||c.skewX||c.skewY)&&(l=!0),!l)return;const u={};c.z&&cP("z",a,u,this.animationValues);for(let h=0;h<lP.length;h++)cP(`rotate${lP[h]}`,a,u,this.animationValues),cP(`skew${lP[h]}`,a,u,this.animationValues);a.render();for(const h in u)a.setStaticValue(h,u[h]),this.animationValues&&(this.animationValues[h]=u[h]);a.scheduleRender()}getProjectionStyles(a){var l,c;if(!this.instance||this.isSVG)return;if(!this.isVisible)return Qfe;const u={visibility:""},h=this.getTransformTemplate();if(this.needsReset)return this.needsReset=!1,u.opacity="",u.pointerEvents=w1(a==null?void 0:a.pointerEvents)||"",u.transform=h?h(this.latestValues,""):"none",u;const f=this.getLead();if(!this.projectionDelta||!this.layout||!f.target){const g={};return this.options.layoutId&&(g.opacity=this.latestValues.opacity!==void 0?this.latestValues.opacity:1,g.pointerEvents=w1(a==null?void 0:a.pointerEvents)||""),this.hasProjected&&!wf(this.latestValues)&&(g.transform=h?h({},""):"none",this.hasProjected=!1),g}const d=f.animationValues||f.latestValues;this.applyTransformsToTarget(),u.transform=Zfe(this.projectionDeltaWithTransform,this.treeScale,d),h&&(u.transform=h(d,u.transform));const{x:p,y:m}=this.projectionDelta;u.transformOrigin=`${p.origin*100}% ${m.origin*100}% 0`,f.animationValues?u.opacity=f===this?(c=(l=d.opacity)!==null&&l!==void 0?l:this.latestValues.opacity)!==null&&c!==void 0?c:1:this.preserveOpacity?this.latestValues.opacity:d.opacityExit:u.opacity=f===this?d.opacity!==void 0?d.opacity:"":d.opacityExit!==void 0?d.opacityExit:0;for(const g in xT){if(d[g]===void 0)continue;const{correct:v,applyTo:y}=xT[g],x=u.transform==="none"?d[g]:v(d[g],f);if(y){const b=y.length;for(let w=0;w<b;w++)u[y[w]]=x}else u[g]=x}return this.options.layoutId&&(u.pointerEvents=f===this?w1(a==null?void 0:a.pointerEvents)||"":"none"),u}clearSnapshot(){this.resumeFrom=this.snapshot=void 0}resetTree(){this.root.nodes.forEach(a=>{var l;return(l=a.currentAnimation)===null||l===void 0?void 0:l.stop()}),this.root.nodes.forEach(A$),this.root.sharedNodes.clear()}}}function ede(r){r.updateLayout()}function tde(r){var e;const n=((e=r.resumeFrom)===null||e===void 0?void 0:e.snapshot)||r.snapshot;if(r.isLead()&&r.layout&&n&&r.hasListeners("didUpdate")){const{layoutBox:i,measuredBox:s}=r.layout,{animationType:o}=r.options,a=n.source!==r.layout.source;o==="size"?Xo(f=>{const d=a?n.measuredBox[f]:n.layoutBox[f],p=Lo(d);d.min=i[f].min,d.max=d.min+p}):oK(o,n.layoutBox,i)&&Xo(f=>{const d=a?n.measuredBox[f]:n.layoutBox[f],p=Lo(i[f]);d.max=d.min+p,r.relativeTarget&&!r.currentAnimation&&(r.isProjectionDirty=!0,r.relativeTarget[f].max=r.relativeTarget[f].min+p)});const l=em();M0(l,i,n.layoutBox);const c=em();a?M0(c,r.applyTransform(s,!0),n.measuredBox):M0(c,i,n.layoutBox);const u=!nK(l);let h=!1;if(!r.resumeFrom){const f=r.getClosestProjectingParent();if(f&&!f.resumeFrom){const{snapshot:d,layout:p}=f;if(d&&p){const m=Ar();A0(m,n.layoutBox,d.layoutBox);const g=Ar();A0(g,i,p.layoutBox),rK(m,g)||(h=!0),f.options.layoutRoot&&(r.relativeTarget=g,r.relativeTargetOrigin=m,r.relativeParent=f)}}}r.notifyListeners("didUpdate",{layout:i,snapshot:n,delta:c,layoutDelta:l,hasLayoutChanged:u,hasRelativeTargetChanged:h})}else if(r.isLead()){const{onExitComplete:i}=r.options;i&&i()}r.options.transition=void 0}function nde(r){n0&&Sf.totalNodes++,r.parent&&(r.isProjecting()||(r.isProjectionDirty=r.parent.isProjectionDirty),r.isSharedProjectionDirty||(r.isSharedProjectionDirty=!!(r.isProjectionDirty||r.parent.isProjectionDirty||r.parent.isSharedProjectionDirty)),r.isTransformDirty||(r.isTransformDirty=r.parent.isTransformDirty))}function rde(r){r.isProjectionDirty=r.isSharedProjectionDirty=r.isTransformDirty=!1}function ide(r){r.clearSnapshot()}function A$(r){r.clearMeasurements()}function sde(r){r.isLayoutDirty=!1}function ode(r){const{visualElement:e}=r.options;e&&e.getProps().onBeforeLayoutMeasure&&e.notify("BeforeLayoutMeasure"),r.resetTransform()}function C$(r){r.finishAnimation(),r.targetDelta=r.relativeTarget=r.target=void 0,r.isProjectionDirty=!0}function ade(r){r.resolveTargetDelta()}function lde(r){r.calcProjection()}function cde(r){r.resetSkewAndRotation()}function ude(r){r.removeLeadSnapshot()}function P$(r,e,n){r.translate=pr(e.translate,0,n),r.scale=pr(e.scale,1,n),r.origin=e.origin,r.originPoint=e.originPoint}function R$(r,e,n,i){r.min=pr(e.min,n.min,i),r.max=pr(e.max,n.max,i)}function hde(r,e,n,i){R$(r.x,e.x,n.x,i),R$(r.y,e.y,n.y,i)}function fde(r){return r.animationValues&&r.animationValues.opacityExit!==void 0}const dde={duration:.45,ease:[.4,0,.1,1]},N$=r=>typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().includes(r),O$=N$("applewebkit/")&&!N$("chrome/")?Math.round:Po;function D$(r){r.min=O$(r.min),r.max=O$(r.max)}function pde(r){D$(r.x),D$(r.y)}function oK(r,e,n){return r==="position"||r==="preserve-aspect"&&!yfe(T$(e),T$(n),.2)}function mde(r){var e;return r!==r.root&&((e=r.scroll)===null||e===void 0?void 0:e.wasRoot)}const gde=sK({attachResizeListener:(r,e)=>Sx(r,"resize",e),measureScroll:()=>({x:document.documentElement.scrollLeft||document.body.scrollLeft,y:document.documentElement.scrollTop||document.body.scrollTop}),checkIsScrollRoot:()=>!0}),uP={current:void 0},aK=sK({measureScroll:r=>({x:r.scrollLeft,y:r.scrollTop}),defaultParent:()=>{if(!uP.current){const r=new gde({});r.mount(window),r.setOptions({layoutScroll:!0}),uP.current=r}return uP.current},resetTransform:(r,e)=>{r.style.transform=e!==void 0?e:"none"},checkIsScrollRoot:r=>window.getComputedStyle(r).position==="fixed"}),yde={pan:{Feature:Dfe},drag:{Feature:Ofe,ProjectionNode:aK,MeasureLayout:JX}};function k$(r,e,n){const{props:i}=r;r.animationState&&i.whileHover&&r.animationState.setActive("whileHover",n==="Start");const s="onHover"+n,o=i[s];o&&tr.postRender(()=>o(e,i_(e)))}class vde extends Bh{mount(){const{current:e}=this.node;e&&(this.unmount=vue(e,n=>(k$(this.node,n,"Start"),i=>k$(this.node,i,"End"))))}unmount(){}}class xde extends Bh{constructor(){super(...arguments),this.isActive=!1}onFocus(){let e=!1;try{e=this.node.current.matches(":focus-visible")}catch{e=!0}!e||!this.node.animationState||(this.node.animationState.setActive("whileFocus",!0),this.isActive=!0)}onBlur(){!this.isActive||!this.node.animationState||(this.node.animationState.setActive("whileFocus",!1),this.isActive=!1)}mount(){this.unmount=r_(Sx(this.node.current,"focus",()=>this.onFocus()),Sx(this.node.current,"blur",()=>this.onBlur()))}unmount(){}}function I$(r,e,n){const{props:i}=r;r.animationState&&i.whileTap&&r.animationState.setActive("whileTap",n==="Start");const s="onTap"+(n==="End"?"":n),o=i[s];o&&tr.postRender(()=>o(e,i_(e)))}class bde extends Bh{mount(){const{current:e}=this.node;e&&(this.unmount=wue(e,n=>(I$(this.node,n,"Start"),(i,{success:s})=>I$(this.node,i,s?"End":"Cancel")),{useGlobalTarget:this.node.props.globalTapTarget}))}unmount(){}}const EO=new WeakMap,hP=new WeakMap,_de=r=>{const e=EO.get(r.target);e&&e(r)},wde=r=>{r.forEach(_de)};function Sde({root:r,...e}){const n=r||document;hP.has(n)||hP.set(n,{});const i=hP.get(n),s=JSON.stringify(e);return i[s]||(i[s]=new IntersectionObserver(wde,{root:r,...e})),i[s]}function Tde(r,e,n){const i=Sde(e);return EO.set(r,n),i.observe(r),()=>{EO.delete(r),i.unobserve(r)}}const Ede={some:0,all:1};class Mde extends Bh{constructor(){super(...arguments),this.hasEnteredView=!1,this.isInView=!1}startObserver(){this.unmount();const{viewport:e={}}=this.node.getProps(),{root:n,margin:i,amount:s="some",once:o}=e,a={root:n?n.current:void 0,rootMargin:i,threshold:typeof s=="number"?s:Ede[s]},l=c=>{const{isIntersecting:u}=c;if(this.isInView===u||(this.isInView=u,o&&!u&&this.hasEnteredView))return;u&&(this.hasEnteredView=!0),this.node.animationState&&this.node.animationState.setActive("whileInView",u);const{onViewportEnter:h,onViewportLeave:f}=this.node.getProps(),d=u?h:f;d&&d(c)};return Tde(this.node.current,a,l)}mount(){this.startObserver()}update(){if(typeof IntersectionObserver>"u")return;const{props:e,prevProps:n}=this.node;["amount","margin","root"].some(Ade(e,n))&&this.startObserver()}unmount(){}}function Ade({viewport:r={}},{viewport:e={}}={}){return n=>r[n]!==e[n]}const Cde={inView:{Feature:Mde},tap:{Feature:bde},focus:{Feature:xde},hover:{Feature:vde}},Pde={layout:{ProjectionNode:aK,MeasureLayout:JX}},MO={current:null},lK={current:!1};function Rde(){if(lK.current=!0,!!fL)if(window.matchMedia){const r=window.matchMedia("(prefers-reduced-motion)"),e=()=>MO.current=r.matches;r.addListener(e),e()}else MO.current=!1}const Nde=[...DX,es,Mh],Ode=r=>Nde.find(OX(r)),L$=new WeakMap;function Dde(r,e,n){for(const i in e){const s=e[i],o=n[i];if(as(s))r.addValue(i,s);else if(as(o))r.addValue(i,_x(s,{owner:r}));else if(o!==s)if(r.hasValue(i)){const a=r.getValue(i);a.liveStyle===!0?a.jump(s):a.hasAnimated||a.set(s)}else{const a=r.getStaticValue(i);r.addValue(i,_x(a!==void 0?a:s,{owner:r}))}}for(const i in n)e[i]===void 0&&r.removeValue(i);return e}const F$=["AnimationStart","AnimationComplete","Update","BeforeLayoutMeasure","LayoutMeasure","LayoutAnimationStart","LayoutAnimationComplete"];class kde{scrapeMotionValuesFromProps(e,n,i){return{}}constructor({parent:e,props:n,presenceContext:i,reducedMotionConfig:s,blockInitialAnimation:o,visualState:a},l={}){this.current=null,this.children=new Set,this.isVariantNode=!1,this.isControllingVariants=!1,this.shouldReduceMotion=null,this.values=new Map,this.KeyframeResolver=UL,this.features={},this.valueSubscriptions=new Map,this.prevMotionValues={},this.events={},this.propEventSubscriptions={},this.notifyUpdate=()=>this.notify("Update",this.latestValues),this.render=()=>{this.current&&(this.triggerBuild(),this.renderInstance(this.current,this.renderState,this.props.style,this.projection))},this.renderScheduledAt=0,this.scheduleRender=()=>{const p=Nl.now();this.renderScheduledAt<p&&(this.renderScheduledAt=p,tr.render(this.render,!1,!0))};const{latestValues:c,renderState:u,onUpdate:h}=a;this.onUpdate=h,this.latestValues=c,this.baseTarget={...c},this.initialValues=n.initial?{...c}:{},this.renderState=u,this.parent=e,this.props=n,this.presenceContext=i,this.depth=e?e.depth+1:0,this.reducedMotionConfig=s,this.options=l,this.blockInitialAnimation=!!o,this.isControllingVariants=DM(n),this.isVariantNode=$q(n),this.isVariantNode&&(this.variantChildren=new Set),this.manuallyAnimateOnMount=!!(e&&e.current);const{willChange:f,...d}=this.scrapeMotionValuesFromProps(n,{},this);for(const p in d){const m=d[p];c[p]!==void 0&&as(m)&&m.set(c[p],!1)}}mount(e){this.current=e,L$.set(e,this),this.projection&&!this.projection.instance&&this.projection.mount(e),this.parent&&this.isVariantNode&&!this.isControllingVariants&&(this.removeFromVariantTree=this.parent.addVariantChild(this)),this.values.forEach((n,i)=>this.bindToMotionValue(i,n)),lK.current||Rde(),this.shouldReduceMotion=this.reducedMotionConfig==="never"?!1:this.reducedMotionConfig==="always"?!0:MO.current,this.parent&&this.parent.children.add(this),this.update(this.props,this.presenceContext)}unmount(){L$.delete(this.current),this.projection&&this.projection.unmount(),Eh(this.notifyUpdate),Eh(this.render),this.valueSubscriptions.forEach(e=>e()),this.valueSubscriptions.clear(),this.removeFromVariantTree&&this.removeFromVariantTree(),this.parent&&this.parent.children.delete(this);for(const e in this.events)this.events[e].clear();for(const e in this.features){const n=this.features[e];n&&(n.unmount(),n.isMounted=!1)}this.current=null}bindToMotionValue(e,n){this.valueSubscriptions.has(e)&&this.valueSubscriptions.get(e)();const i=Nd.has(e),s=n.on("change",l=>{this.latestValues[e]=l,this.props.onUpdate&&tr.preRender(this.notifyUpdate),i&&this.projection&&(this.projection.isTransformDirty=!0)}),o=n.on("renderRequest",this.scheduleRender);let a;window.MotionCheckAppearSync&&(a=window.MotionCheckAppearSync(this,e,n)),this.valueSubscriptions.set(e,()=>{s(),o(),a&&a(),n.owner&&n.stop()})}sortNodePosition(e){return!this.current||!this.sortInstanceNodePosition||this.type!==e.type?0:this.sortInstanceNodePosition(this.current,e.current)}updateFeatures(){let e="animation";for(e in Zm){const n=Zm[e];if(!n)continue;const{isEnabled:i,Feature:s}=n;if(!this.features[e]&&s&&i(this.props)&&(this.features[e]=new s(this)),this.features[e]){const o=this.features[e];o.isMounted?o.update():(o.mount(),o.isMounted=!0)}}}triggerBuild(){this.build(this.renderState,this.latestValues,this.props)}measureViewportBox(){return this.current?this.measureInstanceViewportBox(this.current,this.props):Ar()}getStaticValue(e){return this.latestValues[e]}setStaticValue(e,n){this.latestValues[e]=n}update(e,n){(e.transformTemplate||this.props.transformTemplate)&&this.scheduleRender(),this.prevProps=this.props,this.props=e,this.prevPresenceContext=this.presenceContext,this.presenceContext=n;for(let i=0;i<F$.length;i++){const s=F$[i];this.propEventSubscriptions[s]&&(this.propEventSubscriptions[s](),delete this.propEventSubscriptions[s]);const o="on"+s,a=e[o];a&&(this.propEventSubscriptions[s]=this.on(s,a))}this.prevMotionValues=Dde(this,this.scrapeMotionValuesFromProps(e,this.prevProps,this),this.prevMotionValues),this.handleChildMotionValue&&this.handleChildMotionValue(),this.onUpdate&&this.onUpdate(this)}getProps(){return this.props}getVariant(e){return this.props.variants?this.props.variants[e]:void 0}getDefaultTransition(){return this.props.transition}getTransformPagePoint(){return this.props.transformPagePoint}getClosestVariantNode(){return this.isVariantNode?this:this.parent?this.parent.getClosestVariantNode():void 0}addVariantChild(e){const n=this.getClosestVariantNode();if(n)return n.variantChildren&&n.variantChildren.add(e),()=>n.variantChildren.delete(e)}addValue(e,n){const i=this.values.get(e);n!==i&&(i&&this.removeValue(e),this.bindToMotionValue(e,n),this.values.set(e,n),this.latestValues[e]=n.get())}removeValue(e){this.values.delete(e);const n=this.valueSubscriptions.get(e);n&&(n(),this.valueSubscriptions.delete(e)),delete this.latestValues[e],this.removeValueFromRenderState(e,this.renderState)}hasValue(e){return this.values.has(e)}getValue(e,n){if(this.props.values&&this.props.values[e])return this.props.values[e];let i=this.values.get(e);return i===void 0&&n!==void 0&&(i=_x(n===null?void 0:n,{owner:this}),this.addValue(e,i)),i}readValue(e,n){var i;let s=this.latestValues[e]!==void 0||!this.current?this.latestValues[e]:(i=this.getBaseTargetFromProps(this.props,e))!==null&&i!==void 0?i:this.readValueFromInstance(this.current,e,this.options);return s!=null&&(typeof s=="string"&&(RX(s)||_X(s))?s=parseFloat(s):!Ode(s)&&Mh.test(n)&&(s=AX(e,n)),this.setBaseTarget(e,as(s)?s.get():s)),as(s)?s.get():s}setBaseTarget(e,n){this.baseTarget[e]=n}getBaseTarget(e){var n;const{initial:i}=this.props;let s;if(typeof i=="string"||typeof i=="object"){const a=xL(this.props,i,(n=this.presenceContext)===null||n===void 0?void 0:n.custom);a&&(s=a[e])}if(i&&s!==void 0)return s;const o=this.getBaseTargetFromProps(this.props,e);return o!==void 0&&!as(o)?o:this.initialValues[e]!==void 0&&s===void 0?void 0:this.baseTarget[e]}on(e,n){return this.events[e]||(this.events[e]=new DL),this.events[e].add(n)}notify(e,...n){this.events[e]&&this.events[e].notify(...n)}}class cK extends kde{constructor(){super(...arguments),this.KeyframeResolver=kX}sortInstanceNodePosition(e,n){return e.compareDocumentPosition(n)&2?1:-1}getBaseTargetFromProps(e,n){return e.style?e.style[n]:void 0}removeValueFromRenderState(e,{vars:n,style:i}){delete n[e],delete i[e]}handleChildMotionValue(){this.childSubscription&&(this.childSubscription(),delete this.childSubscription);const{children:e}=this.props;as(e)&&(this.childSubscription=e.on("change",n=>{this.current&&(this.current.textContent=`${n}`)}))}}function Ide(r){return window.getComputedStyle(r)}class Lde extends cK{constructor(){super(...arguments),this.type="html",this.renderInstance=Yq}readValueFromInstance(e,n){if(Nd.has(n)){const i=BL(n);return i&&i.default||0}else{const i=Ide(e),s=(qq(n)?i.getPropertyValue(n):i[n])||0;return typeof s=="string"?s.trim():s}}measureInstanceViewportBox(e,{transformPagePoint:n}){return ZX(e,n)}build(e,n,i){wL(e,n,i.transformTemplate)}scrapeMotionValuesFromProps(e,n,i){return ML(e,n,i)}}class Fde extends cK{constructor(){super(...arguments),this.type="svg",this.isSVGTag=!1,this.measureInstanceViewportBox=Ar}getBaseTargetFromProps(e,n){return e[n]}readValueFromInstance(e,n){if(Nd.has(n)){const i=BL(n);return i&&i.default||0}return n=Zq.has(n)?n:gL(n),e.getAttribute(n)}scrapeMotionValuesFromProps(e,n,i){return eX(e,n,i)}build(e,n,i){SL(e,n,this.isSVGTag,i.transformTemplate)}renderInstance(e,n,i,s){Qq(e,n,i,s)}mount(e){this.isSVGTag=EL(e.tagName),super.mount(e)}}const Bde=(r,e)=>vL(r)?new Fde(e):new Lde(e,{allowProjection:r!==te.Fragment}),Ude=hue({...lfe,...Cde,...yde,...Pde},Bde),zde=Mce(Ude),s_=({children:r})=>N.jsxs("div",{className:"min-h-screen bg-gray-50 dark:bg-gray-900 flex flex-col",children:[N.jsx(mce,{}),N.jsx(zde.main,{className:"flex-1",initial:{opacity:0,y:10},animate:{opacity:1,y:0},exit:{opacity:0,y:10},transition:{duration:.3},children:r}),N.jsx("footer",{className:"py-6 border-t border-gray-200 dark:border-gray-700",children:N.jsx("div",{className:"px-4 sm:px-6 lg:px-8 mx-auto",children:N.jsxs("p",{className:"text-sm text-center text-gray-500 dark:text-gray-400",children:["McKinsey 7S Model Simulator  ",new Date().getFullYear()]})})})]}),hr=({className:r,children:e,variant:n="primary",size:i="md",disabled:s,isLoading:o,...a})=>{const l="font-medium rounded-md inline-flex items-center justify-center transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-offset-2 disabled:opacity-50 disabled:pointer-events-none",c={primary:"bg-blue-600 text-white hover:bg-blue-700 dark:bg-blue-600 dark:hover:bg-blue-700",secondary:"bg-gray-100 text-gray-900 hover:bg-gray-200 dark:bg-gray-700 dark:text-gray-100 dark:hover:bg-gray-600",outline:"border border-gray-300 bg-transparent hover:bg-gray-100 dark:border-gray-600 dark:hover:bg-gray-800 dark:text-gray-100",ghost:"bg-transparent hover:bg-gray-100 dark:hover:bg-gray-800 dark:text-gray-100",danger:"bg-red-600 text-white hover:bg-red-700 dark:bg-red-600 dark:hover:bg-red-700"},u={sm:"text-sm h-8 px-3",md:"text-sm h-10 px-4",lg:"text-base h-12 px-6"};return N.jsxs("button",{className:Vl(l,c[n],u[i],o&&"opacity-70 cursor-not-allowed",r),disabled:s||o,...a,children:[o?N.jsx("span",{className:"mr-2 inline-block h-4 w-4 animate-spin rounded-full border-2 border-current border-t-transparent"}):null,e]})},$de=()=>{const r=oy(),{simulation:e,resetSimulation:n}=ly(),i=()=>{n(),r("/profile")},s=()=>{r("/simulation")};return N.jsx(s_,{children:N.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-12",children:[N.jsxs("div",{className:"text-center mb-12",children:[N.jsx("h1",{className:"text-4xl font-bold text-gray-900 dark:text-white",children:"McKinsey 7S Model Simulator"}),N.jsx("p",{className:"mt-4 text-xl text-gray-600 dark:text-gray-300 max-w-3xl mx-auto",children:"Explore the dynamic relationships among the 7S elements and simulate real-time strategic decision-making."})]}),N.jsxs("div",{className:"flex justify-center space-x-6 mb-16",children:[N.jsx(hr,{size:"lg",onClick:i,children:"Start New Simulation"}),e.company&&N.jsx(hr,{size:"lg",variant:"secondary",onClick:s,children:"Continue Simulation"})]}),N.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-8",children:[N.jsx(vw,{title:"Company Profile",description:"Set up your company's profile with industry, size, structure, and key characteristics.",icon:N.jsx(sle,{className:"h-8 w-8 text-blue-600"})}),N.jsx(vw,{title:"7S Model Visualization",description:"Visualize the interconnections between Strategy, Structure, Systems, Shared Values, Skills, Style, and Staff.",icon:N.jsx(Sq,{className:"h-8 w-8 text-blue-600"})}),N.jsx(vw,{title:"Strategic Decision-Making",description:"Make decisions across various scenarios and see their impact on the 7S elements in real-time.",icon:N.jsx(Tq,{className:"h-8 w-8 text-blue-600"})}),N.jsx(vw,{title:"Results & Analytics",description:"Track KPIs, alignment scores, and system health to understand the impact of your decisions.",icon:N.jsx(ile,{className:"h-8 w-8 text-blue-600"})})]}),N.jsxs("div",{className:"mt-16 bg-blue-50 dark:bg-blue-900/20 rounded-2xl p-8",children:[N.jsx("h2",{className:"text-2xl font-bold text-gray-900 dark:text-white mb-4",children:"About the McKinsey 7S Model"}),N.jsx("p",{className:"text-gray-600 dark:text-gray-300 mb-4",children:"The McKinsey 7S Model is a framework for analyzing organizational effectiveness. It examines the alignment of seven internal elements to ensure that an organization can achieve its objectives."}),N.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6 mt-8",children:[N.jsxs("div",{className:"bg-white dark:bg-gray-800 p-4 rounded-xl shadow-sm",children:[N.jsx("h3",{className:"font-bold text-lg mb-2 text-blue-600",children:"Hard Elements"}),N.jsxs("ul",{className:"space-y-2 text-gray-600 dark:text-gray-300",children:[N.jsxs("li",{children:[N.jsx("span",{className:"font-medium",children:"Strategy:"})," Direction and competitive positioning"]}),N.jsxs("li",{children:[N.jsx("span",{className:"font-medium",children:"Structure:"})," Organization and reporting lines"]}),N.jsxs("li",{children:[N.jsx("span",{className:"font-medium",children:"Systems:"})," Business processes and information flows"]})]})]}),N.jsxs("div",{className:"bg-white dark:bg-gray-800 p-4 rounded-xl shadow-sm",children:[N.jsx("h3",{className:"font-bold text-lg mb-2 text-purple-600",children:"Soft Elements"}),N.jsxs("ul",{className:"space-y-2 text-gray-600 dark:text-gray-300",children:[N.jsxs("li",{children:[N.jsx("span",{className:"font-medium",children:"Shared Values:"})," Core beliefs and corporate culture"]}),N.jsxs("li",{children:[N.jsx("span",{className:"font-medium",children:"Skills:"})," Capabilities and competencies"]}),N.jsxs("li",{children:[N.jsx("span",{className:"font-medium",children:"Style:"})," Leadership approach"]}),N.jsxs("li",{children:[N.jsx("span",{className:"font-medium",children:"Staff:"})," Workforce demographics and attitudes"]})]})]}),N.jsxs("div",{className:"bg-white dark:bg-gray-800 p-4 rounded-xl shadow-sm",children:[N.jsx("h3",{className:"font-bold text-lg mb-2 text-green-600",children:"CAS Integration"}),N.jsxs("ul",{className:"space-y-2 text-gray-600 dark:text-gray-300",children:[N.jsxs("li",{children:[N.jsx("span",{className:"font-medium",children:"Interconnectedness:"})," Elements affect each other"]}),N.jsxs("li",{children:[N.jsx("span",{className:"font-medium",children:"Feedback Loops:"})," Circular causality patterns"]}),N.jsxs("li",{children:[N.jsx("span",{className:"font-medium",children:"Emergence:"})," Complex behaviors from simple rules"]}),N.jsxs("li",{children:[N.jsx("span",{className:"font-medium",children:"Adaptation:"})," System responds to changes"]})]})]})]})]})]})})},vw=({title:r,description:e,icon:n})=>N.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl shadow-sm p-6 border border-gray-100 dark:border-gray-700 transition-transform hover:-translate-y-1",children:[N.jsx("div",{className:"mb-4",children:n}),N.jsx("h3",{className:"text-xl font-semibold text-gray-900 dark:text-white mb-2",children:r}),N.jsx("p",{className:"text-gray-600 dark:text-gray-300",children:e})]});var o_=r=>r.type==="checkbox",Vf=r=>r instanceof Date,_s=r=>r==null;const uK=r=>typeof r=="object";var Or=r=>!_s(r)&&!Array.isArray(r)&&uK(r)&&!Vf(r),jde=r=>Or(r)&&r.target?o_(r.target)?r.target.checked:r.target.value:r,Vde=r=>r.substring(0,r.search(/\.\d+(\.|$)/))||r,Gde=(r,e)=>r.has(Vde(e)),Hde=r=>{const e=r.constructor&&r.constructor.prototype;return Or(e)&&e.hasOwnProperty("isPrototypeOf")},VL=typeof window<"u"&&typeof window.HTMLElement<"u"&&typeof document<"u";function Ji(r){let e;const n=Array.isArray(r),i=typeof FileList<"u"?r instanceof FileList:!1;if(r instanceof Date)e=new Date(r);else if(r instanceof Set)e=new Set(r);else if(!(VL&&(r instanceof Blob||i))&&(n||Or(r)))if(e=n?[]:{},!n&&!Hde(r))e=r;else for(const s in r)r.hasOwnProperty(s)&&(e[s]=Ji(r[s]));else return r;return e}var LM=r=>Array.isArray(r)?r.filter(Boolean):[],$r=r=>r===void 0,ft=(r,e,n)=>{if(!e||!Or(r))return n;const i=LM(e.split(/[,[\].]+?/)).reduce((s,o)=>_s(s)?s:s[o],r);return $r(i)||i===r?$r(r[e])?n:r[e]:i},yl=r=>typeof r=="boolean",GL=r=>/^\w*$/.test(r),hK=r=>LM(r.replace(/["|']|\]/g,"").split(/\.|\[/)),Wn=(r,e,n)=>{let i=-1;const s=GL(e)?[e]:hK(e),o=s.length,a=o-1;for(;++i<o;){const l=s[i];let c=n;if(i!==a){const u=r[l];c=Or(u)||Array.isArray(u)?u:isNaN(+s[i+1])?{}:[]}if(l==="__proto__"||l==="constructor"||l==="prototype")return;r[l]=c,r=r[l]}};const B$={BLUR:"blur",FOCUS_OUT:"focusout",CHANGE:"change"},Va={onBlur:"onBlur",onChange:"onChange",onSubmit:"onSubmit",onTouched:"onTouched",all:"all"},Jl={max:"max",min:"min",maxLength:"maxLength",minLength:"minLength",pattern:"pattern",required:"required",validate:"validate"};Z.createContext(null);var Wde=(r,e,n,i=!0)=>{const s={defaultValues:e._defaultValues};for(const o in r)Object.defineProperty(s,o,{get:()=>{const a=o;return e._proxyFormState[a]!==Va.all&&(e._proxyFormState[a]=!i||Va.all),r[a]}});return s};const qde=typeof window<"u"?te.useLayoutEffect:te.useEffect;var wl=r=>typeof r=="string",Xde=(r,e,n,i,s)=>wl(r)?(i&&e.watch.add(r),ft(n,r,s)):Array.isArray(r)?r.map(o=>(i&&e.watch.add(o),ft(n,o))):(i&&(e.watchAll=!0),n),Kde=(r,e,n,i,s)=>e?{...n[r],types:{...n[r]&&n[r].types?n[r].types:{},[i]:s||!0}}:{},C0=r=>Array.isArray(r)?r:[r],U$=()=>{let r=[];return{get observers(){return r},next:s=>{for(const o of r)o.next&&o.next(s)},subscribe:s=>(r.push(s),{unsubscribe:()=>{r=r.filter(o=>o!==s)}}),unsubscribe:()=>{r=[]}}},AO=r=>_s(r)||!uK(r);function Ju(r,e){if(AO(r)||AO(e))return r===e;if(Vf(r)&&Vf(e))return r.getTime()===e.getTime();const n=Object.keys(r),i=Object.keys(e);if(n.length!==i.length)return!1;for(const s of n){const o=r[s];if(!i.includes(s))return!1;if(s!=="ref"){const a=e[s];if(Vf(o)&&Vf(a)||Or(o)&&Or(a)||Array.isArray(o)&&Array.isArray(a)?!Ju(o,a):o!==a)return!1}}return!0}var xs=r=>Or(r)&&!Object.keys(r).length,HL=r=>r.type==="file",Ga=r=>typeof r=="function",ET=r=>{if(!VL)return!1;const e=r?r.ownerDocument:0;return r instanceof(e&&e.defaultView?e.defaultView.HTMLElement:HTMLElement)},fK=r=>r.type==="select-multiple",WL=r=>r.type==="radio",Yde=r=>WL(r)||o_(r),fP=r=>ET(r)&&r.isConnected;function Zde(r,e){const n=e.slice(0,-1).length;let i=0;for(;i<n;)r=$r(r)?i++:r[e[i++]];return r}function Qde(r){for(const e in r)if(r.hasOwnProperty(e)&&!$r(r[e]))return!1;return!0}function ii(r,e){const n=Array.isArray(e)?e:GL(e)?[e]:hK(e),i=n.length===1?r:Zde(r,n),s=n.length-1,o=n[s];return i&&delete i[o],s!==0&&(Or(i)&&xs(i)||Array.isArray(i)&&Qde(i))&&ii(r,n.slice(0,-1)),r}var dK=r=>{for(const e in r)if(Ga(r[e]))return!0;return!1};function MT(r,e={}){const n=Array.isArray(r);if(Or(r)||n)for(const i in r)Array.isArray(r[i])||Or(r[i])&&!dK(r[i])?(e[i]=Array.isArray(r[i])?[]:{},MT(r[i],e[i])):_s(r[i])||(e[i]=!0);return e}function pK(r,e,n){const i=Array.isArray(r);if(Or(r)||i)for(const s in r)Array.isArray(r[s])||Or(r[s])&&!dK(r[s])?$r(e)||AO(n[s])?n[s]=Array.isArray(r[s])?MT(r[s],[]):{...MT(r[s])}:pK(r[s],_s(e)?{}:e[s],n[s]):n[s]=!Ju(r[s],e[s]);return n}var Qy=(r,e)=>pK(r,e,MT(e));const z$={value:!1,isValid:!1},$$={value:!0,isValid:!0};var mK=r=>{if(Array.isArray(r)){if(r.length>1){const e=r.filter(n=>n&&n.checked&&!n.disabled).map(n=>n.value);return{value:e,isValid:!!e.length}}return r[0].checked&&!r[0].disabled?r[0].attributes&&!$r(r[0].attributes.value)?$r(r[0].value)||r[0].value===""?$$:{value:r[0].value,isValid:!0}:$$:z$}return z$},gK=(r,{valueAsNumber:e,valueAsDate:n,setValueAs:i})=>$r(r)?r:e?r===""?NaN:r&&+r:n&&wl(r)?new Date(r):i?i(r):r;const j$={isValid:!1,value:null};var yK=r=>Array.isArray(r)?r.reduce((e,n)=>n&&n.checked&&!n.disabled?{isValid:!0,value:n.value}:e,j$):j$;function V$(r){const e=r.ref;return HL(e)?e.files:WL(e)?yK(r.refs).value:fK(e)?[...e.selectedOptions].map(({value:n})=>n):o_(e)?mK(r.refs).value:gK($r(e.value)?r.ref.value:e.value,r)}var Jde=(r,e,n,i)=>{const s={};for(const o of r){const a=ft(e,o);a&&Wn(s,o,a._f)}return{criteriaMode:n,names:[...r],fields:s,shouldUseNativeValidation:i}},AT=r=>r instanceof RegExp,Jy=r=>$r(r)?r:AT(r)?r.source:Or(r)?AT(r.value)?r.value.source:r.value:r,G$=r=>({isOnSubmit:!r||r===Va.onSubmit,isOnBlur:r===Va.onBlur,isOnChange:r===Va.onChange,isOnAll:r===Va.all,isOnTouch:r===Va.onTouched});const H$="AsyncFunction";var epe=r=>!!r&&!!r.validate&&!!(Ga(r.validate)&&r.validate.constructor.name===H$||Or(r.validate)&&Object.values(r.validate).find(e=>e.constructor.name===H$)),tpe=r=>r.mount&&(r.required||r.min||r.max||r.maxLength||r.minLength||r.pattern||r.validate),W$=(r,e,n)=>!n&&(e.watchAll||e.watch.has(r)||[...e.watch].some(i=>r.startsWith(i)&&/^\.\w+/.test(r.slice(i.length))));const P0=(r,e,n,i)=>{for(const s of n||Object.keys(r)){const o=ft(r,s);if(o){const{_f:a,...l}=o;if(a){if(a.refs&&a.refs[0]&&e(a.refs[0],s)&&!i)return!0;if(a.ref&&e(a.ref,a.name)&&!i)return!0;if(P0(l,e))break}else if(Or(l)&&P0(l,e))break}}};function q$(r,e,n){const i=ft(r,n);if(i||GL(n))return{error:i,name:n};const s=n.split(".");for(;s.length;){const o=s.join("."),a=ft(e,o),l=ft(r,o);if(a&&!Array.isArray(a)&&n!==o)return{name:n};if(l&&l.type)return{name:o,error:l};s.pop()}return{name:n}}var npe=(r,e,n,i)=>{n(r);const{name:s,...o}=r;return xs(o)||Object.keys(o).length>=Object.keys(e).length||Object.keys(o).find(a=>e[a]===(!i||Va.all))},rpe=(r,e,n)=>!r||!e||r===e||C0(r).some(i=>i&&(n?i===e:i.startsWith(e)||e.startsWith(i))),ipe=(r,e,n,i,s)=>s.isOnAll?!1:!n&&s.isOnTouch?!(e||r):(n?i.isOnBlur:s.isOnBlur)?!r:(n?i.isOnChange:s.isOnChange)?r:!0,spe=(r,e)=>!LM(ft(r,e)).length&&ii(r,e),ope=(r,e,n)=>{const i=C0(ft(r,n));return Wn(i,"root",e[n]),Wn(r,n,i),r},E1=r=>wl(r);function X$(r,e,n="validate"){if(E1(r)||Array.isArray(r)&&r.every(E1)||yl(r)&&!r)return{type:n,message:E1(r)?r:"",ref:e}}var Gd=r=>Or(r)&&!AT(r)?r:{value:r,message:""},K$=async(r,e,n,i,s,o)=>{const{ref:a,refs:l,required:c,maxLength:u,minLength:h,min:f,max:d,pattern:p,validate:m,name:g,valueAsNumber:v,mount:y}=r._f,x=ft(n,g);if(!y||e.has(g))return{};const b=l?l[0]:a,w=D=>{s&&b.reportValidity&&(b.setCustomValidity(yl(D)?"":D||""),b.reportValidity())},_={},S=WL(a),T=o_(a),E=S||T,M=(v||HL(a))&&$r(a.value)&&$r(x)||ET(a)&&a.value===""||x===""||Array.isArray(x)&&!x.length,A=Kde.bind(null,g,i,_),P=(D,B,C,O=Jl.maxLength,R=Jl.minLength)=>{const z=D?B:C;_[g]={type:D?O:R,message:z,ref:a,...A(D?O:R,z)}};if(o?!Array.isArray(x)||!x.length:c&&(!E&&(M||_s(x))||yl(x)&&!x||T&&!mK(l).isValid||S&&!yK(l).isValid)){const{value:D,message:B}=E1(c)?{value:!!c,message:c}:Gd(c);if(D&&(_[g]={type:Jl.required,message:B,ref:b,...A(Jl.required,B)},!i))return w(B),_}if(!M&&(!_s(f)||!_s(d))){let D,B;const C=Gd(d),O=Gd(f);if(!_s(x)&&!isNaN(x)){const R=a.valueAsNumber||x&&+x;_s(C.value)||(D=R>C.value),_s(O.value)||(B=R<O.value)}else{const R=a.valueAsDate||new Date(x),z=H=>new Date(new Date().toDateString()+" "+H),U=a.type=="time",G=a.type=="week";wl(C.value)&&x&&(D=U?z(x)>z(C.value):G?x>C.value:R>new Date(C.value)),wl(O.value)&&x&&(B=U?z(x)<z(O.value):G?x<O.value:R<new Date(O.value))}if((D||B)&&(P(!!D,C.message,O.message,Jl.max,Jl.min),!i))return w(_[g].message),_}if((u||h)&&!M&&(wl(x)||o&&Array.isArray(x))){const D=Gd(u),B=Gd(h),C=!_s(D.value)&&x.length>+D.value,O=!_s(B.value)&&x.length<+B.value;if((C||O)&&(P(C,D.message,B.message),!i))return w(_[g].message),_}if(p&&!M&&wl(x)){const{value:D,message:B}=Gd(p);if(AT(D)&&!x.match(D)&&(_[g]={type:Jl.pattern,message:B,ref:a,...A(Jl.pattern,B)},!i))return w(B),_}if(m){if(Ga(m)){const D=await m(x,n),B=X$(D,b);if(B&&(_[g]={...B,...A(Jl.validate,B.message)},!i))return w(B.message),_}else if(Or(m)){let D={};for(const B in m){if(!xs(D)&&!i)break;const C=X$(await m[B](x,n),b,B);C&&(D={...C,...A(B,C.message)},w(C.message),i&&(_[g]=D))}if(!xs(D)&&(_[g]={ref:b,...D},!i))return _}}return w(!0),_};const ape={mode:Va.onSubmit,reValidateMode:Va.onChange,shouldFocusError:!0};function lpe(r={}){let e={...ape,...r},n={submitCount:0,isDirty:!1,isReady:!1,isLoading:Ga(e.defaultValues),isValidating:!1,isSubmitted:!1,isSubmitting:!1,isSubmitSuccessful:!1,isValid:!1,touchedFields:{},dirtyFields:{},validatingFields:{},errors:e.errors||{},disabled:e.disabled||!1};const i={};let s=Or(e.defaultValues)||Or(e.values)?Ji(e.defaultValues||e.values)||{}:{},o=e.shouldUnregister?{}:Ji(s),a={action:!1,mount:!1,watch:!1},l={mount:new Set,disabled:new Set,unMount:new Set,array:new Set,watch:new Set},c,u=0;const h={isDirty:!1,dirtyFields:!1,validatingFields:!1,touchedFields:!1,isValidating:!1,isValid:!1,errors:!1};let f={...h};const d={array:U$(),state:U$()},p=e.criteriaMode===Va.all,m=X=>I=>{clearTimeout(u),u=setTimeout(X,I)},g=async X=>{if(!e.disabled&&(h.isValid||f.isValid||X)){const I=e.resolver?xs((await T()).errors):await M(i,!0);I!==n.isValid&&d.state.next({isValid:I})}},v=(X,I)=>{!e.disabled&&(h.isValidating||h.validatingFields||f.isValidating||f.validatingFields)&&((X||Array.from(l.mount)).forEach(k=>{k&&(I?Wn(n.validatingFields,k,I):ii(n.validatingFields,k))}),d.state.next({validatingFields:n.validatingFields,isValidating:!xs(n.validatingFields)}))},y=(X,I=[],k,ne,ae=!0,ce=!0)=>{if(ne&&k&&!e.disabled){if(a.action=!0,ce&&Array.isArray(ft(i,X))){const pe=k(ft(i,X),ne.argA,ne.argB);ae&&Wn(i,X,pe)}if(ce&&Array.isArray(ft(n.errors,X))){const pe=k(ft(n.errors,X),ne.argA,ne.argB);ae&&Wn(n.errors,X,pe),spe(n.errors,X)}if((h.touchedFields||f.touchedFields)&&ce&&Array.isArray(ft(n.touchedFields,X))){const pe=k(ft(n.touchedFields,X),ne.argA,ne.argB);ae&&Wn(n.touchedFields,X,pe)}(h.dirtyFields||f.dirtyFields)&&(n.dirtyFields=Qy(s,o)),d.state.next({name:X,isDirty:P(X,I),dirtyFields:n.dirtyFields,errors:n.errors,isValid:n.isValid})}else Wn(o,X,I)},x=(X,I)=>{Wn(n.errors,X,I),d.state.next({errors:n.errors})},b=X=>{n.errors=X,d.state.next({errors:n.errors,isValid:!1})},w=(X,I,k,ne)=>{const ae=ft(i,X);if(ae){const ce=ft(o,X,$r(k)?ft(s,X):k);$r(ce)||ne&&ne.defaultChecked||I?Wn(o,X,I?ce:V$(ae._f)):C(X,ce),a.mount&&g()}},_=(X,I,k,ne,ae)=>{let ce=!1,pe=!1;const ze={name:X};if(!e.disabled){if(!k||ne){(h.isDirty||f.isDirty)&&(pe=n.isDirty,n.isDirty=ze.isDirty=P(),ce=pe!==ze.isDirty);const ke=Ju(ft(s,X),I);pe=!!ft(n.dirtyFields,X),ke?ii(n.dirtyFields,X):Wn(n.dirtyFields,X,!0),ze.dirtyFields=n.dirtyFields,ce=ce||(h.dirtyFields||f.dirtyFields)&&pe!==!ke}if(k){const ke=ft(n.touchedFields,X);ke||(Wn(n.touchedFields,X,k),ze.touchedFields=n.touchedFields,ce=ce||(h.touchedFields||f.touchedFields)&&ke!==k)}ce&&ae&&d.state.next(ze)}return ce?ze:{}},S=(X,I,k,ne)=>{const ae=ft(n.errors,X),ce=(h.isValid||f.isValid)&&yl(I)&&n.isValid!==I;if(e.delayError&&k?(c=m(()=>x(X,k)),c(e.delayError)):(clearTimeout(u),c=null,k?Wn(n.errors,X,k):ii(n.errors,X)),(k?!Ju(ae,k):ae)||!xs(ne)||ce){const pe={...ne,...ce&&yl(I)?{isValid:I}:{},errors:n.errors,name:X};n={...n,...pe},d.state.next(pe)}},T=async X=>{v(X,!0);const I=await e.resolver(o,e.context,Jde(X||l.mount,i,e.criteriaMode,e.shouldUseNativeValidation));return v(X),I},E=async X=>{const{errors:I}=await T(X);if(X)for(const k of X){const ne=ft(I,k);ne?Wn(n.errors,k,ne):ii(n.errors,k)}else n.errors=I;return I},M=async(X,I,k={valid:!0})=>{for(const ne in X){const ae=X[ne];if(ae){const{_f:ce,...pe}=ae;if(ce){const ze=l.array.has(ce.name),ke=ae._f&&epe(ae._f);ke&&h.validatingFields&&v([ne],!0);const lt=await K$(ae,l.disabled,o,p,e.shouldUseNativeValidation&&!I,ze);if(ke&&h.validatingFields&&v([ne]),lt[ce.name]&&(k.valid=!1,I))break;!I&&(ft(lt,ce.name)?ze?ope(n.errors,lt,ce.name):Wn(n.errors,ce.name,lt[ce.name]):ii(n.errors,ce.name))}!xs(pe)&&await M(pe,I,k)}}return k.valid},A=()=>{for(const X of l.unMount){const I=ft(i,X);I&&(I._f.refs?I._f.refs.every(k=>!fP(k)):!fP(I._f.ref))&&oe(X)}l.unMount=new Set},P=(X,I)=>!e.disabled&&(X&&I&&Wn(o,X,I),!Ju(H(),s)),D=(X,I,k)=>Xde(X,l,{...a.mount?o:$r(I)?s:wl(X)?{[X]:I}:I},k,I),B=X=>LM(ft(a.mount?o:s,X,e.shouldUnregister?ft(s,X,[]):[])),C=(X,I,k={})=>{const ne=ft(i,X);let ae=I;if(ne){const ce=ne._f;ce&&(!ce.disabled&&Wn(o,X,gK(I,ce)),ae=ET(ce.ref)&&_s(I)?"":I,fK(ce.ref)?[...ce.ref.options].forEach(pe=>pe.selected=ae.includes(pe.value)):ce.refs?o_(ce.ref)?ce.refs.forEach(pe=>{(!pe.defaultChecked||!pe.disabled)&&(Array.isArray(ae)?pe.checked=!!ae.find(ze=>ze===pe.value):pe.checked=ae===pe.value||!!ae)}):ce.refs.forEach(pe=>pe.checked=pe.value===ae):HL(ce.ref)?ce.ref.value="":(ce.ref.value=ae,ce.ref.type||d.state.next({name:X,values:Ji(o)})))}(k.shouldDirty||k.shouldTouch)&&_(X,ae,k.shouldTouch,k.shouldDirty,!0),k.shouldValidate&&G(X)},O=(X,I,k)=>{for(const ne in I){if(!I.hasOwnProperty(ne))return;const ae=I[ne],ce=`${X}.${ne}`,pe=ft(i,ce);(l.array.has(X)||Or(ae)||pe&&!pe._f)&&!Vf(ae)?O(ce,ae,k):C(ce,ae,k)}},R=(X,I,k={})=>{const ne=ft(i,X),ae=l.array.has(X),ce=Ji(I);Wn(o,X,ce),ae?(d.array.next({name:X,values:Ji(o)}),(h.isDirty||h.dirtyFields||f.isDirty||f.dirtyFields)&&k.shouldDirty&&d.state.next({name:X,dirtyFields:Qy(s,o),isDirty:P(X,ce)})):ne&&!ne._f&&!_s(ce)?O(X,ce,k):C(X,ce,k),W$(X,l)&&d.state.next({...n}),d.state.next({name:a.mount?X:void 0,values:Ji(o)})},z=async X=>{a.mount=!0;const I=X.target;let k=I.name,ne=!0;const ae=ft(i,k),ce=ke=>{ne=Number.isNaN(ke)||Vf(ke)&&isNaN(ke.getTime())||Ju(ke,ft(o,k,ke))},pe=G$(e.mode),ze=G$(e.reValidateMode);if(ae){let ke,lt;const wt=I.type?V$(ae._f):jde(X),De=X.type===B$.BLUR||X.type===B$.FOCUS_OUT,et=!tpe(ae._f)&&!e.resolver&&!ft(n.errors,k)&&!ae._f.deps||ipe(De,ft(n.touchedFields,k),n.isSubmitted,ze,pe),St=W$(k,l,De);Wn(o,k,wt),De?(ae._f.onBlur&&ae._f.onBlur(X),c&&c(0)):ae._f.onChange&&ae._f.onChange(X);const At=_(k,wt,De),tt=!xs(At)||St;if(!De&&d.state.next({name:k,type:X.type,values:Ji(o)}),et)return(h.isValid||f.isValid)&&(e.mode==="onBlur"?De&&g():De||g()),tt&&d.state.next({name:k,...St?{}:At});if(!De&&St&&d.state.next({...n}),e.resolver){const{errors:en}=await T([k]);if(ce(wt),ne){const $t=q$(n.errors,i,k),fn=q$(en,i,$t.name||k);ke=fn.error,k=fn.name,lt=xs(en)}}else v([k],!0),ke=(await K$(ae,l.disabled,o,p,e.shouldUseNativeValidation))[k],v([k]),ce(wt),ne&&(ke?lt=!1:(h.isValid||f.isValid)&&(lt=await M(i,!0)));ne&&(ae._f.deps&&G(ae._f.deps),S(k,lt,ke,At))}},U=(X,I)=>{if(ft(n.errors,I)&&X.focus)return X.focus(),1},G=async(X,I={})=>{let k,ne;const ae=C0(X);if(e.resolver){const ce=await E($r(X)?X:ae);k=xs(ce),ne=X?!ae.some(pe=>ft(ce,pe)):k}else X?(ne=(await Promise.all(ae.map(async ce=>{const pe=ft(i,ce);return await M(pe&&pe._f?{[ce]:pe}:pe)}))).every(Boolean),!(!ne&&!n.isValid)&&g()):ne=k=await M(i);return d.state.next({...!wl(X)||(h.isValid||f.isValid)&&k!==n.isValid?{}:{name:X},...e.resolver||!X?{isValid:k}:{},errors:n.errors}),I.shouldFocus&&!ne&&P0(i,U,X?ae:l.mount),ne},H=X=>{const I={...a.mount?o:s};return $r(X)?I:wl(X)?ft(I,X):X.map(k=>ft(I,k))},Y=(X,I)=>({invalid:!!ft((I||n).errors,X),isDirty:!!ft((I||n).dirtyFields,X),error:ft((I||n).errors,X),isValidating:!!ft(n.validatingFields,X),isTouched:!!ft((I||n).touchedFields,X)}),ee=X=>{X&&C0(X).forEach(I=>ii(n.errors,I)),d.state.next({errors:X?n.errors:{}})},he=(X,I,k)=>{const ne=(ft(i,X,{_f:{}})._f||{}).ref,ae=ft(n.errors,X)||{},{ref:ce,message:pe,type:ze,...ke}=ae;Wn(n.errors,X,{...ke,...I,ref:ne}),d.state.next({name:X,errors:n.errors,isValid:!1}),k&&k.shouldFocus&&ne&&ne.focus&&ne.focus()},q=(X,I)=>Ga(X)?d.state.subscribe({next:k=>X(D(void 0,I),k)}):D(X,I,!0),J=X=>d.state.subscribe({next:I=>{rpe(X.name,I.name,X.exact)&&npe(I,X.formState||h,gt,X.reRenderRoot)&&X.callback({values:{...o},...n,...I})}}).unsubscribe,se=X=>(a.mount=!0,f={...f,...X.formState},J({...X,formState:f})),oe=(X,I={})=>{for(const k of X?C0(X):l.mount)l.mount.delete(k),l.array.delete(k),I.keepValue||(ii(i,k),ii(o,k)),!I.keepError&&ii(n.errors,k),!I.keepDirty&&ii(n.dirtyFields,k),!I.keepTouched&&ii(n.touchedFields,k),!I.keepIsValidating&&ii(n.validatingFields,k),!e.shouldUnregister&&!I.keepDefaultValue&&ii(s,k);d.state.next({values:Ji(o)}),d.state.next({...n,...I.keepDirty?{isDirty:P()}:{}}),!I.keepIsValid&&g()},Ee=({disabled:X,name:I})=>{(yl(X)&&a.mount||X||l.disabled.has(I))&&(X?l.disabled.add(I):l.disabled.delete(I))},ye=(X,I={})=>{let k=ft(i,X);const ne=yl(I.disabled)||yl(e.disabled);return Wn(i,X,{...k||{},_f:{...k&&k._f?k._f:{ref:{name:X}},name:X,mount:!0,...I}}),l.mount.add(X),k?Ee({disabled:yl(I.disabled)?I.disabled:e.disabled,name:X}):w(X,!0,I.value),{...ne?{disabled:I.disabled||e.disabled}:{},...e.progressive?{required:!!I.required,min:Jy(I.min),max:Jy(I.max),minLength:Jy(I.minLength),maxLength:Jy(I.maxLength),pattern:Jy(I.pattern)}:{},name:X,onChange:z,onBlur:z,ref:ae=>{if(ae){ye(X,I),k=ft(i,X);const ce=$r(ae.value)&&ae.querySelectorAll&&ae.querySelectorAll("input,select,textarea")[0]||ae,pe=Yde(ce),ze=k._f.refs||[];if(pe?ze.find(ke=>ke===ce):ce===k._f.ref)return;Wn(i,X,{_f:{...k._f,...pe?{refs:[...ze.filter(fP),ce,...Array.isArray(ft(s,X))?[{}]:[]],ref:{type:ce.type,name:X}}:{ref:ce}}}),w(X,!1,void 0,ce)}else k=ft(i,X,{}),k._f&&(k._f.mount=!1),(e.shouldUnregister||I.shouldUnregister)&&!(Gde(l.array,X)&&a.action)&&l.unMount.add(X)}}},Ce=()=>e.shouldFocusError&&P0(i,U,l.mount),Ge=X=>{yl(X)&&(d.state.next({disabled:X}),P0(i,(I,k)=>{const ne=ft(i,k);ne&&(I.disabled=ne._f.disabled||X,Array.isArray(ne._f.refs)&&ne._f.refs.forEach(ae=>{ae.disabled=ne._f.disabled||X}))},0,!1))},_e=(X,I)=>async k=>{let ne;k&&(k.preventDefault&&k.preventDefault(),k.persist&&k.persist());let ae=Ji(o);if(d.state.next({isSubmitting:!0}),e.resolver){const{errors:ce,values:pe}=await T();n.errors=ce,ae=pe}else await M(i);if(l.disabled.size)for(const ce of l.disabled)Wn(ae,ce,void 0);if(ii(n.errors,"root"),xs(n.errors)){d.state.next({errors:{}});try{await X(ae,k)}catch(ce){ne=ce}}else I&&await I({...n.errors},k),Ce(),setTimeout(Ce);if(d.state.next({isSubmitted:!0,isSubmitting:!1,isSubmitSuccessful:xs(n.errors)&&!ne,submitCount:n.submitCount+1,errors:n.errors}),ne)throw ne},Ke=(X,I={})=>{ft(i,X)&&($r(I.defaultValue)?R(X,Ji(ft(s,X))):(R(X,I.defaultValue),Wn(s,X,Ji(I.defaultValue))),I.keepTouched||ii(n.touchedFields,X),I.keepDirty||(ii(n.dirtyFields,X),n.isDirty=I.defaultValue?P(X,Ji(ft(s,X))):P()),I.keepError||(ii(n.errors,X),h.isValid&&g()),d.state.next({...n}))},Q=(X,I={})=>{const k=X?Ji(X):s,ne=Ji(k),ae=xs(X),ce=ae?s:ne;if(I.keepDefaultValues||(s=k),!I.keepValues){if(I.keepDirtyValues){const pe=new Set([...l.mount,...Object.keys(Qy(s,o))]);for(const ze of Array.from(pe))ft(n.dirtyFields,ze)?Wn(ce,ze,ft(o,ze)):R(ze,ft(ce,ze))}else{if(VL&&$r(X))for(const pe of l.mount){const ze=ft(i,pe);if(ze&&ze._f){const ke=Array.isArray(ze._f.refs)?ze._f.refs[0]:ze._f.ref;if(ET(ke)){const lt=ke.closest("form");if(lt){lt.reset();break}}}}for(const pe of l.mount)R(pe,ft(ce,pe))}o=Ji(ce),d.array.next({values:{...ce}}),d.state.next({values:{...ce}})}l={mount:I.keepDirtyValues?l.mount:new Set,unMount:new Set,array:new Set,disabled:new Set,watch:new Set,watchAll:!1,focus:""},a.mount=!h.isValid||!!I.keepIsValid||!!I.keepDirtyValues,a.watch=!!e.shouldUnregister,d.state.next({submitCount:I.keepSubmitCount?n.submitCount:0,isDirty:ae?!1:I.keepDirty?n.isDirty:!!(I.keepDefaultValues&&!Ju(X,s)),isSubmitted:I.keepIsSubmitted?n.isSubmitted:!1,dirtyFields:ae?{}:I.keepDirtyValues?I.keepDefaultValues&&o?Qy(s,o):n.dirtyFields:I.keepDefaultValues&&X?Qy(s,X):I.keepDirty?n.dirtyFields:{},touchedFields:I.keepTouched?n.touchedFields:{},errors:I.keepErrors?n.errors:{},isSubmitSuccessful:I.keepIsSubmitSuccessful?n.isSubmitSuccessful:!1,isSubmitting:!1})},kt=(X,I)=>Q(Ga(X)?X(o):X,I),ct=(X,I={})=>{const k=ft(i,X),ne=k&&k._f;if(ne){const ae=ne.refs?ne.refs[0]:ne.ref;ae.focus&&(ae.focus(),I.shouldSelect&&Ga(ae.select)&&ae.select())}},gt=X=>{n={...n,...X}},on={control:{register:ye,unregister:oe,getFieldState:Y,handleSubmit:_e,setError:he,_subscribe:J,_runSchema:T,_getWatch:D,_getDirty:P,_setValid:g,_setFieldArray:y,_setDisabledField:Ee,_setErrors:b,_getFieldArray:B,_reset:Q,_resetDefaultValues:()=>Ga(e.defaultValues)&&e.defaultValues().then(X=>{kt(X,e.resetOptions),d.state.next({isLoading:!1})}),_removeUnmounted:A,_disableForm:Ge,_subjects:d,_proxyFormState:h,get _fields(){return i},get _formValues(){return o},get _state(){return a},set _state(X){a=X},get _defaultValues(){return s},get _names(){return l},set _names(X){l=X},get _formState(){return n},get _options(){return e},set _options(X){e={...e,...X}}},subscribe:se,trigger:G,register:ye,handleSubmit:_e,watch:q,setValue:R,getValues:H,reset:kt,resetField:Ke,clearErrors:ee,unregister:oe,setError:he,setFocus:ct,getFieldState:Y};return{...on,formControl:on}}function cpe(r={}){const e=Z.useRef(void 0),n=Z.useRef(void 0),[i,s]=Z.useState({isDirty:!1,isValidating:!1,isLoading:Ga(r.defaultValues),isSubmitted:!1,isSubmitting:!1,isSubmitSuccessful:!1,isValid:!1,submitCount:0,dirtyFields:{},touchedFields:{},validatingFields:{},errors:r.errors||{},disabled:r.disabled||!1,isReady:!1,defaultValues:Ga(r.defaultValues)?void 0:r.defaultValues});e.current||(e.current={...r.formControl?r.formControl:lpe(r),formState:i},r.formControl&&r.defaultValues&&!Ga(r.defaultValues)&&r.formControl.reset(r.defaultValues,r.resetOptions));const o=e.current.control;return o._options=r,qde(()=>{const a=o._subscribe({formState:o._proxyFormState,callback:()=>s({...o._formState}),reRenderRoot:!0});return s(l=>({...l,isReady:!0})),o._formState.isReady=!0,a},[o]),Z.useEffect(()=>o._disableForm(r.disabled),[o,r.disabled]),Z.useEffect(()=>{r.mode&&(o._options.mode=r.mode),r.reValidateMode&&(o._options.reValidateMode=r.reValidateMode),r.errors&&!xs(r.errors)&&o._setErrors(r.errors)},[o,r.errors,r.mode,r.reValidateMode]),Z.useEffect(()=>{r.shouldUnregister&&o._subjects.state.next({values:o._getWatch()})},[o,r.shouldUnregister]),Z.useEffect(()=>{if(o._proxyFormState.isDirty){const a=o._getDirty();a!==i.isDirty&&o._subjects.state.next({isDirty:a})}},[o,i.isDirty]),Z.useEffect(()=>{r.values&&!Ju(r.values,n.current)?(o._reset(r.values,o._options.resetOptions),n.current=r.values,s(a=>({...a}))):o._resetDefaultValues()},[o,r.values]),Z.useEffect(()=>{o._state.mount||(o._setValid(),o._state.mount=!0),o._state.watch&&(o._state.watch=!1,o._subjects.state.next({...o._formState})),o._removeUnmounted()}),e.current.formState=Wde(i,o),e.current}const jr=({className:r,bordered:e=!1,...n})=>N.jsx("div",{className:Vl("bg-white dark:bg-gray-800 rounded-xl shadow-sm overflow-hidden",e&&"border border-gray-200 dark:border-gray-700",r),...n}),Vr=({className:r,...e})=>N.jsx("div",{className:Vl("px-6 py-4 border-b border-gray-200 dark:border-gray-700",r),...e}),Gr=({className:r,...e})=>N.jsx("h3",{className:Vl("text-lg font-semibold text-gray-900 dark:text-white",r),...e}),vK=({className:r,...e})=>N.jsx("p",{className:Vl("text-sm text-gray-500 dark:text-gray-400",r),...e}),Hr=({className:r,...e})=>N.jsx("div",{className:Vl("px-6 py-4",r),...e}),a_=({className:r,...e})=>N.jsx("div",{className:Vl("px-6 py-4 border-t border-gray-200 dark:border-gray-700 bg-gray-50 dark:bg-gray-800",r),...e}),Vs=Z.forwardRef(({className:r,type:e,error:n,...i},s)=>N.jsxs("div",{className:"relative",children:[N.jsx("input",{type:e,className:Vl("flex h-10 w-full rounded-md border border-gray-300 bg-white px-3 py-2 text-sm placeholder:text-gray-400 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent disabled:cursor-not-allowed disabled:opacity-50 dark:border-gray-700 dark:bg-gray-800 dark:text-white dark:placeholder-gray-400",n&&"border-red-500 focus:ring-red-500",r),ref:s,...i}),n&&N.jsx("p",{className:"mt-1 text-sm text-red-500 dark:text-red-400",children:n})]}));Vs.displayName="Input";const Ii=Z.forwardRef(({className:r,error:e,children:n,...i},s)=>N.jsxs("div",{className:"relative",children:[N.jsx("select",{className:Vl("flex h-10 w-full appearance-none rounded-md border border-gray-300 bg-white px-3 py-2 text-sm placeholder:text-gray-400 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent disabled:cursor-not-allowed disabled:opacity-50 dark:border-gray-700 dark:bg-gray-800 dark:text-white dark:placeholder-gray-400",e&&"border-red-500 focus:ring-red-500",r),ref:s,...i,children:n}),N.jsx("div",{className:"pointer-events-none absolute inset-y-0 right-0 flex items-center px-2 text-gray-700 dark:text-gray-300",children:N.jsx("svg",{className:"fill-current h-4 w-4",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",children:N.jsx("path",{d:"M9.293 12.95l.707.707L15.657 8l-1.414-1.414L10 10.828 5.757 6.586 4.343 8z"})})}),e&&N.jsx("p",{className:"mt-1 text-sm text-red-500 dark:text-red-400",children:e})]}));Ii.displayName="Select";const R0=Z.forwardRef(({className:r,error:e,...n},i)=>N.jsxs("div",{className:"relative",children:[N.jsx("textarea",{className:Vl("flex min-h-[80px] w-full rounded-md border border-gray-300 bg-white px-3 py-2 text-sm placeholder:text-gray-400 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent disabled:cursor-not-allowed disabled:opacity-50 dark:border-gray-700 dark:bg-gray-800 dark:text-white dark:placeholder-gray-400",e&&"border-red-500 focus:ring-red-500",r),ref:i,...n}),e&&N.jsx("p",{className:"mt-1 text-sm text-red-500 dark:text-red-400",children:e})]}));R0.displayName="Textarea";const upe=({onSubmit:r,existingProfile:e})=>{var D,B;const{register:n,handleSubmit:i,formState:{errors:s,isSubmitting:o}}=cpe({defaultValues:e||{id:ys(),coreValues:[""],systems:[""],marketChallenges:[""],pastStrategicMoves:[""],kpis:[{name:"Profitability",current:0,target:0,unit:"%"}]}}),[a,l]=Z.useState((e==null?void 0:e.coreValues)||[""]),[c,u]=Z.useState((e==null?void 0:e.systems)||[""]),[h,f]=Z.useState((e==null?void 0:e.marketChallenges)||[""]),[d,p]=Z.useState((e==null?void 0:e.pastStrategicMoves)||[""]),[m,g]=Z.useState((e==null?void 0:e.kpis)||[{name:"Profitability",current:0,target:0,unit:"%"}]),v=()=>l([...a,""]),y=C=>{l(a.filter((O,R)=>R!==C))},x=()=>u([...c,""]),b=C=>{u(c.filter((O,R)=>R!==C))},w=()=>f([...h,""]),_=C=>{f(h.filter((O,R)=>R!==C))},S=()=>p([...d,""]),T=C=>{p(d.filter((O,R)=>R!==C))},E=()=>g([...m,{name:"",current:0,target:0,unit:"%"}]),M=C=>{g(m.filter((O,R)=>R!==C))},A=(C,O,R)=>{const z=[...m];O==="current"||O==="target"?z[C][O]=Number(R):z[C][O]=R,g(z)},P=C=>{const O={...C,id:(e==null?void 0:e.id)||ys(),coreValues:a.filter(R=>R.trim()!==""),systems:c.filter(R=>R.trim()!==""),marketChallenges:h.filter(R=>R.trim()!==""),pastStrategicMoves:d.filter(R=>R.trim()!==""),kpis:m.filter(R=>R.name.trim()!=="")};r(O)};return N.jsxs("form",{onSubmit:i(P),className:"max-w-4xl mx-auto",children:[N.jsxs(jr,{className:"mb-8",children:[N.jsx(Vr,{children:N.jsx(Gr,{children:"Company Information"})}),N.jsxs(Hr,{className:"space-y-4",children:[N.jsxs("div",{className:"grid md:grid-cols-2 gap-4",children:[N.jsxs("div",{children:[N.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Company Name"}),N.jsx(Vs,{...n("name",{required:"Company name is required"}),error:(D=s.name)==null?void 0:D.message,placeholder:"Enter company name"})]}),N.jsxs("div",{children:[N.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Industry"}),N.jsx(Vs,{...n("industry",{required:"Industry is required"}),error:(B=s.industry)==null?void 0:B.message,placeholder:"e.g., Technology, Healthcare"})]}),N.jsxs("div",{children:[N.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Sector"}),N.jsx(Vs,{...n("sector"),placeholder:"e.g., Software, Pharmaceuticals"})]}),N.jsxs("div",{children:[N.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Company Size"}),N.jsxs(Ii,{...n("size",{required:"Company size is required"}),children:[N.jsx("option",{value:"",children:"Select size"}),N.jsx("option",{value:"Small",children:"Small"}),N.jsx("option",{value:"Medium",children:"Medium"}),N.jsx("option",{value:"Large",children:"Large"}),N.jsx("option",{value:"Enterprise",children:"Enterprise"})]})]}),N.jsxs("div",{children:[N.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Geographical Presence"}),N.jsxs(Ii,{...n("geographicalPresence",{required:"Geographical presence is required"}),children:[N.jsx("option",{value:"",children:"Select presence"}),N.jsx("option",{value:"Local",children:"Local"}),N.jsx("option",{value:"Regional",children:"Regional"}),N.jsx("option",{value:"Global",children:"Global"})]})]}),N.jsxs("div",{children:[N.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Current Strategic Focus"}),N.jsx(Vs,{...n("strategicFocus"),placeholder:"e.g., Growth, Innovation"})]})]}),N.jsxs("div",{className:"grid md:grid-cols-2 gap-4",children:[N.jsxs("div",{children:[N.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Mission"}),N.jsx(R0,{...n("mission"),placeholder:"Company mission statement"})]}),N.jsxs("div",{children:[N.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Vision"}),N.jsx(R0,{...n("vision"),placeholder:"Company vision statement"})]})]})]})]}),N.jsxs(jr,{className:"mb-8",children:[N.jsx(Vr,{children:N.jsx(Gr,{children:"Organization Structure"})}),N.jsxs(Hr,{className:"space-y-4",children:[N.jsxs("div",{className:"grid md:grid-cols-2 gap-4",children:[N.jsxs("div",{children:[N.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Structure Type"}),N.jsxs(Ii,{...n("structure"),children:[N.jsx("option",{value:"",children:"Select structure type"}),N.jsx("option",{value:"Organic",children:"Organic"}),N.jsx("option",{value:"Mechanistic",children:"Mechanistic"}),N.jsx("option",{value:"Hybrid",children:"Hybrid"})]})]}),N.jsxs("div",{children:[N.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Leadership Style & Culture"}),N.jsx(Vs,{...n("leadershipStyle"),placeholder:"e.g., Democratic, Hierarchical"})]})]}),N.jsxs("div",{children:[N.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Workforce Characteristics"}),N.jsx(R0,{...n("workforceCharacteristics"),placeholder:"Describe key workforce characteristics"})]})]})]}),N.jsxs(jr,{className:"mb-8",children:[N.jsx(Vr,{children:N.jsx(Gr,{children:"Core Values"})}),N.jsxs(Hr,{className:"space-y-4",children:[a.map((C,O)=>N.jsxs("div",{className:"flex space-x-2",children:[N.jsx(Vs,{value:C,onChange:R=>{const z=[...a];z[O]=R.target.value,l(z)},placeholder:`Core Value ${O+1}`,className:"flex-1"}),a.length>1&&N.jsx(hr,{type:"button",variant:"outline",onClick:()=>y(O),"aria-label":"Remove core value",children:"Remove"})]},O)),N.jsx(hr,{type:"button",onClick:v,children:"Add Core Value"})]})]}),N.jsxs(jr,{className:"mb-8",children:[N.jsx(Vr,{children:N.jsx(Gr,{children:"Systems & Processes"})}),N.jsxs(Hr,{className:"space-y-4",children:[c.map((C,O)=>N.jsxs("div",{className:"flex space-x-2",children:[N.jsx(Vs,{value:C,onChange:R=>{const z=[...c];z[O]=R.target.value,u(z)},placeholder:`System/Process ${O+1}`,className:"flex-1"}),c.length>1&&N.jsx(hr,{type:"button",variant:"outline",onClick:()=>b(O),"aria-label":"Remove system",children:"Remove"})]},O)),N.jsx(hr,{type:"button",onClick:x,children:"Add System/Process"})]})]}),N.jsxs(jr,{className:"mb-8",children:[N.jsx(Vr,{children:N.jsx(Gr,{children:"Market Challenges"})}),N.jsxs(Hr,{className:"space-y-4",children:[h.map((C,O)=>N.jsxs("div",{className:"flex space-x-2",children:[N.jsx(Vs,{value:C,onChange:R=>{const z=[...h];z[O]=R.target.value,f(z)},placeholder:`Market Challenge ${O+1}`,className:"flex-1"}),h.length>1&&N.jsx(hr,{type:"button",variant:"outline",onClick:()=>_(O),"aria-label":"Remove challenge",children:"Remove"})]},O)),N.jsx(hr,{type:"button",onClick:w,children:"Add Market Challenge"})]})]}),N.jsxs(jr,{className:"mb-8",children:[N.jsx(Vr,{children:N.jsx(Gr,{children:"Past Strategic Moves"})}),N.jsxs(Hr,{className:"space-y-4",children:[d.map((C,O)=>N.jsxs("div",{className:"flex space-x-2",children:[N.jsx(Vs,{value:C,onChange:R=>{const z=[...d];z[O]=R.target.value,p(z)},placeholder:`Strategic Move ${O+1}`,className:"flex-1"}),d.length>1&&N.jsx(hr,{type:"button",variant:"outline",onClick:()=>T(O),"aria-label":"Remove strategic move",children:"Remove"})]},O)),N.jsx(hr,{type:"button",onClick:S,children:"Add Strategic Move"})]})]}),N.jsxs(jr,{className:"mb-8",children:[N.jsx(Vr,{children:N.jsx(Gr,{children:"Key Performance Indicators (KPIs)"})}),N.jsxs(Hr,{className:"space-y-4",children:[m.map((C,O)=>N.jsxs("div",{className:"grid grid-cols-4 gap-2",children:[N.jsx("div",{children:N.jsx(Vs,{value:C.name,onChange:R=>A(O,"name",R.target.value),placeholder:"KPI Name"})}),N.jsx("div",{children:N.jsx(Vs,{type:"number",value:C.current,onChange:R=>A(O,"current",R.target.value),placeholder:"Current"})}),N.jsx("div",{children:N.jsx(Vs,{type:"number",value:C.target,onChange:R=>A(O,"target",R.target.value),placeholder:"Target"})}),N.jsxs("div",{className:"flex space-x-2",children:[N.jsx(Vs,{value:C.unit,onChange:R=>A(O,"unit",R.target.value),placeholder:"Unit",className:"flex-1"}),m.length>1&&N.jsx(hr,{type:"button",variant:"outline",onClick:()=>M(O),"aria-label":"Remove KPI",className:"whitespace-nowrap",children:"Remove"})]})]},O)),N.jsx(hr,{type:"button",onClick:E,children:"Add KPI"})]})]}),N.jsx("div",{className:"flex justify-end mb-8",children:N.jsx(hr,{type:"submit",isLoading:o,size:"lg",children:e?"Update Company Profile":"Create Company Profile"})})]})},hpe=()=>{const r=oy(),{simulation:e,setCompany:n,initializeSevenSModel:i}=ly(),s=o=>{n(o),i(),r("/simulation")};return N.jsx(s_,{children:N.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[N.jsxs("div",{className:"mb-8",children:[N.jsx("h1",{className:"text-3xl font-bold text-gray-900 dark:text-white",children:"Company Profile"}),N.jsx("p",{className:"mt-2 text-lg text-gray-600 dark:text-gray-300",children:"Define your company's characteristics to personalize the simulation."})]}),N.jsx(upe,{onSubmit:s,existingProfile:e.company||void 0})]})})};function fpe(r,e){var n=r==null?null:typeof Symbol<"u"&&r[Symbol.iterator]||r["@@iterator"];if(n!=null){var i,s,o,a,l=[],c=!0,u=!1;try{if(o=(n=n.call(r)).next,e===0){if(Object(n)!==n)return;c=!1}else for(;!(c=(i=o.call(n)).done)&&(l.push(i.value),l.length!==e);c=!0);}catch(h){u=!0,s=h}finally{try{if(!c&&n.return!=null&&(a=n.return(),Object(a)!==a))return}finally{if(u)throw s}}return l}}function dpe(r,e,n){return e=_pe(e),e in r?Object.defineProperty(r,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):r[e]=n,r}function Y$(r,e){return gpe(r)||fpe(r,e)||xK(r,e)||xpe()}function ppe(r){return mpe(r)||ype(r)||xK(r)||vpe()}function mpe(r){if(Array.isArray(r))return CO(r)}function gpe(r){if(Array.isArray(r))return r}function ype(r){if(typeof Symbol<"u"&&r[Symbol.iterator]!=null||r["@@iterator"]!=null)return Array.from(r)}function xK(r,e){if(r){if(typeof r=="string")return CO(r,e);var n=Object.prototype.toString.call(r).slice(8,-1);if(n==="Object"&&r.constructor&&(n=r.constructor.name),n==="Map"||n==="Set")return Array.from(r);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return CO(r,e)}}function CO(r,e){(e==null||e>r.length)&&(e=r.length);for(var n=0,i=new Array(e);n<e;n++)i[n]=r[n];return i}function vpe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function xpe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function bpe(r,e){if(typeof r!="object"||r===null)return r;var n=r[Symbol.toPrimitive];if(n!==void 0){var i=n.call(r,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(r)}function _pe(r){var e=bpe(r,"string");return typeof e=="symbol"?e:String(e)}var wpe=function(e,n){var i=new Set(n);return Object.assign.apply(Object,[{}].concat(ppe(Object.entries(e).filter(function(s){var o=Y$(s,1),a=o[0];return!i.has(a)}).map(function(s){var o=Y$(s,2),a=o[0],l=o[1];return dpe({},a,l)}))))};function PO(r,e){(e==null||e>r.length)&&(e=r.length);for(var n=0,i=Array(e);n<e;n++)i[n]=r[n];return i}function Spe(r){if(Array.isArray(r))return r}function Tpe(r){if(Array.isArray(r))return PO(r)}function Epe(r){if(typeof Symbol<"u"&&r[Symbol.iterator]!=null||r["@@iterator"]!=null)return Array.from(r)}function Mpe(r,e){var n=r==null?null:typeof Symbol<"u"&&r[Symbol.iterator]||r["@@iterator"];if(n!=null){var i,s,o,a,l=[],c=!0,u=!1;try{if(o=(n=n.call(r)).next,e!==0)for(;!(c=(i=o.call(n)).done)&&(l.push(i.value),l.length!==e);c=!0);}catch(h){u=!0,s=h}finally{try{if(!c&&n.return!=null&&(a=n.return(),Object(a)!==a))return}finally{if(u)throw s}}return l}}function Ape(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Cpe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Ppe(r,e){return Spe(r)||Mpe(r,e)||bK(r,e)||Ape()}function Z$(r){return Tpe(r)||Epe(r)||bK(r)||Cpe()}function bK(r,e){if(r){if(typeof r=="string")return PO(r,e);var n={}.toString.call(r).slice(8,-1);return n==="Object"&&r.constructor&&(n=r.constructor.name),n==="Map"||n==="Set"?Array.from(r):n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?PO(r,e):void 0}}function FM(r){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},n=e.wrapperElementType,i=n===void 0?"div":n,s=e.nodeMapper,o=s===void 0?function(h){return h}:s,a=e.methodNames,l=a===void 0?[]:a,c=e.initPropNames,u=c===void 0?[]:c;return te.forwardRef(function(h,f){var d=te.useRef(),p=te.useMemo(function(){var v=Object.fromEntries(u.filter(function(y){return h.hasOwnProperty(y)}).map(function(y){return[y,h[y]]}));return r(v)},[]);Q$(function(){p(o(d.current))},te.useLayoutEffect),Q$(function(){return p._destructor instanceof Function?p._destructor:void 0});var m=te.useCallback(function(v){for(var y=arguments.length,x=new Array(y>1?y-1:0),b=1;b<y;b++)x[b-1]=arguments[b];return p[v]instanceof Function?p[v].apply(p,x):void 0},[p]),g=te.useRef({});return Object.keys(wpe(h,[].concat(Z$(l),Z$(u)))).filter(function(v){return g.current[v]!==h[v]}).forEach(function(v){return m(v,h[v])}),g.current=h,te.useImperativeHandle(f,function(){return Object.fromEntries(l.map(function(v){return[v,function(){for(var y=arguments.length,x=new Array(y),b=0;b<y;b++)x[b]=arguments[b];return m.apply(void 0,[v].concat(x))}]}))},[m]),Z.createElement(i,{ref:d})})}function Q$(r){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:te.useEffect,n=te.useRef(),i=te.useRef(!1),s=te.useRef(!1),o=te.useState(0),a=Ppe(o,2);a[0];var l=a[1];i.current&&(s.current=!0),e(function(){return i.current||(n.current=r(),i.current=!0),l(function(c){return c+1}),function(){s.current&&n.current&&n.current()}},[])}const J$=.1;AFRAME.registerComponent("checkpoint-controls",{schema:{enabled:{default:!0},mode:{default:"teleport",oneOf:["teleport","animate"]},animateSpeed:{default:3}},init:function(){this.active=!0,this.checkpoint=null,this.isNavMeshConstrained=!1,this.offset=new THREE.Vector3,this.position=new THREE.Vector3,this.targetPosition=new THREE.Vector3},play:function(){this.active=!0},pause:function(){this.active=!1},setCheckpoint:function(r){const e=this.el;if(this.active&&this.checkpoint!==r){if(this.checkpoint&&e.emit("navigation-end",{checkpoint:this.checkpoint}),this.checkpoint=r,this.sync(),this.position.distanceTo(this.targetPosition)<J$){this.checkpoint=null;return}e.emit("navigation-start",{checkpoint:r}),this.data.mode==="teleport"&&(this.el.setAttribute("position",this.targetPosition),this.checkpoint=null,e.emit("navigation-end",{checkpoint:r}),e.components["movement-controls"].updateNavLocation())}},isVelocityActive:function(){return!!(this.active&&this.checkpoint)},getVelocity:function(){if(!this.active)return;const r=this.data,e=this.offset,n=this.position,i=this.targetPosition,s=this.checkpoint;return this.sync(),n.distanceTo(i)<J$?(this.checkpoint=null,this.el.emit("navigation-end",{checkpoint:s}),e.set(0,0,0)):(e.setLength(r.animateSpeed),e)},sync:function(){const r=this.offset,e=this.position,n=this.targetPosition;e.copy(this.el.getAttribute("position")),this.checkpoint.object3D.getWorldPosition(n),n.add(this.checkpoint.components.checkpoint.getOffset()),r.copy(n).sub(e)}});var Rpe=Object.assign(function(){},{FACE_1:0,FACE_2:1,FACE_3:2,FACE_4:3,L_SHOULDER_1:4,R_SHOULDER_1:5,L_SHOULDER_2:6,R_SHOULDER_2:7,SELECT:8,START:9,DPAD_UP:12,DPAD_DOWN:13,DPAD_LEFT:14,DPAD_RIGHT:15,VENDOR:16});function Npe(r,e,n){this.type=r,this.index=e,this.pressed=n.pressed,this.value=n.value}var Ope=Npe;const Hd=Rpe,dP=Ope,Mu=.2,ec={LEFT:"left",RIGHT:"right"},tc={MOVEMENT:1,ROTATION:2};AFRAME.registerComponent("gamepad-controls",{GamepadButton:Hd,schema:{enabled:{default:!0},rotationSensitivity:{default:2}},init:function(){const r=this.el.sceneEl;this.system=r.systems["tracked-controls"]||r.systems["tracked-controls-webxr"]||{controllers:[]},this.prevTime=window.performance.now(),this.buttons={};const e=this.el.object3D.rotation;this.pitch=new THREE.Object3D,this.pitch.rotation.x=e.x,this.yaw=new THREE.Object3D,this.yaw.position.y=10,this.yaw.rotation.y=e.y,this.yaw.add(this.pitch),this._lookVector=new THREE.Vector2,this._moveVector=new THREE.Vector2,this._dpadVector=new THREE.Vector2,r.addBehavior(this)},update:function(){this.tick()},tick:function(r,e){this.updateButtonState(),this.updateRotation(e)},remove:function(){},isVelocityActive:function(){if(!this.data.enabled||!this.isConnected())return!1;const r=this._dpadVector,e=this._moveVector;this.getDpad(r),this.getJoystick(tc.MOVEMENT,e);const n=r.x||e.x,i=r.y||e.y;return Math.abs(n)>Mu||Math.abs(i)>Mu},getVelocityDelta:function(){const r=this._dpadVector,e=this._moveVector;this.getDpad(r),this.getJoystick(tc.MOVEMENT,e);const n=r.x||e.x,i=r.y||e.y,s=new THREE.Vector3;return Math.abs(n)>Mu&&(s.x+=n),Math.abs(i)>Mu&&(s.z+=i),s},isRotationActive:function(){if(!this.data.enabled||!this.isConnected())return!1;const r=this._lookVector;return this.getJoystick(tc.ROTATION,r),Math.abs(r.x)>Mu||Math.abs(r.y)>Mu},updateRotation:function(r){if(!this.isRotationActive())return;const e=this.data,n=this.yaw,i=this.pitch;n.rotation.y=this.el.object3D.rotation.y,i.rotation.x=this.el.object3D.rotation.x;const s=this._lookVector;this.getJoystick(tc.ROTATION,s),Math.abs(s.x)<=Mu&&(s.x=0),Math.abs(s.y)<=Mu&&(s.y=0),s.multiplyScalar(e.rotationSensitivity*r/1e3),n.rotation.y-=s.x,i.rotation.x-=s.y,i.rotation.x=Math.max(-Math.PI/2,Math.min(Math.PI/2,i.rotation.x)),this.el.object3D.rotation.set(i.rotation.x,n.rotation.y,0)},updateButtonState:function(){const r=this.getGamepad(ec.RIGHT);if(this.data.enabled&&r)for(var e=0;e<r.buttons.length;e++)r.buttons[e].pressed&&!this.buttons[e]?this.emit(new dP("gamepadbuttondown",e,r.buttons[e])):!r.buttons[e].pressed&&this.buttons[e]&&this.emit(new dP("gamepadbuttonup",e,r.buttons[e])),this.buttons[e]=r.buttons[e].pressed;else for(const n in this.buttons)this.buttons[n]=!1},emit:function(r){this.el.emit(r.type,r),this.el.emit(r.type+":"+r.index,new dP(r.type,r.index,r))},getGamepad:function(){const r=[],e=[];return function(n){const i=this.el.sceneEl.components["proxy-controls"],s=i&&i.isConnected()&&i.getGamepad(0);if(s)return s;r.length=0;for(let a=0;a<this.system.controllers.length;a++){const l=this.system.controllers[a],c=l?l.gamepad:null;if(r.push(c),c&&l.handedness===n)return c}const o=navigator.getGamepads?navigator.getGamepads():e;for(let a=0;a<o.length;a++){const l=o[a];if(l&&l.hand===n)return l}return r[0]||o[0]}}(),getButton:function(r){return this.getGamepad(ec.RIGHT).buttons[r]},getAxis:function(r){return this.getGamepad(r>1?ec.RIGHT:ec.LEFT).axes[r]},getJoystick:function(r,e){const n=this.getGamepad(r===tc.MOVEMENT?ec.LEFT:ec.RIGHT);if(!n)return e.set(0,0);if(n.mapping==="xr-standard")switch(r){case tc.MOVEMENT:return e.set(n.axes[2],n.axes[3]);case tc.ROTATION:return e.set(n.axes[2],0)}else switch(r){case tc.MOVEMENT:return e.set(n.axes[0],n.axes[1]);case tc.ROTATION:return e.set(n.axes[2],n.axes[3])}throw new Error('Unexpected joystick index "%d".',r)},getDpad:function(r){const e=this.getGamepad(ec.LEFT);return!e||!e.buttons[Hd.DPAD_RIGHT]?r.set(0,0):r.set((e.buttons[Hd.DPAD_RIGHT].pressed?1:0)+(e.buttons[Hd.DPAD_LEFT].pressed?-1:0),(e.buttons[Hd.DPAD_UP].pressed?-1:0)+(e.buttons[Hd.DPAD_DOWN].pressed?1:0))},isConnected:function(){const r=this.getGamepad(ec.LEFT);return!!(r&&r.connected)},getID:function(){return this.getGamepad(ec.LEFT).id}});(function(r){var e="KeyboardEvent"in r;e||(r.KeyboardEvent=function(){throw TypeError("Illegal constructor")}),"DOM_KEY_LOCATION_STANDARD"in r.KeyboardEvent||(r.KeyboardEvent.DOM_KEY_LOCATION_STANDARD=0),"DOM_KEY_LOCATION_LEFT"in r.KeyboardEvent||(r.KeyboardEvent.DOM_KEY_LOCATION_LEFT=1),"DOM_KEY_LOCATION_RIGHT"in r.KeyboardEvent||(r.KeyboardEvent.DOM_KEY_LOCATION_RIGHT=2),"DOM_KEY_LOCATION_NUMPAD"in r.KeyboardEvent||(r.KeyboardEvent.DOM_KEY_LOCATION_NUMPAD=3);var n=window.KeyboardEvent.DOM_KEY_LOCATION_STANDARD,i=window.KeyboardEvent.DOM_KEY_LOCATION_LEFT,s=window.KeyboardEvent.DOM_KEY_LOCATION_RIGHT,o=window.KeyboardEvent.DOM_KEY_LOCATION_NUMPAD;function a(_,S){return String(_).indexOf(S)!==-1}var l=function(){return a(navigator.platform,"Win")?"win":a(navigator.platform,"Mac")?"mac":a(navigator.platform,"CrOS")?"cros":a(navigator.platform,"Linux")?"linux":a(navigator.userAgent,"iPad")||a(navigator.platform,"iPod")||a(navigator.platform,"iPhone")?"ios":""}(),c=function(){return a(navigator.userAgent,"Chrome/")?"chrome":a(navigator.vendor,"Apple")?"safari":a(navigator.userAgent,"MSIE")?"ie":a(navigator.userAgent,"Gecko/")?"moz":a(navigator.userAgent,"Opera/")?"opera":""}(),u=c+"-"+l;function h(_,S,T){(u===S||c===S||l===S)&&Object.keys(T).forEach(function(E){_[E]=T[E]})}function f(_,S){var T={};return Object.keys(_).forEach(function(E){var M=_[E];S in M&&(T[M[S]]=M)}),T}var d={3:{code:"Cancel"},6:{code:"Help"},8:{code:"Backspace"},9:{code:"Tab"},12:{code:"Clear"},13:{code:"Enter"},16:{code:"Shift"},17:{code:"Control"},18:{code:"Alt"},19:{code:"Pause"},20:{code:"CapsLock"},21:{code:"KanaMode"},22:{code:"HangulMode"},23:{code:"JunjaMode"},24:{code:"FinalMode"},25:{code:"KanjiMode"},27:{code:"Escape"},28:{code:"Convert"},29:{code:"NonConvert"},30:{code:"Accept"},31:{code:"ModeChange"},32:{code:"Space"},33:{code:"PageUp"},34:{code:"PageDown"},35:{code:"End"},36:{code:"Home"},37:{code:"ArrowLeft"},38:{code:"ArrowUp"},39:{code:"ArrowRight"},40:{code:"ArrowDown"},41:{code:"Select"},42:{code:"Print"},43:{code:"Execute"},44:{code:"PrintScreen"},45:{code:"Insert"},46:{code:"Delete"},47:{code:"Help"},48:{code:"Digit0",keyCap:"0"},49:{code:"Digit1",keyCap:"1"},50:{code:"Digit2",keyCap:"2"},51:{code:"Digit3",keyCap:"3"},52:{code:"Digit4",keyCap:"4"},53:{code:"Digit5",keyCap:"5"},54:{code:"Digit6",keyCap:"6"},55:{code:"Digit7",keyCap:"7"},56:{code:"Digit8",keyCap:"8"},57:{code:"Digit9",keyCap:"9"},65:{code:"KeyA",keyCap:"a"},66:{code:"KeyB",keyCap:"b"},67:{code:"KeyC",keyCap:"c"},68:{code:"KeyD",keyCap:"d"},69:{code:"KeyE",keyCap:"e"},70:{code:"KeyF",keyCap:"f"},71:{code:"KeyG",keyCap:"g"},72:{code:"KeyH",keyCap:"h"},73:{code:"KeyI",keyCap:"i"},74:{code:"KeyJ",keyCap:"j"},75:{code:"KeyK",keyCap:"k"},76:{code:"KeyL",keyCap:"l"},77:{code:"KeyM",keyCap:"m"},78:{code:"KeyN",keyCap:"n"},79:{code:"KeyO",keyCap:"o"},80:{code:"KeyP",keyCap:"p"},81:{code:"KeyQ",keyCap:"q"},82:{code:"KeyR",keyCap:"r"},83:{code:"KeyS",keyCap:"s"},84:{code:"KeyT",keyCap:"t"},85:{code:"KeyU",keyCap:"u"},86:{code:"KeyV",keyCap:"v"},87:{code:"KeyW",keyCap:"w"},88:{code:"KeyX",keyCap:"x"},89:{code:"KeyY",keyCap:"y"},90:{code:"KeyZ",keyCap:"z"},91:{code:"OSLeft",location:i},92:{code:"OSRight",location:s},93:{code:"ContextMenu"},95:{code:"Standby"},96:{code:"Numpad0",keyCap:"0",location:o},97:{code:"Numpad1",keyCap:"1",location:o},98:{code:"Numpad2",keyCap:"2",location:o},99:{code:"Numpad3",keyCap:"3",location:o},100:{code:"Numpad4",keyCap:"4",location:o},101:{code:"Numpad5",keyCap:"5",location:o},102:{code:"Numpad6",keyCap:"6",location:o},103:{code:"Numpad7",keyCap:"7",location:o},104:{code:"Numpad8",keyCap:"8",location:o},105:{code:"Numpad9",keyCap:"9",location:o},106:{code:"NumpadMultiply",keyCap:"*",location:o},107:{code:"NumpadAdd",keyCap:"+",location:o},108:{code:"NumpadComma",keyCap:",",location:o},109:{code:"NumpadSubtract",keyCap:"-",location:o},110:{code:"NumpadDecimal",keyCap:".",location:o},111:{code:"NumpadDivide",keyCap:"/",location:o},112:{code:"F1"},113:{code:"F2"},114:{code:"F3"},115:{code:"F4"},116:{code:"F5"},117:{code:"F6"},118:{code:"F7"},119:{code:"F8"},120:{code:"F9"},121:{code:"F10"},122:{code:"F11"},123:{code:"F12"},124:{code:"F13"},125:{code:"F14"},126:{code:"F15"},127:{code:"F16"},128:{code:"F17"},129:{code:"F18"},130:{code:"F19"},131:{code:"F20"},132:{code:"F21"},133:{code:"F22"},134:{code:"F23"},135:{code:"F24"},144:{code:"NumLock",location:o},145:{code:"ScrollLock"},160:{code:"ShiftLeft",location:i},161:{code:"ShiftRight",location:s},162:{code:"ControlLeft",location:i},163:{code:"ControlRight",location:s},164:{code:"AltLeft",location:i},165:{code:"AltRight",location:s},166:{code:"BrowserBack"},167:{code:"BrowserForward"},168:{code:"BrowserRefresh"},169:{code:"BrowserStop"},170:{code:"BrowserSearch"},171:{code:"BrowserFavorites"},172:{code:"BrowserHome"},173:{code:"VolumeMute"},174:{code:"VolumeDown"},175:{code:"VolumeUp"},176:{code:"MediaTrackNext"},177:{code:"MediaTrackPrevious"},178:{code:"MediaStop"},179:{code:"MediaPlayPause"},180:{code:"LaunchMail"},181:{code:"MediaSelect"},182:{code:"LaunchApp1"},183:{code:"LaunchApp2"},186:{code:"Semicolon",keyCap:";"},187:{code:"Equal",keyCap:"="},188:{code:"Comma",keyCap:","},189:{code:"Minus",keyCap:"-"},190:{code:"Period",keyCap:"."},191:{code:"Slash",keyCap:"/"},192:{code:"Backquote",keyCap:"`"},219:{code:"BracketLeft",keyCap:"["},220:{code:"Backslash",keyCap:"\\"},221:{code:"BracketRight",keyCap:"]"},222:{code:"Quote",keyCap:"'"},226:{code:"IntlBackslash",keyCap:"\\"},229:{code:"Process"},246:{code:"Attn"},247:{code:"CrSel"},248:{code:"ExSel"},249:{code:"EraseEof"},250:{code:"Play"},251:{code:"ZoomToggle"},254:{code:"Clear"}};h(d,"moz",{59:{code:"Semicolon",keyCap:";"},61:{code:"Equal",keyCap:"="},107:{code:"Equal",keyCap:"="},109:{code:"Minus",keyCap:"-"},187:{code:"NumpadAdd",keyCap:"+",location:o},189:{code:"NumpadSubtract",keyCap:"-",location:o}}),h(d,"moz-mac",{12:{code:"NumLock",location:o},173:{code:"Minus",keyCap:"-"}}),h(d,"moz-win",{173:{code:"Minus",keyCap:"-"}}),h(d,"chrome-mac",{93:{code:"OSRight",location:s}}),h(d,"safari",{3:{code:"Enter"},25:{code:"Tab"}}),h(d,"ios",{10:{code:"Enter",location:n}}),h(d,"safari-mac",{91:{code:"OSLeft",location:i},93:{code:"OSRight",location:s},229:{code:"KeyQ",keyCap:"Q"}});var p={};l==="cros"&&(p["U+00A0"]={code:"ShiftLeft",location:i},p["U+00A1"]={code:"ShiftRight",location:s},p["U+00A2"]={code:"ControlLeft",location:i},p["U+00A3"]={code:"ControlRight",location:s},p["U+00A4"]={code:"AltLeft",location:i},p["U+00A5"]={code:"AltRight",location:s}),u==="chrome-mac"&&(p["U+0010"]={code:"ContextMenu"}),u==="safari-mac"&&(p["U+0010"]={code:"ContextMenu"}),l==="ios"&&(p["U+0010"]={code:"Function"},p["U+001C"]={code:"ArrowLeft"},p["U+001D"]={code:"ArrowRight"},p["U+001E"]={code:"ArrowUp"},p["U+001F"]={code:"ArrowDown"},p["U+0001"]={code:"Home"},p["U+0004"]={code:"End"},p["U+000B"]={code:"PageUp"},p["U+000C"]={code:"PageDown"});var m=[];m[i]={16:{code:"ShiftLeft",location:i},17:{code:"ControlLeft",location:i},18:{code:"AltLeft",location:i}},m[s]={16:{code:"ShiftRight",location:s},17:{code:"ControlRight",location:s},18:{code:"AltRight",location:s}},m[o]={13:{code:"NumpadEnter",location:o}},h(m[o],"moz",{109:{code:"NumpadSubtract",location:o},107:{code:"NumpadAdd",location:o}}),h(m[i],"moz-mac",{224:{code:"OSLeft",location:i}}),h(m[s],"moz-mac",{224:{code:"OSRight",location:s}}),h(m[s],"moz-win",{91:{code:"OSRight",location:s}}),h(m[s],"mac",{93:{code:"OSRight",location:s}}),h(m[o],"chrome-mac",{12:{code:"NumLock",location:o}}),h(m[o],"safari-mac",{12:{code:"NumLock",location:o},187:{code:"NumpadAdd",location:o},189:{code:"NumpadSubtract",location:o},190:{code:"NumpadDecimal",location:o},191:{code:"NumpadDivide",location:o}});var g={ShiftLeft:{key:"Shift"},ShiftRight:{key:"Shift"},ControlLeft:{key:"Control"},ControlRight:{key:"Control"},AltLeft:{key:"Alt"},AltRight:{key:"Alt"},OSLeft:{key:"OS"},OSRight:{key:"OS"},NumpadEnter:{key:"Enter"},Space:{key:" "},Digit0:{key:"0",shiftKey:")"},Digit1:{key:"1",shiftKey:"!"},Digit2:{key:"2",shiftKey:"@"},Digit3:{key:"3",shiftKey:"#"},Digit4:{key:"4",shiftKey:"$"},Digit5:{key:"5",shiftKey:"%"},Digit6:{key:"6",shiftKey:"^"},Digit7:{key:"7",shiftKey:"&"},Digit8:{key:"8",shiftKey:"*"},Digit9:{key:"9",shiftKey:"("},KeyA:{key:"a",shiftKey:"A"},KeyB:{key:"b",shiftKey:"B"},KeyC:{key:"c",shiftKey:"C"},KeyD:{key:"d",shiftKey:"D"},KeyE:{key:"e",shiftKey:"E"},KeyF:{key:"f",shiftKey:"F"},KeyG:{key:"g",shiftKey:"G"},KeyH:{key:"h",shiftKey:"H"},KeyI:{key:"i",shiftKey:"I"},KeyJ:{key:"j",shiftKey:"J"},KeyK:{key:"k",shiftKey:"K"},KeyL:{key:"l",shiftKey:"L"},KeyM:{key:"m",shiftKey:"M"},KeyN:{key:"n",shiftKey:"N"},KeyO:{key:"o",shiftKey:"O"},KeyP:{key:"p",shiftKey:"P"},KeyQ:{key:"q",shiftKey:"Q"},KeyR:{key:"r",shiftKey:"R"},KeyS:{key:"s",shiftKey:"S"},KeyT:{key:"t",shiftKey:"T"},KeyU:{key:"u",shiftKey:"U"},KeyV:{key:"v",shiftKey:"V"},KeyW:{key:"w",shiftKey:"W"},KeyX:{key:"x",shiftKey:"X"},KeyY:{key:"y",shiftKey:"Y"},KeyZ:{key:"z",shiftKey:"Z"},Numpad0:{key:"0"},Numpad1:{key:"1"},Numpad2:{key:"2"},Numpad3:{key:"3"},Numpad4:{key:"4"},Numpad5:{key:"5"},Numpad6:{key:"6"},Numpad7:{key:"7"},Numpad8:{key:"8"},Numpad9:{key:"9"},NumpadMultiply:{key:"*"},NumpadAdd:{key:"+"},NumpadComma:{key:","},NumpadSubtract:{key:"-"},NumpadDecimal:{key:"."},NumpadDivide:{key:"/"},Semicolon:{key:";",shiftKey:":"},Equal:{key:"=",shiftKey:"+"},Comma:{key:",",shiftKey:"<"},Minus:{key:"-",shiftKey:"_"},Period:{key:".",shiftKey:">"},Slash:{key:"/",shiftKey:"?"},Backquote:{key:"`",shiftKey:"~"},BracketLeft:{key:"[",shiftKey:"{"},Backslash:{key:"\\",shiftKey:"|"},BracketRight:{key:"]",shiftKey:"}"},Quote:{key:"'",shiftKey:'"'},IntlBackslash:{key:"\\",shiftKey:"|"}};h(g,"mac",{OSLeft:{key:"Meta"},OSRight:{key:"Meta"}});var v={Esc:"Escape",Nonconvert:"NonConvert",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Menu:"ContextMenu",MediaNextTrack:"MediaTrackNext",MediaPreviousTrack:"MediaTrackPrevious",SelectMedia:"MediaSelect",HalfWidth:"Hankaku",FullWidth:"Zenkaku",RomanCharacters:"Romaji",Crsel:"CrSel",Exsel:"ExSel",Zoom:"ZoomToggle"},y=f(d,"code");try{var x=e&&"location"in new KeyboardEvent("")}catch{}function b(_){var S="keyCode"in _?_.keyCode:"which"in _?_.which:0,T=function(){if(x||"keyLocation"in _){var M=x?_.location:_.keyLocation;if(M&&S in m[M])return m[M][S]}return"keyIdentifier"in _&&_.keyIdentifier in p?p[_.keyIdentifier]:S in d?d[S]:null}();if(!T)return null;var E=function(){var M=g[T.code];return M?_.shiftKey&&"shiftKey"in M?M.shiftKey:M.key:T.code}();return{code:T.code,key:E,location:T.location,keyCap:T.keyCap}}function w(_,S){if(_=String(_),!y.hasOwnProperty(_))return"Undefined";if(S&&String(S).toLowerCase()!=="en-us")throw Error("Unsupported locale");var T=y[_];return T.keyCap||T.code||"Undefined"}"KeyboardEvent"in r&&"defineProperty"in Object&&function(){function _(T,E,M){E in T||Object.defineProperty(T,E,M)}if(_(KeyboardEvent.prototype,"code",{get:function(){var T=b(this);return T?T.code:""}}),"key"in KeyboardEvent.prototype){var S=Object.getOwnPropertyDescriptor(KeyboardEvent.prototype,"key");Object.defineProperty(KeyboardEvent.prototype,"key",{get:function(){var T=S.get.call(this);return v.hasOwnProperty(T)?v[T]:T}})}_(KeyboardEvent.prototype,"key",{get:function(){var T=b(this);return T&&"key"in T?T.key:"Unidentified"}}),_(KeyboardEvent.prototype,"location",{get:function(){var T=b(this);return T&&"location"in T?T.location:n}}),_(KeyboardEvent.prototype,"locale",{get:function(){return""}})}(),"queryKeyCap"in r.KeyboardEvent||(r.KeyboardEvent.queryKeyCap=w),r.identifyKey=function(_){if(!("code"in _)){var S=b(_);_.code=S?S.code:"",_.key=S&&"key"in S?S.key:"Unidentified",_.location="location"in _?_.location:"keyLocation"in _?_.keyLocation:S&&"location"in S?S.location:n,_.locale=""}}})(window);const Dpe="__keyboard-controls-proxy",kpe=window.KeyboardEvent;AFRAME.registerComponent("keyboard-controls",{schema:{enabled:{default:!0},debug:{default:!1}},init:function(){this.dVelocity=new THREE.Vector3,this.localKeys={},this.listeners={keydown:this.onKeyDown.bind(this),keyup:this.onKeyUp.bind(this),blur:this.onBlur.bind(this),onContextMenu:this.onContextMenu.bind(this)}},isVelocityActive:function(){return this.data.enabled&&!!Object.keys(this.getKeys()).length},getVelocityDelta:function(){const r=this.data,e=this.getKeys();return this.dVelocity.set(0,0,0),r.enabled&&((e.KeyW||e.ArrowUp)&&(this.dVelocity.z-=1),(e.KeyA||e.ArrowLeft)&&(this.dVelocity.x-=1),(e.KeyS||e.ArrowDown)&&(this.dVelocity.z+=1),(e.KeyD||e.ArrowRight)&&(this.dVelocity.x+=1),e.ShiftLeft&&(this.dVelocity=this.dVelocity.multiplyScalar(2))),this.dVelocity.clone()},play:function(){this.attachEventListeners()},pause:function(){this.removeEventListeners()},attachEventListeners:function(){window.addEventListener("contextmenu",this.listeners.onContextMenu,!1),window.addEventListener("keydown",this.listeners.keydown,!1),window.addEventListener("keyup",this.listeners.keyup,!1),window.addEventListener("blur",this.listeners.blur,!1)},onContextMenu:function(){for(const r in this.localKeys)this.localKeys.hasOwnProperty(r)&&delete this.localKeys[r]},removeEventListeners:function(){window.removeEventListener("keydown",this.listeners.keydown),window.removeEventListener("keyup",this.listeners.keyup),window.removeEventListener("blur",this.listeners.blur)},onKeyDown:function(r){AFRAME.utils.shouldCaptureKeyEvent(r)&&(this.localKeys[r.code]=!0,this.emit(r))},onKeyUp:function(r){AFRAME.utils.shouldCaptureKeyEvent(r)&&(delete this.localKeys[r.code],this.emit(r))},onBlur:function(){for(const r in this.localKeys)this.localKeys.hasOwnProperty(r)&&delete this.localKeys[r]},emit:function(r){Dpe in r&&this.el.emit(r.type,r),this.el.emit(r.type+":"+r.code,new kpe(r.type,r)),this.data.debug&&console.log(r.type+":"+r.code)},isPressed:function(r){return r in this.getKeys()},getKeys:function(){return this.isProxied()?this.el.sceneEl.components["proxy-controls"].getKeyboard():this.localKeys},isProxied:function(){const r=this.el.sceneEl.components["proxy-controls"];return r&&r.isConnected()}});AFRAME.registerComponent("touch-controls",{schema:{enabled:{default:!0},reverseEnabled:{default:!0}},init:function(){this.dVelocity=new THREE.Vector3,this.bindMethods(),this.direction=0},play:function(){this.addEventListeners()},pause:function(){this.removeEventListeners(),this.dVelocity.set(0,0,0)},remove:function(){this.pause()},addEventListeners:function(){const r=this.el.sceneEl,e=r.canvas;if(!e){r.addEventListener("render-target-loaded",this.addEventListeners.bind(this));return}e.addEventListener("touchstart",this.onTouchStart,{passive:!0}),e.addEventListener("touchend",this.onTouchEnd,{passive:!0});const n=r.getAttribute("vr-mode-ui");n&&n.cardboardModeEnabled&&r.addEventListener("enter-vr",this.onEnterVR)},removeEventListeners:function(){const r=this.el.sceneEl&&this.el.sceneEl.canvas;r&&(r.removeEventListener("touchstart",this.onTouchStart),r.removeEventListener("touchend",this.onTouchEnd),this.el.sceneEl.removeEventListener("enter-vr",this.onEnterVR))},isVelocityActive:function(){return this.data.enabled&&!!this.direction},getVelocityDelta:function(){return this.dVelocity.z=this.direction,this.dVelocity.clone()},bindMethods:function(){this.onTouchStart=this.onTouchStart.bind(this),this.onTouchEnd=this.onTouchEnd.bind(this),this.onEnterVR=this.onEnterVR.bind(this)},onTouchStart:function(r){this.direction=-1,this.data.reverseEnabled&&r.touches&&r.touches.length===2&&(this.direction=1),r.preventDefault()},onTouchEnd:function(r){this.direction=0,r.preventDefault()},onEnterVR:function(){const r=this.el.sceneEl.xrSession;r&&(r.addEventListener("selectstart",this.onTouchStart),r.addEventListener("selectend",this.onTouchEnd))}});const pP="-controls",Ipe=.2,Lpe=1e-5,Fpe="moved";AFRAME.registerComponent("movement-controls",{dependencies:["rotation"],schema:{enabled:{default:!0},controls:{default:["gamepad","trackpad","keyboard","touch"]},speed:{default:.3,min:0},fly:{default:!1},constrainToNavMesh:{default:!1},camera:{default:"[movement-controls] [camera]",type:"selector"}},init:function(){const r=this.el;this.data.camera||(this.data.camera=r.querySelector("[camera]")),this.velocityCtrl=null,this.velocity=new THREE.Vector3,this.heading=new THREE.Quaternion,this.eventDetail={},this.navGroup=null,this.navNode=null,r.sceneEl.hasLoaded?this.injectControls():r.sceneEl.addEventListener("loaded",this.injectControls.bind(this))},update:function(r){const e=this.el,n=this.data,i=e.sceneEl.systems.nav;if(e.sceneEl.hasLoaded&&this.injectControls(),i&&n.constrainToNavMesh!==r.constrainToNavMesh&&(n.constrainToNavMesh?i.addAgent(this):i.removeAgent(this)),n.enabled!==r.enabled)for(let s=0;s<n.controls.length;s++){const o=n.controls[s]+pP;this.el.setAttribute(o,{enabled:this.data.enabled})}},injectControls:function(){const r=this.data;for(let e=0;e<r.controls.length;e++){const n=r.controls[e]+pP;this.el.setAttribute(n,{enabled:this.data.enabled})}},updateNavLocation:function(){this.navGroup=null,this.navNode=null},tick:function(){const r=new THREE.Vector3,e=new THREE.Vector3,n=new THREE.Vector3;return function(i,s){if(!s)return;const o=this.el,a=this.data;if(!a.enabled)return;this.updateVelocityCtrl();const l=this.velocityCtrl,c=this.velocity;if(l)if(s/1e3>Ipe?c.set(0,0,0):this.updateVelocity(s),a.constrainToNavMesh&&l.isNavMeshConstrained!==!1){if(c.lengthSq()<Lpe)return;r.copy(o.object3D.position),e.copy(c).multiplyScalar(s/1e3).add(r);const u=o.sceneEl.systems.nav;this.navGroup=this.navGroup===null?u.getGroup(r):this.navGroup,this.navNode=this.navNode||u.getNode(r,this.navGroup),this.navNode=u.clampStep(r,e,this.navGroup,this.navNode,n),o.object3D.position.copy(n)}else o.hasAttribute("velocity")?o.setAttribute("velocity",c):(o.object3D.position.x+=c.x*s/1e3,o.object3D.position.y+=c.y*s/1e3,o.object3D.position.z+=c.z*s/1e3)}}(),updateVelocityCtrl:function(){const r=this.data;if(r.enabled){for(let e=0,n=r.controls.length;e<n;e++){const i=this.el.components[r.controls[e]+pP];if(i&&i.isVelocityActive()){this.velocityCtrl=i;return}}this.velocityCtrl=null}},updateVelocity:function(){const r=new THREE.Vector2,e=new THREE.Quaternion;return function(n){let i;const s=this.el,o=this.velocityCtrl,a=this.velocity,l=this.data;if(o)if(o.getVelocityDelta)i=o.getVelocityDelta(n);else if(o.getVelocity){a.copy(o.getVelocity());return}else if(o.getPositionDelta){a.copy(o.getPositionDelta(n).multiplyScalar(1e3/n));return}else throw new Error("Incompatible movement controls: ",o);if(s.hasAttribute("velocity")&&!l.constrainToNavMesh&&a.copy(this.el.getAttribute("velocity")),i&&l.enabled){const c=l.camera;e.copy(c.object3D.quaternion),e.premultiply(s.object3D.quaternion),i.applyQuaternion(e);const u=i.length();l.fly?(a.copy(i),a.multiplyScalar(this.data.speed*16.66667)):(r.set(i.x,i.z),r.setLength(u*this.data.speed*16.66667),a.x=r.x,a.y=0,a.z=r.y),(a.x!==0||a.y!==0||a.z!==0)&&(this.eventDetail.velocity=a,this.el.emit(Fpe,this.eventDetail))}}}()});AFRAME.registerComponent("trackpad-controls",{schema:{enabled:{default:!0},enableNegX:{default:!0},enablePosX:{default:!0},enableNegZ:{default:!0},enablePosZ:{default:!0},mode:{default:"touch",oneOf:["swipe","touch","press"]}},init:function(){this.dVelocity=new THREE.Vector3,this.zVel=0,this.xVel=0,this.bindMethods()},play:function(){this.addEventListeners()},pause:function(){this.removeEventListeners(),this.dVelocity.set(0,0,0)},remove:function(){this.pause()},addEventListeners:function(){const r=this.data,e=this.el.sceneEl;switch(e.addEventListener("axismove",this.onAxisMove),r.mode){case"swipe":case"touch":e.addEventListener("trackpadtouchstart",this.onTouchStart),e.addEventListener("trackpadtouchend",this.onTouchEnd);break;case"press":e.addEventListener("trackpaddown",this.onTouchStart),e.addEventListener("trackpadup",this.onTouchEnd);break}},removeEventListeners:function(){const r=this.el.sceneEl;r.removeEventListener("axismove",this.onAxisMove),r.removeEventListener("trackpadtouchstart",this.onTouchStart),r.removeEventListener("trackpadtouchend",this.onTouchEnd),r.removeEventListener("trackpaddown",this.onTouchStart),r.removeEventListener("trackpadup",this.onTouchEnd)},isVelocityActive:function(){return this.data.enabled&&this.isMoving},getVelocityDelta:function(){return this.dVelocity.z=this.isMoving?-this.zVel:1,this.dVelocity.x=this.isMoving?this.xVel:1,this.dVelocity.clone()},bindMethods:function(){this.onTouchStart=this.onTouchStart.bind(this),this.onTouchEnd=this.onTouchEnd.bind(this),this.onAxisMove=this.onAxisMove.bind(this)},onTouchStart:function(r){switch(this.data.mode){case"swipe":this.canRecordAxis=!0,this.startingAxisData=[];break;case"touch":this.isMoving=!0;break;case"press":this.isMoving=!0;break}r.preventDefault()},onTouchEnd:function(r){this.data.mode=="swipe"&&(this.startingAxisData=[]),this.isMoving=!1,r.preventDefault()},onAxisMove:function(r){switch(this.data.mode){case"swipe":return this.handleSwipeAxis(r);case"touch":case"press":return this.handleTouchAxis(r)}},handleSwipeAxis:function(r){const e=this.data,n=r.detail.axis;if(this.startingAxisData.length===0&&this.canRecordAxis&&(this.canRecordAxis=!1,this.startingAxisData[0]=n[0],this.startingAxisData[1]=n[1]),this.startingAxisData.length>0){let i=0,s=0;e.enableNegX&&n[0]<this.startingAxisData[0]&&(i=-1),e.enablePosX&&n[0]>this.startingAxisData[0]&&(i=1),e.enablePosZ&&n[1]>this.startingAxisData[1]&&(s=-1),e.enableNegZ&&n[1]<this.startingAxisData[1]&&(s=1);const o=Math.abs(this.startingAxisData[1]-n[1]);Math.abs(this.startingAxisData[0]-n[0])>o?(this.zVel=0,this.xVel=i,this.isMoving=!0):(this.xVel=0,this.zVel=s,this.isMoving=!0)}},handleTouchAxis:function(r){const e=this.data,n=r.detail.axis;let i=0,s=0;e.enableNegX&&n[0]<0&&(i=-1),e.enablePosX&&n[0]>0&&(i=1),e.enablePosZ&&n[1]>0&&(s=-1),e.enableNegZ&&n[1]<0&&(s=1),Math.abs(n[0])>Math.abs(n[1])?(this.zVel=0,this.xVel=i):(this.xVel=0,this.zVel=s)}});const M1=(r,e)=>{const n=e.x-r.x,i=e.y-r.y;return Math.sqrt(n*n+i*i)},Bpe=(r,e)=>{const n=e.x-r.x,i=e.y-r.y;return zpe(Math.atan2(i,n))},Upe=(r,e,n)=>{const i={x:0,y:0};return n=RO(n),i.x=r.x-e*Math.cos(n),i.y=r.y-e*Math.sin(n),i},RO=r=>r*(Math.PI/180),zpe=r=>r*(180/Math.PI),$pe=r=>isNaN(r.buttons)?r.pressure!==0:r.buttons!==0,mP=new Map,ej=r=>{mP.has(r)&&clearTimeout(mP.get(r)),mP.set(r,setTimeout(r,100))},CT=(r,e,n)=>{const i=e.split(/[ ,]+/g);let s;for(let o=0;o<i.length;o+=1)s=i[o],r.addEventListener?r.addEventListener(s,n,!1):r.attachEvent&&r.attachEvent(s,n)},tj=(r,e,n)=>{const i=e.split(/[ ,]+/g);let s;for(let o=0;o<i.length;o+=1)s=i[o],r.removeEventListener?r.removeEventListener(s,n):r.detachEvent&&r.detachEvent(s,n)},_K=r=>(r.preventDefault(),r.type.match(/^touch/)?r.changedTouches:r),nj=()=>{const r=window.pageXOffset!==void 0?window.pageXOffset:(document.documentElement||document.body.parentNode||document.body).scrollLeft,e=window.pageYOffset!==void 0?window.pageYOffset:(document.documentElement||document.body.parentNode||document.body).scrollTop;return{x:r,y:e}},rj=(r,e)=>{e.top||e.right||e.bottom||e.left?(r.style.top=e.top,r.style.right=e.right,r.style.bottom=e.bottom,r.style.left=e.left):(r.style.left=e.x+"px",r.style.top=e.y+"px")},qL=(r,e,n)=>{const i=wK(r);for(let s in i)if(i.hasOwnProperty(s))if(typeof e=="string")i[s]=e+" "+n;else{let o="";for(let a=0,l=e.length;a<l;a+=1)o+=e[a]+" "+n+", ";i[s]=o.slice(0,-2)}return i},jpe=(r,e)=>{const n=wK(r);for(let i in n)n.hasOwnProperty(i)&&(n[i]=e);return n},wK=r=>{const e={};return e[r]="",["webkit","Moz","o"].forEach(function(i){e[i+r.charAt(0).toUpperCase()+r.slice(1)]=""}),e},gP=(r,e)=>{for(let n in e)e.hasOwnProperty(n)&&(r[n]=e[n]);return r},Vpe=(r,e)=>{const n={};for(let i in r)r.hasOwnProperty(i)&&e.hasOwnProperty(i)?n[i]=e[i]:r.hasOwnProperty(i)&&(n[i]=r[i]);return n},NO=(r,e)=>{if(r.length)for(let n=0,i=r.length;n<i;n+=1)e(r[n]);else e(r)},Gpe=(r,e,n)=>({x:Math.min(Math.max(r.x,e.x-n),e.x+n),y:Math.min(Math.max(r.y,e.y-n),e.y+n)});var Hpe="ontouchstart"in window,Wpe=!!window.PointerEvent,qpe=!!window.MSPointerEvent,ev={touch:{start:"touchstart",move:"touchmove",end:"touchend, touchcancel"},mouse:{start:"mousedown",move:"mousemove",end:"mouseup"},pointer:{start:"pointerdown",move:"pointermove",end:"pointerup, pointercancel"},MSPointer:{start:"MSPointerDown",move:"MSPointerMove",end:"MSPointerUp"}},rm,Tx={};Wpe?rm=ev.pointer:qpe?rm=ev.MSPointer:Hpe?(rm=ev.touch,Tx=ev.mouse):rm=ev.mouse;function mu(){}mu.prototype.on=function(r,e){var n=this,i=r.split(/[ ,]+/g),s;n._handlers_=n._handlers_||{};for(var o=0;o<i.length;o+=1)s=i[o],n._handlers_[s]=n._handlers_[s]||[],n._handlers_[s].push(e);return n};mu.prototype.off=function(r,e){var n=this;return n._handlers_=n._handlers_||{},r===void 0?n._handlers_={}:e===void 0?n._handlers_[r]=null:n._handlers_[r]&&n._handlers_[r].indexOf(e)>=0&&n._handlers_[r].splice(n._handlers_[r].indexOf(e),1),n};mu.prototype.trigger=function(r,e){var n=this,i=r.split(/[ ,]+/g),s;n._handlers_=n._handlers_||{};for(var o=0;o<i.length;o+=1)s=i[o],n._handlers_[s]&&n._handlers_[s].length&&n._handlers_[s].forEach(function(a){a.call(n,{type:s,target:n},e)})};mu.prototype.config=function(r){var e=this;e.options=e.defaults||{},r&&(e.options=Vpe(e.options,r))};mu.prototype.bindEvt=function(r,e){var n=this;return n._domHandlers_=n._domHandlers_||{},n._domHandlers_[e]=function(){typeof n["on"+e]=="function"?n["on"+e].apply(n,arguments):console.warn('[WARNING] : Missing "on'+e+'" handler.')},CT(r,rm[e],n._domHandlers_[e]),Tx[e]&&CT(r,Tx[e],n._domHandlers_[e]),n};mu.prototype.unbindEvt=function(r,e){var n=this;return n._domHandlers_=n._domHandlers_||{},tj(r,rm[e],n._domHandlers_[e]),Tx[e]&&tj(r,Tx[e],n._domHandlers_[e]),delete n._domHandlers_[e],this};function fi(r,e){return this.identifier=e.identifier,this.position=e.position,this.frontPosition=e.frontPosition,this.collection=r,this.defaults={size:100,threshold:.1,color:"white",fadeTime:250,dataOnly:!1,restJoystick:!0,restOpacity:.5,mode:"dynamic",zone:document.body,lockX:!1,lockY:!1,shape:"circle"},this.config(e),this.options.mode==="dynamic"&&(this.options.restOpacity=0),this.id=fi.id,fi.id+=1,this.buildEl().stylize(),this.instance={el:this.ui.el,on:this.on.bind(this),off:this.off.bind(this),show:this.show.bind(this),hide:this.hide.bind(this),add:this.addToDom.bind(this),remove:this.removeFromDom.bind(this),destroy:this.destroy.bind(this),setPosition:this.setPosition.bind(this),resetDirection:this.resetDirection.bind(this),computeDirection:this.computeDirection.bind(this),trigger:this.trigger.bind(this),position:this.position,frontPosition:this.frontPosition,ui:this.ui,identifier:this.identifier,id:this.id,options:this.options},this.instance}fi.prototype=new mu;fi.constructor=fi;fi.id=0;fi.prototype.buildEl=function(r){return this.ui={},this.options.dataOnly?this:(this.ui.el=document.createElement("div"),this.ui.back=document.createElement("div"),this.ui.front=document.createElement("div"),this.ui.el.className="nipple collection_"+this.collection.id,this.ui.back.className="back",this.ui.front.className="front",this.ui.el.setAttribute("id","nipple_"+this.collection.id+"_"+this.id),this.ui.el.appendChild(this.ui.back),this.ui.el.appendChild(this.ui.front),this)};fi.prototype.stylize=function(){if(this.options.dataOnly)return this;var r=this.options.fadeTime+"ms",e=jpe("borderRadius","50%"),n=qL("transition","opacity",r),i={};return i.el={position:"absolute",opacity:this.options.restOpacity,display:"block",zIndex:999},i.back={position:"absolute",display:"block",width:this.options.size+"px",height:this.options.size+"px",left:0,marginLeft:-this.options.size/2+"px",marginTop:-this.options.size/2+"px",background:this.options.color,opacity:".5"},i.front={width:this.options.size/2+"px",height:this.options.size/2+"px",position:"absolute",display:"block",left:0,marginLeft:-this.options.size/4+"px",marginTop:-this.options.size/4+"px",background:this.options.color,opacity:".5",transform:"translate(0px, 0px)"},gP(i.el,n),this.options.shape==="circle"&&gP(i.back,e),gP(i.front,e),this.applyStyles(i),this};fi.prototype.applyStyles=function(r){for(var e in this.ui)if(this.ui.hasOwnProperty(e))for(var n in r[e])this.ui[e].style[n]=r[e][n];return this};fi.prototype.addToDom=function(){return this.options.dataOnly||document.body.contains(this.ui.el)?this:(this.options.zone.appendChild(this.ui.el),this)};fi.prototype.removeFromDom=function(){return this.options.dataOnly||!document.body.contains(this.ui.el)?this:(this.options.zone.removeChild(this.ui.el),this)};fi.prototype.destroy=function(){clearTimeout(this.removeTimeout),clearTimeout(this.showTimeout),clearTimeout(this.restTimeout),this.trigger("destroyed",this.instance),this.removeFromDom(),this.off()};fi.prototype.show=function(r){var e=this;return e.options.dataOnly||(clearTimeout(e.removeTimeout),clearTimeout(e.showTimeout),clearTimeout(e.restTimeout),e.addToDom(),e.restCallback(),setTimeout(function(){e.ui.el.style.opacity=1},0),e.showTimeout=setTimeout(function(){e.trigger("shown",e.instance),typeof r=="function"&&r.call(this)},e.options.fadeTime)),e};fi.prototype.hide=function(r){var e=this;if(e.options.dataOnly)return e;if(e.ui.el.style.opacity=e.options.restOpacity,clearTimeout(e.removeTimeout),clearTimeout(e.showTimeout),clearTimeout(e.restTimeout),e.removeTimeout=setTimeout(function(){var n=e.options.mode==="dynamic"?"none":"block";e.ui.el.style.display=n,typeof r=="function"&&r.call(e),e.trigger("hidden",e.instance)},e.options.fadeTime),e.options.restJoystick){const n=e.options.restJoystick,i={};i.x=n===!0||n.x!==!1?0:e.instance.frontPosition.x,i.y=n===!0||n.y!==!1?0:e.instance.frontPosition.y,e.setPosition(r,i)}return e};fi.prototype.setPosition=function(r,e){var n=this;n.frontPosition={x:e.x,y:e.y};var i=n.options.fadeTime+"ms",s={};s.front=qL("transition",["transform"],i);var o={front:{}};o.front={transform:"translate("+n.frontPosition.x+"px,"+n.frontPosition.y+"px)"},n.applyStyles(s),n.applyStyles(o),n.restTimeout=setTimeout(function(){typeof r=="function"&&r.call(n),n.restCallback()},n.options.fadeTime)};fi.prototype.restCallback=function(){var r=this,e={};e.front=qL("transition","none",""),r.applyStyles(e),r.trigger("rested",r.instance)};fi.prototype.resetDirection=function(){this.direction={x:!1,y:!1,angle:!1}};fi.prototype.computeDirection=function(r){var e=r.angle.radian,n=Math.PI/4,i=Math.PI/2,s,o,a;if(e>n&&e<n*3&&!r.lockX?s="up":e>-n&&e<=n&&!r.lockY?s="left":e>-n*3&&e<=-n&&!r.lockX?s="down":r.lockY||(s="right"),r.lockY||(e>-i&&e<i?o="left":o="right"),r.lockX||(e>0?a="up":a="down"),r.force>this.options.threshold){var l={},c;for(c in this.direction)this.direction.hasOwnProperty(c)&&(l[c]=this.direction[c]);var u={};this.direction={x:o,y:a,angle:s},r.direction=this.direction;for(c in l)l[c]===this.direction[c]&&(u[c]=!0);if(u.x&&u.y&&u.angle)return r;(!u.x||!u.y)&&this.trigger("plain",r),u.x||this.trigger("plain:"+o,r),u.y||this.trigger("plain:"+a,r),u.angle||this.trigger("dir dir:"+s,r)}else this.resetDirection();return r};function Ir(r,e){var n=this;n.nipples=[],n.idles=[],n.actives=[],n.ids=[],n.pressureIntervals={},n.manager=r,n.id=Ir.id,Ir.id+=1,n.defaults={zone:document.body,multitouch:!1,maxNumberOfNipples:10,mode:"dynamic",position:{top:0,left:0},catchDistance:200,size:100,threshold:.1,color:"white",fadeTime:250,dataOnly:!1,restJoystick:!0,restOpacity:.5,lockX:!1,lockY:!1,shape:"circle",dynamicPage:!1,follow:!1},n.config(e),(n.options.mode==="static"||n.options.mode==="semi")&&(n.options.multitouch=!1),n.options.multitouch||(n.options.maxNumberOfNipples=1);const i=getComputedStyle(n.options.zone.parentElement);return i&&i.display==="flex"&&(n.parentIsFlex=!0),n.updateBox(),n.prepareNipples(),n.bindings(),n.begin(),n.nipples}Ir.prototype=new mu;Ir.constructor=Ir;Ir.id=0;Ir.prototype.prepareNipples=function(){var r=this,e=r.nipples;e.on=r.on.bind(r),e.off=r.off.bind(r),e.options=r.options,e.destroy=r.destroy.bind(r),e.ids=r.ids,e.id=r.id,e.processOnMove=r.processOnMove.bind(r),e.processOnEnd=r.processOnEnd.bind(r),e.get=function(n){if(n===void 0)return e[0];for(var i=0,s=e.length;i<s;i+=1)if(e[i].identifier===n)return e[i];return!1}};Ir.prototype.bindings=function(){var r=this;r.bindEvt(r.options.zone,"start"),r.options.zone.style.touchAction="none",r.options.zone.style.msTouchAction="none"};Ir.prototype.begin=function(){var r=this,e=r.options;if(e.mode==="static"){var n=r.createNipple(e.position,r.manager.getIdentifier());n.add(),r.idles.push(n)}};Ir.prototype.createNipple=function(r,e){var n=this,i=n.manager.scroll,s={},o=n.options,a={x:n.parentIsFlex?i.x:i.x+n.box.left,y:n.parentIsFlex?i.y:i.y+n.box.top};if(r.x&&r.y)s={x:r.x-a.x,y:r.y-a.y};else if(r.top||r.right||r.bottom||r.left){var l=document.createElement("DIV");l.style.display="hidden",l.style.top=r.top,l.style.right=r.right,l.style.bottom=r.bottom,l.style.left=r.left,l.style.position="absolute",o.zone.appendChild(l);var c=l.getBoundingClientRect();o.zone.removeChild(l),s=r,r={x:c.left+i.x,y:c.top+i.y}}var u=new fi(n,{color:o.color,size:o.size,threshold:o.threshold,fadeTime:o.fadeTime,dataOnly:o.dataOnly,restJoystick:o.restJoystick,restOpacity:o.restOpacity,mode:o.mode,identifier:e,position:r,zone:o.zone,frontPosition:{x:0,y:0},shape:o.shape});return o.dataOnly||(rj(u.ui.el,s),rj(u.ui.front,u.frontPosition)),n.nipples.push(u),n.trigger("added "+u.identifier+":added",u),n.manager.trigger("added "+u.identifier+":added",u),n.bindNipple(u),u};Ir.prototype.updateBox=function(){var r=this;r.box=r.options.zone.getBoundingClientRect()};Ir.prototype.bindNipple=function(r){var e=this,n,i=function(s,o){n=s.type+" "+o.id+":"+s.type,e.trigger(n,o)};r.on("destroyed",e.onDestroyed.bind(e)),r.on("shown hidden rested dir plain",i),r.on("dir:up dir:right dir:down dir:left",i),r.on("plain:up plain:right plain:down plain:left",i)};Ir.prototype.pressureFn=function(r,e,n){var i=this,s=0;clearInterval(i.pressureIntervals[n]),i.pressureIntervals[n]=setInterval((function(){var o=r.force||r.pressure||r.webkitForce||0;o!==s&&(e.trigger("pressure",o),i.trigger("pressure "+e.identifier+":pressure",o),s=o)}).bind(i),100)};Ir.prototype.onstart=function(r){var e=this,n=e.options,i=r;r=_K(r),e.updateBox();var s=function(o){e.actives.length<n.maxNumberOfNipples?e.processOnStart(o):i.type.match(/^touch/)&&(Object.keys(e.manager.ids).forEach(function(a){if(Object.values(i.touches).findIndex(function(c){return c.identifier===a})<0){var l=[r[0]];l.identifier=a,e.processOnEnd(l)}}),e.actives.length<n.maxNumberOfNipples&&e.processOnStart(o))};return NO(r,s),e.manager.bindDocument(),!1};Ir.prototype.processOnStart=function(r){var e=this,n=e.options,i,s=e.manager.getIdentifier(r),o=r.force||r.pressure||r.webkitForce||0,a={x:r.pageX,y:r.pageY},l=e.getOrCreate(s,a);l.identifier!==s&&e.manager.removeIdentifier(l.identifier),l.identifier=s;var c=function(h){h.trigger("start",h),e.trigger("start "+h.id+":start",h),h.show(),o>0&&e.pressureFn(r,h,h.identifier),e.processOnMove(r)};if((i=e.idles.indexOf(l))>=0&&e.idles.splice(i,1),e.actives.push(l),e.ids.push(l.identifier),n.mode!=="semi")c(l);else{var u=M1(a,l.position);if(u<=n.catchDistance)c(l);else{l.destroy(),e.processOnStart(r);return}}return l};Ir.prototype.getOrCreate=function(r,e){var n=this,i=n.options,s;return/(semi|static)/.test(i.mode)?(s=n.idles[0],s?(n.idles.splice(0,1),s):i.mode==="semi"?n.createNipple(e,r):(console.warn("Coudln't find the needed nipple."),!1)):(s=n.createNipple(e,r),s)};Ir.prototype.processOnMove=function(r){var e=this,n=e.options,i=e.manager.getIdentifier(r),s=e.nipples.get(i),o=e.manager.scroll;if(!$pe(r)){this.processOnEnd(r);return}if(!s){console.error("Found zombie joystick with ID "+i),e.manager.removeIdentifier(i);return}if(n.dynamicPage){var a=s.el.getBoundingClientRect();s.position={x:o.x+a.left,y:o.y+a.top}}s.identifier=i;var l=s.options.size/2,c={x:r.pageX,y:r.pageY};n.lockX&&(c.y=s.position.y),n.lockY&&(c.x=s.position.x);var u=M1(c,s.position),h=Bpe(c,s.position),f=RO(h),d=u/l,p={distance:u,position:c},m,g;if(s.options.shape==="circle"?(m=Math.min(u,l),g=Upe(s.position,m,h)):(g=Gpe(c,s.position,l),m=M1(g,s.position)),n.follow){if(u>l){let b=c.x-g.x,w=c.y-g.y;s.position.x+=b,s.position.y+=w,s.el.style.top=s.position.y-(e.box.top+o.y)+"px",s.el.style.left=s.position.x-(e.box.left+o.x)+"px",u=M1(c,s.position)}}else c=g,u=m;var v=c.x-s.position.x,y=c.y-s.position.y;s.frontPosition={x:v,y},n.dataOnly||(s.ui.front.style.transform="translate("+v+"px,"+y+"px)");var x={identifier:s.identifier,position:c,force:d,pressure:r.force||r.pressure||r.webkitForce||0,distance:u,angle:{radian:f,degree:h},vector:{x:v/l,y:-y/l},raw:p,instance:s,lockX:n.lockX,lockY:n.lockY};x=s.computeDirection(x),x.angle={radian:RO(180-h),degree:180-h},s.trigger("move",x),e.trigger("move "+s.id+":move",x)};Ir.prototype.processOnEnd=function(r){var e=this,n=e.options,i=e.manager.getIdentifier(r),s=e.nipples.get(i),o=e.manager.removeIdentifier(s.identifier);s&&(n.dataOnly||s.hide(function(){n.mode==="dynamic"&&(s.trigger("removed",s),e.trigger("removed "+s.id+":removed",s),e.manager.trigger("removed "+s.id+":removed",s),s.destroy())}),clearInterval(e.pressureIntervals[s.identifier]),s.resetDirection(),s.trigger("end",s),e.trigger("end "+s.id+":end",s),e.ids.indexOf(s.identifier)>=0&&e.ids.splice(e.ids.indexOf(s.identifier),1),e.actives.indexOf(s)>=0&&e.actives.splice(e.actives.indexOf(s),1),/(semi|static)/.test(n.mode)?e.idles.push(s):e.nipples.indexOf(s)>=0&&e.nipples.splice(e.nipples.indexOf(s),1),e.manager.unbindDocument(),/(semi|static)/.test(n.mode)&&(e.manager.ids[o.id]=o.identifier))};Ir.prototype.onDestroyed=function(r,e){var n=this;n.nipples.indexOf(e)>=0&&n.nipples.splice(n.nipples.indexOf(e),1),n.actives.indexOf(e)>=0&&n.actives.splice(n.actives.indexOf(e),1),n.idles.indexOf(e)>=0&&n.idles.splice(n.idles.indexOf(e),1),n.ids.indexOf(e.identifier)>=0&&n.ids.splice(n.ids.indexOf(e.identifier),1),n.manager.removeIdentifier(e.identifier),n.manager.unbindDocument()};Ir.prototype.destroy=function(){var r=this;r.unbindEvt(r.options.zone,"start"),r.nipples.forEach(function(n){n.destroy()});for(var e in r.pressureIntervals)r.pressureIntervals.hasOwnProperty(e)&&clearInterval(r.pressureIntervals[e]);r.trigger("destroyed",r.nipples),r.manager.unbindDocument(),r.off()};function Ci(r){var e=this;e.ids={},e.index=0,e.collections=[],e.scroll=nj(),e.config(r),e.prepareCollections();var n=function(){var s;e.collections.forEach(function(o){o.forEach(function(a){s=a.el.getBoundingClientRect(),a.position={x:e.scroll.x+s.left,y:e.scroll.y+s.top}})})};CT(window,"resize",function(){ej(n)});var i=function(){e.scroll=nj()};return CT(window,"scroll",function(){ej(i)}),e.collections}Ci.prototype=new mu;Ci.constructor=Ci;Ci.prototype.prepareCollections=function(){var r=this;r.collections.create=r.create.bind(r),r.collections.on=r.on.bind(r),r.collections.off=r.off.bind(r),r.collections.destroy=r.destroy.bind(r),r.collections.get=function(e){var n;return r.collections.every(function(i){return n=i.get(e),!n}),n}};Ci.prototype.create=function(r){return this.createCollection(r)};Ci.prototype.createCollection=function(r){var e=this,n=new Ir(e,r);return e.bindCollection(n),e.collections.push(n),n};Ci.prototype.bindCollection=function(r){var e=this,n,i=function(s,o){n=s.type+" "+o.id+":"+s.type,e.trigger(n,o)};r.on("destroyed",e.onDestroyed.bind(e)),r.on("shown hidden rested dir plain",i),r.on("dir:up dir:right dir:down dir:left",i),r.on("plain:up plain:right plain:down plain:left",i)};Ci.prototype.bindDocument=function(){var r=this;r.binded||(r.bindEvt(document,"move").bindEvt(document,"end"),r.binded=!0)};Ci.prototype.unbindDocument=function(r){var e=this;(!Object.keys(e.ids).length||r===!0)&&(e.unbindEvt(document,"move").unbindEvt(document,"end"),e.binded=!1)};Ci.prototype.getIdentifier=function(r){var e;return r?(e=r.identifier===void 0?r.pointerId:r.identifier,e===void 0&&(e=this.latest||0)):e=this.index,this.ids[e]===void 0&&(this.ids[e]=this.index,this.index+=1),this.latest=e,this.ids[e]};Ci.prototype.removeIdentifier=function(r){var e={};for(var n in this.ids)if(this.ids[n]===r){e.id=n,e.identifier=this.ids[n],delete this.ids[n];break}return e};Ci.prototype.onmove=function(r){var e=this;return e.onAny("move",r),!1};Ci.prototype.onend=function(r){var e=this;return e.onAny("end",r),!1};Ci.prototype.oncancel=function(r){var e=this;return e.onAny("end",r),!1};Ci.prototype.onAny=function(r,e){var n=this,i,s="processOn"+r.charAt(0).toUpperCase()+r.slice(1);e=_K(e);var o=function(l,c,u){u.ids.indexOf(c)>=0&&(u[s](l),l._found_=!0)},a=function(l){i=n.getIdentifier(l),NO(n.collections,o.bind(null,l,i)),l._found_||n.removeIdentifier(i)};return NO(e,a),!1};Ci.prototype.destroy=function(){var r=this;r.unbindDocument(!0),r.ids={},r.index=0,r.collections.forEach(function(e){e.destroy()}),r.off()};Ci.prototype.onDestroyed=function(r,e){var n=this;if(n.collections.indexOf(e)<0)return!1;n.collections.splice(n.collections.indexOf(e),1)};const ij=new Ci,sj={create:function(r){return ij.create(r)},factory:ij};AFRAME.registerComponent("nipple-controls",{schema:{enabled:{default:!0},mode:{default:"dynamic",oneOf:["static","semi","dynamic"]},rotationSensitivity:{default:1},moveJoystickEnabled:{default:!0},lookJoystickEnabled:{default:!0},sideMargin:{default:"30px"},bottomMargin:{default:"70px"},moveJoystickPosition:{default:"left",oneOf:["left","right"]},lookJoystickPosition:{default:"right",oneOf:["left","right"]}},init(){this.dVelocity=new THREE.Vector3,this.lookVector=new THREE.Vector2;const r=this.el.querySelector("[look-controls]").components["look-controls"];this.pitchObject=r.pitchObject,this.yawObject=r.yawObject,this.rigRotation=this.el.object3D.rotation,this.moveData=void 0,this.lookData=void 0,this.moving=!1,this.rotating=!1},update(r){(this.data.moveJoystickPosition!==r.moveJoystickPosition||this.data.sideMargin!==r.sideMargin||this.data.bottomMargin!==r.bottomMargin||this.data.mode!==r.mode)&&this.removeMoveJoystick(),(this.data.lookJoystickPosition!==r.lookJoystickPosition||this.data.sideMargin!==r.sideMargin||this.data.bottomMargin!==r.bottomMargin||this.data.mode!==r.mode)&&this.removeLookJoystick(),this.data.enabled&&this.data.moveJoystickEnabled?this.createMoveJoystick():this.removeMoveJoystick(),this.data.enabled&&this.data.lookJoystickEnabled?this.createLookJoystick():this.removeLookJoystick()},pause(){this.moving=!1,this.rotating=!1},remove(){this.removeMoveJoystick(),this.removeLookJoystick()},isVelocityActive(){return this.data.enabled&&this.moving},getVelocityDelta(){if(this.dVelocity.set(0,0,0),this.isVelocityActive()){const r=this.moveData.force<1?this.moveData.force:1,e=this.moveData.angle.radian,n=Math.cos(e)*r,i=-Math.sin(e)*r;this.dVelocity.set(n,0,i)}return this.dVelocity},isRotationActive(){return this.data.enabled&&this.rotating},updateRotation(r){if(!this.isRotationActive())return;const e=this.lookData.force<1?this.lookData.force:1,n=this.lookData.angle.radian,i=this.lookVector;i.x=Math.cos(n)*e,i.y=Math.sin(n)*e,i.multiplyScalar(this.data.rotationSensitivity*r/1e3),this.yawObject.rotation.y-=i.x;let s=this.pitchObject.rotation.x+i.y;s=Math.max(-Math.PI/2,Math.min(Math.PI/2,s)),this.pitchObject.rotation.x=s},tick:function(r,e){this.updateRotation(e)},initLeftZone(){const r=document.createElement("div");r.setAttribute("id","joystickLeftZone"),r.setAttribute("style",`position:absolute;${this.data.moveJoystickPosition}:${this.data.sideMargin};bottom:${this.data.bottomMargin};z-index:1`),document.body.appendChild(r),this.leftZone=r},initRightZone(){const r=document.createElement("div");r.setAttribute("id","joystickRightZone"),r.setAttribute("style",`position:absolute;${this.data.lookJoystickPosition}:${this.data.sideMargin};bottom:${this.data.bottomMargin};z-index:1`),document.body.appendChild(r),this.rightZone=r},createMoveJoystick(){if(this.moveJoystick)return;this.initLeftZone();const r={mode:this.data.mode,zone:this.leftZone,color:"white",fadeTime:0};this.leftZone.style.width="100px",this.data.mode==="static"?(this.leftZone.style.height="100px",r.position={left:"50%",bottom:"50%"}):this.leftZone.style.height="400px",this.moveJoystick=sj.create(r),this.moveJoystick.on("move",(e,n)=>{this.moveData=n,this.moving=!0}),this.moveJoystick.on("end",(e,n)=>{this.moving=!1})},createLookJoystick(){if(this.lookJoystick)return;this.initRightZone();const r={mode:this.data.mode,zone:this.rightZone,color:"white",fadeTime:0};this.rightZone.style.width="100px",this.data.mode==="static"?(this.rightZone.style.height="100px",r.position={left:"50%",bottom:"50%"}):this.rightZone.style.height="400px",this.lookJoystick=sj.create(r),this.lookJoystick.on("move",(e,n)=>{this.lookData=n,this.rotating=!0}),this.lookJoystick.on("end",(e,n)=>{this.rotating=!1})},removeMoveJoystick(){this.moveJoystick&&(this.moveJoystick.destroy(),this.moveJoystick=void 0),this.moveData=void 0,this.leftZone&&this.leftZone.parentNode&&(this.leftZone.remove(),this.leftZone=void 0)},removeLookJoystick(){this.lookJoystick&&(this.lookJoystick.destroy(),this.lookJoystick=void 0),this.lookData=void 0,this.rightZone&&this.rightZone.parentNode&&(this.rightZone.remove(),this.rightZone=void 0)}});const yP={once:THREE.LoopOnce,repeat:THREE.LoopRepeat,pingpong:THREE.LoopPingPong};AFRAME.registerComponent("animation-mixer",{schema:{clip:{default:"*"},useRegExp:{default:!1},duration:{default:0},clampWhenFinished:{default:!1,type:"boolean"},crossFadeDuration:{default:0},loop:{default:"repeat",oneOf:Object.keys(yP)},repetitions:{default:1/0,min:0},timeScale:{default:1},startAt:{default:0}},init:function(){this.model=null,this.mixer=null,this.activeActions=[];const r=this.el.getObject3D("mesh");r?this.load(r):this.el.addEventListener("model-loaded",e=>{this.load(e.detail.model)})},load:function(r){const e=this.el;this.model=r,this.mixer=new THREE.AnimationMixer(r),this.mixer.addEventListener("loop",n=>{e.emit("animation-loop",{action:n.action,loopDelta:n.loopDelta})}),this.mixer.addEventListener("finished",n=>{e.emit("animation-finished",{action:n.action,direction:n.direction})}),this.data.clip&&this.update({})},remove:function(){this.mixer&&this.mixer.stopAllAction()},update:function(r){if(!r)return;const e=this.data,n=AFRAME.utils.diff(e,r);if("clip"in n){this.stopAction(),e.clip&&this.playAction();return}this.activeActions.forEach(i=>{"duration"in n&&e.duration&&i.setDuration(e.duration),"clampWhenFinished"in n&&(i.clampWhenFinished=e.clampWhenFinished),("loop"in n||"repetitions"in n)&&i.setLoop(yP[e.loop],e.repetitions),"timeScale"in n&&i.setEffectiveTimeScale(e.timeScale)})},stopAction:function(){const r=this.data;for(let e=0;e<this.activeActions.length;e++)r.crossFadeDuration?this.activeActions[e].fadeOut(r.crossFadeDuration):this.activeActions[e].stop();this.activeActions.length=0},playAction:function(){if(!this.mixer)return;const r=this.model,e=this.data,n=r.animations||(r.geometry||{}).animations||[];if(!n.length)return;const i=e.useRegExp?e.clip:Xpe(e.clip);for(let s,o=0;s=n[o];o++)if(s.name.match(i)){const a=this.mixer.clipAction(s,r);a.enabled=!0,a.clampWhenFinished=e.clampWhenFinished,e.duration&&a.setDuration(e.duration),e.timeScale!==1&&a.setEffectiveTimeScale(e.timeScale),a.startAt(this.mixer.time-e.startAt/1e3),a.setLoop(yP[e.loop],e.repetitions).fadeIn(e.crossFadeDuration).play(),this.activeActions.push(a)}},tick:function(r,e){this.mixer&&!isNaN(e)&&this.mixer.update(e/1e3)}});function Xpe(r){return new RegExp("^"+r.split(/\*+/).map(Kpe).join(".*")+"$")}function Kpe(r){return r.replace(/[|\\{}()[\]^$+*?.]/g,"\\$&")}/**
 * @license
 * Copyright 2010-2024 Three.js Authors
 * SPDX-License-Identifier: MIT
 */const SK="164",PT=0,Ype=1,Zpe=2,oj=1,aj=100,lj=204,cj=205,uj=3,XL=0,hj="attached",Qpe="detached",TK=300,Jpe=303,oh=1e3,Sl=1001,fj=1002,RT=1003,A1=1006,KL=1008,eme=1009,tme=1014,EK=1015,nme=1020,MK=1023,vP=1026,dj=1027,NT=2300,OT=2301,xP=2302,pj=2400,mj=2401,gj=2402,rme=2500,AK=0,CK="",Ss="srgb",YL="srgb-linear",ime="display-p3",PK="display-p3-linear",OO="linear",yj="srgb",vj="rec709",xj="p3",Wd=7680,bj=519,sme=515,_j=35044,Gf=2e3,DO=2001;let BM=class{addEventListener(e,n){this._listeners===void 0&&(this._listeners={});const i=this._listeners;i[e]===void 0&&(i[e]=[]),i[e].indexOf(n)===-1&&i[e].push(n)}hasEventListener(e,n){if(this._listeners===void 0)return!1;const i=this._listeners;return i[e]!==void 0&&i[e].indexOf(n)!==-1}removeEventListener(e,n){if(this._listeners===void 0)return;const s=this._listeners[e];if(s!==void 0){const o=s.indexOf(n);o!==-1&&s.splice(o,1)}}dispatchEvent(e){if(this._listeners===void 0)return;const i=this._listeners[e.type];if(i!==void 0){e.target=this;const s=i.slice(0);for(let o=0,a=s.length;o<a;o++)s[o].call(this,e);e.target=null}}};const qi=["00","01","02","03","04","05","06","07","08","09","0a","0b","0c","0d","0e","0f","10","11","12","13","14","15","16","17","18","19","1a","1b","1c","1d","1e","1f","20","21","22","23","24","25","26","27","28","29","2a","2b","2c","2d","2e","2f","30","31","32","33","34","35","36","37","38","39","3a","3b","3c","3d","3e","3f","40","41","42","43","44","45","46","47","48","49","4a","4b","4c","4d","4e","4f","50","51","52","53","54","55","56","57","58","59","5a","5b","5c","5d","5e","5f","60","61","62","63","64","65","66","67","68","69","6a","6b","6c","6d","6e","6f","70","71","72","73","74","75","76","77","78","79","7a","7b","7c","7d","7e","7f","80","81","82","83","84","85","86","87","88","89","8a","8b","8c","8d","8e","8f","90","91","92","93","94","95","96","97","98","99","9a","9b","9c","9d","9e","9f","a0","a1","a2","a3","a4","a5","a6","a7","a8","a9","aa","ab","ac","ad","ae","af","b0","b1","b2","b3","b4","b5","b6","b7","b8","b9","ba","bb","bc","bd","be","bf","c0","c1","c2","c3","c4","c5","c6","c7","c8","c9","ca","cb","cc","cd","ce","cf","d0","d1","d2","d3","d4","d5","d6","d7","d8","d9","da","db","dc","dd","de","df","e0","e1","e2","e3","e4","e5","e6","e7","e8","e9","ea","eb","ec","ed","ee","ef","f0","f1","f2","f3","f4","f5","f6","f7","f8","f9","fa","fb","fc","fd","fe","ff"];let wj=1234567;const N0=Math.PI/180,Ex=180/Math.PI;function Uh(){const r=Math.random()*4294967295|0,e=Math.random()*4294967295|0,n=Math.random()*4294967295|0,i=Math.random()*4294967295|0;return(qi[r&255]+qi[r>>8&255]+qi[r>>16&255]+qi[r>>24&255]+"-"+qi[e&255]+qi[e>>8&255]+"-"+qi[e>>16&15|64]+qi[e>>24&255]+"-"+qi[n&63|128]+qi[n>>8&255]+"-"+qi[n>>16&255]+qi[n>>24&255]+qi[i&255]+qi[i>>8&255]+qi[i>>16&255]+qi[i>>24&255]).toLowerCase()}function Li(r,e,n){return Math.max(e,Math.min(n,r))}function ZL(r,e){return(r%e+e)%e}function ome(r,e,n,i,s){return i+(r-e)*(s-i)/(n-e)}function ame(r,e,n){return r!==e?(n-r)/(e-r):0}function O0(r,e,n){return(1-n)*r+n*e}function lme(r,e,n,i){return O0(r,e,1-Math.exp(-n*i))}function cme(r,e=1){return e-Math.abs(ZL(r,e*2)-e)}function ume(r,e,n){return r<=e?0:r>=n?1:(r=(r-e)/(n-e),r*r*(3-2*r))}function hme(r,e,n){return r<=e?0:r>=n?1:(r=(r-e)/(n-e),r*r*r*(r*(r*6-15)+10))}function fme(r,e){return r+Math.floor(Math.random()*(e-r+1))}function dme(r,e){return r+Math.random()*(e-r)}function pme(r){return r*(.5-Math.random())}function mme(r){r!==void 0&&(wj=r);let e=wj+=1831565813;return e=Math.imul(e^e>>>15,e|1),e^=e+Math.imul(e^e>>>7,e|61),((e^e>>>14)>>>0)/4294967296}function gme(r){return r*N0}function yme(r){return r*Ex}function vme(r){return(r&r-1)===0&&r!==0}function xme(r){return Math.pow(2,Math.ceil(Math.log(r)/Math.LN2))}function bme(r){return Math.pow(2,Math.floor(Math.log(r)/Math.LN2))}function _me(r,e,n,i,s){const o=Math.cos,a=Math.sin,l=o(n/2),c=a(n/2),u=o((e+i)/2),h=a((e+i)/2),f=o((e-i)/2),d=a((e-i)/2),p=o((i-e)/2),m=a((i-e)/2);switch(s){case"XYX":r.set(l*h,c*f,c*d,l*u);break;case"YZY":r.set(c*d,l*h,c*f,l*u);break;case"ZXZ":r.set(c*f,c*d,l*h,l*u);break;case"XZX":r.set(l*h,c*m,c*p,l*u);break;case"YXY":r.set(c*p,l*h,c*m,l*u);break;case"ZYZ":r.set(c*m,c*p,l*h,l*u);break;default:console.warn("THREE.MathUtils: .setQuaternionFromProperEuler() encountered an unknown order: "+s)}}function Bp(r,e){switch(e.constructor){case Float32Array:return r;case Uint32Array:return r/4294967295;case Uint16Array:return r/65535;case Uint8Array:return r/255;case Int32Array:return Math.max(r/2147483647,-1);case Int16Array:return Math.max(r/32767,-1);case Int8Array:return Math.max(r/127,-1);default:throw new Error("Invalid component type.")}}function ds(r,e){switch(e.constructor){case Float32Array:return r;case Uint32Array:return Math.round(r*4294967295);case Uint16Array:return Math.round(r*65535);case Uint8Array:return Math.round(r*255);case Int32Array:return Math.round(r*2147483647);case Int16Array:return Math.round(r*32767);case Int8Array:return Math.round(r*127);default:throw new Error("Invalid component type.")}}const zr={DEG2RAD:N0,RAD2DEG:Ex,generateUUID:Uh,clamp:Li,euclideanModulo:ZL,mapLinear:ome,inverseLerp:ame,lerp:O0,damp:lme,pingpong:cme,smoothstep:ume,smootherstep:hme,randInt:fme,randFloat:dme,randFloatSpread:pme,seededRandom:mme,degToRad:gme,radToDeg:yme,isPowerOfTwo:vme,ceilPowerOfTwo:xme,floorPowerOfTwo:bme,setQuaternionFromProperEuler:_me,normalize:ds,denormalize:Bp};let Er=class RK{constructor(e=0,n=0){RK.prototype.isVector2=!0,this.x=e,this.y=n}get width(){return this.x}set width(e){this.x=e}get height(){return this.y}set height(e){this.y=e}set(e,n){return this.x=e,this.y=n,this}setScalar(e){return this.x=e,this.y=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setComponent(e,n){switch(e){case 0:this.x=n;break;case 1:this.y=n;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y)}copy(e){return this.x=e.x,this.y=e.y,this}add(e){return this.x+=e.x,this.y+=e.y,this}addScalar(e){return this.x+=e,this.y+=e,this}addVectors(e,n){return this.x=e.x+n.x,this.y=e.y+n.y,this}addScaledVector(e,n){return this.x+=e.x*n,this.y+=e.y*n,this}sub(e){return this.x-=e.x,this.y-=e.y,this}subScalar(e){return this.x-=e,this.y-=e,this}subVectors(e,n){return this.x=e.x-n.x,this.y=e.y-n.y,this}multiply(e){return this.x*=e.x,this.y*=e.y,this}multiplyScalar(e){return this.x*=e,this.y*=e,this}divide(e){return this.x/=e.x,this.y/=e.y,this}divideScalar(e){return this.multiplyScalar(1/e)}applyMatrix3(e){const n=this.x,i=this.y,s=e.elements;return this.x=s[0]*n+s[3]*i+s[6],this.y=s[1]*n+s[4]*i+s[7],this}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this}clamp(e,n){return this.x=Math.max(e.x,Math.min(n.x,this.x)),this.y=Math.max(e.y,Math.min(n.y,this.y)),this}clampScalar(e,n){return this.x=Math.max(e,Math.min(n,this.x)),this.y=Math.max(e,Math.min(n,this.y)),this}clampLength(e,n){const i=this.length();return this.divideScalar(i||1).multiplyScalar(Math.max(e,Math.min(n,i)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this}negate(){return this.x=-this.x,this.y=-this.y,this}dot(e){return this.x*e.x+this.y*e.y}cross(e){return this.x*e.y-this.y*e.x}lengthSq(){return this.x*this.x+this.y*this.y}length(){return Math.sqrt(this.x*this.x+this.y*this.y)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)}normalize(){return this.divideScalar(this.length()||1)}angle(){return Math.atan2(-this.y,-this.x)+Math.PI}angleTo(e){const n=Math.sqrt(this.lengthSq()*e.lengthSq());if(n===0)return Math.PI/2;const i=this.dot(e)/n;return Math.acos(Li(i,-1,1))}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){const n=this.x-e.x,i=this.y-e.y;return n*n+i*i}manhattanDistanceTo(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,n){return this.x+=(e.x-this.x)*n,this.y+=(e.y-this.y)*n,this}lerpVectors(e,n,i){return this.x=e.x+(n.x-e.x)*i,this.y=e.y+(n.y-e.y)*i,this}equals(e){return e.x===this.x&&e.y===this.y}fromArray(e,n=0){return this.x=e[n],this.y=e[n+1],this}toArray(e=[],n=0){return e[n]=this.x,e[n+1]=this.y,e}fromBufferAttribute(e,n){return this.x=e.getX(n),this.y=e.getY(n),this}rotateAround(e,n){const i=Math.cos(n),s=Math.sin(n),o=this.x-e.x,a=this.y-e.y;return this.x=o*i-a*s+e.x,this.y=o*s+a*i+e.y,this}random(){return this.x=Math.random(),this.y=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y}},zh=class NK{constructor(e,n,i,s,o,a,l,c,u){NK.prototype.isMatrix3=!0,this.elements=[1,0,0,0,1,0,0,0,1],e!==void 0&&this.set(e,n,i,s,o,a,l,c,u)}set(e,n,i,s,o,a,l,c,u){const h=this.elements;return h[0]=e,h[1]=s,h[2]=l,h[3]=n,h[4]=o,h[5]=c,h[6]=i,h[7]=a,h[8]=u,this}identity(){return this.set(1,0,0,0,1,0,0,0,1),this}copy(e){const n=this.elements,i=e.elements;return n[0]=i[0],n[1]=i[1],n[2]=i[2],n[3]=i[3],n[4]=i[4],n[5]=i[5],n[6]=i[6],n[7]=i[7],n[8]=i[8],this}extractBasis(e,n,i){return e.setFromMatrix3Column(this,0),n.setFromMatrix3Column(this,1),i.setFromMatrix3Column(this,2),this}setFromMatrix4(e){const n=e.elements;return this.set(n[0],n[4],n[8],n[1],n[5],n[9],n[2],n[6],n[10]),this}multiply(e){return this.multiplyMatrices(this,e)}premultiply(e){return this.multiplyMatrices(e,this)}multiplyMatrices(e,n){const i=e.elements,s=n.elements,o=this.elements,a=i[0],l=i[3],c=i[6],u=i[1],h=i[4],f=i[7],d=i[2],p=i[5],m=i[8],g=s[0],v=s[3],y=s[6],x=s[1],b=s[4],w=s[7],_=s[2],S=s[5],T=s[8];return o[0]=a*g+l*x+c*_,o[3]=a*v+l*b+c*S,o[6]=a*y+l*w+c*T,o[1]=u*g+h*x+f*_,o[4]=u*v+h*b+f*S,o[7]=u*y+h*w+f*T,o[2]=d*g+p*x+m*_,o[5]=d*v+p*b+m*S,o[8]=d*y+p*w+m*T,this}multiplyScalar(e){const n=this.elements;return n[0]*=e,n[3]*=e,n[6]*=e,n[1]*=e,n[4]*=e,n[7]*=e,n[2]*=e,n[5]*=e,n[8]*=e,this}determinant(){const e=this.elements,n=e[0],i=e[1],s=e[2],o=e[3],a=e[4],l=e[5],c=e[6],u=e[7],h=e[8];return n*a*h-n*l*u-i*o*h+i*l*c+s*o*u-s*a*c}invert(){const e=this.elements,n=e[0],i=e[1],s=e[2],o=e[3],a=e[4],l=e[5],c=e[6],u=e[7],h=e[8],f=h*a-l*u,d=l*c-h*o,p=u*o-a*c,m=n*f+i*d+s*p;if(m===0)return this.set(0,0,0,0,0,0,0,0,0);const g=1/m;return e[0]=f*g,e[1]=(s*u-h*i)*g,e[2]=(l*i-s*a)*g,e[3]=d*g,e[4]=(h*n-s*c)*g,e[5]=(s*o-l*n)*g,e[6]=p*g,e[7]=(i*c-u*n)*g,e[8]=(a*n-i*o)*g,this}transpose(){let e;const n=this.elements;return e=n[1],n[1]=n[3],n[3]=e,e=n[2],n[2]=n[6],n[6]=e,e=n[5],n[5]=n[7],n[7]=e,this}getNormalMatrix(e){return this.setFromMatrix4(e).invert().transpose()}transposeIntoArray(e){const n=this.elements;return e[0]=n[0],e[1]=n[3],e[2]=n[6],e[3]=n[1],e[4]=n[4],e[5]=n[7],e[6]=n[2],e[7]=n[5],e[8]=n[8],this}setUvTransform(e,n,i,s,o,a,l){const c=Math.cos(o),u=Math.sin(o);return this.set(i*c,i*u,-i*(c*a+u*l)+a+e,-s*u,s*c,-s*(-u*a+c*l)+l+n,0,0,1),this}scale(e,n){return this.premultiply(bP.makeScale(e,n)),this}rotate(e){return this.premultiply(bP.makeRotation(-e)),this}translate(e,n){return this.premultiply(bP.makeTranslation(e,n)),this}makeTranslation(e,n){return e.isVector2?this.set(1,0,e.x,0,1,e.y,0,0,1):this.set(1,0,e,0,1,n,0,0,1),this}makeRotation(e){const n=Math.cos(e),i=Math.sin(e);return this.set(n,-i,0,i,n,0,0,0,1),this}makeScale(e,n){return this.set(e,0,0,0,n,0,0,0,1),this}equals(e){const n=this.elements,i=e.elements;for(let s=0;s<9;s++)if(n[s]!==i[s])return!1;return!0}fromArray(e,n=0){for(let i=0;i<9;i++)this.elements[i]=e[i+n];return this}toArray(e=[],n=0){const i=this.elements;return e[n]=i[0],e[n+1]=i[1],e[n+2]=i[2],e[n+3]=i[3],e[n+4]=i[4],e[n+5]=i[5],e[n+6]=i[6],e[n+7]=i[7],e[n+8]=i[8],e}clone(){return new this.constructor().fromArray(this.elements)}};const bP=new zh;function wme(r){for(let e=r.length-1;e>=0;--e)if(r[e]>=65535)return!0;return!1}function kO(r){return document.createElementNS("http://www.w3.org/1999/xhtml",r)}const Sj={};function Sme(r){r in Sj||(Sj[r]=!0,console.warn(r))}const Tj=new zh().set(.8224621,.177538,0,.0331941,.9668058,0,.0170827,.0723974,.9105199),Ej=new zh().set(1.2249401,-.2249404,0,-.0420569,1.0420571,0,-.0196376,-.0786361,1.0982735),xw={[YL]:{transfer:OO,primaries:vj,toReference:r=>r,fromReference:r=>r},[Ss]:{transfer:yj,primaries:vj,toReference:r=>r.convertSRGBToLinear(),fromReference:r=>r.convertLinearToSRGB()},[PK]:{transfer:OO,primaries:xj,toReference:r=>r.applyMatrix3(Ej),fromReference:r=>r.applyMatrix3(Tj)},[ime]:{transfer:yj,primaries:xj,toReference:r=>r.convertSRGBToLinear().applyMatrix3(Ej),fromReference:r=>r.applyMatrix3(Tj).convertLinearToSRGB()}},Tme=new Set([YL,PK]),xa={enabled:!0,_workingColorSpace:YL,get workingColorSpace(){return this._workingColorSpace},set workingColorSpace(r){if(!Tme.has(r))throw new Error(`Unsupported working color space, "${r}".`);this._workingColorSpace=r},convert:function(r,e,n){if(this.enabled===!1||e===n||!e||!n)return r;const i=xw[e].toReference,s=xw[n].fromReference;return s(i(r))},fromWorkingColorSpace:function(r,e){return this.convert(r,this._workingColorSpace,e)},toWorkingColorSpace:function(r,e){return this.convert(r,e,this._workingColorSpace)},getPrimaries:function(r){return xw[r].primaries},getTransfer:function(r){return r===CK?OO:xw[r].transfer}};function Mm(r){return r<.04045?r*.0773993808:Math.pow(r*.9478672986+.0521327014,2.4)}function _P(r){return r<.0031308?r*12.92:1.055*Math.pow(r,.41666)-.055}let qd,Eme=class{static getDataURL(e){if(/^data:/i.test(e.src)||typeof HTMLCanvasElement>"u")return e.src;let n;if(e instanceof HTMLCanvasElement)n=e;else{qd===void 0&&(qd=kO("canvas")),qd.width=e.width,qd.height=e.height;const i=qd.getContext("2d");e instanceof ImageData?i.putImageData(e,0,0):i.drawImage(e,0,0,e.width,e.height),n=qd}return n.width>2048||n.height>2048?(console.warn("THREE.ImageUtils.getDataURL: Image converted to jpg for performance reasons",e),n.toDataURL("image/jpeg",.6)):n.toDataURL("image/png")}static sRGBToLinear(e){if(typeof HTMLImageElement<"u"&&e instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&e instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&e instanceof ImageBitmap){const n=kO("canvas");n.width=e.width,n.height=e.height;const i=n.getContext("2d");i.drawImage(e,0,0,e.width,e.height);const s=i.getImageData(0,0,e.width,e.height),o=s.data;for(let a=0;a<o.length;a++)o[a]=Mm(o[a]/255)*255;return i.putImageData(s,0,0),n}else if(e.data){const n=e.data.slice(0);for(let i=0;i<n.length;i++)n instanceof Uint8Array||n instanceof Uint8ClampedArray?n[i]=Math.floor(Mm(n[i]/255)*255):n[i]=Mm(n[i]);return{data:n,width:e.width,height:e.height}}else return console.warn("THREE.ImageUtils.sRGBToLinear(): Unsupported image type. No color space conversion applied."),e}},Mme=0,Ame=class{constructor(e=null){this.isSource=!0,Object.defineProperty(this,"id",{value:Mme++}),this.uuid=Uh(),this.data=e,this.dataReady=!0,this.version=0}set needsUpdate(e){e===!0&&this.version++}toJSON(e){const n=e===void 0||typeof e=="string";if(!n&&e.images[this.uuid]!==void 0)return e.images[this.uuid];const i={uuid:this.uuid,url:""},s=this.data;if(s!==null){let o;if(Array.isArray(s)){o=[];for(let a=0,l=s.length;a<l;a++)s[a].isDataTexture?o.push(wP(s[a].image)):o.push(wP(s[a]))}else o=wP(s);i.url=o}return n||(e.images[this.uuid]=i),i}};function wP(r){return typeof HTMLImageElement<"u"&&r instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&r instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&r instanceof ImageBitmap?Eme.getDataURL(r):r.data?{data:Array.from(r.data),width:r.width,height:r.height,type:r.data.constructor.name}:(console.warn("THREE.Texture: Unable to serialize Texture."),{})}let Cme=0,Gc=class C1 extends BM{constructor(e=C1.DEFAULT_IMAGE,n=C1.DEFAULT_MAPPING,i=Sl,s=Sl,o=A1,a=KL,l=MK,c=eme,u=C1.DEFAULT_ANISOTROPY,h=CK){super(),this.isTexture=!0,Object.defineProperty(this,"id",{value:Cme++}),this.uuid=Uh(),this.name="",this.source=new Ame(e),this.mipmaps=[],this.mapping=n,this.channel=0,this.wrapS=i,this.wrapT=s,this.magFilter=o,this.minFilter=a,this.anisotropy=u,this.format=l,this.internalFormat=null,this.type=c,this.offset=new Er(0,0),this.repeat=new Er(1,1),this.center=new Er(0,0),this.rotation=0,this.matrixAutoUpdate=!0,this.matrix=new zh,this.generateMipmaps=!0,this.premultiplyAlpha=!1,this.flipY=!0,this.unpackAlignment=4,this.colorSpace=h,this.userData={},this.version=0,this.onUpdate=null,this.isRenderTargetTexture=!1,this.pmremVersion=0}get image(){return this.source.data}set image(e=null){this.source.data=e}updateMatrix(){this.matrix.setUvTransform(this.offset.x,this.offset.y,this.repeat.x,this.repeat.y,this.rotation,this.center.x,this.center.y)}clone(){return new this.constructor().copy(this)}copy(e){return this.name=e.name,this.source=e.source,this.mipmaps=e.mipmaps.slice(0),this.mapping=e.mapping,this.channel=e.channel,this.wrapS=e.wrapS,this.wrapT=e.wrapT,this.magFilter=e.magFilter,this.minFilter=e.minFilter,this.anisotropy=e.anisotropy,this.format=e.format,this.internalFormat=e.internalFormat,this.type=e.type,this.offset.copy(e.offset),this.repeat.copy(e.repeat),this.center.copy(e.center),this.rotation=e.rotation,this.matrixAutoUpdate=e.matrixAutoUpdate,this.matrix.copy(e.matrix),this.generateMipmaps=e.generateMipmaps,this.premultiplyAlpha=e.premultiplyAlpha,this.flipY=e.flipY,this.unpackAlignment=e.unpackAlignment,this.colorSpace=e.colorSpace,this.userData=JSON.parse(JSON.stringify(e.userData)),this.needsUpdate=!0,this}toJSON(e){const n=e===void 0||typeof e=="string";if(!n&&e.textures[this.uuid]!==void 0)return e.textures[this.uuid];const i={metadata:{version:4.6,type:"Texture",generator:"Texture.toJSON"},uuid:this.uuid,name:this.name,image:this.source.toJSON(e).uuid,mapping:this.mapping,channel:this.channel,repeat:[this.repeat.x,this.repeat.y],offset:[this.offset.x,this.offset.y],center:[this.center.x,this.center.y],rotation:this.rotation,wrap:[this.wrapS,this.wrapT],format:this.format,internalFormat:this.internalFormat,type:this.type,colorSpace:this.colorSpace,minFilter:this.minFilter,magFilter:this.magFilter,anisotropy:this.anisotropy,flipY:this.flipY,generateMipmaps:this.generateMipmaps,premultiplyAlpha:this.premultiplyAlpha,unpackAlignment:this.unpackAlignment};return Object.keys(this.userData).length>0&&(i.userData=this.userData),n||(e.textures[this.uuid]=i),i}dispose(){this.dispatchEvent({type:"dispose"})}transformUv(e){if(this.mapping!==TK)return e;if(e.applyMatrix3(this.matrix),e.x<0||e.x>1)switch(this.wrapS){case oh:e.x=e.x-Math.floor(e.x);break;case Sl:e.x=e.x<0?0:1;break;case fj:Math.abs(Math.floor(e.x)%2)===1?e.x=Math.ceil(e.x)-e.x:e.x=e.x-Math.floor(e.x);break}if(e.y<0||e.y>1)switch(this.wrapT){case oh:e.y=e.y-Math.floor(e.y);break;case Sl:e.y=e.y<0?0:1;break;case fj:Math.abs(Math.floor(e.y)%2)===1?e.y=Math.ceil(e.y)-e.y:e.y=e.y-Math.floor(e.y);break}return this.flipY&&(e.y=1-e.y),e}set needsUpdate(e){e===!0&&(this.version++,this.source.needsUpdate=!0)}set needsPMREMUpdate(e){e===!0&&this.pmremVersion++}};Gc.DEFAULT_IMAGE=null;Gc.DEFAULT_MAPPING=TK;Gc.DEFAULT_ANISOTROPY=1;let Hs=class OK{constructor(e=0,n=0,i=0,s=1){OK.prototype.isVector4=!0,this.x=e,this.y=n,this.z=i,this.w=s}get width(){return this.z}set width(e){this.z=e}get height(){return this.w}set height(e){this.w=e}set(e,n,i,s){return this.x=e,this.y=n,this.z=i,this.w=s,this}setScalar(e){return this.x=e,this.y=e,this.z=e,this.w=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setZ(e){return this.z=e,this}setW(e){return this.w=e,this}setComponent(e,n){switch(e){case 0:this.x=n;break;case 1:this.y=n;break;case 2:this.z=n;break;case 3:this.w=n;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y,this.z,this.w)}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this.w=e.w!==void 0?e.w:1,this}add(e){return this.x+=e.x,this.y+=e.y,this.z+=e.z,this.w+=e.w,this}addScalar(e){return this.x+=e,this.y+=e,this.z+=e,this.w+=e,this}addVectors(e,n){return this.x=e.x+n.x,this.y=e.y+n.y,this.z=e.z+n.z,this.w=e.w+n.w,this}addScaledVector(e,n){return this.x+=e.x*n,this.y+=e.y*n,this.z+=e.z*n,this.w+=e.w*n,this}sub(e){return this.x-=e.x,this.y-=e.y,this.z-=e.z,this.w-=e.w,this}subScalar(e){return this.x-=e,this.y-=e,this.z-=e,this.w-=e,this}subVectors(e,n){return this.x=e.x-n.x,this.y=e.y-n.y,this.z=e.z-n.z,this.w=e.w-n.w,this}multiply(e){return this.x*=e.x,this.y*=e.y,this.z*=e.z,this.w*=e.w,this}multiplyScalar(e){return this.x*=e,this.y*=e,this.z*=e,this.w*=e,this}applyMatrix4(e){const n=this.x,i=this.y,s=this.z,o=this.w,a=e.elements;return this.x=a[0]*n+a[4]*i+a[8]*s+a[12]*o,this.y=a[1]*n+a[5]*i+a[9]*s+a[13]*o,this.z=a[2]*n+a[6]*i+a[10]*s+a[14]*o,this.w=a[3]*n+a[7]*i+a[11]*s+a[15]*o,this}divideScalar(e){return this.multiplyScalar(1/e)}setAxisAngleFromQuaternion(e){this.w=2*Math.acos(e.w);const n=Math.sqrt(1-e.w*e.w);return n<1e-4?(this.x=1,this.y=0,this.z=0):(this.x=e.x/n,this.y=e.y/n,this.z=e.z/n),this}setAxisAngleFromRotationMatrix(e){let n,i,s,o;const c=e.elements,u=c[0],h=c[4],f=c[8],d=c[1],p=c[5],m=c[9],g=c[2],v=c[6],y=c[10];if(Math.abs(h-d)<.01&&Math.abs(f-g)<.01&&Math.abs(m-v)<.01){if(Math.abs(h+d)<.1&&Math.abs(f+g)<.1&&Math.abs(m+v)<.1&&Math.abs(u+p+y-3)<.1)return this.set(1,0,0,0),this;n=Math.PI;const b=(u+1)/2,w=(p+1)/2,_=(y+1)/2,S=(h+d)/4,T=(f+g)/4,E=(m+v)/4;return b>w&&b>_?b<.01?(i=0,s=.707106781,o=.707106781):(i=Math.sqrt(b),s=S/i,o=T/i):w>_?w<.01?(i=.707106781,s=0,o=.707106781):(s=Math.sqrt(w),i=S/s,o=E/s):_<.01?(i=.707106781,s=.707106781,o=0):(o=Math.sqrt(_),i=T/o,s=E/o),this.set(i,s,o,n),this}let x=Math.sqrt((v-m)*(v-m)+(f-g)*(f-g)+(d-h)*(d-h));return Math.abs(x)<.001&&(x=1),this.x=(v-m)/x,this.y=(f-g)/x,this.z=(d-h)/x,this.w=Math.acos((u+p+y-1)/2),this}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this.w=Math.min(this.w,e.w),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this.w=Math.max(this.w,e.w),this}clamp(e,n){return this.x=Math.max(e.x,Math.min(n.x,this.x)),this.y=Math.max(e.y,Math.min(n.y,this.y)),this.z=Math.max(e.z,Math.min(n.z,this.z)),this.w=Math.max(e.w,Math.min(n.w,this.w)),this}clampScalar(e,n){return this.x=Math.max(e,Math.min(n,this.x)),this.y=Math.max(e,Math.min(n,this.y)),this.z=Math.max(e,Math.min(n,this.z)),this.w=Math.max(e,Math.min(n,this.w)),this}clampLength(e,n){const i=this.length();return this.divideScalar(i||1).multiplyScalar(Math.max(e,Math.min(n,i)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this.w=Math.floor(this.w),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this.w=Math.ceil(this.w),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this.w=Math.round(this.w),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this.z=Math.trunc(this.z),this.w=Math.trunc(this.w),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z+this.w*e.w}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)}normalize(){return this.divideScalar(this.length()||1)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,n){return this.x+=(e.x-this.x)*n,this.y+=(e.y-this.y)*n,this.z+=(e.z-this.z)*n,this.w+=(e.w-this.w)*n,this}lerpVectors(e,n,i){return this.x=e.x+(n.x-e.x)*i,this.y=e.y+(n.y-e.y)*i,this.z=e.z+(n.z-e.z)*i,this.w=e.w+(n.w-e.w)*i,this}equals(e){return e.x===this.x&&e.y===this.y&&e.z===this.z&&e.w===this.w}fromArray(e,n=0){return this.x=e[n],this.y=e[n+1],this.z=e[n+2],this.w=e[n+3],this}toArray(e=[],n=0){return e[n]=this.x,e[n+1]=this.y,e[n+2]=this.z,e[n+3]=this.w,e}fromBufferAttribute(e,n){return this.x=e.getX(n),this.y=e.getY(n),this.z=e.getZ(n),this.w=e.getW(n),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this.w=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z,yield this.w}},ws=class{constructor(e=0,n=0,i=0,s=1){this.isQuaternion=!0,this._x=e,this._y=n,this._z=i,this._w=s}static slerpFlat(e,n,i,s,o,a,l){let c=i[s+0],u=i[s+1],h=i[s+2],f=i[s+3];const d=o[a+0],p=o[a+1],m=o[a+2],g=o[a+3];if(l===0){e[n+0]=c,e[n+1]=u,e[n+2]=h,e[n+3]=f;return}if(l===1){e[n+0]=d,e[n+1]=p,e[n+2]=m,e[n+3]=g;return}if(f!==g||c!==d||u!==p||h!==m){let v=1-l;const y=c*d+u*p+h*m+f*g,x=y>=0?1:-1,b=1-y*y;if(b>Number.EPSILON){const _=Math.sqrt(b),S=Math.atan2(_,y*x);v=Math.sin(v*S)/_,l=Math.sin(l*S)/_}const w=l*x;if(c=c*v+d*w,u=u*v+p*w,h=h*v+m*w,f=f*v+g*w,v===1-l){const _=1/Math.sqrt(c*c+u*u+h*h+f*f);c*=_,u*=_,h*=_,f*=_}}e[n]=c,e[n+1]=u,e[n+2]=h,e[n+3]=f}static multiplyQuaternionsFlat(e,n,i,s,o,a){const l=i[s],c=i[s+1],u=i[s+2],h=i[s+3],f=o[a],d=o[a+1],p=o[a+2],m=o[a+3];return e[n]=l*m+h*f+c*p-u*d,e[n+1]=c*m+h*d+u*f-l*p,e[n+2]=u*m+h*p+l*d-c*f,e[n+3]=h*m-l*f-c*d-u*p,e}get x(){return this._x}set x(e){this._x=e,this._onChangeCallback()}get y(){return this._y}set y(e){this._y=e,this._onChangeCallback()}get z(){return this._z}set z(e){this._z=e,this._onChangeCallback()}get w(){return this._w}set w(e){this._w=e,this._onChangeCallback()}set(e,n,i,s){return this._x=e,this._y=n,this._z=i,this._w=s,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._w)}copy(e){return this._x=e.x,this._y=e.y,this._z=e.z,this._w=e.w,this._onChangeCallback(),this}setFromEuler(e,n=!0){const i=e._x,s=e._y,o=e._z,a=e._order,l=Math.cos,c=Math.sin,u=l(i/2),h=l(s/2),f=l(o/2),d=c(i/2),p=c(s/2),m=c(o/2);switch(a){case"XYZ":this._x=d*h*f+u*p*m,this._y=u*p*f-d*h*m,this._z=u*h*m+d*p*f,this._w=u*h*f-d*p*m;break;case"YXZ":this._x=d*h*f+u*p*m,this._y=u*p*f-d*h*m,this._z=u*h*m-d*p*f,this._w=u*h*f+d*p*m;break;case"ZXY":this._x=d*h*f-u*p*m,this._y=u*p*f+d*h*m,this._z=u*h*m+d*p*f,this._w=u*h*f-d*p*m;break;case"ZYX":this._x=d*h*f-u*p*m,this._y=u*p*f+d*h*m,this._z=u*h*m-d*p*f,this._w=u*h*f+d*p*m;break;case"YZX":this._x=d*h*f+u*p*m,this._y=u*p*f+d*h*m,this._z=u*h*m-d*p*f,this._w=u*h*f-d*p*m;break;case"XZY":this._x=d*h*f-u*p*m,this._y=u*p*f-d*h*m,this._z=u*h*m+d*p*f,this._w=u*h*f+d*p*m;break;default:console.warn("THREE.Quaternion: .setFromEuler() encountered an unknown order: "+a)}return n===!0&&this._onChangeCallback(),this}setFromAxisAngle(e,n){const i=n/2,s=Math.sin(i);return this._x=e.x*s,this._y=e.y*s,this._z=e.z*s,this._w=Math.cos(i),this._onChangeCallback(),this}setFromRotationMatrix(e){const n=e.elements,i=n[0],s=n[4],o=n[8],a=n[1],l=n[5],c=n[9],u=n[2],h=n[6],f=n[10],d=i+l+f;if(d>0){const p=.5/Math.sqrt(d+1);this._w=.25/p,this._x=(h-c)*p,this._y=(o-u)*p,this._z=(a-s)*p}else if(i>l&&i>f){const p=2*Math.sqrt(1+i-l-f);this._w=(h-c)/p,this._x=.25*p,this._y=(s+a)/p,this._z=(o+u)/p}else if(l>f){const p=2*Math.sqrt(1+l-i-f);this._w=(o-u)/p,this._x=(s+a)/p,this._y=.25*p,this._z=(c+h)/p}else{const p=2*Math.sqrt(1+f-i-l);this._w=(a-s)/p,this._x=(o+u)/p,this._y=(c+h)/p,this._z=.25*p}return this._onChangeCallback(),this}setFromUnitVectors(e,n){let i=e.dot(n)+1;return i<Number.EPSILON?(i=0,Math.abs(e.x)>Math.abs(e.z)?(this._x=-e.y,this._y=e.x,this._z=0,this._w=i):(this._x=0,this._y=-e.z,this._z=e.y,this._w=i)):(this._x=e.y*n.z-e.z*n.y,this._y=e.z*n.x-e.x*n.z,this._z=e.x*n.y-e.y*n.x,this._w=i),this.normalize()}angleTo(e){return 2*Math.acos(Math.abs(Li(this.dot(e),-1,1)))}rotateTowards(e,n){const i=this.angleTo(e);if(i===0)return this;const s=Math.min(1,n/i);return this.slerp(e,s),this}identity(){return this.set(0,0,0,1)}invert(){return this.conjugate()}conjugate(){return this._x*=-1,this._y*=-1,this._z*=-1,this._onChangeCallback(),this}dot(e){return this._x*e._x+this._y*e._y+this._z*e._z+this._w*e._w}lengthSq(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w}length(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)}normalize(){let e=this.length();return e===0?(this._x=0,this._y=0,this._z=0,this._w=1):(e=1/e,this._x=this._x*e,this._y=this._y*e,this._z=this._z*e,this._w=this._w*e),this._onChangeCallback(),this}multiply(e){return this.multiplyQuaternions(this,e)}premultiply(e){return this.multiplyQuaternions(e,this)}multiplyQuaternions(e,n){const i=e._x,s=e._y,o=e._z,a=e._w,l=n._x,c=n._y,u=n._z,h=n._w;return this._x=i*h+a*l+s*u-o*c,this._y=s*h+a*c+o*l-i*u,this._z=o*h+a*u+i*c-s*l,this._w=a*h-i*l-s*c-o*u,this._onChangeCallback(),this}slerp(e,n){if(n===0)return this;if(n===1)return this.copy(e);const i=this._x,s=this._y,o=this._z,a=this._w;let l=a*e._w+i*e._x+s*e._y+o*e._z;if(l<0?(this._w=-e._w,this._x=-e._x,this._y=-e._y,this._z=-e._z,l=-l):this.copy(e),l>=1)return this._w=a,this._x=i,this._y=s,this._z=o,this;const c=1-l*l;if(c<=Number.EPSILON){const p=1-n;return this._w=p*a+n*this._w,this._x=p*i+n*this._x,this._y=p*s+n*this._y,this._z=p*o+n*this._z,this.normalize(),this}const u=Math.sqrt(c),h=Math.atan2(u,l),f=Math.sin((1-n)*h)/u,d=Math.sin(n*h)/u;return this._w=a*f+this._w*d,this._x=i*f+this._x*d,this._y=s*f+this._y*d,this._z=o*f+this._z*d,this._onChangeCallback(),this}slerpQuaternions(e,n,i){return this.copy(e).slerp(n,i)}random(){const e=2*Math.PI*Math.random(),n=2*Math.PI*Math.random(),i=Math.random(),s=Math.sqrt(1-i),o=Math.sqrt(i);return this.set(s*Math.sin(e),s*Math.cos(e),o*Math.sin(n),o*Math.cos(n))}equals(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._w===this._w}fromArray(e,n=0){return this._x=e[n],this._y=e[n+1],this._z=e[n+2],this._w=e[n+3],this._onChangeCallback(),this}toArray(e=[],n=0){return e[n]=this._x,e[n+1]=this._y,e[n+2]=this._z,e[n+3]=this._w,e}fromBufferAttribute(e,n){return this._x=e.getX(n),this._y=e.getY(n),this._z=e.getZ(n),this._w=e.getW(n),this._onChangeCallback(),this}toJSON(){return this.toArray()}_onChange(e){return this._onChangeCallback=e,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._w}},me=class DK{constructor(e=0,n=0,i=0){DK.prototype.isVector3=!0,this.x=e,this.y=n,this.z=i}set(e,n,i){return i===void 0&&(i=this.z),this.x=e,this.y=n,this.z=i,this}setScalar(e){return this.x=e,this.y=e,this.z=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setZ(e){return this.z=e,this}setComponent(e,n){switch(e){case 0:this.x=n;break;case 1:this.y=n;break;case 2:this.z=n;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y,this.z)}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this}add(e){return this.x+=e.x,this.y+=e.y,this.z+=e.z,this}addScalar(e){return this.x+=e,this.y+=e,this.z+=e,this}addVectors(e,n){return this.x=e.x+n.x,this.y=e.y+n.y,this.z=e.z+n.z,this}addScaledVector(e,n){return this.x+=e.x*n,this.y+=e.y*n,this.z+=e.z*n,this}sub(e){return this.x-=e.x,this.y-=e.y,this.z-=e.z,this}subScalar(e){return this.x-=e,this.y-=e,this.z-=e,this}subVectors(e,n){return this.x=e.x-n.x,this.y=e.y-n.y,this.z=e.z-n.z,this}multiply(e){return this.x*=e.x,this.y*=e.y,this.z*=e.z,this}multiplyScalar(e){return this.x*=e,this.y*=e,this.z*=e,this}multiplyVectors(e,n){return this.x=e.x*n.x,this.y=e.y*n.y,this.z=e.z*n.z,this}applyEuler(e){return this.applyQuaternion(Mj.setFromEuler(e))}applyAxisAngle(e,n){return this.applyQuaternion(Mj.setFromAxisAngle(e,n))}applyMatrix3(e){const n=this.x,i=this.y,s=this.z,o=e.elements;return this.x=o[0]*n+o[3]*i+o[6]*s,this.y=o[1]*n+o[4]*i+o[7]*s,this.z=o[2]*n+o[5]*i+o[8]*s,this}applyNormalMatrix(e){return this.applyMatrix3(e).normalize()}applyMatrix4(e){const n=this.x,i=this.y,s=this.z,o=e.elements,a=1/(o[3]*n+o[7]*i+o[11]*s+o[15]);return this.x=(o[0]*n+o[4]*i+o[8]*s+o[12])*a,this.y=(o[1]*n+o[5]*i+o[9]*s+o[13])*a,this.z=(o[2]*n+o[6]*i+o[10]*s+o[14])*a,this}applyQuaternion(e){const n=this.x,i=this.y,s=this.z,o=e.x,a=e.y,l=e.z,c=e.w,u=2*(a*s-l*i),h=2*(l*n-o*s),f=2*(o*i-a*n);return this.x=n+c*u+a*f-l*h,this.y=i+c*h+l*u-o*f,this.z=s+c*f+o*h-a*u,this}project(e){return this.applyMatrix4(e.matrixWorldInverse).applyMatrix4(e.projectionMatrix)}unproject(e){return this.applyMatrix4(e.projectionMatrixInverse).applyMatrix4(e.matrixWorld)}transformDirection(e){const n=this.x,i=this.y,s=this.z,o=e.elements;return this.x=o[0]*n+o[4]*i+o[8]*s,this.y=o[1]*n+o[5]*i+o[9]*s,this.z=o[2]*n+o[6]*i+o[10]*s,this.normalize()}divide(e){return this.x/=e.x,this.y/=e.y,this.z/=e.z,this}divideScalar(e){return this.multiplyScalar(1/e)}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this}clamp(e,n){return this.x=Math.max(e.x,Math.min(n.x,this.x)),this.y=Math.max(e.y,Math.min(n.y,this.y)),this.z=Math.max(e.z,Math.min(n.z,this.z)),this}clampScalar(e,n){return this.x=Math.max(e,Math.min(n,this.x)),this.y=Math.max(e,Math.min(n,this.y)),this.z=Math.max(e,Math.min(n,this.z)),this}clampLength(e,n){const i=this.length();return this.divideScalar(i||1).multiplyScalar(Math.max(e,Math.min(n,i)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this.z=Math.trunc(this.z),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)}normalize(){return this.divideScalar(this.length()||1)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,n){return this.x+=(e.x-this.x)*n,this.y+=(e.y-this.y)*n,this.z+=(e.z-this.z)*n,this}lerpVectors(e,n,i){return this.x=e.x+(n.x-e.x)*i,this.y=e.y+(n.y-e.y)*i,this.z=e.z+(n.z-e.z)*i,this}cross(e){return this.crossVectors(this,e)}crossVectors(e,n){const i=e.x,s=e.y,o=e.z,a=n.x,l=n.y,c=n.z;return this.x=s*c-o*l,this.y=o*a-i*c,this.z=i*l-s*a,this}projectOnVector(e){const n=e.lengthSq();if(n===0)return this.set(0,0,0);const i=e.dot(this)/n;return this.copy(e).multiplyScalar(i)}projectOnPlane(e){return SP.copy(this).projectOnVector(e),this.sub(SP)}reflect(e){return this.sub(SP.copy(e).multiplyScalar(2*this.dot(e)))}angleTo(e){const n=Math.sqrt(this.lengthSq()*e.lengthSq());if(n===0)return Math.PI/2;const i=this.dot(e)/n;return Math.acos(Li(i,-1,1))}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){const n=this.x-e.x,i=this.y-e.y,s=this.z-e.z;return n*n+i*i+s*s}manhattanDistanceTo(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)+Math.abs(this.z-e.z)}setFromSpherical(e){return this.setFromSphericalCoords(e.radius,e.phi,e.theta)}setFromSphericalCoords(e,n,i){const s=Math.sin(n)*e;return this.x=s*Math.sin(i),this.y=Math.cos(n)*e,this.z=s*Math.cos(i),this}setFromCylindrical(e){return this.setFromCylindricalCoords(e.radius,e.theta,e.y)}setFromCylindricalCoords(e,n,i){return this.x=e*Math.sin(n),this.y=i,this.z=e*Math.cos(n),this}setFromMatrixPosition(e){const n=e.elements;return this.x=n[12],this.y=n[13],this.z=n[14],this}setFromMatrixScale(e){const n=this.setFromMatrixColumn(e,0).length(),i=this.setFromMatrixColumn(e,1).length(),s=this.setFromMatrixColumn(e,2).length();return this.x=n,this.y=i,this.z=s,this}setFromMatrixColumn(e,n){return this.fromArray(e.elements,n*4)}setFromMatrix3Column(e,n){return this.fromArray(e.elements,n*3)}setFromEuler(e){return this.x=e._x,this.y=e._y,this.z=e._z,this}setFromColor(e){return this.x=e.r,this.y=e.g,this.z=e.b,this}equals(e){return e.x===this.x&&e.y===this.y&&e.z===this.z}fromArray(e,n=0){return this.x=e[n],this.y=e[n+1],this.z=e[n+2],this}toArray(e=[],n=0){return e[n]=this.x,e[n+1]=this.y,e[n+2]=this.z,e}fromBufferAttribute(e,n){return this.x=e.getX(n),this.y=e.getY(n),this.z=e.getZ(n),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this}randomDirection(){const e=Math.random()*Math.PI*2,n=Math.random()*2-1,i=Math.sqrt(1-n*n);return this.x=i*Math.cos(e),this.y=n,this.z=i*Math.sin(e),this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z}};const SP=new me,Mj=new ws;let hy=class{constructor(e=new me(1/0,1/0,1/0),n=new me(-1/0,-1/0,-1/0)){this.isBox3=!0,this.min=e,this.max=n}set(e,n){return this.min.copy(e),this.max.copy(n),this}setFromArray(e){this.makeEmpty();for(let n=0,i=e.length;n<i;n+=3)this.expandByPoint(ba.fromArray(e,n));return this}setFromBufferAttribute(e){this.makeEmpty();for(let n=0,i=e.count;n<i;n++)this.expandByPoint(ba.fromBufferAttribute(e,n));return this}setFromPoints(e){this.makeEmpty();for(let n=0,i=e.length;n<i;n++)this.expandByPoint(e[n]);return this}setFromCenterAndSize(e,n){const i=ba.copy(n).multiplyScalar(.5);return this.min.copy(e).sub(i),this.max.copy(e).add(i),this}setFromObject(e,n=!1){return this.makeEmpty(),this.expandByObject(e,n)}clone(){return new this.constructor().copy(this)}copy(e){return this.min.copy(e.min),this.max.copy(e.max),this}makeEmpty(){return this.min.x=this.min.y=this.min.z=1/0,this.max.x=this.max.y=this.max.z=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z}getCenter(e){return this.isEmpty()?e.set(0,0,0):e.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(e){return this.isEmpty()?e.set(0,0,0):e.subVectors(this.max,this.min)}expandByPoint(e){return this.min.min(e),this.max.max(e),this}expandByVector(e){return this.min.sub(e),this.max.add(e),this}expandByScalar(e){return this.min.addScalar(-e),this.max.addScalar(e),this}expandByObject(e,n=!1){e.updateWorldMatrix(!1,!1);const i=e.geometry;if(i!==void 0){const o=i.getAttribute("position");if(n===!0&&o!==void 0&&e.isInstancedMesh!==!0)for(let a=0,l=o.count;a<l;a++)e.isMesh===!0?e.getVertexPosition(a,ba):ba.fromBufferAttribute(o,a),ba.applyMatrix4(e.matrixWorld),this.expandByPoint(ba);else e.boundingBox!==void 0?(e.boundingBox===null&&e.computeBoundingBox(),bw.copy(e.boundingBox)):(i.boundingBox===null&&i.computeBoundingBox(),bw.copy(i.boundingBox)),bw.applyMatrix4(e.matrixWorld),this.union(bw)}const s=e.children;for(let o=0,a=s.length;o<a;o++)this.expandByObject(s[o],n);return this}containsPoint(e){return!(e.x<this.min.x||e.x>this.max.x||e.y<this.min.y||e.y>this.max.y||e.z<this.min.z||e.z>this.max.z)}containsBox(e){return this.min.x<=e.min.x&&e.max.x<=this.max.x&&this.min.y<=e.min.y&&e.max.y<=this.max.y&&this.min.z<=e.min.z&&e.max.z<=this.max.z}getParameter(e,n){return n.set((e.x-this.min.x)/(this.max.x-this.min.x),(e.y-this.min.y)/(this.max.y-this.min.y),(e.z-this.min.z)/(this.max.z-this.min.z))}intersectsBox(e){return!(e.max.x<this.min.x||e.min.x>this.max.x||e.max.y<this.min.y||e.min.y>this.max.y||e.max.z<this.min.z||e.min.z>this.max.z)}intersectsSphere(e){return this.clampPoint(e.center,ba),ba.distanceToSquared(e.center)<=e.radius*e.radius}intersectsPlane(e){let n,i;return e.normal.x>0?(n=e.normal.x*this.min.x,i=e.normal.x*this.max.x):(n=e.normal.x*this.max.x,i=e.normal.x*this.min.x),e.normal.y>0?(n+=e.normal.y*this.min.y,i+=e.normal.y*this.max.y):(n+=e.normal.y*this.max.y,i+=e.normal.y*this.min.y),e.normal.z>0?(n+=e.normal.z*this.min.z,i+=e.normal.z*this.max.z):(n+=e.normal.z*this.max.z,i+=e.normal.z*this.min.z),n<=-e.constant&&i>=-e.constant}intersectsTriangle(e){if(this.isEmpty())return!1;this.getCenter(tv),_w.subVectors(this.max,tv),Xd.subVectors(e.a,tv),Kd.subVectors(e.b,tv),Yd.subVectors(e.c,tv),Au.subVectors(Kd,Xd),Cu.subVectors(Yd,Kd),tf.subVectors(Xd,Yd);let n=[0,-Au.z,Au.y,0,-Cu.z,Cu.y,0,-tf.z,tf.y,Au.z,0,-Au.x,Cu.z,0,-Cu.x,tf.z,0,-tf.x,-Au.y,Au.x,0,-Cu.y,Cu.x,0,-tf.y,tf.x,0];return!TP(n,Xd,Kd,Yd,_w)||(n=[1,0,0,0,1,0,0,0,1],!TP(n,Xd,Kd,Yd,_w))?!1:(ww.crossVectors(Au,Cu),n=[ww.x,ww.y,ww.z],TP(n,Xd,Kd,Yd,_w))}clampPoint(e,n){return n.copy(e).clamp(this.min,this.max)}distanceToPoint(e){return this.clampPoint(e,ba).distanceTo(e)}getBoundingSphere(e){return this.isEmpty()?e.makeEmpty():(this.getCenter(e.center),e.radius=this.getSize(ba).length()*.5),e}intersect(e){return this.min.max(e.min),this.max.min(e.max),this.isEmpty()&&this.makeEmpty(),this}union(e){return this.min.min(e.min),this.max.max(e.max),this}applyMatrix4(e){return this.isEmpty()?this:(nc[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(e),nc[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(e),nc[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(e),nc[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(e),nc[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(e),nc[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(e),nc[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(e),nc[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(e),this.setFromPoints(nc),this)}translate(e){return this.min.add(e),this.max.add(e),this}equals(e){return e.min.equals(this.min)&&e.max.equals(this.max)}};const nc=[new me,new me,new me,new me,new me,new me,new me,new me],ba=new me,bw=new hy,Xd=new me,Kd=new me,Yd=new me,Au=new me,Cu=new me,tf=new me,tv=new me,_w=new me,ww=new me,nf=new me;function TP(r,e,n,i,s){for(let o=0,a=r.length-3;o<=a;o+=3){nf.fromArray(r,o);const l=s.x*Math.abs(nf.x)+s.y*Math.abs(nf.y)+s.z*Math.abs(nf.z),c=e.dot(nf),u=n.dot(nf),h=i.dot(nf);if(Math.max(-Math.max(c,u,h),Math.min(c,u,h))>l)return!1}return!0}const Pme=new hy,nv=new me,EP=new me;let fy=class{constructor(e=new me,n=-1){this.isSphere=!0,this.center=e,this.radius=n}set(e,n){return this.center.copy(e),this.radius=n,this}setFromPoints(e,n){const i=this.center;n!==void 0?i.copy(n):Pme.setFromPoints(e).getCenter(i);let s=0;for(let o=0,a=e.length;o<a;o++)s=Math.max(s,i.distanceToSquared(e[o]));return this.radius=Math.sqrt(s),this}copy(e){return this.center.copy(e.center),this.radius=e.radius,this}isEmpty(){return this.radius<0}makeEmpty(){return this.center.set(0,0,0),this.radius=-1,this}containsPoint(e){return e.distanceToSquared(this.center)<=this.radius*this.radius}distanceToPoint(e){return e.distanceTo(this.center)-this.radius}intersectsSphere(e){const n=this.radius+e.radius;return e.center.distanceToSquared(this.center)<=n*n}intersectsBox(e){return e.intersectsSphere(this)}intersectsPlane(e){return Math.abs(e.distanceToPoint(this.center))<=this.radius}clampPoint(e,n){const i=this.center.distanceToSquared(e);return n.copy(e),i>this.radius*this.radius&&(n.sub(this.center).normalize(),n.multiplyScalar(this.radius).add(this.center)),n}getBoundingBox(e){return this.isEmpty()?(e.makeEmpty(),e):(e.set(this.center,this.center),e.expandByScalar(this.radius),e)}applyMatrix4(e){return this.center.applyMatrix4(e),this.radius=this.radius*e.getMaxScaleOnAxis(),this}translate(e){return this.center.add(e),this}expandByPoint(e){if(this.isEmpty())return this.center.copy(e),this.radius=0,this;nv.subVectors(e,this.center);const n=nv.lengthSq();if(n>this.radius*this.radius){const i=Math.sqrt(n),s=(i-this.radius)*.5;this.center.addScaledVector(nv,s/i),this.radius+=s}return this}union(e){return e.isEmpty()?this:this.isEmpty()?(this.copy(e),this):(this.center.equals(e.center)===!0?this.radius=Math.max(this.radius,e.radius):(EP.subVectors(e.center,this.center).setLength(e.radius),this.expandByPoint(nv.copy(e.center).add(EP)),this.expandByPoint(nv.copy(e.center).sub(EP))),this)}equals(e){return e.center.equals(this.center)&&e.radius===this.radius}clone(){return new this.constructor().copy(this)}};const rc=new me,MP=new me,Sw=new me,Pu=new me,AP=new me,Tw=new me,CP=new me;let QL=class{constructor(e=new me,n=new me(0,0,-1)){this.origin=e,this.direction=n}set(e,n){return this.origin.copy(e),this.direction.copy(n),this}copy(e){return this.origin.copy(e.origin),this.direction.copy(e.direction),this}at(e,n){return n.copy(this.origin).addScaledVector(this.direction,e)}lookAt(e){return this.direction.copy(e).sub(this.origin).normalize(),this}recast(e){return this.origin.copy(this.at(e,rc)),this}closestPointToPoint(e,n){n.subVectors(e,this.origin);const i=n.dot(this.direction);return i<0?n.copy(this.origin):n.copy(this.origin).addScaledVector(this.direction,i)}distanceToPoint(e){return Math.sqrt(this.distanceSqToPoint(e))}distanceSqToPoint(e){const n=rc.subVectors(e,this.origin).dot(this.direction);return n<0?this.origin.distanceToSquared(e):(rc.copy(this.origin).addScaledVector(this.direction,n),rc.distanceToSquared(e))}distanceSqToSegment(e,n,i,s){MP.copy(e).add(n).multiplyScalar(.5),Sw.copy(n).sub(e).normalize(),Pu.copy(this.origin).sub(MP);const o=e.distanceTo(n)*.5,a=-this.direction.dot(Sw),l=Pu.dot(this.direction),c=-Pu.dot(Sw),u=Pu.lengthSq(),h=Math.abs(1-a*a);let f,d,p,m;if(h>0)if(f=a*c-l,d=a*l-c,m=o*h,f>=0)if(d>=-m)if(d<=m){const g=1/h;f*=g,d*=g,p=f*(f+a*d+2*l)+d*(a*f+d+2*c)+u}else d=o,f=Math.max(0,-(a*d+l)),p=-f*f+d*(d+2*c)+u;else d=-o,f=Math.max(0,-(a*d+l)),p=-f*f+d*(d+2*c)+u;else d<=-m?(f=Math.max(0,-(-a*o+l)),d=f>0?-o:Math.min(Math.max(-o,-c),o),p=-f*f+d*(d+2*c)+u):d<=m?(f=0,d=Math.min(Math.max(-o,-c),o),p=d*(d+2*c)+u):(f=Math.max(0,-(a*o+l)),d=f>0?o:Math.min(Math.max(-o,-c),o),p=-f*f+d*(d+2*c)+u);else d=a>0?-o:o,f=Math.max(0,-(a*d+l)),p=-f*f+d*(d+2*c)+u;return i&&i.copy(this.origin).addScaledVector(this.direction,f),s&&s.copy(MP).addScaledVector(Sw,d),p}intersectSphere(e,n){rc.subVectors(e.center,this.origin);const i=rc.dot(this.direction),s=rc.dot(rc)-i*i,o=e.radius*e.radius;if(s>o)return null;const a=Math.sqrt(o-s),l=i-a,c=i+a;return c<0?null:l<0?this.at(c,n):this.at(l,n)}intersectsSphere(e){return this.distanceSqToPoint(e.center)<=e.radius*e.radius}distanceToPlane(e){const n=e.normal.dot(this.direction);if(n===0)return e.distanceToPoint(this.origin)===0?0:null;const i=-(this.origin.dot(e.normal)+e.constant)/n;return i>=0?i:null}intersectPlane(e,n){const i=this.distanceToPlane(e);return i===null?null:this.at(i,n)}intersectsPlane(e){const n=e.distanceToPoint(this.origin);return n===0||e.normal.dot(this.direction)*n<0}intersectBox(e,n){let i,s,o,a,l,c;const u=1/this.direction.x,h=1/this.direction.y,f=1/this.direction.z,d=this.origin;return u>=0?(i=(e.min.x-d.x)*u,s=(e.max.x-d.x)*u):(i=(e.max.x-d.x)*u,s=(e.min.x-d.x)*u),h>=0?(o=(e.min.y-d.y)*h,a=(e.max.y-d.y)*h):(o=(e.max.y-d.y)*h,a=(e.min.y-d.y)*h),i>a||o>s||((o>i||isNaN(i))&&(i=o),(a<s||isNaN(s))&&(s=a),f>=0?(l=(e.min.z-d.z)*f,c=(e.max.z-d.z)*f):(l=(e.max.z-d.z)*f,c=(e.min.z-d.z)*f),i>c||l>s)||((l>i||i!==i)&&(i=l),(c<s||s!==s)&&(s=c),s<0)?null:this.at(i>=0?i:s,n)}intersectsBox(e){return this.intersectBox(e,rc)!==null}intersectTriangle(e,n,i,s,o){AP.subVectors(n,e),Tw.subVectors(i,e),CP.crossVectors(AP,Tw);let a=this.direction.dot(CP),l;if(a>0){if(s)return null;l=1}else if(a<0)l=-1,a=-a;else return null;Pu.subVectors(this.origin,e);const c=l*this.direction.dot(Tw.crossVectors(Pu,Tw));if(c<0)return null;const u=l*this.direction.dot(AP.cross(Pu));if(u<0||c+u>a)return null;const h=-l*Pu.dot(CP);return h<0?null:this.at(h/a,o)}applyMatrix4(e){return this.origin.applyMatrix4(e),this.direction.transformDirection(e),this}equals(e){return e.origin.equals(this.origin)&&e.direction.equals(this.direction)}clone(){return new this.constructor().copy(this)}},_t=class IO{constructor(e,n,i,s,o,a,l,c,u,h,f,d,p,m,g,v){IO.prototype.isMatrix4=!0,this.elements=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],e!==void 0&&this.set(e,n,i,s,o,a,l,c,u,h,f,d,p,m,g,v)}set(e,n,i,s,o,a,l,c,u,h,f,d,p,m,g,v){const y=this.elements;return y[0]=e,y[4]=n,y[8]=i,y[12]=s,y[1]=o,y[5]=a,y[9]=l,y[13]=c,y[2]=u,y[6]=h,y[10]=f,y[14]=d,y[3]=p,y[7]=m,y[11]=g,y[15]=v,this}identity(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this}clone(){return new IO().fromArray(this.elements)}copy(e){const n=this.elements,i=e.elements;return n[0]=i[0],n[1]=i[1],n[2]=i[2],n[3]=i[3],n[4]=i[4],n[5]=i[5],n[6]=i[6],n[7]=i[7],n[8]=i[8],n[9]=i[9],n[10]=i[10],n[11]=i[11],n[12]=i[12],n[13]=i[13],n[14]=i[14],n[15]=i[15],this}copyPosition(e){const n=this.elements,i=e.elements;return n[12]=i[12],n[13]=i[13],n[14]=i[14],this}setFromMatrix3(e){const n=e.elements;return this.set(n[0],n[3],n[6],0,n[1],n[4],n[7],0,n[2],n[5],n[8],0,0,0,0,1),this}extractBasis(e,n,i){return e.setFromMatrixColumn(this,0),n.setFromMatrixColumn(this,1),i.setFromMatrixColumn(this,2),this}makeBasis(e,n,i){return this.set(e.x,n.x,i.x,0,e.y,n.y,i.y,0,e.z,n.z,i.z,0,0,0,0,1),this}extractRotation(e){const n=this.elements,i=e.elements,s=1/Zd.setFromMatrixColumn(e,0).length(),o=1/Zd.setFromMatrixColumn(e,1).length(),a=1/Zd.setFromMatrixColumn(e,2).length();return n[0]=i[0]*s,n[1]=i[1]*s,n[2]=i[2]*s,n[3]=0,n[4]=i[4]*o,n[5]=i[5]*o,n[6]=i[6]*o,n[7]=0,n[8]=i[8]*a,n[9]=i[9]*a,n[10]=i[10]*a,n[11]=0,n[12]=0,n[13]=0,n[14]=0,n[15]=1,this}makeRotationFromEuler(e){const n=this.elements,i=e.x,s=e.y,o=e.z,a=Math.cos(i),l=Math.sin(i),c=Math.cos(s),u=Math.sin(s),h=Math.cos(o),f=Math.sin(o);if(e.order==="XYZ"){const d=a*h,p=a*f,m=l*h,g=l*f;n[0]=c*h,n[4]=-c*f,n[8]=u,n[1]=p+m*u,n[5]=d-g*u,n[9]=-l*c,n[2]=g-d*u,n[6]=m+p*u,n[10]=a*c}else if(e.order==="YXZ"){const d=c*h,p=c*f,m=u*h,g=u*f;n[0]=d+g*l,n[4]=m*l-p,n[8]=a*u,n[1]=a*f,n[5]=a*h,n[9]=-l,n[2]=p*l-m,n[6]=g+d*l,n[10]=a*c}else if(e.order==="ZXY"){const d=c*h,p=c*f,m=u*h,g=u*f;n[0]=d-g*l,n[4]=-a*f,n[8]=m+p*l,n[1]=p+m*l,n[5]=a*h,n[9]=g-d*l,n[2]=-a*u,n[6]=l,n[10]=a*c}else if(e.order==="ZYX"){const d=a*h,p=a*f,m=l*h,g=l*f;n[0]=c*h,n[4]=m*u-p,n[8]=d*u+g,n[1]=c*f,n[5]=g*u+d,n[9]=p*u-m,n[2]=-u,n[6]=l*c,n[10]=a*c}else if(e.order==="YZX"){const d=a*c,p=a*u,m=l*c,g=l*u;n[0]=c*h,n[4]=g-d*f,n[8]=m*f+p,n[1]=f,n[5]=a*h,n[9]=-l*h,n[2]=-u*h,n[6]=p*f+m,n[10]=d-g*f}else if(e.order==="XZY"){const d=a*c,p=a*u,m=l*c,g=l*u;n[0]=c*h,n[4]=-f,n[8]=u*h,n[1]=d*f+g,n[5]=a*h,n[9]=p*f-m,n[2]=m*f-p,n[6]=l*h,n[10]=g*f+d}return n[3]=0,n[7]=0,n[11]=0,n[12]=0,n[13]=0,n[14]=0,n[15]=1,this}makeRotationFromQuaternion(e){return this.compose(Rme,e,Nme)}lookAt(e,n,i){const s=this.elements;return uo.subVectors(e,n),uo.lengthSq()===0&&(uo.z=1),uo.normalize(),Ru.crossVectors(i,uo),Ru.lengthSq()===0&&(Math.abs(i.z)===1?uo.x+=1e-4:uo.z+=1e-4,uo.normalize(),Ru.crossVectors(i,uo)),Ru.normalize(),Ew.crossVectors(uo,Ru),s[0]=Ru.x,s[4]=Ew.x,s[8]=uo.x,s[1]=Ru.y,s[5]=Ew.y,s[9]=uo.y,s[2]=Ru.z,s[6]=Ew.z,s[10]=uo.z,this}multiply(e){return this.multiplyMatrices(this,e)}premultiply(e){return this.multiplyMatrices(e,this)}multiplyMatrices(e,n){const i=e.elements,s=n.elements,o=this.elements,a=i[0],l=i[4],c=i[8],u=i[12],h=i[1],f=i[5],d=i[9],p=i[13],m=i[2],g=i[6],v=i[10],y=i[14],x=i[3],b=i[7],w=i[11],_=i[15],S=s[0],T=s[4],E=s[8],M=s[12],A=s[1],P=s[5],D=s[9],B=s[13],C=s[2],O=s[6],R=s[10],z=s[14],U=s[3],G=s[7],H=s[11],Y=s[15];return o[0]=a*S+l*A+c*C+u*U,o[4]=a*T+l*P+c*O+u*G,o[8]=a*E+l*D+c*R+u*H,o[12]=a*M+l*B+c*z+u*Y,o[1]=h*S+f*A+d*C+p*U,o[5]=h*T+f*P+d*O+p*G,o[9]=h*E+f*D+d*R+p*H,o[13]=h*M+f*B+d*z+p*Y,o[2]=m*S+g*A+v*C+y*U,o[6]=m*T+g*P+v*O+y*G,o[10]=m*E+g*D+v*R+y*H,o[14]=m*M+g*B+v*z+y*Y,o[3]=x*S+b*A+w*C+_*U,o[7]=x*T+b*P+w*O+_*G,o[11]=x*E+b*D+w*R+_*H,o[15]=x*M+b*B+w*z+_*Y,this}multiplyScalar(e){const n=this.elements;return n[0]*=e,n[4]*=e,n[8]*=e,n[12]*=e,n[1]*=e,n[5]*=e,n[9]*=e,n[13]*=e,n[2]*=e,n[6]*=e,n[10]*=e,n[14]*=e,n[3]*=e,n[7]*=e,n[11]*=e,n[15]*=e,this}determinant(){const e=this.elements,n=e[0],i=e[4],s=e[8],o=e[12],a=e[1],l=e[5],c=e[9],u=e[13],h=e[2],f=e[6],d=e[10],p=e[14],m=e[3],g=e[7],v=e[11],y=e[15];return m*(+o*c*f-s*u*f-o*l*d+i*u*d+s*l*p-i*c*p)+g*(+n*c*p-n*u*d+o*a*d-s*a*p+s*u*h-o*c*h)+v*(+n*u*f-n*l*p-o*a*f+i*a*p+o*l*h-i*u*h)+y*(-s*l*h-n*c*f+n*l*d+s*a*f-i*a*d+i*c*h)}transpose(){const e=this.elements;let n;return n=e[1],e[1]=e[4],e[4]=n,n=e[2],e[2]=e[8],e[8]=n,n=e[6],e[6]=e[9],e[9]=n,n=e[3],e[3]=e[12],e[12]=n,n=e[7],e[7]=e[13],e[13]=n,n=e[11],e[11]=e[14],e[14]=n,this}setPosition(e,n,i){const s=this.elements;return e.isVector3?(s[12]=e.x,s[13]=e.y,s[14]=e.z):(s[12]=e,s[13]=n,s[14]=i),this}invert(){const e=this.elements,n=e[0],i=e[1],s=e[2],o=e[3],a=e[4],l=e[5],c=e[6],u=e[7],h=e[8],f=e[9],d=e[10],p=e[11],m=e[12],g=e[13],v=e[14],y=e[15],x=f*v*u-g*d*u+g*c*p-l*v*p-f*c*y+l*d*y,b=m*d*u-h*v*u-m*c*p+a*v*p+h*c*y-a*d*y,w=h*g*u-m*f*u+m*l*p-a*g*p-h*l*y+a*f*y,_=m*f*c-h*g*c-m*l*d+a*g*d+h*l*v-a*f*v,S=n*x+i*b+s*w+o*_;if(S===0)return this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0);const T=1/S;return e[0]=x*T,e[1]=(g*d*o-f*v*o-g*s*p+i*v*p+f*s*y-i*d*y)*T,e[2]=(l*v*o-g*c*o+g*s*u-i*v*u-l*s*y+i*c*y)*T,e[3]=(f*c*o-l*d*o-f*s*u+i*d*u+l*s*p-i*c*p)*T,e[4]=b*T,e[5]=(h*v*o-m*d*o+m*s*p-n*v*p-h*s*y+n*d*y)*T,e[6]=(m*c*o-a*v*o-m*s*u+n*v*u+a*s*y-n*c*y)*T,e[7]=(a*d*o-h*c*o+h*s*u-n*d*u-a*s*p+n*c*p)*T,e[8]=w*T,e[9]=(m*f*o-h*g*o-m*i*p+n*g*p+h*i*y-n*f*y)*T,e[10]=(a*g*o-m*l*o+m*i*u-n*g*u-a*i*y+n*l*y)*T,e[11]=(h*l*o-a*f*o-h*i*u+n*f*u+a*i*p-n*l*p)*T,e[12]=_*T,e[13]=(h*g*s-m*f*s+m*i*d-n*g*d-h*i*v+n*f*v)*T,e[14]=(m*l*s-a*g*s-m*i*c+n*g*c+a*i*v-n*l*v)*T,e[15]=(a*f*s-h*l*s+h*i*c-n*f*c-a*i*d+n*l*d)*T,this}scale(e){const n=this.elements,i=e.x,s=e.y,o=e.z;return n[0]*=i,n[4]*=s,n[8]*=o,n[1]*=i,n[5]*=s,n[9]*=o,n[2]*=i,n[6]*=s,n[10]*=o,n[3]*=i,n[7]*=s,n[11]*=o,this}getMaxScaleOnAxis(){const e=this.elements,n=e[0]*e[0]+e[1]*e[1]+e[2]*e[2],i=e[4]*e[4]+e[5]*e[5]+e[6]*e[6],s=e[8]*e[8]+e[9]*e[9]+e[10]*e[10];return Math.sqrt(Math.max(n,i,s))}makeTranslation(e,n,i){return e.isVector3?this.set(1,0,0,e.x,0,1,0,e.y,0,0,1,e.z,0,0,0,1):this.set(1,0,0,e,0,1,0,n,0,0,1,i,0,0,0,1),this}makeRotationX(e){const n=Math.cos(e),i=Math.sin(e);return this.set(1,0,0,0,0,n,-i,0,0,i,n,0,0,0,0,1),this}makeRotationY(e){const n=Math.cos(e),i=Math.sin(e);return this.set(n,0,i,0,0,1,0,0,-i,0,n,0,0,0,0,1),this}makeRotationZ(e){const n=Math.cos(e),i=Math.sin(e);return this.set(n,-i,0,0,i,n,0,0,0,0,1,0,0,0,0,1),this}makeRotationAxis(e,n){const i=Math.cos(n),s=Math.sin(n),o=1-i,a=e.x,l=e.y,c=e.z,u=o*a,h=o*l;return this.set(u*a+i,u*l-s*c,u*c+s*l,0,u*l+s*c,h*l+i,h*c-s*a,0,u*c-s*l,h*c+s*a,o*c*c+i,0,0,0,0,1),this}makeScale(e,n,i){return this.set(e,0,0,0,0,n,0,0,0,0,i,0,0,0,0,1),this}makeShear(e,n,i,s,o,a){return this.set(1,i,o,0,e,1,a,0,n,s,1,0,0,0,0,1),this}compose(e,n,i){const s=this.elements,o=n._x,a=n._y,l=n._z,c=n._w,u=o+o,h=a+a,f=l+l,d=o*u,p=o*h,m=o*f,g=a*h,v=a*f,y=l*f,x=c*u,b=c*h,w=c*f,_=i.x,S=i.y,T=i.z;return s[0]=(1-(g+y))*_,s[1]=(p+w)*_,s[2]=(m-b)*_,s[3]=0,s[4]=(p-w)*S,s[5]=(1-(d+y))*S,s[6]=(v+x)*S,s[7]=0,s[8]=(m+b)*T,s[9]=(v-x)*T,s[10]=(1-(d+g))*T,s[11]=0,s[12]=e.x,s[13]=e.y,s[14]=e.z,s[15]=1,this}decompose(e,n,i){const s=this.elements;let o=Zd.set(s[0],s[1],s[2]).length();const a=Zd.set(s[4],s[5],s[6]).length(),l=Zd.set(s[8],s[9],s[10]).length();this.determinant()<0&&(o=-o),e.x=s[12],e.y=s[13],e.z=s[14],_a.copy(this);const u=1/o,h=1/a,f=1/l;return _a.elements[0]*=u,_a.elements[1]*=u,_a.elements[2]*=u,_a.elements[4]*=h,_a.elements[5]*=h,_a.elements[6]*=h,_a.elements[8]*=f,_a.elements[9]*=f,_a.elements[10]*=f,n.setFromRotationMatrix(_a),i.x=o,i.y=a,i.z=l,this}makePerspective(e,n,i,s,o,a,l=Gf){const c=this.elements,u=2*o/(n-e),h=2*o/(i-s),f=(n+e)/(n-e),d=(i+s)/(i-s);let p,m;if(l===Gf)p=-(a+o)/(a-o),m=-2*a*o/(a-o);else if(l===DO)p=-a/(a-o),m=-a*o/(a-o);else throw new Error("THREE.Matrix4.makePerspective(): Invalid coordinate system: "+l);return c[0]=u,c[4]=0,c[8]=f,c[12]=0,c[1]=0,c[5]=h,c[9]=d,c[13]=0,c[2]=0,c[6]=0,c[10]=p,c[14]=m,c[3]=0,c[7]=0,c[11]=-1,c[15]=0,this}makeOrthographic(e,n,i,s,o,a,l=Gf){const c=this.elements,u=1/(n-e),h=1/(i-s),f=1/(a-o),d=(n+e)*u,p=(i+s)*h;let m,g;if(l===Gf)m=(a+o)*f,g=-2*f;else if(l===DO)m=o*f,g=-1*f;else throw new Error("THREE.Matrix4.makeOrthographic(): Invalid coordinate system: "+l);return c[0]=2*u,c[4]=0,c[8]=0,c[12]=-d,c[1]=0,c[5]=2*h,c[9]=0,c[13]=-p,c[2]=0,c[6]=0,c[10]=g,c[14]=-m,c[3]=0,c[7]=0,c[11]=0,c[15]=1,this}equals(e){const n=this.elements,i=e.elements;for(let s=0;s<16;s++)if(n[s]!==i[s])return!1;return!0}fromArray(e,n=0){for(let i=0;i<16;i++)this.elements[i]=e[i+n];return this}toArray(e=[],n=0){const i=this.elements;return e[n]=i[0],e[n+1]=i[1],e[n+2]=i[2],e[n+3]=i[3],e[n+4]=i[4],e[n+5]=i[5],e[n+6]=i[6],e[n+7]=i[7],e[n+8]=i[8],e[n+9]=i[9],e[n+10]=i[10],e[n+11]=i[11],e[n+12]=i[12],e[n+13]=i[13],e[n+14]=i[14],e[n+15]=i[15],e}};const Zd=new me,_a=new _t,Rme=new me(0,0,0),Nme=new me(1,1,1),Ru=new me,Ew=new me,uo=new me,Aj=new _t,Cj=new ws;let Fi=class kK{constructor(e=0,n=0,i=0,s=kK.DEFAULT_ORDER){this.isEuler=!0,this._x=e,this._y=n,this._z=i,this._order=s}get x(){return this._x}set x(e){this._x=e,this._onChangeCallback()}get y(){return this._y}set y(e){this._y=e,this._onChangeCallback()}get z(){return this._z}set z(e){this._z=e,this._onChangeCallback()}get order(){return this._order}set order(e){this._order=e,this._onChangeCallback()}set(e,n,i,s=this._order){return this._x=e,this._y=n,this._z=i,this._order=s,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._order)}copy(e){return this._x=e._x,this._y=e._y,this._z=e._z,this._order=e._order,this._onChangeCallback(),this}setFromRotationMatrix(e,n=this._order,i=!0){const s=e.elements,o=s[0],a=s[4],l=s[8],c=s[1],u=s[5],h=s[9],f=s[2],d=s[6],p=s[10];switch(n){case"XYZ":this._y=Math.asin(Li(l,-1,1)),Math.abs(l)<.9999999?(this._x=Math.atan2(-h,p),this._z=Math.atan2(-a,o)):(this._x=Math.atan2(d,u),this._z=0);break;case"YXZ":this._x=Math.asin(-Li(h,-1,1)),Math.abs(h)<.9999999?(this._y=Math.atan2(l,p),this._z=Math.atan2(c,u)):(this._y=Math.atan2(-f,o),this._z=0);break;case"ZXY":this._x=Math.asin(Li(d,-1,1)),Math.abs(d)<.9999999?(this._y=Math.atan2(-f,p),this._z=Math.atan2(-a,u)):(this._y=0,this._z=Math.atan2(c,o));break;case"ZYX":this._y=Math.asin(-Li(f,-1,1)),Math.abs(f)<.9999999?(this._x=Math.atan2(d,p),this._z=Math.atan2(c,o)):(this._x=0,this._z=Math.atan2(-a,u));break;case"YZX":this._z=Math.asin(Li(c,-1,1)),Math.abs(c)<.9999999?(this._x=Math.atan2(-h,u),this._y=Math.atan2(-f,o)):(this._x=0,this._y=Math.atan2(l,p));break;case"XZY":this._z=Math.asin(-Li(a,-1,1)),Math.abs(a)<.9999999?(this._x=Math.atan2(d,u),this._y=Math.atan2(l,o)):(this._x=Math.atan2(-h,p),this._y=0);break;default:console.warn("THREE.Euler: .setFromRotationMatrix() encountered an unknown order: "+n)}return this._order=n,i===!0&&this._onChangeCallback(),this}setFromQuaternion(e,n,i){return Aj.makeRotationFromQuaternion(e),this.setFromRotationMatrix(Aj,n,i)}setFromVector3(e,n=this._order){return this.set(e.x,e.y,e.z,n)}reorder(e){return Cj.setFromEuler(this),this.setFromQuaternion(Cj,e)}equals(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._order===this._order}fromArray(e){return this._x=e[0],this._y=e[1],this._z=e[2],e[3]!==void 0&&(this._order=e[3]),this._onChangeCallback(),this}toArray(e=[],n=0){return e[n]=this._x,e[n+1]=this._y,e[n+2]=this._z,e[n+3]=this._order,e}_onChange(e){return this._onChangeCallback=e,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._order}};Fi.DEFAULT_ORDER="XYZ";let Ome=class{constructor(){this.mask=1}set(e){this.mask=(1<<e|0)>>>0}enable(e){this.mask|=1<<e|0}enableAll(){this.mask=-1}toggle(e){this.mask^=1<<e|0}disable(e){this.mask&=~(1<<e|0)}disableAll(){this.mask=0}test(e){return(this.mask&e.mask)!==0}isEnabled(e){return(this.mask&(1<<e|0))!==0}},Dme=0;const Pj=new me,Qd=new ws,ic=new _t,Mw=new me,rv=new me,kme=new me,Ime=new ws,Rj=new me(1,0,0),Nj=new me(0,1,0),Oj=new me(0,0,1),Dj={type:"added"},Lme={type:"removed"},Jd={type:"childadded",child:null},PP={type:"childremoved",child:null};let Ai=class P1 extends BM{constructor(){super(),this.isObject3D=!0,Object.defineProperty(this,"id",{value:Dme++}),this.uuid=Uh(),this.name="",this.type="Object3D",this.parent=null,this.children=[],this.up=P1.DEFAULT_UP.clone();const e=new me,n=new Fi,i=new ws,s=new me(1,1,1);function o(){i.setFromEuler(n,!1)}function a(){n.setFromQuaternion(i,void 0,!1)}n._onChange(o),i._onChange(a),Object.defineProperties(this,{position:{configurable:!0,enumerable:!0,value:e},rotation:{configurable:!0,enumerable:!0,value:n},quaternion:{configurable:!0,enumerable:!0,value:i},scale:{configurable:!0,enumerable:!0,value:s},modelViewMatrix:{value:new _t},normalMatrix:{value:new zh}}),this.matrix=new _t,this.matrixWorld=new _t,this.matrixAutoUpdate=P1.DEFAULT_MATRIX_AUTO_UPDATE,this.matrixWorldAutoUpdate=P1.DEFAULT_MATRIX_WORLD_AUTO_UPDATE,this.matrixWorldNeedsUpdate=!1,this.layers=new Ome,this.visible=!0,this.castShadow=!1,this.receiveShadow=!1,this.frustumCulled=!0,this.renderOrder=0,this.animations=[],this.userData={}}onBeforeShadow(){}onAfterShadow(){}onBeforeRender(){}onAfterRender(){}applyMatrix4(e){this.matrixAutoUpdate&&this.updateMatrix(),this.matrix.premultiply(e),this.matrix.decompose(this.position,this.quaternion,this.scale)}applyQuaternion(e){return this.quaternion.premultiply(e),this}setRotationFromAxisAngle(e,n){this.quaternion.setFromAxisAngle(e,n)}setRotationFromEuler(e){this.quaternion.setFromEuler(e,!0)}setRotationFromMatrix(e){this.quaternion.setFromRotationMatrix(e)}setRotationFromQuaternion(e){this.quaternion.copy(e)}rotateOnAxis(e,n){return Qd.setFromAxisAngle(e,n),this.quaternion.multiply(Qd),this}rotateOnWorldAxis(e,n){return Qd.setFromAxisAngle(e,n),this.quaternion.premultiply(Qd),this}rotateX(e){return this.rotateOnAxis(Rj,e)}rotateY(e){return this.rotateOnAxis(Nj,e)}rotateZ(e){return this.rotateOnAxis(Oj,e)}translateOnAxis(e,n){return Pj.copy(e).applyQuaternion(this.quaternion),this.position.add(Pj.multiplyScalar(n)),this}translateX(e){return this.translateOnAxis(Rj,e)}translateY(e){return this.translateOnAxis(Nj,e)}translateZ(e){return this.translateOnAxis(Oj,e)}localToWorld(e){return this.updateWorldMatrix(!0,!1),e.applyMatrix4(this.matrixWorld)}worldToLocal(e){return this.updateWorldMatrix(!0,!1),e.applyMatrix4(ic.copy(this.matrixWorld).invert())}lookAt(e,n,i){e.isVector3?Mw.copy(e):Mw.set(e,n,i);const s=this.parent;this.updateWorldMatrix(!0,!1),rv.setFromMatrixPosition(this.matrixWorld),this.isCamera||this.isLight?ic.lookAt(rv,Mw,this.up):ic.lookAt(Mw,rv,this.up),this.quaternion.setFromRotationMatrix(ic),s&&(ic.extractRotation(s.matrixWorld),Qd.setFromRotationMatrix(ic),this.quaternion.premultiply(Qd.invert()))}add(e){if(arguments.length>1){for(let n=0;n<arguments.length;n++)this.add(arguments[n]);return this}return e===this?(console.error("THREE.Object3D.add: object can't be added as a child of itself.",e),this):(e&&e.isObject3D?(e.removeFromParent(),e.parent=this,this.children.push(e),e.dispatchEvent(Dj),Jd.child=e,this.dispatchEvent(Jd),Jd.child=null):console.error("THREE.Object3D.add: object not an instance of THREE.Object3D.",e),this)}remove(e){if(arguments.length>1){for(let i=0;i<arguments.length;i++)this.remove(arguments[i]);return this}const n=this.children.indexOf(e);return n!==-1&&(e.parent=null,this.children.splice(n,1),e.dispatchEvent(Lme),PP.child=e,this.dispatchEvent(PP),PP.child=null),this}removeFromParent(){const e=this.parent;return e!==null&&e.remove(this),this}clear(){return this.remove(...this.children)}attach(e){return this.updateWorldMatrix(!0,!1),ic.copy(this.matrixWorld).invert(),e.parent!==null&&(e.parent.updateWorldMatrix(!0,!1),ic.multiply(e.parent.matrixWorld)),e.applyMatrix4(ic),e.removeFromParent(),e.parent=this,this.children.push(e),e.updateWorldMatrix(!1,!0),e.dispatchEvent(Dj),Jd.child=e,this.dispatchEvent(Jd),Jd.child=null,this}getObjectById(e){return this.getObjectByProperty("id",e)}getObjectByName(e){return this.getObjectByProperty("name",e)}getObjectByProperty(e,n){if(this[e]===n)return this;for(let i=0,s=this.children.length;i<s;i++){const a=this.children[i].getObjectByProperty(e,n);if(a!==void 0)return a}}getObjectsByProperty(e,n,i=[]){this[e]===n&&i.push(this);const s=this.children;for(let o=0,a=s.length;o<a;o++)s[o].getObjectsByProperty(e,n,i);return i}getWorldPosition(e){return this.updateWorldMatrix(!0,!1),e.setFromMatrixPosition(this.matrixWorld)}getWorldQuaternion(e){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(rv,e,kme),e}getWorldScale(e){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(rv,Ime,e),e}getWorldDirection(e){this.updateWorldMatrix(!0,!1);const n=this.matrixWorld.elements;return e.set(n[8],n[9],n[10]).normalize()}raycast(){}traverse(e){e(this);const n=this.children;for(let i=0,s=n.length;i<s;i++)n[i].traverse(e)}traverseVisible(e){if(this.visible===!1)return;e(this);const n=this.children;for(let i=0,s=n.length;i<s;i++)n[i].traverseVisible(e)}traverseAncestors(e){const n=this.parent;n!==null&&(e(n),n.traverseAncestors(e))}updateMatrix(){this.matrix.compose(this.position,this.quaternion,this.scale),this.matrixWorldNeedsUpdate=!0}updateMatrixWorld(e){this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||e)&&(this.parent===null?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),this.matrixWorldNeedsUpdate=!1,e=!0);const n=this.children;for(let i=0,s=n.length;i<s;i++){const o=n[i];(o.matrixWorldAutoUpdate===!0||e===!0)&&o.updateMatrixWorld(e)}}updateWorldMatrix(e,n){const i=this.parent;if(e===!0&&i!==null&&i.matrixWorldAutoUpdate===!0&&i.updateWorldMatrix(!0,!1),this.matrixAutoUpdate&&this.updateMatrix(),this.parent===null?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),n===!0){const s=this.children;for(let o=0,a=s.length;o<a;o++){const l=s[o];l.matrixWorldAutoUpdate===!0&&l.updateWorldMatrix(!1,!0)}}}toJSON(e){const n=e===void 0||typeof e=="string",i={};n&&(e={geometries:{},materials:{},textures:{},images:{},shapes:{},skeletons:{},animations:{},nodes:{}},i.metadata={version:4.6,type:"Object",generator:"Object3D.toJSON"});const s={};s.uuid=this.uuid,s.type=this.type,this.name!==""&&(s.name=this.name),this.castShadow===!0&&(s.castShadow=!0),this.receiveShadow===!0&&(s.receiveShadow=!0),this.visible===!1&&(s.visible=!1),this.frustumCulled===!1&&(s.frustumCulled=!1),this.renderOrder!==0&&(s.renderOrder=this.renderOrder),Object.keys(this.userData).length>0&&(s.userData=this.userData),s.layers=this.layers.mask,s.matrix=this.matrix.toArray(),s.up=this.up.toArray(),this.matrixAutoUpdate===!1&&(s.matrixAutoUpdate=!1),this.isInstancedMesh&&(s.type="InstancedMesh",s.count=this.count,s.instanceMatrix=this.instanceMatrix.toJSON(),this.instanceColor!==null&&(s.instanceColor=this.instanceColor.toJSON())),this.isBatchedMesh&&(s.type="BatchedMesh",s.perObjectFrustumCulled=this.perObjectFrustumCulled,s.sortObjects=this.sortObjects,s.drawRanges=this._drawRanges,s.reservedRanges=this._reservedRanges,s.visibility=this._visibility,s.active=this._active,s.bounds=this._bounds.map(l=>({boxInitialized:l.boxInitialized,boxMin:l.box.min.toArray(),boxMax:l.box.max.toArray(),sphereInitialized:l.sphereInitialized,sphereRadius:l.sphere.radius,sphereCenter:l.sphere.center.toArray()})),s.maxGeometryCount=this._maxGeometryCount,s.maxVertexCount=this._maxVertexCount,s.maxIndexCount=this._maxIndexCount,s.geometryInitialized=this._geometryInitialized,s.geometryCount=this._geometryCount,s.matricesTexture=this._matricesTexture.toJSON(e),this.boundingSphere!==null&&(s.boundingSphere={center:s.boundingSphere.center.toArray(),radius:s.boundingSphere.radius}),this.boundingBox!==null&&(s.boundingBox={min:s.boundingBox.min.toArray(),max:s.boundingBox.max.toArray()}));function o(l,c){return l[c.uuid]===void 0&&(l[c.uuid]=c.toJSON(e)),c.uuid}if(this.isScene)this.background&&(this.background.isColor?s.background=this.background.toJSON():this.background.isTexture&&(s.background=this.background.toJSON(e).uuid)),this.environment&&this.environment.isTexture&&this.environment.isRenderTargetTexture!==!0&&(s.environment=this.environment.toJSON(e).uuid);else if(this.isMesh||this.isLine||this.isPoints){s.geometry=o(e.geometries,this.geometry);const l=this.geometry.parameters;if(l!==void 0&&l.shapes!==void 0){const c=l.shapes;if(Array.isArray(c))for(let u=0,h=c.length;u<h;u++){const f=c[u];o(e.shapes,f)}else o(e.shapes,c)}}if(this.isSkinnedMesh&&(s.bindMode=this.bindMode,s.bindMatrix=this.bindMatrix.toArray(),this.skeleton!==void 0&&(o(e.skeletons,this.skeleton),s.skeleton=this.skeleton.uuid)),this.material!==void 0)if(Array.isArray(this.material)){const l=[];for(let c=0,u=this.material.length;c<u;c++)l.push(o(e.materials,this.material[c]));s.material=l}else s.material=o(e.materials,this.material);if(this.children.length>0){s.children=[];for(let l=0;l<this.children.length;l++)s.children.push(this.children[l].toJSON(e).object)}if(this.animations.length>0){s.animations=[];for(let l=0;l<this.animations.length;l++){const c=this.animations[l];s.animations.push(o(e.animations,c))}}if(n){const l=a(e.geometries),c=a(e.materials),u=a(e.textures),h=a(e.images),f=a(e.shapes),d=a(e.skeletons),p=a(e.animations),m=a(e.nodes);l.length>0&&(i.geometries=l),c.length>0&&(i.materials=c),u.length>0&&(i.textures=u),h.length>0&&(i.images=h),f.length>0&&(i.shapes=f),d.length>0&&(i.skeletons=d),p.length>0&&(i.animations=p),m.length>0&&(i.nodes=m)}return i.object=s,i;function a(l){const c=[];for(const u in l){const h=l[u];delete h.metadata,c.push(h)}return c}}clone(e){return new this.constructor().copy(this,e)}copy(e,n=!0){if(this.name=e.name,this.up.copy(e.up),this.position.copy(e.position),this.rotation.order=e.rotation.order,this.quaternion.copy(e.quaternion),this.scale.copy(e.scale),this.matrix.copy(e.matrix),this.matrixWorld.copy(e.matrixWorld),this.matrixAutoUpdate=e.matrixAutoUpdate,this.matrixWorldAutoUpdate=e.matrixWorldAutoUpdate,this.matrixWorldNeedsUpdate=e.matrixWorldNeedsUpdate,this.layers.mask=e.layers.mask,this.visible=e.visible,this.castShadow=e.castShadow,this.receiveShadow=e.receiveShadow,this.frustumCulled=e.frustumCulled,this.renderOrder=e.renderOrder,this.animations=e.animations.slice(),this.userData=JSON.parse(JSON.stringify(e.userData)),n===!0)for(let i=0;i<e.children.length;i++){const s=e.children[i];this.add(s.clone())}return this}};Ai.DEFAULT_UP=new me(0,1,0);Ai.DEFAULT_MATRIX_AUTO_UPDATE=!0;Ai.DEFAULT_MATRIX_WORLD_AUTO_UPDATE=!0;const wa=new me,sc=new me,RP=new me,oc=new me,ep=new me,tp=new me,kj=new me,NP=new me,OP=new me,DP=new me;let Aw=class Up{constructor(e=new me,n=new me,i=new me){this.a=e,this.b=n,this.c=i}static getNormal(e,n,i,s){s.subVectors(i,n),wa.subVectors(e,n),s.cross(wa);const o=s.lengthSq();return o>0?s.multiplyScalar(1/Math.sqrt(o)):s.set(0,0,0)}static getBarycoord(e,n,i,s,o){wa.subVectors(s,n),sc.subVectors(i,n),RP.subVectors(e,n);const a=wa.dot(wa),l=wa.dot(sc),c=wa.dot(RP),u=sc.dot(sc),h=sc.dot(RP),f=a*u-l*l;if(f===0)return o.set(0,0,0),null;const d=1/f,p=(u*c-l*h)*d,m=(a*h-l*c)*d;return o.set(1-p-m,m,p)}static containsPoint(e,n,i,s){return this.getBarycoord(e,n,i,s,oc)===null?!1:oc.x>=0&&oc.y>=0&&oc.x+oc.y<=1}static getInterpolation(e,n,i,s,o,a,l,c){return this.getBarycoord(e,n,i,s,oc)===null?(c.x=0,c.y=0,"z"in c&&(c.z=0),"w"in c&&(c.w=0),null):(c.setScalar(0),c.addScaledVector(o,oc.x),c.addScaledVector(a,oc.y),c.addScaledVector(l,oc.z),c)}static isFrontFacing(e,n,i,s){return wa.subVectors(i,n),sc.subVectors(e,n),wa.cross(sc).dot(s)<0}set(e,n,i){return this.a.copy(e),this.b.copy(n),this.c.copy(i),this}setFromPointsAndIndices(e,n,i,s){return this.a.copy(e[n]),this.b.copy(e[i]),this.c.copy(e[s]),this}setFromAttributeAndIndices(e,n,i,s){return this.a.fromBufferAttribute(e,n),this.b.fromBufferAttribute(e,i),this.c.fromBufferAttribute(e,s),this}clone(){return new this.constructor().copy(this)}copy(e){return this.a.copy(e.a),this.b.copy(e.b),this.c.copy(e.c),this}getArea(){return wa.subVectors(this.c,this.b),sc.subVectors(this.a,this.b),wa.cross(sc).length()*.5}getMidpoint(e){return e.addVectors(this.a,this.b).add(this.c).multiplyScalar(1/3)}getNormal(e){return Up.getNormal(this.a,this.b,this.c,e)}getPlane(e){return e.setFromCoplanarPoints(this.a,this.b,this.c)}getBarycoord(e,n){return Up.getBarycoord(e,this.a,this.b,this.c,n)}getInterpolation(e,n,i,s,o){return Up.getInterpolation(e,this.a,this.b,this.c,n,i,s,o)}containsPoint(e){return Up.containsPoint(e,this.a,this.b,this.c)}isFrontFacing(e){return Up.isFrontFacing(this.a,this.b,this.c,e)}intersectsBox(e){return e.intersectsTriangle(this)}closestPointToPoint(e,n){const i=this.a,s=this.b,o=this.c;let a,l;ep.subVectors(s,i),tp.subVectors(o,i),NP.subVectors(e,i);const c=ep.dot(NP),u=tp.dot(NP);if(c<=0&&u<=0)return n.copy(i);OP.subVectors(e,s);const h=ep.dot(OP),f=tp.dot(OP);if(h>=0&&f<=h)return n.copy(s);const d=c*f-h*u;if(d<=0&&c>=0&&h<=0)return a=c/(c-h),n.copy(i).addScaledVector(ep,a);DP.subVectors(e,o);const p=ep.dot(DP),m=tp.dot(DP);if(m>=0&&p<=m)return n.copy(o);const g=p*u-c*m;if(g<=0&&u>=0&&m<=0)return l=u/(u-m),n.copy(i).addScaledVector(tp,l);const v=h*m-p*f;if(v<=0&&f-h>=0&&p-m>=0)return kj.subVectors(o,s),l=(f-h)/(f-h+(p-m)),n.copy(s).addScaledVector(kj,l);const y=1/(v+g+d);return a=g*y,l=d*y,n.copy(i).addScaledVector(ep,a).addScaledVector(tp,l)}equals(e){return e.a.equals(this.a)&&e.b.equals(this.b)&&e.c.equals(this.c)}};const IK={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074},Nu={h:0,s:0,l:0},Cw={h:0,s:0,l:0};function kP(r,e,n){return n<0&&(n+=1),n>1&&(n-=1),n<1/6?r+(e-r)*6*n:n<1/2?e:n<2/3?r+(e-r)*6*(2/3-n):r}let wr=class{constructor(e,n,i){return this.isColor=!0,this.r=1,this.g=1,this.b=1,this.set(e,n,i)}set(e,n,i){if(n===void 0&&i===void 0){const s=e;s&&s.isColor?this.copy(s):typeof s=="number"?this.setHex(s):typeof s=="string"&&this.setStyle(s)}else this.setRGB(e,n,i);return this}setScalar(e){return this.r=e,this.g=e,this.b=e,this}setHex(e,n=Ss){return e=Math.floor(e),this.r=(e>>16&255)/255,this.g=(e>>8&255)/255,this.b=(e&255)/255,xa.toWorkingColorSpace(this,n),this}setRGB(e,n,i,s=xa.workingColorSpace){return this.r=e,this.g=n,this.b=i,xa.toWorkingColorSpace(this,s),this}setHSL(e,n,i,s=xa.workingColorSpace){if(e=ZL(e,1),n=Li(n,0,1),i=Li(i,0,1),n===0)this.r=this.g=this.b=i;else{const o=i<=.5?i*(1+n):i+n-i*n,a=2*i-o;this.r=kP(a,o,e+1/3),this.g=kP(a,o,e),this.b=kP(a,o,e-1/3)}return xa.toWorkingColorSpace(this,s),this}setStyle(e,n=Ss){function i(o){o!==void 0&&parseFloat(o)<1&&console.warn("THREE.Color: Alpha component of "+e+" will be ignored.")}let s;if(s=/^(\w+)\(([^\)]*)\)/.exec(e)){let o;const a=s[1],l=s[2];switch(a){case"rgb":case"rgba":if(o=/^\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(l))return i(o[4]),this.setRGB(Math.min(255,parseInt(o[1],10))/255,Math.min(255,parseInt(o[2],10))/255,Math.min(255,parseInt(o[3],10))/255,n);if(o=/^\s*(\d+)\%\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(l))return i(o[4]),this.setRGB(Math.min(100,parseInt(o[1],10))/100,Math.min(100,parseInt(o[2],10))/100,Math.min(100,parseInt(o[3],10))/100,n);break;case"hsl":case"hsla":if(o=/^\s*(\d*\.?\d+)\s*,\s*(\d*\.?\d+)\%\s*,\s*(\d*\.?\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(l))return i(o[4]),this.setHSL(parseFloat(o[1])/360,parseFloat(o[2])/100,parseFloat(o[3])/100,n);break;default:console.warn("THREE.Color: Unknown color model "+e)}}else if(s=/^\#([A-Fa-f\d]+)$/.exec(e)){const o=s[1],a=o.length;if(a===3)return this.setRGB(parseInt(o.charAt(0),16)/15,parseInt(o.charAt(1),16)/15,parseInt(o.charAt(2),16)/15,n);if(a===6)return this.setHex(parseInt(o,16),n);console.warn("THREE.Color: Invalid hex color "+e)}else if(e&&e.length>0)return this.setColorName(e,n);return this}setColorName(e,n=Ss){const i=IK[e.toLowerCase()];return i!==void 0?this.setHex(i,n):console.warn("THREE.Color: Unknown color "+e),this}clone(){return new this.constructor(this.r,this.g,this.b)}copy(e){return this.r=e.r,this.g=e.g,this.b=e.b,this}copySRGBToLinear(e){return this.r=Mm(e.r),this.g=Mm(e.g),this.b=Mm(e.b),this}copyLinearToSRGB(e){return this.r=_P(e.r),this.g=_P(e.g),this.b=_P(e.b),this}convertSRGBToLinear(){return this.copySRGBToLinear(this),this}convertLinearToSRGB(){return this.copyLinearToSRGB(this),this}getHex(e=Ss){return xa.fromWorkingColorSpace(Xi.copy(this),e),Math.round(Li(Xi.r*255,0,255))*65536+Math.round(Li(Xi.g*255,0,255))*256+Math.round(Li(Xi.b*255,0,255))}getHexString(e=Ss){return("000000"+this.getHex(e).toString(16)).slice(-6)}getHSL(e,n=xa.workingColorSpace){xa.fromWorkingColorSpace(Xi.copy(this),n);const i=Xi.r,s=Xi.g,o=Xi.b,a=Math.max(i,s,o),l=Math.min(i,s,o);let c,u;const h=(l+a)/2;if(l===a)c=0,u=0;else{const f=a-l;switch(u=h<=.5?f/(a+l):f/(2-a-l),a){case i:c=(s-o)/f+(s<o?6:0);break;case s:c=(o-i)/f+2;break;case o:c=(i-s)/f+4;break}c/=6}return e.h=c,e.s=u,e.l=h,e}getRGB(e,n=xa.workingColorSpace){return xa.fromWorkingColorSpace(Xi.copy(this),n),e.r=Xi.r,e.g=Xi.g,e.b=Xi.b,e}getStyle(e=Ss){xa.fromWorkingColorSpace(Xi.copy(this),e);const n=Xi.r,i=Xi.g,s=Xi.b;return e!==Ss?`color(${e} ${n.toFixed(3)} ${i.toFixed(3)} ${s.toFixed(3)})`:`rgb(${Math.round(n*255)},${Math.round(i*255)},${Math.round(s*255)})`}offsetHSL(e,n,i){return this.getHSL(Nu),this.setHSL(Nu.h+e,Nu.s+n,Nu.l+i)}add(e){return this.r+=e.r,this.g+=e.g,this.b+=e.b,this}addColors(e,n){return this.r=e.r+n.r,this.g=e.g+n.g,this.b=e.b+n.b,this}addScalar(e){return this.r+=e,this.g+=e,this.b+=e,this}sub(e){return this.r=Math.max(0,this.r-e.r),this.g=Math.max(0,this.g-e.g),this.b=Math.max(0,this.b-e.b),this}multiply(e){return this.r*=e.r,this.g*=e.g,this.b*=e.b,this}multiplyScalar(e){return this.r*=e,this.g*=e,this.b*=e,this}lerp(e,n){return this.r+=(e.r-this.r)*n,this.g+=(e.g-this.g)*n,this.b+=(e.b-this.b)*n,this}lerpColors(e,n,i){return this.r=e.r+(n.r-e.r)*i,this.g=e.g+(n.g-e.g)*i,this.b=e.b+(n.b-e.b)*i,this}lerpHSL(e,n){this.getHSL(Nu),e.getHSL(Cw);const i=O0(Nu.h,Cw.h,n),s=O0(Nu.s,Cw.s,n),o=O0(Nu.l,Cw.l,n);return this.setHSL(i,s,o),this}setFromVector3(e){return this.r=e.x,this.g=e.y,this.b=e.z,this}applyMatrix3(e){const n=this.r,i=this.g,s=this.b,o=e.elements;return this.r=o[0]*n+o[3]*i+o[6]*s,this.g=o[1]*n+o[4]*i+o[7]*s,this.b=o[2]*n+o[5]*i+o[8]*s,this}equals(e){return e.r===this.r&&e.g===this.g&&e.b===this.b}fromArray(e,n=0){return this.r=e[n],this.g=e[n+1],this.b=e[n+2],this}toArray(e=[],n=0){return e[n]=this.r,e[n+1]=this.g,e[n+2]=this.b,e}fromBufferAttribute(e,n){return this.r=e.getX(n),this.g=e.getY(n),this.b=e.getZ(n),this}toJSON(){return this.getHex()}*[Symbol.iterator](){yield this.r,yield this.g,yield this.b}};const Xi=new wr;wr.NAMES=IK;let Fme=0,UM=class extends BM{constructor(){super(),this.isMaterial=!0,Object.defineProperty(this,"id",{value:Fme++}),this.uuid=Uh(),this.name="",this.type="Material",this.blending=oj,this.side=PT,this.vertexColors=!1,this.opacity=1,this.transparent=!1,this.alphaHash=!1,this.blendSrc=lj,this.blendDst=cj,this.blendEquation=aj,this.blendSrcAlpha=null,this.blendDstAlpha=null,this.blendEquationAlpha=null,this.blendColor=new wr(0,0,0),this.blendAlpha=0,this.depthFunc=uj,this.depthTest=!0,this.depthWrite=!0,this.stencilWriteMask=255,this.stencilFunc=bj,this.stencilRef=0,this.stencilFuncMask=255,this.stencilFail=Wd,this.stencilZFail=Wd,this.stencilZPass=Wd,this.stencilWrite=!1,this.clippingPlanes=null,this.clipIntersection=!1,this.clipShadows=!1,this.shadowSide=null,this.colorWrite=!0,this.precision=null,this.polygonOffset=!1,this.polygonOffsetFactor=0,this.polygonOffsetUnits=0,this.dithering=!1,this.alphaToCoverage=!1,this.premultipliedAlpha=!1,this.forceSinglePass=!1,this.visible=!0,this.toneMapped=!0,this.userData={},this.version=0,this._alphaTest=0}get alphaTest(){return this._alphaTest}set alphaTest(e){this._alphaTest>0!=e>0&&this.version++,this._alphaTest=e}onBuild(){}onBeforeRender(){}onBeforeCompile(){}customProgramCacheKey(){return this.onBeforeCompile.toString()}setValues(e){if(e!==void 0)for(const n in e){const i=e[n];if(i===void 0){console.warn(`THREE.Material: parameter '${n}' has value of undefined.`);continue}const s=this[n];if(s===void 0){console.warn(`THREE.Material: '${n}' is not a property of THREE.${this.type}.`);continue}s&&s.isColor?s.set(i):s&&s.isVector3&&i&&i.isVector3?s.copy(i):this[n]=i}}toJSON(e){const n=e===void 0||typeof e=="string";n&&(e={textures:{},images:{}});const i={metadata:{version:4.6,type:"Material",generator:"Material.toJSON"}};i.uuid=this.uuid,i.type=this.type,this.name!==""&&(i.name=this.name),this.color&&this.color.isColor&&(i.color=this.color.getHex()),this.roughness!==void 0&&(i.roughness=this.roughness),this.metalness!==void 0&&(i.metalness=this.metalness),this.sheen!==void 0&&(i.sheen=this.sheen),this.sheenColor&&this.sheenColor.isColor&&(i.sheenColor=this.sheenColor.getHex()),this.sheenRoughness!==void 0&&(i.sheenRoughness=this.sheenRoughness),this.emissive&&this.emissive.isColor&&(i.emissive=this.emissive.getHex()),this.emissiveIntensity!==void 0&&this.emissiveIntensity!==1&&(i.emissiveIntensity=this.emissiveIntensity),this.specular&&this.specular.isColor&&(i.specular=this.specular.getHex()),this.specularIntensity!==void 0&&(i.specularIntensity=this.specularIntensity),this.specularColor&&this.specularColor.isColor&&(i.specularColor=this.specularColor.getHex()),this.shininess!==void 0&&(i.shininess=this.shininess),this.clearcoat!==void 0&&(i.clearcoat=this.clearcoat),this.clearcoatRoughness!==void 0&&(i.clearcoatRoughness=this.clearcoatRoughness),this.clearcoatMap&&this.clearcoatMap.isTexture&&(i.clearcoatMap=this.clearcoatMap.toJSON(e).uuid),this.clearcoatRoughnessMap&&this.clearcoatRoughnessMap.isTexture&&(i.clearcoatRoughnessMap=this.clearcoatRoughnessMap.toJSON(e).uuid),this.clearcoatNormalMap&&this.clearcoatNormalMap.isTexture&&(i.clearcoatNormalMap=this.clearcoatNormalMap.toJSON(e).uuid,i.clearcoatNormalScale=this.clearcoatNormalScale.toArray()),this.dispersion!==void 0&&(i.dispersion=this.dispersion),this.iridescence!==void 0&&(i.iridescence=this.iridescence),this.iridescenceIOR!==void 0&&(i.iridescenceIOR=this.iridescenceIOR),this.iridescenceThicknessRange!==void 0&&(i.iridescenceThicknessRange=this.iridescenceThicknessRange),this.iridescenceMap&&this.iridescenceMap.isTexture&&(i.iridescenceMap=this.iridescenceMap.toJSON(e).uuid),this.iridescenceThicknessMap&&this.iridescenceThicknessMap.isTexture&&(i.iridescenceThicknessMap=this.iridescenceThicknessMap.toJSON(e).uuid),this.anisotropy!==void 0&&(i.anisotropy=this.anisotropy),this.anisotropyRotation!==void 0&&(i.anisotropyRotation=this.anisotropyRotation),this.anisotropyMap&&this.anisotropyMap.isTexture&&(i.anisotropyMap=this.anisotropyMap.toJSON(e).uuid),this.map&&this.map.isTexture&&(i.map=this.map.toJSON(e).uuid),this.matcap&&this.matcap.isTexture&&(i.matcap=this.matcap.toJSON(e).uuid),this.alphaMap&&this.alphaMap.isTexture&&(i.alphaMap=this.alphaMap.toJSON(e).uuid),this.lightMap&&this.lightMap.isTexture&&(i.lightMap=this.lightMap.toJSON(e).uuid,i.lightMapIntensity=this.lightMapIntensity),this.aoMap&&this.aoMap.isTexture&&(i.aoMap=this.aoMap.toJSON(e).uuid,i.aoMapIntensity=this.aoMapIntensity),this.bumpMap&&this.bumpMap.isTexture&&(i.bumpMap=this.bumpMap.toJSON(e).uuid,i.bumpScale=this.bumpScale),this.normalMap&&this.normalMap.isTexture&&(i.normalMap=this.normalMap.toJSON(e).uuid,i.normalMapType=this.normalMapType,i.normalScale=this.normalScale.toArray()),this.displacementMap&&this.displacementMap.isTexture&&(i.displacementMap=this.displacementMap.toJSON(e).uuid,i.displacementScale=this.displacementScale,i.displacementBias=this.displacementBias),this.roughnessMap&&this.roughnessMap.isTexture&&(i.roughnessMap=this.roughnessMap.toJSON(e).uuid),this.metalnessMap&&this.metalnessMap.isTexture&&(i.metalnessMap=this.metalnessMap.toJSON(e).uuid),this.emissiveMap&&this.emissiveMap.isTexture&&(i.emissiveMap=this.emissiveMap.toJSON(e).uuid),this.specularMap&&this.specularMap.isTexture&&(i.specularMap=this.specularMap.toJSON(e).uuid),this.specularIntensityMap&&this.specularIntensityMap.isTexture&&(i.specularIntensityMap=this.specularIntensityMap.toJSON(e).uuid),this.specularColorMap&&this.specularColorMap.isTexture&&(i.specularColorMap=this.specularColorMap.toJSON(e).uuid),this.envMap&&this.envMap.isTexture&&(i.envMap=this.envMap.toJSON(e).uuid,this.combine!==void 0&&(i.combine=this.combine)),this.envMapRotation!==void 0&&(i.envMapRotation=this.envMapRotation.toArray()),this.envMapIntensity!==void 0&&(i.envMapIntensity=this.envMapIntensity),this.reflectivity!==void 0&&(i.reflectivity=this.reflectivity),this.refractionRatio!==void 0&&(i.refractionRatio=this.refractionRatio),this.gradientMap&&this.gradientMap.isTexture&&(i.gradientMap=this.gradientMap.toJSON(e).uuid),this.transmission!==void 0&&(i.transmission=this.transmission),this.transmissionMap&&this.transmissionMap.isTexture&&(i.transmissionMap=this.transmissionMap.toJSON(e).uuid),this.thickness!==void 0&&(i.thickness=this.thickness),this.thicknessMap&&this.thicknessMap.isTexture&&(i.thicknessMap=this.thicknessMap.toJSON(e).uuid),this.attenuationDistance!==void 0&&this.attenuationDistance!==1/0&&(i.attenuationDistance=this.attenuationDistance),this.attenuationColor!==void 0&&(i.attenuationColor=this.attenuationColor.getHex()),this.size!==void 0&&(i.size=this.size),this.shadowSide!==null&&(i.shadowSide=this.shadowSide),this.sizeAttenuation!==void 0&&(i.sizeAttenuation=this.sizeAttenuation),this.blending!==oj&&(i.blending=this.blending),this.side!==PT&&(i.side=this.side),this.vertexColors===!0&&(i.vertexColors=!0),this.opacity<1&&(i.opacity=this.opacity),this.transparent===!0&&(i.transparent=!0),this.blendSrc!==lj&&(i.blendSrc=this.blendSrc),this.blendDst!==cj&&(i.blendDst=this.blendDst),this.blendEquation!==aj&&(i.blendEquation=this.blendEquation),this.blendSrcAlpha!==null&&(i.blendSrcAlpha=this.blendSrcAlpha),this.blendDstAlpha!==null&&(i.blendDstAlpha=this.blendDstAlpha),this.blendEquationAlpha!==null&&(i.blendEquationAlpha=this.blendEquationAlpha),this.blendColor&&this.blendColor.isColor&&(i.blendColor=this.blendColor.getHex()),this.blendAlpha!==0&&(i.blendAlpha=this.blendAlpha),this.depthFunc!==uj&&(i.depthFunc=this.depthFunc),this.depthTest===!1&&(i.depthTest=this.depthTest),this.depthWrite===!1&&(i.depthWrite=this.depthWrite),this.colorWrite===!1&&(i.colorWrite=this.colorWrite),this.stencilWriteMask!==255&&(i.stencilWriteMask=this.stencilWriteMask),this.stencilFunc!==bj&&(i.stencilFunc=this.stencilFunc),this.stencilRef!==0&&(i.stencilRef=this.stencilRef),this.stencilFuncMask!==255&&(i.stencilFuncMask=this.stencilFuncMask),this.stencilFail!==Wd&&(i.stencilFail=this.stencilFail),this.stencilZFail!==Wd&&(i.stencilZFail=this.stencilZFail),this.stencilZPass!==Wd&&(i.stencilZPass=this.stencilZPass),this.stencilWrite===!0&&(i.stencilWrite=this.stencilWrite),this.rotation!==void 0&&this.rotation!==0&&(i.rotation=this.rotation),this.polygonOffset===!0&&(i.polygonOffset=!0),this.polygonOffsetFactor!==0&&(i.polygonOffsetFactor=this.polygonOffsetFactor),this.polygonOffsetUnits!==0&&(i.polygonOffsetUnits=this.polygonOffsetUnits),this.linewidth!==void 0&&this.linewidth!==1&&(i.linewidth=this.linewidth),this.dashSize!==void 0&&(i.dashSize=this.dashSize),this.gapSize!==void 0&&(i.gapSize=this.gapSize),this.scale!==void 0&&(i.scale=this.scale),this.dithering===!0&&(i.dithering=!0),this.alphaTest>0&&(i.alphaTest=this.alphaTest),this.alphaHash===!0&&(i.alphaHash=!0),this.alphaToCoverage===!0&&(i.alphaToCoverage=!0),this.premultipliedAlpha===!0&&(i.premultipliedAlpha=!0),this.forceSinglePass===!0&&(i.forceSinglePass=!0),this.wireframe===!0&&(i.wireframe=!0),this.wireframeLinewidth>1&&(i.wireframeLinewidth=this.wireframeLinewidth),this.wireframeLinecap!=="round"&&(i.wireframeLinecap=this.wireframeLinecap),this.wireframeLinejoin!=="round"&&(i.wireframeLinejoin=this.wireframeLinejoin),this.flatShading===!0&&(i.flatShading=!0),this.visible===!1&&(i.visible=!1),this.toneMapped===!1&&(i.toneMapped=!1),this.fog===!1&&(i.fog=!1),Object.keys(this.userData).length>0&&(i.userData=this.userData);function s(o){const a=[];for(const l in o){const c=o[l];delete c.metadata,a.push(c)}return a}if(n){const o=s(e.textures),a=s(e.images);o.length>0&&(i.textures=o),a.length>0&&(i.images=a)}return i}clone(){return new this.constructor().copy(this)}copy(e){this.name=e.name,this.blending=e.blending,this.side=e.side,this.vertexColors=e.vertexColors,this.opacity=e.opacity,this.transparent=e.transparent,this.blendSrc=e.blendSrc,this.blendDst=e.blendDst,this.blendEquation=e.blendEquation,this.blendSrcAlpha=e.blendSrcAlpha,this.blendDstAlpha=e.blendDstAlpha,this.blendEquationAlpha=e.blendEquationAlpha,this.blendColor.copy(e.blendColor),this.blendAlpha=e.blendAlpha,this.depthFunc=e.depthFunc,this.depthTest=e.depthTest,this.depthWrite=e.depthWrite,this.stencilWriteMask=e.stencilWriteMask,this.stencilFunc=e.stencilFunc,this.stencilRef=e.stencilRef,this.stencilFuncMask=e.stencilFuncMask,this.stencilFail=e.stencilFail,this.stencilZFail=e.stencilZFail,this.stencilZPass=e.stencilZPass,this.stencilWrite=e.stencilWrite;const n=e.clippingPlanes;let i=null;if(n!==null){const s=n.length;i=new Array(s);for(let o=0;o!==s;++o)i[o]=n[o].clone()}return this.clippingPlanes=i,this.clipIntersection=e.clipIntersection,this.clipShadows=e.clipShadows,this.shadowSide=e.shadowSide,this.colorWrite=e.colorWrite,this.precision=e.precision,this.polygonOffset=e.polygonOffset,this.polygonOffsetFactor=e.polygonOffsetFactor,this.polygonOffsetUnits=e.polygonOffsetUnits,this.dithering=e.dithering,this.alphaTest=e.alphaTest,this.alphaHash=e.alphaHash,this.alphaToCoverage=e.alphaToCoverage,this.premultipliedAlpha=e.premultipliedAlpha,this.forceSinglePass=e.forceSinglePass,this.visible=e.visible,this.toneMapped=e.toneMapped,this.userData=JSON.parse(JSON.stringify(e.userData)),this}dispose(){this.dispatchEvent({type:"dispose"})}set needsUpdate(e){e===!0&&this.version++}},LO=class extends UM{constructor(e){super(),this.isMeshBasicMaterial=!0,this.type="MeshBasicMaterial",this.color=new wr(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.envMapRotation=new Fi,this.combine=XL,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.envMapRotation.copy(e.envMapRotation),this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.fog=e.fog,this}};const Fr=new me,Pw=new Er;let Am=class{constructor(e,n,i=!1){if(Array.isArray(e))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");this.isBufferAttribute=!0,this.name="",this.array=e,this.itemSize=n,this.count=e!==void 0?e.length/n:0,this.normalized=i,this.usage=_j,this._updateRange={offset:0,count:-1},this.updateRanges=[],this.gpuType=EK,this.version=0}onUploadCallback(){}set needsUpdate(e){e===!0&&this.version++}get updateRange(){return Sme("THREE.BufferAttribute: updateRange() is deprecated and will be removed in r169. Use addUpdateRange() instead."),this._updateRange}setUsage(e){return this.usage=e,this}addUpdateRange(e,n){this.updateRanges.push({start:e,count:n})}clearUpdateRanges(){this.updateRanges.length=0}copy(e){return this.name=e.name,this.array=new e.array.constructor(e.array),this.itemSize=e.itemSize,this.count=e.count,this.normalized=e.normalized,this.usage=e.usage,this.gpuType=e.gpuType,this}copyAt(e,n,i){e*=this.itemSize,i*=n.itemSize;for(let s=0,o=this.itemSize;s<o;s++)this.array[e+s]=n.array[i+s];return this}copyArray(e){return this.array.set(e),this}applyMatrix3(e){if(this.itemSize===2)for(let n=0,i=this.count;n<i;n++)Pw.fromBufferAttribute(this,n),Pw.applyMatrix3(e),this.setXY(n,Pw.x,Pw.y);else if(this.itemSize===3)for(let n=0,i=this.count;n<i;n++)Fr.fromBufferAttribute(this,n),Fr.applyMatrix3(e),this.setXYZ(n,Fr.x,Fr.y,Fr.z);return this}applyMatrix4(e){for(let n=0,i=this.count;n<i;n++)Fr.fromBufferAttribute(this,n),Fr.applyMatrix4(e),this.setXYZ(n,Fr.x,Fr.y,Fr.z);return this}applyNormalMatrix(e){for(let n=0,i=this.count;n<i;n++)Fr.fromBufferAttribute(this,n),Fr.applyNormalMatrix(e),this.setXYZ(n,Fr.x,Fr.y,Fr.z);return this}transformDirection(e){for(let n=0,i=this.count;n<i;n++)Fr.fromBufferAttribute(this,n),Fr.transformDirection(e),this.setXYZ(n,Fr.x,Fr.y,Fr.z);return this}set(e,n=0){return this.array.set(e,n),this}getComponent(e,n){let i=this.array[e*this.itemSize+n];return this.normalized&&(i=Bp(i,this.array)),i}setComponent(e,n,i){return this.normalized&&(i=ds(i,this.array)),this.array[e*this.itemSize+n]=i,this}getX(e){let n=this.array[e*this.itemSize];return this.normalized&&(n=Bp(n,this.array)),n}setX(e,n){return this.normalized&&(n=ds(n,this.array)),this.array[e*this.itemSize]=n,this}getY(e){let n=this.array[e*this.itemSize+1];return this.normalized&&(n=Bp(n,this.array)),n}setY(e,n){return this.normalized&&(n=ds(n,this.array)),this.array[e*this.itemSize+1]=n,this}getZ(e){let n=this.array[e*this.itemSize+2];return this.normalized&&(n=Bp(n,this.array)),n}setZ(e,n){return this.normalized&&(n=ds(n,this.array)),this.array[e*this.itemSize+2]=n,this}getW(e){let n=this.array[e*this.itemSize+3];return this.normalized&&(n=Bp(n,this.array)),n}setW(e,n){return this.normalized&&(n=ds(n,this.array)),this.array[e*this.itemSize+3]=n,this}setXY(e,n,i){return e*=this.itemSize,this.normalized&&(n=ds(n,this.array),i=ds(i,this.array)),this.array[e+0]=n,this.array[e+1]=i,this}setXYZ(e,n,i,s){return e*=this.itemSize,this.normalized&&(n=ds(n,this.array),i=ds(i,this.array),s=ds(s,this.array)),this.array[e+0]=n,this.array[e+1]=i,this.array[e+2]=s,this}setXYZW(e,n,i,s,o){return e*=this.itemSize,this.normalized&&(n=ds(n,this.array),i=ds(i,this.array),s=ds(s,this.array),o=ds(o,this.array)),this.array[e+0]=n,this.array[e+1]=i,this.array[e+2]=s,this.array[e+3]=o,this}onUpload(e){return this.onUploadCallback=e,this}clone(){return new this.constructor(this.array,this.itemSize).copy(this)}toJSON(){const e={itemSize:this.itemSize,type:this.array.constructor.name,array:Array.from(this.array),normalized:this.normalized};return this.name!==""&&(e.name=this.name),this.usage!==_j&&(e.usage=this.usage),e}},LK=class extends Am{constructor(e,n,i){super(new Uint16Array(e),n,i)}},Bme=class extends Am{constructor(e,n,i){super(new Uint32Array(e),n,i)}},ns=class extends Am{constructor(e,n,i){super(new Float32Array(e),n,i)}},Ume=0;const jo=new _t,IP=new Ai,np=new me,ho=new hy,iv=new hy,vi=new me;let Cm=class FK extends BM{constructor(){super(),this.isBufferGeometry=!0,Object.defineProperty(this,"id",{value:Ume++}),this.uuid=Uh(),this.name="",this.type="BufferGeometry",this.index=null,this.attributes={},this.morphAttributes={},this.morphTargetsRelative=!1,this.groups=[],this.boundingBox=null,this.boundingSphere=null,this.drawRange={start:0,count:1/0},this.userData={}}getIndex(){return this.index}setIndex(e){return Array.isArray(e)?this.index=new(wme(e)?Bme:LK)(e,1):this.index=e,this}getAttribute(e){return this.attributes[e]}setAttribute(e,n){return this.attributes[e]=n,this}deleteAttribute(e){return delete this.attributes[e],this}hasAttribute(e){return this.attributes[e]!==void 0}addGroup(e,n,i=0){this.groups.push({start:e,count:n,materialIndex:i})}clearGroups(){this.groups=[]}setDrawRange(e,n){this.drawRange.start=e,this.drawRange.count=n}applyMatrix4(e){const n=this.attributes.position;n!==void 0&&(n.applyMatrix4(e),n.needsUpdate=!0);const i=this.attributes.normal;if(i!==void 0){const o=new zh().getNormalMatrix(e);i.applyNormalMatrix(o),i.needsUpdate=!0}const s=this.attributes.tangent;return s!==void 0&&(s.transformDirection(e),s.needsUpdate=!0),this.boundingBox!==null&&this.computeBoundingBox(),this.boundingSphere!==null&&this.computeBoundingSphere(),this}applyQuaternion(e){return jo.makeRotationFromQuaternion(e),this.applyMatrix4(jo),this}rotateX(e){return jo.makeRotationX(e),this.applyMatrix4(jo),this}rotateY(e){return jo.makeRotationY(e),this.applyMatrix4(jo),this}rotateZ(e){return jo.makeRotationZ(e),this.applyMatrix4(jo),this}translate(e,n,i){return jo.makeTranslation(e,n,i),this.applyMatrix4(jo),this}scale(e,n,i){return jo.makeScale(e,n,i),this.applyMatrix4(jo),this}lookAt(e){return IP.lookAt(e),IP.updateMatrix(),this.applyMatrix4(IP.matrix),this}center(){return this.computeBoundingBox(),this.boundingBox.getCenter(np).negate(),this.translate(np.x,np.y,np.z),this}setFromPoints(e){const n=[];for(let i=0,s=e.length;i<s;i++){const o=e[i];n.push(o.x,o.y,o.z||0)}return this.setAttribute("position",new ns(n,3)),this}computeBoundingBox(){this.boundingBox===null&&(this.boundingBox=new hy);const e=this.attributes.position,n=this.morphAttributes.position;if(e&&e.isGLBufferAttribute){console.error("THREE.BufferGeometry.computeBoundingBox(): GLBufferAttribute requires a manual bounding box.",this),this.boundingBox.set(new me(-1/0,-1/0,-1/0),new me(1/0,1/0,1/0));return}if(e!==void 0){if(this.boundingBox.setFromBufferAttribute(e),n)for(let i=0,s=n.length;i<s;i++){const o=n[i];ho.setFromBufferAttribute(o),this.morphTargetsRelative?(vi.addVectors(this.boundingBox.min,ho.min),this.boundingBox.expandByPoint(vi),vi.addVectors(this.boundingBox.max,ho.max),this.boundingBox.expandByPoint(vi)):(this.boundingBox.expandByPoint(ho.min),this.boundingBox.expandByPoint(ho.max))}}else this.boundingBox.makeEmpty();(isNaN(this.boundingBox.min.x)||isNaN(this.boundingBox.min.y)||isNaN(this.boundingBox.min.z))&&console.error('THREE.BufferGeometry.computeBoundingBox(): Computed min/max have NaN values. The "position" attribute is likely to have NaN values.',this)}computeBoundingSphere(){this.boundingSphere===null&&(this.boundingSphere=new fy);const e=this.attributes.position,n=this.morphAttributes.position;if(e&&e.isGLBufferAttribute){console.error("THREE.BufferGeometry.computeBoundingSphere(): GLBufferAttribute requires a manual bounding sphere.",this),this.boundingSphere.set(new me,1/0);return}if(e){const i=this.boundingSphere.center;if(ho.setFromBufferAttribute(e),n)for(let o=0,a=n.length;o<a;o++){const l=n[o];iv.setFromBufferAttribute(l),this.morphTargetsRelative?(vi.addVectors(ho.min,iv.min),ho.expandByPoint(vi),vi.addVectors(ho.max,iv.max),ho.expandByPoint(vi)):(ho.expandByPoint(iv.min),ho.expandByPoint(iv.max))}ho.getCenter(i);let s=0;for(let o=0,a=e.count;o<a;o++)vi.fromBufferAttribute(e,o),s=Math.max(s,i.distanceToSquared(vi));if(n)for(let o=0,a=n.length;o<a;o++){const l=n[o],c=this.morphTargetsRelative;for(let u=0,h=l.count;u<h;u++)vi.fromBufferAttribute(l,u),c&&(np.fromBufferAttribute(e,u),vi.add(np)),s=Math.max(s,i.distanceToSquared(vi))}this.boundingSphere.radius=Math.sqrt(s),isNaN(this.boundingSphere.radius)&&console.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.',this)}}computeTangents(){const e=this.index,n=this.attributes;if(e===null||n.position===void 0||n.normal===void 0||n.uv===void 0){console.error("THREE.BufferGeometry: .computeTangents() failed. Missing required attributes (index, position, normal or uv)");return}const i=n.position,s=n.normal,o=n.uv;this.hasAttribute("tangent")===!1&&this.setAttribute("tangent",new Am(new Float32Array(4*i.count),4));const a=this.getAttribute("tangent"),l=[],c=[];for(let E=0;E<i.count;E++)l[E]=new me,c[E]=new me;const u=new me,h=new me,f=new me,d=new Er,p=new Er,m=new Er,g=new me,v=new me;function y(E,M,A){u.fromBufferAttribute(i,E),h.fromBufferAttribute(i,M),f.fromBufferAttribute(i,A),d.fromBufferAttribute(o,E),p.fromBufferAttribute(o,M),m.fromBufferAttribute(o,A),h.sub(u),f.sub(u),p.sub(d),m.sub(d);const P=1/(p.x*m.y-m.x*p.y);isFinite(P)&&(g.copy(h).multiplyScalar(m.y).addScaledVector(f,-p.y).multiplyScalar(P),v.copy(f).multiplyScalar(p.x).addScaledVector(h,-m.x).multiplyScalar(P),l[E].add(g),l[M].add(g),l[A].add(g),c[E].add(v),c[M].add(v),c[A].add(v))}let x=this.groups;x.length===0&&(x=[{start:0,count:e.count}]);for(let E=0,M=x.length;E<M;++E){const A=x[E],P=A.start,D=A.count;for(let B=P,C=P+D;B<C;B+=3)y(e.getX(B+0),e.getX(B+1),e.getX(B+2))}const b=new me,w=new me,_=new me,S=new me;function T(E){_.fromBufferAttribute(s,E),S.copy(_);const M=l[E];b.copy(M),b.sub(_.multiplyScalar(_.dot(M))).normalize(),w.crossVectors(S,M);const P=w.dot(c[E])<0?-1:1;a.setXYZW(E,b.x,b.y,b.z,P)}for(let E=0,M=x.length;E<M;++E){const A=x[E],P=A.start,D=A.count;for(let B=P,C=P+D;B<C;B+=3)T(e.getX(B+0)),T(e.getX(B+1)),T(e.getX(B+2))}}computeVertexNormals(){const e=this.index,n=this.getAttribute("position");if(n!==void 0){let i=this.getAttribute("normal");if(i===void 0)i=new Am(new Float32Array(n.count*3),3),this.setAttribute("normal",i);else for(let d=0,p=i.count;d<p;d++)i.setXYZ(d,0,0,0);const s=new me,o=new me,a=new me,l=new me,c=new me,u=new me,h=new me,f=new me;if(e)for(let d=0,p=e.count;d<p;d+=3){const m=e.getX(d+0),g=e.getX(d+1),v=e.getX(d+2);s.fromBufferAttribute(n,m),o.fromBufferAttribute(n,g),a.fromBufferAttribute(n,v),h.subVectors(a,o),f.subVectors(s,o),h.cross(f),l.fromBufferAttribute(i,m),c.fromBufferAttribute(i,g),u.fromBufferAttribute(i,v),l.add(h),c.add(h),u.add(h),i.setXYZ(m,l.x,l.y,l.z),i.setXYZ(g,c.x,c.y,c.z),i.setXYZ(v,u.x,u.y,u.z)}else for(let d=0,p=n.count;d<p;d+=3)s.fromBufferAttribute(n,d+0),o.fromBufferAttribute(n,d+1),a.fromBufferAttribute(n,d+2),h.subVectors(a,o),f.subVectors(s,o),h.cross(f),i.setXYZ(d+0,h.x,h.y,h.z),i.setXYZ(d+1,h.x,h.y,h.z),i.setXYZ(d+2,h.x,h.y,h.z);this.normalizeNormals(),i.needsUpdate=!0}}normalizeNormals(){const e=this.attributes.normal;for(let n=0,i=e.count;n<i;n++)vi.fromBufferAttribute(e,n),vi.normalize(),e.setXYZ(n,vi.x,vi.y,vi.z)}toNonIndexed(){function e(l,c){const u=l.array,h=l.itemSize,f=l.normalized,d=new u.constructor(c.length*h);let p=0,m=0;for(let g=0,v=c.length;g<v;g++){l.isInterleavedBufferAttribute?p=c[g]*l.data.stride+l.offset:p=c[g]*h;for(let y=0;y<h;y++)d[m++]=u[p++]}return new Am(d,h,f)}if(this.index===null)return console.warn("THREE.BufferGeometry.toNonIndexed(): BufferGeometry is already non-indexed."),this;const n=new FK,i=this.index.array,s=this.attributes;for(const l in s){const c=s[l],u=e(c,i);n.setAttribute(l,u)}const o=this.morphAttributes;for(const l in o){const c=[],u=o[l];for(let h=0,f=u.length;h<f;h++){const d=u[h],p=e(d,i);c.push(p)}n.morphAttributes[l]=c}n.morphTargetsRelative=this.morphTargetsRelative;const a=this.groups;for(let l=0,c=a.length;l<c;l++){const u=a[l];n.addGroup(u.start,u.count,u.materialIndex)}return n}toJSON(){const e={metadata:{version:4.6,type:"BufferGeometry",generator:"BufferGeometry.toJSON"}};if(e.uuid=this.uuid,e.type=this.type,this.name!==""&&(e.name=this.name),Object.keys(this.userData).length>0&&(e.userData=this.userData),this.parameters!==void 0){const c=this.parameters;for(const u in c)c[u]!==void 0&&(e[u]=c[u]);return e}e.data={attributes:{}};const n=this.index;n!==null&&(e.data.index={type:n.array.constructor.name,array:Array.prototype.slice.call(n.array)});const i=this.attributes;for(const c in i){const u=i[c];e.data.attributes[c]=u.toJSON(e.data)}const s={};let o=!1;for(const c in this.morphAttributes){const u=this.morphAttributes[c],h=[];for(let f=0,d=u.length;f<d;f++){const p=u[f];h.push(p.toJSON(e.data))}h.length>0&&(s[c]=h,o=!0)}o&&(e.data.morphAttributes=s,e.data.morphTargetsRelative=this.morphTargetsRelative);const a=this.groups;a.length>0&&(e.data.groups=JSON.parse(JSON.stringify(a)));const l=this.boundingSphere;return l!==null&&(e.data.boundingSphere={center:l.center.toArray(),radius:l.radius}),e}clone(){return new this.constructor().copy(this)}copy(e){this.index=null,this.attributes={},this.morphAttributes={},this.groups=[],this.boundingBox=null,this.boundingSphere=null;const n={};this.name=e.name;const i=e.index;i!==null&&this.setIndex(i.clone(n));const s=e.attributes;for(const u in s){const h=s[u];this.setAttribute(u,h.clone(n))}const o=e.morphAttributes;for(const u in o){const h=[],f=o[u];for(let d=0,p=f.length;d<p;d++)h.push(f[d].clone(n));this.morphAttributes[u]=h}this.morphTargetsRelative=e.morphTargetsRelative;const a=e.groups;for(let u=0,h=a.length;u<h;u++){const f=a[u];this.addGroup(f.start,f.count,f.materialIndex)}const l=e.boundingBox;l!==null&&(this.boundingBox=l.clone());const c=e.boundingSphere;return c!==null&&(this.boundingSphere=c.clone()),this.drawRange.start=e.drawRange.start,this.drawRange.count=e.drawRange.count,this.userData=e.userData,this}dispose(){this.dispatchEvent({type:"dispose"})}};const Ij=new _t,rf=new QL,Rw=new fy,Lj=new me,rp=new me,ip=new me,sp=new me,LP=new me,Nw=new me,Ow=new Er,Dw=new Er,kw=new Er,Fj=new me,Bj=new me,Uj=new me,Iw=new me,Lw=new me;let JL=class extends Ai{constructor(e=new Cm,n=new LO){super(),this.isMesh=!0,this.type="Mesh",this.geometry=e,this.material=n,this.updateMorphTargets()}copy(e,n){return super.copy(e,n),e.morphTargetInfluences!==void 0&&(this.morphTargetInfluences=e.morphTargetInfluences.slice()),e.morphTargetDictionary!==void 0&&(this.morphTargetDictionary=Object.assign({},e.morphTargetDictionary)),this.material=Array.isArray(e.material)?e.material.slice():e.material,this.geometry=e.geometry,this}updateMorphTargets(){const n=this.geometry.morphAttributes,i=Object.keys(n);if(i.length>0){const s=n[i[0]];if(s!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let o=0,a=s.length;o<a;o++){const l=s[o].name||String(o);this.morphTargetInfluences.push(0),this.morphTargetDictionary[l]=o}}}}getVertexPosition(e,n){const i=this.geometry,s=i.attributes.position,o=i.morphAttributes.position,a=i.morphTargetsRelative;n.fromBufferAttribute(s,e);const l=this.morphTargetInfluences;if(o&&l){Nw.set(0,0,0);for(let c=0,u=o.length;c<u;c++){const h=l[c],f=o[c];h!==0&&(LP.fromBufferAttribute(f,e),a?Nw.addScaledVector(LP,h):Nw.addScaledVector(LP.sub(n),h))}n.add(Nw)}return n}raycast(e,n){const i=this.geometry,s=this.material,o=this.matrixWorld;s!==void 0&&(i.boundingSphere===null&&i.computeBoundingSphere(),Rw.copy(i.boundingSphere),Rw.applyMatrix4(o),rf.copy(e.ray).recast(e.near),!(Rw.containsPoint(rf.origin)===!1&&(rf.intersectSphere(Rw,Lj)===null||rf.origin.distanceToSquared(Lj)>(e.far-e.near)**2))&&(Ij.copy(o).invert(),rf.copy(e.ray).applyMatrix4(Ij),!(i.boundingBox!==null&&rf.intersectsBox(i.boundingBox)===!1)&&this._computeIntersections(e,n,rf)))}_computeIntersections(e,n,i){let s;const o=this.geometry,a=this.material,l=o.index,c=o.attributes.position,u=o.attributes.uv,h=o.attributes.uv1,f=o.attributes.normal,d=o.groups,p=o.drawRange;if(l!==null)if(Array.isArray(a))for(let m=0,g=d.length;m<g;m++){const v=d[m],y=a[v.materialIndex],x=Math.max(v.start,p.start),b=Math.min(l.count,Math.min(v.start+v.count,p.start+p.count));for(let w=x,_=b;w<_;w+=3){const S=l.getX(w),T=l.getX(w+1),E=l.getX(w+2);s=Fw(this,y,e,i,u,h,f,S,T,E),s&&(s.faceIndex=Math.floor(w/3),s.face.materialIndex=v.materialIndex,n.push(s))}}else{const m=Math.max(0,p.start),g=Math.min(l.count,p.start+p.count);for(let v=m,y=g;v<y;v+=3){const x=l.getX(v),b=l.getX(v+1),w=l.getX(v+2);s=Fw(this,a,e,i,u,h,f,x,b,w),s&&(s.faceIndex=Math.floor(v/3),n.push(s))}}else if(c!==void 0)if(Array.isArray(a))for(let m=0,g=d.length;m<g;m++){const v=d[m],y=a[v.materialIndex],x=Math.max(v.start,p.start),b=Math.min(c.count,Math.min(v.start+v.count,p.start+p.count));for(let w=x,_=b;w<_;w+=3){const S=w,T=w+1,E=w+2;s=Fw(this,y,e,i,u,h,f,S,T,E),s&&(s.faceIndex=Math.floor(w/3),s.face.materialIndex=v.materialIndex,n.push(s))}}else{const m=Math.max(0,p.start),g=Math.min(c.count,p.start+p.count);for(let v=m,y=g;v<y;v+=3){const x=v,b=v+1,w=v+2;s=Fw(this,a,e,i,u,h,f,x,b,w),s&&(s.faceIndex=Math.floor(v/3),n.push(s))}}}};function zme(r,e,n,i,s,o,a,l){let c;if(e.side===Ype?c=i.intersectTriangle(a,o,s,!0,l):c=i.intersectTriangle(s,o,a,e.side===PT,l),c===null)return null;Lw.copy(l),Lw.applyMatrix4(r.matrixWorld);const u=n.ray.origin.distanceTo(Lw);return u<n.near||u>n.far?null:{distance:u,point:Lw.clone(),object:r}}function Fw(r,e,n,i,s,o,a,l,c,u){r.getVertexPosition(l,rp),r.getVertexPosition(c,ip),r.getVertexPosition(u,sp);const h=zme(r,e,n,i,rp,ip,sp,Iw);if(h){s&&(Ow.fromBufferAttribute(s,l),Dw.fromBufferAttribute(s,c),kw.fromBufferAttribute(s,u),h.uv=Aw.getInterpolation(Iw,rp,ip,sp,Ow,Dw,kw,new Er)),o&&(Ow.fromBufferAttribute(o,l),Dw.fromBufferAttribute(o,c),kw.fromBufferAttribute(o,u),h.uv1=Aw.getInterpolation(Iw,rp,ip,sp,Ow,Dw,kw,new Er)),a&&(Fj.fromBufferAttribute(a,l),Bj.fromBufferAttribute(a,c),Uj.fromBufferAttribute(a,u),h.normal=Aw.getInterpolation(Iw,rp,ip,sp,Fj,Bj,Uj,new me),h.normal.dot(i.direction)>0&&h.normal.multiplyScalar(-1));const f={a:l,b:c,c:u,normal:new me,materialIndex:0};Aw.getNormal(rp,ip,sp,f.normal),h.face=f}return h}let BK=class extends Ai{constructor(){super(),this.isCamera=!0,this.type="Camera",this.matrixWorldInverse=new _t,this.projectionMatrix=new _t,this.projectionMatrixInverse=new _t,this.coordinateSystem=Gf}copy(e,n){return super.copy(e,n),this.matrixWorldInverse.copy(e.matrixWorldInverse),this.projectionMatrix.copy(e.projectionMatrix),this.projectionMatrixInverse.copy(e.projectionMatrixInverse),this.coordinateSystem=e.coordinateSystem,this}getWorldDirection(e){return super.getWorldDirection(e).negate()}updateMatrixWorld(e){super.updateMatrixWorld(e),this.matrixWorldInverse.copy(this.matrixWorld).invert()}updateWorldMatrix(e,n){super.updateWorldMatrix(e,n),this.matrixWorldInverse.copy(this.matrixWorld).invert()}clone(){return new this.constructor().copy(this)}};const Ou=new me,zj=new Er,$j=new Er;let Mx=class extends BK{constructor(e=50,n=1,i=.1,s=2e3){super(),this.isPerspectiveCamera=!0,this.type="PerspectiveCamera",this.fov=e,this.zoom=1,this.near=i,this.far=s,this.focus=10,this.aspect=n,this.view=null,this.filmGauge=35,this.filmOffset=0,this.updateProjectionMatrix()}copy(e,n){return super.copy(e,n),this.fov=e.fov,this.zoom=e.zoom,this.near=e.near,this.far=e.far,this.focus=e.focus,this.aspect=e.aspect,this.view=e.view===null?null:Object.assign({},e.view),this.filmGauge=e.filmGauge,this.filmOffset=e.filmOffset,this}setFocalLength(e){const n=.5*this.getFilmHeight()/e;this.fov=Ex*2*Math.atan(n),this.updateProjectionMatrix()}getFocalLength(){const e=Math.tan(N0*.5*this.fov);return .5*this.getFilmHeight()/e}getEffectiveFOV(){return Ex*2*Math.atan(Math.tan(N0*.5*this.fov)/this.zoom)}getFilmWidth(){return this.filmGauge*Math.min(this.aspect,1)}getFilmHeight(){return this.filmGauge/Math.max(this.aspect,1)}getViewBounds(e,n,i){Ou.set(-1,-1,.5).applyMatrix4(this.projectionMatrixInverse),n.set(Ou.x,Ou.y).multiplyScalar(-e/Ou.z),Ou.set(1,1,.5).applyMatrix4(this.projectionMatrixInverse),i.set(Ou.x,Ou.y).multiplyScalar(-e/Ou.z)}getViewSize(e,n){return this.getViewBounds(e,zj,$j),n.subVectors($j,zj)}setViewOffset(e,n,i,s,o,a){this.aspect=e/n,this.view===null&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=n,this.view.offsetX=i,this.view.offsetY=s,this.view.width=o,this.view.height=a,this.updateProjectionMatrix()}clearViewOffset(){this.view!==null&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const e=this.near;let n=e*Math.tan(N0*.5*this.fov)/this.zoom,i=2*n,s=this.aspect*i,o=-.5*s;const a=this.view;if(this.view!==null&&this.view.enabled){const c=a.fullWidth,u=a.fullHeight;o+=a.offsetX*s/c,n-=a.offsetY*i/u,s*=a.width/c,i*=a.height/u}const l=this.filmOffset;l!==0&&(o+=e*l/this.getFilmWidth()),this.projectionMatrix.makePerspective(o,o+s,n,n-i,e,this.far,this.coordinateSystem),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(e){const n=super.toJSON(e);return n.object.fov=this.fov,n.object.zoom=this.zoom,n.object.near=this.near,n.object.far=this.far,n.object.focus=this.focus,n.object.aspect=this.aspect,this.view!==null&&(n.object.view=Object.assign({},this.view)),n.object.filmGauge=this.filmGauge,n.object.filmOffset=this.filmOffset,n}};const FP=new me,$me=new me,jme=new zh;let op=class{constructor(e=new me(1,0,0),n=0){this.isPlane=!0,this.normal=e,this.constant=n}set(e,n){return this.normal.copy(e),this.constant=n,this}setComponents(e,n,i,s){return this.normal.set(e,n,i),this.constant=s,this}setFromNormalAndCoplanarPoint(e,n){return this.normal.copy(e),this.constant=-n.dot(this.normal),this}setFromCoplanarPoints(e,n,i){const s=FP.subVectors(i,n).cross($me.subVectors(e,n)).normalize();return this.setFromNormalAndCoplanarPoint(s,e),this}copy(e){return this.normal.copy(e.normal),this.constant=e.constant,this}normalize(){const e=1/this.normal.length();return this.normal.multiplyScalar(e),this.constant*=e,this}negate(){return this.constant*=-1,this.normal.negate(),this}distanceToPoint(e){return this.normal.dot(e)+this.constant}distanceToSphere(e){return this.distanceToPoint(e.center)-e.radius}projectPoint(e,n){return n.copy(e).addScaledVector(this.normal,-this.distanceToPoint(e))}intersectLine(e,n){const i=e.delta(FP),s=this.normal.dot(i);if(s===0)return this.distanceToPoint(e.start)===0?n.copy(e.start):null;const o=-(e.start.dot(this.normal)+this.constant)/s;return o<0||o>1?null:n.copy(e.start).addScaledVector(i,o)}intersectsLine(e){const n=this.distanceToPoint(e.start),i=this.distanceToPoint(e.end);return n<0&&i>0||i<0&&n>0}intersectsBox(e){return e.intersectsPlane(this)}intersectsSphere(e){return e.intersectsPlane(this)}coplanarPoint(e){return e.copy(this.normal).multiplyScalar(-this.constant)}applyMatrix4(e,n){const i=n||jme.getNormalMatrix(e),s=this.coplanarPoint(FP).applyMatrix4(e),o=this.normal.applyMatrix3(i).normalize();return this.constant=-s.dot(o),this}translate(e){return this.constant-=e.dot(this.normal),this}equals(e){return e.normal.equals(this.normal)&&e.constant===this.constant}clone(){return new this.constructor().copy(this)}};const sf=new fy,Bw=new me;let Vme=class{constructor(e=new op,n=new op,i=new op,s=new op,o=new op,a=new op){this.planes=[e,n,i,s,o,a]}set(e,n,i,s,o,a){const l=this.planes;return l[0].copy(e),l[1].copy(n),l[2].copy(i),l[3].copy(s),l[4].copy(o),l[5].copy(a),this}copy(e){const n=this.planes;for(let i=0;i<6;i++)n[i].copy(e.planes[i]);return this}setFromProjectionMatrix(e,n=Gf){const i=this.planes,s=e.elements,o=s[0],a=s[1],l=s[2],c=s[3],u=s[4],h=s[5],f=s[6],d=s[7],p=s[8],m=s[9],g=s[10],v=s[11],y=s[12],x=s[13],b=s[14],w=s[15];if(i[0].setComponents(c-o,d-u,v-p,w-y).normalize(),i[1].setComponents(c+o,d+u,v+p,w+y).normalize(),i[2].setComponents(c+a,d+h,v+m,w+x).normalize(),i[3].setComponents(c-a,d-h,v-m,w-x).normalize(),i[4].setComponents(c-l,d-f,v-g,w-b).normalize(),n===Gf)i[5].setComponents(c+l,d+f,v+g,w+b).normalize();else if(n===DO)i[5].setComponents(l,f,g,b).normalize();else throw new Error("THREE.Frustum.setFromProjectionMatrix(): Invalid coordinate system: "+n);return this}intersectsObject(e){if(e.boundingSphere!==void 0)e.boundingSphere===null&&e.computeBoundingSphere(),sf.copy(e.boundingSphere).applyMatrix4(e.matrixWorld);else{const n=e.geometry;n.boundingSphere===null&&n.computeBoundingSphere(),sf.copy(n.boundingSphere).applyMatrix4(e.matrixWorld)}return this.intersectsSphere(sf)}intersectsSprite(e){return sf.center.set(0,0,0),sf.radius=.7071067811865476,sf.applyMatrix4(e.matrixWorld),this.intersectsSphere(sf)}intersectsSphere(e){const n=this.planes,i=e.center,s=-e.radius;for(let o=0;o<6;o++)if(n[o].distanceToPoint(i)<s)return!1;return!0}intersectsBox(e){const n=this.planes;for(let i=0;i<6;i++){const s=n[i];if(Bw.x=s.normal.x>0?e.max.x:e.min.x,Bw.y=s.normal.y>0?e.max.y:e.min.y,Bw.z=s.normal.z>0?e.max.z:e.min.z,s.distanceToPoint(Bw)<0)return!1}return!0}containsPoint(e){const n=this.planes;for(let i=0;i<6;i++)if(n[i].distanceToPoint(e)<0)return!1;return!0}clone(){return new this.constructor().copy(this)}},eF=class extends BK{constructor(e=-1,n=1,i=1,s=-1,o=.1,a=2e3){super(),this.isOrthographicCamera=!0,this.type="OrthographicCamera",this.zoom=1,this.view=null,this.left=e,this.right=n,this.top=i,this.bottom=s,this.near=o,this.far=a,this.updateProjectionMatrix()}copy(e,n){return super.copy(e,n),this.left=e.left,this.right=e.right,this.top=e.top,this.bottom=e.bottom,this.near=e.near,this.far=e.far,this.zoom=e.zoom,this.view=e.view===null?null:Object.assign({},e.view),this}setViewOffset(e,n,i,s,o,a){this.view===null&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=n,this.view.offsetX=i,this.view.offsetY=s,this.view.width=o,this.view.height=a,this.updateProjectionMatrix()}clearViewOffset(){this.view!==null&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const e=(this.right-this.left)/(2*this.zoom),n=(this.top-this.bottom)/(2*this.zoom),i=(this.right+this.left)/2,s=(this.top+this.bottom)/2;let o=i-e,a=i+e,l=s+n,c=s-n;if(this.view!==null&&this.view.enabled){const u=(this.right-this.left)/this.view.fullWidth/this.zoom,h=(this.top-this.bottom)/this.view.fullHeight/this.zoom;o+=u*this.view.offsetX,a=o+u*this.view.width,l-=h*this.view.offsetY,c=l-h*this.view.height}this.projectionMatrix.makeOrthographic(o,a,l,c,this.near,this.far,this.coordinateSystem),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(e){const n=super.toJSON(e);return n.object.zoom=this.zoom,n.object.left=this.left,n.object.right=this.right,n.object.top=this.top,n.object.bottom=this.bottom,n.object.near=this.near,n.object.far=this.far,this.view!==null&&(n.object.view=Object.assign({},this.view)),n}},Gme=class extends Gc{constructor(e,n,i,s,o,a,l,c,u,h){if(h=h!==void 0?h:vP,h!==vP&&h!==dj)throw new Error("DepthTexture format must be either THREE.DepthFormat or THREE.DepthStencilFormat");i===void 0&&h===vP&&(i=tme),i===void 0&&h===dj&&(i=nme),super(null,s,o,a,l,c,h,i,u),this.isDepthTexture=!0,this.image={width:e,height:n},this.magFilter=l!==void 0?l:RT,this.minFilter=c!==void 0?c:RT,this.flipY=!1,this.generateMipmaps=!1,this.compareFunction=null}copy(e){return super.copy(e),this.compareFunction=e.compareFunction,this}toJSON(e){const n=super.toJSON(e);return this.compareFunction!==null&&(n.compareFunction=this.compareFunction),n}};const Hme=new Gme(1,1);Hme.compareFunction=sme;let DT=class extends Ai{constructor(){super(),this.isGroup=!0,this.type="Group"}},Wme=class extends Ai{constructor(){super(),this.isScene=!0,this.type="Scene",this.background=null,this.environment=null,this.fog=null,this.backgroundBlurriness=0,this.backgroundIntensity=1,this.backgroundRotation=new Fi,this.environmentIntensity=1,this.environmentRotation=new Fi,this.overrideMaterial=null,typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}copy(e,n){return super.copy(e,n),e.background!==null&&(this.background=e.background.clone()),e.environment!==null&&(this.environment=e.environment.clone()),e.fog!==null&&(this.fog=e.fog.clone()),this.backgroundBlurriness=e.backgroundBlurriness,this.backgroundIntensity=e.backgroundIntensity,this.backgroundRotation.copy(e.backgroundRotation),this.environmentIntensity=e.environmentIntensity,this.environmentRotation.copy(e.environmentRotation),e.overrideMaterial!==null&&(this.overrideMaterial=e.overrideMaterial.clone()),this.matrixAutoUpdate=e.matrixAutoUpdate,this}toJSON(e){const n=super.toJSON(e);return this.fog!==null&&(n.object.fog=this.fog.toJSON()),this.backgroundBlurriness>0&&(n.object.backgroundBlurriness=this.backgroundBlurriness),this.backgroundIntensity!==1&&(n.object.backgroundIntensity=this.backgroundIntensity),n.object.backgroundRotation=this.backgroundRotation.toArray(),this.environmentIntensity!==1&&(n.object.environmentIntensity=this.environmentIntensity),n.object.environmentRotation=this.environmentRotation.toArray(),n}};const jj=new me,Vj=new Hs,Gj=new Hs,qme=new me,Hj=new _t,Uw=new me,BP=new fy,Wj=new _t,UP=new QL;class UK extends JL{constructor(e,n){super(e,n),this.isSkinnedMesh=!0,this.type="SkinnedMesh",this.bindMode=hj,this.bindMatrix=new _t,this.bindMatrixInverse=new _t,this.boundingBox=null,this.boundingSphere=null}computeBoundingBox(){const e=this.geometry;this.boundingBox===null&&(this.boundingBox=new hy),this.boundingBox.makeEmpty();const n=e.getAttribute("position");for(let i=0;i<n.count;i++)this.getVertexPosition(i,Uw),this.boundingBox.expandByPoint(Uw)}computeBoundingSphere(){const e=this.geometry;this.boundingSphere===null&&(this.boundingSphere=new fy),this.boundingSphere.makeEmpty();const n=e.getAttribute("position");for(let i=0;i<n.count;i++)this.getVertexPosition(i,Uw),this.boundingSphere.expandByPoint(Uw)}copy(e,n){return super.copy(e,n),this.bindMode=e.bindMode,this.bindMatrix.copy(e.bindMatrix),this.bindMatrixInverse.copy(e.bindMatrixInverse),this.skeleton=e.skeleton,e.boundingBox!==null&&(this.boundingBox=e.boundingBox.clone()),e.boundingSphere!==null&&(this.boundingSphere=e.boundingSphere.clone()),this}raycast(e,n){const i=this.material,s=this.matrixWorld;i!==void 0&&(this.boundingSphere===null&&this.computeBoundingSphere(),BP.copy(this.boundingSphere),BP.applyMatrix4(s),e.ray.intersectsSphere(BP)!==!1&&(Wj.copy(s).invert(),UP.copy(e.ray).applyMatrix4(Wj),!(this.boundingBox!==null&&UP.intersectsBox(this.boundingBox)===!1)&&this._computeIntersections(e,n,UP)))}getVertexPosition(e,n){return super.getVertexPosition(e,n),this.applyBoneTransform(e,n),n}bind(e,n){this.skeleton=e,n===void 0&&(this.updateMatrixWorld(!0),this.skeleton.calculateInverses(),n=this.matrixWorld),this.bindMatrix.copy(n),this.bindMatrixInverse.copy(n).invert()}pose(){this.skeleton.pose()}normalizeSkinWeights(){const e=new Hs,n=this.geometry.attributes.skinWeight;for(let i=0,s=n.count;i<s;i++){e.fromBufferAttribute(n,i);const o=1/e.manhattanLength();o!==1/0?e.multiplyScalar(o):e.set(1,0,0,0),n.setXYZW(i,e.x,e.y,e.z,e.w)}}updateMatrixWorld(e){super.updateMatrixWorld(e),this.bindMode===hj?this.bindMatrixInverse.copy(this.matrixWorld).invert():this.bindMode===Qpe?this.bindMatrixInverse.copy(this.bindMatrix).invert():console.warn("THREE.SkinnedMesh: Unrecognized bindMode: "+this.bindMode)}applyBoneTransform(e,n){const i=this.skeleton,s=this.geometry;Vj.fromBufferAttribute(s.attributes.skinIndex,e),Gj.fromBufferAttribute(s.attributes.skinWeight,e),jj.copy(n).applyMatrix4(this.bindMatrix),n.set(0,0,0);for(let o=0;o<4;o++){const a=Gj.getComponent(o);if(a!==0){const l=Vj.getComponent(o);Hj.multiplyMatrices(i.bones[l].matrixWorld,i.boneInverses[l]),n.addScaledVector(qme.copy(jj).applyMatrix4(Hj),a)}}return n.applyMatrix4(this.bindMatrixInverse)}}class kT extends Ai{constructor(){super(),this.isBone=!0,this.type="Bone"}}let zK=class extends Gc{constructor(e=null,n=1,i=1,s,o,a,l,c,u=RT,h=RT,f,d){super(null,a,l,c,u,h,s,o,f,d),this.isDataTexture=!0,this.image={data:e,width:n,height:i},this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}};const qj=new _t,Xme=new _t;class zM{constructor(e=[],n=[]){this.uuid=Uh(),this.bones=e.slice(0),this.boneInverses=n,this.boneMatrices=null,this.boneTexture=null,this.init()}init(){const e=this.bones,n=this.boneInverses;if(this.boneMatrices=new Float32Array(e.length*16),n.length===0)this.calculateInverses();else if(e.length!==n.length){console.warn("THREE.Skeleton: Number of inverse bone matrices does not match amount of bones."),this.boneInverses=[];for(let i=0,s=this.bones.length;i<s;i++)this.boneInverses.push(new _t)}}calculateInverses(){this.boneInverses.length=0;for(let e=0,n=this.bones.length;e<n;e++){const i=new _t;this.bones[e]&&i.copy(this.bones[e].matrixWorld).invert(),this.boneInverses.push(i)}}pose(){for(let e=0,n=this.bones.length;e<n;e++){const i=this.bones[e];i&&i.matrixWorld.copy(this.boneInverses[e]).invert()}for(let e=0,n=this.bones.length;e<n;e++){const i=this.bones[e];i&&(i.parent&&i.parent.isBone?(i.matrix.copy(i.parent.matrixWorld).invert(),i.matrix.multiply(i.matrixWorld)):i.matrix.copy(i.matrixWorld),i.matrix.decompose(i.position,i.quaternion,i.scale))}}update(){const e=this.bones,n=this.boneInverses,i=this.boneMatrices,s=this.boneTexture;for(let o=0,a=e.length;o<a;o++){const l=e[o]?e[o].matrixWorld:Xme;qj.multiplyMatrices(l,n[o]),qj.toArray(i,o*16)}s!==null&&(s.needsUpdate=!0)}clone(){return new zM(this.bones,this.boneInverses)}computeBoneTexture(){let e=Math.sqrt(this.bones.length*4);e=Math.ceil(e/4)*4,e=Math.max(e,4);const n=new Float32Array(e*e*4);n.set(this.boneMatrices);const i=new zK(n,e,e,MK,EK);return i.needsUpdate=!0,this.boneMatrices=n,this.boneTexture=i,this}getBoneByName(e){for(let n=0,i=this.bones.length;n<i;n++){const s=this.bones[n];if(s.name===e)return s}}dispose(){this.boneTexture!==null&&(this.boneTexture.dispose(),this.boneTexture=null)}fromJSON(e,n){this.uuid=e.uuid;for(let i=0,s=e.bones.length;i<s;i++){const o=e.bones[i];let a=n[o];a===void 0&&(console.warn("THREE.Skeleton: No bone found with UUID:",o),a=new kT),this.bones.push(a),this.boneInverses.push(new _t().fromArray(e.boneInverses[i]))}return this.init(),this}toJSON(){const e={metadata:{version:4.6,type:"Skeleton",generator:"Skeleton.toJSON"},bones:[],boneInverses:[]};e.uuid=this.uuid;const n=this.bones,i=this.boneInverses;for(let s=0,o=n.length;s<o;s++){const a=n[s];e.bones.push(a.uuid);const l=i[s];e.boneInverses.push(l.toArray())}return e}}let IT=class extends UM{constructor(e){super(),this.isLineBasicMaterial=!0,this.type="LineBasicMaterial",this.color=new wr(16777215),this.map=null,this.linewidth=1,this.linecap="round",this.linejoin="round",this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.linewidth=e.linewidth,this.linecap=e.linecap,this.linejoin=e.linejoin,this.fog=e.fog,this}};const LT=new me,FT=new me,Xj=new _t,sv=new QL,zw=new fy,zP=new me,Kj=new me;let tF=class extends Ai{constructor(e=new Cm,n=new IT){super(),this.isLine=!0,this.type="Line",this.geometry=e,this.material=n,this.updateMorphTargets()}copy(e,n){return super.copy(e,n),this.material=Array.isArray(e.material)?e.material.slice():e.material,this.geometry=e.geometry,this}computeLineDistances(){const e=this.geometry;if(e.index===null){const n=e.attributes.position,i=[0];for(let s=1,o=n.count;s<o;s++)LT.fromBufferAttribute(n,s-1),FT.fromBufferAttribute(n,s),i[s]=i[s-1],i[s]+=LT.distanceTo(FT);e.setAttribute("lineDistance",new ns(i,1))}else console.warn("THREE.Line.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");return this}raycast(e,n){const i=this.geometry,s=this.matrixWorld,o=e.params.Line.threshold,a=i.drawRange;if(i.boundingSphere===null&&i.computeBoundingSphere(),zw.copy(i.boundingSphere),zw.applyMatrix4(s),zw.radius+=o,e.ray.intersectsSphere(zw)===!1)return;Xj.copy(s).invert(),sv.copy(e.ray).applyMatrix4(Xj);const l=o/((this.scale.x+this.scale.y+this.scale.z)/3),c=l*l,u=this.isLineSegments?2:1,h=i.index,d=i.attributes.position;if(h!==null){const p=Math.max(0,a.start),m=Math.min(h.count,a.start+a.count);for(let g=p,v=m-1;g<v;g+=u){const y=h.getX(g),x=h.getX(g+1),b=$w(this,e,sv,c,y,x);b&&n.push(b)}if(this.isLineLoop){const g=h.getX(m-1),v=h.getX(p),y=$w(this,e,sv,c,g,v);y&&n.push(y)}}else{const p=Math.max(0,a.start),m=Math.min(d.count,a.start+a.count);for(let g=p,v=m-1;g<v;g+=u){const y=$w(this,e,sv,c,g,g+1);y&&n.push(y)}if(this.isLineLoop){const g=$w(this,e,sv,c,m-1,p);g&&n.push(g)}}}updateMorphTargets(){const n=this.geometry.morphAttributes,i=Object.keys(n);if(i.length>0){const s=n[i[0]];if(s!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let o=0,a=s.length;o<a;o++){const l=s[o].name||String(o);this.morphTargetInfluences.push(0),this.morphTargetDictionary[l]=o}}}}};function $w(r,e,n,i,s,o){const a=r.geometry.attributes.position;if(LT.fromBufferAttribute(a,s),FT.fromBufferAttribute(a,o),n.distanceSqToSegment(LT,FT,zP,Kj)>i)return;zP.applyMatrix4(r.matrixWorld);const c=e.ray.origin.distanceTo(zP);if(!(c<e.near||c>e.far))return{distance:c,point:Kj.clone().applyMatrix4(r.matrixWorld),index:s,face:null,faceIndex:null,object:r}}const Yj=new me,Zj=new me;class Kme extends tF{constructor(e,n){super(e,n),this.isLineSegments=!0,this.type="LineSegments"}computeLineDistances(){const e=this.geometry;if(e.index===null){const n=e.attributes.position,i=[];for(let s=0,o=n.count;s<o;s+=2)Yj.fromBufferAttribute(n,s),Zj.fromBufferAttribute(n,s+1),i[s]=s===0?0:i[s-1],i[s+1]=i[s]+Yj.distanceTo(Zj);e.setAttribute("lineDistance",new ns(i,1))}else console.warn("THREE.LineSegments.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");return this}}let Yme=class{constructor(){this.type="Curve",this.arcLengthDivisions=200}getPoint(){return console.warn("THREE.Curve: .getPoint() not implemented."),null}getPointAt(e,n){const i=this.getUtoTmapping(e);return this.getPoint(i,n)}getPoints(e=5){const n=[];for(let i=0;i<=e;i++)n.push(this.getPoint(i/e));return n}getSpacedPoints(e=5){const n=[];for(let i=0;i<=e;i++)n.push(this.getPointAt(i/e));return n}getLength(){const e=this.getLengths();return e[e.length-1]}getLengths(e=this.arcLengthDivisions){if(this.cacheArcLengths&&this.cacheArcLengths.length===e+1&&!this.needsUpdate)return this.cacheArcLengths;this.needsUpdate=!1;const n=[];let i,s=this.getPoint(0),o=0;n.push(0);for(let a=1;a<=e;a++)i=this.getPoint(a/e),o+=i.distanceTo(s),n.push(o),s=i;return this.cacheArcLengths=n,n}updateArcLengths(){this.needsUpdate=!0,this.getLengths()}getUtoTmapping(e,n){const i=this.getLengths();let s=0;const o=i.length;let a;n?a=n:a=e*i[o-1];let l=0,c=o-1,u;for(;l<=c;)if(s=Math.floor(l+(c-l)/2),u=i[s]-a,u<0)l=s+1;else if(u>0)c=s-1;else{c=s;break}if(s=c,i[s]===a)return s/(o-1);const h=i[s],d=i[s+1]-h,p=(a-h)/d;return(s+p)/(o-1)}getTangent(e,n){let s=e-1e-4,o=e+1e-4;s<0&&(s=0),o>1&&(o=1);const a=this.getPoint(s),l=this.getPoint(o),c=n||(a.isVector2?new Er:new me);return c.copy(l).sub(a).normalize(),c}getTangentAt(e,n){const i=this.getUtoTmapping(e);return this.getTangent(i,n)}computeFrenetFrames(e,n){const i=new me,s=[],o=[],a=[],l=new me,c=new _t;for(let p=0;p<=e;p++){const m=p/e;s[p]=this.getTangentAt(m,new me)}o[0]=new me,a[0]=new me;let u=Number.MAX_VALUE;const h=Math.abs(s[0].x),f=Math.abs(s[0].y),d=Math.abs(s[0].z);h<=u&&(u=h,i.set(1,0,0)),f<=u&&(u=f,i.set(0,1,0)),d<=u&&i.set(0,0,1),l.crossVectors(s[0],i).normalize(),o[0].crossVectors(s[0],l),a[0].crossVectors(s[0],o[0]);for(let p=1;p<=e;p++){if(o[p]=o[p-1].clone(),a[p]=a[p-1].clone(),l.crossVectors(s[p-1],s[p]),l.length()>Number.EPSILON){l.normalize();const m=Math.acos(Li(s[p-1].dot(s[p]),-1,1));o[p].applyMatrix4(c.makeRotationAxis(l,m))}a[p].crossVectors(s[p],o[p])}if(n===!0){let p=Math.acos(Li(o[0].dot(o[e]),-1,1));p/=e,s[0].dot(l.crossVectors(o[0],o[e]))>0&&(p=-p);for(let m=1;m<=e;m++)o[m].applyMatrix4(c.makeRotationAxis(s[m],p*m)),a[m].crossVectors(s[m],o[m])}return{tangents:s,normals:o,binormals:a}}clone(){return new this.constructor().copy(this)}copy(e){return this.arcLengthDivisions=e.arcLengthDivisions,this}toJSON(){const e={metadata:{version:4.6,type:"Curve",generator:"Curve.toJSON"}};return e.arcLengthDivisions=this.arcLengthDivisions,e.type=this.type,e}fromJSON(e){return this.arcLengthDivisions=e.arcLengthDivisions,this}};const Zme={triangulate:function(r,e,n=2){const i=e&&e.length,s=i?e[0]*n:r.length;let o=$K(r,0,s,n,!0);const a=[];if(!o||o.next===o.prev)return a;let l,c,u,h,f,d,p;if(i&&(o=nge(r,e,o,n)),r.length>80*n){l=u=r[0],c=h=r[1];for(let m=n;m<s;m+=n)f=r[m],d=r[m+1],f<l&&(l=f),d<c&&(c=d),f>u&&(u=f),d>h&&(h=d);p=Math.max(u-l,h-c),p=p!==0?32767/p:0}return Ax(o,a,n,l,c,p,0),a}};function $K(r,e,n,i,s){let o,a;if(s===dge(r,e,n,i)>0)for(o=e;o<n;o+=i)a=Qj(o,r[o],r[o+1],a);else for(o=n-i;o>=e;o-=i)a=Qj(o,r[o],r[o+1],a);return a&&$M(a,a.next)&&(Px(a),a=a.next),a}function hd(r,e){if(!r)return r;e||(e=r);let n=r,i;do if(i=!1,!n.steiner&&($M(n,n.next)||mr(n.prev,n,n.next)===0)){if(Px(n),n=e=n.prev,n===n.next)break;i=!0}else n=n.next;while(i||n!==e);return e}function Ax(r,e,n,i,s,o,a){if(!r)return;!a&&o&&age(r,i,s,o);let l=r,c,u;for(;r.prev!==r.next;){if(c=r.prev,u=r.next,o?Jme(r,i,s,o):Qme(r)){e.push(c.i/n|0),e.push(r.i/n|0),e.push(u.i/n|0),Px(r),r=u.next,l=u.next;continue}if(r=u,r===l){a?a===1?(r=ege(hd(r),e,n),Ax(r,e,n,i,s,o,2)):a===2&&tge(r,e,n,i,s,o):Ax(hd(r),e,n,i,s,o,1);break}}}function Qme(r){const e=r.prev,n=r,i=r.next;if(mr(e,n,i)>=0)return!1;const s=e.x,o=n.x,a=i.x,l=e.y,c=n.y,u=i.y,h=s<o?s<a?s:a:o<a?o:a,f=l<c?l<u?l:u:c<u?c:u,d=s>o?s>a?s:a:o>a?o:a,p=l>c?l>u?l:u:c>u?c:u;let m=i.next;for(;m!==e;){if(m.x>=h&&m.x<=d&&m.y>=f&&m.y<=p&&im(s,l,o,c,a,u,m.x,m.y)&&mr(m.prev,m,m.next)>=0)return!1;m=m.next}return!0}function Jme(r,e,n,i){const s=r.prev,o=r,a=r.next;if(mr(s,o,a)>=0)return!1;const l=s.x,c=o.x,u=a.x,h=s.y,f=o.y,d=a.y,p=l<c?l<u?l:u:c<u?c:u,m=h<f?h<d?h:d:f<d?f:d,g=l>c?l>u?l:u:c>u?c:u,v=h>f?h>d?h:d:f>d?f:d,y=FO(p,m,e,n,i),x=FO(g,v,e,n,i);let b=r.prevZ,w=r.nextZ;for(;b&&b.z>=y&&w&&w.z<=x;){if(b.x>=p&&b.x<=g&&b.y>=m&&b.y<=v&&b!==s&&b!==a&&im(l,h,c,f,u,d,b.x,b.y)&&mr(b.prev,b,b.next)>=0||(b=b.prevZ,w.x>=p&&w.x<=g&&w.y>=m&&w.y<=v&&w!==s&&w!==a&&im(l,h,c,f,u,d,w.x,w.y)&&mr(w.prev,w,w.next)>=0))return!1;w=w.nextZ}for(;b&&b.z>=y;){if(b.x>=p&&b.x<=g&&b.y>=m&&b.y<=v&&b!==s&&b!==a&&im(l,h,c,f,u,d,b.x,b.y)&&mr(b.prev,b,b.next)>=0)return!1;b=b.prevZ}for(;w&&w.z<=x;){if(w.x>=p&&w.x<=g&&w.y>=m&&w.y<=v&&w!==s&&w!==a&&im(l,h,c,f,u,d,w.x,w.y)&&mr(w.prev,w,w.next)>=0)return!1;w=w.nextZ}return!0}function ege(r,e,n){let i=r;do{const s=i.prev,o=i.next.next;!$M(s,o)&&jK(s,i,i.next,o)&&Cx(s,o)&&Cx(o,s)&&(e.push(s.i/n|0),e.push(i.i/n|0),e.push(o.i/n|0),Px(i),Px(i.next),i=r=o),i=i.next}while(i!==r);return hd(i)}function tge(r,e,n,i,s,o){let a=r;do{let l=a.next.next;for(;l!==a.prev;){if(a.i!==l.i&&uge(a,l)){let c=VK(a,l);a=hd(a,a.next),c=hd(c,c.next),Ax(a,e,n,i,s,o,0),Ax(c,e,n,i,s,o,0);return}l=l.next}a=a.next}while(a!==r)}function nge(r,e,n,i){const s=[];let o,a,l,c,u;for(o=0,a=e.length;o<a;o++)l=e[o]*i,c=o<a-1?e[o+1]*i:r.length,u=$K(r,l,c,i,!1),u===u.next&&(u.steiner=!0),s.push(cge(u));for(s.sort(rge),o=0;o<s.length;o++)n=ige(s[o],n);return n}function rge(r,e){return r.x-e.x}function ige(r,e){const n=sge(r,e);if(!n)return e;const i=VK(n,r);return hd(i,i.next),hd(n,n.next)}function sge(r,e){let n=e,i=-1/0,s;const o=r.x,a=r.y;do{if(a<=n.y&&a>=n.next.y&&n.next.y!==n.y){const d=n.x+(a-n.y)*(n.next.x-n.x)/(n.next.y-n.y);if(d<=o&&d>i&&(i=d,s=n.x<n.next.x?n:n.next,d===o))return s}n=n.next}while(n!==e);if(!s)return null;const l=s,c=s.x,u=s.y;let h=1/0,f;n=s;do o>=n.x&&n.x>=c&&o!==n.x&&im(a<u?o:i,a,c,u,a<u?i:o,a,n.x,n.y)&&(f=Math.abs(a-n.y)/(o-n.x),Cx(n,r)&&(f<h||f===h&&(n.x>s.x||n.x===s.x&&oge(s,n)))&&(s=n,h=f)),n=n.next;while(n!==l);return s}function oge(r,e){return mr(r.prev,r,e.prev)<0&&mr(e.next,r,r.next)<0}function age(r,e,n,i){let s=r;do s.z===0&&(s.z=FO(s.x,s.y,e,n,i)),s.prevZ=s.prev,s.nextZ=s.next,s=s.next;while(s!==r);s.prevZ.nextZ=null,s.prevZ=null,lge(s)}function lge(r){let e,n,i,s,o,a,l,c,u=1;do{for(n=r,r=null,o=null,a=0;n;){for(a++,i=n,l=0,e=0;e<u&&(l++,i=i.nextZ,!!i);e++);for(c=u;l>0||c>0&&i;)l!==0&&(c===0||!i||n.z<=i.z)?(s=n,n=n.nextZ,l--):(s=i,i=i.nextZ,c--),o?o.nextZ=s:r=s,s.prevZ=o,o=s;n=i}o.nextZ=null,u*=2}while(a>1);return r}function FO(r,e,n,i,s){return r=(r-n)*s|0,e=(e-i)*s|0,r=(r|r<<8)&16711935,r=(r|r<<4)&252645135,r=(r|r<<2)&858993459,r=(r|r<<1)&1431655765,e=(e|e<<8)&16711935,e=(e|e<<4)&252645135,e=(e|e<<2)&858993459,e=(e|e<<1)&1431655765,r|e<<1}function cge(r){let e=r,n=r;do(e.x<n.x||e.x===n.x&&e.y<n.y)&&(n=e),e=e.next;while(e!==r);return n}function im(r,e,n,i,s,o,a,l){return(s-a)*(e-l)>=(r-a)*(o-l)&&(r-a)*(i-l)>=(n-a)*(e-l)&&(n-a)*(o-l)>=(s-a)*(i-l)}function uge(r,e){return r.next.i!==e.i&&r.prev.i!==e.i&&!hge(r,e)&&(Cx(r,e)&&Cx(e,r)&&fge(r,e)&&(mr(r.prev,r,e.prev)||mr(r,e.prev,e))||$M(r,e)&&mr(r.prev,r,r.next)>0&&mr(e.prev,e,e.next)>0)}function mr(r,e,n){return(e.y-r.y)*(n.x-e.x)-(e.x-r.x)*(n.y-e.y)}function $M(r,e){return r.x===e.x&&r.y===e.y}function jK(r,e,n,i){const s=Vw(mr(r,e,n)),o=Vw(mr(r,e,i)),a=Vw(mr(n,i,r)),l=Vw(mr(n,i,e));return!!(s!==o&&a!==l||s===0&&jw(r,n,e)||o===0&&jw(r,i,e)||a===0&&jw(n,r,i)||l===0&&jw(n,e,i))}function jw(r,e,n){return e.x<=Math.max(r.x,n.x)&&e.x>=Math.min(r.x,n.x)&&e.y<=Math.max(r.y,n.y)&&e.y>=Math.min(r.y,n.y)}function Vw(r){return r>0?1:r<0?-1:0}function hge(r,e){let n=r;do{if(n.i!==r.i&&n.next.i!==r.i&&n.i!==e.i&&n.next.i!==e.i&&jK(n,n.next,r,e))return!0;n=n.next}while(n!==r);return!1}function Cx(r,e){return mr(r.prev,r,r.next)<0?mr(r,e,r.next)>=0&&mr(r,r.prev,e)>=0:mr(r,e,r.prev)<0||mr(r,r.next,e)<0}function fge(r,e){let n=r,i=!1;const s=(r.x+e.x)/2,o=(r.y+e.y)/2;do n.y>o!=n.next.y>o&&n.next.y!==n.y&&s<(n.next.x-n.x)*(o-n.y)/(n.next.y-n.y)+n.x&&(i=!i),n=n.next;while(n!==r);return i}function VK(r,e){const n=new BO(r.i,r.x,r.y),i=new BO(e.i,e.x,e.y),s=r.next,o=e.prev;return r.next=e,e.prev=r,n.next=s,s.prev=n,i.next=n,n.prev=i,o.next=i,i.prev=o,i}function Qj(r,e,n,i){const s=new BO(r,e,n);return i?(s.next=i.next,s.prev=i,i.next.prev=s,i.next=s):(s.prev=s,s.next=s),s}function Px(r){r.next.prev=r.prev,r.prev.next=r.next,r.prevZ&&(r.prevZ.nextZ=r.nextZ),r.nextZ&&(r.nextZ.prevZ=r.prevZ)}function BO(r,e,n){this.i=r,this.x=e,this.y=n,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}function dge(r,e,n,i){let s=0;for(let o=e,a=n-i;o<n;o+=i)s+=(r[a]-r[o])*(r[o+1]+r[a+1]),a=o;return s}class nF{static area(e){const n=e.length;let i=0;for(let s=n-1,o=0;o<n;s=o++)i+=e[s].x*e[o].y-e[o].x*e[s].y;return i*.5}static isClockWise(e){return nF.area(e)<0}static triangulateShape(e,n){const i=[],s=[],o=[];Jj(e),eV(i,e);let a=e.length;n.forEach(Jj);for(let c=0;c<n.length;c++)s.push(a),a+=n[c].length,eV(i,n[c]);const l=Zme.triangulate(i,s);for(let c=0;c<l.length;c+=3)o.push(l.slice(c,c+3));return o}}function Jj(r){const e=r.length;e>2&&r[e-1].equals(r[0])&&r.pop()}function eV(r,e){for(let n=0;n<e.length;n++)r.push(e[n].x),r.push(e[n].y)}let D0=class extends UM{constructor(e){super(),this.isMeshPhongMaterial=!0,this.type="MeshPhongMaterial",this.color=new wr(16777215),this.specular=new wr(1118481),this.shininess=30,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new wr(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=AK,this.normalScale=new Er(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.envMapRotation=new Fi,this.combine=XL,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.specular.copy(e.specular),this.shininess=e.shininess,this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.envMapRotation.copy(e.envMapRotation),this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.flatShading=e.flatShading,this.fog=e.fog,this}},GK=class extends UM{constructor(e){super(),this.isMeshLambertMaterial=!0,this.type="MeshLambertMaterial",this.color=new wr(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new wr(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=AK,this.normalScale=new Er(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.envMapRotation=new Fi,this.combine=XL,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.envMapRotation.copy(e.envMapRotation),this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.flatShading=e.flatShading,this.fog=e.fog,this}};function Gw(r,e,n){return!r||!n&&r.constructor===e?r:typeof e.BYTES_PER_ELEMENT=="number"?new e(r):Array.prototype.slice.call(r)}function pge(r){return ArrayBuffer.isView(r)&&!(r instanceof DataView)}function mge(r){function e(s,o){return r[s]-r[o]}const n=r.length,i=new Array(n);for(let s=0;s!==n;++s)i[s]=s;return i.sort(e),i}function tV(r,e,n){const i=r.length,s=new r.constructor(i);for(let o=0,a=0;a!==i;++o){const l=n[o]*e;for(let c=0;c!==e;++c)s[a++]=r[l+c]}return s}function HK(r,e,n,i){let s=1,o=r[0];for(;o!==void 0&&o[i]===void 0;)o=r[s++];if(o===void 0)return;let a=o[i];if(a!==void 0)if(Array.isArray(a))do a=o[i],a!==void 0&&(e.push(o.time),n.push.apply(n,a)),o=r[s++];while(o!==void 0);else if(a.toArray!==void 0)do a=o[i],a!==void 0&&(e.push(o.time),a.toArray(n,n.length)),o=r[s++];while(o!==void 0);else do a=o[i],a!==void 0&&(e.push(o.time),n.push(a)),o=r[s++];while(o!==void 0)}class jM{constructor(e,n,i,s){this.parameterPositions=e,this._cachedIndex=0,this.resultBuffer=s!==void 0?s:new n.constructor(i),this.sampleValues=n,this.valueSize=i,this.settings=null,this.DefaultSettings_={}}evaluate(e){const n=this.parameterPositions;let i=this._cachedIndex,s=n[i],o=n[i-1];e:{t:{let a;n:{r:if(!(e<s)){for(let l=i+2;;){if(s===void 0){if(e<o)break r;return i=n.length,this._cachedIndex=i,this.copySampleValue_(i-1)}if(i===l)break;if(o=s,s=n[++i],e<s)break t}a=n.length;break n}if(!(e>=o)){const l=n[1];e<l&&(i=2,o=l);for(let c=i-2;;){if(o===void 0)return this._cachedIndex=0,this.copySampleValue_(0);if(i===c)break;if(s=o,o=n[--i-1],e>=o)break t}a=i,i=0;break n}break e}for(;i<a;){const l=i+a>>>1;e<n[l]?a=l:i=l+1}if(s=n[i],o=n[i-1],o===void 0)return this._cachedIndex=0,this.copySampleValue_(0);if(s===void 0)return i=n.length,this._cachedIndex=i,this.copySampleValue_(i-1)}this._cachedIndex=i,this.intervalChanged_(i,o,s)}return this.interpolate_(i,o,e,s)}getSettings_(){return this.settings||this.DefaultSettings_}copySampleValue_(e){const n=this.resultBuffer,i=this.sampleValues,s=this.valueSize,o=e*s;for(let a=0;a!==s;++a)n[a]=i[o+a];return n}interpolate_(){throw new Error("call to abstract method")}intervalChanged_(){}}class gge extends jM{constructor(e,n,i,s){super(e,n,i,s),this._weightPrev=-0,this._offsetPrev=-0,this._weightNext=-0,this._offsetNext=-0,this.DefaultSettings_={endingStart:pj,endingEnd:pj}}intervalChanged_(e,n,i){const s=this.parameterPositions;let o=e-2,a=e+1,l=s[o],c=s[a];if(l===void 0)switch(this.getSettings_().endingStart){case mj:o=e,l=2*n-i;break;case gj:o=s.length-2,l=n+s[o]-s[o+1];break;default:o=e,l=i}if(c===void 0)switch(this.getSettings_().endingEnd){case mj:a=e,c=2*i-n;break;case gj:a=1,c=i+s[1]-s[0];break;default:a=e-1,c=n}const u=(i-n)*.5,h=this.valueSize;this._weightPrev=u/(n-l),this._weightNext=u/(c-i),this._offsetPrev=o*h,this._offsetNext=a*h}interpolate_(e,n,i,s){const o=this.resultBuffer,a=this.sampleValues,l=this.valueSize,c=e*l,u=c-l,h=this._offsetPrev,f=this._offsetNext,d=this._weightPrev,p=this._weightNext,m=(i-n)/(s-n),g=m*m,v=g*m,y=-d*v+2*d*g-d*m,x=(1+d)*v+(-1.5-2*d)*g+(-.5+d)*m+1,b=(-1-p)*v+(1.5+p)*g+.5*m,w=p*v-p*g;for(let _=0;_!==l;++_)o[_]=y*a[h+_]+x*a[u+_]+b*a[c+_]+w*a[f+_];return o}}class yge extends jM{constructor(e,n,i,s){super(e,n,i,s)}interpolate_(e,n,i,s){const o=this.resultBuffer,a=this.sampleValues,l=this.valueSize,c=e*l,u=c-l,h=(i-n)/(s-n),f=1-h;for(let d=0;d!==l;++d)o[d]=a[u+d]*f+a[c+d]*h;return o}}class vge extends jM{constructor(e,n,i,s){super(e,n,i,s)}interpolate_(e){return this.copySampleValue_(e-1)}}class Gl{constructor(e,n,i,s){if(e===void 0)throw new Error("THREE.KeyframeTrack: track name is undefined");if(n===void 0||n.length===0)throw new Error("THREE.KeyframeTrack: no keyframes in track named "+e);this.name=e,this.times=Gw(n,this.TimeBufferType),this.values=Gw(i,this.ValueBufferType),this.setInterpolation(s||this.DefaultInterpolation)}static toJSON(e){const n=e.constructor;let i;if(n.toJSON!==this.toJSON)i=n.toJSON(e);else{i={name:e.name,times:Gw(e.times,Array),values:Gw(e.values,Array)};const s=e.getInterpolation();s!==e.DefaultInterpolation&&(i.interpolation=s)}return i.type=e.ValueTypeName,i}InterpolantFactoryMethodDiscrete(e){return new vge(this.times,this.values,this.getValueSize(),e)}InterpolantFactoryMethodLinear(e){return new yge(this.times,this.values,this.getValueSize(),e)}InterpolantFactoryMethodSmooth(e){return new gge(this.times,this.values,this.getValueSize(),e)}setInterpolation(e){let n;switch(e){case NT:n=this.InterpolantFactoryMethodDiscrete;break;case OT:n=this.InterpolantFactoryMethodLinear;break;case xP:n=this.InterpolantFactoryMethodSmooth;break}if(n===void 0){const i="unsupported interpolation for "+this.ValueTypeName+" keyframe track named "+this.name;if(this.createInterpolant===void 0)if(e!==this.DefaultInterpolation)this.setInterpolation(this.DefaultInterpolation);else throw new Error(i);return console.warn("THREE.KeyframeTrack:",i),this}return this.createInterpolant=n,this}getInterpolation(){switch(this.createInterpolant){case this.InterpolantFactoryMethodDiscrete:return NT;case this.InterpolantFactoryMethodLinear:return OT;case this.InterpolantFactoryMethodSmooth:return xP}}getValueSize(){return this.values.length/this.times.length}shift(e){if(e!==0){const n=this.times;for(let i=0,s=n.length;i!==s;++i)n[i]+=e}return this}scale(e){if(e!==1){const n=this.times;for(let i=0,s=n.length;i!==s;++i)n[i]*=e}return this}trim(e,n){const i=this.times,s=i.length;let o=0,a=s-1;for(;o!==s&&i[o]<e;)++o;for(;a!==-1&&i[a]>n;)--a;if(++a,o!==0||a!==s){o>=a&&(a=Math.max(a,1),o=a-1);const l=this.getValueSize();this.times=i.slice(o,a),this.values=this.values.slice(o*l,a*l)}return this}validate(){let e=!0;const n=this.getValueSize();n-Math.floor(n)!==0&&(console.error("THREE.KeyframeTrack: Invalid value size in track.",this),e=!1);const i=this.times,s=this.values,o=i.length;o===0&&(console.error("THREE.KeyframeTrack: Track is empty.",this),e=!1);let a=null;for(let l=0;l!==o;l++){const c=i[l];if(typeof c=="number"&&isNaN(c)){console.error("THREE.KeyframeTrack: Time is not a valid number.",this,l,c),e=!1;break}if(a!==null&&a>c){console.error("THREE.KeyframeTrack: Out of order keys.",this,l,c,a),e=!1;break}a=c}if(s!==void 0&&pge(s))for(let l=0,c=s.length;l!==c;++l){const u=s[l];if(isNaN(u)){console.error("THREE.KeyframeTrack: Value is not a valid number.",this,l,u),e=!1;break}}return e}optimize(){const e=this.times.slice(),n=this.values.slice(),i=this.getValueSize(),s=this.getInterpolation()===xP,o=e.length-1;let a=1;for(let l=1;l<o;++l){let c=!1;const u=e[l],h=e[l+1];if(u!==h&&(l!==1||u!==e[0]))if(s)c=!0;else{const f=l*i,d=f-i,p=f+i;for(let m=0;m!==i;++m){const g=n[f+m];if(g!==n[d+m]||g!==n[p+m]){c=!0;break}}}if(c){if(l!==a){e[a]=e[l];const f=l*i,d=a*i;for(let p=0;p!==i;++p)n[d+p]=n[f+p]}++a}}if(o>0){e[a]=e[o];for(let l=o*i,c=a*i,u=0;u!==i;++u)n[c+u]=n[l+u];++a}return a!==e.length?(this.times=e.slice(0,a),this.values=n.slice(0,a*i)):(this.times=e,this.values=n),this}clone(){const e=this.times.slice(),n=this.values.slice(),i=this.constructor,s=new i(this.name,e,n);return s.createInterpolant=this.createInterpolant,s}}Gl.prototype.TimeBufferType=Float32Array;Gl.prototype.ValueBufferType=Float32Array;Gl.prototype.DefaultInterpolation=OT;class dy extends Gl{}dy.prototype.ValueTypeName="bool";dy.prototype.ValueBufferType=Array;dy.prototype.DefaultInterpolation=NT;dy.prototype.InterpolantFactoryMethodLinear=void 0;dy.prototype.InterpolantFactoryMethodSmooth=void 0;class WK extends Gl{}WK.prototype.ValueTypeName="color";class Rx extends Gl{}Rx.prototype.ValueTypeName="number";class xge extends jM{constructor(e,n,i,s){super(e,n,i,s)}interpolate_(e,n,i,s){const o=this.resultBuffer,a=this.sampleValues,l=this.valueSize,c=(i-n)/(s-n);let u=e*l;for(let h=u+l;u!==h;u+=4)ws.slerpFlat(o,0,a,u-l,a,u,c);return o}}class Ah extends Gl{InterpolantFactoryMethodLinear(e){return new xge(this.times,this.values,this.getValueSize(),e)}}Ah.prototype.ValueTypeName="quaternion";Ah.prototype.DefaultInterpolation=OT;Ah.prototype.InterpolantFactoryMethodSmooth=void 0;class py extends Gl{}py.prototype.ValueTypeName="string";py.prototype.ValueBufferType=Array;py.prototype.DefaultInterpolation=NT;py.prototype.InterpolantFactoryMethodLinear=void 0;py.prototype.InterpolantFactoryMethodSmooth=void 0;class fd extends Gl{}fd.prototype.ValueTypeName="vector";class UO{constructor(e="",n=-1,i=[],s=rme){this.name=e,this.tracks=i,this.duration=n,this.blendMode=s,this.uuid=Uh(),this.duration<0&&this.resetDuration()}static parse(e){const n=[],i=e.tracks,s=1/(e.fps||1);for(let a=0,l=i.length;a!==l;++a)n.push(_ge(i[a]).scale(s));const o=new this(e.name,e.duration,n,e.blendMode);return o.uuid=e.uuid,o}static toJSON(e){const n=[],i=e.tracks,s={name:e.name,duration:e.duration,tracks:n,uuid:e.uuid,blendMode:e.blendMode};for(let o=0,a=i.length;o!==a;++o)n.push(Gl.toJSON(i[o]));return s}static CreateFromMorphTargetSequence(e,n,i,s){const o=n.length,a=[];for(let l=0;l<o;l++){let c=[],u=[];c.push((l+o-1)%o,l,(l+1)%o),u.push(0,1,0);const h=mge(c);c=tV(c,1,h),u=tV(u,1,h),!s&&c[0]===0&&(c.push(o),u.push(u[0])),a.push(new Rx(".morphTargetInfluences["+n[l].name+"]",c,u).scale(1/i))}return new this(e,-1,a)}static findByName(e,n){let i=e;if(!Array.isArray(e)){const s=e;i=s.geometry&&s.geometry.animations||s.animations}for(let s=0;s<i.length;s++)if(i[s].name===n)return i[s];return null}static CreateClipsFromMorphTargetSequences(e,n,i){const s={},o=/^([\w-]*?)([\d]+)$/;for(let l=0,c=e.length;l<c;l++){const u=e[l],h=u.name.match(o);if(h&&h.length>1){const f=h[1];let d=s[f];d||(s[f]=d=[]),d.push(u)}}const a=[];for(const l in s)a.push(this.CreateFromMorphTargetSequence(l,s[l],n,i));return a}static parseAnimation(e,n){if(!e)return console.error("THREE.AnimationClip: No animation in JSONLoader data."),null;const i=function(f,d,p,m,g){if(p.length!==0){const v=[],y=[];HK(p,v,y,m),v.length!==0&&g.push(new f(d,v,y))}},s=[],o=e.name||"default",a=e.fps||30,l=e.blendMode;let c=e.length||-1;const u=e.hierarchy||[];for(let f=0;f<u.length;f++){const d=u[f].keys;if(!(!d||d.length===0))if(d[0].morphTargets){const p={};let m;for(m=0;m<d.length;m++)if(d[m].morphTargets)for(let g=0;g<d[m].morphTargets.length;g++)p[d[m].morphTargets[g]]=-1;for(const g in p){const v=[],y=[];for(let x=0;x!==d[m].morphTargets.length;++x){const b=d[m];v.push(b.time),y.push(b.morphTarget===g?1:0)}s.push(new Rx(".morphTargetInfluence["+g+"]",v,y))}c=p.length*a}else{const p=".bones["+n[f].name+"]";i(fd,p+".position",d,"pos",s),i(Ah,p+".quaternion",d,"rot",s),i(fd,p+".scale",d,"scl",s)}}return s.length===0?null:new this(o,c,s,l)}resetDuration(){const e=this.tracks;let n=0;for(let i=0,s=e.length;i!==s;++i){const o=this.tracks[i];n=Math.max(n,o.times[o.times.length-1])}return this.duration=n,this}trim(){for(let e=0;e<this.tracks.length;e++)this.tracks[e].trim(0,this.duration);return this}validate(){let e=!0;for(let n=0;n<this.tracks.length;n++)e=e&&this.tracks[n].validate();return e}optimize(){for(let e=0;e<this.tracks.length;e++)this.tracks[e].optimize();return this}clone(){const e=[];for(let n=0;n<this.tracks.length;n++)e.push(this.tracks[n].clone());return new this.constructor(this.name,this.duration,e,this.blendMode)}toJSON(){return this.constructor.toJSON(this)}}function bge(r){switch(r.toLowerCase()){case"scalar":case"double":case"float":case"number":case"integer":return Rx;case"vector":case"vector2":case"vector3":case"vector4":return fd;case"color":return WK;case"quaternion":return Ah;case"bool":case"boolean":return dy;case"string":return py}throw new Error("THREE.KeyframeTrack: Unsupported typeName: "+r)}function _ge(r){if(r.type===void 0)throw new Error("THREE.KeyframeTrack: track type undefined, can not parse");const e=bge(r.type);if(r.times===void 0){const n=[],i=[];HK(r.keys,n,i,"value"),r.times=n,r.values=i}return e.parse!==void 0?e.parse(r):new e(r.name,r.times,r.values,r.interpolation)}const BT={enabled:!1,files:{},add:function(r,e){this.enabled!==!1&&(this.files[r]=e)},get:function(r){if(this.enabled!==!1)return this.files[r]},remove:function(r){delete this.files[r]},clear:function(){this.files={}}};let wge=class{constructor(e,n,i){const s=this;let o=!1,a=0,l=0,c;const u=[];this.onStart=void 0,this.onLoad=e,this.onProgress=n,this.onError=i,this.itemStart=function(h){l++,o===!1&&s.onStart!==void 0&&s.onStart(h,a,l),o=!0},this.itemEnd=function(h){a++,s.onProgress!==void 0&&s.onProgress(h,a,l),a===l&&(o=!1,s.onLoad!==void 0&&s.onLoad())},this.itemError=function(h){s.onError!==void 0&&s.onError(h)},this.resolveURL=function(h){return c?c(h):h},this.setURLModifier=function(h){return c=h,this},this.addHandler=function(h,f){return u.push(h,f),this},this.removeHandler=function(h){const f=u.indexOf(h);return f!==-1&&u.splice(f,2),this},this.getHandler=function(h){for(let f=0,d=u.length;f<d;f+=2){const p=u[f],m=u[f+1];if(p.global&&(p.lastIndex=0),p.test(h))return m}return null}}};const Sge=new wge;let Fl=class{constructor(e){this.manager=e!==void 0?e:Sge,this.crossOrigin="anonymous",this.withCredentials=!1,this.path="",this.resourcePath="",this.requestHeader={}}load(){}loadAsync(e,n){const i=this;return new Promise(function(s,o){i.load(e,s,n,o)})}parse(){}setCrossOrigin(e){return this.crossOrigin=e,this}setWithCredentials(e){return this.withCredentials=e,this}setPath(e){return this.path=e,this}setResourcePath(e){return this.resourcePath=e,this}setRequestHeader(e){return this.requestHeader=e,this}};Fl.DEFAULT_MATERIAL_NAME="__DEFAULT";const ac={};class Tge extends Error{constructor(e,n){super(e),this.response=n}}class rF extends Fl{constructor(e){super(e)}load(e,n,i,s){e===void 0&&(e=""),this.path!==void 0&&(e=this.path+e),e=this.manager.resolveURL(e);const o=BT.get(e);if(o!==void 0)return this.manager.itemStart(e),setTimeout(()=>{n&&n(o),this.manager.itemEnd(e)},0),o;if(ac[e]!==void 0){ac[e].push({onLoad:n,onProgress:i,onError:s});return}ac[e]=[],ac[e].push({onLoad:n,onProgress:i,onError:s});const a=new Request(e,{headers:new Headers(this.requestHeader),credentials:this.withCredentials?"include":"same-origin"}),l=this.mimeType,c=this.responseType;fetch(a).then(u=>{if(u.status===200||u.status===0){if(u.status===0&&console.warn("THREE.FileLoader: HTTP Status 0 received."),typeof ReadableStream>"u"||u.body===void 0||u.body.getReader===void 0)return u;const h=ac[e],f=u.body.getReader(),d=u.headers.get("X-File-Size")||u.headers.get("Content-Length"),p=d?parseInt(d):0,m=p!==0;let g=0;const v=new ReadableStream({start(y){x();function x(){f.read().then(({done:b,value:w})=>{if(b)y.close();else{g+=w.byteLength;const _=new ProgressEvent("progress",{lengthComputable:m,loaded:g,total:p});for(let S=0,T=h.length;S<T;S++){const E=h[S];E.onProgress&&E.onProgress(_)}y.enqueue(w),x()}})}}});return new Response(v)}else throw new Tge(`fetch for "${u.url}" responded with ${u.status}: ${u.statusText}`,u)}).then(u=>{switch(c){case"arraybuffer":return u.arrayBuffer();case"blob":return u.blob();case"document":return u.text().then(h=>new DOMParser().parseFromString(h,l));case"json":return u.json();default:if(l===void 0)return u.text();{const f=/charset="?([^;"\s]*)"?/i.exec(l),d=f&&f[1]?f[1].toLowerCase():void 0,p=new TextDecoder(d);return u.arrayBuffer().then(m=>p.decode(m))}}}).then(u=>{BT.add(e,u);const h=ac[e];delete ac[e];for(let f=0,d=h.length;f<d;f++){const p=h[f];p.onLoad&&p.onLoad(u)}}).catch(u=>{const h=ac[e];if(h===void 0)throw this.manager.itemError(e),u;delete ac[e];for(let f=0,d=h.length;f<d;f++){const p=h[f];p.onError&&p.onError(u)}this.manager.itemError(e)}).finally(()=>{this.manager.itemEnd(e)}),this.manager.itemStart(e)}setResponseType(e){return this.responseType=e,this}setMimeType(e){return this.mimeType=e,this}}let Ege=class extends Fl{constructor(e){super(e)}load(e,n,i,s){this.path!==void 0&&(e=this.path+e),e=this.manager.resolveURL(e);const o=this,a=BT.get(e);if(a!==void 0)return o.manager.itemStart(e),setTimeout(function(){n&&n(a),o.manager.itemEnd(e)},0),a;const l=kO("img");function c(){h(),BT.add(e,this),n&&n(this),o.manager.itemEnd(e)}function u(f){h(),s&&s(f),o.manager.itemError(e),o.manager.itemEnd(e)}function h(){l.removeEventListener("load",c,!1),l.removeEventListener("error",u,!1)}return l.addEventListener("load",c,!1),l.addEventListener("error",u,!1),e.slice(0,5)!=="data:"&&this.crossOrigin!==void 0&&(l.crossOrigin=this.crossOrigin),o.manager.itemStart(e),l.src=e,l}};class Mge extends Fl{constructor(e){super(e)}load(e,n,i,s){const o=this,a=new zK,l=new rF(this.manager);return l.setResponseType("arraybuffer"),l.setRequestHeader(this.requestHeader),l.setPath(this.path),l.setWithCredentials(o.withCredentials),l.load(e,function(c){let u;try{u=o.parse(c)}catch(h){if(s!==void 0)s(h);else{console.error(h);return}}u.image!==void 0?a.image=u.image:u.data!==void 0&&(a.image.width=u.width,a.image.height=u.height,a.image.data=u.data),a.wrapS=u.wrapS!==void 0?u.wrapS:Sl,a.wrapT=u.wrapT!==void 0?u.wrapT:Sl,a.magFilter=u.magFilter!==void 0?u.magFilter:A1,a.minFilter=u.minFilter!==void 0?u.minFilter:A1,a.anisotropy=u.anisotropy!==void 0?u.anisotropy:1,u.colorSpace!==void 0&&(a.colorSpace=u.colorSpace),u.flipY!==void 0&&(a.flipY=u.flipY),u.format!==void 0&&(a.format=u.format),u.type!==void 0&&(a.type=u.type),u.mipmaps!==void 0&&(a.mipmaps=u.mipmaps,a.minFilter=KL),u.mipmapCount===1&&(a.minFilter=A1),u.generateMipmaps!==void 0&&(a.generateMipmaps=u.generateMipmaps),a.needsUpdate=!0,n&&n(a,u)},i,s),a}}let qK=class extends Fl{constructor(e){super(e)}load(e,n,i,s){const o=new Gc,a=new Ege(this.manager);return a.setCrossOrigin(this.crossOrigin),a.setPath(this.path),a.load(e,function(l){o.image=l,o.needsUpdate=!0,n!==void 0&&n(o)},i,s),o}},VM=class extends Ai{constructor(e,n=1){super(),this.isLight=!0,this.type="Light",this.color=new wr(e),this.intensity=n}dispose(){}copy(e,n){return super.copy(e,n),this.color.copy(e.color),this.intensity=e.intensity,this}toJSON(e){const n=super.toJSON(e);return n.object.color=this.color.getHex(),n.object.intensity=this.intensity,this.groundColor!==void 0&&(n.object.groundColor=this.groundColor.getHex()),this.distance!==void 0&&(n.object.distance=this.distance),this.angle!==void 0&&(n.object.angle=this.angle),this.decay!==void 0&&(n.object.decay=this.decay),this.penumbra!==void 0&&(n.object.penumbra=this.penumbra),this.shadow!==void 0&&(n.object.shadow=this.shadow.toJSON()),n}};const $P=new _t,nV=new me,rV=new me;let iF=class{constructor(e){this.camera=e,this.bias=0,this.normalBias=0,this.radius=1,this.blurSamples=8,this.mapSize=new Er(512,512),this.map=null,this.mapPass=null,this.matrix=new _t,this.autoUpdate=!0,this.needsUpdate=!1,this._frustum=new Vme,this._frameExtents=new Er(1,1),this._viewportCount=1,this._viewports=[new Hs(0,0,1,1)]}getViewportCount(){return this._viewportCount}getFrustum(){return this._frustum}updateMatrices(e){const n=this.camera,i=this.matrix;nV.setFromMatrixPosition(e.matrixWorld),n.position.copy(nV),rV.setFromMatrixPosition(e.target.matrixWorld),n.lookAt(rV),n.updateMatrixWorld(),$P.multiplyMatrices(n.projectionMatrix,n.matrixWorldInverse),this._frustum.setFromProjectionMatrix($P),i.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),i.multiply($P)}getViewport(e){return this._viewports[e]}getFrameExtents(){return this._frameExtents}dispose(){this.map&&this.map.dispose(),this.mapPass&&this.mapPass.dispose()}copy(e){return this.camera=e.camera.clone(),this.bias=e.bias,this.radius=e.radius,this.mapSize.copy(e.mapSize),this}clone(){return new this.constructor().copy(this)}toJSON(){const e={};return this.bias!==0&&(e.bias=this.bias),this.normalBias!==0&&(e.normalBias=this.normalBias),this.radius!==1&&(e.radius=this.radius),(this.mapSize.x!==512||this.mapSize.y!==512)&&(e.mapSize=this.mapSize.toArray()),e.camera=this.camera.toJSON(!1).object,delete e.camera.matrix,e}},Age=class extends iF{constructor(){super(new Mx(50,1,.5,500)),this.isSpotLightShadow=!0,this.focus=1}updateMatrices(e){const n=this.camera,i=Ex*2*e.angle*this.focus,s=this.mapSize.width/this.mapSize.height,o=e.distance||n.far;(i!==n.fov||s!==n.aspect||o!==n.far)&&(n.fov=i,n.aspect=s,n.far=o,n.updateProjectionMatrix()),super.updateMatrices(e)}copy(e){return super.copy(e),this.focus=e.focus,this}},XK=class extends VM{constructor(e,n,i=0,s=Math.PI/3,o=0,a=2){super(e,n),this.isSpotLight=!0,this.type="SpotLight",this.position.copy(Ai.DEFAULT_UP),this.updateMatrix(),this.target=new Ai,this.distance=i,this.angle=s,this.penumbra=o,this.decay=a,this.map=null,this.shadow=new Age}get power(){return this.intensity*Math.PI}set power(e){this.intensity=e/Math.PI}dispose(){this.shadow.dispose()}copy(e,n){return super.copy(e,n),this.distance=e.distance,this.angle=e.angle,this.penumbra=e.penumbra,this.decay=e.decay,this.target=e.target.clone(),this.shadow=e.shadow.clone(),this}};const iV=new _t,ov=new me,jP=new me;let Cge=class extends iF{constructor(){super(new Mx(90,1,.5,500)),this.isPointLightShadow=!0,this._frameExtents=new Er(4,2),this._viewportCount=6,this._viewports=[new Hs(2,1,1,1),new Hs(0,1,1,1),new Hs(3,1,1,1),new Hs(1,1,1,1),new Hs(3,0,1,1),new Hs(1,0,1,1)],this._cubeDirections=[new me(1,0,0),new me(-1,0,0),new me(0,0,1),new me(0,0,-1),new me(0,1,0),new me(0,-1,0)],this._cubeUps=[new me(0,1,0),new me(0,1,0),new me(0,1,0),new me(0,1,0),new me(0,0,1),new me(0,0,-1)]}updateMatrices(e,n=0){const i=this.camera,s=this.matrix,o=e.distance||i.far;o!==i.far&&(i.far=o,i.updateProjectionMatrix()),ov.setFromMatrixPosition(e.matrixWorld),i.position.copy(ov),jP.copy(i.position),jP.add(this._cubeDirections[n]),i.up.copy(this._cubeUps[n]),i.lookAt(jP),i.updateMatrixWorld(),s.makeTranslation(-ov.x,-ov.y,-ov.z),iV.multiplyMatrices(i.projectionMatrix,i.matrixWorldInverse),this._frustum.setFromProjectionMatrix(iV)}},zO=class extends VM{constructor(e,n,i=0,s=2){super(e,n),this.isPointLight=!0,this.type="PointLight",this.distance=i,this.decay=s,this.shadow=new Cge}get power(){return this.intensity*4*Math.PI}set power(e){this.intensity=e/(4*Math.PI)}dispose(){this.shadow.dispose()}copy(e,n){return super.copy(e,n),this.distance=e.distance,this.decay=e.decay,this.shadow=e.shadow.clone(),this}},Pge=class extends iF{constructor(){super(new eF(-5,5,5,-5,.5,500)),this.isDirectionalLightShadow=!0}},KK=class extends VM{constructor(e,n){super(e,n),this.isDirectionalLight=!0,this.type="DirectionalLight",this.position.copy(Ai.DEFAULT_UP),this.updateMatrix(),this.target=new Ai,this.shadow=new Pge}dispose(){this.shadow.dispose()}copy(e){return super.copy(e),this.target=e.target.clone(),this.shadow=e.shadow.clone(),this}},YK=class extends VM{constructor(e,n){super(e,n),this.isAmbientLight=!0,this.type="AmbientLight"}};class ZK{static decodeText(e){if(typeof TextDecoder<"u")return new TextDecoder().decode(e);let n="";for(let i=0,s=e.length;i<s;i++)n+=String.fromCharCode(e[i]);try{return decodeURIComponent(escape(n))}catch{return n}}static extractUrlBase(e){const n=e.lastIndexOf("/");return n===-1?"./":e.slice(0,n+1)}static resolveURL(e,n){return typeof e!="string"||e===""?"":(/^https?:\/\//i.test(n)&&/^\//.test(e)&&(n=n.replace(/(^https?:\/\/[^\/]+).*/i,"$1")),/^(https?:)?\/\//i.test(e)||/^data:.*,.*$/i.test(e)||/^blob:.*$/i.test(e)?e:n+e)}}const sF="\\[\\]\\.:\\/",Rge=new RegExp("["+sF+"]","g"),oF="[^"+sF+"]",Nge="[^"+sF.replace("\\.","")+"]",Oge=/((?:WC+[\/:])*)/.source.replace("WC",oF),Dge=/(WCOD+)?/.source.replace("WCOD",Nge),kge=/(?:\.(WC+)(?:\[(.+)\])?)?/.source.replace("WC",oF),Ige=/\.(WC+)(?:\[(.+)\])?/.source.replace("WC",oF),Lge=new RegExp("^"+Oge+Dge+kge+Ige+"$"),Fge=["material","materials","bones","map"];class Bge{constructor(e,n,i){const s=i||yn.parseTrackName(n);this._targetGroup=e,this._bindings=e.subscribe_(n,s)}getValue(e,n){this.bind();const i=this._targetGroup.nCachedObjects_,s=this._bindings[i];s!==void 0&&s.getValue(e,n)}setValue(e,n){const i=this._bindings;for(let s=this._targetGroup.nCachedObjects_,o=i.length;s!==o;++s)i[s].setValue(e,n)}bind(){const e=this._bindings;for(let n=this._targetGroup.nCachedObjects_,i=e.length;n!==i;++n)e[n].bind()}unbind(){const e=this._bindings;for(let n=this._targetGroup.nCachedObjects_,i=e.length;n!==i;++n)e[n].unbind()}}class yn{constructor(e,n,i){this.path=n,this.parsedPath=i||yn.parseTrackName(n),this.node=yn.findNode(e,this.parsedPath.nodeName),this.rootNode=e,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}static create(e,n,i){return e&&e.isAnimationObjectGroup?new yn.Composite(e,n,i):new yn(e,n,i)}static sanitizeNodeName(e){return e.replace(/\s/g,"_").replace(Rge,"")}static parseTrackName(e){const n=Lge.exec(e);if(n===null)throw new Error("PropertyBinding: Cannot parse trackName: "+e);const i={nodeName:n[2],objectName:n[3],objectIndex:n[4],propertyName:n[5],propertyIndex:n[6]},s=i.nodeName&&i.nodeName.lastIndexOf(".");if(s!==void 0&&s!==-1){const o=i.nodeName.substring(s+1);Fge.indexOf(o)!==-1&&(i.nodeName=i.nodeName.substring(0,s),i.objectName=o)}if(i.propertyName===null||i.propertyName.length===0)throw new Error("PropertyBinding: can not parse propertyName from trackName: "+e);return i}static findNode(e,n){if(n===void 0||n===""||n==="."||n===-1||n===e.name||n===e.uuid)return e;if(e.skeleton){const i=e.skeleton.getBoneByName(n);if(i!==void 0)return i}if(e.children){const i=function(o){for(let a=0;a<o.length;a++){const l=o[a];if(l.name===n||l.uuid===n)return l;const c=i(l.children);if(c)return c}return null},s=i(e.children);if(s)return s}return null}_getValue_unavailable(){}_setValue_unavailable(){}_getValue_direct(e,n){e[n]=this.targetObject[this.propertyName]}_getValue_array(e,n){const i=this.resolvedProperty;for(let s=0,o=i.length;s!==o;++s)e[n++]=i[s]}_getValue_arrayElement(e,n){e[n]=this.resolvedProperty[this.propertyIndex]}_getValue_toArray(e,n){this.resolvedProperty.toArray(e,n)}_setValue_direct(e,n){this.targetObject[this.propertyName]=e[n]}_setValue_direct_setNeedsUpdate(e,n){this.targetObject[this.propertyName]=e[n],this.targetObject.needsUpdate=!0}_setValue_direct_setMatrixWorldNeedsUpdate(e,n){this.targetObject[this.propertyName]=e[n],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_array(e,n){const i=this.resolvedProperty;for(let s=0,o=i.length;s!==o;++s)i[s]=e[n++]}_setValue_array_setNeedsUpdate(e,n){const i=this.resolvedProperty;for(let s=0,o=i.length;s!==o;++s)i[s]=e[n++];this.targetObject.needsUpdate=!0}_setValue_array_setMatrixWorldNeedsUpdate(e,n){const i=this.resolvedProperty;for(let s=0,o=i.length;s!==o;++s)i[s]=e[n++];this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_arrayElement(e,n){this.resolvedProperty[this.propertyIndex]=e[n]}_setValue_arrayElement_setNeedsUpdate(e,n){this.resolvedProperty[this.propertyIndex]=e[n],this.targetObject.needsUpdate=!0}_setValue_arrayElement_setMatrixWorldNeedsUpdate(e,n){this.resolvedProperty[this.propertyIndex]=e[n],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_fromArray(e,n){this.resolvedProperty.fromArray(e,n)}_setValue_fromArray_setNeedsUpdate(e,n){this.resolvedProperty.fromArray(e,n),this.targetObject.needsUpdate=!0}_setValue_fromArray_setMatrixWorldNeedsUpdate(e,n){this.resolvedProperty.fromArray(e,n),this.targetObject.matrixWorldNeedsUpdate=!0}_getValue_unbound(e,n){this.bind(),this.getValue(e,n)}_setValue_unbound(e,n){this.bind(),this.setValue(e,n)}bind(){let e=this.node;const n=this.parsedPath,i=n.objectName,s=n.propertyName;let o=n.propertyIndex;if(e||(e=yn.findNode(this.rootNode,n.nodeName),this.node=e),this.getValue=this._getValue_unavailable,this.setValue=this._setValue_unavailable,!e){console.warn("THREE.PropertyBinding: No target node found for track: "+this.path+".");return}if(i){let u=n.objectIndex;switch(i){case"materials":if(!e.material){console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);return}if(!e.material.materials){console.error("THREE.PropertyBinding: Can not bind to material.materials as node.material does not have a materials array.",this);return}e=e.material.materials;break;case"bones":if(!e.skeleton){console.error("THREE.PropertyBinding: Can not bind to bones as node does not have a skeleton.",this);return}e=e.skeleton.bones;for(let h=0;h<e.length;h++)if(e[h].name===u){u=h;break}break;case"map":if("map"in e){e=e.map;break}if(!e.material){console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);return}if(!e.material.map){console.error("THREE.PropertyBinding: Can not bind to material.map as node.material does not have a map.",this);return}e=e.material.map;break;default:if(e[i]===void 0){console.error("THREE.PropertyBinding: Can not bind to objectName of node undefined.",this);return}e=e[i]}if(u!==void 0){if(e[u]===void 0){console.error("THREE.PropertyBinding: Trying to bind to objectIndex of objectName, but is undefined.",this,e);return}e=e[u]}}const a=e[s];if(a===void 0){const u=n.nodeName;console.error("THREE.PropertyBinding: Trying to update property for track: "+u+"."+s+" but it wasn't found.",e);return}let l=this.Versioning.None;this.targetObject=e,e.needsUpdate!==void 0?l=this.Versioning.NeedsUpdate:e.matrixWorldNeedsUpdate!==void 0&&(l=this.Versioning.MatrixWorldNeedsUpdate);let c=this.BindingType.Direct;if(o!==void 0){if(s==="morphTargetInfluences"){if(!e.geometry){console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.",this);return}if(!e.geometry.morphAttributes){console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.morphAttributes.",this);return}e.morphTargetDictionary[o]!==void 0&&(o=e.morphTargetDictionary[o])}c=this.BindingType.ArrayElement,this.resolvedProperty=a,this.propertyIndex=o}else a.fromArray!==void 0&&a.toArray!==void 0?(c=this.BindingType.HasFromToArray,this.resolvedProperty=a):Array.isArray(a)?(c=this.BindingType.EntireArray,this.resolvedProperty=a):this.propertyName=s;this.getValue=this.GetterByBindingType[c],this.setValue=this.SetterByBindingTypeAndVersioning[c][l]}unbind(){this.node=null,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}}yn.Composite=Bge;yn.prototype.BindingType={Direct:0,EntireArray:1,ArrayElement:2,HasFromToArray:3};yn.prototype.Versioning={None:0,NeedsUpdate:1,MatrixWorldNeedsUpdate:2};yn.prototype.GetterByBindingType=[yn.prototype._getValue_direct,yn.prototype._getValue_array,yn.prototype._getValue_arrayElement,yn.prototype._getValue_toArray];yn.prototype.SetterByBindingTypeAndVersioning=[[yn.prototype._setValue_direct,yn.prototype._setValue_direct_setNeedsUpdate,yn.prototype._setValue_direct_setMatrixWorldNeedsUpdate],[yn.prototype._setValue_array,yn.prototype._setValue_array_setNeedsUpdate,yn.prototype._setValue_array_setMatrixWorldNeedsUpdate],[yn.prototype._setValue_arrayElement,yn.prototype._setValue_arrayElement_setNeedsUpdate,yn.prototype._setValue_arrayElement_setMatrixWorldNeedsUpdate],[yn.prototype._setValue_fromArray,yn.prototype._setValue_fromArray_setNeedsUpdate,yn.prototype._setValue_fromArray_setMatrixWorldNeedsUpdate]];typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("register",{detail:{revision:SK}}));typeof window<"u"&&(window.__THREE__?console.warn("WARNING: Multiple instances of Three.js being imported."):window.__THREE__=SK);class sV extends Mge{constructor(e){super(e)}parse(e){function n(R){switch(R.image_type){case d:case g:if(R.colormap_length>256||R.colormap_size!==24||R.colormap_type!==1)throw new Error("THREE.TGALoader: Invalid type colormap data for indexed type.");break;case p:case m:case v:case y:if(R.colormap_type)throw new Error("THREE.TGALoader: Invalid type colormap data for colormap type.");break;case f:throw new Error("THREE.TGALoader: No data.");default:throw new Error("THREE.TGALoader: Invalid type "+R.image_type)}if(R.width<=0||R.height<=0)throw new Error("THREE.TGALoader: Invalid image size.");if(R.pixel_size!==8&&R.pixel_size!==16&&R.pixel_size!==24&&R.pixel_size!==32)throw new Error("THREE.TGALoader: Invalid pixel size "+R.pixel_size)}function i(R,z,U,G,H){let Y,ee;const he=U.pixel_size>>3,q=U.width*U.height*he;if(z&&(ee=H.subarray(G,G+=U.colormap_length*(U.colormap_size>>3))),R){Y=new Uint8Array(q);let J,se,oe,Ee=0;const ye=new Uint8Array(he);for(;Ee<q;)if(J=H[G++],se=(J&127)+1,J&128){for(oe=0;oe<he;++oe)ye[oe]=H[G++];for(oe=0;oe<se;++oe)Y.set(ye,Ee+oe*he);Ee+=he*se}else{for(se*=he,oe=0;oe<se;++oe)Y[Ee+oe]=H[G++];Ee+=se}}else Y=H.subarray(G,G+=z?U.width*U.height:q);return{pixel_data:Y,palettes:ee}}function s(R,z,U,G,H,Y,ee,he,q){const J=q;let se,oe=0,Ee,ye;const Ce=A.width;for(ye=z;ye!==G;ye+=U)for(Ee=H;Ee!==ee;Ee+=Y,oe++)se=he[oe],R[(Ee+Ce*ye)*4+3]=255,R[(Ee+Ce*ye)*4+2]=J[se*3+0],R[(Ee+Ce*ye)*4+1]=J[se*3+1],R[(Ee+Ce*ye)*4+0]=J[se*3+2];return R}function o(R,z,U,G,H,Y,ee,he){let q,J=0,se,oe;const Ee=A.width;for(oe=z;oe!==G;oe+=U)for(se=H;se!==ee;se+=Y,J+=2)q=he[J+0]+(he[J+1]<<8),R[(se+Ee*oe)*4+0]=(q&31744)>>7,R[(se+Ee*oe)*4+1]=(q&992)>>2,R[(se+Ee*oe)*4+2]=(q&31)<<3,R[(se+Ee*oe)*4+3]=q&32768?0:255;return R}function a(R,z,U,G,H,Y,ee,he){let q=0,J,se;const oe=A.width;for(se=z;se!==G;se+=U)for(J=H;J!==ee;J+=Y,q+=3)R[(J+oe*se)*4+3]=255,R[(J+oe*se)*4+2]=he[q+0],R[(J+oe*se)*4+1]=he[q+1],R[(J+oe*se)*4+0]=he[q+2];return R}function l(R,z,U,G,H,Y,ee,he){let q=0,J,se;const oe=A.width;for(se=z;se!==G;se+=U)for(J=H;J!==ee;J+=Y,q+=4)R[(J+oe*se)*4+2]=he[q+0],R[(J+oe*se)*4+1]=he[q+1],R[(J+oe*se)*4+0]=he[q+2],R[(J+oe*se)*4+3]=he[q+3];return R}function c(R,z,U,G,H,Y,ee,he){let q,J=0,se,oe;const Ee=A.width;for(oe=z;oe!==G;oe+=U)for(se=H;se!==ee;se+=Y,J++)q=he[J],R[(se+Ee*oe)*4+0]=q,R[(se+Ee*oe)*4+1]=q,R[(se+Ee*oe)*4+2]=q,R[(se+Ee*oe)*4+3]=255;return R}function u(R,z,U,G,H,Y,ee,he){let q=0,J,se;const oe=A.width;for(se=z;se!==G;se+=U)for(J=H;J!==ee;J+=Y,q+=2)R[(J+oe*se)*4+0]=he[q+0],R[(J+oe*se)*4+1]=he[q+0],R[(J+oe*se)*4+2]=he[q+0],R[(J+oe*se)*4+3]=he[q+1];return R}function h(R,z,U,G,H){let Y,ee,he,q,J,se;switch((A.flags&x)>>b){default:case S:Y=0,he=1,J=z,ee=0,q=1,se=U;break;case w:Y=0,he=1,J=z,ee=U-1,q=-1,se=-1;break;case T:Y=z-1,he=-1,J=-1,ee=0,q=1,se=U;break;case _:Y=z-1,he=-1,J=-1,ee=U-1,q=-1,se=-1;break}if(B)switch(A.pixel_size){case 8:c(R,ee,q,se,Y,he,J,G);break;case 16:u(R,ee,q,se,Y,he,J,G);break;default:throw new Error("THREE.TGALoader: Format not supported.")}else switch(A.pixel_size){case 8:s(R,ee,q,se,Y,he,J,G,H);break;case 16:o(R,ee,q,se,Y,he,J,G);break;case 24:a(R,ee,q,se,Y,he,J,G);break;case 32:l(R,ee,q,se,Y,he,J,G);break;default:throw new Error("THREE.TGALoader: Format not supported.")}return R}const f=0,d=1,p=2,m=3,g=9,v=10,y=11,x=48,b=4,w=0,_=1,S=2,T=3;if(e.length<19)throw new Error("THREE.TGALoader: Not enough data to contain header.");let E=0;const M=new Uint8Array(e),A={id_length:M[E++],colormap_type:M[E++],image_type:M[E++],colormap_index:M[E++]|M[E++]<<8,colormap_length:M[E++]|M[E++]<<8,colormap_size:M[E++],origin:[M[E++]|M[E++]<<8,M[E++]|M[E++]<<8],width:M[E++]|M[E++]<<8,height:M[E++]|M[E++]<<8,pixel_size:M[E++],flags:M[E++]};if(n(A),A.id_length+E>e.length)throw new Error("THREE.TGALoader: No data.");E+=A.id_length;let P=!1,D=!1,B=!1;switch(A.image_type){case g:P=!0,D=!0;break;case d:D=!0;break;case v:P=!0;break;case p:break;case y:P=!0,B=!0;break;case m:B=!0;break}const C=new Uint8Array(A.width*A.height*4),O=i(P,D,A,E,M);return h(C,A.width,A.height,O.pixel_data,O.palettes),{data:C,width:A.width,height:A.height,flipY:!0,generateMipmaps:!0,minFilter:KL}}}class Uge extends Fl{load(e,n,i,s){const o=this,a=o.path===""?ZK.extractUrlBase(e):o.path,l=new rF(o.manager);l.setPath(o.path),l.setRequestHeader(o.requestHeader),l.setWithCredentials(o.withCredentials),l.load(e,function(c){try{n(o.parse(c,a))}catch(u){s?s(u):console.error(u),o.manager.itemError(e)}},i,s)}parse(e,n){function i(F,L){const j=[],$=F.childNodes;for(let W=0,xe=$.length;W<xe;W++){const Pe=$[W];Pe.nodeName===L&&j.push(Pe)}return j}function s(F){if(F.length===0)return[];const L=F.trim().split(/\s+/),j=new Array(L.length);for(let $=0,W=L.length;$<W;$++)j[$]=L[$];return j}function o(F){if(F.length===0)return[];const L=F.trim().split(/\s+/),j=new Array(L.length);for(let $=0,W=L.length;$<W;$++)j[$]=parseFloat(L[$]);return j}function a(F){if(F.length===0)return[];const L=F.trim().split(/\s+/),j=new Array(L.length);for(let $=0,W=L.length;$<W;$++)j[$]=parseInt(L[$]);return j}function l(F){return F.substring(1)}function c(){return"three_default_"+Yl++}function u(F){return Object.keys(F).length===0}function h(F){return{unit:f(i(F,"unit")[0]),upAxis:d(i(F,"up_axis")[0])}}function f(F){return F!==void 0&&F.hasAttribute("meter")===!0?parseFloat(F.getAttribute("meter")):1}function d(F){return F!==void 0?F.textContent:"Y_UP"}function p(F,L,j,$){const W=i(F,L)[0];if(W!==void 0){const xe=i(W,j);for(let Pe=0;Pe<xe.length;Pe++)$(xe[Pe])}}function m(F,L){for(const j in F){const $=F[j];$.build=L(F[j])}}function g(F,L){return F.build!==void 0||(F.build=L(F)),F.build}function v(F){const L={sources:{},samplers:{},channels:{}};let j=!1;for(let $=0,W=F.childNodes.length;$<W;$++){const xe=F.childNodes[$];if(xe.nodeType!==1)continue;let Pe;switch(xe.nodeName){case"source":Pe=xe.getAttribute("id"),L.sources[Pe]=Se(xe);break;case"sampler":Pe=xe.getAttribute("id"),L.samplers[Pe]=y(xe);break;case"channel":Pe=xe.getAttribute("target"),L.channels[Pe]=x(xe);break;case"animation":v(xe),j=!0;break;default:console.log(xe)}}j===!1&&(Dt.animations[F.getAttribute("id")||zr.generateUUID()]=L)}function y(F){const L={inputs:{}};for(let j=0,$=F.childNodes.length;j<$;j++){const W=F.childNodes[j];if(W.nodeType===1)switch(W.nodeName){case"input":const xe=l(W.getAttribute("source")),Pe=W.getAttribute("semantic");L.inputs[Pe]=xe;break}}return L}function x(F){const L={};let $=F.getAttribute("target").split("/");const W=$.shift();let xe=$.shift();const Pe=xe.indexOf("(")!==-1,rt=xe.indexOf(".")!==-1;if(rt)$=xe.split("."),xe=$.shift(),L.member=$.shift();else if(Pe){const He=xe.split("(");xe=He.shift();for(let Qe=0;Qe<He.length;Qe++)He[Qe]=parseInt(He[Qe].replace(/\)/,""));L.indices=He}return L.id=W,L.sid=xe,L.arraySyntax=Pe,L.memberSyntax=rt,L.sampler=l(F.getAttribute("source")),L}function b(F){const L=[],j=F.channels,$=F.samplers,W=F.sources;for(const xe in j)if(j.hasOwnProperty(xe)){const Pe=j[xe],rt=$[Pe.sampler],He=rt.inputs.INPUT,Qe=rt.inputs.OUTPUT,yt=W[He],Ie=W[Qe],dt=_(Pe,yt,Ie);A(dt,L)}return L}function w(F){return g(Dt.animations[F],b)}function _(F,L,j){const $=Dt.nodes[F.id],W=Yt($.id),xe=$.transforms[F.sid],Pe=$.matrix.clone().transpose();let rt,He,Qe,yt,Ie,dt;const ut={};switch(xe){case"matrix":for(Qe=0,yt=L.array.length;Qe<yt;Qe++)if(rt=L.array[Qe],He=Qe*j.stride,ut[rt]===void 0&&(ut[rt]={}),F.arraySyntax===!0){const ur=j.array[He],En=F.indices[0]+4*F.indices[1];ut[rt][En]=ur}else for(Ie=0,dt=j.stride;Ie<dt;Ie++)ut[rt][Ie]=j.array[He+Ie];break;case"translate":console.warn('THREE.ColladaLoader: Animation transform type "%s" not yet implemented.',xe);break;case"rotate":console.warn('THREE.ColladaLoader: Animation transform type "%s" not yet implemented.',xe);break;case"scale":console.warn('THREE.ColladaLoader: Animation transform type "%s" not yet implemented.',xe);break}const Mt=S(ut,Pe);return{name:W.uuid,keyframes:Mt}}function S(F,L){const j=[];for(const W in F)j.push({time:parseFloat(W),value:F[W]});j.sort($);for(let W=0;W<16;W++)P(j,W,L.elements[W]);return j;function $(W,xe){return W.time-xe.time}}const T=new me,E=new me,M=new ws;function A(F,L){const j=F.keyframes,$=F.name,W=[],xe=[],Pe=[],rt=[];for(let He=0,Qe=j.length;He<Qe;He++){const yt=j[He],Ie=yt.time,dt=yt.value;le.fromArray(dt).transpose(),le.decompose(T,M,E),W.push(Ie),xe.push(T.x,T.y,T.z),Pe.push(M.x,M.y,M.z,M.w),rt.push(E.x,E.y,E.z)}return xe.length>0&&L.push(new fd($+".position",W,xe)),Pe.length>0&&L.push(new Ah($+".quaternion",W,Pe)),rt.length>0&&L.push(new fd($+".scale",W,rt)),L}function P(F,L,j){let $,W=!0,xe,Pe;for(xe=0,Pe=F.length;xe<Pe;xe++)$=F[xe],$.value[L]===void 0?$.value[L]=null:W=!1;if(W===!0)for(xe=0,Pe=F.length;xe<Pe;xe++)$=F[xe],$.value[L]=j;else D(F,L)}function D(F,L){let j,$;for(let W=0,xe=F.length;W<xe;W++){const Pe=F[W];if(Pe.value[L]===null){if(j=B(F,W,L),$=C(F,W,L),j===null){Pe.value[L]=$.value[L];continue}if($===null){Pe.value[L]=j.value[L];continue}O(Pe,j,$,L)}}}function B(F,L,j){for(;L>=0;){const $=F[L];if($.value[j]!==null)return $;L--}return null}function C(F,L,j){for(;L<F.length;){const $=F[L];if($.value[j]!==null)return $;L++}return null}function O(F,L,j,$){if(j.time-L.time===0){F.value[$]=L.value[$];return}F.value[$]=(F.time-L.time)*(j.value[$]-L.value[$])/(j.time-L.time)+L.value[$]}function R(F){const L={name:F.getAttribute("id")||"default",start:parseFloat(F.getAttribute("start")||0),end:parseFloat(F.getAttribute("end")||0),animations:[]};for(let j=0,$=F.childNodes.length;j<$;j++){const W=F.childNodes[j];if(W.nodeType===1)switch(W.nodeName){case"instance_animation":L.animations.push(l(W.getAttribute("url")));break}}Dt.clips[F.getAttribute("id")]=L}function z(F){const L=[],j=F.name,$=F.end-F.start||-1,W=F.animations;for(let xe=0,Pe=W.length;xe<Pe;xe++){const rt=w(W[xe]);for(let He=0,Qe=rt.length;He<Qe;He++)L.push(rt[He])}return new UO(j,$,L)}function U(F){return g(Dt.clips[F],z)}function G(F){const L={};for(let j=0,$=F.childNodes.length;j<$;j++){const W=F.childNodes[j];if(W.nodeType===1)switch(W.nodeName){case"skin":L.id=l(W.getAttribute("source")),L.skin=H(W);break;case"morph":L.id=l(W.getAttribute("source")),console.warn("THREE.ColladaLoader: Morph target animation not supported yet.");break}}Dt.controllers[F.getAttribute("id")]=L}function H(F){const L={sources:{}};for(let j=0,$=F.childNodes.length;j<$;j++){const W=F.childNodes[j];if(W.nodeType===1)switch(W.nodeName){case"bind_shape_matrix":L.bindShapeMatrix=o(W.textContent);break;case"source":const xe=W.getAttribute("id");L.sources[xe]=Se(W);break;case"joints":L.joints=Y(W);break;case"vertex_weights":L.vertexWeights=ee(W);break}}return L}function Y(F){const L={inputs:{}};for(let j=0,$=F.childNodes.length;j<$;j++){const W=F.childNodes[j];if(W.nodeType===1)switch(W.nodeName){case"input":const xe=W.getAttribute("semantic"),Pe=l(W.getAttribute("source"));L.inputs[xe]=Pe;break}}return L}function ee(F){const L={inputs:{}};for(let j=0,$=F.childNodes.length;j<$;j++){const W=F.childNodes[j];if(W.nodeType===1)switch(W.nodeName){case"input":const xe=W.getAttribute("semantic"),Pe=l(W.getAttribute("source")),rt=parseInt(W.getAttribute("offset"));L.inputs[xe]={id:Pe,offset:rt};break;case"vcount":L.vcount=a(W.textContent);break;case"v":L.v=a(W.textContent);break}}return L}function he(F){const L={id:F.id},j=Dt.geometries[L.id];return F.skin!==void 0&&(L.skin=q(F.skin),j.sources.skinIndices=L.skin.indices,j.sources.skinWeights=L.skin.weights),L}function q(F){const j={joints:[],indices:{array:[],stride:4},weights:{array:[],stride:4}},$=F.sources,W=F.vertexWeights,xe=W.vcount,Pe=W.v,rt=W.inputs.JOINT.offset,He=W.inputs.WEIGHT.offset,Qe=F.sources[F.joints.inputs.JOINT],yt=F.sources[F.joints.inputs.INV_BIND_MATRIX],Ie=$[W.inputs.WEIGHT.id].array;let dt=0,ut,Mt,bt;for(ut=0,bt=xe.length;ut<bt;ut++){const En=xe[ut],mn=[];for(Mt=0;Mt<En;Mt++){const gn=Pe[dt+rt],Zl=Pe[dt+He],$s=Ie[Zl];mn.push({index:gn,weight:$s}),dt+=2}for(mn.sort(ur),Mt=0;Mt<4;Mt++){const gn=mn[Mt];gn!==void 0?(j.indices.array.push(gn.index),j.weights.array.push(gn.weight)):(j.indices.array.push(0),j.weights.array.push(0))}}for(F.bindShapeMatrix?j.bindMatrix=new _t().fromArray(F.bindShapeMatrix).transpose():j.bindMatrix=new _t().identity(),ut=0,bt=Qe.array.length;ut<bt;ut++){const En=Qe.array[ut],mn=new _t().fromArray(yt.array,ut*yt.stride).transpose();j.joints.push({name:En,boneInverse:mn})}return j;function ur(En,mn){return mn.weight-En.weight}}function J(F){return g(Dt.controllers[F],he)}function se(F){const L={init_from:i(F,"init_from")[0].textContent};Dt.images[F.getAttribute("id")]=L}function oe(F){return F.build!==void 0?F.build:F.init_from}function Ee(F){const L=Dt.images[F];return L!==void 0?g(L,oe):(console.warn("THREE.ColladaLoader: Couldn't find image with ID:",F),null)}function ye(F){const L={};for(let j=0,$=F.childNodes.length;j<$;j++){const W=F.childNodes[j];if(W.nodeType===1)switch(W.nodeName){case"profile_COMMON":L.profile=Ce(W);break}}Dt.effects[F.getAttribute("id")]=L}function Ce(F){const L={surfaces:{},samplers:{}};for(let j=0,$=F.childNodes.length;j<$;j++){const W=F.childNodes[j];if(W.nodeType===1)switch(W.nodeName){case"newparam":Ge(W,L);break;case"technique":L.technique=Q(W);break;case"extra":L.extra=X(W);break}}return L}function Ge(F,L){const j=F.getAttribute("sid");for(let $=0,W=F.childNodes.length;$<W;$++){const xe=F.childNodes[$];if(xe.nodeType===1)switch(xe.nodeName){case"surface":L.surfaces[j]=_e(xe);break;case"sampler2D":L.samplers[j]=Ke(xe);break}}}function _e(F){const L={};for(let j=0,$=F.childNodes.length;j<$;j++){const W=F.childNodes[j];if(W.nodeType===1)switch(W.nodeName){case"init_from":L.init_from=W.textContent;break}}return L}function Ke(F){const L={};for(let j=0,$=F.childNodes.length;j<$;j++){const W=F.childNodes[j];if(W.nodeType===1)switch(W.nodeName){case"source":L.source=W.textContent;break}}return L}function Q(F){const L={};for(let j=0,$=F.childNodes.length;j<$;j++){const W=F.childNodes[j];if(W.nodeType===1)switch(W.nodeName){case"constant":case"lambert":case"blinn":case"phong":L.type=W.nodeName,L.parameters=kt(W);break;case"extra":L.extra=X(W);break}}return L}function kt(F){const L={};for(let j=0,$=F.childNodes.length;j<$;j++){const W=F.childNodes[j];if(W.nodeType===1)switch(W.nodeName){case"emission":case"diffuse":case"specular":case"bump":case"ambient":case"shininess":case"transparency":L[W.nodeName]=ct(W);break;case"transparent":L[W.nodeName]={opaque:W.hasAttribute("opaque")?W.getAttribute("opaque"):"A_ONE",data:ct(W)};break}}return L}function ct(F){const L={};for(let j=0,$=F.childNodes.length;j<$;j++){const W=F.childNodes[j];if(W.nodeType===1)switch(W.nodeName){case"color":L[W.nodeName]=o(W.textContent);break;case"float":L[W.nodeName]=parseFloat(W.textContent);break;case"texture":L[W.nodeName]={id:W.getAttribute("texture"),extra:gt(W)};break}}return L}function gt(F){const L={technique:{}};for(let j=0,$=F.childNodes.length;j<$;j++){const W=F.childNodes[j];if(W.nodeType===1)switch(W.nodeName){case"extra":ot(W,L);break}}return L}function ot(F,L){for(let j=0,$=F.childNodes.length;j<$;j++){const W=F.childNodes[j];if(W.nodeType===1)switch(W.nodeName){case"technique":on(W,L);break}}}function on(F,L){for(let j=0,$=F.childNodes.length;j<$;j++){const W=F.childNodes[j];if(W.nodeType===1)switch(W.nodeName){case"repeatU":case"repeatV":case"offsetU":case"offsetV":L.technique[W.nodeName]=parseFloat(W.textContent);break;case"wrapU":case"wrapV":W.textContent.toUpperCase()==="TRUE"?L.technique[W.nodeName]=1:W.textContent.toUpperCase()==="FALSE"?L.technique[W.nodeName]=0:L.technique[W.nodeName]=parseInt(W.textContent);break;case"bump":L[W.nodeName]=k(W);break}}}function X(F){const L={};for(let j=0,$=F.childNodes.length;j<$;j++){const W=F.childNodes[j];if(W.nodeType===1)switch(W.nodeName){case"technique":L.technique=I(W);break}}return L}function I(F){const L={};for(let j=0,$=F.childNodes.length;j<$;j++){const W=F.childNodes[j];if(W.nodeType===1)switch(W.nodeName){case"double_sided":L[W.nodeName]=parseInt(W.textContent);break;case"bump":L[W.nodeName]=k(W);break}}return L}function k(F){const L={};for(let j=0,$=F.childNodes.length;j<$;j++){const W=F.childNodes[j];if(W.nodeType===1)switch(W.nodeName){case"texture":L[W.nodeName]={id:W.getAttribute("texture"),texcoord:W.getAttribute("texcoord"),extra:gt(W)};break}}return L}function ne(F){return F}function ae(F){return g(Dt.effects[F],ne)}function ce(F){const L={name:F.getAttribute("name")};for(let j=0,$=F.childNodes.length;j<$;j++){const W=F.childNodes[j];if(W.nodeType===1)switch(W.nodeName){case"instance_effect":L.url=l(W.getAttribute("url"));break}}Dt.materials[F.getAttribute("id")]=L}function pe(F){let L,j=F.slice((F.lastIndexOf(".")-1>>>0)+2);switch(j=j.toLowerCase(),j){case"tga":L=Gi;break;default:L=us}return L}function ze(F){const L=ae(F.url),j=L.profile.technique;let $;switch(j.type){case"phong":case"blinn":$=new D0;break;case"lambert":$=new GK;break;default:$=new LO;break}$.name=F.name||"";function W(He,Qe=null){const yt=L.profile.samplers[He.id];let Ie=null;if(yt!==void 0){const dt=L.profile.surfaces[yt.source];Ie=Ee(dt.init_from)}else console.warn("THREE.ColladaLoader: Undefined sampler. Access image directly (see #12530)."),Ie=Ee(He.id);if(Ie!==null){const dt=pe(Ie);if(dt!==void 0){const ut=dt.load(Ie),Mt=He.extra;if(Mt!==void 0&&Mt.technique!==void 0&&u(Mt.technique)===!1){const bt=Mt.technique;ut.wrapS=bt.wrapU?oh:Sl,ut.wrapT=bt.wrapV?oh:Sl,ut.offset.set(bt.offsetU||0,bt.offsetV||0),ut.repeat.set(bt.repeatU||1,bt.repeatV||1)}else ut.wrapS=oh,ut.wrapT=oh;return Qe!==null&&(ut.colorSpace=Qe),ut}else return console.warn("THREE.ColladaLoader: Loader for texture %s not found.",Ie),null}else return console.warn("THREE.ColladaLoader: Couldn't create texture with ID:",He.id),null}const xe=j.parameters;for(const He in xe){const Qe=xe[He];switch(He){case"diffuse":Qe.color&&$.color.fromArray(Qe.color),Qe.texture&&($.map=W(Qe.texture,Ss));break;case"specular":Qe.color&&$.specular&&$.specular.fromArray(Qe.color),Qe.texture&&($.specularMap=W(Qe.texture));break;case"bump":Qe.texture&&($.normalMap=W(Qe.texture));break;case"ambient":Qe.texture&&($.lightMap=W(Qe.texture,Ss));break;case"shininess":Qe.float&&$.shininess&&($.shininess=Qe.float);break;case"emission":Qe.color&&$.emissive&&$.emissive.fromArray(Qe.color),Qe.texture&&($.emissiveMap=W(Qe.texture,Ss));break}}$.color.convertSRGBToLinear(),$.specular&&$.specular.convertSRGBToLinear(),$.emissive&&$.emissive.convertSRGBToLinear();let Pe=xe.transparent,rt=xe.transparency;if(rt===void 0&&Pe&&(rt={float:1}),Pe===void 0&&rt&&(Pe={opaque:"A_ONE",data:{color:[1,1,1,1]}}),Pe&&rt)if(Pe.data.texture)$.transparent=!0;else{const He=Pe.data.color;switch(Pe.opaque){case"A_ONE":$.opacity=He[3]*rt.float;break;case"RGB_ZERO":$.opacity=1-He[0]*rt.float;break;case"A_ZERO":$.opacity=1-He[3]*rt.float;break;case"RGB_ONE":$.opacity=He[0]*rt.float;break;default:console.warn('THREE.ColladaLoader: Invalid opaque type "%s" of transparent tag.',Pe.opaque)}$.opacity<1&&($.transparent=!0)}if(j.extra!==void 0&&j.extra.technique!==void 0){const He=j.extra.technique;for(const Qe in He){const yt=He[Qe];switch(Qe){case"double_sided":$.side=yt===1?Zpe:PT;break;case"bump":$.normalMap=W(yt.texture),$.normalScale=new Er(1,1);break}}}return $}function ke(F){return g(Dt.materials[F],ze)}function lt(F){const L={name:F.getAttribute("name")};for(let j=0,$=F.childNodes.length;j<$;j++){const W=F.childNodes[j];if(W.nodeType===1)switch(W.nodeName){case"optics":L.optics=wt(W);break}}Dt.cameras[F.getAttribute("id")]=L}function wt(F){for(let L=0;L<F.childNodes.length;L++){const j=F.childNodes[L];switch(j.nodeName){case"technique_common":return De(j)}}return{}}function De(F){const L={};for(let j=0;j<F.childNodes.length;j++){const $=F.childNodes[j];switch($.nodeName){case"perspective":case"orthographic":L.technique=$.nodeName,L.parameters=et($);break}}return L}function et(F){const L={};for(let j=0;j<F.childNodes.length;j++){const $=F.childNodes[j];switch($.nodeName){case"xfov":case"yfov":case"xmag":case"ymag":case"znear":case"zfar":case"aspect_ratio":L[$.nodeName]=parseFloat($.textContent);break}}return L}function St(F){let L;switch(F.optics.technique){case"perspective":L=new Mx(F.optics.parameters.yfov,F.optics.parameters.aspect_ratio,F.optics.parameters.znear,F.optics.parameters.zfar);break;case"orthographic":let j=F.optics.parameters.ymag,$=F.optics.parameters.xmag;const W=F.optics.parameters.aspect_ratio;$=$===void 0?j*W:$,j=j===void 0?$/W:j,$*=.5,j*=.5,L=new eF(-$,$,j,-j,F.optics.parameters.znear,F.optics.parameters.zfar);break;default:L=new Mx;break}return L.name=F.name||"",L}function At(F){const L=Dt.cameras[F];return L!==void 0?g(L,St):(console.warn("THREE.ColladaLoader: Couldn't find camera with ID:",F),null)}function tt(F){let L={};for(let j=0,$=F.childNodes.length;j<$;j++){const W=F.childNodes[j];if(W.nodeType===1)switch(W.nodeName){case"technique_common":L=en(W);break}}Dt.lights[F.getAttribute("id")]=L}function en(F){const L={};for(let j=0,$=F.childNodes.length;j<$;j++){const W=F.childNodes[j];if(W.nodeType===1)switch(W.nodeName){case"directional":case"point":case"spot":case"ambient":L.technique=W.nodeName,L.parameters=$t(W)}}return L}function $t(F){const L={};for(let j=0,$=F.childNodes.length;j<$;j++){const W=F.childNodes[j];if(W.nodeType===1)switch(W.nodeName){case"color":const xe=o(W.textContent);L.color=new wr().fromArray(xe).convertSRGBToLinear();break;case"falloff_angle":L.falloffAngle=parseFloat(W.textContent);break;case"quadratic_attenuation":const Pe=parseFloat(W.textContent);L.distance=Pe?Math.sqrt(1/Pe):0;break}}return L}function fn(F){let L;switch(F.technique){case"directional":L=new KK;break;case"point":L=new zO;break;case"spot":L=new XK;break;case"ambient":L=new YK;break}return F.parameters.color&&L.color.copy(F.parameters.color),F.parameters.distance&&(L.distance=F.parameters.distance),L}function ue(F){const L=Dt.lights[F];return L!==void 0?g(L,fn):(console.warn("THREE.ColladaLoader: Couldn't find light with ID:",F),null)}function Ye(F){const L={name:F.getAttribute("name"),sources:{},vertices:{},primitives:[]},j=i(F,"mesh")[0];if(j!==void 0){for(let $=0;$<j.childNodes.length;$++){const W=j.childNodes[$];if(W.nodeType!==1)continue;const xe=W.getAttribute("id");switch(W.nodeName){case"source":L.sources[xe]=Se(W);break;case"vertices":L.vertices=Re(W);break;case"polygons":console.warn("THREE.ColladaLoader: Unsupported primitive type: ",W.nodeName);break;case"lines":case"linestrips":case"polylist":case"triangles":L.primitives.push(Je(W));break;default:console.log(W)}}Dt.geometries[F.getAttribute("id")]=L}}function Se(F){const L={array:[],stride:3};for(let j=0;j<F.childNodes.length;j++){const $=F.childNodes[j];if($.nodeType===1)switch($.nodeName){case"float_array":L.array=o($.textContent);break;case"Name_array":L.array=s($.textContent);break;case"technique_common":const W=i($,"accessor")[0];W!==void 0&&(L.stride=parseInt(W.getAttribute("stride")));break}}return L}function Re(F){const L={};for(let j=0;j<F.childNodes.length;j++){const $=F.childNodes[j];$.nodeType===1&&(L[$.getAttribute("semantic")]=l($.getAttribute("source")))}return L}function Je(F){const L={type:F.nodeName,material:F.getAttribute("material"),count:parseInt(F.getAttribute("count")),inputs:{},stride:0,hasUV:!1};for(let j=0,$=F.childNodes.length;j<$;j++){const W=F.childNodes[j];if(W.nodeType===1)switch(W.nodeName){case"input":const xe=l(W.getAttribute("source")),Pe=W.getAttribute("semantic"),rt=parseInt(W.getAttribute("offset")),He=parseInt(W.getAttribute("set")),Qe=He>0?Pe+He:Pe;L.inputs[Qe]={id:xe,offset:rt},L.stride=Math.max(L.stride,rt+1),Pe==="TEXCOORD"&&(L.hasUV=!0);break;case"vcount":L.vcount=a(W.textContent);break;case"p":L.p=a(W.textContent);break}}return L}function Ze(F){const L={};for(let j=0;j<F.length;j++){const $=F[j];L[$.type]===void 0&&(L[$.type]=[]),L[$.type].push($)}return L}function Gt(F){let L=0;for(let j=0,$=F.length;j<$;j++)F[j].hasUV===!0&&L++;L>0&&L<F.length&&(F.uvsNeedsFix=!0)}function Vn(F){const L={},j=F.sources,$=F.vertices,W=F.primitives;if(W.length===0)return{};const xe=Ze(W);for(const Pe in xe){const rt=xe[Pe];Gt(rt),L[Pe]=yi(rt,j,$)}return L}function yi(F,L,j){const $={},W={array:[],stride:0},xe={array:[],stride:0},Pe={array:[],stride:0},rt={array:[],stride:0},He={array:[],stride:0},Qe={array:[],stride:4},yt={array:[],stride:4},Ie=new Cm,dt=[];let ut=0;for(let Mt=0;Mt<F.length;Mt++){const bt=F[Mt],ur=bt.inputs;let En=0;switch(bt.type){case"lines":case"linestrips":En=bt.count*2;break;case"triangles":En=bt.count*3;break;case"polylist":for(let mn=0;mn<bt.count;mn++){const gn=bt.vcount[mn];switch(gn){case 3:En+=3;break;case 4:En+=6;break;default:En+=(gn-2)*3;break}}break;default:console.warn("THREE.ColladaLoader: Unknow primitive type:",bt.type)}Ie.addGroup(ut,En,Mt),ut+=En,bt.material&&dt.push(bt.material);for(const mn in ur){const gn=ur[mn];switch(mn){case"VERTEX":for(const Zl in j){const $s=j[Zl];switch(Zl){case"POSITION":const jd=W.array.length;if(Xt(bt,L[$s],gn.offset,W.array),W.stride=L[$s].stride,L.skinWeights&&L.skinIndices&&(Xt(bt,L.skinIndices,gn.offset,Qe.array),Xt(bt,L.skinWeights,gn.offset,yt.array)),bt.hasUV===!1&&F.uvsNeedsFix===!0){const Aie=(W.array.length-jd)/W.stride;for(let JB=0;JB<Aie;JB++)Pe.array.push(0,0)}break;case"NORMAL":Xt(bt,L[$s],gn.offset,xe.array),xe.stride=L[$s].stride;break;case"COLOR":Xt(bt,L[$s],gn.offset,He.array),He.stride=L[$s].stride;break;case"TEXCOORD":Xt(bt,L[$s],gn.offset,Pe.array),Pe.stride=L[$s].stride;break;case"TEXCOORD1":Xt(bt,L[$s],gn.offset,rt.array),Pe.stride=L[$s].stride;break;default:console.warn('THREE.ColladaLoader: Semantic "%s" not handled in geometry build process.',Zl)}}break;case"NORMAL":Xt(bt,L[gn.id],gn.offset,xe.array),xe.stride=L[gn.id].stride;break;case"COLOR":Xt(bt,L[gn.id],gn.offset,He.array,!0),He.stride=L[gn.id].stride;break;case"TEXCOORD":Xt(bt,L[gn.id],gn.offset,Pe.array),Pe.stride=L[gn.id].stride;break;case"TEXCOORD1":Xt(bt,L[gn.id],gn.offset,rt.array),rt.stride=L[gn.id].stride;break}}}return W.array.length>0&&Ie.setAttribute("position",new ns(W.array,W.stride)),xe.array.length>0&&Ie.setAttribute("normal",new ns(xe.array,xe.stride)),He.array.length>0&&Ie.setAttribute("color",new ns(He.array,He.stride)),Pe.array.length>0&&Ie.setAttribute("uv",new ns(Pe.array,Pe.stride)),rt.array.length>0&&Ie.setAttribute("uv1",new ns(rt.array,rt.stride)),Qe.array.length>0&&Ie.setAttribute("skinIndex",new ns(Qe.array,Qe.stride)),yt.array.length>0&&Ie.setAttribute("skinWeight",new ns(yt.array,yt.stride)),$.data=Ie,$.type=F[0].type,$.materialKeys=dt,$}function Xt(F,L,j,$,W=!1){const xe=F.p,Pe=F.stride,rt=F.vcount;function He(Ie){let dt=xe[Ie+j]*yt;const ut=dt+yt;for(;dt<ut;dt++)$.push(Qe[dt]);if(W){const Mt=$.length-yt-1;Lr.setRGB($[Mt+0],$[Mt+1],$[Mt+2]).convertSRGBToLinear(),$[Mt+0]=Lr.r,$[Mt+1]=Lr.g,$[Mt+2]=Lr.b}}const Qe=L.array,yt=L.stride;if(F.vcount!==void 0){let Ie=0;for(let dt=0,ut=rt.length;dt<ut;dt++){const Mt=rt[dt];if(Mt===4){const bt=Ie+Pe*0,ur=Ie+Pe*1,En=Ie+Pe*2,mn=Ie+Pe*3;He(bt),He(ur),He(mn),He(ur),He(En),He(mn)}else if(Mt===3){const bt=Ie+Pe*0,ur=Ie+Pe*1,En=Ie+Pe*2;He(bt),He(ur),He(En)}else if(Mt>4)for(let bt=1,ur=Mt-2;bt<=ur;bt++){const En=Ie+Pe*0,mn=Ie+Pe*bt,gn=Ie+Pe*(bt+1);He(En),He(mn),He(gn)}Ie+=Pe*Mt}}else for(let Ie=0,dt=xe.length;Ie<dt;Ie+=Pe)He(Ie)}function Us(F){return g(Dt.geometries[F],Vn)}function ya(F){const L={name:F.getAttribute("name")||"",joints:{},links:[]};for(let j=0;j<F.childNodes.length;j++){const $=F.childNodes[j];if($.nodeType===1)switch($.nodeName){case"technique_common":Kl($,L);break}}Dt.kinematicsModels[F.getAttribute("id")]=L}function G_(F){return F.build!==void 0?F.build:F}function H_(F){return g(Dt.kinematicsModels[F],G_)}function Kl(F,L){for(let j=0;j<F.childNodes.length;j++){const $=F.childNodes[j];if($.nodeType===1)switch($.nodeName){case"joint":L.joints[$.getAttribute("sid")]=Fy($);break;case"link":L.links.push(By($));break}}}function Fy(F){let L;for(let j=0;j<F.childNodes.length;j++){const $=F.childNodes[j];if($.nodeType===1)switch($.nodeName){case"prismatic":case"revolute":L=W_($);break}}return L}function W_(F){const L={sid:F.getAttribute("sid"),name:F.getAttribute("name")||"",axis:new me,limits:{min:0,max:0},type:F.nodeName,static:!1,zeroPosition:0,middlePosition:0};for(let j=0;j<F.childNodes.length;j++){const $=F.childNodes[j];if($.nodeType===1)switch($.nodeName){case"axis":const W=o($.textContent);L.axis.fromArray(W);break;case"limits":const xe=$.getElementsByTagName("max")[0],Pe=$.getElementsByTagName("min")[0];L.limits.max=parseFloat(xe.textContent),L.limits.min=parseFloat(Pe.textContent);break}}return L.limits.min>=L.limits.max&&(L.static=!0),L.middlePosition=(L.limits.min+L.limits.max)/2,L}function By(F){const L={sid:F.getAttribute("sid"),name:F.getAttribute("name")||"",attachments:[],transforms:[]};for(let j=0;j<F.childNodes.length;j++){const $=F.childNodes[j];if($.nodeType===1)switch($.nodeName){case"attachment_full":L.attachments.push(Ud($));break;case"matrix":case"translate":case"rotate":L.transforms.push(Uy($));break}}return L}function Ud(F){const L={joint:F.getAttribute("joint").split("/").pop(),transforms:[],links:[]};for(let j=0;j<F.childNodes.length;j++){const $=F.childNodes[j];if($.nodeType===1)switch($.nodeName){case"link":L.links.push(By($));break;case"matrix":case"translate":case"rotate":L.transforms.push(Uy($));break}}return L}function Uy(F){const L={type:F.nodeName},j=o(F.textContent);switch(L.type){case"matrix":L.obj=new _t,L.obj.fromArray(j).transpose();break;case"translate":L.obj=new me,L.obj.fromArray(j);break;case"rotate":L.obj=new me,L.obj.fromArray(j),L.angle=zr.degToRad(j[3]);break}return L}function zd(F){const L={name:F.getAttribute("name")||"",rigidBodies:{}};for(let j=0;j<F.childNodes.length;j++){const $=F.childNodes[j];if($.nodeType===1)switch($.nodeName){case"rigid_body":L.rigidBodies[$.getAttribute("name")]={},q_($,L.rigidBodies[$.getAttribute("name")]);break}}Dt.physicsModels[F.getAttribute("id")]=L}function q_(F,L){for(let j=0;j<F.childNodes.length;j++){const $=F.childNodes[j];if($.nodeType===1)switch($.nodeName){case"technique_common":X_($,L);break}}}function X_(F,L){for(let j=0;j<F.childNodes.length;j++){const $=F.childNodes[j];if($.nodeType===1)switch($.nodeName){case"inertia":L.inertia=o($.textContent);break;case"mass":L.mass=o($.textContent)[0];break}}}function vC(F){const L={bindJointAxis:[]};for(let j=0;j<F.childNodes.length;j++){const $=F.childNodes[j];if($.nodeType===1)switch($.nodeName){case"bind_joint_axis":L.bindJointAxis.push(xC($));break}}Dt.kinematicsScenes[l(F.getAttribute("url"))]=L}function xC(F){const L={target:F.getAttribute("target").split("/").pop()};for(let j=0;j<F.childNodes.length;j++){const $=F.childNodes[j];if($.nodeType===1)switch($.nodeName){case"axis":const W=$.getElementsByTagName("param")[0];L.axis=W.textContent;const xe=L.axis.split("inst_").pop().split("axis")[0];L.jointIndex=xe.substring(0,xe.length-1);break}}return L}function bC(F){return F.build!==void 0?F.build:F}function _C(F){return g(Dt.kinematicsScenes[F],bC)}function wC(){const F=Object.keys(Dt.kinematicsModels)[0],L=Object.keys(Dt.kinematicsScenes)[0],j=Object.keys(Dt.visualScenes)[0];if(F===void 0||L===void 0)return;const $=H_(F),W=_C(L),xe=ln(j),Pe=W.bindJointAxis,rt={};for(let yt=0,Ie=Pe.length;yt<Ie;yt++){const dt=Pe[yt],ut=Bn.querySelector('[sid="'+dt.target+'"]');if(ut){const Mt=ut.parentElement;He(dt.jointIndex,Mt)}}function He(yt,Ie){const dt=Ie.getAttribute("name"),ut=$.joints[yt];xe.traverse(function(Mt){Mt.name===dt&&(rt[yt]={object:Mt,transforms:SC(Ie),joint:ut,position:ut.zeroPosition})})}const Qe=new _t;$d={joints:$&&$.joints,getJointValue:function(yt){const Ie=rt[yt];if(Ie)return Ie.position;console.warn("THREE.ColladaLoader: Joint "+yt+" doesn't exist.")},setJointValue:function(yt,Ie){const dt=rt[yt];if(dt){const ut=dt.joint;if(Ie>ut.limits.max||Ie<ut.limits.min)console.warn("THREE.ColladaLoader: Joint "+yt+" value "+Ie+" outside of limits (min: "+ut.limits.min+", max: "+ut.limits.max+").");else if(ut.static)console.warn("THREE.ColladaLoader: Joint "+yt+" is static.");else{const Mt=dt.object,bt=ut.axis,ur=dt.transforms;le.identity();for(let En=0;En<ur.length;En++){const mn=ur[En];if(mn.sid&&mn.sid.indexOf(yt)!==-1)switch(ut.type){case"revolute":le.multiply(Qe.makeRotationAxis(bt,zr.degToRad(Ie)));break;case"prismatic":le.multiply(Qe.makeTranslation(bt.x*Ie,bt.y*Ie,bt.z*Ie));break;default:console.warn("THREE.ColladaLoader: Unknown joint type: "+ut.type);break}else switch(mn.type){case"matrix":le.multiply(mn.obj);break;case"translate":le.multiply(Qe.makeTranslation(mn.obj.x,mn.obj.y,mn.obj.z));break;case"scale":le.scale(mn.obj);break;case"rotate":le.multiply(Qe.makeRotationAxis(mn.obj,mn.angle));break}}Mt.matrix.copy(le),Mt.matrix.decompose(Mt.position,Mt.quaternion,Mt.scale),rt[yt].position=Ie}}else console.log("THREE.ColladaLoader: "+yt+" does not exist.")}}}function SC(F){const L=[],j=Bn.querySelector('[id="'+F.id+'"]');for(let $=0;$<j.childNodes.length;$++){const W=j.childNodes[$];if(W.nodeType!==1)continue;let xe,Pe;switch(W.nodeName){case"matrix":xe=o(W.textContent);const rt=new _t().fromArray(xe).transpose();L.push({sid:W.getAttribute("sid"),type:W.nodeName,obj:rt});break;case"translate":case"scale":xe=o(W.textContent),Pe=new me().fromArray(xe),L.push({sid:W.getAttribute("sid"),type:W.nodeName,obj:Pe});break;case"rotate":xe=o(W.textContent),Pe=new me().fromArray(xe);const He=zr.degToRad(xe[3]);L.push({sid:W.getAttribute("sid"),type:W.nodeName,obj:Pe,angle:He});break}}return L}function V(F){const L=F.getElementsByTagName("node");for(let j=0;j<L.length;j++){const $=L[j];$.hasAttribute("id")===!1&&$.setAttribute("id",c())}}const le=new _t,ge=new me;function ve(F){const L={name:F.getAttribute("name")||"",type:F.getAttribute("type"),id:F.getAttribute("id"),sid:F.getAttribute("sid"),matrix:new _t,nodes:[],instanceCameras:[],instanceControllers:[],instanceLights:[],instanceGeometries:[],instanceNodes:[],transforms:{}};for(let j=0;j<F.childNodes.length;j++){const $=F.childNodes[j];if($.nodeType!==1)continue;let W;switch($.nodeName){case"node":L.nodes.push($.getAttribute("id")),ve($);break;case"instance_camera":L.instanceCameras.push(l($.getAttribute("url")));break;case"instance_controller":L.instanceControllers.push(de($));break;case"instance_light":L.instanceLights.push(l($.getAttribute("url")));break;case"instance_geometry":L.instanceGeometries.push(de($));break;case"instance_node":L.instanceNodes.push(l($.getAttribute("url")));break;case"matrix":W=o($.textContent),L.matrix.multiply(le.fromArray(W).transpose()),L.transforms[$.getAttribute("sid")]=$.nodeName;break;case"translate":W=o($.textContent),ge.fromArray(W),L.matrix.multiply(le.makeTranslation(ge.x,ge.y,ge.z)),L.transforms[$.getAttribute("sid")]=$.nodeName;break;case"rotate":W=o($.textContent);const xe=zr.degToRad(W[3]);L.matrix.multiply(le.makeRotationAxis(ge.fromArray(W),xe)),L.transforms[$.getAttribute("sid")]=$.nodeName;break;case"scale":W=o($.textContent),L.matrix.scale(ge.fromArray(W)),L.transforms[$.getAttribute("sid")]=$.nodeName;break;case"extra":break;default:console.log($)}}return xt(L.id)?console.warn("THREE.ColladaLoader: There is already a node with ID %s. Exclude current node from further processing.",L.id):Dt.nodes[L.id]=L,L}function de(F){const L={id:l(F.getAttribute("url")),materials:{},skeletons:[]};for(let j=0;j<F.childNodes.length;j++){const $=F.childNodes[j];switch($.nodeName){case"bind_material":const W=$.getElementsByTagName("instance_material");for(let xe=0;xe<W.length;xe++){const Pe=W[xe],rt=Pe.getAttribute("symbol"),He=Pe.getAttribute("target");L.materials[rt]=l(He)}break;case"skeleton":L.skeletons.push(l($.textContent));break}}return L}function Ue(F,L){const j=[],$=[];let W,xe,Pe;for(W=0;W<F.length;W++){const Qe=F[W];let yt;if(xt(Qe))yt=Yt(Qe),qe(yt,L,j);else if(nr(Qe)){const dt=Dt.visualScenes[Qe].children;for(let ut=0;ut<dt.length;ut++){const Mt=dt[ut];if(Mt.type==="JOINT"){const bt=Yt(Mt.id);qe(bt,L,j)}}}else console.error("THREE.ColladaLoader: Unable to find root bone of skeleton with ID:",Qe)}for(W=0;W<L.length;W++)for(xe=0;xe<j.length;xe++)if(Pe=j[xe],Pe.bone.name===L[W].name){$[W]=Pe,Pe.processed=!0;break}for(W=0;W<j.length;W++)Pe=j[W],Pe.processed===!1&&($.push(Pe),Pe.processed=!0);const rt=[],He=[];for(W=0;W<$.length;W++)Pe=$[W],rt.push(Pe.bone),He.push(Pe.boneInverse);return new zM(rt,He)}function qe(F,L,j){F.traverse(function($){if($.isBone===!0){let W;for(let xe=0;xe<L.length;xe++){const Pe=L[xe];if(Pe.name===$.name){W=Pe.boneInverse;break}}W===void 0&&(W=new _t),j.push({bone:$,boneInverse:W,processed:!1})}})}function nt(F){const L=[],j=F.matrix,$=F.nodes,W=F.type,xe=F.instanceCameras,Pe=F.instanceControllers,rt=F.instanceLights,He=F.instanceGeometries,Qe=F.instanceNodes;for(let Ie=0,dt=$.length;Ie<dt;Ie++)L.push(Yt($[Ie]));for(let Ie=0,dt=xe.length;Ie<dt;Ie++){const ut=At(xe[Ie]);ut!==null&&L.push(ut.clone())}for(let Ie=0,dt=Pe.length;Ie<dt;Ie++){const ut=Pe[Ie],Mt=J(ut.id),bt=Us(Mt.id),ur=Ot(bt,ut.materials),En=ut.skeletons,mn=Mt.skin.joints,gn=Ue(En,mn);for(let Zl=0,$s=ur.length;Zl<$s;Zl++){const jd=ur[Zl];jd.isSkinnedMesh&&(jd.bind(gn,Mt.skin.bindMatrix),jd.normalizeSkinWeights()),L.push(jd)}}for(let Ie=0,dt=rt.length;Ie<dt;Ie++){const ut=ue(rt[Ie]);ut!==null&&L.push(ut.clone())}for(let Ie=0,dt=He.length;Ie<dt;Ie++){const ut=He[Ie],Mt=Us(ut.id),bt=Ot(Mt,ut.materials);for(let ur=0,En=bt.length;ur<En;ur++)L.push(bt[ur])}for(let Ie=0,dt=Qe.length;Ie<dt;Ie++)L.push(Yt(Qe[Ie]).clone());let yt;if($.length===0&&L.length===1)yt=L[0];else{yt=W==="JOINT"?new kT:new DT;for(let Ie=0;Ie<L.length;Ie++)yt.add(L[Ie])}return yt.name=W==="JOINT"?F.sid:F.name,yt.matrix.copy(j),yt.matrix.decompose(yt.position,yt.quaternion,yt.scale),yt}const at=new LO({name:Fl.DEFAULT_MATERIAL_NAME,color:16711935});function It(F,L){const j=[];for(let $=0,W=F.length;$<W;$++){const xe=L[F[$]];xe===void 0?(console.warn("THREE.ColladaLoader: Material with key %s not found. Apply fallback material.",F[$]),j.push(at)):j.push(ke(xe))}return j}function Ot(F,L){const j=[];for(const $ in F){const W=F[$],xe=It(W.materialKeys,L);if(xe.length===0&&($==="lines"||$==="linestrips"?xe.push(new IT):xe.push(new D0)),$==="lines"||$==="linestrips")for(let Qe=0,yt=xe.length;Qe<yt;Qe++){const Ie=xe[Qe];if(Ie.isMeshPhongMaterial===!0||Ie.isMeshLambertMaterial===!0){const dt=new IT;dt.color.copy(Ie.color),dt.opacity=Ie.opacity,dt.transparent=Ie.transparent,xe[Qe]=dt}}const Pe=W.data.attributes.skinIndex!==void 0,rt=xe.length===1?xe[0]:xe;let He;switch($){case"lines":He=new Kme(W.data,rt);break;case"linestrips":He=new tF(W.data,rt);break;case"triangles":case"polylist":Pe?He=new UK(W.data,rt):He=new JL(W.data,rt);break}j.push(He)}return j}function xt(F){return Dt.nodes[F]!==void 0}function Yt(F){return g(Dt.nodes[F],nt)}function dn(F){const L={name:F.getAttribute("name"),children:[]};V(F);const j=i(F,"node");for(let $=0;$<j.length;$++)L.children.push(ve(j[$]));Dt.visualScenes[F.getAttribute("id")]=L}function cr(F){const L=new DT;L.name=F.name;const j=F.children;for(let $=0;$<j.length;$++){const W=j[$];L.add(Yt(W.id))}return L}function nr(F){return Dt.visualScenes[F]!==void 0}function ln(F){return g(Dt.visualScenes[F],cr)}function Et(F){const L=i(F,"instance_visual_scene")[0];return ln(l(L.getAttribute("url")))}function ei(){const F=Dt.clips;if(u(F)===!0){if(u(Dt.animations)===!1){const L=[];for(const j in Dt.animations){const $=w(j);for(let W=0,xe=$.length;W<xe;W++)L.push($[W])}ti.push(new UO("default",-1,L))}}else for(const L in F)ti.push(U(L))}function pn(F){let L="";const j=[F];for(;j.length;){const $=j.shift();$.nodeType===Node.TEXT_NODE?L+=$.textContent:(L+=`
`,j.push.apply(j,$.childNodes))}return L.trim()}if(e.length===0)return{scene:new Wme};const zs=new DOMParser().parseFromString(e,"application/xml"),Bn=i(zs,"COLLADA")[0],Ri=zs.getElementsByTagName("parsererror")[0];if(Ri!==void 0){const F=i(Ri,"div")[0];let L;return F?L=F.textContent:L=pn(Ri),console.error(`THREE.ColladaLoader: Failed to parse collada file.
`,L),null}const Jh=Bn.getAttribute("version");console.debug("THREE.ColladaLoader: File version",Jh);const On=h(i(Bn,"asset")[0]),us=new qK(this.manager);us.setPath(this.resourcePath||n).setCrossOrigin(this.crossOrigin);let Gi;sV&&(Gi=new sV(this.manager),Gi.setPath(this.resourcePath||n));const Lr=new wr,ti=[];let $d={},Yl=0;const Dt={animations:{},clips:{},controllers:{},images:{},effects:{},materials:{},cameras:{},lights:{},geometries:{},nodes:{},visualScenes:{},kinematicsModels:{},physicsModels:{},kinematicsScenes:{}};p(Bn,"library_animations","animation",v),p(Bn,"library_animation_clips","animation_clip",R),p(Bn,"library_controllers","controller",G),p(Bn,"library_images","image",se),p(Bn,"library_effects","effect",ye),p(Bn,"library_materials","material",ce),p(Bn,"library_cameras","camera",lt),p(Bn,"library_lights","light",tt),p(Bn,"library_geometries","geometry",Ye),p(Bn,"library_nodes","node",ve),p(Bn,"library_visual_scenes","visual_scene",dn),p(Bn,"library_kinematics_models","kinematics_model",ya),p(Bn,"library_physics_models","physics_model",zd),p(Bn,"scene","instance_kinematics_scene",vC),m(Dt.animations,b),m(Dt.clips,z),m(Dt.controllers,he),m(Dt.images,oe),m(Dt.effects,ne),m(Dt.materials,ze),m(Dt.cameras,St),m(Dt.lights,fn),m(Dt.geometries,Vn),m(Dt.visualScenes,cr),ei(),wC();const K_=Et(i(Bn,"scene")[0]);return K_.animations=ti,On.upAxis==="Z_UP"&&(console.warn("THREE.ColladaLoader: You are loading an asset with a Z-UP coordinate system. The loader just rotates the asset to transform it into Y-UP. The vertex data are not converted, see #24289."),K_.rotation.set(-Math.PI/2,0,0)),K_.scale.multiplyScalar(On.unit),{get animations(){return console.warn("THREE.ColladaLoader: Please access animations over scene.animations now."),ti},kinematics:$d,library:Dt,scene:K_}}}THREE.ColladaLoader=Uge;AFRAME.registerComponent("collada-model-legacy",{schema:{type:"asset"},init:function(){this.model=null,this.loader=new THREE.ColladaLoader},update:function(){var r=this,e=this.el,n=this.data,i=this.el.sceneEl.systems.renderer;n&&(this.remove(),this.loader.load(n,function(s){r.model=s.scene,r.model.traverse(function(o){if(o.isMesh){var a=o.material;a.color&&i.applyColorCorrection(a.color),a.map&&i.applyColorCorrection(a.map),a.emissive&&i.applyColorCorrection(a.emissive),a.emissiveMap&&i.applyColorCorrection(a.emissiveMap)}}),e.setObject3D("mesh",r.model),e.emit("model-loaded",{format:"collada",model:r.model})}))},remove:function(){this.model&&this.el.removeObject3D("mesh")}});/*!
fflate - fast JavaScript compression/decompression
<https://101arrowz.github.io/fflate>
Licensed under MIT. https://github.com/101arrowz/fflate/blob/master/LICENSE
version 0.8.2
*/var ea=Uint8Array,sm=Uint16Array,zge=Int32Array,QK=new ea([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),JK=new ea([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),$ge=new ea([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),eY=function(r,e){for(var n=new sm(31),i=0;i<31;++i)n[i]=e+=1<<r[i-1];for(var s=new zge(n[30]),i=1;i<30;++i)for(var o=n[i];o<n[i+1];++o)s[o]=o-n[i]<<5|i;return{b:n,r:s}},tY=eY(QK,2),nY=tY.b,jge=tY.r;nY[28]=258,jge[258]=28;var Vge=eY(JK,0),Gge=Vge.b,$O=new sm(32768);for(var Qn=0;Qn<32768;++Qn){var Du=(Qn&43690)>>1|(Qn&21845)<<1;Du=(Du&52428)>>2|(Du&13107)<<2,Du=(Du&61680)>>4|(Du&3855)<<4,$O[Qn]=((Du&65280)>>8|(Du&255)<<8)>>1}var k0=function(r,e,n){for(var i=r.length,s=0,o=new sm(e);s<i;++s)r[s]&&++o[r[s]-1];var a=new sm(e);for(s=1;s<e;++s)a[s]=a[s-1]+o[s-1]<<1;var l;if(n){l=new sm(1<<e);var c=15-e;for(s=0;s<i;++s)if(r[s])for(var u=s<<4|r[s],h=e-r[s],f=a[r[s]-1]++<<h,d=f|(1<<h)-1;f<=d;++f)l[$O[f]>>c]=u}else for(l=new sm(i),s=0;s<i;++s)r[s]&&(l[s]=$O[a[r[s]-1]++]>>15-r[s]);return l},l_=new ea(288);for(var Qn=0;Qn<144;++Qn)l_[Qn]=8;for(var Qn=144;Qn<256;++Qn)l_[Qn]=9;for(var Qn=256;Qn<280;++Qn)l_[Qn]=7;for(var Qn=280;Qn<288;++Qn)l_[Qn]=8;var rY=new ea(32);for(var Qn=0;Qn<32;++Qn)rY[Qn]=5;var Hge=k0(l_,9,1),Wge=k0(rY,5,1),VP=function(r){for(var e=r[0],n=1;n<r.length;++n)r[n]>e&&(e=r[n]);return e},Sa=function(r,e,n){var i=e/8|0;return(r[i]|r[i+1]<<8)>>(e&7)&n},GP=function(r,e){var n=e/8|0;return(r[n]|r[n+1]<<8|r[n+2]<<16)>>(e&7)},qge=function(r){return(r+7)/8|0},Xge=function(r,e,n){return(n==null||n>r.length)&&(n=r.length),new ea(r.subarray(e,n))},Kge=["unexpected EOF","invalid block type","invalid length/literal","invalid distance","stream finished","no stream handler",,"no callback","invalid UTF-8 data","extra field too long","date not in range 1980-2099","filename too long","stream finishing","invalid zip data"],ka=function(r,e,n){var i=new Error(e||Kge[r]);if(i.code=r,Error.captureStackTrace&&Error.captureStackTrace(i,ka),!n)throw i;return i},Yge=function(r,e,n,i){var s=r.length,o=0;if(!s||e.f&&!e.l)return n||new ea(0);var a=!n,l=a||e.i!=2,c=e.i;a&&(n=new ea(s*3));var u=function(Ge){var _e=n.length;if(Ge>_e){var Ke=new ea(Math.max(_e*2,Ge));Ke.set(n),n=Ke}},h=e.f||0,f=e.p||0,d=e.b||0,p=e.l,m=e.d,g=e.m,v=e.n,y=s*8;do{if(!p){h=Sa(r,f,1);var x=Sa(r,f+1,3);if(f+=3,x)if(x==1)p=Hge,m=Wge,g=9,v=5;else if(x==2){var S=Sa(r,f,31)+257,T=Sa(r,f+10,15)+4,E=S+Sa(r,f+5,31)+1;f+=14;for(var M=new ea(E),A=new ea(19),P=0;P<T;++P)A[$ge[P]]=Sa(r,f+P*3,7);f+=T*3;for(var D=VP(A),B=(1<<D)-1,C=k0(A,D,1),P=0;P<E;){var O=C[Sa(r,f,B)];f+=O&15;var b=O>>4;if(b<16)M[P++]=b;else{var R=0,z=0;for(b==16?(z=3+Sa(r,f,3),f+=2,R=M[P-1]):b==17?(z=3+Sa(r,f,7),f+=3):b==18&&(z=11+Sa(r,f,127),f+=7);z--;)M[P++]=R}}var U=M.subarray(0,S),G=M.subarray(S);g=VP(U),v=VP(G),p=k0(U,g,1),m=k0(G,v,1)}else ka(1);else{var b=qge(f)+4,w=r[b-4]|r[b-3]<<8,_=b+w;if(_>s){c&&ka(0);break}l&&u(d+w),n.set(r.subarray(b,_),d),e.b=d+=w,e.p=f=_*8,e.f=h;continue}if(f>y){c&&ka(0);break}}l&&u(d+131072);for(var H=(1<<g)-1,Y=(1<<v)-1,ee=f;;ee=f){var R=p[GP(r,f)&H],he=R>>4;if(f+=R&15,f>y){c&&ka(0);break}if(R||ka(2),he<256)n[d++]=he;else if(he==256){ee=f,p=null;break}else{var q=he-254;if(he>264){var P=he-257,J=QK[P];q=Sa(r,f,(1<<J)-1)+nY[P],f+=J}var se=m[GP(r,f)&Y],oe=se>>4;se||ka(3),f+=se&15;var G=Gge[oe];if(oe>3){var J=JK[oe];G+=GP(r,f)&(1<<J)-1,f+=J}if(f>y){c&&ka(0);break}l&&u(d+131072);var Ee=d+q;if(d<G){var ye=o-G,Ce=Math.min(G,Ee);for(ye+d<0&&ka(3);d<Ce;++d)n[d]=i[ye+d]}for(;d<Ee;++d)n[d]=n[d-G]}}e.l=p,e.p=ee,e.b=d,e.f=h,p&&(h=1,e.m=g,e.d=m,e.n=v)}while(!h);return d!=n.length&&a?Xge(n,0,d):n.subarray(0,d)},Zge=new ea(0),Qge=function(r,e){return((r[0]&15)!=8||r[0]>>4>7||(r[0]<<8|r[1])%31)&&ka(6,"invalid zlib data"),(r[1]>>5&1)==+!e&&ka(6,"invalid zlib data: "+(r[1]&32?"need":"unexpected")+" dictionary"),(r[1]>>3&4)+2};function Jge(r,e){return Yge(r.subarray(Qge(r,e),-4),{i:2},e,e)}var eye=typeof TextDecoder<"u"&&new TextDecoder,tye=0;try{eye.decode(Zge,{stream:!0}),tye=1}catch{}function iY(r,e,n){const i=n.length-r-1;if(e>=n[i])return i-1;if(e<=n[r])return r;let s=r,o=i,a=Math.floor((s+o)/2);for(;e<n[a]||e>=n[a+1];)e<n[a]?o=a:s=a,a=Math.floor((s+o)/2);return a}function nye(r,e,n,i){const s=[],o=[],a=[];s[0]=1;for(let l=1;l<=n;++l){o[l]=e-i[r+1-l],a[l]=i[r+l]-e;let c=0;for(let u=0;u<l;++u){const h=a[u+1],f=o[l-u],d=s[u]/(h+f);s[u]=c+h*d,c=f*d}s[l]=c}return s}function rye(r,e,n,i){const s=iY(r,i,e),o=nye(s,i,r,e),a=new Hs(0,0,0,0);for(let l=0;l<=r;++l){const c=n[s-r+l],u=o[l],h=c.w*u;a.x+=c.x*h,a.y+=c.y*h,a.z+=c.z*h,a.w+=c.w*u}return a}function iye(r,e,n,i,s){const o=[];for(let f=0;f<=n;++f)o[f]=0;const a=[];for(let f=0;f<=i;++f)a[f]=o.slice(0);const l=[];for(let f=0;f<=n;++f)l[f]=o.slice(0);l[0][0]=1;const c=o.slice(0),u=o.slice(0);for(let f=1;f<=n;++f){c[f]=e-s[r+1-f],u[f]=s[r+f]-e;let d=0;for(let p=0;p<f;++p){const m=u[p+1],g=c[f-p];l[f][p]=m+g;const v=l[p][f-1]/l[f][p];l[p][f]=d+m*v,d=g*v}l[f][f]=d}for(let f=0;f<=n;++f)a[0][f]=l[f][n];for(let f=0;f<=n;++f){let d=0,p=1;const m=[];for(let g=0;g<=n;++g)m[g]=o.slice(0);m[0][0]=1;for(let g=1;g<=i;++g){let v=0;const y=f-g,x=n-g;f>=g&&(m[p][0]=m[d][0]/l[x+1][y],v=m[p][0]*l[y][x]);const b=y>=-1?1:-y,w=f-1<=x?g-1:n-f;for(let S=b;S<=w;++S)m[p][S]=(m[d][S]-m[d][S-1])/l[x+1][y+S],v+=m[p][S]*l[y+S][x];f<=x&&(m[p][g]=-m[d][g-1]/l[x+1][f],v+=m[p][g]*l[f][x]),a[g][f]=v;const _=d;d=p,p=_}}let h=n;for(let f=1;f<=i;++f){for(let d=0;d<=n;++d)a[f][d]*=h;h*=n-f}return a}function sye(r,e,n,i,s){const o=s<r?s:r,a=[],l=iY(r,i,e),c=iye(l,i,r,o,e),u=[];for(let h=0;h<n.length;++h){const f=n[h].clone(),d=f.w;f.x*=d,f.y*=d,f.z*=d,u[h]=f}for(let h=0;h<=o;++h){const f=u[l-r].clone().multiplyScalar(c[h][0]);for(let d=1;d<=r;++d)f.add(u[l-r+d].clone().multiplyScalar(c[h][d]));a[h]=f}for(let h=o+1;h<=s+1;++h)a[h]=new Hs(0,0,0);return a}function oye(r,e){let n=1;for(let s=2;s<=r;++s)n*=s;let i=1;for(let s=2;s<=e;++s)i*=s;for(let s=2;s<=r-e;++s)i*=s;return n/i}function aye(r){const e=r.length,n=[],i=[];for(let o=0;o<e;++o){const a=r[o];n[o]=new me(a.x,a.y,a.z),i[o]=a.w}const s=[];for(let o=0;o<e;++o){const a=n[o].clone();for(let l=1;l<=o;++l)a.sub(s[o-l].clone().multiplyScalar(oye(o,l)*i[l]));s[o]=a.divideScalar(i[0])}return s}function lye(r,e,n,i,s){const o=sye(r,e,n,i,s);return aye(o)}class cye extends Yme{constructor(e,n,i,s,o){super(),this.degree=e,this.knots=n,this.controlPoints=[],this.startKnot=s||0,this.endKnot=o||this.knots.length-1;for(let a=0;a<i.length;++a){const l=i[a];this.controlPoints[a]=new Hs(l.x,l.y,l.z,l.w)}}getPoint(e,n=new me){const i=n,s=this.knots[this.startKnot]+e*(this.knots[this.endKnot]-this.knots[this.startKnot]),o=rye(this.degree,this.knots,this.controlPoints,s);return o.w!==1&&o.divideScalar(o.w),i.set(o.x,o.y,o.z)}getTangent(e,n=new me){const i=n,s=this.knots[0]+e*(this.knots[this.knots.length-1]-this.knots[0]),o=lye(this.degree,this.knots,this.controlPoints,s,1);return i.copy(o[1]).normalize(),i}}let tn,Cr,ps;class uye extends Fl{constructor(e){super(e)}load(e,n,i,s){const o=this,a=o.path===""?ZK.extractUrlBase(e):o.path,l=new rF(this.manager);l.setPath(o.path),l.setResponseType("arraybuffer"),l.setRequestHeader(o.requestHeader),l.setWithCredentials(o.withCredentials),l.load(e,function(c){try{n(o.parse(c,a))}catch(u){s?s(u):console.error(u),o.manager.itemError(e)}},i,s)}parse(e,n){if(gye(e))tn=new mye().parse(e);else{const s=lY(e);if(!yye(s))throw new Error("THREE.FBXLoader: Unknown format.");if(aV(s)<7e3)throw new Error("THREE.FBXLoader: FBX version not supported, FileVersion: "+aV(s));tn=new pye().parse(s)}const i=new qK(this.manager).setPath(this.resourcePath||n).setCrossOrigin(this.crossOrigin);return new hye(i,this.manager).parse(tn)}}class hye{constructor(e,n){this.textureLoader=e,this.manager=n}parse(){Cr=this.parseConnections();const e=this.parseImages(),n=this.parseTextures(e),i=this.parseMaterials(n),s=this.parseDeformers(),o=new fye().parse(s);return this.parseScene(s,o,i),ps}parseConnections(){const e=new Map;return"Connections"in tn&&tn.Connections.connections.forEach(function(i){const s=i[0],o=i[1],a=i[2];e.has(s)||e.set(s,{parents:[],children:[]});const l={ID:o,relationship:a};e.get(s).parents.push(l),e.has(o)||e.set(o,{parents:[],children:[]});const c={ID:s,relationship:a};e.get(o).children.push(c)}),e}parseImages(){const e={},n={};if("Video"in tn.Objects){const i=tn.Objects.Video;for(const s in i){const o=i[s],a=parseInt(s);if(e[a]=o.RelativeFilename||o.Filename,"Content"in o){const l=o.Content instanceof ArrayBuffer&&o.Content.byteLength>0,c=typeof o.Content=="string"&&o.Content!=="";if(l||c){const u=this.parseImage(i[s]);n[o.RelativeFilename||o.Filename]=u}}}}for(const i in e){const s=e[i];n[s]!==void 0?e[i]=n[s]:e[i]=e[i].split("\\").pop()}return e}parseImage(e){const n=e.Content,i=e.RelativeFilename||e.Filename,s=i.slice(i.lastIndexOf(".")+1).toLowerCase();let o;switch(s){case"bmp":o="image/bmp";break;case"jpg":case"jpeg":o="image/jpeg";break;case"png":o="image/png";break;case"tif":o="image/tiff";break;case"tga":this.manager.getHandler(".tga")===null&&console.warn("FBXLoader: TGA loader not found, skipping ",i),o="image/tga";break;default:console.warn('FBXLoader: Image type "'+s+'" is not supported.');return}if(typeof n=="string")return"data:"+o+";base64,"+n;{const a=new Uint8Array(n);return window.URL.createObjectURL(new Blob([a],{type:o}))}}parseTextures(e){const n=new Map;if("Texture"in tn.Objects){const i=tn.Objects.Texture;for(const s in i){const o=this.parseTexture(i[s],e);n.set(parseInt(s),o)}}return n}parseTexture(e,n){const i=this.loadTexture(e,n);i.ID=e.id,i.name=e.attrName;const s=e.WrapModeU,o=e.WrapModeV,a=s!==void 0?s.value:0,l=o!==void 0?o.value:0;if(i.wrapS=a===0?oh:Sl,i.wrapT=l===0?oh:Sl,"Scaling"in e){const c=e.Scaling.value;i.repeat.x=c[0],i.repeat.y=c[1]}if("Translation"in e){const c=e.Translation.value;i.offset.x=c[0],i.offset.y=c[1]}return i}loadTexture(e,n){let i;const s=this.textureLoader.path,o=Cr.get(e.id).children;o!==void 0&&o.length>0&&n[o[0].ID]!==void 0&&(i=n[o[0].ID],(i.indexOf("blob:")===0||i.indexOf("data:")===0)&&this.textureLoader.setPath(void 0));let a;const l=e.FileName.slice(-3).toLowerCase();if(l==="tga"){const c=this.manager.getHandler(".tga");c===null?(console.warn("FBXLoader: TGA loader not found, creating placeholder texture for",e.RelativeFilename),a=new Gc):(c.setPath(this.textureLoader.path),a=c.load(i))}else if(l==="dds"){const c=this.manager.getHandler(".dds");c===null?(console.warn("FBXLoader: DDS loader not found, creating placeholder texture for",e.RelativeFilename),a=new Gc):(c.setPath(this.textureLoader.path),a=c.load(i))}else l==="psd"?(console.warn("FBXLoader: PSD textures are not supported, creating placeholder texture for",e.RelativeFilename),a=new Gc):a=this.textureLoader.load(i);return this.textureLoader.setPath(s),a}parseMaterials(e){const n=new Map;if("Material"in tn.Objects){const i=tn.Objects.Material;for(const s in i){const o=this.parseMaterial(i[s],e);o!==null&&n.set(parseInt(s),o)}}return n}parseMaterial(e,n){const i=e.id,s=e.attrName;let o=e.ShadingModel;if(typeof o=="object"&&(o=o.value),!Cr.has(i))return null;const a=this.parseParameters(e,n,i);let l;switch(o.toLowerCase()){case"phong":l=new D0;break;case"lambert":l=new GK;break;default:console.warn('THREE.FBXLoader: unknown material type "%s". Defaulting to MeshPhongMaterial.',o),l=new D0;break}return l.setValues(a),l.name=s,l}parseParameters(e,n,i){const s={};e.BumpFactor&&(s.bumpScale=e.BumpFactor.value),e.Diffuse?s.color=new wr().fromArray(e.Diffuse.value).convertSRGBToLinear():e.DiffuseColor&&(e.DiffuseColor.type==="Color"||e.DiffuseColor.type==="ColorRGB")&&(s.color=new wr().fromArray(e.DiffuseColor.value).convertSRGBToLinear()),e.DisplacementFactor&&(s.displacementScale=e.DisplacementFactor.value),e.Emissive?s.emissive=new wr().fromArray(e.Emissive.value).convertSRGBToLinear():e.EmissiveColor&&(e.EmissiveColor.type==="Color"||e.EmissiveColor.type==="ColorRGB")&&(s.emissive=new wr().fromArray(e.EmissiveColor.value).convertSRGBToLinear()),e.EmissiveFactor&&(s.emissiveIntensity=parseFloat(e.EmissiveFactor.value)),e.Opacity&&(s.opacity=parseFloat(e.Opacity.value)),s.opacity<1&&(s.transparent=!0),e.ReflectionFactor&&(s.reflectivity=e.ReflectionFactor.value),e.Shininess&&(s.shininess=e.Shininess.value),e.Specular?s.specular=new wr().fromArray(e.Specular.value).convertSRGBToLinear():e.SpecularColor&&e.SpecularColor.type==="Color"&&(s.specular=new wr().fromArray(e.SpecularColor.value).convertSRGBToLinear());const o=this;return Cr.get(i).children.forEach(function(a){const l=a.relationship;switch(l){case"Bump":s.bumpMap=o.getTexture(n,a.ID);break;case"Maya|TEX_ao_map":s.aoMap=o.getTexture(n,a.ID);break;case"DiffuseColor":case"Maya|TEX_color_map":s.map=o.getTexture(n,a.ID),s.map!==void 0&&(s.map.colorSpace=Ss);break;case"DisplacementColor":s.displacementMap=o.getTexture(n,a.ID);break;case"EmissiveColor":s.emissiveMap=o.getTexture(n,a.ID),s.emissiveMap!==void 0&&(s.emissiveMap.colorSpace=Ss);break;case"NormalMap":case"Maya|TEX_normal_map":s.normalMap=o.getTexture(n,a.ID);break;case"ReflectionColor":s.envMap=o.getTexture(n,a.ID),s.envMap!==void 0&&(s.envMap.mapping=Jpe,s.envMap.colorSpace=Ss);break;case"SpecularColor":s.specularMap=o.getTexture(n,a.ID),s.specularMap!==void 0&&(s.specularMap.colorSpace=Ss);break;case"TransparentColor":case"TransparencyFactor":s.alphaMap=o.getTexture(n,a.ID),s.transparent=!0;break;case"AmbientColor":case"ShininessExponent":case"SpecularFactor":case"VectorDisplacementColor":default:console.warn("THREE.FBXLoader: %s map is not supported in three.js, skipping texture.",l);break}}),s}getTexture(e,n){return"LayeredTexture"in tn.Objects&&n in tn.Objects.LayeredTexture&&(console.warn("THREE.FBXLoader: layered textures are not supported in three.js. Discarding all but first layer."),n=Cr.get(n).children[0].ID),e.get(n)}parseDeformers(){const e={},n={};if("Deformer"in tn.Objects){const i=tn.Objects.Deformer;for(const s in i){const o=i[s],a=Cr.get(parseInt(s));if(o.attrType==="Skin"){const l=this.parseSkeleton(a,i);l.ID=s,a.parents.length>1&&console.warn("THREE.FBXLoader: skeleton attached to more than one geometry is not supported."),l.geometryID=a.parents[0].ID,e[s]=l}else if(o.attrType==="BlendShape"){const l={id:s};l.rawTargets=this.parseMorphTargets(a,i),l.id=s,a.parents.length>1&&console.warn("THREE.FBXLoader: morph target attached to more than one geometry is not supported."),n[s]=l}}}return{skeletons:e,morphTargets:n}}parseSkeleton(e,n){const i=[];return e.children.forEach(function(s){const o=n[s.ID];if(o.attrType!=="Cluster")return;const a={ID:s.ID,indices:[],weights:[],transformLink:new _t().fromArray(o.TransformLink.a)};"Indexes"in o&&(a.indices=o.Indexes.a,a.weights=o.Weights.a),i.push(a)}),{rawBones:i,bones:[]}}parseMorphTargets(e,n){const i=[];for(let s=0;s<e.children.length;s++){const o=e.children[s],a=n[o.ID],l={name:a.attrName,initialWeight:a.DeformPercent,id:a.id,fullWeights:a.FullWeights.a};if(a.attrType!=="BlendShapeChannel")return;l.geoID=Cr.get(parseInt(o.ID)).children.filter(function(c){return c.relationship===void 0})[0].ID,i.push(l)}return i}parseScene(e,n,i){ps=new DT;const s=this.parseModels(e.skeletons,n,i),o=tn.Objects.Model,a=this;s.forEach(function(c){const u=o[c.ID];a.setLookAtProperties(c,u),Cr.get(c.ID).parents.forEach(function(f){const d=s.get(f.ID);d!==void 0&&d.add(c)}),c.parent===null&&ps.add(c)}),this.bindSkeleton(e.skeletons,n,s),this.addGlobalSceneSettings(),ps.traverse(function(c){if(c.userData.transformData){c.parent&&(c.userData.transformData.parentMatrix=c.parent.matrix,c.userData.transformData.parentMatrixWorld=c.parent.matrixWorld);const u=oY(c.userData.transformData);c.applyMatrix4(u),c.updateWorldMatrix()}});const l=new dye().parse();ps.children.length===1&&ps.children[0].isGroup&&(ps.children[0].animations=l,ps=ps.children[0]),ps.animations=l}parseModels(e,n,i){const s=new Map,o=tn.Objects.Model;for(const a in o){const l=parseInt(a),c=o[a],u=Cr.get(l);let h=this.buildSkeleton(u,e,l,c.attrName);if(!h){switch(c.attrType){case"Camera":h=this.createCamera(u);break;case"Light":h=this.createLight(u);break;case"Mesh":h=this.createMesh(u,n,i);break;case"NurbsCurve":h=this.createCurve(u,n);break;case"LimbNode":case"Root":h=new kT;break;case"Null":default:h=new DT;break}h.name=c.attrName?yn.sanitizeNodeName(c.attrName):"",h.userData.originalName=c.attrName,h.ID=l}this.getTransformData(h,c),s.set(l,h)}return s}buildSkeleton(e,n,i,s){let o=null;return e.parents.forEach(function(a){for(const l in n){const c=n[l];c.rawBones.forEach(function(u,h){if(u.ID===a.ID){const f=o;o=new kT,o.matrixWorld.copy(u.transformLink),o.name=s?yn.sanitizeNodeName(s):"",o.userData.originalName=s,o.ID=i,c.bones[h]=o,f!==null&&o.add(f)}})}}),o}createCamera(e){let n,i;if(e.children.forEach(function(s){const o=tn.Objects.NodeAttribute[s.ID];o!==void 0&&(i=o)}),i===void 0)n=new Ai;else{let s=0;i.CameraProjectionType!==void 0&&i.CameraProjectionType.value===1&&(s=1);let o=1;i.NearPlane!==void 0&&(o=i.NearPlane.value/1e3);let a=1e3;i.FarPlane!==void 0&&(a=i.FarPlane.value/1e3);let l=window.innerWidth,c=window.innerHeight;i.AspectWidth!==void 0&&i.AspectHeight!==void 0&&(l=i.AspectWidth.value,c=i.AspectHeight.value);const u=l/c;let h=45;i.FieldOfView!==void 0&&(h=i.FieldOfView.value);const f=i.FocalLength?i.FocalLength.value:null;switch(s){case 0:n=new Mx(h,u,o,a),f!==null&&n.setFocalLength(f);break;case 1:n=new eF(-l/2,l/2,c/2,-c/2,o,a);break;default:console.warn("THREE.FBXLoader: Unknown camera type "+s+"."),n=new Ai;break}}return n}createLight(e){let n,i;if(e.children.forEach(function(s){const o=tn.Objects.NodeAttribute[s.ID];o!==void 0&&(i=o)}),i===void 0)n=new Ai;else{let s;i.LightType===void 0?s=0:s=i.LightType.value;let o=16777215;i.Color!==void 0&&(o=new wr().fromArray(i.Color.value).convertSRGBToLinear());let a=i.Intensity===void 0?1:i.Intensity.value/100;i.CastLightOnObject!==void 0&&i.CastLightOnObject.value===0&&(a=0);let l=0;i.FarAttenuationEnd!==void 0&&(i.EnableFarAttenuation!==void 0&&i.EnableFarAttenuation.value===0?l=0:l=i.FarAttenuationEnd.value);const c=1;switch(s){case 0:n=new zO(o,a,l,c);break;case 1:n=new KK(o,a);break;case 2:let u=Math.PI/3;i.InnerAngle!==void 0&&(u=zr.degToRad(i.InnerAngle.value));let h=0;i.OuterAngle!==void 0&&(h=zr.degToRad(i.OuterAngle.value),h=Math.max(h,1)),n=new XK(o,a,l,u,h,c);break;default:console.warn("THREE.FBXLoader: Unknown light type "+i.LightType.value+", defaulting to a PointLight."),n=new zO(o,a);break}i.CastShadows!==void 0&&i.CastShadows.value===1&&(n.castShadow=!0)}return n}createMesh(e,n,i){let s,o=null,a=null;const l=[];return e.children.forEach(function(c){n.has(c.ID)&&(o=n.get(c.ID)),i.has(c.ID)&&l.push(i.get(c.ID))}),l.length>1?a=l:l.length>0?a=l[0]:(a=new D0({name:Fl.DEFAULT_MATERIAL_NAME,color:13421772}),l.push(a)),"color"in o.attributes&&l.forEach(function(c){c.vertexColors=!0}),o.FBX_Deformer?(s=new UK(o,a),s.normalizeSkinWeights()):s=new JL(o,a),s}createCurve(e,n){const i=e.children.reduce(function(o,a){return n.has(a.ID)&&(o=n.get(a.ID)),o},null),s=new IT({name:Fl.DEFAULT_MATERIAL_NAME,color:3342591,linewidth:1});return new tF(i,s)}getTransformData(e,n){const i={};"InheritType"in n&&(i.inheritType=parseInt(n.InheritType.value)),"RotationOrder"in n?i.eulerOrder=aY(n.RotationOrder.value):i.eulerOrder="ZYX","Lcl_Translation"in n&&(i.translation=n.Lcl_Translation.value),"PreRotation"in n&&(i.preRotation=n.PreRotation.value),"Lcl_Rotation"in n&&(i.rotation=n.Lcl_Rotation.value),"PostRotation"in n&&(i.postRotation=n.PostRotation.value),"Lcl_Scaling"in n&&(i.scale=n.Lcl_Scaling.value),"ScalingOffset"in n&&(i.scalingOffset=n.ScalingOffset.value),"ScalingPivot"in n&&(i.scalingPivot=n.ScalingPivot.value),"RotationOffset"in n&&(i.rotationOffset=n.RotationOffset.value),"RotationPivot"in n&&(i.rotationPivot=n.RotationPivot.value),e.userData.transformData=i}setLookAtProperties(e,n){"LookAtProperty"in n&&Cr.get(e.ID).children.forEach(function(s){if(s.relationship==="LookAtProperty"){const o=tn.Objects.Model[s.ID];if("Lcl_Translation"in o){const a=o.Lcl_Translation.value;e.target!==void 0?(e.target.position.fromArray(a),ps.add(e.target)):e.lookAt(new me().fromArray(a))}}})}bindSkeleton(e,n,i){const s=this.parsePoseNodes();for(const o in e){const a=e[o];Cr.get(parseInt(a.ID)).parents.forEach(function(c){if(n.has(c.ID)){const u=c.ID;Cr.get(u).parents.forEach(function(f){i.has(f.ID)&&i.get(f.ID).bind(new zM(a.bones),s[f.ID])})}})}}parsePoseNodes(){const e={};if("Pose"in tn.Objects){const n=tn.Objects.Pose;for(const i in n)if(n[i].attrType==="BindPose"&&n[i].NbPoseNodes>0){const s=n[i].PoseNode;Array.isArray(s)?s.forEach(function(o){e[o.Node]=new _t().fromArray(o.Matrix.a)}):e[s.Node]=new _t().fromArray(s.Matrix.a)}}return e}addGlobalSceneSettings(){if("GlobalSettings"in tn){if("AmbientColor"in tn.GlobalSettings){const e=tn.GlobalSettings.AmbientColor.value,n=e[0],i=e[1],s=e[2];if(n!==0||i!==0||s!==0){const o=new wr(n,i,s).convertSRGBToLinear();ps.add(new YK(o,1))}}"UnitScaleFactor"in tn.GlobalSettings&&(ps.userData.unitScaleFactor=tn.GlobalSettings.UnitScaleFactor.value)}}}class fye{constructor(){this.negativeMaterialIndices=!1}parse(e){const n=new Map;if("Geometry"in tn.Objects){const i=tn.Objects.Geometry;for(const s in i){const o=Cr.get(parseInt(s)),a=this.parseGeometry(o,i[s],e);n.set(parseInt(s),a)}}return this.negativeMaterialIndices===!0&&console.warn("THREE.FBXLoader: The FBX file contains invalid (negative) material indices. The asset might not render as expected."),n}parseGeometry(e,n,i){switch(n.attrType){case"Mesh":return this.parseMeshGeometry(e,n,i);case"NurbsCurve":return this.parseNurbsGeometry(n)}}parseMeshGeometry(e,n,i){const s=i.skeletons,o=[],a=e.parents.map(function(f){return tn.Objects.Model[f.ID]});if(a.length===0)return;const l=e.children.reduce(function(f,d){return s[d.ID]!==void 0&&(f=s[d.ID]),f},null);e.children.forEach(function(f){i.morphTargets[f.ID]!==void 0&&o.push(i.morphTargets[f.ID])});const c=a[0],u={};"RotationOrder"in c&&(u.eulerOrder=aY(c.RotationOrder.value)),"InheritType"in c&&(u.inheritType=parseInt(c.InheritType.value)),"GeometricTranslation"in c&&(u.translation=c.GeometricTranslation.value),"GeometricRotation"in c&&(u.rotation=c.GeometricRotation.value),"GeometricScaling"in c&&(u.scale=c.GeometricScaling.value);const h=oY(u);return this.genGeometry(n,l,o,h)}genGeometry(e,n,i,s){const o=new Cm;e.attrName&&(o.name=e.attrName);const a=this.parseGeoNode(e,n),l=this.genBuffers(a),c=new ns(l.vertex,3);if(c.applyMatrix4(s),o.setAttribute("position",c),l.colors.length>0&&o.setAttribute("color",new ns(l.colors,3)),n&&(o.setAttribute("skinIndex",new LK(l.weightsIndices,4)),o.setAttribute("skinWeight",new ns(l.vertexWeights,4)),o.FBX_Deformer=n),l.normal.length>0){const u=new zh().getNormalMatrix(s),h=new ns(l.normal,3);h.applyNormalMatrix(u),o.setAttribute("normal",h)}if(l.uvs.forEach(function(u,h){const f=h===0?"uv":`uv${h}`;o.setAttribute(f,new ns(l.uvs[h],2))}),a.material&&a.material.mappingType!=="AllSame"){let u=l.materialIndex[0],h=0;if(l.materialIndex.forEach(function(f,d){f!==u&&(o.addGroup(h,d-h,u),u=f,h=d)}),o.groups.length>0){const f=o.groups[o.groups.length-1],d=f.start+f.count;d!==l.materialIndex.length&&o.addGroup(d,l.materialIndex.length-d,u)}o.groups.length===0&&o.addGroup(0,l.materialIndex.length,l.materialIndex[0])}return this.addMorphTargets(o,e,i,s),o}parseGeoNode(e,n){const i={};if(i.vertexPositions=e.Vertices!==void 0?e.Vertices.a:[],i.vertexIndices=e.PolygonVertexIndex!==void 0?e.PolygonVertexIndex.a:[],e.LayerElementColor&&(i.color=this.parseVertexColors(e.LayerElementColor[0])),e.LayerElementMaterial&&(i.material=this.parseMaterialIndices(e.LayerElementMaterial[0])),e.LayerElementNormal&&(i.normal=this.parseNormals(e.LayerElementNormal[0])),e.LayerElementUV){i.uv=[];let s=0;for(;e.LayerElementUV[s];)e.LayerElementUV[s].UV&&i.uv.push(this.parseUVs(e.LayerElementUV[s])),s++}return i.weightTable={},n!==null&&(i.skeleton=n,n.rawBones.forEach(function(s,o){s.indices.forEach(function(a,l){i.weightTable[a]===void 0&&(i.weightTable[a]=[]),i.weightTable[a].push({id:o,weight:s.weights[l]})})})),i}genBuffers(e){const n={vertex:[],normal:[],colors:[],uvs:[],materialIndex:[],vertexWeights:[],weightsIndices:[]};let i=0,s=0,o=!1,a=[],l=[],c=[],u=[],h=[],f=[];const d=this;return e.vertexIndices.forEach(function(p,m){let g,v=!1;p<0&&(p=p^-1,v=!0);let y=[],x=[];if(a.push(p*3,p*3+1,p*3+2),e.color){const b=Hw(m,i,p,e.color);c.push(b[0],b[1],b[2])}if(e.skeleton){if(e.weightTable[p]!==void 0&&e.weightTable[p].forEach(function(b){x.push(b.weight),y.push(b.id)}),x.length>4){o||(console.warn("THREE.FBXLoader: Vertex has more than 4 skinning weights assigned to vertex. Deleting additional weights."),o=!0);const b=[0,0,0,0],w=[0,0,0,0];x.forEach(function(_,S){let T=_,E=y[S];w.forEach(function(M,A,P){if(T>M){P[A]=T,T=M;const D=b[A];b[A]=E,E=D}})}),y=b,x=w}for(;x.length<4;)x.push(0),y.push(0);for(let b=0;b<4;++b)h.push(x[b]),f.push(y[b])}if(e.normal){const b=Hw(m,i,p,e.normal);l.push(b[0],b[1],b[2])}e.material&&e.material.mappingType!=="AllSame"&&(g=Hw(m,i,p,e.material)[0],g<0&&(d.negativeMaterialIndices=!0,g=0)),e.uv&&e.uv.forEach(function(b,w){const _=Hw(m,i,p,b);u[w]===void 0&&(u[w]=[]),u[w].push(_[0]),u[w].push(_[1])}),s++,v&&(d.genFace(n,e,a,g,l,c,u,h,f,s),i++,s=0,a=[],l=[],c=[],u=[],h=[],f=[])}),n}getNormalNewell(e){const n=new me(0,0,0);for(let i=0;i<e.length;i++){const s=e[i],o=e[(i+1)%e.length];n.x+=(s.y-o.y)*(s.z+o.z),n.y+=(s.z-o.z)*(s.x+o.x),n.z+=(s.x-o.x)*(s.y+o.y)}return n.normalize(),n}getNormalTangentAndBitangent(e){const n=this.getNormalNewell(e),s=(Math.abs(n.z)>.5?new me(0,1,0):new me(0,0,1)).cross(n).normalize(),o=n.clone().cross(s).normalize();return{normal:n,tangent:s,bitangent:o}}flattenVertex(e,n,i){return new Er(e.dot(n),e.dot(i))}genFace(e,n,i,s,o,a,l,c,u,h){let f;if(h>3){const d=[];for(let v=0;v<i.length;v+=3)d.push(new me(n.vertexPositions[i[v]],n.vertexPositions[i[v+1]],n.vertexPositions[i[v+2]]));const{tangent:p,bitangent:m}=this.getNormalTangentAndBitangent(d),g=[];for(const v of d)g.push(this.flattenVertex(v,p,m));f=nF.triangulateShape(g,[])}else f=[[0,1,2]];for(const[d,p,m]of f)e.vertex.push(n.vertexPositions[i[d*3]]),e.vertex.push(n.vertexPositions[i[d*3+1]]),e.vertex.push(n.vertexPositions[i[d*3+2]]),e.vertex.push(n.vertexPositions[i[p*3]]),e.vertex.push(n.vertexPositions[i[p*3+1]]),e.vertex.push(n.vertexPositions[i[p*3+2]]),e.vertex.push(n.vertexPositions[i[m*3]]),e.vertex.push(n.vertexPositions[i[m*3+1]]),e.vertex.push(n.vertexPositions[i[m*3+2]]),n.skeleton&&(e.vertexWeights.push(c[d*4]),e.vertexWeights.push(c[d*4+1]),e.vertexWeights.push(c[d*4+2]),e.vertexWeights.push(c[d*4+3]),e.vertexWeights.push(c[p*4]),e.vertexWeights.push(c[p*4+1]),e.vertexWeights.push(c[p*4+2]),e.vertexWeights.push(c[p*4+3]),e.vertexWeights.push(c[m*4]),e.vertexWeights.push(c[m*4+1]),e.vertexWeights.push(c[m*4+2]),e.vertexWeights.push(c[m*4+3]),e.weightsIndices.push(u[d*4]),e.weightsIndices.push(u[d*4+1]),e.weightsIndices.push(u[d*4+2]),e.weightsIndices.push(u[d*4+3]),e.weightsIndices.push(u[p*4]),e.weightsIndices.push(u[p*4+1]),e.weightsIndices.push(u[p*4+2]),e.weightsIndices.push(u[p*4+3]),e.weightsIndices.push(u[m*4]),e.weightsIndices.push(u[m*4+1]),e.weightsIndices.push(u[m*4+2]),e.weightsIndices.push(u[m*4+3])),n.color&&(e.colors.push(a[d*3]),e.colors.push(a[d*3+1]),e.colors.push(a[d*3+2]),e.colors.push(a[p*3]),e.colors.push(a[p*3+1]),e.colors.push(a[p*3+2]),e.colors.push(a[m*3]),e.colors.push(a[m*3+1]),e.colors.push(a[m*3+2])),n.material&&n.material.mappingType!=="AllSame"&&(e.materialIndex.push(s),e.materialIndex.push(s),e.materialIndex.push(s)),n.normal&&(e.normal.push(o[d*3]),e.normal.push(o[d*3+1]),e.normal.push(o[d*3+2]),e.normal.push(o[p*3]),e.normal.push(o[p*3+1]),e.normal.push(o[p*3+2]),e.normal.push(o[m*3]),e.normal.push(o[m*3+1]),e.normal.push(o[m*3+2])),n.uv&&n.uv.forEach(function(g,v){e.uvs[v]===void 0&&(e.uvs[v]=[]),e.uvs[v].push(l[v][d*2]),e.uvs[v].push(l[v][d*2+1]),e.uvs[v].push(l[v][p*2]),e.uvs[v].push(l[v][p*2+1]),e.uvs[v].push(l[v][m*2]),e.uvs[v].push(l[v][m*2+1])})}addMorphTargets(e,n,i,s){if(i.length===0)return;e.morphTargetsRelative=!0,e.morphAttributes.position=[];const o=this;i.forEach(function(a){a.rawTargets.forEach(function(l){const c=tn.Objects.Geometry[l.geoID];c!==void 0&&o.genMorphGeometry(e,n,c,s,l.name)})})}genMorphGeometry(e,n,i,s,o){const a=n.PolygonVertexIndex!==void 0?n.PolygonVertexIndex.a:[],l=i.Vertices!==void 0?i.Vertices.a:[],c=i.Indexes!==void 0?i.Indexes.a:[],u=e.attributes.position.count*3,h=new Float32Array(u);for(let m=0;m<c.length;m++){const g=c[m]*3;h[g]=l[m*3],h[g+1]=l[m*3+1],h[g+2]=l[m*3+2]}const f={vertexIndices:a,vertexPositions:h},d=this.genBuffers(f),p=new ns(d.vertex,3);p.name=o||i.attrName,p.applyMatrix4(s),e.morphAttributes.position.push(p)}parseNormals(e){const n=e.MappingInformationType,i=e.ReferenceInformationType,s=e.Normals.a;let o=[];return i==="IndexToDirect"&&("NormalIndex"in e?o=e.NormalIndex.a:"NormalsIndex"in e&&(o=e.NormalsIndex.a)),{dataSize:3,buffer:s,indices:o,mappingType:n,referenceType:i}}parseUVs(e){const n=e.MappingInformationType,i=e.ReferenceInformationType,s=e.UV.a;let o=[];return i==="IndexToDirect"&&(o=e.UVIndex.a),{dataSize:2,buffer:s,indices:o,mappingType:n,referenceType:i}}parseVertexColors(e){const n=e.MappingInformationType,i=e.ReferenceInformationType,s=e.Colors.a;let o=[];i==="IndexToDirect"&&(o=e.ColorIndex.a);for(let a=0,l=new wr;a<s.length;a+=4)l.fromArray(s,a).convertSRGBToLinear().toArray(s,a);return{dataSize:4,buffer:s,indices:o,mappingType:n,referenceType:i}}parseMaterialIndices(e){const n=e.MappingInformationType,i=e.ReferenceInformationType;if(n==="NoMappingInformation")return{dataSize:1,buffer:[0],indices:[0],mappingType:"AllSame",referenceType:i};const s=e.Materials.a,o=[];for(let a=0;a<s.length;++a)o.push(a);return{dataSize:1,buffer:s,indices:o,mappingType:n,referenceType:i}}parseNurbsGeometry(e){const n=parseInt(e.Order);if(isNaN(n))return console.error("THREE.FBXLoader: Invalid Order %s given for geometry ID: %s",e.Order,e.id),new Cm;const i=n-1,s=e.KnotVector.a,o=[],a=e.Points.a;for(let f=0,d=a.length;f<d;f+=4)o.push(new Hs().fromArray(a,f));let l,c;if(e.Form==="Closed")o.push(o[0]);else if(e.Form==="Periodic"){l=i,c=s.length-1-l;for(let f=0;f<i;++f)o.push(o[f])}const h=new cye(i,s,o,l,c).getPoints(o.length*12);return new Cm().setFromPoints(h)}}class dye{parse(){const e=[],n=this.parseClips();if(n!==void 0)for(const i in n){const s=n[i],o=this.addClip(s);e.push(o)}return e}parseClips(){if(tn.Objects.AnimationCurve===void 0)return;const e=this.parseAnimationCurveNodes();this.parseAnimationCurves(e);const n=this.parseAnimationLayers(e);return this.parseAnimStacks(n)}parseAnimationCurveNodes(){const e=tn.Objects.AnimationCurveNode,n=new Map;for(const i in e){const s=e[i];if(s.attrName.match(/S|R|T|DeformPercent/)!==null){const o={id:s.id,attr:s.attrName,curves:{}};n.set(o.id,o)}}return n}parseAnimationCurves(e){const n=tn.Objects.AnimationCurve;for(const i in n){const s={id:n[i].id,times:n[i].KeyTime.a.map(vye),values:n[i].KeyValueFloat.a},o=Cr.get(s.id);if(o!==void 0){const a=o.parents[0].ID,l=o.parents[0].relationship;l.match(/X/)?e.get(a).curves.x=s:l.match(/Y/)?e.get(a).curves.y=s:l.match(/Z/)?e.get(a).curves.z=s:l.match(/DeformPercent/)&&e.has(a)&&(e.get(a).curves.morph=s)}}}parseAnimationLayers(e){const n=tn.Objects.AnimationLayer,i=new Map;for(const s in n){const o=[],a=Cr.get(parseInt(s));a!==void 0&&(a.children.forEach(function(c,u){if(e.has(c.ID)){const h=e.get(c.ID);if(h.curves.x!==void 0||h.curves.y!==void 0||h.curves.z!==void 0){if(o[u]===void 0){const f=Cr.get(c.ID).parents.filter(function(d){return d.relationship!==void 0})[0].ID;if(f!==void 0){const d=tn.Objects.Model[f.toString()];if(d===void 0){console.warn("THREE.FBXLoader: Encountered a unused curve.",c);return}const p={modelName:d.attrName?yn.sanitizeNodeName(d.attrName):"",ID:d.id,initialPosition:[0,0,0],initialRotation:[0,0,0],initialScale:[1,1,1]};ps.traverse(function(m){m.ID===d.id&&(p.transform=m.matrix,m.userData.transformData&&(p.eulerOrder=m.userData.transformData.eulerOrder))}),p.transform||(p.transform=new _t),"PreRotation"in d&&(p.preRotation=d.PreRotation.value),"PostRotation"in d&&(p.postRotation=d.PostRotation.value),o[u]=p}}o[u]&&(o[u][h.attr]=h)}else if(h.curves.morph!==void 0){if(o[u]===void 0){const f=Cr.get(c.ID).parents.filter(function(y){return y.relationship!==void 0})[0].ID,d=Cr.get(f).parents[0].ID,p=Cr.get(d).parents[0].ID,m=Cr.get(p).parents[0].ID,g=tn.Objects.Model[m],v={modelName:g.attrName?yn.sanitizeNodeName(g.attrName):"",morphName:tn.Objects.Deformer[f].attrName};o[u]=v}o[u][h.attr]=h}}}),i.set(parseInt(s),o))}return i}parseAnimStacks(e){const n=tn.Objects.AnimationStack,i={};for(const s in n){const o=Cr.get(parseInt(s)).children;o.length>1&&console.warn("THREE.FBXLoader: Encountered an animation stack with multiple layers, this is currently not supported. Ignoring subsequent layers.");const a=e.get(o[0].ID);i[s]={name:n[s].attrName,layer:a}}return i}addClip(e){let n=[];const i=this;return e.layer.forEach(function(s){n=n.concat(i.generateTracks(s))}),new UO(e.name,-1,n)}generateTracks(e){const n=[];let i=new me,s=new me;if(e.transform&&e.transform.decompose(i,new ws,s),i=i.toArray(),s=s.toArray(),e.T!==void 0&&Object.keys(e.T.curves).length>0){const o=this.generateVectorTrack(e.modelName,e.T.curves,i,"position");o!==void 0&&n.push(o)}if(e.R!==void 0&&Object.keys(e.R.curves).length>0){const o=this.generateRotationTrack(e.modelName,e.R.curves,e.preRotation,e.postRotation,e.eulerOrder);o!==void 0&&n.push(o)}if(e.S!==void 0&&Object.keys(e.S.curves).length>0){const o=this.generateVectorTrack(e.modelName,e.S.curves,s,"scale");o!==void 0&&n.push(o)}if(e.DeformPercent!==void 0){const o=this.generateMorphTrack(e);o!==void 0&&n.push(o)}return n}generateVectorTrack(e,n,i,s){const o=this.getTimesForAllAxes(n),a=this.getKeyframeTrackValues(o,n,i);return new fd(e+"."+s,o,a)}generateRotationTrack(e,n,i,s,o){let a,l;if(n.x!==void 0&&n.y!==void 0&&n.z!==void 0){const f=this.interpolateRotations(n.x,n.y,n.z,o);a=f[0],l=f[1]}i!==void 0&&(i=i.map(zr.degToRad),i.push(o),i=new Fi().fromArray(i),i=new ws().setFromEuler(i)),s!==void 0&&(s=s.map(zr.degToRad),s.push(o),s=new Fi().fromArray(s),s=new ws().setFromEuler(s).invert());const c=new ws,u=new Fi,h=[];if(!l||!a)return new Ah(e+".quaternion",[0],[0]);for(let f=0;f<l.length;f+=3)u.set(l[f],l[f+1],l[f+2],o),c.setFromEuler(u),i!==void 0&&c.premultiply(i),s!==void 0&&c.multiply(s),f>2&&new ws().fromArray(h,(f-3)/3*4).dot(c)<0&&c.set(-c.x,-c.y,-c.z,-c.w),c.toArray(h,f/3*4);return new Ah(e+".quaternion",a,h)}generateMorphTrack(e){const n=e.DeformPercent.curves.morph,i=n.values.map(function(o){return o/100}),s=ps.getObjectByName(e.modelName).morphTargetDictionary[e.morphName];return new Rx(e.modelName+".morphTargetInfluences["+s+"]",n.times,i)}getTimesForAllAxes(e){let n=[];if(e.x!==void 0&&(n=n.concat(e.x.times)),e.y!==void 0&&(n=n.concat(e.y.times)),e.z!==void 0&&(n=n.concat(e.z.times)),n=n.sort(function(i,s){return i-s}),n.length>1){let i=1,s=n[0];for(let o=1;o<n.length;o++){const a=n[o];a!==s&&(n[i]=a,s=a,i++)}n=n.slice(0,i)}return n}getKeyframeTrackValues(e,n,i){const s=i,o=[];let a=-1,l=-1,c=-1;return e.forEach(function(u){if(n.x&&(a=n.x.times.indexOf(u)),n.y&&(l=n.y.times.indexOf(u)),n.z&&(c=n.z.times.indexOf(u)),a!==-1){const h=n.x.values[a];o.push(h),s[0]=h}else o.push(s[0]);if(l!==-1){const h=n.y.values[l];o.push(h),s[1]=h}else o.push(s[1]);if(c!==-1){const h=n.z.values[c];o.push(h),s[2]=h}else o.push(s[2])}),o}interpolateRotations(e,n,i,s){const o=[],a=[];o.push(e.times[0]),a.push(zr.degToRad(e.values[0])),a.push(zr.degToRad(n.values[0])),a.push(zr.degToRad(i.values[0]));for(let l=1;l<e.values.length;l++){const c=[e.values[l-1],n.values[l-1],i.values[l-1]];if(isNaN(c[0])||isNaN(c[1])||isNaN(c[2]))continue;const u=c.map(zr.degToRad),h=[e.values[l],n.values[l],i.values[l]];if(isNaN(h[0])||isNaN(h[1])||isNaN(h[2]))continue;const f=h.map(zr.degToRad),d=[h[0]-c[0],h[1]-c[1],h[2]-c[2]],p=[Math.abs(d[0]),Math.abs(d[1]),Math.abs(d[2])];if(p[0]>=180||p[1]>=180||p[2]>=180){const g=Math.max(...p)/180,v=new Fi(...u,s),y=new Fi(...f,s),x=new ws().setFromEuler(v),b=new ws().setFromEuler(y);x.dot(b)&&b.set(-b.x,-b.y,-b.z,-b.w);const w=e.times[l-1],_=e.times[l]-w,S=new ws,T=new Fi;for(let E=0;E<1;E+=1/g)S.copy(x.clone().slerp(b.clone(),E)),o.push(w+E*_),T.setFromQuaternion(S,s),a.push(T.x),a.push(T.y),a.push(T.z)}else o.push(e.times[l]),a.push(zr.degToRad(e.values[l])),a.push(zr.degToRad(n.values[l])),a.push(zr.degToRad(i.values[l]))}return[o,a]}}class pye{getPrevNode(){return this.nodeStack[this.currentIndent-2]}getCurrentNode(){return this.nodeStack[this.currentIndent-1]}getCurrentProp(){return this.currentProp}pushStack(e){this.nodeStack.push(e),this.currentIndent+=1}popStack(){this.nodeStack.pop(),this.currentIndent-=1}setCurrentProp(e,n){this.currentProp=e,this.currentPropName=n}parse(e){this.currentIndent=0,this.allNodes=new sY,this.nodeStack=[],this.currentProp=[],this.currentPropName="";const n=this,i=e.split(/[\r\n]+/);return i.forEach(function(s,o){const a=s.match(/^[\s\t]*;/),l=s.match(/^[\s\t]*$/);if(a||l)return;const c=s.match("^\\t{"+n.currentIndent+"}(\\w+):(.*){",""),u=s.match("^\\t{"+n.currentIndent+"}(\\w+):[\\s\\t\\r\\n](.*)"),h=s.match("^\\t{"+(n.currentIndent-1)+"}}");c?n.parseNodeBegin(s,c):u?n.parseNodeProperty(s,u,i[++o]):h?n.popStack():s.match(/^[^\s\t}]/)&&n.parseNodePropertyContinued(s)}),this.allNodes}parseNodeBegin(e,n){const i=n[1].trim().replace(/^"/,"").replace(/"$/,""),s=n[2].split(",").map(function(c){return c.trim().replace(/^"/,"").replace(/"$/,"")}),o={name:i},a=this.parseNodeAttr(s),l=this.getCurrentNode();this.currentIndent===0?this.allNodes.add(i,o):i in l?(i==="PoseNode"?l.PoseNode.push(o):l[i].id!==void 0&&(l[i]={},l[i][l[i].id]=l[i]),a.id!==""&&(l[i][a.id]=o)):typeof a.id=="number"?(l[i]={},l[i][a.id]=o):i!=="Properties70"&&(i==="PoseNode"?l[i]=[o]:l[i]=o),typeof a.id=="number"&&(o.id=a.id),a.name!==""&&(o.attrName=a.name),a.type!==""&&(o.attrType=a.type),this.pushStack(o)}parseNodeAttr(e){let n=e[0];e[0]!==""&&(n=parseInt(e[0]),isNaN(n)&&(n=e[0]));let i="",s="";return e.length>1&&(i=e[1].replace(/^(\w+)::/,""),s=e[2]),{id:n,name:i,type:s}}parseNodeProperty(e,n,i){let s=n[1].replace(/^"/,"").replace(/"$/,"").trim(),o=n[2].replace(/^"/,"").replace(/"$/,"").trim();s==="Content"&&o===","&&(o=i.replace(/"/g,"").replace(/,$/,"").trim());const a=this.getCurrentNode();if(a.name==="Properties70"){this.parseNodeSpecialProperty(e,s,o);return}if(s==="C"){const c=o.split(",").slice(1),u=parseInt(c[0]),h=parseInt(c[1]);let f=o.split(",").slice(3);f=f.map(function(d){return d.trim().replace(/^"/,"")}),s="connections",o=[u,h],bye(o,f),a[s]===void 0&&(a[s]=[])}s==="Node"&&(a.id=o),s in a&&Array.isArray(a[s])?a[s].push(o):s!=="a"?a[s]=o:a.a=o,this.setCurrentProp(a,s),s==="a"&&o.slice(-1)!==","&&(a.a=WP(o))}parseNodePropertyContinued(e){const n=this.getCurrentNode();n.a+=e,e.slice(-1)!==","&&(n.a=WP(n.a))}parseNodeSpecialProperty(e,n,i){const s=i.split('",').map(function(h){return h.trim().replace(/^\"/,"").replace(/\s/,"_")}),o=s[0],a=s[1],l=s[2],c=s[3];let u=s[4];switch(a){case"int":case"enum":case"bool":case"ULongLong":case"double":case"Number":case"FieldOfView":u=parseFloat(u);break;case"Color":case"ColorRGB":case"Vector3D":case"Lcl_Translation":case"Lcl_Rotation":case"Lcl_Scaling":u=WP(u);break}this.getPrevNode()[o]={type:a,type2:l,flag:c,value:u},this.setCurrentProp(this.getPrevNode(),o)}}class mye{parse(e){const n=new oV(e);n.skip(23);const i=n.getUint32();if(i<6400)throw new Error("THREE.FBXLoader: FBX version not supported, FileVersion: "+i);const s=new sY;for(;!this.endOfContent(n);){const o=this.parseNode(n,i);o!==null&&s.add(o.name,o)}return s}endOfContent(e){return e.size()%16===0?(e.getOffset()+160+16&-16)>=e.size():e.getOffset()+160+16>=e.size()}parseNode(e,n){const i={},s=n>=7500?e.getUint64():e.getUint32(),o=n>=7500?e.getUint64():e.getUint32();n>=7500?e.getUint64():e.getUint32();const a=e.getUint8(),l=e.getString(a);if(s===0)return null;const c=[];for(let d=0;d<o;d++)c.push(this.parseProperty(e));const u=c.length>0?c[0]:"",h=c.length>1?c[1]:"",f=c.length>2?c[2]:"";for(i.singleProperty=o===1&&e.getOffset()===s;s>e.getOffset();){const d=this.parseNode(e,n);d!==null&&this.parseSubNode(l,i,d)}return i.propertyList=c,typeof u=="number"&&(i.id=u),h!==""&&(i.attrName=h),f!==""&&(i.attrType=f),l!==""&&(i.name=l),i}parseSubNode(e,n,i){if(i.singleProperty===!0){const s=i.propertyList[0];Array.isArray(s)?(n[i.name]=i,i.a=s):n[i.name]=s}else if(e==="Connections"&&i.name==="C"){const s=[];i.propertyList.forEach(function(o,a){a!==0&&s.push(o)}),n.connections===void 0&&(n.connections=[]),n.connections.push(s)}else if(i.name==="Properties70")Object.keys(i).forEach(function(o){n[o]=i[o]});else if(e==="Properties70"&&i.name==="P"){let s=i.propertyList[0],o=i.propertyList[1];const a=i.propertyList[2],l=i.propertyList[3];let c;s.indexOf("Lcl ")===0&&(s=s.replace("Lcl ","Lcl_")),o.indexOf("Lcl ")===0&&(o=o.replace("Lcl ","Lcl_")),o==="Color"||o==="ColorRGB"||o==="Vector"||o==="Vector3D"||o.indexOf("Lcl_")===0?c=[i.propertyList[4],i.propertyList[5],i.propertyList[6]]:c=i.propertyList[4],n[s]={type:o,type2:a,flag:l,value:c}}else n[i.name]===void 0?typeof i.id=="number"?(n[i.name]={},n[i.name][i.id]=i):n[i.name]=i:i.name==="PoseNode"?(Array.isArray(n[i.name])||(n[i.name]=[n[i.name]]),n[i.name].push(i)):n[i.name][i.id]===void 0&&(n[i.name][i.id]=i)}parseProperty(e){const n=e.getString(1);let i;switch(n){case"C":return e.getBoolean();case"D":return e.getFloat64();case"F":return e.getFloat32();case"I":return e.getInt32();case"L":return e.getInt64();case"R":return i=e.getUint32(),e.getArrayBuffer(i);case"S":return i=e.getUint32(),e.getString(i);case"Y":return e.getInt16();case"b":case"c":case"d":case"f":case"i":case"l":const s=e.getUint32(),o=e.getUint32(),a=e.getUint32();if(o===0)switch(n){case"b":case"c":return e.getBooleanArray(s);case"d":return e.getFloat64Array(s);case"f":return e.getFloat32Array(s);case"i":return e.getInt32Array(s);case"l":return e.getInt64Array(s)}const l=Jge(new Uint8Array(e.getArrayBuffer(a))),c=new oV(l.buffer);switch(n){case"b":case"c":return c.getBooleanArray(s);case"d":return c.getFloat64Array(s);case"f":return c.getFloat32Array(s);case"i":return c.getInt32Array(s);case"l":return c.getInt64Array(s)}break;default:throw new Error("THREE.FBXLoader: Unknown property type "+n)}}}class oV{constructor(e,n){this.dv=new DataView(e),this.offset=0,this.littleEndian=n!==void 0?n:!0,this._textDecoder=new TextDecoder}getOffset(){return this.offset}size(){return this.dv.buffer.byteLength}skip(e){this.offset+=e}getBoolean(){return(this.getUint8()&1)===1}getBooleanArray(e){const n=[];for(let i=0;i<e;i++)n.push(this.getBoolean());return n}getUint8(){const e=this.dv.getUint8(this.offset);return this.offset+=1,e}getInt16(){const e=this.dv.getInt16(this.offset,this.littleEndian);return this.offset+=2,e}getInt32(){const e=this.dv.getInt32(this.offset,this.littleEndian);return this.offset+=4,e}getInt32Array(e){const n=[];for(let i=0;i<e;i++)n.push(this.getInt32());return n}getUint32(){const e=this.dv.getUint32(this.offset,this.littleEndian);return this.offset+=4,e}getInt64(){let e,n;return this.littleEndian?(e=this.getUint32(),n=this.getUint32()):(n=this.getUint32(),e=this.getUint32()),n&2147483648?(n=~n&4294967295,e=~e&4294967295,e===4294967295&&(n=n+1&4294967295),e=e+1&4294967295,-(n*4294967296+e)):n*4294967296+e}getInt64Array(e){const n=[];for(let i=0;i<e;i++)n.push(this.getInt64());return n}getUint64(){let e,n;return this.littleEndian?(e=this.getUint32(),n=this.getUint32()):(n=this.getUint32(),e=this.getUint32()),n*4294967296+e}getFloat32(){const e=this.dv.getFloat32(this.offset,this.littleEndian);return this.offset+=4,e}getFloat32Array(e){const n=[];for(let i=0;i<e;i++)n.push(this.getFloat32());return n}getFloat64(){const e=this.dv.getFloat64(this.offset,this.littleEndian);return this.offset+=8,e}getFloat64Array(e){const n=[];for(let i=0;i<e;i++)n.push(this.getFloat64());return n}getArrayBuffer(e){const n=this.dv.buffer.slice(this.offset,this.offset+e);return this.offset+=e,n}getString(e){const n=this.offset;let i=new Uint8Array(this.dv.buffer,n,e);this.skip(e);const s=i.indexOf(0);return s>=0&&(i=new Uint8Array(this.dv.buffer,n,s)),this._textDecoder.decode(i)}}class sY{add(e,n){this[e]=n}}function gye(r){const e="Kaydara FBX Binary  \0";return r.byteLength>=e.length&&e===lY(r,0,e.length)}function yye(r){const e=["K","a","y","d","a","r","a","\\","F","B","X","\\","B","i","n","a","r","y","\\","\\"];let n=0;function i(s){const o=r[s-1];return r=r.slice(n+s),n++,o}for(let s=0;s<e.length;++s)if(i(1)===e[s])return!1;return!0}function aV(r){const e=/FBXVersion: (\d+)/,n=r.match(e);if(n)return parseInt(n[1]);throw new Error("THREE.FBXLoader: Cannot find the version number for the file given.")}function vye(r){return r/46186158e3}const xye=[];function Hw(r,e,n,i){let s;switch(i.mappingType){case"ByPolygonVertex":s=r;break;case"ByPolygon":s=e;break;case"ByVertice":s=n;break;case"AllSame":s=i.indices[0];break;default:console.warn("THREE.FBXLoader: unknown attribute mapping type "+i.mappingType)}i.referenceType==="IndexToDirect"&&(s=i.indices[s]);const o=s*i.dataSize,a=o+i.dataSize;return _ye(xye,i.buffer,o,a)}const HP=new Fi,ap=new me;function oY(r){const e=new _t,n=new _t,i=new _t,s=new _t,o=new _t,a=new _t,l=new _t,c=new _t,u=new _t,h=new _t,f=new _t,d=new _t,p=r.inheritType?r.inheritType:0;if(r.translation&&e.setPosition(ap.fromArray(r.translation)),r.preRotation){const A=r.preRotation.map(zr.degToRad);A.push(r.eulerOrder||Fi.DEFAULT_ORDER),n.makeRotationFromEuler(HP.fromArray(A))}if(r.rotation){const A=r.rotation.map(zr.degToRad);A.push(r.eulerOrder||Fi.DEFAULT_ORDER),i.makeRotationFromEuler(HP.fromArray(A))}if(r.postRotation){const A=r.postRotation.map(zr.degToRad);A.push(r.eulerOrder||Fi.DEFAULT_ORDER),s.makeRotationFromEuler(HP.fromArray(A)),s.invert()}r.scale&&o.scale(ap.fromArray(r.scale)),r.scalingOffset&&l.setPosition(ap.fromArray(r.scalingOffset)),r.scalingPivot&&a.setPosition(ap.fromArray(r.scalingPivot)),r.rotationOffset&&c.setPosition(ap.fromArray(r.rotationOffset)),r.rotationPivot&&u.setPosition(ap.fromArray(r.rotationPivot)),r.parentMatrixWorld&&(f.copy(r.parentMatrix),h.copy(r.parentMatrixWorld));const m=n.clone().multiply(i).multiply(s),g=new _t;g.extractRotation(h);const v=new _t;v.copyPosition(h);const y=v.clone().invert().multiply(h),x=g.clone().invert().multiply(y),b=o,w=new _t;if(p===0)w.copy(g).multiply(m).multiply(x).multiply(b);else if(p===1)w.copy(g).multiply(x).multiply(m).multiply(b);else{const P=new _t().scale(new me().setFromMatrixScale(f)).clone().invert(),D=x.clone().multiply(P);w.copy(g).multiply(m).multiply(D).multiply(b)}const _=u.clone().invert(),S=a.clone().invert();let T=e.clone().multiply(c).multiply(u).multiply(n).multiply(i).multiply(s).multiply(_).multiply(l).multiply(a).multiply(o).multiply(S);const E=new _t().copyPosition(T),M=h.clone().multiply(E);return d.copyPosition(M),T=d.clone().multiply(w),T.premultiply(h.invert()),T}function aY(r){r=r||0;const e=["ZYX","YZX","XZY","ZXY","YXZ","XYZ"];return r===6?(console.warn("THREE.FBXLoader: unsupported Euler Order: Spherical XYZ. Animations and rotations may be incorrect."),e[0]):e[r]}function WP(r){return r.split(",").map(function(n){return parseFloat(n)})}function lY(r,e,n){return e===void 0&&(e=0),n===void 0&&(n=r.byteLength),new TextDecoder().decode(new Uint8Array(r,e,n))}function bye(r,e){for(let n=0,i=r.length,s=e.length;n<s;n++,i++)r[i]=e[n]}function _ye(r,e,n,i){for(let s=n,o=0;s<i;s++,o++)r[o]=e[s];return r}THREE.FBXLoader=uye;AFRAME.registerComponent("fbx-model",{schema:{src:{type:"asset"},crossorigin:{default:""}},init:function(){this.model=null},update:function(){const r=this.data;if(!r.src)return;this.remove();const e=new THREE.FBXLoader;r.crossorigin&&e.setCrossOrigin(r.crossorigin),e.load(r.src,this.load.bind(this))},load:function(r){this.model=r,this.el.setObject3D("mesh",r),this.el.emit("model-loaded",{format:"fbx",model:r})},remove:function(){this.model&&this.el.removeObject3D("mesh")}});function wye(){return"script_"+Date.now()+"_"+Math.ceil(Math.random()*1e5)}function Sye(r,e){var n=document.createElement("script");return n.type="text/javascript",n.async=!0,n.id=e,n.src=r,n}function qP(r){const e=document.getElementById(r),n=e.parentNode;try{n&&n.removeChild(e)}catch{}}function Tye(r){const e=document.getElementsByTagName("script")[0];e.parentNode.insertBefore(r,e)}function Eye(r,e,n){return new n(function(i,s){const o=e.timeout||5e3,a=wye(),l=Sye(r,a),c=setTimeout(function(){s(new Error("Script request to "+r+" timed out")),qP(a)},o),u=function(h){clearTimeout(h)};l.addEventListener("load",function(h){i({ok:!0}),u(c),qP(a)}),l.addEventListener("error",function(h){s(new Error("Script request to "+r+" failed "+h)),u(c),qP(a)}),Tye(l)})}function Mye(r){return r=r||{},function(e,n){return n=n||{},Eye(e,n,r.Promise||Promise)}}var Aye=Mye;const Cye=Aye(),Pye="https://cdn.jsdelivr.net/gh/mrdoob/three.js@r86/examples/js/loaders/GLTFLoader.js",Rye=function(){let r;return function(){return r=r||Cye(Pye),r}}();AFRAME.registerComponent("gltf-model-legacy",{schema:{type:"model"},init:function(){this.model=null,this.loader=null,this.loaderPromise=Rye().then(()=>{this.loader=new THREE.GLTFLoader,this.loader.setCrossOrigin("Anonymous")})},update:function(){const r=this,e=this.el,n=this.data;n&&(this.remove(),this.loaderPromise.then(()=>{this.loader.load(n,function(s){r.model=s.scene,r.model.animations=s.animations,e.setObject3D("mesh",r.model),e.emit("model-loaded",{format:"gltf",model:r.model})})}))},remove:function(){this.model&&this.el.removeObject3D("mesh")}});AFRAME.registerComponent("object-model",{schema:{src:{type:"asset"},crossorigin:{default:""}},init:function(){this.model=null},update:function(){let r;const e=this.data;e.src&&(this.remove(),r=new THREE.ObjectLoader,e.crossorigin&&r.setCrossOrigin(e.crossorigin),r.load(e.src,n=>{n.traverse(i=>{i instanceof THREE.SkinnedMesh&&i.material&&(i.material.skinning=!!(i.geometry&&i.geometry.bones||[]).length)}),this.load(n)}))},load:function(r){this.model=r,this.el.setObject3D("mesh",r),this.el.emit("model-loaded",{format:"json",model:r})},remove:function(){this.model&&this.el.removeObject3D("mesh")}});AFRAME.registerComponent("checkpoint",{schema:{offset:{default:{x:0,y:0,z:0},type:"vec3"}},init:function(){this.active=!1,this.targetEl=null,this.fire=this.fire.bind(this),this.offset=new THREE.Vector3},update:function(){this.offset.copy(this.data.offset)},play:function(){this.el.addEventListener("click",this.fire)},pause:function(){this.el.removeEventListener("click",this.fire)},remove:function(){this.pause()},fire:function(){const r=this.el.sceneEl.querySelector("[checkpoint-controls]");if(!r)throw new Error("No `checkpoint-controls` component found.");r.components["checkpoint-controls"].setCheckpoint(this.el)},getOffset:function(){return this.offset.copy(this.data.offset)}});function Nye(r){return r?Array.isArray(r)?r:r.materials?r.materials:[r]:[]}function av(r,e,n,i){r&&(e=e||[],r.traverse(s=>{if(!s.isMesh)return;Nye(s.material).forEach(a=>{a&&!("envMap"in a)||e.length&&e.indexOf(a.name)===-1||(a.envMap=n,a.reflectivity=i,a.needsUpdate=!0)})}))}AFRAME.registerComponent("cube-env-map",{multiple:!0,schema:{path:{default:""},extension:{default:"jpg",oneOf:["jpg","png"]},enableBackground:{default:!1},reflectivity:{default:1,min:0,max:1},materials:{default:[]}},init:function(){const r=this.data;this.texture=new THREE.CubeTextureLoader().load([r.path+"posx."+r.extension,r.path+"negx."+r.extension,r.path+"posy."+r.extension,r.path+"negy."+r.extension,r.path+"posz."+r.extension,r.path+"negz."+r.extension]),this.texture.format=THREE.RGBAFormat,this.object3dsetHandler=()=>{const e=this.el.getObject3D("mesh"),n=this.data;av(e,n.materials,this.texture,n.reflectivity)},this.object3dsetHandler(),this.el.addEventListener("object3dset",this.object3dsetHandler)},update:function(r){const e=this.data,n=this.el.getObject3D("mesh");let i=[],s=[];if(e.materials.length&&(r.materials?(i=e.materials.filter(o=>!r.materials.includes(o)),s=r.materials.filter(o=>!e.materials.includes(o))):i=e.materials),i.length&&av(n,i,this.texture,e.reflectivity),s.length&&av(n,s,null,1),r.materials&&e.reflectivity!==r.reflectivity){const o=e.materials.filter(a=>r.materials.includes(a));o.length&&av(n,o,this.texture,e.reflectivity)}this.data.enableBackground&&!r.enableBackground?this.setBackground(this.texture):!this.data.enableBackground&&r.enableBackground&&this.setBackground(null)},remove:function(){this.el.removeEventListener("object3dset",this.object3dsetHandler);const r=this.el.getObject3D("mesh"),e=this.data;av(r,e.materials,null,1),e.enableBackground&&this.setBackground(null)},setBackground:function(r){this.el.sceneEl.object3D.background=r}});AFRAME.registerComponent("grab",{init:function(){this.system=this.el.sceneEl.systems.physics,this.GRABBED_STATE="grabbed",this.grabbing=!1,this.hitEl=null,this.physics=this.el.sceneEl.systems.physics,this.constraint=null,this.onHit=this.onHit.bind(this),this.onGripOpen=this.onGripOpen.bind(this),this.onGripClose=this.onGripClose.bind(this)},play:function(){const r=this.el;r.addEventListener("hit",this.onHit),r.addEventListener("gripdown",this.onGripClose),r.addEventListener("gripup",this.onGripOpen),r.addEventListener("trackpaddown",this.onGripClose),r.addEventListener("trackpadup",this.onGripOpen),r.addEventListener("triggerdown",this.onGripClose),r.addEventListener("triggerup",this.onGripOpen)},pause:function(){const r=this.el;r.removeEventListener("hit",this.onHit),r.removeEventListener("gripdown",this.onGripClose),r.removeEventListener("gripup",this.onGripOpen),r.removeEventListener("trackpaddown",this.onGripClose),r.removeEventListener("trackpadup",this.onGripOpen),r.removeEventListener("triggerdown",this.onGripClose),r.removeEventListener("triggerup",this.onGripOpen)},onGripClose:function(){this.grabbing=!0},onGripOpen:function(){const r=this.hitEl;this.grabbing=!1,r&&(r.removeState(this.GRABBED_STATE),this.hitEl=void 0,this.system.removeConstraint(this.constraint),this.constraint=null)},onHit:function(r){const e=r.detail.el;e.is(this.GRABBED_STATE)||!this.grabbing||this.hitEl||(e.addState(this.GRABBED_STATE),this.hitEl=e,this.constraint=new CANNON.LockConstraint(this.el.body,e.body),this.system.addConstraint(this.constraint))}});AFRAME.registerComponent("normal-material",{init:function(){this.material=new THREE.MeshNormalMaterial({flatShading:!0}),this.applyMaterial=this.applyMaterial.bind(this),this.el.addEventListener("object3dset",this.applyMaterial),this.applyMaterial()},remove:function(){this.el.removeEventListener("object3dset",this.applyMaterial)},applyMaterial:function(){this.el.object3D.traverse(r=>{r.isMesh&&(r.material=this.material)})}});AFRAME.registerComponent("sphere-collider",{schema:{enabled:{default:!0},interval:{default:80},objects:{default:""},state:{default:"collided"},radius:{default:.05},watch:{default:!0}},init:function(){this.observer=null,this.els=[],this.collisions=[],this.prevCheckTime=void 0,this.eventDetail={},this.handleHit=this.handleHit.bind(this),this.handleHitEnd=this.handleHitEnd.bind(this)},play:function(){const r=this.el.sceneEl;this.data.watch&&(this.observer=new MutationObserver(this.update.bind(this,null)),this.observer.observe(r,{childList:!0,subtree:!0}))},pause:function(){this.observer&&(this.observer.disconnect(),this.observer=null)},update:function(){const r=this.data;let e;r.objects?e=this.el.sceneEl.querySelectorAll(r.objects):e=this.el.sceneEl.children,this.els=Array.prototype.slice.call(e)},tick:function(){const r=new THREE.Vector3,e=new THREE.Vector3,n=new THREE.Vector3,i=new THREE.Vector3,s=new THREE.Box3,o=[],a=new Map;return function(l){if(!this.data.enabled)return;const c=this.prevCheckTime;if(c&&l-c<this.data.interval)return;this.prevCheckTime=l;const u=this.el,h=this.data,f=u.getObject3D("mesh");let d;if(!f)return;o.length=0,a.clear(),u.object3D.getWorldPosition(r),u.object3D.getWorldScale(n),d=h.radius*m(n),this.els.forEach(p),o.sort((g,v)=>a.get(g)>a.get(v)?1:-1).forEach(this.handleHit),this.collisions.filter(g=>!a.has(g)).forEach(this.handleHitEnd),Oye(this.collisions,o);function p(g){let v,y,x,b;g.isEntity&&(y=g.getObject3D("mesh"),y&&(s.setFromObject(y).getSize(i),b=Math.max(i.x,i.y,i.z)/2,v=Math.sqrt(2*b*b),s.getCenter(e),v&&(x=r.distanceTo(e),x<v+d&&(o.push(g),a.set(g,x)))))}function m(g){return Math.max(g.x,g.y,g.z)}}}(),handleHit:function(r){r.emit("hit"),r.addState(this.data.state),this.eventDetail.el=r,this.el.emit("hit",this.eventDetail)},handleHitEnd:function(r){r.emit("hitend"),r.removeState(this.data.state),this.eventDetail.el=r,this.el.emit("hitend",this.eventDetail)}});function Oye(r,e){r.length=0;for(let n=0;n<e.length;n++)r[n]=e[n]}AFRAME.registerComponent("nav-mesh",{schema:{nodeName:{type:"string"}},init:function(){this.system=this.el.sceneEl.systems.nav,this.hasLoadedNavMesh=!1,this.nodeName=this.data.nodeName,this.el.addEventListener("object3dset",this.loadNavMesh.bind(this))},play:function(){this.hasLoadedNavMesh||this.loadNavMesh()},loadNavMesh:function(){var r=this;const e=this.el.getObject3D("mesh");if(this.el.sceneEl.object3D,!e)return;let n;if(e.traverse(s=>{s.isMesh&&(!r.nodeName||s.name===r.nodeName)&&(n=s)}),!n)return;const i=n.geometry.clone();n.updateWorldMatrix(!0,!1),i.applyMatrix4(n.matrixWorld),this.system.setNavMeshGeometry(i),this.hasLoadedNavMesh=!0}});AFRAME.registerComponent("nav-agent",{schema:{destination:{type:"vec3"},active:{default:!1},speed:{default:2}},init:function(){this.system=this.el.sceneEl.systems.nav,this.system.addAgent(this),this.group=null,this.path=[],this.raycaster=new THREE.Raycaster},remove:function(){this.system.removeAgent(this)},update:function(){this.path.length=0},updateNavLocation:function(){this.group=null,this.path=[]},tick:function(){const r=new THREE.Vector3,e=new THREE.Vector3,n=new THREE.Vector3;return function(i,s){const o=this.el,a=this.data,l=this.raycaster,c=a.speed*s/1e3;if(!a.active)return;if(!this.path.length){const m=this.el.object3D.position;this.group=this.group||this.system.getGroup(m),this.path=this.system.getPath(m,r.copy(a.destination),this.group)||[],o.emit("navigation-start")}if(!this.path.length){console.warn("[nav] Unable to find path to %o.",a.destination),this.el.setAttribute("nav-agent",{active:!1}),o.emit("navigation-end");return}const u=o.object3D.position,h=this.path[0];e.subVectors(h,u);const f=e.length();let d;if(f<c){if(this.path.shift(),!this.path.length){this.el.setAttribute("nav-agent",{active:!1}),o.emit("navigation-end");return}n.copy(u),d=this.path[0]}else n.copy(e.setLength(c)).add(u),d=h;d.y=u.y,o.object3D.lookAt(d),l.ray.origin.copy(n),l.ray.origin.y+=1.5,l.ray.direction={x:0,y:-1,z:0};const p=l.intersectObject(this.system.getNavMesh());p.length?(e.subVectors(p[0].point,u),u.add(e.setLength(c))):u.copy(n)}}()});/**
 * @license
 * Copyright 2010-2025 Three.js Authors
 * SPDX-License-Identifier: MIT
 */const my="176",Ui={LEFT:0,MIDDLE:1,RIGHT:2,ROTATE:0,DOLLY:1,PAN:2},Oc={ROTATE:0,PAN:1,DOLLY_PAN:2,DOLLY_ROTATE:3},cY=0,jO=1,uY=2,Dye=0,aF=1,kye=2,wo=3,no=0,Fn=1,Es=2,ro=0,Ro=1,Jm=2,eg=3,tg=4,Pm=5,ss=100,lF=101,cF=102,hY=103,fY=104,wc=200,uF=201,hF=202,fF=203,Nx=204,Ox=205,dF=206,pF=207,mF=208,gF=209,yF=210,Iye=211,Lye=212,Fye=213,Bye=214,Dx=0,kx=1,Ix=2,Ch=3,Lx=4,Fx=5,Bx=6,Ux=7,c_=0,dY=1,pY=2,io=0,mY=1,gY=2,yY=3,vY=4,Uye=5,xY=6,bY=7,vF=300,tl=301,nl=302,dd=303,pd=304,md=306,gd=1e3,Tl=1001,yd=1002,jn=1003,xF=1004,Dc=1005,li=1006,Rm=1007,Ks=1008,gr=1009,Jf=1010,ed=1011,qa=1012,Si=1013,In=1014,Nr=1015,Ei=1016,GM=1017,HM=1018,No=1020,WM=35902,bF=1021,u_=1022,Tr=1023,Oo=1026,Do=1027,h_=1028,gy=1029,kc=1030,yy=1031,zye=1032,vy=1033,td=33776,yh=33777,vh=33778,xh=33779,zx=35840,$x=35841,jx=35842,Vx=35843,Gx=36196,ng=37492,rg=37496,ig=37808,sg=37809,og=37810,ag=37811,lg=37812,cg=37813,ug=37814,hg=37815,fg=37816,dg=37817,pg=37818,mg=37819,gg=37820,yg=37821,nd=36492,VO=36494,GO=36495,_F=36283,Hx=36284,Wx=36285,qx=36286,$ye=3200,jye=3201,ou=0,_Y=1,Eo="",vt="srgb",Ol="srgb-linear",UT="linear",wn="srgb",Vye=0,Tf=7680,Gye=7681,Hye=7682,Wye=7683,qye=34055,Xye=34056,Kye=5386,Yye=512,Zye=513,Qye=514,Jye=515,eve=516,tve=517,nve=518,HO=519,wF=512,qM=513,SF=514,XM=515,TF=516,EF=517,MF=518,AF=519,zT=35044,om=35048,lV="300 es",Ps=2e3,Ph=2001;class gu{addEventListener(e,n){this._listeners===void 0&&(this._listeners={});const i=this._listeners;i[e]===void 0&&(i[e]=[]),i[e].indexOf(n)===-1&&i[e].push(n)}hasEventListener(e,n){const i=this._listeners;return i===void 0?!1:i[e]!==void 0&&i[e].indexOf(n)!==-1}removeEventListener(e,n){const i=this._listeners;if(i===void 0)return;const s=i[e];if(s!==void 0){const o=s.indexOf(n);o!==-1&&s.splice(o,1)}}dispatchEvent(e){const n=this._listeners;if(n===void 0)return;const i=n[e.type];if(i!==void 0){e.target=this;const s=i.slice(0);for(let o=0,a=s.length;o<a;o++)s[o].call(this,e);e.target=null}}}const Ki=["00","01","02","03","04","05","06","07","08","09","0a","0b","0c","0d","0e","0f","10","11","12","13","14","15","16","17","18","19","1a","1b","1c","1d","1e","1f","20","21","22","23","24","25","26","27","28","29","2a","2b","2c","2d","2e","2f","30","31","32","33","34","35","36","37","38","39","3a","3b","3c","3d","3e","3f","40","41","42","43","44","45","46","47","48","49","4a","4b","4c","4d","4e","4f","50","51","52","53","54","55","56","57","58","59","5a","5b","5c","5d","5e","5f","60","61","62","63","64","65","66","67","68","69","6a","6b","6c","6d","6e","6f","70","71","72","73","74","75","76","77","78","79","7a","7b","7c","7d","7e","7f","80","81","82","83","84","85","86","87","88","89","8a","8b","8c","8d","8e","8f","90","91","92","93","94","95","96","97","98","99","9a","9b","9c","9d","9e","9f","a0","a1","a2","a3","a4","a5","a6","a7","a8","a9","aa","ab","ac","ad","ae","af","b0","b1","b2","b3","b4","b5","b6","b7","b8","b9","ba","bb","bc","bd","be","bf","c0","c1","c2","c3","c4","c5","c6","c7","c8","c9","ca","cb","cc","cd","ce","cf","d0","d1","d2","d3","d4","d5","d6","d7","d8","d9","da","db","dc","dd","de","df","e0","e1","e2","e3","e4","e5","e6","e7","e8","e9","ea","eb","ec","ed","ee","ef","f0","f1","f2","f3","f4","f5","f6","f7","f8","f9","fa","fb","fc","fd","fe","ff"];let cV=1234567;const I0=Math.PI/180,vd=180/Math.PI;function Hc(){const r=Math.random()*4294967295|0,e=Math.random()*4294967295|0,n=Math.random()*4294967295|0,i=Math.random()*4294967295|0;return(Ki[r&255]+Ki[r>>8&255]+Ki[r>>16&255]+Ki[r>>24&255]+"-"+Ki[e&255]+Ki[e>>8&255]+"-"+Ki[e>>16&15|64]+Ki[e>>24&255]+"-"+Ki[n&63|128]+Ki[n>>8&255]+"-"+Ki[n>>16&255]+Ki[n>>24&255]+Ki[i&255]+Ki[i>>8&255]+Ki[i>>16&255]+Ki[i>>24&255]).toLowerCase()}function Wt(r,e,n){return Math.max(e,Math.min(n,r))}function CF(r,e){return(r%e+e)%e}function rve(r,e,n,i,s){return i+(r-e)*(s-i)/(n-e)}function ive(r,e,n){return r!==e?(n-r)/(e-r):0}function L0(r,e,n){return(1-n)*r+n*e}function sve(r,e,n,i){return L0(r,e,1-Math.exp(-n*i))}function ove(r,e=1){return e-Math.abs(CF(r,e*2)-e)}function ave(r,e,n){return r<=e?0:r>=n?1:(r=(r-e)/(n-e),r*r*(3-2*r))}function lve(r,e,n){return r<=e?0:r>=n?1:(r=(r-e)/(n-e),r*r*r*(r*(r*6-15)+10))}function cve(r,e){return r+Math.floor(Math.random()*(e-r+1))}function uve(r,e){return r+Math.random()*(e-r)}function hve(r){return r*(.5-Math.random())}function fve(r){r!==void 0&&(cV=r);let e=cV+=1831565813;return e=Math.imul(e^e>>>15,e|1),e^=e+Math.imul(e^e>>>7,e|61),((e^e>>>14)>>>0)/4294967296}function dve(r){return r*I0}function pve(r){return r*vd}function mve(r){return(r&r-1)===0&&r!==0}function gve(r){return Math.pow(2,Math.ceil(Math.log(r)/Math.LN2))}function yve(r){return Math.pow(2,Math.floor(Math.log(r)/Math.LN2))}function vve(r,e,n,i,s){const o=Math.cos,a=Math.sin,l=o(n/2),c=a(n/2),u=o((e+i)/2),h=a((e+i)/2),f=o((e-i)/2),d=a((e-i)/2),p=o((i-e)/2),m=a((i-e)/2);switch(s){case"XYX":r.set(l*h,c*f,c*d,l*u);break;case"YZY":r.set(c*d,l*h,c*f,l*u);break;case"ZXZ":r.set(c*f,c*d,l*h,l*u);break;case"XZX":r.set(l*h,c*m,c*p,l*u);break;case"YXY":r.set(c*p,l*h,c*m,l*u);break;case"ZYZ":r.set(c*m,c*p,l*h,l*u);break;default:console.warn("THREE.MathUtils: .setQuaternionFromProperEuler() encountered an unknown order: "+s)}}function Ms(r,e){switch(e.constructor){case Float32Array:return r;case Uint32Array:return r/4294967295;case Uint16Array:return r/65535;case Uint8Array:return r/255;case Int32Array:return Math.max(r/2147483647,-1);case Int16Array:return Math.max(r/32767,-1);case Int8Array:return Math.max(r/127,-1);default:throw new Error("Invalid component type.")}}function Ht(r,e){switch(e.constructor){case Float32Array:return r;case Uint32Array:return Math.round(r*4294967295);case Uint16Array:return Math.round(r*65535);case Uint8Array:return Math.round(r*255);case Int32Array:return Math.round(r*2147483647);case Int16Array:return Math.round(r*32767);case Int8Array:return Math.round(r*127);default:throw new Error("Invalid component type.")}}const $T={DEG2RAD:I0,RAD2DEG:vd,generateUUID:Hc,clamp:Wt,euclideanModulo:CF,mapLinear:rve,inverseLerp:ive,lerp:L0,damp:sve,pingpong:ove,smoothstep:ave,smootherstep:lve,randInt:cve,randFloat:uve,randFloatSpread:hve,seededRandom:fve,degToRad:dve,radToDeg:pve,isPowerOfTwo:mve,ceilPowerOfTwo:gve,floorPowerOfTwo:yve,setQuaternionFromProperEuler:vve,normalize:Ht,denormalize:Ms};class Fe{constructor(e=0,n=0){Fe.prototype.isVector2=!0,this.x=e,this.y=n}get width(){return this.x}set width(e){this.x=e}get height(){return this.y}set height(e){this.y=e}set(e,n){return this.x=e,this.y=n,this}setScalar(e){return this.x=e,this.y=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setComponent(e,n){switch(e){case 0:this.x=n;break;case 1:this.y=n;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y)}copy(e){return this.x=e.x,this.y=e.y,this}add(e){return this.x+=e.x,this.y+=e.y,this}addScalar(e){return this.x+=e,this.y+=e,this}addVectors(e,n){return this.x=e.x+n.x,this.y=e.y+n.y,this}addScaledVector(e,n){return this.x+=e.x*n,this.y+=e.y*n,this}sub(e){return this.x-=e.x,this.y-=e.y,this}subScalar(e){return this.x-=e,this.y-=e,this}subVectors(e,n){return this.x=e.x-n.x,this.y=e.y-n.y,this}multiply(e){return this.x*=e.x,this.y*=e.y,this}multiplyScalar(e){return this.x*=e,this.y*=e,this}divide(e){return this.x/=e.x,this.y/=e.y,this}divideScalar(e){return this.multiplyScalar(1/e)}applyMatrix3(e){const n=this.x,i=this.y,s=e.elements;return this.x=s[0]*n+s[3]*i+s[6],this.y=s[1]*n+s[4]*i+s[7],this}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this}clamp(e,n){return this.x=Wt(this.x,e.x,n.x),this.y=Wt(this.y,e.y,n.y),this}clampScalar(e,n){return this.x=Wt(this.x,e,n),this.y=Wt(this.y,e,n),this}clampLength(e,n){const i=this.length();return this.divideScalar(i||1).multiplyScalar(Wt(i,e,n))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this}negate(){return this.x=-this.x,this.y=-this.y,this}dot(e){return this.x*e.x+this.y*e.y}cross(e){return this.x*e.y-this.y*e.x}lengthSq(){return this.x*this.x+this.y*this.y}length(){return Math.sqrt(this.x*this.x+this.y*this.y)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)}normalize(){return this.divideScalar(this.length()||1)}angle(){return Math.atan2(-this.y,-this.x)+Math.PI}angleTo(e){const n=Math.sqrt(this.lengthSq()*e.lengthSq());if(n===0)return Math.PI/2;const i=this.dot(e)/n;return Math.acos(Wt(i,-1,1))}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){const n=this.x-e.x,i=this.y-e.y;return n*n+i*i}manhattanDistanceTo(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,n){return this.x+=(e.x-this.x)*n,this.y+=(e.y-this.y)*n,this}lerpVectors(e,n,i){return this.x=e.x+(n.x-e.x)*i,this.y=e.y+(n.y-e.y)*i,this}equals(e){return e.x===this.x&&e.y===this.y}fromArray(e,n=0){return this.x=e[n],this.y=e[n+1],this}toArray(e=[],n=0){return e[n]=this.x,e[n+1]=this.y,e}fromBufferAttribute(e,n){return this.x=e.getX(n),this.y=e.getY(n),this}rotateAround(e,n){const i=Math.cos(n),s=Math.sin(n),o=this.x-e.x,a=this.y-e.y;return this.x=o*i-a*s+e.x,this.y=o*s+a*i+e.y,this}random(){return this.x=Math.random(),this.y=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y}}class Bt{constructor(e,n,i,s,o,a,l,c,u){Bt.prototype.isMatrix3=!0,this.elements=[1,0,0,0,1,0,0,0,1],e!==void 0&&this.set(e,n,i,s,o,a,l,c,u)}set(e,n,i,s,o,a,l,c,u){const h=this.elements;return h[0]=e,h[1]=s,h[2]=l,h[3]=n,h[4]=o,h[5]=c,h[6]=i,h[7]=a,h[8]=u,this}identity(){return this.set(1,0,0,0,1,0,0,0,1),this}copy(e){const n=this.elements,i=e.elements;return n[0]=i[0],n[1]=i[1],n[2]=i[2],n[3]=i[3],n[4]=i[4],n[5]=i[5],n[6]=i[6],n[7]=i[7],n[8]=i[8],this}extractBasis(e,n,i){return e.setFromMatrix3Column(this,0),n.setFromMatrix3Column(this,1),i.setFromMatrix3Column(this,2),this}setFromMatrix4(e){const n=e.elements;return this.set(n[0],n[4],n[8],n[1],n[5],n[9],n[2],n[6],n[10]),this}multiply(e){return this.multiplyMatrices(this,e)}premultiply(e){return this.multiplyMatrices(e,this)}multiplyMatrices(e,n){const i=e.elements,s=n.elements,o=this.elements,a=i[0],l=i[3],c=i[6],u=i[1],h=i[4],f=i[7],d=i[2],p=i[5],m=i[8],g=s[0],v=s[3],y=s[6],x=s[1],b=s[4],w=s[7],_=s[2],S=s[5],T=s[8];return o[0]=a*g+l*x+c*_,o[3]=a*v+l*b+c*S,o[6]=a*y+l*w+c*T,o[1]=u*g+h*x+f*_,o[4]=u*v+h*b+f*S,o[7]=u*y+h*w+f*T,o[2]=d*g+p*x+m*_,o[5]=d*v+p*b+m*S,o[8]=d*y+p*w+m*T,this}multiplyScalar(e){const n=this.elements;return n[0]*=e,n[3]*=e,n[6]*=e,n[1]*=e,n[4]*=e,n[7]*=e,n[2]*=e,n[5]*=e,n[8]*=e,this}determinant(){const e=this.elements,n=e[0],i=e[1],s=e[2],o=e[3],a=e[4],l=e[5],c=e[6],u=e[7],h=e[8];return n*a*h-n*l*u-i*o*h+i*l*c+s*o*u-s*a*c}invert(){const e=this.elements,n=e[0],i=e[1],s=e[2],o=e[3],a=e[4],l=e[5],c=e[6],u=e[7],h=e[8],f=h*a-l*u,d=l*c-h*o,p=u*o-a*c,m=n*f+i*d+s*p;if(m===0)return this.set(0,0,0,0,0,0,0,0,0);const g=1/m;return e[0]=f*g,e[1]=(s*u-h*i)*g,e[2]=(l*i-s*a)*g,e[3]=d*g,e[4]=(h*n-s*c)*g,e[5]=(s*o-l*n)*g,e[6]=p*g,e[7]=(i*c-u*n)*g,e[8]=(a*n-i*o)*g,this}transpose(){let e;const n=this.elements;return e=n[1],n[1]=n[3],n[3]=e,e=n[2],n[2]=n[6],n[6]=e,e=n[5],n[5]=n[7],n[7]=e,this}getNormalMatrix(e){return this.setFromMatrix4(e).invert().transpose()}transposeIntoArray(e){const n=this.elements;return e[0]=n[0],e[1]=n[3],e[2]=n[6],e[3]=n[1],e[4]=n[4],e[5]=n[7],e[6]=n[2],e[7]=n[5],e[8]=n[8],this}setUvTransform(e,n,i,s,o,a,l){const c=Math.cos(o),u=Math.sin(o);return this.set(i*c,i*u,-i*(c*a+u*l)+a+e,-s*u,s*c,-s*(-u*a+c*l)+l+n,0,0,1),this}scale(e,n){return this.premultiply(XP.makeScale(e,n)),this}rotate(e){return this.premultiply(XP.makeRotation(-e)),this}translate(e,n){return this.premultiply(XP.makeTranslation(e,n)),this}makeTranslation(e,n){return e.isVector2?this.set(1,0,e.x,0,1,e.y,0,0,1):this.set(1,0,e,0,1,n,0,0,1),this}makeRotation(e){const n=Math.cos(e),i=Math.sin(e);return this.set(n,-i,0,i,n,0,0,0,1),this}makeScale(e,n){return this.set(e,0,0,0,n,0,0,0,1),this}equals(e){const n=this.elements,i=e.elements;for(let s=0;s<9;s++)if(n[s]!==i[s])return!1;return!0}fromArray(e,n=0){for(let i=0;i<9;i++)this.elements[i]=e[i+n];return this}toArray(e=[],n=0){const i=this.elements;return e[n]=i[0],e[n+1]=i[1],e[n+2]=i[2],e[n+3]=i[3],e[n+4]=i[4],e[n+5]=i[5],e[n+6]=i[6],e[n+7]=i[7],e[n+8]=i[8],e}clone(){return new this.constructor().fromArray(this.elements)}}const XP=new Bt;function PF(r){for(let e=r.length-1;e>=0;--e)if(r[e]>=65535)return!0;return!1}function Xx(r){return document.createElementNS("http://www.w3.org/1999/xhtml",r)}function wY(){const r=Xx("canvas");return r.style.display="block",r}const uV={};function Ja(r){r in uV||(uV[r]=!0,console.warn(r))}function xve(r,e,n){return new Promise(function(i,s){function o(){switch(r.clientWaitSync(e,r.SYNC_FLUSH_COMMANDS_BIT,0)){case r.WAIT_FAILED:s();break;case r.TIMEOUT_EXPIRED:setTimeout(o,n);break;default:i()}}setTimeout(o,n)})}function bve(r){const e=r.elements;e[2]=.5*e[2]+.5*e[3],e[6]=.5*e[6]+.5*e[7],e[10]=.5*e[10]+.5*e[11],e[14]=.5*e[14]+.5*e[15]}function _ve(r){const e=r.elements;e[11]===-1?(e[10]=-e[10]-1,e[14]=-e[14]):(e[10]=-e[10],e[14]=-e[14]+1)}const hV=new Bt().set(.4123908,.3575843,.1804808,.212639,.7151687,.0721923,.0193308,.1191948,.9505322),fV=new Bt().set(3.2409699,-1.5373832,-.4986108,-.9692436,1.8759675,.0415551,.0556301,-.203977,1.0569715);function wve(){const r={enabled:!0,workingColorSpace:Ol,spaces:{},convert:function(s,o,a){return this.enabled===!1||o===a||!o||!a||(this.spaces[o].transfer===wn&&(s.r=Wc(s.r),s.g=Wc(s.g),s.b=Wc(s.b)),this.spaces[o].primaries!==this.spaces[a].primaries&&(s.applyMatrix3(this.spaces[o].toXYZ),s.applyMatrix3(this.spaces[a].fromXYZ)),this.spaces[a].transfer===wn&&(s.r=Nm(s.r),s.g=Nm(s.g),s.b=Nm(s.b))),s},fromWorkingColorSpace:function(s,o){return this.convert(s,this.workingColorSpace,o)},toWorkingColorSpace:function(s,o){return this.convert(s,o,this.workingColorSpace)},getPrimaries:function(s){return this.spaces[s].primaries},getTransfer:function(s){return s===Eo?UT:this.spaces[s].transfer},getLuminanceCoefficients:function(s,o=this.workingColorSpace){return s.fromArray(this.spaces[o].luminanceCoefficients)},define:function(s){Object.assign(this.spaces,s)},_getMatrix:function(s,o,a){return s.copy(this.spaces[o].toXYZ).multiply(this.spaces[a].fromXYZ)},_getDrawingBufferColorSpace:function(s){return this.spaces[s].outputColorSpaceConfig.drawingBufferColorSpace},_getUnpackColorSpace:function(s=this.workingColorSpace){return this.spaces[s].workingColorSpaceConfig.unpackColorSpace}},e=[.64,.33,.3,.6,.15,.06],n=[.2126,.7152,.0722],i=[.3127,.329];return r.define({[Ol]:{primaries:e,whitePoint:i,transfer:UT,toXYZ:hV,fromXYZ:fV,luminanceCoefficients:n,workingColorSpaceConfig:{unpackColorSpace:vt},outputColorSpaceConfig:{drawingBufferColorSpace:vt}},[vt]:{primaries:e,whitePoint:i,transfer:wn,toXYZ:hV,fromXYZ:fV,luminanceCoefficients:n,outputColorSpaceConfig:{drawingBufferColorSpace:vt}}}),r}const Qt=wve();function Wc(r){return r<.04045?r*.0773993808:Math.pow(r*.9478672986+.0521327014,2.4)}function Nm(r){return r<.0031308?r*12.92:1.055*Math.pow(r,.41666)-.055}let lp;class Sve{static getDataURL(e,n="image/png"){if(/^data:/i.test(e.src)||typeof HTMLCanvasElement>"u")return e.src;let i;if(e instanceof HTMLCanvasElement)i=e;else{lp===void 0&&(lp=Xx("canvas")),lp.width=e.width,lp.height=e.height;const s=lp.getContext("2d");e instanceof ImageData?s.putImageData(e,0,0):s.drawImage(e,0,0,e.width,e.height),i=lp}return i.toDataURL(n)}static sRGBToLinear(e){if(typeof HTMLImageElement<"u"&&e instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&e instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&e instanceof ImageBitmap){const n=Xx("canvas");n.width=e.width,n.height=e.height;const i=n.getContext("2d");i.drawImage(e,0,0,e.width,e.height);const s=i.getImageData(0,0,e.width,e.height),o=s.data;for(let a=0;a<o.length;a++)o[a]=Wc(o[a]/255)*255;return i.putImageData(s,0,0),n}else if(e.data){const n=e.data.slice(0);for(let i=0;i<n.length;i++)n instanceof Uint8Array||n instanceof Uint8ClampedArray?n[i]=Math.floor(Wc(n[i]/255)*255):n[i]=Wc(n[i]);return{data:n,width:e.width,height:e.height}}else return console.warn("THREE.ImageUtils.sRGBToLinear(): Unsupported image type. No color space conversion applied."),e}}let Tve=0;class RF{constructor(e=null){this.isSource=!0,Object.defineProperty(this,"id",{value:Tve++}),this.uuid=Hc(),this.data=e,this.dataReady=!0,this.version=0}set needsUpdate(e){e===!0&&this.version++}toJSON(e){const n=e===void 0||typeof e=="string";if(!n&&e.images[this.uuid]!==void 0)return e.images[this.uuid];const i={uuid:this.uuid,url:""},s=this.data;if(s!==null){let o;if(Array.isArray(s)){o=[];for(let a=0,l=s.length;a<l;a++)s[a].isDataTexture?o.push(KP(s[a].image)):o.push(KP(s[a]))}else o=KP(s);i.url=o}return n||(e.images[this.uuid]=i),i}}function KP(r){return typeof HTMLImageElement<"u"&&r instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&r instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&r instanceof ImageBitmap?Sve.getDataURL(r):r.data?{data:Array.from(r.data),width:r.width,height:r.height,type:r.data.constructor.name}:(console.warn("THREE.Texture: Unable to serialize Texture."),{})}let Eve=0;class ui extends gu{constructor(e=ui.DEFAULT_IMAGE,n=ui.DEFAULT_MAPPING,i=Tl,s=Tl,o=li,a=Ks,l=Tr,c=gr,u=ui.DEFAULT_ANISOTROPY,h=Eo){super(),this.isTexture=!0,Object.defineProperty(this,"id",{value:Eve++}),this.uuid=Hc(),this.name="",this.source=new RF(e),this.mipmaps=[],this.mapping=n,this.channel=0,this.wrapS=i,this.wrapT=s,this.magFilter=o,this.minFilter=a,this.anisotropy=u,this.format=l,this.internalFormat=null,this.type=c,this.offset=new Fe(0,0),this.repeat=new Fe(1,1),this.center=new Fe(0,0),this.rotation=0,this.matrixAutoUpdate=!0,this.matrix=new Bt,this.generateMipmaps=!0,this.premultiplyAlpha=!1,this.flipY=!0,this.unpackAlignment=4,this.colorSpace=h,this.userData={},this.version=0,this.onUpdate=null,this.renderTarget=null,this.isRenderTargetTexture=!1,this.isTextureArray=!1,this.pmremVersion=0}get image(){return this.source.data}set image(e=null){this.source.data=e}updateMatrix(){this.matrix.setUvTransform(this.offset.x,this.offset.y,this.repeat.x,this.repeat.y,this.rotation,this.center.x,this.center.y)}clone(){return new this.constructor().copy(this)}copy(e){return this.name=e.name,this.source=e.source,this.mipmaps=e.mipmaps.slice(0),this.mapping=e.mapping,this.channel=e.channel,this.wrapS=e.wrapS,this.wrapT=e.wrapT,this.magFilter=e.magFilter,this.minFilter=e.minFilter,this.anisotropy=e.anisotropy,this.format=e.format,this.internalFormat=e.internalFormat,this.type=e.type,this.offset.copy(e.offset),this.repeat.copy(e.repeat),this.center.copy(e.center),this.rotation=e.rotation,this.matrixAutoUpdate=e.matrixAutoUpdate,this.matrix.copy(e.matrix),this.generateMipmaps=e.generateMipmaps,this.premultiplyAlpha=e.premultiplyAlpha,this.flipY=e.flipY,this.unpackAlignment=e.unpackAlignment,this.colorSpace=e.colorSpace,this.renderTarget=e.renderTarget,this.isRenderTargetTexture=e.isRenderTargetTexture,this.isTextureArray=e.isTextureArray,this.userData=JSON.parse(JSON.stringify(e.userData)),this.needsUpdate=!0,this}toJSON(e){const n=e===void 0||typeof e=="string";if(!n&&e.textures[this.uuid]!==void 0)return e.textures[this.uuid];const i={metadata:{version:4.6,type:"Texture",generator:"Texture.toJSON"},uuid:this.uuid,name:this.name,image:this.source.toJSON(e).uuid,mapping:this.mapping,channel:this.channel,repeat:[this.repeat.x,this.repeat.y],offset:[this.offset.x,this.offset.y],center:[this.center.x,this.center.y],rotation:this.rotation,wrap:[this.wrapS,this.wrapT],format:this.format,internalFormat:this.internalFormat,type:this.type,colorSpace:this.colorSpace,minFilter:this.minFilter,magFilter:this.magFilter,anisotropy:this.anisotropy,flipY:this.flipY,generateMipmaps:this.generateMipmaps,premultiplyAlpha:this.premultiplyAlpha,unpackAlignment:this.unpackAlignment};return Object.keys(this.userData).length>0&&(i.userData=this.userData),n||(e.textures[this.uuid]=i),i}dispose(){this.dispatchEvent({type:"dispose"})}transformUv(e){if(this.mapping!==vF)return e;if(e.applyMatrix3(this.matrix),e.x<0||e.x>1)switch(this.wrapS){case gd:e.x=e.x-Math.floor(e.x);break;case Tl:e.x=e.x<0?0:1;break;case yd:Math.abs(Math.floor(e.x)%2)===1?e.x=Math.ceil(e.x)-e.x:e.x=e.x-Math.floor(e.x);break}if(e.y<0||e.y>1)switch(this.wrapT){case gd:e.y=e.y-Math.floor(e.y);break;case Tl:e.y=e.y<0?0:1;break;case yd:Math.abs(Math.floor(e.y)%2)===1?e.y=Math.ceil(e.y)-e.y:e.y=e.y-Math.floor(e.y);break}return this.flipY&&(e.y=1-e.y),e}set needsUpdate(e){e===!0&&(this.version++,this.source.needsUpdate=!0)}set needsPMREMUpdate(e){e===!0&&this.pmremVersion++}}ui.DEFAULT_IMAGE=null;ui.DEFAULT_MAPPING=vF;ui.DEFAULT_ANISOTROPY=1;class Nt{constructor(e=0,n=0,i=0,s=1){Nt.prototype.isVector4=!0,this.x=e,this.y=n,this.z=i,this.w=s}get width(){return this.z}set width(e){this.z=e}get height(){return this.w}set height(e){this.w=e}set(e,n,i,s){return this.x=e,this.y=n,this.z=i,this.w=s,this}setScalar(e){return this.x=e,this.y=e,this.z=e,this.w=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setZ(e){return this.z=e,this}setW(e){return this.w=e,this}setComponent(e,n){switch(e){case 0:this.x=n;break;case 1:this.y=n;break;case 2:this.z=n;break;case 3:this.w=n;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y,this.z,this.w)}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this.w=e.w!==void 0?e.w:1,this}add(e){return this.x+=e.x,this.y+=e.y,this.z+=e.z,this.w+=e.w,this}addScalar(e){return this.x+=e,this.y+=e,this.z+=e,this.w+=e,this}addVectors(e,n){return this.x=e.x+n.x,this.y=e.y+n.y,this.z=e.z+n.z,this.w=e.w+n.w,this}addScaledVector(e,n){return this.x+=e.x*n,this.y+=e.y*n,this.z+=e.z*n,this.w+=e.w*n,this}sub(e){return this.x-=e.x,this.y-=e.y,this.z-=e.z,this.w-=e.w,this}subScalar(e){return this.x-=e,this.y-=e,this.z-=e,this.w-=e,this}subVectors(e,n){return this.x=e.x-n.x,this.y=e.y-n.y,this.z=e.z-n.z,this.w=e.w-n.w,this}multiply(e){return this.x*=e.x,this.y*=e.y,this.z*=e.z,this.w*=e.w,this}multiplyScalar(e){return this.x*=e,this.y*=e,this.z*=e,this.w*=e,this}applyMatrix4(e){const n=this.x,i=this.y,s=this.z,o=this.w,a=e.elements;return this.x=a[0]*n+a[4]*i+a[8]*s+a[12]*o,this.y=a[1]*n+a[5]*i+a[9]*s+a[13]*o,this.z=a[2]*n+a[6]*i+a[10]*s+a[14]*o,this.w=a[3]*n+a[7]*i+a[11]*s+a[15]*o,this}divide(e){return this.x/=e.x,this.y/=e.y,this.z/=e.z,this.w/=e.w,this}divideScalar(e){return this.multiplyScalar(1/e)}setAxisAngleFromQuaternion(e){this.w=2*Math.acos(e.w);const n=Math.sqrt(1-e.w*e.w);return n<1e-4?(this.x=1,this.y=0,this.z=0):(this.x=e.x/n,this.y=e.y/n,this.z=e.z/n),this}setAxisAngleFromRotationMatrix(e){let n,i,s,o;const c=e.elements,u=c[0],h=c[4],f=c[8],d=c[1],p=c[5],m=c[9],g=c[2],v=c[6],y=c[10];if(Math.abs(h-d)<.01&&Math.abs(f-g)<.01&&Math.abs(m-v)<.01){if(Math.abs(h+d)<.1&&Math.abs(f+g)<.1&&Math.abs(m+v)<.1&&Math.abs(u+p+y-3)<.1)return this.set(1,0,0,0),this;n=Math.PI;const b=(u+1)/2,w=(p+1)/2,_=(y+1)/2,S=(h+d)/4,T=(f+g)/4,E=(m+v)/4;return b>w&&b>_?b<.01?(i=0,s=.707106781,o=.707106781):(i=Math.sqrt(b),s=S/i,o=T/i):w>_?w<.01?(i=.707106781,s=0,o=.707106781):(s=Math.sqrt(w),i=S/s,o=E/s):_<.01?(i=.707106781,s=.707106781,o=0):(o=Math.sqrt(_),i=T/o,s=E/o),this.set(i,s,o,n),this}let x=Math.sqrt((v-m)*(v-m)+(f-g)*(f-g)+(d-h)*(d-h));return Math.abs(x)<.001&&(x=1),this.x=(v-m)/x,this.y=(f-g)/x,this.z=(d-h)/x,this.w=Math.acos((u+p+y-1)/2),this}setFromMatrixPosition(e){const n=e.elements;return this.x=n[12],this.y=n[13],this.z=n[14],this.w=n[15],this}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this.w=Math.min(this.w,e.w),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this.w=Math.max(this.w,e.w),this}clamp(e,n){return this.x=Wt(this.x,e.x,n.x),this.y=Wt(this.y,e.y,n.y),this.z=Wt(this.z,e.z,n.z),this.w=Wt(this.w,e.w,n.w),this}clampScalar(e,n){return this.x=Wt(this.x,e,n),this.y=Wt(this.y,e,n),this.z=Wt(this.z,e,n),this.w=Wt(this.w,e,n),this}clampLength(e,n){const i=this.length();return this.divideScalar(i||1).multiplyScalar(Wt(i,e,n))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this.w=Math.floor(this.w),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this.w=Math.ceil(this.w),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this.w=Math.round(this.w),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this.z=Math.trunc(this.z),this.w=Math.trunc(this.w),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z+this.w*e.w}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)}normalize(){return this.divideScalar(this.length()||1)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,n){return this.x+=(e.x-this.x)*n,this.y+=(e.y-this.y)*n,this.z+=(e.z-this.z)*n,this.w+=(e.w-this.w)*n,this}lerpVectors(e,n,i){return this.x=e.x+(n.x-e.x)*i,this.y=e.y+(n.y-e.y)*i,this.z=e.z+(n.z-e.z)*i,this.w=e.w+(n.w-e.w)*i,this}equals(e){return e.x===this.x&&e.y===this.y&&e.z===this.z&&e.w===this.w}fromArray(e,n=0){return this.x=e[n],this.y=e[n+1],this.z=e[n+2],this.w=e[n+3],this}toArray(e=[],n=0){return e[n]=this.x,e[n+1]=this.y,e[n+2]=this.z,e[n+3]=this.w,e}fromBufferAttribute(e,n){return this.x=e.getX(n),this.y=e.getY(n),this.z=e.getZ(n),this.w=e.getW(n),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this.w=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z,yield this.w}}class $h extends gu{constructor(e=1,n=1,i={}){super(),this.isRenderTarget=!0,this.width=e,this.height=n,this.depth=i.depth?i.depth:1,this.scissor=new Nt(0,0,e,n),this.scissorTest=!1,this.viewport=new Nt(0,0,e,n);const s={width:e,height:n,depth:this.depth};i=Object.assign({generateMipmaps:!1,internalFormat:null,minFilter:li,depthBuffer:!0,stencilBuffer:!1,resolveDepthBuffer:!0,resolveStencilBuffer:!0,depthTexture:null,samples:0,count:1,multiview:!1},i);const o=new ui(s,i.mapping,i.wrapS,i.wrapT,i.magFilter,i.minFilter,i.format,i.type,i.anisotropy,i.colorSpace);o.flipY=!1,o.generateMipmaps=i.generateMipmaps,o.internalFormat=i.internalFormat,this.textures=[];const a=i.count;for(let l=0;l<a;l++)this.textures[l]=o.clone(),this.textures[l].isRenderTargetTexture=!0,this.textures[l].renderTarget=this;this.depthBuffer=i.depthBuffer,this.stencilBuffer=i.stencilBuffer,this.resolveDepthBuffer=i.resolveDepthBuffer,this.resolveStencilBuffer=i.resolveStencilBuffer,this._depthTexture=null,this.depthTexture=i.depthTexture,this.samples=i.samples,this.multiview=i.multiview}get texture(){return this.textures[0]}set texture(e){this.textures[0]=e}set depthTexture(e){this._depthTexture!==null&&(this._depthTexture.renderTarget=null),e!==null&&(e.renderTarget=this),this._depthTexture=e}get depthTexture(){return this._depthTexture}setSize(e,n,i=1){if(this.width!==e||this.height!==n||this.depth!==i){this.width=e,this.height=n,this.depth=i;for(let s=0,o=this.textures.length;s<o;s++)this.textures[s].image.width=e,this.textures[s].image.height=n,this.textures[s].image.depth=i;this.dispose()}this.viewport.set(0,0,e,n),this.scissor.set(0,0,e,n)}clone(){return new this.constructor().copy(this)}copy(e){this.width=e.width,this.height=e.height,this.depth=e.depth,this.scissor.copy(e.scissor),this.scissorTest=e.scissorTest,this.viewport.copy(e.viewport),this.textures.length=0;for(let n=0,i=e.textures.length;n<i;n++){this.textures[n]=e.textures[n].clone(),this.textures[n].isRenderTargetTexture=!0,this.textures[n].renderTarget=this;const s=Object.assign({},e.textures[n].image);this.textures[n].source=new RF(s)}return this.depthBuffer=e.depthBuffer,this.stencilBuffer=e.stencilBuffer,this.resolveDepthBuffer=e.resolveDepthBuffer,this.resolveStencilBuffer=e.resolveStencilBuffer,e.depthTexture!==null&&(this.depthTexture=e.depthTexture.clone()),this.samples=e.samples,this}dispose(){this.dispatchEvent({type:"dispose"})}}class Rh extends $h{constructor(e=1,n=1,i={}){super(e,n,i),this.isWebGLRenderTarget=!0}}class KM extends ui{constructor(e=null,n=1,i=1,s=1){super(null),this.isDataArrayTexture=!0,this.image={data:e,width:n,height:i,depth:s},this.magFilter=jn,this.minFilter=jn,this.wrapR=Tl,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1,this.layerUpdates=new Set}addLayerUpdate(e){this.layerUpdates.add(e)}clearLayerUpdates(){this.layerUpdates.clear()}}class Mve extends ui{constructor(e=null,n=1,i=1,s=1){super(null),this.isData3DTexture=!0,this.image={data:e,width:n,height:i,depth:s},this.magFilter=jn,this.minFilter=jn,this.wrapR=Tl,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}class rl{constructor(e=0,n=0,i=0,s=1){this.isQuaternion=!0,this._x=e,this._y=n,this._z=i,this._w=s}static slerpFlat(e,n,i,s,o,a,l){let c=i[s+0],u=i[s+1],h=i[s+2],f=i[s+3];const d=o[a+0],p=o[a+1],m=o[a+2],g=o[a+3];if(l===0){e[n+0]=c,e[n+1]=u,e[n+2]=h,e[n+3]=f;return}if(l===1){e[n+0]=d,e[n+1]=p,e[n+2]=m,e[n+3]=g;return}if(f!==g||c!==d||u!==p||h!==m){let v=1-l;const y=c*d+u*p+h*m+f*g,x=y>=0?1:-1,b=1-y*y;if(b>Number.EPSILON){const _=Math.sqrt(b),S=Math.atan2(_,y*x);v=Math.sin(v*S)/_,l=Math.sin(l*S)/_}const w=l*x;if(c=c*v+d*w,u=u*v+p*w,h=h*v+m*w,f=f*v+g*w,v===1-l){const _=1/Math.sqrt(c*c+u*u+h*h+f*f);c*=_,u*=_,h*=_,f*=_}}e[n]=c,e[n+1]=u,e[n+2]=h,e[n+3]=f}static multiplyQuaternionsFlat(e,n,i,s,o,a){const l=i[s],c=i[s+1],u=i[s+2],h=i[s+3],f=o[a],d=o[a+1],p=o[a+2],m=o[a+3];return e[n]=l*m+h*f+c*p-u*d,e[n+1]=c*m+h*d+u*f-l*p,e[n+2]=u*m+h*p+l*d-c*f,e[n+3]=h*m-l*f-c*d-u*p,e}get x(){return this._x}set x(e){this._x=e,this._onChangeCallback()}get y(){return this._y}set y(e){this._y=e,this._onChangeCallback()}get z(){return this._z}set z(e){this._z=e,this._onChangeCallback()}get w(){return this._w}set w(e){this._w=e,this._onChangeCallback()}set(e,n,i,s){return this._x=e,this._y=n,this._z=i,this._w=s,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._w)}copy(e){return this._x=e.x,this._y=e.y,this._z=e.z,this._w=e.w,this._onChangeCallback(),this}setFromEuler(e,n=!0){const i=e._x,s=e._y,o=e._z,a=e._order,l=Math.cos,c=Math.sin,u=l(i/2),h=l(s/2),f=l(o/2),d=c(i/2),p=c(s/2),m=c(o/2);switch(a){case"XYZ":this._x=d*h*f+u*p*m,this._y=u*p*f-d*h*m,this._z=u*h*m+d*p*f,this._w=u*h*f-d*p*m;break;case"YXZ":this._x=d*h*f+u*p*m,this._y=u*p*f-d*h*m,this._z=u*h*m-d*p*f,this._w=u*h*f+d*p*m;break;case"ZXY":this._x=d*h*f-u*p*m,this._y=u*p*f+d*h*m,this._z=u*h*m+d*p*f,this._w=u*h*f-d*p*m;break;case"ZYX":this._x=d*h*f-u*p*m,this._y=u*p*f+d*h*m,this._z=u*h*m-d*p*f,this._w=u*h*f+d*p*m;break;case"YZX":this._x=d*h*f+u*p*m,this._y=u*p*f+d*h*m,this._z=u*h*m-d*p*f,this._w=u*h*f-d*p*m;break;case"XZY":this._x=d*h*f-u*p*m,this._y=u*p*f-d*h*m,this._z=u*h*m+d*p*f,this._w=u*h*f+d*p*m;break;default:console.warn("THREE.Quaternion: .setFromEuler() encountered an unknown order: "+a)}return n===!0&&this._onChangeCallback(),this}setFromAxisAngle(e,n){const i=n/2,s=Math.sin(i);return this._x=e.x*s,this._y=e.y*s,this._z=e.z*s,this._w=Math.cos(i),this._onChangeCallback(),this}setFromRotationMatrix(e){const n=e.elements,i=n[0],s=n[4],o=n[8],a=n[1],l=n[5],c=n[9],u=n[2],h=n[6],f=n[10],d=i+l+f;if(d>0){const p=.5/Math.sqrt(d+1);this._w=.25/p,this._x=(h-c)*p,this._y=(o-u)*p,this._z=(a-s)*p}else if(i>l&&i>f){const p=2*Math.sqrt(1+i-l-f);this._w=(h-c)/p,this._x=.25*p,this._y=(s+a)/p,this._z=(o+u)/p}else if(l>f){const p=2*Math.sqrt(1+l-i-f);this._w=(o-u)/p,this._x=(s+a)/p,this._y=.25*p,this._z=(c+h)/p}else{const p=2*Math.sqrt(1+f-i-l);this._w=(a-s)/p,this._x=(o+u)/p,this._y=(c+h)/p,this._z=.25*p}return this._onChangeCallback(),this}setFromUnitVectors(e,n){let i=e.dot(n)+1;return i<Number.EPSILON?(i=0,Math.abs(e.x)>Math.abs(e.z)?(this._x=-e.y,this._y=e.x,this._z=0,this._w=i):(this._x=0,this._y=-e.z,this._z=e.y,this._w=i)):(this._x=e.y*n.z-e.z*n.y,this._y=e.z*n.x-e.x*n.z,this._z=e.x*n.y-e.y*n.x,this._w=i),this.normalize()}angleTo(e){return 2*Math.acos(Math.abs(Wt(this.dot(e),-1,1)))}rotateTowards(e,n){const i=this.angleTo(e);if(i===0)return this;const s=Math.min(1,n/i);return this.slerp(e,s),this}identity(){return this.set(0,0,0,1)}invert(){return this.conjugate()}conjugate(){return this._x*=-1,this._y*=-1,this._z*=-1,this._onChangeCallback(),this}dot(e){return this._x*e._x+this._y*e._y+this._z*e._z+this._w*e._w}lengthSq(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w}length(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)}normalize(){let e=this.length();return e===0?(this._x=0,this._y=0,this._z=0,this._w=1):(e=1/e,this._x=this._x*e,this._y=this._y*e,this._z=this._z*e,this._w=this._w*e),this._onChangeCallback(),this}multiply(e){return this.multiplyQuaternions(this,e)}premultiply(e){return this.multiplyQuaternions(e,this)}multiplyQuaternions(e,n){const i=e._x,s=e._y,o=e._z,a=e._w,l=n._x,c=n._y,u=n._z,h=n._w;return this._x=i*h+a*l+s*u-o*c,this._y=s*h+a*c+o*l-i*u,this._z=o*h+a*u+i*c-s*l,this._w=a*h-i*l-s*c-o*u,this._onChangeCallback(),this}slerp(e,n){if(n===0)return this;if(n===1)return this.copy(e);const i=this._x,s=this._y,o=this._z,a=this._w;let l=a*e._w+i*e._x+s*e._y+o*e._z;if(l<0?(this._w=-e._w,this._x=-e._x,this._y=-e._y,this._z=-e._z,l=-l):this.copy(e),l>=1)return this._w=a,this._x=i,this._y=s,this._z=o,this;const c=1-l*l;if(c<=Number.EPSILON){const p=1-n;return this._w=p*a+n*this._w,this._x=p*i+n*this._x,this._y=p*s+n*this._y,this._z=p*o+n*this._z,this.normalize(),this}const u=Math.sqrt(c),h=Math.atan2(u,l),f=Math.sin((1-n)*h)/u,d=Math.sin(n*h)/u;return this._w=a*f+this._w*d,this._x=i*f+this._x*d,this._y=s*f+this._y*d,this._z=o*f+this._z*d,this._onChangeCallback(),this}slerpQuaternions(e,n,i){return this.copy(e).slerp(n,i)}random(){const e=2*Math.PI*Math.random(),n=2*Math.PI*Math.random(),i=Math.random(),s=Math.sqrt(1-i),o=Math.sqrt(i);return this.set(s*Math.sin(e),s*Math.cos(e),o*Math.sin(n),o*Math.cos(n))}equals(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._w===this._w}fromArray(e,n=0){return this._x=e[n],this._y=e[n+1],this._z=e[n+2],this._w=e[n+3],this._onChangeCallback(),this}toArray(e=[],n=0){return e[n]=this._x,e[n+1]=this._y,e[n+2]=this._z,e[n+3]=this._w,e}fromBufferAttribute(e,n){return this._x=e.getX(n),this._y=e.getY(n),this._z=e.getZ(n),this._w=e.getW(n),this._onChangeCallback(),this}toJSON(){return this.toArray()}_onChange(e){return this._onChangeCallback=e,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._w}}class K{constructor(e=0,n=0,i=0){K.prototype.isVector3=!0,this.x=e,this.y=n,this.z=i}set(e,n,i){return i===void 0&&(i=this.z),this.x=e,this.y=n,this.z=i,this}setScalar(e){return this.x=e,this.y=e,this.z=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setZ(e){return this.z=e,this}setComponent(e,n){switch(e){case 0:this.x=n;break;case 1:this.y=n;break;case 2:this.z=n;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y,this.z)}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this}add(e){return this.x+=e.x,this.y+=e.y,this.z+=e.z,this}addScalar(e){return this.x+=e,this.y+=e,this.z+=e,this}addVectors(e,n){return this.x=e.x+n.x,this.y=e.y+n.y,this.z=e.z+n.z,this}addScaledVector(e,n){return this.x+=e.x*n,this.y+=e.y*n,this.z+=e.z*n,this}sub(e){return this.x-=e.x,this.y-=e.y,this.z-=e.z,this}subScalar(e){return this.x-=e,this.y-=e,this.z-=e,this}subVectors(e,n){return this.x=e.x-n.x,this.y=e.y-n.y,this.z=e.z-n.z,this}multiply(e){return this.x*=e.x,this.y*=e.y,this.z*=e.z,this}multiplyScalar(e){return this.x*=e,this.y*=e,this.z*=e,this}multiplyVectors(e,n){return this.x=e.x*n.x,this.y=e.y*n.y,this.z=e.z*n.z,this}applyEuler(e){return this.applyQuaternion(dV.setFromEuler(e))}applyAxisAngle(e,n){return this.applyQuaternion(dV.setFromAxisAngle(e,n))}applyMatrix3(e){const n=this.x,i=this.y,s=this.z,o=e.elements;return this.x=o[0]*n+o[3]*i+o[6]*s,this.y=o[1]*n+o[4]*i+o[7]*s,this.z=o[2]*n+o[5]*i+o[8]*s,this}applyNormalMatrix(e){return this.applyMatrix3(e).normalize()}applyMatrix4(e){const n=this.x,i=this.y,s=this.z,o=e.elements,a=1/(o[3]*n+o[7]*i+o[11]*s+o[15]);return this.x=(o[0]*n+o[4]*i+o[8]*s+o[12])*a,this.y=(o[1]*n+o[5]*i+o[9]*s+o[13])*a,this.z=(o[2]*n+o[6]*i+o[10]*s+o[14])*a,this}applyQuaternion(e){const n=this.x,i=this.y,s=this.z,o=e.x,a=e.y,l=e.z,c=e.w,u=2*(a*s-l*i),h=2*(l*n-o*s),f=2*(o*i-a*n);return this.x=n+c*u+a*f-l*h,this.y=i+c*h+l*u-o*f,this.z=s+c*f+o*h-a*u,this}project(e){return this.applyMatrix4(e.matrixWorldInverse).applyMatrix4(e.projectionMatrix)}unproject(e){return this.applyMatrix4(e.projectionMatrixInverse).applyMatrix4(e.matrixWorld)}transformDirection(e){const n=this.x,i=this.y,s=this.z,o=e.elements;return this.x=o[0]*n+o[4]*i+o[8]*s,this.y=o[1]*n+o[5]*i+o[9]*s,this.z=o[2]*n+o[6]*i+o[10]*s,this.normalize()}divide(e){return this.x/=e.x,this.y/=e.y,this.z/=e.z,this}divideScalar(e){return this.multiplyScalar(1/e)}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this}clamp(e,n){return this.x=Wt(this.x,e.x,n.x),this.y=Wt(this.y,e.y,n.y),this.z=Wt(this.z,e.z,n.z),this}clampScalar(e,n){return this.x=Wt(this.x,e,n),this.y=Wt(this.y,e,n),this.z=Wt(this.z,e,n),this}clampLength(e,n){const i=this.length();return this.divideScalar(i||1).multiplyScalar(Wt(i,e,n))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this.z=Math.trunc(this.z),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)}normalize(){return this.divideScalar(this.length()||1)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,n){return this.x+=(e.x-this.x)*n,this.y+=(e.y-this.y)*n,this.z+=(e.z-this.z)*n,this}lerpVectors(e,n,i){return this.x=e.x+(n.x-e.x)*i,this.y=e.y+(n.y-e.y)*i,this.z=e.z+(n.z-e.z)*i,this}cross(e){return this.crossVectors(this,e)}crossVectors(e,n){const i=e.x,s=e.y,o=e.z,a=n.x,l=n.y,c=n.z;return this.x=s*c-o*l,this.y=o*a-i*c,this.z=i*l-s*a,this}projectOnVector(e){const n=e.lengthSq();if(n===0)return this.set(0,0,0);const i=e.dot(this)/n;return this.copy(e).multiplyScalar(i)}projectOnPlane(e){return YP.copy(this).projectOnVector(e),this.sub(YP)}reflect(e){return this.sub(YP.copy(e).multiplyScalar(2*this.dot(e)))}angleTo(e){const n=Math.sqrt(this.lengthSq()*e.lengthSq());if(n===0)return Math.PI/2;const i=this.dot(e)/n;return Math.acos(Wt(i,-1,1))}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){const n=this.x-e.x,i=this.y-e.y,s=this.z-e.z;return n*n+i*i+s*s}manhattanDistanceTo(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)+Math.abs(this.z-e.z)}setFromSpherical(e){return this.setFromSphericalCoords(e.radius,e.phi,e.theta)}setFromSphericalCoords(e,n,i){const s=Math.sin(n)*e;return this.x=s*Math.sin(i),this.y=Math.cos(n)*e,this.z=s*Math.cos(i),this}setFromCylindrical(e){return this.setFromCylindricalCoords(e.radius,e.theta,e.y)}setFromCylindricalCoords(e,n,i){return this.x=e*Math.sin(n),this.y=i,this.z=e*Math.cos(n),this}setFromMatrixPosition(e){const n=e.elements;return this.x=n[12],this.y=n[13],this.z=n[14],this}setFromMatrixScale(e){const n=this.setFromMatrixColumn(e,0).length(),i=this.setFromMatrixColumn(e,1).length(),s=this.setFromMatrixColumn(e,2).length();return this.x=n,this.y=i,this.z=s,this}setFromMatrixColumn(e,n){return this.fromArray(e.elements,n*4)}setFromMatrix3Column(e,n){return this.fromArray(e.elements,n*3)}setFromEuler(e){return this.x=e._x,this.y=e._y,this.z=e._z,this}setFromColor(e){return this.x=e.r,this.y=e.g,this.z=e.b,this}equals(e){return e.x===this.x&&e.y===this.y&&e.z===this.z}fromArray(e,n=0){return this.x=e[n],this.y=e[n+1],this.z=e[n+2],this}toArray(e=[],n=0){return e[n]=this.x,e[n+1]=this.y,e[n+2]=this.z,e}fromBufferAttribute(e,n){return this.x=e.getX(n),this.y=e.getY(n),this.z=e.getZ(n),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this}randomDirection(){const e=Math.random()*Math.PI*2,n=Math.random()*2-1,i=Math.sqrt(1-n*n);return this.x=i*Math.cos(e),this.y=n,this.z=i*Math.sin(e),this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z}}const YP=new K,dV=new rl;class Od{constructor(e=new K(1/0,1/0,1/0),n=new K(-1/0,-1/0,-1/0)){this.isBox3=!0,this.min=e,this.max=n}set(e,n){return this.min.copy(e),this.max.copy(n),this}setFromArray(e){this.makeEmpty();for(let n=0,i=e.length;n<i;n+=3)this.expandByPoint(Ta.fromArray(e,n));return this}setFromBufferAttribute(e){this.makeEmpty();for(let n=0,i=e.count;n<i;n++)this.expandByPoint(Ta.fromBufferAttribute(e,n));return this}setFromPoints(e){this.makeEmpty();for(let n=0,i=e.length;n<i;n++)this.expandByPoint(e[n]);return this}setFromCenterAndSize(e,n){const i=Ta.copy(n).multiplyScalar(.5);return this.min.copy(e).sub(i),this.max.copy(e).add(i),this}setFromObject(e,n=!1){return this.makeEmpty(),this.expandByObject(e,n)}clone(){return new this.constructor().copy(this)}copy(e){return this.min.copy(e.min),this.max.copy(e.max),this}makeEmpty(){return this.min.x=this.min.y=this.min.z=1/0,this.max.x=this.max.y=this.max.z=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z}getCenter(e){return this.isEmpty()?e.set(0,0,0):e.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(e){return this.isEmpty()?e.set(0,0,0):e.subVectors(this.max,this.min)}expandByPoint(e){return this.min.min(e),this.max.max(e),this}expandByVector(e){return this.min.sub(e),this.max.add(e),this}expandByScalar(e){return this.min.addScalar(-e),this.max.addScalar(e),this}expandByObject(e,n=!1){e.updateWorldMatrix(!1,!1);const i=e.geometry;if(i!==void 0){const o=i.getAttribute("position");if(n===!0&&o!==void 0&&e.isInstancedMesh!==!0)for(let a=0,l=o.count;a<l;a++)e.isMesh===!0?e.getVertexPosition(a,Ta):Ta.fromBufferAttribute(o,a),Ta.applyMatrix4(e.matrixWorld),this.expandByPoint(Ta);else e.boundingBox!==void 0?(e.boundingBox===null&&e.computeBoundingBox(),Ww.copy(e.boundingBox)):(i.boundingBox===null&&i.computeBoundingBox(),Ww.copy(i.boundingBox)),Ww.applyMatrix4(e.matrixWorld),this.union(Ww)}const s=e.children;for(let o=0,a=s.length;o<a;o++)this.expandByObject(s[o],n);return this}containsPoint(e){return e.x>=this.min.x&&e.x<=this.max.x&&e.y>=this.min.y&&e.y<=this.max.y&&e.z>=this.min.z&&e.z<=this.max.z}containsBox(e){return this.min.x<=e.min.x&&e.max.x<=this.max.x&&this.min.y<=e.min.y&&e.max.y<=this.max.y&&this.min.z<=e.min.z&&e.max.z<=this.max.z}getParameter(e,n){return n.set((e.x-this.min.x)/(this.max.x-this.min.x),(e.y-this.min.y)/(this.max.y-this.min.y),(e.z-this.min.z)/(this.max.z-this.min.z))}intersectsBox(e){return e.max.x>=this.min.x&&e.min.x<=this.max.x&&e.max.y>=this.min.y&&e.min.y<=this.max.y&&e.max.z>=this.min.z&&e.min.z<=this.max.z}intersectsSphere(e){return this.clampPoint(e.center,Ta),Ta.distanceToSquared(e.center)<=e.radius*e.radius}intersectsPlane(e){let n,i;return e.normal.x>0?(n=e.normal.x*this.min.x,i=e.normal.x*this.max.x):(n=e.normal.x*this.max.x,i=e.normal.x*this.min.x),e.normal.y>0?(n+=e.normal.y*this.min.y,i+=e.normal.y*this.max.y):(n+=e.normal.y*this.max.y,i+=e.normal.y*this.min.y),e.normal.z>0?(n+=e.normal.z*this.min.z,i+=e.normal.z*this.max.z):(n+=e.normal.z*this.max.z,i+=e.normal.z*this.min.z),n<=-e.constant&&i>=-e.constant}intersectsTriangle(e){if(this.isEmpty())return!1;this.getCenter(lv),qw.subVectors(this.max,lv),cp.subVectors(e.a,lv),up.subVectors(e.b,lv),hp.subVectors(e.c,lv),ku.subVectors(up,cp),Iu.subVectors(hp,up),of.subVectors(cp,hp);let n=[0,-ku.z,ku.y,0,-Iu.z,Iu.y,0,-of.z,of.y,ku.z,0,-ku.x,Iu.z,0,-Iu.x,of.z,0,-of.x,-ku.y,ku.x,0,-Iu.y,Iu.x,0,-of.y,of.x,0];return!ZP(n,cp,up,hp,qw)||(n=[1,0,0,0,1,0,0,0,1],!ZP(n,cp,up,hp,qw))?!1:(Xw.crossVectors(ku,Iu),n=[Xw.x,Xw.y,Xw.z],ZP(n,cp,up,hp,qw))}clampPoint(e,n){return n.copy(e).clamp(this.min,this.max)}distanceToPoint(e){return this.clampPoint(e,Ta).distanceTo(e)}getBoundingSphere(e){return this.isEmpty()?e.makeEmpty():(this.getCenter(e.center),e.radius=this.getSize(Ta).length()*.5),e}intersect(e){return this.min.max(e.min),this.max.min(e.max),this.isEmpty()&&this.makeEmpty(),this}union(e){return this.min.min(e.min),this.max.max(e.max),this}applyMatrix4(e){return this.isEmpty()?this:(lc[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(e),lc[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(e),lc[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(e),lc[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(e),lc[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(e),lc[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(e),lc[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(e),lc[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(e),this.setFromPoints(lc),this)}translate(e){return this.min.add(e),this.max.add(e),this}equals(e){return e.min.equals(this.min)&&e.max.equals(this.max)}}const lc=[new K,new K,new K,new K,new K,new K,new K,new K],Ta=new K,Ww=new Od,cp=new K,up=new K,hp=new K,ku=new K,Iu=new K,of=new K,lv=new K,qw=new K,Xw=new K,af=new K;function ZP(r,e,n,i,s){for(let o=0,a=r.length-3;o<=a;o+=3){af.fromArray(r,o);const l=s.x*Math.abs(af.x)+s.y*Math.abs(af.y)+s.z*Math.abs(af.z),c=e.dot(af),u=n.dot(af),h=i.dot(af);if(Math.max(-Math.max(c,u,h),Math.min(c,u,h))>l)return!1}return!0}const Ave=new Od,cv=new K,QP=new K;class f_{constructor(e=new K,n=-1){this.isSphere=!0,this.center=e,this.radius=n}set(e,n){return this.center.copy(e),this.radius=n,this}setFromPoints(e,n){const i=this.center;n!==void 0?i.copy(n):Ave.setFromPoints(e).getCenter(i);let s=0;for(let o=0,a=e.length;o<a;o++)s=Math.max(s,i.distanceToSquared(e[o]));return this.radius=Math.sqrt(s),this}copy(e){return this.center.copy(e.center),this.radius=e.radius,this}isEmpty(){return this.radius<0}makeEmpty(){return this.center.set(0,0,0),this.radius=-1,this}containsPoint(e){return e.distanceToSquared(this.center)<=this.radius*this.radius}distanceToPoint(e){return e.distanceTo(this.center)-this.radius}intersectsSphere(e){const n=this.radius+e.radius;return e.center.distanceToSquared(this.center)<=n*n}intersectsBox(e){return e.intersectsSphere(this)}intersectsPlane(e){return Math.abs(e.distanceToPoint(this.center))<=this.radius}clampPoint(e,n){const i=this.center.distanceToSquared(e);return n.copy(e),i>this.radius*this.radius&&(n.sub(this.center).normalize(),n.multiplyScalar(this.radius).add(this.center)),n}getBoundingBox(e){return this.isEmpty()?(e.makeEmpty(),e):(e.set(this.center,this.center),e.expandByScalar(this.radius),e)}applyMatrix4(e){return this.center.applyMatrix4(e),this.radius=this.radius*e.getMaxScaleOnAxis(),this}translate(e){return this.center.add(e),this}expandByPoint(e){if(this.isEmpty())return this.center.copy(e),this.radius=0,this;cv.subVectors(e,this.center);const n=cv.lengthSq();if(n>this.radius*this.radius){const i=Math.sqrt(n),s=(i-this.radius)*.5;this.center.addScaledVector(cv,s/i),this.radius+=s}return this}union(e){return e.isEmpty()?this:this.isEmpty()?(this.copy(e),this):(this.center.equals(e.center)===!0?this.radius=Math.max(this.radius,e.radius):(QP.subVectors(e.center,this.center).setLength(e.radius),this.expandByPoint(cv.copy(e.center).add(QP)),this.expandByPoint(cv.copy(e.center).sub(QP))),this)}equals(e){return e.center.equals(this.center)&&e.radius===this.radius}clone(){return new this.constructor().copy(this)}}const cc=new K,JP=new K,Kw=new K,Lu=new K,eR=new K,Yw=new K,tR=new K;class YM{constructor(e=new K,n=new K(0,0,-1)){this.origin=e,this.direction=n}set(e,n){return this.origin.copy(e),this.direction.copy(n),this}copy(e){return this.origin.copy(e.origin),this.direction.copy(e.direction),this}at(e,n){return n.copy(this.origin).addScaledVector(this.direction,e)}lookAt(e){return this.direction.copy(e).sub(this.origin).normalize(),this}recast(e){return this.origin.copy(this.at(e,cc)),this}closestPointToPoint(e,n){n.subVectors(e,this.origin);const i=n.dot(this.direction);return i<0?n.copy(this.origin):n.copy(this.origin).addScaledVector(this.direction,i)}distanceToPoint(e){return Math.sqrt(this.distanceSqToPoint(e))}distanceSqToPoint(e){const n=cc.subVectors(e,this.origin).dot(this.direction);return n<0?this.origin.distanceToSquared(e):(cc.copy(this.origin).addScaledVector(this.direction,n),cc.distanceToSquared(e))}distanceSqToSegment(e,n,i,s){JP.copy(e).add(n).multiplyScalar(.5),Kw.copy(n).sub(e).normalize(),Lu.copy(this.origin).sub(JP);const o=e.distanceTo(n)*.5,a=-this.direction.dot(Kw),l=Lu.dot(this.direction),c=-Lu.dot(Kw),u=Lu.lengthSq(),h=Math.abs(1-a*a);let f,d,p,m;if(h>0)if(f=a*c-l,d=a*l-c,m=o*h,f>=0)if(d>=-m)if(d<=m){const g=1/h;f*=g,d*=g,p=f*(f+a*d+2*l)+d*(a*f+d+2*c)+u}else d=o,f=Math.max(0,-(a*d+l)),p=-f*f+d*(d+2*c)+u;else d=-o,f=Math.max(0,-(a*d+l)),p=-f*f+d*(d+2*c)+u;else d<=-m?(f=Math.max(0,-(-a*o+l)),d=f>0?-o:Math.min(Math.max(-o,-c),o),p=-f*f+d*(d+2*c)+u):d<=m?(f=0,d=Math.min(Math.max(-o,-c),o),p=d*(d+2*c)+u):(f=Math.max(0,-(a*o+l)),d=f>0?o:Math.min(Math.max(-o,-c),o),p=-f*f+d*(d+2*c)+u);else d=a>0?-o:o,f=Math.max(0,-(a*d+l)),p=-f*f+d*(d+2*c)+u;return i&&i.copy(this.origin).addScaledVector(this.direction,f),s&&s.copy(JP).addScaledVector(Kw,d),p}intersectSphere(e,n){cc.subVectors(e.center,this.origin);const i=cc.dot(this.direction),s=cc.dot(cc)-i*i,o=e.radius*e.radius;if(s>o)return null;const a=Math.sqrt(o-s),l=i-a,c=i+a;return c<0?null:l<0?this.at(c,n):this.at(l,n)}intersectsSphere(e){return this.distanceSqToPoint(e.center)<=e.radius*e.radius}distanceToPlane(e){const n=e.normal.dot(this.direction);if(n===0)return e.distanceToPoint(this.origin)===0?0:null;const i=-(this.origin.dot(e.normal)+e.constant)/n;return i>=0?i:null}intersectPlane(e,n){const i=this.distanceToPlane(e);return i===null?null:this.at(i,n)}intersectsPlane(e){const n=e.distanceToPoint(this.origin);return n===0||e.normal.dot(this.direction)*n<0}intersectBox(e,n){let i,s,o,a,l,c;const u=1/this.direction.x,h=1/this.direction.y,f=1/this.direction.z,d=this.origin;return u>=0?(i=(e.min.x-d.x)*u,s=(e.max.x-d.x)*u):(i=(e.max.x-d.x)*u,s=(e.min.x-d.x)*u),h>=0?(o=(e.min.y-d.y)*h,a=(e.max.y-d.y)*h):(o=(e.max.y-d.y)*h,a=(e.min.y-d.y)*h),i>a||o>s||((o>i||isNaN(i))&&(i=o),(a<s||isNaN(s))&&(s=a),f>=0?(l=(e.min.z-d.z)*f,c=(e.max.z-d.z)*f):(l=(e.max.z-d.z)*f,c=(e.min.z-d.z)*f),i>c||l>s)||((l>i||i!==i)&&(i=l),(c<s||s!==s)&&(s=c),s<0)?null:this.at(i>=0?i:s,n)}intersectsBox(e){return this.intersectBox(e,cc)!==null}intersectTriangle(e,n,i,s,o){eR.subVectors(n,e),Yw.subVectors(i,e),tR.crossVectors(eR,Yw);let a=this.direction.dot(tR),l;if(a>0){if(s)return null;l=1}else if(a<0)l=-1,a=-a;else return null;Lu.subVectors(this.origin,e);const c=l*this.direction.dot(Yw.crossVectors(Lu,Yw));if(c<0)return null;const u=l*this.direction.dot(eR.cross(Lu));if(u<0||c+u>a)return null;const h=-l*Lu.dot(tR);return h<0?null:this.at(h/a,o)}applyMatrix4(e){return this.origin.applyMatrix4(e),this.direction.transformDirection(e),this}equals(e){return e.origin.equals(this.origin)&&e.direction.equals(this.direction)}clone(){return new this.constructor().copy(this)}}class sn{constructor(e,n,i,s,o,a,l,c,u,h,f,d,p,m,g,v){sn.prototype.isMatrix4=!0,this.elements=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],e!==void 0&&this.set(e,n,i,s,o,a,l,c,u,h,f,d,p,m,g,v)}set(e,n,i,s,o,a,l,c,u,h,f,d,p,m,g,v){const y=this.elements;return y[0]=e,y[4]=n,y[8]=i,y[12]=s,y[1]=o,y[5]=a,y[9]=l,y[13]=c,y[2]=u,y[6]=h,y[10]=f,y[14]=d,y[3]=p,y[7]=m,y[11]=g,y[15]=v,this}identity(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this}clone(){return new sn().fromArray(this.elements)}copy(e){const n=this.elements,i=e.elements;return n[0]=i[0],n[1]=i[1],n[2]=i[2],n[3]=i[3],n[4]=i[4],n[5]=i[5],n[6]=i[6],n[7]=i[7],n[8]=i[8],n[9]=i[9],n[10]=i[10],n[11]=i[11],n[12]=i[12],n[13]=i[13],n[14]=i[14],n[15]=i[15],this}copyPosition(e){const n=this.elements,i=e.elements;return n[12]=i[12],n[13]=i[13],n[14]=i[14],this}setFromMatrix3(e){const n=e.elements;return this.set(n[0],n[3],n[6],0,n[1],n[4],n[7],0,n[2],n[5],n[8],0,0,0,0,1),this}extractBasis(e,n,i){return e.setFromMatrixColumn(this,0),n.setFromMatrixColumn(this,1),i.setFromMatrixColumn(this,2),this}makeBasis(e,n,i){return this.set(e.x,n.x,i.x,0,e.y,n.y,i.y,0,e.z,n.z,i.z,0,0,0,0,1),this}extractRotation(e){const n=this.elements,i=e.elements,s=1/fp.setFromMatrixColumn(e,0).length(),o=1/fp.setFromMatrixColumn(e,1).length(),a=1/fp.setFromMatrixColumn(e,2).length();return n[0]=i[0]*s,n[1]=i[1]*s,n[2]=i[2]*s,n[3]=0,n[4]=i[4]*o,n[5]=i[5]*o,n[6]=i[6]*o,n[7]=0,n[8]=i[8]*a,n[9]=i[9]*a,n[10]=i[10]*a,n[11]=0,n[12]=0,n[13]=0,n[14]=0,n[15]=1,this}makeRotationFromEuler(e){const n=this.elements,i=e.x,s=e.y,o=e.z,a=Math.cos(i),l=Math.sin(i),c=Math.cos(s),u=Math.sin(s),h=Math.cos(o),f=Math.sin(o);if(e.order==="XYZ"){const d=a*h,p=a*f,m=l*h,g=l*f;n[0]=c*h,n[4]=-c*f,n[8]=u,n[1]=p+m*u,n[5]=d-g*u,n[9]=-l*c,n[2]=g-d*u,n[6]=m+p*u,n[10]=a*c}else if(e.order==="YXZ"){const d=c*h,p=c*f,m=u*h,g=u*f;n[0]=d+g*l,n[4]=m*l-p,n[8]=a*u,n[1]=a*f,n[5]=a*h,n[9]=-l,n[2]=p*l-m,n[6]=g+d*l,n[10]=a*c}else if(e.order==="ZXY"){const d=c*h,p=c*f,m=u*h,g=u*f;n[0]=d-g*l,n[4]=-a*f,n[8]=m+p*l,n[1]=p+m*l,n[5]=a*h,n[9]=g-d*l,n[2]=-a*u,n[6]=l,n[10]=a*c}else if(e.order==="ZYX"){const d=a*h,p=a*f,m=l*h,g=l*f;n[0]=c*h,n[4]=m*u-p,n[8]=d*u+g,n[1]=c*f,n[5]=g*u+d,n[9]=p*u-m,n[2]=-u,n[6]=l*c,n[10]=a*c}else if(e.order==="YZX"){const d=a*c,p=a*u,m=l*c,g=l*u;n[0]=c*h,n[4]=g-d*f,n[8]=m*f+p,n[1]=f,n[5]=a*h,n[9]=-l*h,n[2]=-u*h,n[6]=p*f+m,n[10]=d-g*f}else if(e.order==="XZY"){const d=a*c,p=a*u,m=l*c,g=l*u;n[0]=c*h,n[4]=-f,n[8]=u*h,n[1]=d*f+g,n[5]=a*h,n[9]=p*f-m,n[2]=m*f-p,n[6]=l*h,n[10]=g*f+d}return n[3]=0,n[7]=0,n[11]=0,n[12]=0,n[13]=0,n[14]=0,n[15]=1,this}makeRotationFromQuaternion(e){return this.compose(Cve,e,Pve)}lookAt(e,n,i){const s=this.elements;return fo.subVectors(e,n),fo.lengthSq()===0&&(fo.z=1),fo.normalize(),Fu.crossVectors(i,fo),Fu.lengthSq()===0&&(Math.abs(i.z)===1?fo.x+=1e-4:fo.z+=1e-4,fo.normalize(),Fu.crossVectors(i,fo)),Fu.normalize(),Zw.crossVectors(fo,Fu),s[0]=Fu.x,s[4]=Zw.x,s[8]=fo.x,s[1]=Fu.y,s[5]=Zw.y,s[9]=fo.y,s[2]=Fu.z,s[6]=Zw.z,s[10]=fo.z,this}multiply(e){return this.multiplyMatrices(this,e)}premultiply(e){return this.multiplyMatrices(e,this)}multiplyMatrices(e,n){const i=e.elements,s=n.elements,o=this.elements,a=i[0],l=i[4],c=i[8],u=i[12],h=i[1],f=i[5],d=i[9],p=i[13],m=i[2],g=i[6],v=i[10],y=i[14],x=i[3],b=i[7],w=i[11],_=i[15],S=s[0],T=s[4],E=s[8],M=s[12],A=s[1],P=s[5],D=s[9],B=s[13],C=s[2],O=s[6],R=s[10],z=s[14],U=s[3],G=s[7],H=s[11],Y=s[15];return o[0]=a*S+l*A+c*C+u*U,o[4]=a*T+l*P+c*O+u*G,o[8]=a*E+l*D+c*R+u*H,o[12]=a*M+l*B+c*z+u*Y,o[1]=h*S+f*A+d*C+p*U,o[5]=h*T+f*P+d*O+p*G,o[9]=h*E+f*D+d*R+p*H,o[13]=h*M+f*B+d*z+p*Y,o[2]=m*S+g*A+v*C+y*U,o[6]=m*T+g*P+v*O+y*G,o[10]=m*E+g*D+v*R+y*H,o[14]=m*M+g*B+v*z+y*Y,o[3]=x*S+b*A+w*C+_*U,o[7]=x*T+b*P+w*O+_*G,o[11]=x*E+b*D+w*R+_*H,o[15]=x*M+b*B+w*z+_*Y,this}multiplyScalar(e){const n=this.elements;return n[0]*=e,n[4]*=e,n[8]*=e,n[12]*=e,n[1]*=e,n[5]*=e,n[9]*=e,n[13]*=e,n[2]*=e,n[6]*=e,n[10]*=e,n[14]*=e,n[3]*=e,n[7]*=e,n[11]*=e,n[15]*=e,this}determinant(){const e=this.elements,n=e[0],i=e[4],s=e[8],o=e[12],a=e[1],l=e[5],c=e[9],u=e[13],h=e[2],f=e[6],d=e[10],p=e[14],m=e[3],g=e[7],v=e[11],y=e[15];return m*(+o*c*f-s*u*f-o*l*d+i*u*d+s*l*p-i*c*p)+g*(+n*c*p-n*u*d+o*a*d-s*a*p+s*u*h-o*c*h)+v*(+n*u*f-n*l*p-o*a*f+i*a*p+o*l*h-i*u*h)+y*(-s*l*h-n*c*f+n*l*d+s*a*f-i*a*d+i*c*h)}transpose(){const e=this.elements;let n;return n=e[1],e[1]=e[4],e[4]=n,n=e[2],e[2]=e[8],e[8]=n,n=e[6],e[6]=e[9],e[9]=n,n=e[3],e[3]=e[12],e[12]=n,n=e[7],e[7]=e[13],e[13]=n,n=e[11],e[11]=e[14],e[14]=n,this}setPosition(e,n,i){const s=this.elements;return e.isVector3?(s[12]=e.x,s[13]=e.y,s[14]=e.z):(s[12]=e,s[13]=n,s[14]=i),this}invert(){const e=this.elements,n=e[0],i=e[1],s=e[2],o=e[3],a=e[4],l=e[5],c=e[6],u=e[7],h=e[8],f=e[9],d=e[10],p=e[11],m=e[12],g=e[13],v=e[14],y=e[15],x=f*v*u-g*d*u+g*c*p-l*v*p-f*c*y+l*d*y,b=m*d*u-h*v*u-m*c*p+a*v*p+h*c*y-a*d*y,w=h*g*u-m*f*u+m*l*p-a*g*p-h*l*y+a*f*y,_=m*f*c-h*g*c-m*l*d+a*g*d+h*l*v-a*f*v,S=n*x+i*b+s*w+o*_;if(S===0)return this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0);const T=1/S;return e[0]=x*T,e[1]=(g*d*o-f*v*o-g*s*p+i*v*p+f*s*y-i*d*y)*T,e[2]=(l*v*o-g*c*o+g*s*u-i*v*u-l*s*y+i*c*y)*T,e[3]=(f*c*o-l*d*o-f*s*u+i*d*u+l*s*p-i*c*p)*T,e[4]=b*T,e[5]=(h*v*o-m*d*o+m*s*p-n*v*p-h*s*y+n*d*y)*T,e[6]=(m*c*o-a*v*o-m*s*u+n*v*u+a*s*y-n*c*y)*T,e[7]=(a*d*o-h*c*o+h*s*u-n*d*u-a*s*p+n*c*p)*T,e[8]=w*T,e[9]=(m*f*o-h*g*o-m*i*p+n*g*p+h*i*y-n*f*y)*T,e[10]=(a*g*o-m*l*o+m*i*u-n*g*u-a*i*y+n*l*y)*T,e[11]=(h*l*o-a*f*o-h*i*u+n*f*u+a*i*p-n*l*p)*T,e[12]=_*T,e[13]=(h*g*s-m*f*s+m*i*d-n*g*d-h*i*v+n*f*v)*T,e[14]=(m*l*s-a*g*s-m*i*c+n*g*c+a*i*v-n*l*v)*T,e[15]=(a*f*s-h*l*s+h*i*c-n*f*c-a*i*d+n*l*d)*T,this}scale(e){const n=this.elements,i=e.x,s=e.y,o=e.z;return n[0]*=i,n[4]*=s,n[8]*=o,n[1]*=i,n[5]*=s,n[9]*=o,n[2]*=i,n[6]*=s,n[10]*=o,n[3]*=i,n[7]*=s,n[11]*=o,this}getMaxScaleOnAxis(){const e=this.elements,n=e[0]*e[0]+e[1]*e[1]+e[2]*e[2],i=e[4]*e[4]+e[5]*e[5]+e[6]*e[6],s=e[8]*e[8]+e[9]*e[9]+e[10]*e[10];return Math.sqrt(Math.max(n,i,s))}makeTranslation(e,n,i){return e.isVector3?this.set(1,0,0,e.x,0,1,0,e.y,0,0,1,e.z,0,0,0,1):this.set(1,0,0,e,0,1,0,n,0,0,1,i,0,0,0,1),this}makeRotationX(e){const n=Math.cos(e),i=Math.sin(e);return this.set(1,0,0,0,0,n,-i,0,0,i,n,0,0,0,0,1),this}makeRotationY(e){const n=Math.cos(e),i=Math.sin(e);return this.set(n,0,i,0,0,1,0,0,-i,0,n,0,0,0,0,1),this}makeRotationZ(e){const n=Math.cos(e),i=Math.sin(e);return this.set(n,-i,0,0,i,n,0,0,0,0,1,0,0,0,0,1),this}makeRotationAxis(e,n){const i=Math.cos(n),s=Math.sin(n),o=1-i,a=e.x,l=e.y,c=e.z,u=o*a,h=o*l;return this.set(u*a+i,u*l-s*c,u*c+s*l,0,u*l+s*c,h*l+i,h*c-s*a,0,u*c-s*l,h*c+s*a,o*c*c+i,0,0,0,0,1),this}makeScale(e,n,i){return this.set(e,0,0,0,0,n,0,0,0,0,i,0,0,0,0,1),this}makeShear(e,n,i,s,o,a){return this.set(1,i,o,0,e,1,a,0,n,s,1,0,0,0,0,1),this}compose(e,n,i){const s=this.elements,o=n._x,a=n._y,l=n._z,c=n._w,u=o+o,h=a+a,f=l+l,d=o*u,p=o*h,m=o*f,g=a*h,v=a*f,y=l*f,x=c*u,b=c*h,w=c*f,_=i.x,S=i.y,T=i.z;return s[0]=(1-(g+y))*_,s[1]=(p+w)*_,s[2]=(m-b)*_,s[3]=0,s[4]=(p-w)*S,s[5]=(1-(d+y))*S,s[6]=(v+x)*S,s[7]=0,s[8]=(m+b)*T,s[9]=(v-x)*T,s[10]=(1-(d+g))*T,s[11]=0,s[12]=e.x,s[13]=e.y,s[14]=e.z,s[15]=1,this}decompose(e,n,i){const s=this.elements;let o=fp.set(s[0],s[1],s[2]).length();const a=fp.set(s[4],s[5],s[6]).length(),l=fp.set(s[8],s[9],s[10]).length();this.determinant()<0&&(o=-o),e.x=s[12],e.y=s[13],e.z=s[14],Ea.copy(this);const u=1/o,h=1/a,f=1/l;return Ea.elements[0]*=u,Ea.elements[1]*=u,Ea.elements[2]*=u,Ea.elements[4]*=h,Ea.elements[5]*=h,Ea.elements[6]*=h,Ea.elements[8]*=f,Ea.elements[9]*=f,Ea.elements[10]*=f,n.setFromRotationMatrix(Ea),i.x=o,i.y=a,i.z=l,this}makePerspective(e,n,i,s,o,a,l=Ps){const c=this.elements,u=2*o/(n-e),h=2*o/(i-s),f=(n+e)/(n-e),d=(i+s)/(i-s);let p,m;if(l===Ps)p=-(a+o)/(a-o),m=-2*a*o/(a-o);else if(l===Ph)p=-a/(a-o),m=-a*o/(a-o);else throw new Error("THREE.Matrix4.makePerspective(): Invalid coordinate system: "+l);return c[0]=u,c[4]=0,c[8]=f,c[12]=0,c[1]=0,c[5]=h,c[9]=d,c[13]=0,c[2]=0,c[6]=0,c[10]=p,c[14]=m,c[3]=0,c[7]=0,c[11]=-1,c[15]=0,this}makeOrthographic(e,n,i,s,o,a,l=Ps){const c=this.elements,u=1/(n-e),h=1/(i-s),f=1/(a-o),d=(n+e)*u,p=(i+s)*h;let m,g;if(l===Ps)m=(a+o)*f,g=-2*f;else if(l===Ph)m=o*f,g=-1*f;else throw new Error("THREE.Matrix4.makeOrthographic(): Invalid coordinate system: "+l);return c[0]=2*u,c[4]=0,c[8]=0,c[12]=-d,c[1]=0,c[5]=2*h,c[9]=0,c[13]=-p,c[2]=0,c[6]=0,c[10]=g,c[14]=-m,c[3]=0,c[7]=0,c[11]=0,c[15]=1,this}equals(e){const n=this.elements,i=e.elements;for(let s=0;s<16;s++)if(n[s]!==i[s])return!1;return!0}fromArray(e,n=0){for(let i=0;i<16;i++)this.elements[i]=e[i+n];return this}toArray(e=[],n=0){const i=this.elements;return e[n]=i[0],e[n+1]=i[1],e[n+2]=i[2],e[n+3]=i[3],e[n+4]=i[4],e[n+5]=i[5],e[n+6]=i[6],e[n+7]=i[7],e[n+8]=i[8],e[n+9]=i[9],e[n+10]=i[10],e[n+11]=i[11],e[n+12]=i[12],e[n+13]=i[13],e[n+14]=i[14],e[n+15]=i[15],e}}const fp=new K,Ea=new sn,Cve=new K(0,0,0),Pve=new K(1,1,1),Fu=new K,Zw=new K,fo=new K,pV=new sn,mV=new rl;class so{constructor(e=0,n=0,i=0,s=so.DEFAULT_ORDER){this.isEuler=!0,this._x=e,this._y=n,this._z=i,this._order=s}get x(){return this._x}set x(e){this._x=e,this._onChangeCallback()}get y(){return this._y}set y(e){this._y=e,this._onChangeCallback()}get z(){return this._z}set z(e){this._z=e,this._onChangeCallback()}get order(){return this._order}set order(e){this._order=e,this._onChangeCallback()}set(e,n,i,s=this._order){return this._x=e,this._y=n,this._z=i,this._order=s,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._order)}copy(e){return this._x=e._x,this._y=e._y,this._z=e._z,this._order=e._order,this._onChangeCallback(),this}setFromRotationMatrix(e,n=this._order,i=!0){const s=e.elements,o=s[0],a=s[4],l=s[8],c=s[1],u=s[5],h=s[9],f=s[2],d=s[6],p=s[10];switch(n){case"XYZ":this._y=Math.asin(Wt(l,-1,1)),Math.abs(l)<.9999999?(this._x=Math.atan2(-h,p),this._z=Math.atan2(-a,o)):(this._x=Math.atan2(d,u),this._z=0);break;case"YXZ":this._x=Math.asin(-Wt(h,-1,1)),Math.abs(h)<.9999999?(this._y=Math.atan2(l,p),this._z=Math.atan2(c,u)):(this._y=Math.atan2(-f,o),this._z=0);break;case"ZXY":this._x=Math.asin(Wt(d,-1,1)),Math.abs(d)<.9999999?(this._y=Math.atan2(-f,p),this._z=Math.atan2(-a,u)):(this._y=0,this._z=Math.atan2(c,o));break;case"ZYX":this._y=Math.asin(-Wt(f,-1,1)),Math.abs(f)<.9999999?(this._x=Math.atan2(d,p),this._z=Math.atan2(c,o)):(this._x=0,this._z=Math.atan2(-a,u));break;case"YZX":this._z=Math.asin(Wt(c,-1,1)),Math.abs(c)<.9999999?(this._x=Math.atan2(-h,u),this._y=Math.atan2(-f,o)):(this._x=0,this._y=Math.atan2(l,p));break;case"XZY":this._z=Math.asin(-Wt(a,-1,1)),Math.abs(a)<.9999999?(this._x=Math.atan2(d,u),this._y=Math.atan2(l,o)):(this._x=Math.atan2(-h,p),this._y=0);break;default:console.warn("THREE.Euler: .setFromRotationMatrix() encountered an unknown order: "+n)}return this._order=n,i===!0&&this._onChangeCallback(),this}setFromQuaternion(e,n,i){return pV.makeRotationFromQuaternion(e),this.setFromRotationMatrix(pV,n,i)}setFromVector3(e,n=this._order){return this.set(e.x,e.y,e.z,n)}reorder(e){return mV.setFromEuler(this),this.setFromQuaternion(mV,e)}equals(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._order===this._order}fromArray(e){return this._x=e[0],this._y=e[1],this._z=e[2],e[3]!==void 0&&(this._order=e[3]),this._onChangeCallback(),this}toArray(e=[],n=0){return e[n]=this._x,e[n+1]=this._y,e[n+2]=this._z,e[n+3]=this._order,e}_onChange(e){return this._onChangeCallback=e,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._order}}so.DEFAULT_ORDER="XYZ";class NF{constructor(){this.mask=1}set(e){this.mask=(1<<e|0)>>>0}enable(e){this.mask|=1<<e|0}enableAll(){this.mask=-1}toggle(e){this.mask^=1<<e|0}disable(e){this.mask&=~(1<<e|0)}disableAll(){this.mask=0}test(e){return(this.mask&e.mask)!==0}isEnabled(e){return(this.mask&(1<<e|0))!==0}}let Rve=0;const gV=new K,dp=new rl,uc=new sn,Qw=new K,uv=new K,Nve=new K,Ove=new rl,yV=new K(1,0,0),vV=new K(0,1,0),xV=new K(0,0,1),bV={type:"added"},Dve={type:"removed"},pp={type:"childadded",child:null},nR={type:"childremoved",child:null};class Mr extends gu{constructor(){super(),this.isObject3D=!0,Object.defineProperty(this,"id",{value:Rve++}),this.uuid=Hc(),this.name="",this.type="Object3D",this.parent=null,this.children=[],this.up=Mr.DEFAULT_UP.clone();const e=new K,n=new so,i=new rl,s=new K(1,1,1);function o(){i.setFromEuler(n,!1)}function a(){n.setFromQuaternion(i,void 0,!1)}n._onChange(o),i._onChange(a),Object.defineProperties(this,{position:{configurable:!0,enumerable:!0,value:e},rotation:{configurable:!0,enumerable:!0,value:n},quaternion:{configurable:!0,enumerable:!0,value:i},scale:{configurable:!0,enumerable:!0,value:s},modelViewMatrix:{value:new sn},normalMatrix:{value:new Bt}}),this.matrix=new sn,this.matrixWorld=new sn,this.matrixAutoUpdate=Mr.DEFAULT_MATRIX_AUTO_UPDATE,this.matrixWorldAutoUpdate=Mr.DEFAULT_MATRIX_WORLD_AUTO_UPDATE,this.matrixWorldNeedsUpdate=!1,this.layers=new NF,this.visible=!0,this.castShadow=!1,this.receiveShadow=!1,this.frustumCulled=!0,this.renderOrder=0,this.animations=[],this.customDepthMaterial=void 0,this.customDistanceMaterial=void 0,this.userData={}}onBeforeShadow(){}onAfterShadow(){}onBeforeRender(){}onAfterRender(){}applyMatrix4(e){this.matrixAutoUpdate&&this.updateMatrix(),this.matrix.premultiply(e),this.matrix.decompose(this.position,this.quaternion,this.scale)}applyQuaternion(e){return this.quaternion.premultiply(e),this}setRotationFromAxisAngle(e,n){this.quaternion.setFromAxisAngle(e,n)}setRotationFromEuler(e){this.quaternion.setFromEuler(e,!0)}setRotationFromMatrix(e){this.quaternion.setFromRotationMatrix(e)}setRotationFromQuaternion(e){this.quaternion.copy(e)}rotateOnAxis(e,n){return dp.setFromAxisAngle(e,n),this.quaternion.multiply(dp),this}rotateOnWorldAxis(e,n){return dp.setFromAxisAngle(e,n),this.quaternion.premultiply(dp),this}rotateX(e){return this.rotateOnAxis(yV,e)}rotateY(e){return this.rotateOnAxis(vV,e)}rotateZ(e){return this.rotateOnAxis(xV,e)}translateOnAxis(e,n){return gV.copy(e).applyQuaternion(this.quaternion),this.position.add(gV.multiplyScalar(n)),this}translateX(e){return this.translateOnAxis(yV,e)}translateY(e){return this.translateOnAxis(vV,e)}translateZ(e){return this.translateOnAxis(xV,e)}localToWorld(e){return this.updateWorldMatrix(!0,!1),e.applyMatrix4(this.matrixWorld)}worldToLocal(e){return this.updateWorldMatrix(!0,!1),e.applyMatrix4(uc.copy(this.matrixWorld).invert())}lookAt(e,n,i){e.isVector3?Qw.copy(e):Qw.set(e,n,i);const s=this.parent;this.updateWorldMatrix(!0,!1),uv.setFromMatrixPosition(this.matrixWorld),this.isCamera||this.isLight?uc.lookAt(uv,Qw,this.up):uc.lookAt(Qw,uv,this.up),this.quaternion.setFromRotationMatrix(uc),s&&(uc.extractRotation(s.matrixWorld),dp.setFromRotationMatrix(uc),this.quaternion.premultiply(dp.invert()))}add(e){if(arguments.length>1){for(let n=0;n<arguments.length;n++)this.add(arguments[n]);return this}return e===this?(console.error("THREE.Object3D.add: object can't be added as a child of itself.",e),this):(e&&e.isObject3D?(e.removeFromParent(),e.parent=this,this.children.push(e),e.dispatchEvent(bV),pp.child=e,this.dispatchEvent(pp),pp.child=null):console.error("THREE.Object3D.add: object not an instance of THREE.Object3D.",e),this)}remove(e){if(arguments.length>1){for(let i=0;i<arguments.length;i++)this.remove(arguments[i]);return this}const n=this.children.indexOf(e);return n!==-1&&(e.parent=null,this.children.splice(n,1),e.dispatchEvent(Dve),nR.child=e,this.dispatchEvent(nR),nR.child=null),this}removeFromParent(){const e=this.parent;return e!==null&&e.remove(this),this}clear(){return this.remove(...this.children)}attach(e){return this.updateWorldMatrix(!0,!1),uc.copy(this.matrixWorld).invert(),e.parent!==null&&(e.parent.updateWorldMatrix(!0,!1),uc.multiply(e.parent.matrixWorld)),e.applyMatrix4(uc),e.removeFromParent(),e.parent=this,this.children.push(e),e.updateWorldMatrix(!1,!0),e.dispatchEvent(bV),pp.child=e,this.dispatchEvent(pp),pp.child=null,this}getObjectById(e){return this.getObjectByProperty("id",e)}getObjectByName(e){return this.getObjectByProperty("name",e)}getObjectByProperty(e,n){if(this[e]===n)return this;for(let i=0,s=this.children.length;i<s;i++){const a=this.children[i].getObjectByProperty(e,n);if(a!==void 0)return a}}getObjectsByProperty(e,n,i=[]){this[e]===n&&i.push(this);const s=this.children;for(let o=0,a=s.length;o<a;o++)s[o].getObjectsByProperty(e,n,i);return i}getWorldPosition(e){return this.updateWorldMatrix(!0,!1),e.setFromMatrixPosition(this.matrixWorld)}getWorldQuaternion(e){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(uv,e,Nve),e}getWorldScale(e){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(uv,Ove,e),e}getWorldDirection(e){this.updateWorldMatrix(!0,!1);const n=this.matrixWorld.elements;return e.set(n[8],n[9],n[10]).normalize()}raycast(){}traverse(e){e(this);const n=this.children;for(let i=0,s=n.length;i<s;i++)n[i].traverse(e)}traverseVisible(e){if(this.visible===!1)return;e(this);const n=this.children;for(let i=0,s=n.length;i<s;i++)n[i].traverseVisible(e)}traverseAncestors(e){const n=this.parent;n!==null&&(e(n),n.traverseAncestors(e))}updateMatrix(){this.matrix.compose(this.position,this.quaternion,this.scale),this.matrixWorldNeedsUpdate=!0}updateMatrixWorld(e){this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||e)&&(this.matrixWorldAutoUpdate===!0&&(this.parent===null?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix)),this.matrixWorldNeedsUpdate=!1,e=!0);const n=this.children;for(let i=0,s=n.length;i<s;i++)n[i].updateMatrixWorld(e)}updateWorldMatrix(e,n){const i=this.parent;if(e===!0&&i!==null&&i.updateWorldMatrix(!0,!1),this.matrixAutoUpdate&&this.updateMatrix(),this.matrixWorldAutoUpdate===!0&&(this.parent===null?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix)),n===!0){const s=this.children;for(let o=0,a=s.length;o<a;o++)s[o].updateWorldMatrix(!1,!0)}}toJSON(e){const n=e===void 0||typeof e=="string",i={};n&&(e={geometries:{},materials:{},textures:{},images:{},shapes:{},skeletons:{},animations:{},nodes:{}},i.metadata={version:4.6,type:"Object",generator:"Object3D.toJSON"});const s={};s.uuid=this.uuid,s.type=this.type,this.name!==""&&(s.name=this.name),this.castShadow===!0&&(s.castShadow=!0),this.receiveShadow===!0&&(s.receiveShadow=!0),this.visible===!1&&(s.visible=!1),this.frustumCulled===!1&&(s.frustumCulled=!1),this.renderOrder!==0&&(s.renderOrder=this.renderOrder),Object.keys(this.userData).length>0&&(s.userData=this.userData),s.layers=this.layers.mask,s.matrix=this.matrix.toArray(),s.up=this.up.toArray(),this.matrixAutoUpdate===!1&&(s.matrixAutoUpdate=!1),this.isInstancedMesh&&(s.type="InstancedMesh",s.count=this.count,s.instanceMatrix=this.instanceMatrix.toJSON(),this.instanceColor!==null&&(s.instanceColor=this.instanceColor.toJSON())),this.isBatchedMesh&&(s.type="BatchedMesh",s.perObjectFrustumCulled=this.perObjectFrustumCulled,s.sortObjects=this.sortObjects,s.drawRanges=this._drawRanges,s.reservedRanges=this._reservedRanges,s.geometryInfo=this._geometryInfo.map(l=>({...l,boundingBox:l.boundingBox?{min:l.boundingBox.min.toArray(),max:l.boundingBox.max.toArray()}:void 0,boundingSphere:l.boundingSphere?{radius:l.boundingSphere.radius,center:l.boundingSphere.center.toArray()}:void 0})),s.instanceInfo=this._instanceInfo.map(l=>({...l})),s.availableInstanceIds=this._availableInstanceIds.slice(),s.availableGeometryIds=this._availableGeometryIds.slice(),s.nextIndexStart=this._nextIndexStart,s.nextVertexStart=this._nextVertexStart,s.geometryCount=this._geometryCount,s.maxInstanceCount=this._maxInstanceCount,s.maxVertexCount=this._maxVertexCount,s.maxIndexCount=this._maxIndexCount,s.geometryInitialized=this._geometryInitialized,s.matricesTexture=this._matricesTexture.toJSON(e),s.indirectTexture=this._indirectTexture.toJSON(e),this._colorsTexture!==null&&(s.colorsTexture=this._colorsTexture.toJSON(e)),this.boundingSphere!==null&&(s.boundingSphere={center:this.boundingSphere.center.toArray(),radius:this.boundingSphere.radius}),this.boundingBox!==null&&(s.boundingBox={min:this.boundingBox.min.toArray(),max:this.boundingBox.max.toArray()}));function o(l,c){return l[c.uuid]===void 0&&(l[c.uuid]=c.toJSON(e)),c.uuid}if(this.isScene)this.background&&(this.background.isColor?s.background=this.background.toJSON():this.background.isTexture&&(s.background=this.background.toJSON(e).uuid)),this.environment&&this.environment.isTexture&&this.environment.isRenderTargetTexture!==!0&&(s.environment=this.environment.toJSON(e).uuid);else if(this.isMesh||this.isLine||this.isPoints){s.geometry=o(e.geometries,this.geometry);const l=this.geometry.parameters;if(l!==void 0&&l.shapes!==void 0){const c=l.shapes;if(Array.isArray(c))for(let u=0,h=c.length;u<h;u++){const f=c[u];o(e.shapes,f)}else o(e.shapes,c)}}if(this.isSkinnedMesh&&(s.bindMode=this.bindMode,s.bindMatrix=this.bindMatrix.toArray(),this.skeleton!==void 0&&(o(e.skeletons,this.skeleton),s.skeleton=this.skeleton.uuid)),this.material!==void 0)if(Array.isArray(this.material)){const l=[];for(let c=0,u=this.material.length;c<u;c++)l.push(o(e.materials,this.material[c]));s.material=l}else s.material=o(e.materials,this.material);if(this.children.length>0){s.children=[];for(let l=0;l<this.children.length;l++)s.children.push(this.children[l].toJSON(e).object)}if(this.animations.length>0){s.animations=[];for(let l=0;l<this.animations.length;l++){const c=this.animations[l];s.animations.push(o(e.animations,c))}}if(n){const l=a(e.geometries),c=a(e.materials),u=a(e.textures),h=a(e.images),f=a(e.shapes),d=a(e.skeletons),p=a(e.animations),m=a(e.nodes);l.length>0&&(i.geometries=l),c.length>0&&(i.materials=c),u.length>0&&(i.textures=u),h.length>0&&(i.images=h),f.length>0&&(i.shapes=f),d.length>0&&(i.skeletons=d),p.length>0&&(i.animations=p),m.length>0&&(i.nodes=m)}return i.object=s,i;function a(l){const c=[];for(const u in l){const h=l[u];delete h.metadata,c.push(h)}return c}}clone(e){return new this.constructor().copy(this,e)}copy(e,n=!0){if(this.name=e.name,this.up.copy(e.up),this.position.copy(e.position),this.rotation.order=e.rotation.order,this.quaternion.copy(e.quaternion),this.scale.copy(e.scale),this.matrix.copy(e.matrix),this.matrixWorld.copy(e.matrixWorld),this.matrixAutoUpdate=e.matrixAutoUpdate,this.matrixWorldAutoUpdate=e.matrixWorldAutoUpdate,this.matrixWorldNeedsUpdate=e.matrixWorldNeedsUpdate,this.layers.mask=e.layers.mask,this.visible=e.visible,this.castShadow=e.castShadow,this.receiveShadow=e.receiveShadow,this.frustumCulled=e.frustumCulled,this.renderOrder=e.renderOrder,this.animations=e.animations.slice(),this.userData=JSON.parse(JSON.stringify(e.userData)),n===!0)for(let i=0;i<e.children.length;i++){const s=e.children[i];this.add(s.clone())}return this}}Mr.DEFAULT_UP=new K(0,1,0);Mr.DEFAULT_MATRIX_AUTO_UPDATE=!0;Mr.DEFAULT_MATRIX_WORLD_AUTO_UPDATE=!0;const Ma=new K,hc=new K,rR=new K,fc=new K,mp=new K,gp=new K,_V=new K,iR=new K,sR=new K,oR=new K,aR=new Nt,lR=new Nt,cR=new Nt;class ta{constructor(e=new K,n=new K,i=new K){this.a=e,this.b=n,this.c=i}static getNormal(e,n,i,s){s.subVectors(i,n),Ma.subVectors(e,n),s.cross(Ma);const o=s.lengthSq();return o>0?s.multiplyScalar(1/Math.sqrt(o)):s.set(0,0,0)}static getBarycoord(e,n,i,s,o){Ma.subVectors(s,n),hc.subVectors(i,n),rR.subVectors(e,n);const a=Ma.dot(Ma),l=Ma.dot(hc),c=Ma.dot(rR),u=hc.dot(hc),h=hc.dot(rR),f=a*u-l*l;if(f===0)return o.set(0,0,0),null;const d=1/f,p=(u*c-l*h)*d,m=(a*h-l*c)*d;return o.set(1-p-m,m,p)}static containsPoint(e,n,i,s){return this.getBarycoord(e,n,i,s,fc)===null?!1:fc.x>=0&&fc.y>=0&&fc.x+fc.y<=1}static getInterpolation(e,n,i,s,o,a,l,c){return this.getBarycoord(e,n,i,s,fc)===null?(c.x=0,c.y=0,"z"in c&&(c.z=0),"w"in c&&(c.w=0),null):(c.setScalar(0),c.addScaledVector(o,fc.x),c.addScaledVector(a,fc.y),c.addScaledVector(l,fc.z),c)}static getInterpolatedAttribute(e,n,i,s,o,a){return aR.setScalar(0),lR.setScalar(0),cR.setScalar(0),aR.fromBufferAttribute(e,n),lR.fromBufferAttribute(e,i),cR.fromBufferAttribute(e,s),a.setScalar(0),a.addScaledVector(aR,o.x),a.addScaledVector(lR,o.y),a.addScaledVector(cR,o.z),a}static isFrontFacing(e,n,i,s){return Ma.subVectors(i,n),hc.subVectors(e,n),Ma.cross(hc).dot(s)<0}set(e,n,i){return this.a.copy(e),this.b.copy(n),this.c.copy(i),this}setFromPointsAndIndices(e,n,i,s){return this.a.copy(e[n]),this.b.copy(e[i]),this.c.copy(e[s]),this}setFromAttributeAndIndices(e,n,i,s){return this.a.fromBufferAttribute(e,n),this.b.fromBufferAttribute(e,i),this.c.fromBufferAttribute(e,s),this}clone(){return new this.constructor().copy(this)}copy(e){return this.a.copy(e.a),this.b.copy(e.b),this.c.copy(e.c),this}getArea(){return Ma.subVectors(this.c,this.b),hc.subVectors(this.a,this.b),Ma.cross(hc).length()*.5}getMidpoint(e){return e.addVectors(this.a,this.b).add(this.c).multiplyScalar(1/3)}getNormal(e){return ta.getNormal(this.a,this.b,this.c,e)}getPlane(e){return e.setFromCoplanarPoints(this.a,this.b,this.c)}getBarycoord(e,n){return ta.getBarycoord(e,this.a,this.b,this.c,n)}getInterpolation(e,n,i,s,o){return ta.getInterpolation(e,this.a,this.b,this.c,n,i,s,o)}containsPoint(e){return ta.containsPoint(e,this.a,this.b,this.c)}isFrontFacing(e){return ta.isFrontFacing(this.a,this.b,this.c,e)}intersectsBox(e){return e.intersectsTriangle(this)}closestPointToPoint(e,n){const i=this.a,s=this.b,o=this.c;let a,l;mp.subVectors(s,i),gp.subVectors(o,i),iR.subVectors(e,i);const c=mp.dot(iR),u=gp.dot(iR);if(c<=0&&u<=0)return n.copy(i);sR.subVectors(e,s);const h=mp.dot(sR),f=gp.dot(sR);if(h>=0&&f<=h)return n.copy(s);const d=c*f-h*u;if(d<=0&&c>=0&&h<=0)return a=c/(c-h),n.copy(i).addScaledVector(mp,a);oR.subVectors(e,o);const p=mp.dot(oR),m=gp.dot(oR);if(m>=0&&p<=m)return n.copy(o);const g=p*u-c*m;if(g<=0&&u>=0&&m<=0)return l=u/(u-m),n.copy(i).addScaledVector(gp,l);const v=h*m-p*f;if(v<=0&&f-h>=0&&p-m>=0)return _V.subVectors(o,s),l=(f-h)/(f-h+(p-m)),n.copy(s).addScaledVector(_V,l);const y=1/(v+g+d);return a=g*y,l=d*y,n.copy(i).addScaledVector(mp,a).addScaledVector(gp,l)}equals(e){return e.a.equals(this.a)&&e.b.equals(this.b)&&e.c.equals(this.c)}}const SY={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074},Bu={h:0,s:0,l:0},Jw={h:0,s:0,l:0};function uR(r,e,n){return n<0&&(n+=1),n>1&&(n-=1),n<1/6?r+(e-r)*6*n:n<1/2?e:n<2/3?r+(e-r)*6*(2/3-n):r}let pt=class{constructor(e,n,i){return this.isColor=!0,this.r=1,this.g=1,this.b=1,this.set(e,n,i)}set(e,n,i){if(n===void 0&&i===void 0){const s=e;s&&s.isColor?this.copy(s):typeof s=="number"?this.setHex(s):typeof s=="string"&&this.setStyle(s)}else this.setRGB(e,n,i);return this}setScalar(e){return this.r=e,this.g=e,this.b=e,this}setHex(e,n=vt){return e=Math.floor(e),this.r=(e>>16&255)/255,this.g=(e>>8&255)/255,this.b=(e&255)/255,Qt.toWorkingColorSpace(this,n),this}setRGB(e,n,i,s=Qt.workingColorSpace){return this.r=e,this.g=n,this.b=i,Qt.toWorkingColorSpace(this,s),this}setHSL(e,n,i,s=Qt.workingColorSpace){if(e=CF(e,1),n=Wt(n,0,1),i=Wt(i,0,1),n===0)this.r=this.g=this.b=i;else{const o=i<=.5?i*(1+n):i+n-i*n,a=2*i-o;this.r=uR(a,o,e+1/3),this.g=uR(a,o,e),this.b=uR(a,o,e-1/3)}return Qt.toWorkingColorSpace(this,s),this}setStyle(e,n=vt){function i(o){o!==void 0&&parseFloat(o)<1&&console.warn("THREE.Color: Alpha component of "+e+" will be ignored.")}let s;if(s=/^(\w+)\(([^\)]*)\)/.exec(e)){let o;const a=s[1],l=s[2];switch(a){case"rgb":case"rgba":if(o=/^\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(l))return i(o[4]),this.setRGB(Math.min(255,parseInt(o[1],10))/255,Math.min(255,parseInt(o[2],10))/255,Math.min(255,parseInt(o[3],10))/255,n);if(o=/^\s*(\d+)\%\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(l))return i(o[4]),this.setRGB(Math.min(100,parseInt(o[1],10))/100,Math.min(100,parseInt(o[2],10))/100,Math.min(100,parseInt(o[3],10))/100,n);break;case"hsl":case"hsla":if(o=/^\s*(\d*\.?\d+)\s*,\s*(\d*\.?\d+)\%\s*,\s*(\d*\.?\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(l))return i(o[4]),this.setHSL(parseFloat(o[1])/360,parseFloat(o[2])/100,parseFloat(o[3])/100,n);break;default:console.warn("THREE.Color: Unknown color model "+e)}}else if(s=/^\#([A-Fa-f\d]+)$/.exec(e)){const o=s[1],a=o.length;if(a===3)return this.setRGB(parseInt(o.charAt(0),16)/15,parseInt(o.charAt(1),16)/15,parseInt(o.charAt(2),16)/15,n);if(a===6)return this.setHex(parseInt(o,16),n);console.warn("THREE.Color: Invalid hex color "+e)}else if(e&&e.length>0)return this.setColorName(e,n);return this}setColorName(e,n=vt){const i=SY[e.toLowerCase()];return i!==void 0?this.setHex(i,n):console.warn("THREE.Color: Unknown color "+e),this}clone(){return new this.constructor(this.r,this.g,this.b)}copy(e){return this.r=e.r,this.g=e.g,this.b=e.b,this}copySRGBToLinear(e){return this.r=Wc(e.r),this.g=Wc(e.g),this.b=Wc(e.b),this}copyLinearToSRGB(e){return this.r=Nm(e.r),this.g=Nm(e.g),this.b=Nm(e.b),this}convertSRGBToLinear(){return this.copySRGBToLinear(this),this}convertLinearToSRGB(){return this.copyLinearToSRGB(this),this}getHex(e=vt){return Qt.fromWorkingColorSpace(Yi.copy(this),e),Math.round(Wt(Yi.r*255,0,255))*65536+Math.round(Wt(Yi.g*255,0,255))*256+Math.round(Wt(Yi.b*255,0,255))}getHexString(e=vt){return("000000"+this.getHex(e).toString(16)).slice(-6)}getHSL(e,n=Qt.workingColorSpace){Qt.fromWorkingColorSpace(Yi.copy(this),n);const i=Yi.r,s=Yi.g,o=Yi.b,a=Math.max(i,s,o),l=Math.min(i,s,o);let c,u;const h=(l+a)/2;if(l===a)c=0,u=0;else{const f=a-l;switch(u=h<=.5?f/(a+l):f/(2-a-l),a){case i:c=(s-o)/f+(s<o?6:0);break;case s:c=(o-i)/f+2;break;case o:c=(i-s)/f+4;break}c/=6}return e.h=c,e.s=u,e.l=h,e}getRGB(e,n=Qt.workingColorSpace){return Qt.fromWorkingColorSpace(Yi.copy(this),n),e.r=Yi.r,e.g=Yi.g,e.b=Yi.b,e}getStyle(e=vt){Qt.fromWorkingColorSpace(Yi.copy(this),e);const n=Yi.r,i=Yi.g,s=Yi.b;return e!==vt?`color(${e} ${n.toFixed(3)} ${i.toFixed(3)} ${s.toFixed(3)})`:`rgb(${Math.round(n*255)},${Math.round(i*255)},${Math.round(s*255)})`}offsetHSL(e,n,i){return this.getHSL(Bu),this.setHSL(Bu.h+e,Bu.s+n,Bu.l+i)}add(e){return this.r+=e.r,this.g+=e.g,this.b+=e.b,this}addColors(e,n){return this.r=e.r+n.r,this.g=e.g+n.g,this.b=e.b+n.b,this}addScalar(e){return this.r+=e,this.g+=e,this.b+=e,this}sub(e){return this.r=Math.max(0,this.r-e.r),this.g=Math.max(0,this.g-e.g),this.b=Math.max(0,this.b-e.b),this}multiply(e){return this.r*=e.r,this.g*=e.g,this.b*=e.b,this}multiplyScalar(e){return this.r*=e,this.g*=e,this.b*=e,this}lerp(e,n){return this.r+=(e.r-this.r)*n,this.g+=(e.g-this.g)*n,this.b+=(e.b-this.b)*n,this}lerpColors(e,n,i){return this.r=e.r+(n.r-e.r)*i,this.g=e.g+(n.g-e.g)*i,this.b=e.b+(n.b-e.b)*i,this}lerpHSL(e,n){this.getHSL(Bu),e.getHSL(Jw);const i=L0(Bu.h,Jw.h,n),s=L0(Bu.s,Jw.s,n),o=L0(Bu.l,Jw.l,n);return this.setHSL(i,s,o),this}setFromVector3(e){return this.r=e.x,this.g=e.y,this.b=e.z,this}applyMatrix3(e){const n=this.r,i=this.g,s=this.b,o=e.elements;return this.r=o[0]*n+o[3]*i+o[6]*s,this.g=o[1]*n+o[4]*i+o[7]*s,this.b=o[2]*n+o[5]*i+o[8]*s,this}equals(e){return e.r===this.r&&e.g===this.g&&e.b===this.b}fromArray(e,n=0){return this.r=e[n],this.g=e[n+1],this.b=e[n+2],this}toArray(e=[],n=0){return e[n]=this.r,e[n+1]=this.g,e[n+2]=this.b,e}fromBufferAttribute(e,n){return this.r=e.getX(n),this.g=e.getY(n),this.b=e.getZ(n),this}toJSON(){return this.getHex()}*[Symbol.iterator](){yield this.r,yield this.g,yield this.b}};const Yi=new pt;pt.NAMES=SY;let kve=0;class cs extends gu{constructor(){super(),this.isMaterial=!0,Object.defineProperty(this,"id",{value:kve++}),this.uuid=Hc(),this.name="",this.type="Material",this.blending=Ro,this.side=no,this.vertexColors=!1,this.opacity=1,this.transparent=!1,this.alphaHash=!1,this.blendSrc=Nx,this.blendDst=Ox,this.blendEquation=ss,this.blendSrcAlpha=null,this.blendDstAlpha=null,this.blendEquationAlpha=null,this.blendColor=new pt(0,0,0),this.blendAlpha=0,this.depthFunc=Ch,this.depthTest=!0,this.depthWrite=!0,this.stencilWriteMask=255,this.stencilFunc=HO,this.stencilRef=0,this.stencilFuncMask=255,this.stencilFail=Tf,this.stencilZFail=Tf,this.stencilZPass=Tf,this.stencilWrite=!1,this.clippingPlanes=null,this.clipIntersection=!1,this.clipShadows=!1,this.shadowSide=null,this.colorWrite=!0,this.precision=null,this.polygonOffset=!1,this.polygonOffsetFactor=0,this.polygonOffsetUnits=0,this.dithering=!1,this.alphaToCoverage=!1,this.premultipliedAlpha=!1,this.forceSinglePass=!1,this.allowOverride=!0,this.visible=!0,this.toneMapped=!0,this.userData={},this.version=0,this._alphaTest=0}get alphaTest(){return this._alphaTest}set alphaTest(e){this._alphaTest>0!=e>0&&this.version++,this._alphaTest=e}onBeforeRender(){}onBeforeCompile(){}customProgramCacheKey(){return this.onBeforeCompile.toString()}setValues(e){if(e!==void 0)for(const n in e){const i=e[n];if(i===void 0){console.warn(`THREE.Material: parameter '${n}' has value of undefined.`);continue}const s=this[n];if(s===void 0){console.warn(`THREE.Material: '${n}' is not a property of THREE.${this.type}.`);continue}s&&s.isColor?s.set(i):s&&s.isVector3&&i&&i.isVector3?s.copy(i):this[n]=i}}toJSON(e){const n=e===void 0||typeof e=="string";n&&(e={textures:{},images:{}});const i={metadata:{version:4.6,type:"Material",generator:"Material.toJSON"}};i.uuid=this.uuid,i.type=this.type,this.name!==""&&(i.name=this.name),this.color&&this.color.isColor&&(i.color=this.color.getHex()),this.roughness!==void 0&&(i.roughness=this.roughness),this.metalness!==void 0&&(i.metalness=this.metalness),this.sheen!==void 0&&(i.sheen=this.sheen),this.sheenColor&&this.sheenColor.isColor&&(i.sheenColor=this.sheenColor.getHex()),this.sheenRoughness!==void 0&&(i.sheenRoughness=this.sheenRoughness),this.emissive&&this.emissive.isColor&&(i.emissive=this.emissive.getHex()),this.emissiveIntensity!==void 0&&this.emissiveIntensity!==1&&(i.emissiveIntensity=this.emissiveIntensity),this.specular&&this.specular.isColor&&(i.specular=this.specular.getHex()),this.specularIntensity!==void 0&&(i.specularIntensity=this.specularIntensity),this.specularColor&&this.specularColor.isColor&&(i.specularColor=this.specularColor.getHex()),this.shininess!==void 0&&(i.shininess=this.shininess),this.clearcoat!==void 0&&(i.clearcoat=this.clearcoat),this.clearcoatRoughness!==void 0&&(i.clearcoatRoughness=this.clearcoatRoughness),this.clearcoatMap&&this.clearcoatMap.isTexture&&(i.clearcoatMap=this.clearcoatMap.toJSON(e).uuid),this.clearcoatRoughnessMap&&this.clearcoatRoughnessMap.isTexture&&(i.clearcoatRoughnessMap=this.clearcoatRoughnessMap.toJSON(e).uuid),this.clearcoatNormalMap&&this.clearcoatNormalMap.isTexture&&(i.clearcoatNormalMap=this.clearcoatNormalMap.toJSON(e).uuid,i.clearcoatNormalScale=this.clearcoatNormalScale.toArray()),this.dispersion!==void 0&&(i.dispersion=this.dispersion),this.iridescence!==void 0&&(i.iridescence=this.iridescence),this.iridescenceIOR!==void 0&&(i.iridescenceIOR=this.iridescenceIOR),this.iridescenceThicknessRange!==void 0&&(i.iridescenceThicknessRange=this.iridescenceThicknessRange),this.iridescenceMap&&this.iridescenceMap.isTexture&&(i.iridescenceMap=this.iridescenceMap.toJSON(e).uuid),this.iridescenceThicknessMap&&this.iridescenceThicknessMap.isTexture&&(i.iridescenceThicknessMap=this.iridescenceThicknessMap.toJSON(e).uuid),this.anisotropy!==void 0&&(i.anisotropy=this.anisotropy),this.anisotropyRotation!==void 0&&(i.anisotropyRotation=this.anisotropyRotation),this.anisotropyMap&&this.anisotropyMap.isTexture&&(i.anisotropyMap=this.anisotropyMap.toJSON(e).uuid),this.map&&this.map.isTexture&&(i.map=this.map.toJSON(e).uuid),this.matcap&&this.matcap.isTexture&&(i.matcap=this.matcap.toJSON(e).uuid),this.alphaMap&&this.alphaMap.isTexture&&(i.alphaMap=this.alphaMap.toJSON(e).uuid),this.lightMap&&this.lightMap.isTexture&&(i.lightMap=this.lightMap.toJSON(e).uuid,i.lightMapIntensity=this.lightMapIntensity),this.aoMap&&this.aoMap.isTexture&&(i.aoMap=this.aoMap.toJSON(e).uuid,i.aoMapIntensity=this.aoMapIntensity),this.bumpMap&&this.bumpMap.isTexture&&(i.bumpMap=this.bumpMap.toJSON(e).uuid,i.bumpScale=this.bumpScale),this.normalMap&&this.normalMap.isTexture&&(i.normalMap=this.normalMap.toJSON(e).uuid,i.normalMapType=this.normalMapType,i.normalScale=this.normalScale.toArray()),this.displacementMap&&this.displacementMap.isTexture&&(i.displacementMap=this.displacementMap.toJSON(e).uuid,i.displacementScale=this.displacementScale,i.displacementBias=this.displacementBias),this.roughnessMap&&this.roughnessMap.isTexture&&(i.roughnessMap=this.roughnessMap.toJSON(e).uuid),this.metalnessMap&&this.metalnessMap.isTexture&&(i.metalnessMap=this.metalnessMap.toJSON(e).uuid),this.emissiveMap&&this.emissiveMap.isTexture&&(i.emissiveMap=this.emissiveMap.toJSON(e).uuid),this.specularMap&&this.specularMap.isTexture&&(i.specularMap=this.specularMap.toJSON(e).uuid),this.specularIntensityMap&&this.specularIntensityMap.isTexture&&(i.specularIntensityMap=this.specularIntensityMap.toJSON(e).uuid),this.specularColorMap&&this.specularColorMap.isTexture&&(i.specularColorMap=this.specularColorMap.toJSON(e).uuid),this.envMap&&this.envMap.isTexture&&(i.envMap=this.envMap.toJSON(e).uuid,this.combine!==void 0&&(i.combine=this.combine)),this.envMapRotation!==void 0&&(i.envMapRotation=this.envMapRotation.toArray()),this.envMapIntensity!==void 0&&(i.envMapIntensity=this.envMapIntensity),this.reflectivity!==void 0&&(i.reflectivity=this.reflectivity),this.refractionRatio!==void 0&&(i.refractionRatio=this.refractionRatio),this.gradientMap&&this.gradientMap.isTexture&&(i.gradientMap=this.gradientMap.toJSON(e).uuid),this.transmission!==void 0&&(i.transmission=this.transmission),this.transmissionMap&&this.transmissionMap.isTexture&&(i.transmissionMap=this.transmissionMap.toJSON(e).uuid),this.thickness!==void 0&&(i.thickness=this.thickness),this.thicknessMap&&this.thicknessMap.isTexture&&(i.thicknessMap=this.thicknessMap.toJSON(e).uuid),this.attenuationDistance!==void 0&&this.attenuationDistance!==1/0&&(i.attenuationDistance=this.attenuationDistance),this.attenuationColor!==void 0&&(i.attenuationColor=this.attenuationColor.getHex()),this.size!==void 0&&(i.size=this.size),this.shadowSide!==null&&(i.shadowSide=this.shadowSide),this.sizeAttenuation!==void 0&&(i.sizeAttenuation=this.sizeAttenuation),this.blending!==Ro&&(i.blending=this.blending),this.side!==no&&(i.side=this.side),this.vertexColors===!0&&(i.vertexColors=!0),this.opacity<1&&(i.opacity=this.opacity),this.transparent===!0&&(i.transparent=!0),this.blendSrc!==Nx&&(i.blendSrc=this.blendSrc),this.blendDst!==Ox&&(i.blendDst=this.blendDst),this.blendEquation!==ss&&(i.blendEquation=this.blendEquation),this.blendSrcAlpha!==null&&(i.blendSrcAlpha=this.blendSrcAlpha),this.blendDstAlpha!==null&&(i.blendDstAlpha=this.blendDstAlpha),this.blendEquationAlpha!==null&&(i.blendEquationAlpha=this.blendEquationAlpha),this.blendColor&&this.blendColor.isColor&&(i.blendColor=this.blendColor.getHex()),this.blendAlpha!==0&&(i.blendAlpha=this.blendAlpha),this.depthFunc!==Ch&&(i.depthFunc=this.depthFunc),this.depthTest===!1&&(i.depthTest=this.depthTest),this.depthWrite===!1&&(i.depthWrite=this.depthWrite),this.colorWrite===!1&&(i.colorWrite=this.colorWrite),this.stencilWriteMask!==255&&(i.stencilWriteMask=this.stencilWriteMask),this.stencilFunc!==HO&&(i.stencilFunc=this.stencilFunc),this.stencilRef!==0&&(i.stencilRef=this.stencilRef),this.stencilFuncMask!==255&&(i.stencilFuncMask=this.stencilFuncMask),this.stencilFail!==Tf&&(i.stencilFail=this.stencilFail),this.stencilZFail!==Tf&&(i.stencilZFail=this.stencilZFail),this.stencilZPass!==Tf&&(i.stencilZPass=this.stencilZPass),this.stencilWrite===!0&&(i.stencilWrite=this.stencilWrite),this.rotation!==void 0&&this.rotation!==0&&(i.rotation=this.rotation),this.polygonOffset===!0&&(i.polygonOffset=!0),this.polygonOffsetFactor!==0&&(i.polygonOffsetFactor=this.polygonOffsetFactor),this.polygonOffsetUnits!==0&&(i.polygonOffsetUnits=this.polygonOffsetUnits),this.linewidth!==void 0&&this.linewidth!==1&&(i.linewidth=this.linewidth),this.dashSize!==void 0&&(i.dashSize=this.dashSize),this.gapSize!==void 0&&(i.gapSize=this.gapSize),this.scale!==void 0&&(i.scale=this.scale),this.dithering===!0&&(i.dithering=!0),this.alphaTest>0&&(i.alphaTest=this.alphaTest),this.alphaHash===!0&&(i.alphaHash=!0),this.alphaToCoverage===!0&&(i.alphaToCoverage=!0),this.premultipliedAlpha===!0&&(i.premultipliedAlpha=!0),this.forceSinglePass===!0&&(i.forceSinglePass=!0),this.wireframe===!0&&(i.wireframe=!0),this.wireframeLinewidth>1&&(i.wireframeLinewidth=this.wireframeLinewidth),this.wireframeLinecap!=="round"&&(i.wireframeLinecap=this.wireframeLinecap),this.wireframeLinejoin!=="round"&&(i.wireframeLinejoin=this.wireframeLinejoin),this.flatShading===!0&&(i.flatShading=!0),this.visible===!1&&(i.visible=!1),this.toneMapped===!1&&(i.toneMapped=!1),this.fog===!1&&(i.fog=!1),Object.keys(this.userData).length>0&&(i.userData=this.userData);function s(o){const a=[];for(const l in o){const c=o[l];delete c.metadata,a.push(c)}return a}if(n){const o=s(e.textures),a=s(e.images);o.length>0&&(i.textures=o),a.length>0&&(i.images=a)}return i}clone(){return new this.constructor().copy(this)}copy(e){this.name=e.name,this.blending=e.blending,this.side=e.side,this.vertexColors=e.vertexColors,this.opacity=e.opacity,this.transparent=e.transparent,this.blendSrc=e.blendSrc,this.blendDst=e.blendDst,this.blendEquation=e.blendEquation,this.blendSrcAlpha=e.blendSrcAlpha,this.blendDstAlpha=e.blendDstAlpha,this.blendEquationAlpha=e.blendEquationAlpha,this.blendColor.copy(e.blendColor),this.blendAlpha=e.blendAlpha,this.depthFunc=e.depthFunc,this.depthTest=e.depthTest,this.depthWrite=e.depthWrite,this.stencilWriteMask=e.stencilWriteMask,this.stencilFunc=e.stencilFunc,this.stencilRef=e.stencilRef,this.stencilFuncMask=e.stencilFuncMask,this.stencilFail=e.stencilFail,this.stencilZFail=e.stencilZFail,this.stencilZPass=e.stencilZPass,this.stencilWrite=e.stencilWrite;const n=e.clippingPlanes;let i=null;if(n!==null){const s=n.length;i=new Array(s);for(let o=0;o!==s;++o)i[o]=n[o].clone()}return this.clippingPlanes=i,this.clipIntersection=e.clipIntersection,this.clipShadows=e.clipShadows,this.shadowSide=e.shadowSide,this.colorWrite=e.colorWrite,this.precision=e.precision,this.polygonOffset=e.polygonOffset,this.polygonOffsetFactor=e.polygonOffsetFactor,this.polygonOffsetUnits=e.polygonOffsetUnits,this.dithering=e.dithering,this.alphaTest=e.alphaTest,this.alphaHash=e.alphaHash,this.alphaToCoverage=e.alphaToCoverage,this.premultipliedAlpha=e.premultipliedAlpha,this.forceSinglePass=e.forceSinglePass,this.visible=e.visible,this.toneMapped=e.toneMapped,this.userData=JSON.parse(JSON.stringify(e.userData)),this}dispose(){this.dispatchEvent({type:"dispose"})}set needsUpdate(e){e===!0&&this.version++}}class As extends cs{constructor(e){super(),this.isMeshBasicMaterial=!0,this.type="MeshBasicMaterial",this.color=new pt(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.envMapRotation=new so,this.combine=c_,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.envMapRotation.copy(e.envMapRotation),this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.fog=e.fog,this}}const Ec=Ive();function Ive(){const r=new ArrayBuffer(4),e=new Float32Array(r),n=new Uint32Array(r),i=new Uint32Array(512),s=new Uint32Array(512);for(let c=0;c<256;++c){const u=c-127;u<-27?(i[c]=0,i[c|256]=32768,s[c]=24,s[c|256]=24):u<-14?(i[c]=1024>>-u-14,i[c|256]=1024>>-u-14|32768,s[c]=-u-1,s[c|256]=-u-1):u<=15?(i[c]=u+15<<10,i[c|256]=u+15<<10|32768,s[c]=13,s[c|256]=13):u<128?(i[c]=31744,i[c|256]=64512,s[c]=24,s[c|256]=24):(i[c]=31744,i[c|256]=64512,s[c]=13,s[c|256]=13)}const o=new Uint32Array(2048),a=new Uint32Array(64),l=new Uint32Array(64);for(let c=1;c<1024;++c){let u=c<<13,h=0;for(;!(u&8388608);)u<<=1,h-=8388608;u&=-8388609,h+=947912704,o[c]=u|h}for(let c=1024;c<2048;++c)o[c]=939524096+(c-1024<<13);for(let c=1;c<31;++c)a[c]=c<<23;a[31]=1199570944,a[32]=2147483648;for(let c=33;c<63;++c)a[c]=2147483648+(c-32<<23);a[63]=3347054592;for(let c=1;c<64;++c)c!==32&&(l[c]=1024);return{floatView:e,uint32View:n,baseTable:i,shiftTable:s,mantissaTable:o,exponentTable:a,offsetTable:l}}function po(r){Math.abs(r)>65504&&console.warn("THREE.DataUtils.toHalfFloat(): Value out of range."),r=Wt(r,-65504,65504),Ec.floatView[0]=r;const e=Ec.uint32View[0],n=e>>23&511;return Ec.baseTable[n]+((e&8388607)>>Ec.shiftTable[n])}function eS(r){const e=r>>10;return Ec.uint32View[0]=Ec.mantissaTable[Ec.offsetTable[e]+(r&1023)]+Ec.exponentTable[e],Ec.floatView[0]}const Br=new K,tS=new Fe;let Lve=0;class hi{constructor(e,n,i=!1){if(Array.isArray(e))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");this.isBufferAttribute=!0,Object.defineProperty(this,"id",{value:Lve++}),this.name="",this.array=e,this.itemSize=n,this.count=e!==void 0?e.length/n:0,this.normalized=i,this.usage=zT,this.updateRanges=[],this.gpuType=Nr,this.version=0}onUploadCallback(){}set needsUpdate(e){e===!0&&this.version++}setUsage(e){return this.usage=e,this}addUpdateRange(e,n){this.updateRanges.push({start:e,count:n})}clearUpdateRanges(){this.updateRanges.length=0}copy(e){return this.name=e.name,this.array=new e.array.constructor(e.array),this.itemSize=e.itemSize,this.count=e.count,this.normalized=e.normalized,this.usage=e.usage,this.gpuType=e.gpuType,this}copyAt(e,n,i){e*=this.itemSize,i*=n.itemSize;for(let s=0,o=this.itemSize;s<o;s++)this.array[e+s]=n.array[i+s];return this}copyArray(e){return this.array.set(e),this}applyMatrix3(e){if(this.itemSize===2)for(let n=0,i=this.count;n<i;n++)tS.fromBufferAttribute(this,n),tS.applyMatrix3(e),this.setXY(n,tS.x,tS.y);else if(this.itemSize===3)for(let n=0,i=this.count;n<i;n++)Br.fromBufferAttribute(this,n),Br.applyMatrix3(e),this.setXYZ(n,Br.x,Br.y,Br.z);return this}applyMatrix4(e){for(let n=0,i=this.count;n<i;n++)Br.fromBufferAttribute(this,n),Br.applyMatrix4(e),this.setXYZ(n,Br.x,Br.y,Br.z);return this}applyNormalMatrix(e){for(let n=0,i=this.count;n<i;n++)Br.fromBufferAttribute(this,n),Br.applyNormalMatrix(e),this.setXYZ(n,Br.x,Br.y,Br.z);return this}transformDirection(e){for(let n=0,i=this.count;n<i;n++)Br.fromBufferAttribute(this,n),Br.transformDirection(e),this.setXYZ(n,Br.x,Br.y,Br.z);return this}set(e,n=0){return this.array.set(e,n),this}getComponent(e,n){let i=this.array[e*this.itemSize+n];return this.normalized&&(i=Ms(i,this.array)),i}setComponent(e,n,i){return this.normalized&&(i=Ht(i,this.array)),this.array[e*this.itemSize+n]=i,this}getX(e){let n=this.array[e*this.itemSize];return this.normalized&&(n=Ms(n,this.array)),n}setX(e,n){return this.normalized&&(n=Ht(n,this.array)),this.array[e*this.itemSize]=n,this}getY(e){let n=this.array[e*this.itemSize+1];return this.normalized&&(n=Ms(n,this.array)),n}setY(e,n){return this.normalized&&(n=Ht(n,this.array)),this.array[e*this.itemSize+1]=n,this}getZ(e){let n=this.array[e*this.itemSize+2];return this.normalized&&(n=Ms(n,this.array)),n}setZ(e,n){return this.normalized&&(n=Ht(n,this.array)),this.array[e*this.itemSize+2]=n,this}getW(e){let n=this.array[e*this.itemSize+3];return this.normalized&&(n=Ms(n,this.array)),n}setW(e,n){return this.normalized&&(n=Ht(n,this.array)),this.array[e*this.itemSize+3]=n,this}setXY(e,n,i){return e*=this.itemSize,this.normalized&&(n=Ht(n,this.array),i=Ht(i,this.array)),this.array[e+0]=n,this.array[e+1]=i,this}setXYZ(e,n,i,s){return e*=this.itemSize,this.normalized&&(n=Ht(n,this.array),i=Ht(i,this.array),s=Ht(s,this.array)),this.array[e+0]=n,this.array[e+1]=i,this.array[e+2]=s,this}setXYZW(e,n,i,s,o){return e*=this.itemSize,this.normalized&&(n=Ht(n,this.array),i=Ht(i,this.array),s=Ht(s,this.array),o=Ht(o,this.array)),this.array[e+0]=n,this.array[e+1]=i,this.array[e+2]=s,this.array[e+3]=o,this}onUpload(e){return this.onUploadCallback=e,this}clone(){return new this.constructor(this.array,this.itemSize).copy(this)}toJSON(){const e={itemSize:this.itemSize,type:this.array.constructor.name,array:Array.from(this.array),normalized:this.normalized};return this.name!==""&&(e.name=this.name),this.usage!==zT&&(e.usage=this.usage),e}}class OF extends hi{constructor(e,n,i){super(new Uint16Array(e),n,i)}}class DF extends hi{constructor(e,n,i){super(new Uint32Array(e),n,i)}}class TY extends hi{constructor(e,n,i){super(new Uint16Array(e),n,i),this.isFloat16BufferAttribute=!0}getX(e){let n=eS(this.array[e*this.itemSize]);return this.normalized&&(n=Ms(n,this.array)),n}setX(e,n){return this.normalized&&(n=Ht(n,this.array)),this.array[e*this.itemSize]=po(n),this}getY(e){let n=eS(this.array[e*this.itemSize+1]);return this.normalized&&(n=Ms(n,this.array)),n}setY(e,n){return this.normalized&&(n=Ht(n,this.array)),this.array[e*this.itemSize+1]=po(n),this}getZ(e){let n=eS(this.array[e*this.itemSize+2]);return this.normalized&&(n=Ms(n,this.array)),n}setZ(e,n){return this.normalized&&(n=Ht(n,this.array)),this.array[e*this.itemSize+2]=po(n),this}getW(e){let n=eS(this.array[e*this.itemSize+3]);return this.normalized&&(n=Ms(n,this.array)),n}setW(e,n){return this.normalized&&(n=Ht(n,this.array)),this.array[e*this.itemSize+3]=po(n),this}setXY(e,n,i){return e*=this.itemSize,this.normalized&&(n=Ht(n,this.array),i=Ht(i,this.array)),this.array[e+0]=po(n),this.array[e+1]=po(i),this}setXYZ(e,n,i,s){return e*=this.itemSize,this.normalized&&(n=Ht(n,this.array),i=Ht(i,this.array),s=Ht(s,this.array)),this.array[e+0]=po(n),this.array[e+1]=po(i),this.array[e+2]=po(s),this}setXYZW(e,n,i,s,o){return e*=this.itemSize,this.normalized&&(n=Ht(n,this.array),i=Ht(i,this.array),s=Ht(s,this.array),o=Ht(o,this.array)),this.array[e+0]=po(n),this.array[e+1]=po(i),this.array[e+2]=po(s),this.array[e+3]=po(o),this}}class Dr extends hi{constructor(e,n,i){super(new Float32Array(e),n,i)}}let Fve=0;const Vo=new sn,hR=new Mr,yp=new K,mo=new Od,hv=new Od,xi=new K;class ji extends gu{constructor(){super(),this.isBufferGeometry=!0,Object.defineProperty(this,"id",{value:Fve++}),this.uuid=Hc(),this.name="",this.type="BufferGeometry",this.index=null,this.indirect=null,this.attributes={},this.morphAttributes={},this.morphTargetsRelative=!1,this.groups=[],this.boundingBox=null,this.boundingSphere=null,this.drawRange={start:0,count:1/0},this.userData={}}getIndex(){return this.index}setIndex(e){return Array.isArray(e)?this.index=new(PF(e)?DF:OF)(e,1):this.index=e,this}setIndirect(e){return this.indirect=e,this}getIndirect(){return this.indirect}getAttribute(e){return this.attributes[e]}setAttribute(e,n){return this.attributes[e]=n,this}deleteAttribute(e){return delete this.attributes[e],this}hasAttribute(e){return this.attributes[e]!==void 0}addGroup(e,n,i=0){this.groups.push({start:e,count:n,materialIndex:i})}clearGroups(){this.groups=[]}setDrawRange(e,n){this.drawRange.start=e,this.drawRange.count=n}applyMatrix4(e){const n=this.attributes.position;n!==void 0&&(n.applyMatrix4(e),n.needsUpdate=!0);const i=this.attributes.normal;if(i!==void 0){const o=new Bt().getNormalMatrix(e);i.applyNormalMatrix(o),i.needsUpdate=!0}const s=this.attributes.tangent;return s!==void 0&&(s.transformDirection(e),s.needsUpdate=!0),this.boundingBox!==null&&this.computeBoundingBox(),this.boundingSphere!==null&&this.computeBoundingSphere(),this}applyQuaternion(e){return Vo.makeRotationFromQuaternion(e),this.applyMatrix4(Vo),this}rotateX(e){return Vo.makeRotationX(e),this.applyMatrix4(Vo),this}rotateY(e){return Vo.makeRotationY(e),this.applyMatrix4(Vo),this}rotateZ(e){return Vo.makeRotationZ(e),this.applyMatrix4(Vo),this}translate(e,n,i){return Vo.makeTranslation(e,n,i),this.applyMatrix4(Vo),this}scale(e,n,i){return Vo.makeScale(e,n,i),this.applyMatrix4(Vo),this}lookAt(e){return hR.lookAt(e),hR.updateMatrix(),this.applyMatrix4(hR.matrix),this}center(){return this.computeBoundingBox(),this.boundingBox.getCenter(yp).negate(),this.translate(yp.x,yp.y,yp.z),this}setFromPoints(e){const n=this.getAttribute("position");if(n===void 0){const i=[];for(let s=0,o=e.length;s<o;s++){const a=e[s];i.push(a.x,a.y,a.z||0)}this.setAttribute("position",new Dr(i,3))}else{const i=Math.min(e.length,n.count);for(let s=0;s<i;s++){const o=e[s];n.setXYZ(s,o.x,o.y,o.z||0)}e.length>n.count&&console.warn("THREE.BufferGeometry: Buffer size too small for points data. Use .dispose() and create a new geometry."),n.needsUpdate=!0}return this}computeBoundingBox(){this.boundingBox===null&&(this.boundingBox=new Od);const e=this.attributes.position,n=this.morphAttributes.position;if(e&&e.isGLBufferAttribute){console.error("THREE.BufferGeometry.computeBoundingBox(): GLBufferAttribute requires a manual bounding box.",this),this.boundingBox.set(new K(-1/0,-1/0,-1/0),new K(1/0,1/0,1/0));return}if(e!==void 0){if(this.boundingBox.setFromBufferAttribute(e),n)for(let i=0,s=n.length;i<s;i++){const o=n[i];mo.setFromBufferAttribute(o),this.morphTargetsRelative?(xi.addVectors(this.boundingBox.min,mo.min),this.boundingBox.expandByPoint(xi),xi.addVectors(this.boundingBox.max,mo.max),this.boundingBox.expandByPoint(xi)):(this.boundingBox.expandByPoint(mo.min),this.boundingBox.expandByPoint(mo.max))}}else this.boundingBox.makeEmpty();(isNaN(this.boundingBox.min.x)||isNaN(this.boundingBox.min.y)||isNaN(this.boundingBox.min.z))&&console.error('THREE.BufferGeometry.computeBoundingBox(): Computed min/max have NaN values. The "position" attribute is likely to have NaN values.',this)}computeBoundingSphere(){this.boundingSphere===null&&(this.boundingSphere=new f_);const e=this.attributes.position,n=this.morphAttributes.position;if(e&&e.isGLBufferAttribute){console.error("THREE.BufferGeometry.computeBoundingSphere(): GLBufferAttribute requires a manual bounding sphere.",this),this.boundingSphere.set(new K,1/0);return}if(e){const i=this.boundingSphere.center;if(mo.setFromBufferAttribute(e),n)for(let o=0,a=n.length;o<a;o++){const l=n[o];hv.setFromBufferAttribute(l),this.morphTargetsRelative?(xi.addVectors(mo.min,hv.min),mo.expandByPoint(xi),xi.addVectors(mo.max,hv.max),mo.expandByPoint(xi)):(mo.expandByPoint(hv.min),mo.expandByPoint(hv.max))}mo.getCenter(i);let s=0;for(let o=0,a=e.count;o<a;o++)xi.fromBufferAttribute(e,o),s=Math.max(s,i.distanceToSquared(xi));if(n)for(let o=0,a=n.length;o<a;o++){const l=n[o],c=this.morphTargetsRelative;for(let u=0,h=l.count;u<h;u++)xi.fromBufferAttribute(l,u),c&&(yp.fromBufferAttribute(e,u),xi.add(yp)),s=Math.max(s,i.distanceToSquared(xi))}this.boundingSphere.radius=Math.sqrt(s),isNaN(this.boundingSphere.radius)&&console.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.',this)}}computeTangents(){const e=this.index,n=this.attributes;if(e===null||n.position===void 0||n.normal===void 0||n.uv===void 0){console.error("THREE.BufferGeometry: .computeTangents() failed. Missing required attributes (index, position, normal or uv)");return}const i=n.position,s=n.normal,o=n.uv;this.hasAttribute("tangent")===!1&&this.setAttribute("tangent",new hi(new Float32Array(4*i.count),4));const a=this.getAttribute("tangent"),l=[],c=[];for(let E=0;E<i.count;E++)l[E]=new K,c[E]=new K;const u=new K,h=new K,f=new K,d=new Fe,p=new Fe,m=new Fe,g=new K,v=new K;function y(E,M,A){u.fromBufferAttribute(i,E),h.fromBufferAttribute(i,M),f.fromBufferAttribute(i,A),d.fromBufferAttribute(o,E),p.fromBufferAttribute(o,M),m.fromBufferAttribute(o,A),h.sub(u),f.sub(u),p.sub(d),m.sub(d);const P=1/(p.x*m.y-m.x*p.y);isFinite(P)&&(g.copy(h).multiplyScalar(m.y).addScaledVector(f,-p.y).multiplyScalar(P),v.copy(f).multiplyScalar(p.x).addScaledVector(h,-m.x).multiplyScalar(P),l[E].add(g),l[M].add(g),l[A].add(g),c[E].add(v),c[M].add(v),c[A].add(v))}let x=this.groups;x.length===0&&(x=[{start:0,count:e.count}]);for(let E=0,M=x.length;E<M;++E){const A=x[E],P=A.start,D=A.count;for(let B=P,C=P+D;B<C;B+=3)y(e.getX(B+0),e.getX(B+1),e.getX(B+2))}const b=new K,w=new K,_=new K,S=new K;function T(E){_.fromBufferAttribute(s,E),S.copy(_);const M=l[E];b.copy(M),b.sub(_.multiplyScalar(_.dot(M))).normalize(),w.crossVectors(S,M);const P=w.dot(c[E])<0?-1:1;a.setXYZW(E,b.x,b.y,b.z,P)}for(let E=0,M=x.length;E<M;++E){const A=x[E],P=A.start,D=A.count;for(let B=P,C=P+D;B<C;B+=3)T(e.getX(B+0)),T(e.getX(B+1)),T(e.getX(B+2))}}computeVertexNormals(){const e=this.index,n=this.getAttribute("position");if(n!==void 0){let i=this.getAttribute("normal");if(i===void 0)i=new hi(new Float32Array(n.count*3),3),this.setAttribute("normal",i);else for(let d=0,p=i.count;d<p;d++)i.setXYZ(d,0,0,0);const s=new K,o=new K,a=new K,l=new K,c=new K,u=new K,h=new K,f=new K;if(e)for(let d=0,p=e.count;d<p;d+=3){const m=e.getX(d+0),g=e.getX(d+1),v=e.getX(d+2);s.fromBufferAttribute(n,m),o.fromBufferAttribute(n,g),a.fromBufferAttribute(n,v),h.subVectors(a,o),f.subVectors(s,o),h.cross(f),l.fromBufferAttribute(i,m),c.fromBufferAttribute(i,g),u.fromBufferAttribute(i,v),l.add(h),c.add(h),u.add(h),i.setXYZ(m,l.x,l.y,l.z),i.setXYZ(g,c.x,c.y,c.z),i.setXYZ(v,u.x,u.y,u.z)}else for(let d=0,p=n.count;d<p;d+=3)s.fromBufferAttribute(n,d+0),o.fromBufferAttribute(n,d+1),a.fromBufferAttribute(n,d+2),h.subVectors(a,o),f.subVectors(s,o),h.cross(f),i.setXYZ(d+0,h.x,h.y,h.z),i.setXYZ(d+1,h.x,h.y,h.z),i.setXYZ(d+2,h.x,h.y,h.z);this.normalizeNormals(),i.needsUpdate=!0}}normalizeNormals(){const e=this.attributes.normal;for(let n=0,i=e.count;n<i;n++)xi.fromBufferAttribute(e,n),xi.normalize(),e.setXYZ(n,xi.x,xi.y,xi.z)}toNonIndexed(){function e(l,c){const u=l.array,h=l.itemSize,f=l.normalized,d=new u.constructor(c.length*h);let p=0,m=0;for(let g=0,v=c.length;g<v;g++){l.isInterleavedBufferAttribute?p=c[g]*l.data.stride+l.offset:p=c[g]*h;for(let y=0;y<h;y++)d[m++]=u[p++]}return new hi(d,h,f)}if(this.index===null)return console.warn("THREE.BufferGeometry.toNonIndexed(): BufferGeometry is already non-indexed."),this;const n=new ji,i=this.index.array,s=this.attributes;for(const l in s){const c=s[l],u=e(c,i);n.setAttribute(l,u)}const o=this.morphAttributes;for(const l in o){const c=[],u=o[l];for(let h=0,f=u.length;h<f;h++){const d=u[h],p=e(d,i);c.push(p)}n.morphAttributes[l]=c}n.morphTargetsRelative=this.morphTargetsRelative;const a=this.groups;for(let l=0,c=a.length;l<c;l++){const u=a[l];n.addGroup(u.start,u.count,u.materialIndex)}return n}toJSON(){const e={metadata:{version:4.6,type:"BufferGeometry",generator:"BufferGeometry.toJSON"}};if(e.uuid=this.uuid,e.type=this.type,this.name!==""&&(e.name=this.name),Object.keys(this.userData).length>0&&(e.userData=this.userData),this.parameters!==void 0){const c=this.parameters;for(const u in c)c[u]!==void 0&&(e[u]=c[u]);return e}e.data={attributes:{}};const n=this.index;n!==null&&(e.data.index={type:n.array.constructor.name,array:Array.prototype.slice.call(n.array)});const i=this.attributes;for(const c in i){const u=i[c];e.data.attributes[c]=u.toJSON(e.data)}const s={};let o=!1;for(const c in this.morphAttributes){const u=this.morphAttributes[c],h=[];for(let f=0,d=u.length;f<d;f++){const p=u[f];h.push(p.toJSON(e.data))}h.length>0&&(s[c]=h,o=!0)}o&&(e.data.morphAttributes=s,e.data.morphTargetsRelative=this.morphTargetsRelative);const a=this.groups;a.length>0&&(e.data.groups=JSON.parse(JSON.stringify(a)));const l=this.boundingSphere;return l!==null&&(e.data.boundingSphere={center:l.center.toArray(),radius:l.radius}),e}clone(){return new this.constructor().copy(this)}copy(e){this.index=null,this.attributes={},this.morphAttributes={},this.groups=[],this.boundingBox=null,this.boundingSphere=null;const n={};this.name=e.name;const i=e.index;i!==null&&this.setIndex(i.clone());const s=e.attributes;for(const u in s){const h=s[u];this.setAttribute(u,h.clone(n))}const o=e.morphAttributes;for(const u in o){const h=[],f=o[u];for(let d=0,p=f.length;d<p;d++)h.push(f[d].clone(n));this.morphAttributes[u]=h}this.morphTargetsRelative=e.morphTargetsRelative;const a=e.groups;for(let u=0,h=a.length;u<h;u++){const f=a[u];this.addGroup(f.start,f.count,f.materialIndex)}const l=e.boundingBox;l!==null&&(this.boundingBox=l.clone());const c=e.boundingSphere;return c!==null&&(this.boundingSphere=c.clone()),this.drawRange.start=e.drawRange.start,this.drawRange.count=e.drawRange.count,this.userData=e.userData,this}dispose(){this.dispatchEvent({type:"dispose"})}}const wV=new sn,lf=new YM,nS=new f_,SV=new K,rS=new K,iS=new K,sS=new K,fR=new K,oS=new K,TV=new K,aS=new K;class Jn extends Mr{constructor(e=new ji,n=new As){super(),this.isMesh=!0,this.type="Mesh",this.geometry=e,this.material=n,this.morphTargetDictionary=void 0,this.morphTargetInfluences=void 0,this.updateMorphTargets()}copy(e,n){return super.copy(e,n),e.morphTargetInfluences!==void 0&&(this.morphTargetInfluences=e.morphTargetInfluences.slice()),e.morphTargetDictionary!==void 0&&(this.morphTargetDictionary=Object.assign({},e.morphTargetDictionary)),this.material=Array.isArray(e.material)?e.material.slice():e.material,this.geometry=e.geometry,this}updateMorphTargets(){const n=this.geometry.morphAttributes,i=Object.keys(n);if(i.length>0){const s=n[i[0]];if(s!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let o=0,a=s.length;o<a;o++){const l=s[o].name||String(o);this.morphTargetInfluences.push(0),this.morphTargetDictionary[l]=o}}}}getVertexPosition(e,n){const i=this.geometry,s=i.attributes.position,o=i.morphAttributes.position,a=i.morphTargetsRelative;n.fromBufferAttribute(s,e);const l=this.morphTargetInfluences;if(o&&l){oS.set(0,0,0);for(let c=0,u=o.length;c<u;c++){const h=l[c],f=o[c];h!==0&&(fR.fromBufferAttribute(f,e),a?oS.addScaledVector(fR,h):oS.addScaledVector(fR.sub(n),h))}n.add(oS)}return n}raycast(e,n){const i=this.geometry,s=this.material,o=this.matrixWorld;s!==void 0&&(i.boundingSphere===null&&i.computeBoundingSphere(),nS.copy(i.boundingSphere),nS.applyMatrix4(o),lf.copy(e.ray).recast(e.near),!(nS.containsPoint(lf.origin)===!1&&(lf.intersectSphere(nS,SV)===null||lf.origin.distanceToSquared(SV)>(e.far-e.near)**2))&&(wV.copy(o).invert(),lf.copy(e.ray).applyMatrix4(wV),!(i.boundingBox!==null&&lf.intersectsBox(i.boundingBox)===!1)&&this._computeIntersections(e,n,lf)))}_computeIntersections(e,n,i){let s;const o=this.geometry,a=this.material,l=o.index,c=o.attributes.position,u=o.attributes.uv,h=o.attributes.uv1,f=o.attributes.normal,d=o.groups,p=o.drawRange;if(l!==null)if(Array.isArray(a))for(let m=0,g=d.length;m<g;m++){const v=d[m],y=a[v.materialIndex],x=Math.max(v.start,p.start),b=Math.min(l.count,Math.min(v.start+v.count,p.start+p.count));for(let w=x,_=b;w<_;w+=3){const S=l.getX(w),T=l.getX(w+1),E=l.getX(w+2);s=lS(this,y,e,i,u,h,f,S,T,E),s&&(s.faceIndex=Math.floor(w/3),s.face.materialIndex=v.materialIndex,n.push(s))}}else{const m=Math.max(0,p.start),g=Math.min(l.count,p.start+p.count);for(let v=m,y=g;v<y;v+=3){const x=l.getX(v),b=l.getX(v+1),w=l.getX(v+2);s=lS(this,a,e,i,u,h,f,x,b,w),s&&(s.faceIndex=Math.floor(v/3),n.push(s))}}else if(c!==void 0)if(Array.isArray(a))for(let m=0,g=d.length;m<g;m++){const v=d[m],y=a[v.materialIndex],x=Math.max(v.start,p.start),b=Math.min(c.count,Math.min(v.start+v.count,p.start+p.count));for(let w=x,_=b;w<_;w+=3){const S=w,T=w+1,E=w+2;s=lS(this,y,e,i,u,h,f,S,T,E),s&&(s.faceIndex=Math.floor(w/3),s.face.materialIndex=v.materialIndex,n.push(s))}}else{const m=Math.max(0,p.start),g=Math.min(c.count,p.start+p.count);for(let v=m,y=g;v<y;v+=3){const x=v,b=v+1,w=v+2;s=lS(this,a,e,i,u,h,f,x,b,w),s&&(s.faceIndex=Math.floor(v/3),n.push(s))}}}}function Bve(r,e,n,i,s,o,a,l){let c;if(e.side===Fn?c=i.intersectTriangle(a,o,s,!0,l):c=i.intersectTriangle(s,o,a,e.side===no,l),c===null)return null;aS.copy(l),aS.applyMatrix4(r.matrixWorld);const u=n.ray.origin.distanceTo(aS);return u<n.near||u>n.far?null:{distance:u,point:aS.clone(),object:r}}function lS(r,e,n,i,s,o,a,l,c,u){r.getVertexPosition(l,rS),r.getVertexPosition(c,iS),r.getVertexPosition(u,sS);const h=Bve(r,e,n,i,rS,iS,sS,TV);if(h){const f=new K;ta.getBarycoord(TV,rS,iS,sS,f),s&&(h.uv=ta.getInterpolatedAttribute(s,l,c,u,f,new Fe)),o&&(h.uv1=ta.getInterpolatedAttribute(o,l,c,u,f,new Fe)),a&&(h.normal=ta.getInterpolatedAttribute(a,l,c,u,f,new K),h.normal.dot(i.direction)>0&&h.normal.multiplyScalar(-1));const d={a:l,b:c,c:u,normal:new K,materialIndex:0};ta.getNormal(rS,iS,sS,d.normal),h.face=d,h.barycoord=f}return h}class Dl extends ji{constructor(e=1,n=1,i=1,s=1,o=1,a=1){super(),this.type="BoxGeometry",this.parameters={width:e,height:n,depth:i,widthSegments:s,heightSegments:o,depthSegments:a};const l=this;s=Math.floor(s),o=Math.floor(o),a=Math.floor(a);const c=[],u=[],h=[],f=[];let d=0,p=0;m("z","y","x",-1,-1,i,n,e,a,o,0),m("z","y","x",1,-1,i,n,-e,a,o,1),m("x","z","y",1,1,e,i,n,s,a,2),m("x","z","y",1,-1,e,i,-n,s,a,3),m("x","y","z",1,-1,e,n,i,s,o,4),m("x","y","z",-1,-1,e,n,-i,s,o,5),this.setIndex(c),this.setAttribute("position",new Dr(u,3)),this.setAttribute("normal",new Dr(h,3)),this.setAttribute("uv",new Dr(f,2));function m(g,v,y,x,b,w,_,S,T,E,M){const A=w/T,P=_/E,D=w/2,B=_/2,C=S/2,O=T+1,R=E+1;let z=0,U=0;const G=new K;for(let H=0;H<R;H++){const Y=H*P-B;for(let ee=0;ee<O;ee++){const he=ee*A-D;G[g]=he*x,G[v]=Y*b,G[y]=C,u.push(G.x,G.y,G.z),G[g]=0,G[v]=0,G[y]=S>0?1:-1,h.push(G.x,G.y,G.z),f.push(ee/T),f.push(1-H/E),z+=1}}for(let H=0;H<E;H++)for(let Y=0;Y<T;Y++){const ee=d+Y+O*H,he=d+Y+O*(H+1),q=d+(Y+1)+O*(H+1),J=d+(Y+1)+O*H;c.push(ee,he,J),c.push(he,q,J),U+=6}l.addGroup(p,U,M),p+=U,d+=z}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new Dl(e.width,e.height,e.depth,e.widthSegments,e.heightSegments,e.depthSegments)}}function vg(r){const e={};for(const n in r){e[n]={};for(const i in r[n]){const s=r[n][i];s&&(s.isColor||s.isMatrix3||s.isMatrix4||s.isVector2||s.isVector3||s.isVector4||s.isTexture||s.isQuaternion)?s.isRenderTargetTexture?(console.warn("UniformsUtils: Textures of render targets cannot be cloned via cloneUniforms() or mergeUniforms()."),e[n][i]=null):e[n][i]=s.clone():Array.isArray(s)?e[n][i]=s.slice():e[n][i]=s}}return e}function ms(r){const e={};for(let n=0;n<r.length;n++){const i=vg(r[n]);for(const s in i)e[s]=i[s]}return e}function Uve(r){const e=[];for(let n=0;n<r.length;n++)e.push(r[n].clone());return e}function EY(r){const e=r.getRenderTarget();return e===null?r.outputColorSpace:e.isXRRenderTarget===!0?e.texture.colorSpace:Qt.workingColorSpace}const MY={clone:vg,merge:ms};var zve=`void main() {
	gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
}`,$ve=`void main() {
	gl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );
}`;class Bl extends cs{constructor(e){super(),this.isShaderMaterial=!0,this.type="ShaderMaterial",this.defines={},this.uniforms={},this.uniformsGroups=[],this.vertexShader=zve,this.fragmentShader=$ve,this.linewidth=1,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.lights=!1,this.clipping=!1,this.forceSinglePass=!0,this.extensions={clipCullDistance:!1,multiDraw:!1},this.defaultAttributeValues={color:[1,1,1],uv:[0,0],uv1:[0,0]},this.index0AttributeName=void 0,this.uniformsNeedUpdate=!1,this.glslVersion=null,e!==void 0&&this.setValues(e)}copy(e){return super.copy(e),this.fragmentShader=e.fragmentShader,this.vertexShader=e.vertexShader,this.uniforms=vg(e.uniforms),this.uniformsGroups=Uve(e.uniformsGroups),this.defines=Object.assign({},e.defines),this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.fog=e.fog,this.lights=e.lights,this.clipping=e.clipping,this.extensions=Object.assign({},e.extensions),this.glslVersion=e.glslVersion,this}toJSON(e){const n=super.toJSON(e);n.glslVersion=this.glslVersion,n.uniforms={};for(const s in this.uniforms){const a=this.uniforms[s].value;a&&a.isTexture?n.uniforms[s]={type:"t",value:a.toJSON(e).uuid}:a&&a.isColor?n.uniforms[s]={type:"c",value:a.getHex()}:a&&a.isVector2?n.uniforms[s]={type:"v2",value:a.toArray()}:a&&a.isVector3?n.uniforms[s]={type:"v3",value:a.toArray()}:a&&a.isVector4?n.uniforms[s]={type:"v4",value:a.toArray()}:a&&a.isMatrix3?n.uniforms[s]={type:"m3",value:a.toArray()}:a&&a.isMatrix4?n.uniforms[s]={type:"m4",value:a.toArray()}:n.uniforms[s]={value:a}}Object.keys(this.defines).length>0&&(n.defines=this.defines),n.vertexShader=this.vertexShader,n.fragmentShader=this.fragmentShader,n.lights=this.lights,n.clipping=this.clipping;const i={};for(const s in this.extensions)this.extensions[s]===!0&&(i[s]=!0);return Object.keys(i).length>0&&(n.extensions=i),n}}class kF extends Mr{constructor(){super(),this.isCamera=!0,this.type="Camera",this.matrixWorldInverse=new sn,this.projectionMatrix=new sn,this.projectionMatrixInverse=new sn,this.coordinateSystem=Ps}copy(e,n){return super.copy(e,n),this.matrixWorldInverse.copy(e.matrixWorldInverse),this.projectionMatrix.copy(e.projectionMatrix),this.projectionMatrixInverse.copy(e.projectionMatrixInverse),this.coordinateSystem=e.coordinateSystem,this}getWorldDirection(e){return super.getWorldDirection(e).negate()}updateMatrixWorld(e){super.updateMatrixWorld(e),this.matrixWorldInverse.copy(this.matrixWorld).invert()}updateWorldMatrix(e,n){super.updateWorldMatrix(e,n),this.matrixWorldInverse.copy(this.matrixWorld).invert()}clone(){return new this.constructor().copy(this)}}const Uu=new K,EV=new Fe,MV=new Fe;class Ti extends kF{constructor(e=50,n=1,i=.1,s=2e3){super(),this.isPerspectiveCamera=!0,this.type="PerspectiveCamera",this.fov=e,this.zoom=1,this.near=i,this.far=s,this.focus=10,this.aspect=n,this.view=null,this.filmGauge=35,this.filmOffset=0,this.updateProjectionMatrix()}copy(e,n){return super.copy(e,n),this.fov=e.fov,this.zoom=e.zoom,this.near=e.near,this.far=e.far,this.focus=e.focus,this.aspect=e.aspect,this.view=e.view===null?null:Object.assign({},e.view),this.filmGauge=e.filmGauge,this.filmOffset=e.filmOffset,this}setFocalLength(e){const n=.5*this.getFilmHeight()/e;this.fov=vd*2*Math.atan(n),this.updateProjectionMatrix()}getFocalLength(){const e=Math.tan(I0*.5*this.fov);return .5*this.getFilmHeight()/e}getEffectiveFOV(){return vd*2*Math.atan(Math.tan(I0*.5*this.fov)/this.zoom)}getFilmWidth(){return this.filmGauge*Math.min(this.aspect,1)}getFilmHeight(){return this.filmGauge/Math.max(this.aspect,1)}getViewBounds(e,n,i){Uu.set(-1,-1,.5).applyMatrix4(this.projectionMatrixInverse),n.set(Uu.x,Uu.y).multiplyScalar(-e/Uu.z),Uu.set(1,1,.5).applyMatrix4(this.projectionMatrixInverse),i.set(Uu.x,Uu.y).multiplyScalar(-e/Uu.z)}getViewSize(e,n){return this.getViewBounds(e,EV,MV),n.subVectors(MV,EV)}setViewOffset(e,n,i,s,o,a){this.aspect=e/n,this.view===null&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=n,this.view.offsetX=i,this.view.offsetY=s,this.view.width=o,this.view.height=a,this.updateProjectionMatrix()}clearViewOffset(){this.view!==null&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const e=this.near;let n=e*Math.tan(I0*.5*this.fov)/this.zoom,i=2*n,s=this.aspect*i,o=-.5*s;const a=this.view;if(this.view!==null&&this.view.enabled){const c=a.fullWidth,u=a.fullHeight;o+=a.offsetX*s/c,n-=a.offsetY*i/u,s*=a.width/c,i*=a.height/u}const l=this.filmOffset;l!==0&&(o+=e*l/this.getFilmWidth()),this.projectionMatrix.makePerspective(o,o+s,n,n-i,e,this.far,this.coordinateSystem),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(e){const n=super.toJSON(e);return n.object.fov=this.fov,n.object.zoom=this.zoom,n.object.near=this.near,n.object.far=this.far,n.object.focus=this.focus,n.object.aspect=this.aspect,this.view!==null&&(n.object.view=Object.assign({},this.view)),n.object.filmGauge=this.filmGauge,n.object.filmOffset=this.filmOffset,n}}const vp=-90,xp=1;class AY extends Mr{constructor(e,n,i){super(),this.type="CubeCamera",this.renderTarget=i,this.coordinateSystem=null,this.activeMipmapLevel=0;const s=new Ti(vp,xp,e,n);s.layers=this.layers,this.add(s);const o=new Ti(vp,xp,e,n);o.layers=this.layers,this.add(o);const a=new Ti(vp,xp,e,n);a.layers=this.layers,this.add(a);const l=new Ti(vp,xp,e,n);l.layers=this.layers,this.add(l);const c=new Ti(vp,xp,e,n);c.layers=this.layers,this.add(c);const u=new Ti(vp,xp,e,n);u.layers=this.layers,this.add(u)}updateCoordinateSystem(){const e=this.coordinateSystem,n=this.children.concat(),[i,s,o,a,l,c]=n;for(const u of n)this.remove(u);if(e===Ps)i.up.set(0,1,0),i.lookAt(1,0,0),s.up.set(0,1,0),s.lookAt(-1,0,0),o.up.set(0,0,-1),o.lookAt(0,1,0),a.up.set(0,0,1),a.lookAt(0,-1,0),l.up.set(0,1,0),l.lookAt(0,0,1),c.up.set(0,1,0),c.lookAt(0,0,-1);else if(e===Ph)i.up.set(0,-1,0),i.lookAt(-1,0,0),s.up.set(0,-1,0),s.lookAt(1,0,0),o.up.set(0,0,1),o.lookAt(0,1,0),a.up.set(0,0,-1),a.lookAt(0,-1,0),l.up.set(0,-1,0),l.lookAt(0,0,1),c.up.set(0,-1,0),c.lookAt(0,0,-1);else throw new Error("THREE.CubeCamera.updateCoordinateSystem(): Invalid coordinate system: "+e);for(const u of n)this.add(u),u.updateMatrixWorld()}update(e,n){this.parent===null&&this.updateMatrixWorld();const{renderTarget:i,activeMipmapLevel:s}=this;this.coordinateSystem!==e.coordinateSystem&&(this.coordinateSystem=e.coordinateSystem,this.updateCoordinateSystem());const[o,a,l,c,u,h]=this.children,f=e.getRenderTarget(),d=e.getActiveCubeFace(),p=e.getActiveMipmapLevel(),m=e.xr.enabled;e.xr.enabled=!1;const g=i.texture.generateMipmaps;i.texture.generateMipmaps=!1,e.setRenderTarget(i,0,s),e.render(n,o),e.setRenderTarget(i,1,s),e.render(n,a),e.setRenderTarget(i,2,s),e.render(n,l),e.setRenderTarget(i,3,s),e.render(n,c),e.setRenderTarget(i,4,s),e.render(n,u),i.texture.generateMipmaps=g,e.setRenderTarget(i,5,s),e.render(n,h),e.setRenderTarget(f,d,p),e.xr.enabled=m,i.texture.needsPMREMUpdate=!0}}class ZM extends ui{constructor(e=[],n=tl,i,s,o,a,l,c,u,h){super(e,n,i,s,o,a,l,c,u,h),this.isCubeTexture=!0,this.flipY=!1}get images(){return this.image}set images(e){this.image=e}}class CY extends Rh{constructor(e=1,n={}){super(e,e,n),this.isWebGLCubeRenderTarget=!0;const i={width:e,height:e,depth:1},s=[i,i,i,i,i,i];this.texture=new ZM(s,n.mapping,n.wrapS,n.wrapT,n.magFilter,n.minFilter,n.format,n.type,n.anisotropy,n.colorSpace),this.texture.isRenderTargetTexture=!0,this.texture.generateMipmaps=n.generateMipmaps!==void 0?n.generateMipmaps:!1,this.texture.minFilter=n.minFilter!==void 0?n.minFilter:li}fromEquirectangularTexture(e,n){this.texture.type=n.type,this.texture.colorSpace=n.colorSpace,this.texture.generateMipmaps=n.generateMipmaps,this.texture.minFilter=n.minFilter,this.texture.magFilter=n.magFilter;const i={uniforms:{tEquirect:{value:null}},vertexShader:`

				varying vec3 vWorldDirection;

				vec3 transformDirection( in vec3 dir, in mat4 matrix ) {

					return normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );

				}

				void main() {

					vWorldDirection = transformDirection( position, modelMatrix );

					#include <begin_vertex>
					#include <project_vertex>

				}
			`,fragmentShader:`

				uniform sampler2D tEquirect;

				varying vec3 vWorldDirection;

				#include <common>

				void main() {

					vec3 direction = normalize( vWorldDirection );

					vec2 sampleUV = equirectUv( direction );

					gl_FragColor = texture2D( tEquirect, sampleUV );

				}
			`},s=new Dl(5,5,5),o=new Bl({name:"CubemapFromEquirect",uniforms:vg(i.uniforms),vertexShader:i.vertexShader,fragmentShader:i.fragmentShader,side:Fn,blending:ro});o.uniforms.tEquirect.value=n;const a=new Jn(s,o),l=n.minFilter;return n.minFilter===Ks&&(n.minFilter=li),new AY(1,10,this).update(e,a),n.minFilter=l,a.geometry.dispose(),a.material.dispose(),this}clear(e,n=!0,i=!0,s=!0){const o=e.getRenderTarget();for(let a=0;a<6;a++)e.setRenderTarget(this,a),e.clear(n,i,s);e.setRenderTarget(o)}}let am=class extends Mr{constructor(){super(),this.isGroup=!0,this.type="Group"}};const jve={type:"move"};class R1{constructor(){this._targetRay=null,this._grip=null,this._hand=null}getHandSpace(){return this._hand===null&&(this._hand=new am,this._hand.matrixAutoUpdate=!1,this._hand.visible=!1,this._hand.joints={},this._hand.inputState={pinching:!1}),this._hand}getTargetRaySpace(){return this._targetRay===null&&(this._targetRay=new am,this._targetRay.matrixAutoUpdate=!1,this._targetRay.visible=!1,this._targetRay.hasLinearVelocity=!1,this._targetRay.linearVelocity=new K,this._targetRay.hasAngularVelocity=!1,this._targetRay.angularVelocity=new K),this._targetRay}getGripSpace(){return this._grip===null&&(this._grip=new am,this._grip.matrixAutoUpdate=!1,this._grip.visible=!1,this._grip.hasLinearVelocity=!1,this._grip.linearVelocity=new K,this._grip.hasAngularVelocity=!1,this._grip.angularVelocity=new K),this._grip}dispatchEvent(e){return this._targetRay!==null&&this._targetRay.dispatchEvent(e),this._grip!==null&&this._grip.dispatchEvent(e),this._hand!==null&&this._hand.dispatchEvent(e),this}connect(e){if(e&&e.hand){const n=this._hand;if(n)for(const i of e.hand.values())this._getHandJoint(n,i)}return this.dispatchEvent({type:"connected",data:e}),this}disconnect(e){return this.dispatchEvent({type:"disconnected",data:e}),this._targetRay!==null&&(this._targetRay.visible=!1),this._grip!==null&&(this._grip.visible=!1),this._hand!==null&&(this._hand.visible=!1),this}update(e,n,i){let s=null,o=null,a=null;const l=this._targetRay,c=this._grip,u=this._hand;if(e&&n.session.visibilityState!=="visible-blurred"){if(u&&e.hand){a=!0;for(const g of e.hand.values()){const v=n.getJointPose(g,i),y=this._getHandJoint(u,g);v!==null&&(y.matrix.fromArray(v.transform.matrix),y.matrix.decompose(y.position,y.rotation,y.scale),y.matrixWorldNeedsUpdate=!0,y.jointRadius=v.radius),y.visible=v!==null}const h=u.joints["index-finger-tip"],f=u.joints["thumb-tip"],d=h.position.distanceTo(f.position),p=.02,m=.005;u.inputState.pinching&&d>p+m?(u.inputState.pinching=!1,this.dispatchEvent({type:"pinchend",handedness:e.handedness,target:this})):!u.inputState.pinching&&d<=p-m&&(u.inputState.pinching=!0,this.dispatchEvent({type:"pinchstart",handedness:e.handedness,target:this}))}else c!==null&&e.gripSpace&&(o=n.getPose(e.gripSpace,i),o!==null&&(c.matrix.fromArray(o.transform.matrix),c.matrix.decompose(c.position,c.rotation,c.scale),c.matrixWorldNeedsUpdate=!0,o.linearVelocity?(c.hasLinearVelocity=!0,c.linearVelocity.copy(o.linearVelocity)):c.hasLinearVelocity=!1,o.angularVelocity?(c.hasAngularVelocity=!0,c.angularVelocity.copy(o.angularVelocity)):c.hasAngularVelocity=!1));l!==null&&(s=n.getPose(e.targetRaySpace,i),s===null&&o!==null&&(s=o),s!==null&&(l.matrix.fromArray(s.transform.matrix),l.matrix.decompose(l.position,l.rotation,l.scale),l.matrixWorldNeedsUpdate=!0,s.linearVelocity?(l.hasLinearVelocity=!0,l.linearVelocity.copy(s.linearVelocity)):l.hasLinearVelocity=!1,s.angularVelocity?(l.hasAngularVelocity=!0,l.angularVelocity.copy(s.angularVelocity)):l.hasAngularVelocity=!1,this.dispatchEvent(jve)))}return l!==null&&(l.visible=s!==null),c!==null&&(c.visible=o!==null),u!==null&&(u.visible=a!==null),this}_getHandJoint(e,n){if(e.joints[n.jointName]===void 0){const i=new am;i.matrixAutoUpdate=!1,i.visible=!1,e.joints[n.jointName]=i,e.add(i)}return e.joints[n.jointName]}}class QM extends Mr{constructor(){super(),this.isScene=!0,this.type="Scene",this.background=null,this.environment=null,this.fog=null,this.backgroundBlurriness=0,this.backgroundIntensity=1,this.backgroundRotation=new so,this.environmentIntensity=1,this.environmentRotation=new so,this.overrideMaterial=null,typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}copy(e,n){return super.copy(e,n),e.background!==null&&(this.background=e.background.clone()),e.environment!==null&&(this.environment=e.environment.clone()),e.fog!==null&&(this.fog=e.fog.clone()),this.backgroundBlurriness=e.backgroundBlurriness,this.backgroundIntensity=e.backgroundIntensity,this.backgroundRotation.copy(e.backgroundRotation),this.environmentIntensity=e.environmentIntensity,this.environmentRotation.copy(e.environmentRotation),e.overrideMaterial!==null&&(this.overrideMaterial=e.overrideMaterial.clone()),this.matrixAutoUpdate=e.matrixAutoUpdate,this}toJSON(e){const n=super.toJSON(e);return this.fog!==null&&(n.object.fog=this.fog.toJSON()),this.backgroundBlurriness>0&&(n.object.backgroundBlurriness=this.backgroundBlurriness),this.backgroundIntensity!==1&&(n.object.backgroundIntensity=this.backgroundIntensity),n.object.backgroundRotation=this.backgroundRotation.toArray(),this.environmentIntensity!==1&&(n.object.environmentIntensity=this.environmentIntensity),n.object.environmentRotation=this.environmentRotation.toArray(),n}}class PY{constructor(e,n){this.isInterleavedBuffer=!0,this.array=e,this.stride=n,this.count=e!==void 0?e.length/n:0,this.usage=zT,this.updateRanges=[],this.version=0,this.uuid=Hc()}onUploadCallback(){}set needsUpdate(e){e===!0&&this.version++}setUsage(e){return this.usage=e,this}addUpdateRange(e,n){this.updateRanges.push({start:e,count:n})}clearUpdateRanges(){this.updateRanges.length=0}copy(e){return this.array=new e.array.constructor(e.array),this.count=e.count,this.stride=e.stride,this.usage=e.usage,this}copyAt(e,n,i){e*=this.stride,i*=n.stride;for(let s=0,o=this.stride;s<o;s++)this.array[e+s]=n.array[i+s];return this}set(e,n=0){return this.array.set(e,n),this}clone(e){e.arrayBuffers===void 0&&(e.arrayBuffers={}),this.array.buffer._uuid===void 0&&(this.array.buffer._uuid=Hc()),e.arrayBuffers[this.array.buffer._uuid]===void 0&&(e.arrayBuffers[this.array.buffer._uuid]=this.array.slice(0).buffer);const n=new this.array.constructor(e.arrayBuffers[this.array.buffer._uuid]),i=new this.constructor(n,this.stride);return i.setUsage(this.usage),i}onUpload(e){return this.onUploadCallback=e,this}toJSON(e){return e.arrayBuffers===void 0&&(e.arrayBuffers={}),this.array.buffer._uuid===void 0&&(this.array.buffer._uuid=Hc()),e.arrayBuffers[this.array.buffer._uuid]===void 0&&(e.arrayBuffers[this.array.buffer._uuid]=Array.from(new Uint32Array(this.array.buffer))),{uuid:this.uuid,buffer:this.array.buffer._uuid,type:this.array.constructor.name,stride:this.stride}}}const hs=new K;class IF{constructor(e,n,i,s=!1){this.isInterleavedBufferAttribute=!0,this.name="",this.data=e,this.itemSize=n,this.offset=i,this.normalized=s}get count(){return this.data.count}get array(){return this.data.array}set needsUpdate(e){this.data.needsUpdate=e}applyMatrix4(e){for(let n=0,i=this.data.count;n<i;n++)hs.fromBufferAttribute(this,n),hs.applyMatrix4(e),this.setXYZ(n,hs.x,hs.y,hs.z);return this}applyNormalMatrix(e){for(let n=0,i=this.count;n<i;n++)hs.fromBufferAttribute(this,n),hs.applyNormalMatrix(e),this.setXYZ(n,hs.x,hs.y,hs.z);return this}transformDirection(e){for(let n=0,i=this.count;n<i;n++)hs.fromBufferAttribute(this,n),hs.transformDirection(e),this.setXYZ(n,hs.x,hs.y,hs.z);return this}getComponent(e,n){let i=this.array[e*this.data.stride+this.offset+n];return this.normalized&&(i=Ms(i,this.array)),i}setComponent(e,n,i){return this.normalized&&(i=Ht(i,this.array)),this.data.array[e*this.data.stride+this.offset+n]=i,this}setX(e,n){return this.normalized&&(n=Ht(n,this.array)),this.data.array[e*this.data.stride+this.offset]=n,this}setY(e,n){return this.normalized&&(n=Ht(n,this.array)),this.data.array[e*this.data.stride+this.offset+1]=n,this}setZ(e,n){return this.normalized&&(n=Ht(n,this.array)),this.data.array[e*this.data.stride+this.offset+2]=n,this}setW(e,n){return this.normalized&&(n=Ht(n,this.array)),this.data.array[e*this.data.stride+this.offset+3]=n,this}getX(e){let n=this.data.array[e*this.data.stride+this.offset];return this.normalized&&(n=Ms(n,this.array)),n}getY(e){let n=this.data.array[e*this.data.stride+this.offset+1];return this.normalized&&(n=Ms(n,this.array)),n}getZ(e){let n=this.data.array[e*this.data.stride+this.offset+2];return this.normalized&&(n=Ms(n,this.array)),n}getW(e){let n=this.data.array[e*this.data.stride+this.offset+3];return this.normalized&&(n=Ms(n,this.array)),n}setXY(e,n,i){return e=e*this.data.stride+this.offset,this.normalized&&(n=Ht(n,this.array),i=Ht(i,this.array)),this.data.array[e+0]=n,this.data.array[e+1]=i,this}setXYZ(e,n,i,s){return e=e*this.data.stride+this.offset,this.normalized&&(n=Ht(n,this.array),i=Ht(i,this.array),s=Ht(s,this.array)),this.data.array[e+0]=n,this.data.array[e+1]=i,this.data.array[e+2]=s,this}setXYZW(e,n,i,s,o){return e=e*this.data.stride+this.offset,this.normalized&&(n=Ht(n,this.array),i=Ht(i,this.array),s=Ht(s,this.array),o=Ht(o,this.array)),this.data.array[e+0]=n,this.data.array[e+1]=i,this.data.array[e+2]=s,this.data.array[e+3]=o,this}clone(e){if(e===void 0){console.log("THREE.InterleavedBufferAttribute.clone(): Cloning an interleaved buffer attribute will de-interleave buffer data.");const n=[];for(let i=0;i<this.count;i++){const s=i*this.data.stride+this.offset;for(let o=0;o<this.itemSize;o++)n.push(this.data.array[s+o])}return new hi(new this.array.constructor(n),this.itemSize,this.normalized)}else return e.interleavedBuffers===void 0&&(e.interleavedBuffers={}),e.interleavedBuffers[this.data.uuid]===void 0&&(e.interleavedBuffers[this.data.uuid]=this.data.clone(e)),new IF(e.interleavedBuffers[this.data.uuid],this.itemSize,this.offset,this.normalized)}toJSON(e){if(e===void 0){console.log("THREE.InterleavedBufferAttribute.toJSON(): Serializing an interleaved buffer attribute will de-interleave buffer data.");const n=[];for(let i=0;i<this.count;i++){const s=i*this.data.stride+this.offset;for(let o=0;o<this.itemSize;o++)n.push(this.data.array[s+o])}return{itemSize:this.itemSize,type:this.array.constructor.name,array:n,normalized:this.normalized}}else return e.interleavedBuffers===void 0&&(e.interleavedBuffers={}),e.interleavedBuffers[this.data.uuid]===void 0&&(e.interleavedBuffers[this.data.uuid]=this.data.toJSON(e)),{isInterleavedBufferAttribute:!0,itemSize:this.itemSize,data:this.data.uuid,offset:this.offset,normalized:this.normalized}}}class Vve extends cs{constructor(e){super(),this.isSpriteMaterial=!0,this.type="SpriteMaterial",this.color=new pt(16777215),this.map=null,this.alphaMap=null,this.rotation=0,this.sizeAttenuation=!0,this.transparent=!0,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.alphaMap=e.alphaMap,this.rotation=e.rotation,this.sizeAttenuation=e.sizeAttenuation,this.fog=e.fog,this}}class Gve extends ui{constructor(e=null,n=1,i=1,s,o,a,l,c,u=jn,h=jn,f,d){super(null,a,l,c,u,h,s,o,f,d),this.isDataTexture=!0,this.image={data:e,width:n,height:i},this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}class Hve extends hi{constructor(e,n,i,s=1){super(e,n,i),this.isInstancedBufferAttribute=!0,this.meshPerAttribute=s}copy(e){return super.copy(e),this.meshPerAttribute=e.meshPerAttribute,this}toJSON(){const e=super.toJSON();return e.meshPerAttribute=this.meshPerAttribute,e.isInstancedBufferAttribute=!0,e}}const dR=new K,Wve=new K,qve=new Bt;class To{constructor(e=new K(1,0,0),n=0){this.isPlane=!0,this.normal=e,this.constant=n}set(e,n){return this.normal.copy(e),this.constant=n,this}setComponents(e,n,i,s){return this.normal.set(e,n,i),this.constant=s,this}setFromNormalAndCoplanarPoint(e,n){return this.normal.copy(e),this.constant=-n.dot(this.normal),this}setFromCoplanarPoints(e,n,i){const s=dR.subVectors(i,n).cross(Wve.subVectors(e,n)).normalize();return this.setFromNormalAndCoplanarPoint(s,e),this}copy(e){return this.normal.copy(e.normal),this.constant=e.constant,this}normalize(){const e=1/this.normal.length();return this.normal.multiplyScalar(e),this.constant*=e,this}negate(){return this.constant*=-1,this.normal.negate(),this}distanceToPoint(e){return this.normal.dot(e)+this.constant}distanceToSphere(e){return this.distanceToPoint(e.center)-e.radius}projectPoint(e,n){return n.copy(e).addScaledVector(this.normal,-this.distanceToPoint(e))}intersectLine(e,n){const i=e.delta(dR),s=this.normal.dot(i);if(s===0)return this.distanceToPoint(e.start)===0?n.copy(e.start):null;const o=-(e.start.dot(this.normal)+this.constant)/s;return o<0||o>1?null:n.copy(e.start).addScaledVector(i,o)}intersectsLine(e){const n=this.distanceToPoint(e.start),i=this.distanceToPoint(e.end);return n<0&&i>0||i<0&&n>0}intersectsBox(e){return e.intersectsPlane(this)}intersectsSphere(e){return e.intersectsPlane(this)}coplanarPoint(e){return e.copy(this.normal).multiplyScalar(-this.constant)}applyMatrix4(e,n){const i=n||qve.getNormalMatrix(e),s=this.coplanarPoint(dR).applyMatrix4(e),o=this.normal.applyMatrix3(i).normalize();return this.constant=-s.dot(o),this}translate(e){return this.constant-=e.dot(this.normal),this}equals(e){return e.normal.equals(this.normal)&&e.constant===this.constant}clone(){return new this.constructor().copy(this)}}const cf=new f_,cS=new K;class d_{constructor(e=new To,n=new To,i=new To,s=new To,o=new To,a=new To){this.planes=[e,n,i,s,o,a]}set(e,n,i,s,o,a){const l=this.planes;return l[0].copy(e),l[1].copy(n),l[2].copy(i),l[3].copy(s),l[4].copy(o),l[5].copy(a),this}copy(e){const n=this.planes;for(let i=0;i<6;i++)n[i].copy(e.planes[i]);return this}setFromProjectionMatrix(e,n=Ps){const i=this.planes,s=e.elements,o=s[0],a=s[1],l=s[2],c=s[3],u=s[4],h=s[5],f=s[6],d=s[7],p=s[8],m=s[9],g=s[10],v=s[11],y=s[12],x=s[13],b=s[14],w=s[15];if(i[0].setComponents(c-o,d-u,v-p,w-y).normalize(),i[1].setComponents(c+o,d+u,v+p,w+y).normalize(),i[2].setComponents(c+a,d+h,v+m,w+x).normalize(),i[3].setComponents(c-a,d-h,v-m,w-x).normalize(),i[4].setComponents(c-l,d-f,v-g,w-b).normalize(),n===Ps)i[5].setComponents(c+l,d+f,v+g,w+b).normalize();else if(n===Ph)i[5].setComponents(l,f,g,b).normalize();else throw new Error("THREE.Frustum.setFromProjectionMatrix(): Invalid coordinate system: "+n);return this}intersectsObject(e){if(e.boundingSphere!==void 0)e.boundingSphere===null&&e.computeBoundingSphere(),cf.copy(e.boundingSphere).applyMatrix4(e.matrixWorld);else{const n=e.geometry;n.boundingSphere===null&&n.computeBoundingSphere(),cf.copy(n.boundingSphere).applyMatrix4(e.matrixWorld)}return this.intersectsSphere(cf)}intersectsSprite(e){return cf.center.set(0,0,0),cf.radius=.7071067811865476,cf.applyMatrix4(e.matrixWorld),this.intersectsSphere(cf)}intersectsSphere(e){const n=this.planes,i=e.center,s=-e.radius;for(let o=0;o<6;o++)if(n[o].distanceToPoint(i)<s)return!1;return!0}intersectsBox(e){const n=this.planes;for(let i=0;i<6;i++){const s=n[i];if(cS.x=s.normal.x>0?e.max.x:e.min.x,cS.y=s.normal.y>0?e.max.y:e.min.y,cS.z=s.normal.z>0?e.max.z:e.min.z,s.distanceToPoint(cS)<0)return!1}return!0}containsPoint(e){const n=this.planes;for(let i=0;i<6;i++)if(n[i].distanceToPoint(e)<0)return!1;return!0}clone(){return new this.constructor().copy(this)}}const ul=new sn,hl=new d_;class LF{constructor(){this.coordinateSystem=Ps}intersectsObject(e,n){if(!n.isArrayCamera||n.cameras.length===0)return!1;for(let i=0;i<n.cameras.length;i++){const s=n.cameras[i];if(ul.multiplyMatrices(s.projectionMatrix,s.matrixWorldInverse),hl.setFromProjectionMatrix(ul,this.coordinateSystem),hl.intersectsObject(e))return!0}return!1}intersectsSprite(e,n){if(!n||!n.cameras||n.cameras.length===0)return!1;for(let i=0;i<n.cameras.length;i++){const s=n.cameras[i];if(ul.multiplyMatrices(s.projectionMatrix,s.matrixWorldInverse),hl.setFromProjectionMatrix(ul,this.coordinateSystem),hl.intersectsSprite(e))return!0}return!1}intersectsSphere(e,n){if(!n||!n.cameras||n.cameras.length===0)return!1;for(let i=0;i<n.cameras.length;i++){const s=n.cameras[i];if(ul.multiplyMatrices(s.projectionMatrix,s.matrixWorldInverse),hl.setFromProjectionMatrix(ul,this.coordinateSystem),hl.intersectsSphere(e))return!0}return!1}intersectsBox(e,n){if(!n||!n.cameras||n.cameras.length===0)return!1;for(let i=0;i<n.cameras.length;i++){const s=n.cameras[i];if(ul.multiplyMatrices(s.projectionMatrix,s.matrixWorldInverse),hl.setFromProjectionMatrix(ul,this.coordinateSystem),hl.intersectsBox(e))return!0}return!1}containsPoint(e,n){if(!n||!n.cameras||n.cameras.length===0)return!1;for(let i=0;i<n.cameras.length;i++){const s=n.cameras[i];if(ul.multiplyMatrices(s.projectionMatrix,s.matrixWorldInverse),hl.setFromProjectionMatrix(ul,this.coordinateSystem),hl.containsPoint(e))return!0}return!1}clone(){return new LF}}class p_ extends cs{constructor(e){super(),this.isLineBasicMaterial=!0,this.type="LineBasicMaterial",this.color=new pt(16777215),this.map=null,this.linewidth=1,this.linecap="round",this.linejoin="round",this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.linewidth=e.linewidth,this.linecap=e.linecap,this.linejoin=e.linejoin,this.fog=e.fog,this}}const jT=new K,VT=new K,AV=new sn,fv=new YM,uS=new f_,pR=new K,CV=new K;let RY=class extends Mr{constructor(e=new ji,n=new p_){super(),this.isLine=!0,this.type="Line",this.geometry=e,this.material=n,this.morphTargetDictionary=void 0,this.morphTargetInfluences=void 0,this.updateMorphTargets()}copy(e,n){return super.copy(e,n),this.material=Array.isArray(e.material)?e.material.slice():e.material,this.geometry=e.geometry,this}computeLineDistances(){const e=this.geometry;if(e.index===null){const n=e.attributes.position,i=[0];for(let s=1,o=n.count;s<o;s++)jT.fromBufferAttribute(n,s-1),VT.fromBufferAttribute(n,s),i[s]=i[s-1],i[s]+=jT.distanceTo(VT);e.setAttribute("lineDistance",new Dr(i,1))}else console.warn("THREE.Line.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");return this}raycast(e,n){const i=this.geometry,s=this.matrixWorld,o=e.params.Line.threshold,a=i.drawRange;if(i.boundingSphere===null&&i.computeBoundingSphere(),uS.copy(i.boundingSphere),uS.applyMatrix4(s),uS.radius+=o,e.ray.intersectsSphere(uS)===!1)return;AV.copy(s).invert(),fv.copy(e.ray).applyMatrix4(AV);const l=o/((this.scale.x+this.scale.y+this.scale.z)/3),c=l*l,u=this.isLineSegments?2:1,h=i.index,d=i.attributes.position;if(h!==null){const p=Math.max(0,a.start),m=Math.min(h.count,a.start+a.count);for(let g=p,v=m-1;g<v;g+=u){const y=h.getX(g),x=h.getX(g+1),b=hS(this,e,fv,c,y,x,g);b&&n.push(b)}if(this.isLineLoop){const g=h.getX(m-1),v=h.getX(p),y=hS(this,e,fv,c,g,v,m-1);y&&n.push(y)}}else{const p=Math.max(0,a.start),m=Math.min(d.count,a.start+a.count);for(let g=p,v=m-1;g<v;g+=u){const y=hS(this,e,fv,c,g,g+1,g);y&&n.push(y)}if(this.isLineLoop){const g=hS(this,e,fv,c,m-1,p,m-1);g&&n.push(g)}}}updateMorphTargets(){const n=this.geometry.morphAttributes,i=Object.keys(n);if(i.length>0){const s=n[i[0]];if(s!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let o=0,a=s.length;o<a;o++){const l=s[o].name||String(o);this.morphTargetInfluences.push(0),this.morphTargetDictionary[l]=o}}}}};function hS(r,e,n,i,s,o,a){const l=r.geometry.attributes.position;if(jT.fromBufferAttribute(l,s),VT.fromBufferAttribute(l,o),n.distanceSqToSegment(jT,VT,pR,CV)>i)return;pR.applyMatrix4(r.matrixWorld);const u=e.ray.origin.distanceTo(pR);if(!(u<e.near||u>e.far))return{distance:u,point:CV.clone().applyMatrix4(r.matrixWorld),index:a,face:null,faceIndex:null,barycoord:null,object:r}}class Xve extends cs{constructor(e){super(),this.isPointsMaterial=!0,this.type="PointsMaterial",this.color=new pt(16777215),this.map=null,this.alphaMap=null,this.size=1,this.sizeAttenuation=!0,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.alphaMap=e.alphaMap,this.size=e.size,this.sizeAttenuation=e.sizeAttenuation,this.fog=e.fog,this}}class Kve extends ui{constructor(e,n){super({width:e,height:n}),this.isFramebufferTexture=!0,this.magFilter=jn,this.minFilter=jn,this.generateMipmaps=!1,this.needsUpdate=!0}}class ko extends ui{constructor(e,n,i=In,s,o,a,l=jn,c=jn,u,h=Oo){if(h!==Oo&&h!==Do)throw new Error("DepthTexture format must be either THREE.DepthFormat or THREE.DepthStencilFormat");super(null,s,o,a,l,c,h,i,u),this.isDepthTexture=!0,this.image={width:e,height:n},this.flipY=!1,this.generateMipmaps=!1,this.compareFunction=null}copy(e){return super.copy(e),this.source=new RF(Object.assign({},e.image)),this.compareFunction=e.compareFunction,this}toJSON(e){const n=super.toJSON(e);return this.compareFunction!==null&&(n.compareFunction=this.compareFunction),n}}class NY extends ko{constructor(e=1,n=1,i=1){super(e,n),this.isDepthArrayTexture=!0,this.image={width:e,height:n,depth:i},this.flipY=!1,this.generateMipmaps=!1,this.compareFunction=null,this.layerUpdates=new Set}addLayerUpdate(e){this.layerUpdates.add(e)}clearLayerUpdates(){this.layerUpdates.clear()}}class m_ extends ji{constructor(e=1,n=1,i=1,s=32,o=1,a=!1,l=0,c=Math.PI*2){super(),this.type="CylinderGeometry",this.parameters={radiusTop:e,radiusBottom:n,height:i,radialSegments:s,heightSegments:o,openEnded:a,thetaStart:l,thetaLength:c};const u=this;s=Math.floor(s),o=Math.floor(o);const h=[],f=[],d=[],p=[];let m=0;const g=[],v=i/2;let y=0;x(),a===!1&&(e>0&&b(!0),n>0&&b(!1)),this.setIndex(h),this.setAttribute("position",new Dr(f,3)),this.setAttribute("normal",new Dr(d,3)),this.setAttribute("uv",new Dr(p,2));function x(){const w=new K,_=new K;let S=0;const T=(n-e)/i;for(let E=0;E<=o;E++){const M=[],A=E/o,P=A*(n-e)+e;for(let D=0;D<=s;D++){const B=D/s,C=B*c+l,O=Math.sin(C),R=Math.cos(C);_.x=P*O,_.y=-A*i+v,_.z=P*R,f.push(_.x,_.y,_.z),w.set(O,T,R).normalize(),d.push(w.x,w.y,w.z),p.push(B,1-A),M.push(m++)}g.push(M)}for(let E=0;E<s;E++)for(let M=0;M<o;M++){const A=g[M][E],P=g[M+1][E],D=g[M+1][E+1],B=g[M][E+1];(e>0||M!==0)&&(h.push(A,P,B),S+=3),(n>0||M!==o-1)&&(h.push(P,D,B),S+=3)}u.addGroup(y,S,0),y+=S}function b(w){const _=m,S=new Fe,T=new K;let E=0;const M=w===!0?e:n,A=w===!0?1:-1;for(let D=1;D<=s;D++)f.push(0,v*A,0),d.push(0,A,0),p.push(.5,.5),m++;const P=m;for(let D=0;D<=s;D++){const C=D/s*c+l,O=Math.cos(C),R=Math.sin(C);T.x=M*R,T.y=v*A,T.z=M*O,f.push(T.x,T.y,T.z),d.push(0,A,0),S.x=O*.5+.5,S.y=R*.5*A+.5,p.push(S.x,S.y),m++}for(let D=0;D<s;D++){const B=_+D,C=P+D;w===!0?h.push(C,C+1,B):h.push(C+1,C,B),E+=3}u.addGroup(y,E,w===!0?1:2),y+=E}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new m_(e.radiusTop,e.radiusBottom,e.height,e.radialSegments,e.heightSegments,e.openEnded,e.thetaStart,e.thetaLength)}}class FF extends m_{constructor(e=1,n=1,i=32,s=1,o=!1,a=0,l=Math.PI*2){super(0,e,n,i,s,o,a,l),this.type="ConeGeometry",this.parameters={radius:e,height:n,radialSegments:i,heightSegments:s,openEnded:o,thetaStart:a,thetaLength:l}}static fromJSON(e){return new FF(e.radius,e.height,e.radialSegments,e.heightSegments,e.openEnded,e.thetaStart,e.thetaLength)}}let yu=class{constructor(){this.type="Curve",this.arcLengthDivisions=200,this.needsUpdate=!1,this.cacheArcLengths=null}getPoint(){console.warn("THREE.Curve: .getPoint() not implemented.")}getPointAt(e,n){const i=this.getUtoTmapping(e);return this.getPoint(i,n)}getPoints(e=5){const n=[];for(let i=0;i<=e;i++)n.push(this.getPoint(i/e));return n}getSpacedPoints(e=5){const n=[];for(let i=0;i<=e;i++)n.push(this.getPointAt(i/e));return n}getLength(){const e=this.getLengths();return e[e.length-1]}getLengths(e=this.arcLengthDivisions){if(this.cacheArcLengths&&this.cacheArcLengths.length===e+1&&!this.needsUpdate)return this.cacheArcLengths;this.needsUpdate=!1;const n=[];let i,s=this.getPoint(0),o=0;n.push(0);for(let a=1;a<=e;a++)i=this.getPoint(a/e),o+=i.distanceTo(s),n.push(o),s=i;return this.cacheArcLengths=n,n}updateArcLengths(){this.needsUpdate=!0,this.getLengths()}getUtoTmapping(e,n=null){const i=this.getLengths();let s=0;const o=i.length;let a;n?a=n:a=e*i[o-1];let l=0,c=o-1,u;for(;l<=c;)if(s=Math.floor(l+(c-l)/2),u=i[s]-a,u<0)l=s+1;else if(u>0)c=s-1;else{c=s;break}if(s=c,i[s]===a)return s/(o-1);const h=i[s],d=i[s+1]-h,p=(a-h)/d;return(s+p)/(o-1)}getTangent(e,n){let s=e-1e-4,o=e+1e-4;s<0&&(s=0),o>1&&(o=1);const a=this.getPoint(s),l=this.getPoint(o),c=n||(a.isVector2?new Fe:new K);return c.copy(l).sub(a).normalize(),c}getTangentAt(e,n){const i=this.getUtoTmapping(e);return this.getTangent(i,n)}computeFrenetFrames(e,n=!1){const i=new K,s=[],o=[],a=[],l=new K,c=new sn;for(let p=0;p<=e;p++){const m=p/e;s[p]=this.getTangentAt(m,new K)}o[0]=new K,a[0]=new K;let u=Number.MAX_VALUE;const h=Math.abs(s[0].x),f=Math.abs(s[0].y),d=Math.abs(s[0].z);h<=u&&(u=h,i.set(1,0,0)),f<=u&&(u=f,i.set(0,1,0)),d<=u&&i.set(0,0,1),l.crossVectors(s[0],i).normalize(),o[0].crossVectors(s[0],l),a[0].crossVectors(s[0],o[0]);for(let p=1;p<=e;p++){if(o[p]=o[p-1].clone(),a[p]=a[p-1].clone(),l.crossVectors(s[p-1],s[p]),l.length()>Number.EPSILON){l.normalize();const m=Math.acos(Wt(s[p-1].dot(s[p]),-1,1));o[p].applyMatrix4(c.makeRotationAxis(l,m))}a[p].crossVectors(s[p],o[p])}if(n===!0){let p=Math.acos(Wt(o[0].dot(o[e]),-1,1));p/=e,s[0].dot(l.crossVectors(o[0],o[e]))>0&&(p=-p);for(let m=1;m<=e;m++)o[m].applyMatrix4(c.makeRotationAxis(s[m],p*m)),a[m].crossVectors(s[m],o[m])}return{tangents:s,normals:o,binormals:a}}clone(){return new this.constructor().copy(this)}copy(e){return this.arcLengthDivisions=e.arcLengthDivisions,this}toJSON(){const e={metadata:{version:4.6,type:"Curve",generator:"Curve.toJSON"}};return e.arcLengthDivisions=this.arcLengthDivisions,e.type=this.type,e}fromJSON(e){return this.arcLengthDivisions=e.arcLengthDivisions,this}};class OY extends yu{constructor(e=0,n=0,i=1,s=1,o=0,a=Math.PI*2,l=!1,c=0){super(),this.isEllipseCurve=!0,this.type="EllipseCurve",this.aX=e,this.aY=n,this.xRadius=i,this.yRadius=s,this.aStartAngle=o,this.aEndAngle=a,this.aClockwise=l,this.aRotation=c}getPoint(e,n=new Fe){const i=n,s=Math.PI*2;let o=this.aEndAngle-this.aStartAngle;const a=Math.abs(o)<Number.EPSILON;for(;o<0;)o+=s;for(;o>s;)o-=s;o<Number.EPSILON&&(a?o=0:o=s),this.aClockwise===!0&&!a&&(o===s?o=-s:o=o-s);const l=this.aStartAngle+e*o;let c=this.aX+this.xRadius*Math.cos(l),u=this.aY+this.yRadius*Math.sin(l);if(this.aRotation!==0){const h=Math.cos(this.aRotation),f=Math.sin(this.aRotation),d=c-this.aX,p=u-this.aY;c=d*h-p*f+this.aX,u=d*f+p*h+this.aY}return i.set(c,u)}copy(e){return super.copy(e),this.aX=e.aX,this.aY=e.aY,this.xRadius=e.xRadius,this.yRadius=e.yRadius,this.aStartAngle=e.aStartAngle,this.aEndAngle=e.aEndAngle,this.aClockwise=e.aClockwise,this.aRotation=e.aRotation,this}toJSON(){const e=super.toJSON();return e.aX=this.aX,e.aY=this.aY,e.xRadius=this.xRadius,e.yRadius=this.yRadius,e.aStartAngle=this.aStartAngle,e.aEndAngle=this.aEndAngle,e.aClockwise=this.aClockwise,e.aRotation=this.aRotation,e}fromJSON(e){return super.fromJSON(e),this.aX=e.aX,this.aY=e.aY,this.xRadius=e.xRadius,this.yRadius=e.yRadius,this.aStartAngle=e.aStartAngle,this.aEndAngle=e.aEndAngle,this.aClockwise=e.aClockwise,this.aRotation=e.aRotation,this}}class Yve extends OY{constructor(e,n,i,s,o,a){super(e,n,i,i,s,o,a),this.isArcCurve=!0,this.type="ArcCurve"}}function BF(){let r=0,e=0,n=0,i=0;function s(o,a,l,c){r=o,e=l,n=-3*o+3*a-2*l-c,i=2*o-2*a+l+c}return{initCatmullRom:function(o,a,l,c,u){s(a,l,u*(l-o),u*(c-a))},initNonuniformCatmullRom:function(o,a,l,c,u,h,f){let d=(a-o)/u-(l-o)/(u+h)+(l-a)/h,p=(l-a)/h-(c-a)/(h+f)+(c-l)/f;d*=h,p*=h,s(a,l,d,p)},calc:function(o){const a=o*o,l=a*o;return r+e*o+n*a+i*l}}}const fS=new K,mR=new BF,gR=new BF,yR=new BF;class Zve extends yu{constructor(e=[],n=!1,i="centripetal",s=.5){super(),this.isCatmullRomCurve3=!0,this.type="CatmullRomCurve3",this.points=e,this.closed=n,this.curveType=i,this.tension=s}getPoint(e,n=new K){const i=n,s=this.points,o=s.length,a=(o-(this.closed?0:1))*e;let l=Math.floor(a),c=a-l;this.closed?l+=l>0?0:(Math.floor(Math.abs(l)/o)+1)*o:c===0&&l===o-1&&(l=o-2,c=1);let u,h;this.closed||l>0?u=s[(l-1)%o]:(fS.subVectors(s[0],s[1]).add(s[0]),u=fS);const f=s[l%o],d=s[(l+1)%o];if(this.closed||l+2<o?h=s[(l+2)%o]:(fS.subVectors(s[o-1],s[o-2]).add(s[o-1]),h=fS),this.curveType==="centripetal"||this.curveType==="chordal"){const p=this.curveType==="chordal"?.5:.25;let m=Math.pow(u.distanceToSquared(f),p),g=Math.pow(f.distanceToSquared(d),p),v=Math.pow(d.distanceToSquared(h),p);g<1e-4&&(g=1),m<1e-4&&(m=g),v<1e-4&&(v=g),mR.initNonuniformCatmullRom(u.x,f.x,d.x,h.x,m,g,v),gR.initNonuniformCatmullRom(u.y,f.y,d.y,h.y,m,g,v),yR.initNonuniformCatmullRom(u.z,f.z,d.z,h.z,m,g,v)}else this.curveType==="catmullrom"&&(mR.initCatmullRom(u.x,f.x,d.x,h.x,this.tension),gR.initCatmullRom(u.y,f.y,d.y,h.y,this.tension),yR.initCatmullRom(u.z,f.z,d.z,h.z,this.tension));return i.set(mR.calc(c),gR.calc(c),yR.calc(c)),i}copy(e){super.copy(e),this.points=[];for(let n=0,i=e.points.length;n<i;n++){const s=e.points[n];this.points.push(s.clone())}return this.closed=e.closed,this.curveType=e.curveType,this.tension=e.tension,this}toJSON(){const e=super.toJSON();e.points=[];for(let n=0,i=this.points.length;n<i;n++){const s=this.points[n];e.points.push(s.toArray())}return e.closed=this.closed,e.curveType=this.curveType,e.tension=this.tension,e}fromJSON(e){super.fromJSON(e),this.points=[];for(let n=0,i=e.points.length;n<i;n++){const s=e.points[n];this.points.push(new K().fromArray(s))}return this.closed=e.closed,this.curveType=e.curveType,this.tension=e.tension,this}}function PV(r,e,n,i,s){const o=(i-e)*.5,a=(s-n)*.5,l=r*r,c=r*l;return(2*n-2*i+o+a)*c+(-3*n+3*i-2*o-a)*l+o*r+n}function Qve(r,e){const n=1-r;return n*n*e}function Jve(r,e){return 2*(1-r)*r*e}function e0e(r,e){return r*r*e}function F0(r,e,n,i){return Qve(r,e)+Jve(r,n)+e0e(r,i)}function t0e(r,e){const n=1-r;return n*n*n*e}function n0e(r,e){const n=1-r;return 3*n*n*r*e}function r0e(r,e){return 3*(1-r)*r*r*e}function i0e(r,e){return r*r*r*e}function B0(r,e,n,i,s){return t0e(r,e)+n0e(r,n)+r0e(r,i)+i0e(r,s)}class s0e extends yu{constructor(e=new Fe,n=new Fe,i=new Fe,s=new Fe){super(),this.isCubicBezierCurve=!0,this.type="CubicBezierCurve",this.v0=e,this.v1=n,this.v2=i,this.v3=s}getPoint(e,n=new Fe){const i=n,s=this.v0,o=this.v1,a=this.v2,l=this.v3;return i.set(B0(e,s.x,o.x,a.x,l.x),B0(e,s.y,o.y,a.y,l.y)),i}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this.v3.copy(e.v3),this}toJSON(){const e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e.v3=this.v3.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this.v3.fromArray(e.v3),this}}class DY extends yu{constructor(e=new K,n=new K,i=new K,s=new K){super(),this.isCubicBezierCurve3=!0,this.type="CubicBezierCurve3",this.v0=e,this.v1=n,this.v2=i,this.v3=s}getPoint(e,n=new K){const i=n,s=this.v0,o=this.v1,a=this.v2,l=this.v3;return i.set(B0(e,s.x,o.x,a.x,l.x),B0(e,s.y,o.y,a.y,l.y),B0(e,s.z,o.z,a.z,l.z)),i}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this.v3.copy(e.v3),this}toJSON(){const e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e.v3=this.v3.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this.v3.fromArray(e.v3),this}}class o0e extends yu{constructor(e=new Fe,n=new Fe){super(),this.isLineCurve=!0,this.type="LineCurve",this.v1=e,this.v2=n}getPoint(e,n=new Fe){const i=n;return e===1?i.copy(this.v2):(i.copy(this.v2).sub(this.v1),i.multiplyScalar(e).add(this.v1)),i}getPointAt(e,n){return this.getPoint(e,n)}getTangent(e,n=new Fe){return n.subVectors(this.v2,this.v1).normalize()}getTangentAt(e,n){return this.getTangent(e,n)}copy(e){return super.copy(e),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){const e=super.toJSON();return e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}class a0e extends yu{constructor(e=new K,n=new K){super(),this.isLineCurve3=!0,this.type="LineCurve3",this.v1=e,this.v2=n}getPoint(e,n=new K){const i=n;return e===1?i.copy(this.v2):(i.copy(this.v2).sub(this.v1),i.multiplyScalar(e).add(this.v1)),i}getPointAt(e,n){return this.getPoint(e,n)}getTangent(e,n=new K){return n.subVectors(this.v2,this.v1).normalize()}getTangentAt(e,n){return this.getTangent(e,n)}copy(e){return super.copy(e),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){const e=super.toJSON();return e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}class l0e extends yu{constructor(e=new Fe,n=new Fe,i=new Fe){super(),this.isQuadraticBezierCurve=!0,this.type="QuadraticBezierCurve",this.v0=e,this.v1=n,this.v2=i}getPoint(e,n=new Fe){const i=n,s=this.v0,o=this.v1,a=this.v2;return i.set(F0(e,s.x,o.x,a.x),F0(e,s.y,o.y,a.y)),i}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){const e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}class UF extends yu{constructor(e=new K,n=new K,i=new K){super(),this.isQuadraticBezierCurve3=!0,this.type="QuadraticBezierCurve3",this.v0=e,this.v1=n,this.v2=i}getPoint(e,n=new K){const i=n,s=this.v0,o=this.v1,a=this.v2;return i.set(F0(e,s.x,o.x,a.x),F0(e,s.y,o.y,a.y),F0(e,s.z,o.z,a.z)),i}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){const e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}class c0e extends yu{constructor(e=[]){super(),this.isSplineCurve=!0,this.type="SplineCurve",this.points=e}getPoint(e,n=new Fe){const i=n,s=this.points,o=(s.length-1)*e,a=Math.floor(o),l=o-a,c=s[a===0?a:a-1],u=s[a],h=s[a>s.length-2?s.length-1:a+1],f=s[a>s.length-3?s.length-1:a+2];return i.set(PV(l,c.x,u.x,h.x,f.x),PV(l,c.y,u.y,h.y,f.y)),i}copy(e){super.copy(e),this.points=[];for(let n=0,i=e.points.length;n<i;n++){const s=e.points[n];this.points.push(s.clone())}return this}toJSON(){const e=super.toJSON();e.points=[];for(let n=0,i=this.points.length;n<i;n++){const s=this.points[n];e.points.push(s.toArray())}return e}fromJSON(e){super.fromJSON(e),this.points=[];for(let n=0,i=e.points.length;n<i;n++){const s=e.points[n];this.points.push(new Fe().fromArray(s))}return this}}var u0e=Object.freeze({__proto__:null,ArcCurve:Yve,CatmullRomCurve3:Zve,CubicBezierCurve:s0e,CubicBezierCurve3:DY,EllipseCurve:OY,LineCurve:o0e,LineCurve3:a0e,QuadraticBezierCurve:l0e,QuadraticBezierCurve3:UF,SplineCurve:c0e});class g_ extends ji{constructor(e=1,n=1,i=1,s=1){super(),this.type="PlaneGeometry",this.parameters={width:e,height:n,widthSegments:i,heightSegments:s};const o=e/2,a=n/2,l=Math.floor(i),c=Math.floor(s),u=l+1,h=c+1,f=e/l,d=n/c,p=[],m=[],g=[],v=[];for(let y=0;y<h;y++){const x=y*d-a;for(let b=0;b<u;b++){const w=b*f-o;m.push(w,-x,0),g.push(0,0,1),v.push(b/l),v.push(1-y/c)}}for(let y=0;y<c;y++)for(let x=0;x<l;x++){const b=x+u*y,w=x+u*(y+1),_=x+1+u*(y+1),S=x+1+u*y;p.push(b,w,S),p.push(w,_,S)}this.setIndex(p),this.setAttribute("position",new Dr(m,3)),this.setAttribute("normal",new Dr(g,3)),this.setAttribute("uv",new Dr(v,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new g_(e.width,e.height,e.widthSegments,e.heightSegments)}}class xd extends ji{constructor(e=1,n=32,i=16,s=0,o=Math.PI*2,a=0,l=Math.PI){super(),this.type="SphereGeometry",this.parameters={radius:e,widthSegments:n,heightSegments:i,phiStart:s,phiLength:o,thetaStart:a,thetaLength:l},n=Math.max(3,Math.floor(n)),i=Math.max(2,Math.floor(i));const c=Math.min(a+l,Math.PI);let u=0;const h=[],f=new K,d=new K,p=[],m=[],g=[],v=[];for(let y=0;y<=i;y++){const x=[],b=y/i;let w=0;y===0&&a===0?w=.5/n:y===i&&c===Math.PI&&(w=-.5/n);for(let _=0;_<=n;_++){const S=_/n;f.x=-e*Math.cos(s+S*o)*Math.sin(a+b*l),f.y=e*Math.cos(a+b*l),f.z=e*Math.sin(s+S*o)*Math.sin(a+b*l),m.push(f.x,f.y,f.z),d.copy(f).normalize(),g.push(d.x,d.y,d.z),v.push(S+w,1-b),x.push(u++)}h.push(x)}for(let y=0;y<i;y++)for(let x=0;x<n;x++){const b=h[y][x+1],w=h[y][x],_=h[y+1][x],S=h[y+1][x+1];(y!==0||a>0)&&p.push(b,w,S),(y!==i-1||c<Math.PI)&&p.push(w,_,S)}this.setIndex(p),this.setAttribute("position",new Dr(m,3)),this.setAttribute("normal",new Dr(g,3)),this.setAttribute("uv",new Dr(v,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new xd(e.radius,e.widthSegments,e.heightSegments,e.phiStart,e.phiLength,e.thetaStart,e.thetaLength)}}class zF extends ji{constructor(e=new UF(new K(-1,-1,0),new K(-1,1,0),new K(1,1,0)),n=64,i=1,s=8,o=!1){super(),this.type="TubeGeometry",this.parameters={path:e,tubularSegments:n,radius:i,radialSegments:s,closed:o};const a=e.computeFrenetFrames(n,o);this.tangents=a.tangents,this.normals=a.normals,this.binormals=a.binormals;const l=new K,c=new K,u=new Fe;let h=new K;const f=[],d=[],p=[],m=[];g(),this.setIndex(m),this.setAttribute("position",new Dr(f,3)),this.setAttribute("normal",new Dr(d,3)),this.setAttribute("uv",new Dr(p,2));function g(){for(let b=0;b<n;b++)v(b);v(o===!1?n:0),x(),y()}function v(b){h=e.getPointAt(b/n,h);const w=a.normals[b],_=a.binormals[b];for(let S=0;S<=s;S++){const T=S/s*Math.PI*2,E=Math.sin(T),M=-Math.cos(T);c.x=M*w.x+E*_.x,c.y=M*w.y+E*_.y,c.z=M*w.z+E*_.z,c.normalize(),d.push(c.x,c.y,c.z),l.x=h.x+i*c.x,l.y=h.y+i*c.y,l.z=h.z+i*c.z,f.push(l.x,l.y,l.z)}}function y(){for(let b=1;b<=n;b++)for(let w=1;w<=s;w++){const _=(s+1)*(b-1)+(w-1),S=(s+1)*b+(w-1),T=(s+1)*b+w,E=(s+1)*(b-1)+w;m.push(_,S,E),m.push(S,T,E)}}function x(){for(let b=0;b<=n;b++)for(let w=0;w<=s;w++)u.x=b/n,u.y=w/s,p.push(u.x,u.y)}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}toJSON(){const e=super.toJSON();return e.path=this.parameters.path.toJSON(),e}static fromJSON(e){return new zF(new u0e[e.path.type]().fromJSON(e.path),e.tubularSegments,e.radius,e.radialSegments,e.closed)}}class h0e extends cs{constructor(e){super(),this.isShadowMaterial=!0,this.type="ShadowMaterial",this.color=new pt(0),this.transparent=!0,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.fog=e.fog,this}}class kY extends cs{constructor(e){super(),this.isMeshStandardMaterial=!0,this.type="MeshStandardMaterial",this.defines={STANDARD:""},this.color=new pt(16777215),this.roughness=1,this.metalness=0,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new pt(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=ou,this.normalScale=new Fe(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.roughnessMap=null,this.metalnessMap=null,this.alphaMap=null,this.envMap=null,this.envMapRotation=new so,this.envMapIntensity=1,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.defines={STANDARD:""},this.color.copy(e.color),this.roughness=e.roughness,this.metalness=e.metalness,this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.roughnessMap=e.roughnessMap,this.metalnessMap=e.metalnessMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.envMapRotation.copy(e.envMapRotation),this.envMapIntensity=e.envMapIntensity,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.flatShading=e.flatShading,this.fog=e.fog,this}}class f0e extends kY{constructor(e){super(),this.isMeshPhysicalMaterial=!0,this.defines={STANDARD:"",PHYSICAL:""},this.type="MeshPhysicalMaterial",this.anisotropyRotation=0,this.anisotropyMap=null,this.clearcoatMap=null,this.clearcoatRoughness=0,this.clearcoatRoughnessMap=null,this.clearcoatNormalScale=new Fe(1,1),this.clearcoatNormalMap=null,this.ior=1.5,Object.defineProperty(this,"reflectivity",{get:function(){return Wt(2.5*(this.ior-1)/(this.ior+1),0,1)},set:function(n){this.ior=(1+.4*n)/(1-.4*n)}}),this.iridescenceMap=null,this.iridescenceIOR=1.3,this.iridescenceThicknessRange=[100,400],this.iridescenceThicknessMap=null,this.sheenColor=new pt(0),this.sheenColorMap=null,this.sheenRoughness=1,this.sheenRoughnessMap=null,this.transmissionMap=null,this.thickness=0,this.thicknessMap=null,this.attenuationDistance=1/0,this.attenuationColor=new pt(1,1,1),this.specularIntensity=1,this.specularIntensityMap=null,this.specularColor=new pt(1,1,1),this.specularColorMap=null,this._anisotropy=0,this._clearcoat=0,this._dispersion=0,this._iridescence=0,this._sheen=0,this._transmission=0,this.setValues(e)}get anisotropy(){return this._anisotropy}set anisotropy(e){this._anisotropy>0!=e>0&&this.version++,this._anisotropy=e}get clearcoat(){return this._clearcoat}set clearcoat(e){this._clearcoat>0!=e>0&&this.version++,this._clearcoat=e}get iridescence(){return this._iridescence}set iridescence(e){this._iridescence>0!=e>0&&this.version++,this._iridescence=e}get dispersion(){return this._dispersion}set dispersion(e){this._dispersion>0!=e>0&&this.version++,this._dispersion=e}get sheen(){return this._sheen}set sheen(e){this._sheen>0!=e>0&&this.version++,this._sheen=e}get transmission(){return this._transmission}set transmission(e){this._transmission>0!=e>0&&this.version++,this._transmission=e}copy(e){return super.copy(e),this.defines={STANDARD:"",PHYSICAL:""},this.anisotropy=e.anisotropy,this.anisotropyRotation=e.anisotropyRotation,this.anisotropyMap=e.anisotropyMap,this.clearcoat=e.clearcoat,this.clearcoatMap=e.clearcoatMap,this.clearcoatRoughness=e.clearcoatRoughness,this.clearcoatRoughnessMap=e.clearcoatRoughnessMap,this.clearcoatNormalMap=e.clearcoatNormalMap,this.clearcoatNormalScale.copy(e.clearcoatNormalScale),this.dispersion=e.dispersion,this.ior=e.ior,this.iridescence=e.iridescence,this.iridescenceMap=e.iridescenceMap,this.iridescenceIOR=e.iridescenceIOR,this.iridescenceThicknessRange=[...e.iridescenceThicknessRange],this.iridescenceThicknessMap=e.iridescenceThicknessMap,this.sheen=e.sheen,this.sheenColor.copy(e.sheenColor),this.sheenColorMap=e.sheenColorMap,this.sheenRoughness=e.sheenRoughness,this.sheenRoughnessMap=e.sheenRoughnessMap,this.transmission=e.transmission,this.transmissionMap=e.transmissionMap,this.thickness=e.thickness,this.thicknessMap=e.thicknessMap,this.attenuationDistance=e.attenuationDistance,this.attenuationColor.copy(e.attenuationColor),this.specularIntensity=e.specularIntensity,this.specularIntensityMap=e.specularIntensityMap,this.specularColor.copy(e.specularColor),this.specularColorMap=e.specularColorMap,this}}class d0e extends cs{constructor(e){super(),this.isMeshPhongMaterial=!0,this.type="MeshPhongMaterial",this.color=new pt(16777215),this.specular=new pt(1118481),this.shininess=30,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new pt(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=ou,this.normalScale=new Fe(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.envMapRotation=new so,this.combine=c_,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.specular.copy(e.specular),this.shininess=e.shininess,this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.envMapRotation.copy(e.envMapRotation),this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.flatShading=e.flatShading,this.fog=e.fog,this}}class p0e extends cs{constructor(e){super(),this.isMeshToonMaterial=!0,this.defines={TOON:""},this.type="MeshToonMaterial",this.color=new pt(16777215),this.map=null,this.gradientMap=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new pt(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=ou,this.normalScale=new Fe(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.alphaMap=null,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.gradientMap=e.gradientMap,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.alphaMap=e.alphaMap,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.fog=e.fog,this}}class m0e extends cs{constructor(e){super(),this.isMeshNormalMaterial=!0,this.type="MeshNormalMaterial",this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=ou,this.normalScale=new Fe(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.flatShading=!1,this.setValues(e)}copy(e){return super.copy(e),this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.flatShading=e.flatShading,this}}class IY extends cs{constructor(e){super(),this.isMeshLambertMaterial=!0,this.type="MeshLambertMaterial",this.color=new pt(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new pt(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=ou,this.normalScale=new Fe(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.envMapRotation=new so,this.combine=c_,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.envMapRotation.copy(e.envMapRotation),this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.flatShading=e.flatShading,this.fog=e.fog,this}}class g0e extends cs{constructor(e){super(),this.isMeshDepthMaterial=!0,this.type="MeshDepthMaterial",this.depthPacking=$ye,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.setValues(e)}copy(e){return super.copy(e),this.depthPacking=e.depthPacking,this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this}}class y0e extends cs{constructor(e){super(),this.isMeshDistanceMaterial=!0,this.type="MeshDistanceMaterial",this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.setValues(e)}copy(e){return super.copy(e),this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this}}class v0e extends cs{constructor(e){super(),this.isMeshMatcapMaterial=!0,this.defines={MATCAP:""},this.type="MeshMatcapMaterial",this.color=new pt(16777215),this.matcap=null,this.map=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=ou,this.normalScale=new Fe(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.alphaMap=null,this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.defines={MATCAP:""},this.color.copy(e.color),this.matcap=e.matcap,this.map=e.map,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.alphaMap=e.alphaMap,this.flatShading=e.flatShading,this.fog=e.fog,this}}class x0e extends p_{constructor(e){super(),this.isLineDashedMaterial=!0,this.type="LineDashedMaterial",this.scale=1,this.dashSize=3,this.gapSize=1,this.setValues(e)}copy(e){return super.copy(e),this.scale=e.scale,this.dashSize=e.dashSize,this.gapSize=e.gapSize,this}}const RV={enabled:!1,files:{},add:function(r,e){this.enabled!==!1&&(this.files[r]=e)},get:function(r){if(this.enabled!==!1)return this.files[r]},remove:function(r){delete this.files[r]},clear:function(){this.files={}}};class b0e{constructor(e,n,i){const s=this;let o=!1,a=0,l=0,c;const u=[];this.onStart=void 0,this.onLoad=e,this.onProgress=n,this.onError=i,this.itemStart=function(h){l++,o===!1&&s.onStart!==void 0&&s.onStart(h,a,l),o=!0},this.itemEnd=function(h){a++,s.onProgress!==void 0&&s.onProgress(h,a,l),a===l&&(o=!1,s.onLoad!==void 0&&s.onLoad())},this.itemError=function(h){s.onError!==void 0&&s.onError(h)},this.resolveURL=function(h){return c?c(h):h},this.setURLModifier=function(h){return c=h,this},this.addHandler=function(h,f){return u.push(h,f),this},this.removeHandler=function(h){const f=u.indexOf(h);return f!==-1&&u.splice(f,2),this},this.getHandler=function(h){for(let f=0,d=u.length;f<d;f+=2){const p=u[f],m=u[f+1];if(p.global&&(p.lastIndex=0),p.test(h))return m}return null}}}const _0e=new b0e;class $F{constructor(e){this.manager=e!==void 0?e:_0e,this.crossOrigin="anonymous",this.withCredentials=!1,this.path="",this.resourcePath="",this.requestHeader={}}load(){}loadAsync(e,n){const i=this;return new Promise(function(s,o){i.load(e,s,n,o)})}parse(){}setCrossOrigin(e){return this.crossOrigin=e,this}setWithCredentials(e){return this.withCredentials=e,this}setPath(e){return this.path=e,this}setResourcePath(e){return this.resourcePath=e,this}setRequestHeader(e){return this.requestHeader=e,this}}$F.DEFAULT_MATERIAL_NAME="__DEFAULT";class w0e extends $F{constructor(e){super(e)}load(e,n,i,s){this.path!==void 0&&(e=this.path+e),e=this.manager.resolveURL(e);const o=this,a=RV.get(e);if(a!==void 0)return o.manager.itemStart(e),setTimeout(function(){n&&n(a),o.manager.itemEnd(e)},0),a;const l=Xx("img");function c(){h(),RV.add(e,this),n&&n(this),o.manager.itemEnd(e)}function u(f){h(),s&&s(f),o.manager.itemError(e),o.manager.itemEnd(e)}function h(){l.removeEventListener("load",c,!1),l.removeEventListener("error",u,!1)}return l.addEventListener("load",c,!1),l.addEventListener("error",u,!1),e.slice(0,5)!=="data:"&&this.crossOrigin!==void 0&&(l.crossOrigin=this.crossOrigin),o.manager.itemStart(e),l.src=e,l}}class S0e extends $F{constructor(e){super(e)}load(e,n,i,s){const o=new ui,a=new w0e(this.manager);return a.setCrossOrigin(this.crossOrigin),a.setPath(this.path),a.load(e,function(l){o.image=l,o.needsUpdate=!0,n!==void 0&&n(o)},i,s),o}}class Dd extends Mr{constructor(e,n=1){super(),this.isLight=!0,this.type="Light",this.color=new pt(e),this.intensity=n}dispose(){}copy(e,n){return super.copy(e,n),this.color.copy(e.color),this.intensity=e.intensity,this}toJSON(e){const n=super.toJSON(e);return n.object.color=this.color.getHex(),n.object.intensity=this.intensity,this.groundColor!==void 0&&(n.object.groundColor=this.groundColor.getHex()),this.distance!==void 0&&(n.object.distance=this.distance),this.angle!==void 0&&(n.object.angle=this.angle),this.decay!==void 0&&(n.object.decay=this.decay),this.penumbra!==void 0&&(n.object.penumbra=this.penumbra),this.shadow!==void 0&&(n.object.shadow=this.shadow.toJSON()),this.target!==void 0&&(n.object.target=this.target.uuid),n}}class T0e extends Dd{constructor(e,n,i){super(e,i),this.isHemisphereLight=!0,this.type="HemisphereLight",this.position.copy(Mr.DEFAULT_UP),this.updateMatrix(),this.groundColor=new pt(n)}copy(e,n){return super.copy(e,n),this.groundColor.copy(e.groundColor),this}}const vR=new sn,NV=new K,OV=new K;class jF{constructor(e){this.camera=e,this.intensity=1,this.bias=0,this.normalBias=0,this.radius=1,this.blurSamples=8,this.mapSize=new Fe(512,512),this.mapType=gr,this.map=null,this.mapPass=null,this.matrix=new sn,this.autoUpdate=!0,this.needsUpdate=!1,this._frustum=new d_,this._frameExtents=new Fe(1,1),this._viewportCount=1,this._viewports=[new Nt(0,0,1,1)]}getViewportCount(){return this._viewportCount}getFrustum(){return this._frustum}updateMatrices(e){const n=this.camera,i=this.matrix;NV.setFromMatrixPosition(e.matrixWorld),n.position.copy(NV),OV.setFromMatrixPosition(e.target.matrixWorld),n.lookAt(OV),n.updateMatrixWorld(),vR.multiplyMatrices(n.projectionMatrix,n.matrixWorldInverse),this._frustum.setFromProjectionMatrix(vR),i.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),i.multiply(vR)}getViewport(e){return this._viewports[e]}getFrameExtents(){return this._frameExtents}dispose(){this.map&&this.map.dispose(),this.mapPass&&this.mapPass.dispose()}copy(e){return this.camera=e.camera.clone(),this.intensity=e.intensity,this.bias=e.bias,this.radius=e.radius,this.autoUpdate=e.autoUpdate,this.needsUpdate=e.needsUpdate,this.normalBias=e.normalBias,this.blurSamples=e.blurSamples,this.mapSize.copy(e.mapSize),this}clone(){return new this.constructor().copy(this)}toJSON(){const e={};return this.intensity!==1&&(e.intensity=this.intensity),this.bias!==0&&(e.bias=this.bias),this.normalBias!==0&&(e.normalBias=this.normalBias),this.radius!==1&&(e.radius=this.radius),(this.mapSize.x!==512||this.mapSize.y!==512)&&(e.mapSize=this.mapSize.toArray()),e.camera=this.camera.toJSON(!1).object,delete e.camera.matrix,e}}class E0e extends jF{constructor(){super(new Ti(50,1,.5,500)),this.isSpotLightShadow=!0,this.focus=1}updateMatrices(e){const n=this.camera,i=vd*2*e.angle*this.focus,s=this.mapSize.width/this.mapSize.height,o=e.distance||n.far;(i!==n.fov||s!==n.aspect||o!==n.far)&&(n.fov=i,n.aspect=s,n.far=o,n.updateProjectionMatrix()),super.updateMatrices(e)}copy(e){return super.copy(e),this.focus=e.focus,this}}class LY extends Dd{constructor(e,n,i=0,s=Math.PI/3,o=0,a=2){super(e,n),this.isSpotLight=!0,this.type="SpotLight",this.position.copy(Mr.DEFAULT_UP),this.updateMatrix(),this.target=new Mr,this.distance=i,this.angle=s,this.penumbra=o,this.decay=a,this.map=null,this.shadow=new E0e}get power(){return this.intensity*Math.PI}set power(e){this.intensity=e/Math.PI}dispose(){this.shadow.dispose()}copy(e,n){return super.copy(e,n),this.distance=e.distance,this.angle=e.angle,this.penumbra=e.penumbra,this.decay=e.decay,this.target=e.target.clone(),this.shadow=e.shadow.clone(),this}}const DV=new sn,dv=new K,xR=new K;class M0e extends jF{constructor(){super(new Ti(90,1,.5,500)),this.isPointLightShadow=!0,this._frameExtents=new Fe(4,2),this._viewportCount=6,this._viewports=[new Nt(2,1,1,1),new Nt(0,1,1,1),new Nt(3,1,1,1),new Nt(1,1,1,1),new Nt(3,0,1,1),new Nt(1,0,1,1)],this._cubeDirections=[new K(1,0,0),new K(-1,0,0),new K(0,0,1),new K(0,0,-1),new K(0,1,0),new K(0,-1,0)],this._cubeUps=[new K(0,1,0),new K(0,1,0),new K(0,1,0),new K(0,1,0),new K(0,0,1),new K(0,0,-1)]}updateMatrices(e,n=0){const i=this.camera,s=this.matrix,o=e.distance||i.far;o!==i.far&&(i.far=o,i.updateProjectionMatrix()),dv.setFromMatrixPosition(e.matrixWorld),i.position.copy(dv),xR.copy(i.position),xR.add(this._cubeDirections[n]),i.up.copy(this._cubeUps[n]),i.lookAt(xR),i.updateMatrixWorld(),s.makeTranslation(-dv.x,-dv.y,-dv.z),DV.multiplyMatrices(i.projectionMatrix,i.matrixWorldInverse),this._frustum.setFromProjectionMatrix(DV)}}class A0e extends Dd{constructor(e,n,i=0,s=2){super(e,n),this.isPointLight=!0,this.type="PointLight",this.distance=i,this.decay=s,this.shadow=new M0e}get power(){return this.intensity*4*Math.PI}set power(e){this.intensity=e/(4*Math.PI)}dispose(){this.shadow.dispose()}copy(e,n){return super.copy(e,n),this.distance=e.distance,this.decay=e.decay,this.shadow=e.shadow.clone(),this}}class y_ extends kF{constructor(e=-1,n=1,i=1,s=-1,o=.1,a=2e3){super(),this.isOrthographicCamera=!0,this.type="OrthographicCamera",this.zoom=1,this.view=null,this.left=e,this.right=n,this.top=i,this.bottom=s,this.near=o,this.far=a,this.updateProjectionMatrix()}copy(e,n){return super.copy(e,n),this.left=e.left,this.right=e.right,this.top=e.top,this.bottom=e.bottom,this.near=e.near,this.far=e.far,this.zoom=e.zoom,this.view=e.view===null?null:Object.assign({},e.view),this}setViewOffset(e,n,i,s,o,a){this.view===null&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=n,this.view.offsetX=i,this.view.offsetY=s,this.view.width=o,this.view.height=a,this.updateProjectionMatrix()}clearViewOffset(){this.view!==null&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const e=(this.right-this.left)/(2*this.zoom),n=(this.top-this.bottom)/(2*this.zoom),i=(this.right+this.left)/2,s=(this.top+this.bottom)/2;let o=i-e,a=i+e,l=s+n,c=s-n;if(this.view!==null&&this.view.enabled){const u=(this.right-this.left)/this.view.fullWidth/this.zoom,h=(this.top-this.bottom)/this.view.fullHeight/this.zoom;o+=u*this.view.offsetX,a=o+u*this.view.width,l-=h*this.view.offsetY,c=l-h*this.view.height}this.projectionMatrix.makeOrthographic(o,a,l,c,this.near,this.far,this.coordinateSystem),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(e){const n=super.toJSON(e);return n.object.zoom=this.zoom,n.object.left=this.left,n.object.right=this.right,n.object.top=this.top,n.object.bottom=this.bottom,n.object.near=this.near,n.object.far=this.far,this.view!==null&&(n.object.view=Object.assign({},this.view)),n}}class C0e extends jF{constructor(){super(new y_(-5,5,5,-5,.5,500)),this.isDirectionalLightShadow=!0}}class FY extends Dd{constructor(e,n){super(e,n),this.isDirectionalLight=!0,this.type="DirectionalLight",this.position.copy(Mr.DEFAULT_UP),this.updateMatrix(),this.target=new Mr,this.shadow=new C0e}dispose(){this.shadow.dispose()}copy(e){return super.copy(e),this.target=e.target.clone(),this.shadow=e.shadow.clone(),this}}class BY extends Dd{constructor(e,n){super(e,n),this.isAmbientLight=!0,this.type="AmbientLight"}}class P0e extends Dd{constructor(e,n,i=10,s=10){super(e,n),this.isRectAreaLight=!0,this.type="RectAreaLight",this.width=i,this.height=s}get power(){return this.intensity*this.width*this.height*Math.PI}set power(e){this.intensity=e/(this.width*this.height*Math.PI)}copy(e){return super.copy(e),this.width=e.width,this.height=e.height,this}toJSON(e){const n=super.toJSON(e);return n.object.width=this.width,n.object.height=this.height,n}}class R0e{constructor(){this.isSphericalHarmonics3=!0,this.coefficients=[];for(let e=0;e<9;e++)this.coefficients.push(new K)}set(e){for(let n=0;n<9;n++)this.coefficients[n].copy(e[n]);return this}zero(){for(let e=0;e<9;e++)this.coefficients[e].set(0,0,0);return this}getAt(e,n){const i=e.x,s=e.y,o=e.z,a=this.coefficients;return n.copy(a[0]).multiplyScalar(.282095),n.addScaledVector(a[1],.488603*s),n.addScaledVector(a[2],.488603*o),n.addScaledVector(a[3],.488603*i),n.addScaledVector(a[4],1.092548*(i*s)),n.addScaledVector(a[5],1.092548*(s*o)),n.addScaledVector(a[6],.315392*(3*o*o-1)),n.addScaledVector(a[7],1.092548*(i*o)),n.addScaledVector(a[8],.546274*(i*i-s*s)),n}getIrradianceAt(e,n){const i=e.x,s=e.y,o=e.z,a=this.coefficients;return n.copy(a[0]).multiplyScalar(.886227),n.addScaledVector(a[1],2*.511664*s),n.addScaledVector(a[2],2*.511664*o),n.addScaledVector(a[3],2*.511664*i),n.addScaledVector(a[4],2*.429043*i*s),n.addScaledVector(a[5],2*.429043*s*o),n.addScaledVector(a[6],.743125*o*o-.247708),n.addScaledVector(a[7],2*.429043*i*o),n.addScaledVector(a[8],.429043*(i*i-s*s)),n}add(e){for(let n=0;n<9;n++)this.coefficients[n].add(e.coefficients[n]);return this}addScaledSH(e,n){for(let i=0;i<9;i++)this.coefficients[i].addScaledVector(e.coefficients[i],n);return this}scale(e){for(let n=0;n<9;n++)this.coefficients[n].multiplyScalar(e);return this}lerp(e,n){for(let i=0;i<9;i++)this.coefficients[i].lerp(e.coefficients[i],n);return this}equals(e){for(let n=0;n<9;n++)if(!this.coefficients[n].equals(e.coefficients[n]))return!1;return!0}copy(e){return this.set(e.coefficients)}clone(){return new this.constructor().copy(this)}fromArray(e,n=0){const i=this.coefficients;for(let s=0;s<9;s++)i[s].fromArray(e,n+s*3);return this}toArray(e=[],n=0){const i=this.coefficients;for(let s=0;s<9;s++)i[s].toArray(e,n+s*3);return e}static getBasisAt(e,n){const i=e.x,s=e.y,o=e.z;n[0]=.282095,n[1]=.488603*s,n[2]=.488603*o,n[3]=.488603*i,n[4]=1.092548*i*s,n[5]=1.092548*s*o,n[6]=.315392*(3*o*o-1),n[7]=1.092548*i*o,n[8]=.546274*(i*i-s*s)}}class N0e extends Dd{constructor(e=new R0e,n=1){super(void 0,n),this.isLightProbe=!0,this.sh=e}copy(e){return super.copy(e),this.sh.copy(e.sh),this}fromJSON(e){return this.intensity=e.intensity,this.sh.fromArray(e.sh),this}toJSON(e){const n=super.toJSON(e);return n.object.sh=this.sh.toArray(),n}}class UY extends Ti{constructor(e=[]){super(),this.isArrayCamera=!0,this.isMultiViewCamera=!1,this.cameras=e}}class zY{constructor(e=!0){this.autoStart=e,this.startTime=0,this.oldTime=0,this.elapsedTime=0,this.running=!1}start(){this.startTime=kV(),this.oldTime=this.startTime,this.elapsedTime=0,this.running=!0}stop(){this.getElapsedTime(),this.running=!1,this.autoStart=!1}getElapsedTime(){return this.getDelta(),this.elapsedTime}getDelta(){let e=0;if(this.autoStart&&!this.running)return this.start(),0;if(this.running){const n=kV();e=(n-this.oldTime)/1e3,this.oldTime=n,this.elapsedTime+=e}return e}}function kV(){return performance.now()}class O0e extends $h{constructor(e=1,n=1,i=1,s={}){super(e,n,s),this.isRenderTargetArray=!0,this.depth=i,this.texture=new KM(null,e,n,i),this.texture.isRenderTargetTexture=!0}}class D0e extends PY{constructor(e,n,i=1){super(e,n),this.isInstancedInterleavedBuffer=!0,this.meshPerAttribute=i}copy(e){return super.copy(e),this.meshPerAttribute=e.meshPerAttribute,this}clone(e){const n=super.clone(e);return n.meshPerAttribute=this.meshPerAttribute,n}toJSON(e){const n=super.toJSON(e);return n.isInstancedInterleavedBuffer=!0,n.meshPerAttribute=this.meshPerAttribute,n}}const IV=new sn;class $Y{constructor(e,n,i=0,s=1/0){this.ray=new YM(e,n),this.near=i,this.far=s,this.camera=null,this.layers=new NF,this.params={Mesh:{},Line:{threshold:1},LOD:{},Points:{threshold:1},Sprite:{}}}set(e,n){this.ray.set(e,n)}setFromCamera(e,n){n.isPerspectiveCamera?(this.ray.origin.setFromMatrixPosition(n.matrixWorld),this.ray.direction.set(e.x,e.y,.5).unproject(n).sub(this.ray.origin).normalize(),this.camera=n):n.isOrthographicCamera?(this.ray.origin.set(e.x,e.y,(n.near+n.far)/(n.near-n.far)).unproject(n),this.ray.direction.set(0,0,-1).transformDirection(n.matrixWorld),this.camera=n):console.error("THREE.Raycaster: Unsupported camera type: "+n.type)}setFromXRController(e){return IV.identity().extractRotation(e.matrixWorld),this.ray.origin.setFromMatrixPosition(e.matrixWorld),this.ray.direction.set(0,0,-1).applyMatrix4(IV),this}intersectObject(e,n=!0,i=[]){return WO(e,this,i,n),i.sort(LV),i}intersectObjects(e,n=!0,i=[]){for(let s=0,o=e.length;s<o;s++)WO(e[s],this,i,n);return i.sort(LV),i}}function LV(r,e){return r.distance-e.distance}function WO(r,e,n,i){let s=!0;if(r.layers.test(e.layers)&&r.raycast(e,n)===!1&&(s=!1),s===!0&&i===!0){const o=r.children;for(let a=0,l=o.length;a<l;a++)WO(o[a],e,n,!0)}}class FV{constructor(e=1,n=0,i=0){this.radius=e,this.phi=n,this.theta=i}set(e,n,i){return this.radius=e,this.phi=n,this.theta=i,this}copy(e){return this.radius=e.radius,this.phi=e.phi,this.theta=e.theta,this}makeSafe(){return this.phi=Wt(this.phi,1e-6,Math.PI-1e-6),this}setFromVector3(e){return this.setFromCartesianCoords(e.x,e.y,e.z)}setFromCartesianCoords(e,n,i){return this.radius=Math.sqrt(e*e+n*n+i*i),this.radius===0?(this.theta=0,this.phi=0):(this.theta=Math.atan2(e,i),this.phi=Math.acos(Wt(n/this.radius,-1,1))),this}clone(){return new this.constructor().copy(this)}}class JM{constructor(e,n,i,s){JM.prototype.isMatrix2=!0,this.elements=[1,0,0,1],e!==void 0&&this.set(e,n,i,s)}identity(){return this.set(1,0,0,1),this}fromArray(e,n=0){for(let i=0;i<4;i++)this.elements[i]=e[i+n];return this}set(e,n,i,s){const o=this.elements;return o[0]=e,o[2]=n,o[1]=i,o[3]=s,this}}class eA extends gu{constructor(e,n=null){super(),this.object=e,this.domElement=n,this.enabled=!0,this.state=-1,this.keys={},this.mouseButtons={LEFT:null,MIDDLE:null,RIGHT:null},this.touches={ONE:null,TWO:null}}connect(e){if(e===void 0){console.warn("THREE.Controls: connect() now requires an element.");return}this.domElement!==null&&this.disconnect(),this.domElement=e}disconnect(){}dispose(){}update(){}}function BV(r,e,n,i){const s=k0e(i);switch(n){case bF:return r*e;case h_:return r*e/s.components*s.byteLength;case gy:return r*e/s.components*s.byteLength;case kc:return r*e*2/s.components*s.byteLength;case yy:return r*e*2/s.components*s.byteLength;case u_:return r*e*3/s.components*s.byteLength;case Tr:return r*e*4/s.components*s.byteLength;case vy:return r*e*4/s.components*s.byteLength;case td:case yh:return Math.floor((r+3)/4)*Math.floor((e+3)/4)*8;case vh:case xh:return Math.floor((r+3)/4)*Math.floor((e+3)/4)*16;case $x:case Vx:return Math.max(r,16)*Math.max(e,8)/4;case zx:case jx:return Math.max(r,8)*Math.max(e,8)/2;case Gx:case ng:return Math.floor((r+3)/4)*Math.floor((e+3)/4)*8;case rg:return Math.floor((r+3)/4)*Math.floor((e+3)/4)*16;case ig:return Math.floor((r+3)/4)*Math.floor((e+3)/4)*16;case sg:return Math.floor((r+4)/5)*Math.floor((e+3)/4)*16;case og:return Math.floor((r+4)/5)*Math.floor((e+4)/5)*16;case ag:return Math.floor((r+5)/6)*Math.floor((e+4)/5)*16;case lg:return Math.floor((r+5)/6)*Math.floor((e+5)/6)*16;case cg:return Math.floor((r+7)/8)*Math.floor((e+4)/5)*16;case ug:return Math.floor((r+7)/8)*Math.floor((e+5)/6)*16;case hg:return Math.floor((r+7)/8)*Math.floor((e+7)/8)*16;case fg:return Math.floor((r+9)/10)*Math.floor((e+4)/5)*16;case dg:return Math.floor((r+9)/10)*Math.floor((e+5)/6)*16;case pg:return Math.floor((r+9)/10)*Math.floor((e+7)/8)*16;case mg:return Math.floor((r+9)/10)*Math.floor((e+9)/10)*16;case gg:return Math.floor((r+11)/12)*Math.floor((e+9)/10)*16;case yg:return Math.floor((r+11)/12)*Math.floor((e+11)/12)*16;case nd:case VO:case GO:return Math.ceil(r/4)*Math.ceil(e/4)*16;case _F:case Hx:return Math.ceil(r/4)*Math.ceil(e/4)*8;case Wx:case qx:return Math.ceil(r/4)*Math.ceil(e/4)*16}throw new Error(`Unable to determine texture byte length for ${n} format.`)}function k0e(r){switch(r){case gr:case Jf:return{byteLength:1,components:1};case qa:case ed:case Ei:return{byteLength:2,components:1};case GM:case HM:return{byteLength:2,components:4};case In:case Si:case Nr:return{byteLength:4,components:1};case WM:return{byteLength:4,components:3}}throw new Error(`Unknown texture type ${r}.`)}typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("register",{detail:{revision:my}}));typeof window<"u"&&(window.__THREE__?console.warn("WARNING: Multiple instances of Three.js being imported."):window.__THREE__=my);/**
 * @license
 * Copyright 2010-2025 Three.js Authors
 * SPDX-License-Identifier: MIT
 */function jY(){let r=null,e=!1,n=null,i=null;function s(o,a){n(o,a),i=r.requestAnimationFrame(s)}return{start:function(){e!==!0&&n!==null&&(i=r.requestAnimationFrame(s),e=!0)},stop:function(){r.cancelAnimationFrame(i),e=!1},setAnimationLoop:function(o){n=o},setContext:function(o){r=o}}}function I0e(r){const e=new WeakMap;function n(l,c){const u=l.array,h=l.usage,f=u.byteLength,d=r.createBuffer();r.bindBuffer(c,d),r.bufferData(c,u,h),l.onUploadCallback();let p;if(u instanceof Float32Array)p=r.FLOAT;else if(u instanceof Uint16Array)l.isFloat16BufferAttribute?p=r.HALF_FLOAT:p=r.UNSIGNED_SHORT;else if(u instanceof Int16Array)p=r.SHORT;else if(u instanceof Uint32Array)p=r.UNSIGNED_INT;else if(u instanceof Int32Array)p=r.INT;else if(u instanceof Int8Array)p=r.BYTE;else if(u instanceof Uint8Array)p=r.UNSIGNED_BYTE;else if(u instanceof Uint8ClampedArray)p=r.UNSIGNED_BYTE;else throw new Error("THREE.WebGLAttributes: Unsupported buffer data format: "+u);return{buffer:d,type:p,bytesPerElement:u.BYTES_PER_ELEMENT,version:l.version,size:f}}function i(l,c,u){const h=c.array,f=c.updateRanges;if(r.bindBuffer(u,l),f.length===0)r.bufferSubData(u,0,h);else{f.sort((p,m)=>p.start-m.start);let d=0;for(let p=1;p<f.length;p++){const m=f[d],g=f[p];g.start<=m.start+m.count+1?m.count=Math.max(m.count,g.start+g.count-m.start):(++d,f[d]=g)}f.length=d+1;for(let p=0,m=f.length;p<m;p++){const g=f[p];r.bufferSubData(u,g.start*h.BYTES_PER_ELEMENT,h,g.start,g.count)}c.clearUpdateRanges()}c.onUploadCallback()}function s(l){return l.isInterleavedBufferAttribute&&(l=l.data),e.get(l)}function o(l){l.isInterleavedBufferAttribute&&(l=l.data);const c=e.get(l);c&&(r.deleteBuffer(c.buffer),e.delete(l))}function a(l,c){if(l.isInterleavedBufferAttribute&&(l=l.data),l.isGLBufferAttribute){const h=e.get(l);(!h||h.version<l.version)&&e.set(l,{buffer:l.buffer,type:l.type,bytesPerElement:l.elementSize,version:l.version});return}const u=e.get(l);if(u===void 0)e.set(l,n(l,c));else if(u.version<l.version){if(u.size!==l.array.byteLength)throw new Error("THREE.WebGLAttributes: The size of the buffer attribute's array buffer does not match the original size. Resizing buffer attributes is not supported.");i(u.buffer,l,c),u.version=l.version}}return{get:s,remove:o,update:a}}var L0e=`#ifdef USE_ALPHAHASH
	if ( diffuseColor.a < getAlphaHashThreshold( vPosition ) ) discard;
#endif`,F0e=`#ifdef USE_ALPHAHASH
	const float ALPHA_HASH_SCALE = 0.05;
	float hash2D( vec2 value ) {
		return fract( 1.0e4 * sin( 17.0 * value.x + 0.1 * value.y ) * ( 0.1 + abs( sin( 13.0 * value.y + value.x ) ) ) );
	}
	float hash3D( vec3 value ) {
		return hash2D( vec2( hash2D( value.xy ), value.z ) );
	}
	float getAlphaHashThreshold( vec3 position ) {
		float maxDeriv = max(
			length( dFdx( position.xyz ) ),
			length( dFdy( position.xyz ) )
		);
		float pixScale = 1.0 / ( ALPHA_HASH_SCALE * maxDeriv );
		vec2 pixScales = vec2(
			exp2( floor( log2( pixScale ) ) ),
			exp2( ceil( log2( pixScale ) ) )
		);
		vec2 alpha = vec2(
			hash3D( floor( pixScales.x * position.xyz ) ),
			hash3D( floor( pixScales.y * position.xyz ) )
		);
		float lerpFactor = fract( log2( pixScale ) );
		float x = ( 1.0 - lerpFactor ) * alpha.x + lerpFactor * alpha.y;
		float a = min( lerpFactor, 1.0 - lerpFactor );
		vec3 cases = vec3(
			x * x / ( 2.0 * a * ( 1.0 - a ) ),
			( x - 0.5 * a ) / ( 1.0 - a ),
			1.0 - ( ( 1.0 - x ) * ( 1.0 - x ) / ( 2.0 * a * ( 1.0 - a ) ) )
		);
		float threshold = ( x < ( 1.0 - a ) )
			? ( ( x < a ) ? cases.x : cases.y )
			: cases.z;
		return clamp( threshold , 1.0e-6, 1.0 );
	}
#endif`,B0e=`#ifdef USE_ALPHAMAP
	diffuseColor.a *= texture2D( alphaMap, vAlphaMapUv ).g;
#endif`,U0e=`#ifdef USE_ALPHAMAP
	uniform sampler2D alphaMap;
#endif`,z0e=`#ifdef USE_ALPHATEST
	#ifdef ALPHA_TO_COVERAGE
	diffuseColor.a = smoothstep( alphaTest, alphaTest + fwidth( diffuseColor.a ), diffuseColor.a );
	if ( diffuseColor.a == 0.0 ) discard;
	#else
	if ( diffuseColor.a < alphaTest ) discard;
	#endif
#endif`,$0e=`#ifdef USE_ALPHATEST
	uniform float alphaTest;
#endif`,j0e=`#ifdef USE_AOMAP
	float ambientOcclusion = ( texture2D( aoMap, vAoMapUv ).r - 1.0 ) * aoMapIntensity + 1.0;
	reflectedLight.indirectDiffuse *= ambientOcclusion;
	#if defined( USE_CLEARCOAT ) 
		clearcoatSpecularIndirect *= ambientOcclusion;
	#endif
	#if defined( USE_SHEEN ) 
		sheenSpecularIndirect *= ambientOcclusion;
	#endif
	#if defined( USE_ENVMAP ) && defined( STANDARD )
		float dotNV = saturate( dot( geometryNormal, geometryViewDir ) );
		reflectedLight.indirectSpecular *= computeSpecularOcclusion( dotNV, ambientOcclusion, material.roughness );
	#endif
#endif`,V0e=`#ifdef USE_AOMAP
	uniform sampler2D aoMap;
	uniform float aoMapIntensity;
#endif`,G0e=`#ifdef USE_BATCHING
	#if ! defined( GL_ANGLE_multi_draw )
	#define gl_DrawID _gl_DrawID
	uniform int _gl_DrawID;
	#endif
	uniform highp sampler2D batchingTexture;
	uniform highp usampler2D batchingIdTexture;
	mat4 getBatchingMatrix( const in float i ) {
		int size = textureSize( batchingTexture, 0 ).x;
		int j = int( i ) * 4;
		int x = j % size;
		int y = j / size;
		vec4 v1 = texelFetch( batchingTexture, ivec2( x, y ), 0 );
		vec4 v2 = texelFetch( batchingTexture, ivec2( x + 1, y ), 0 );
		vec4 v3 = texelFetch( batchingTexture, ivec2( x + 2, y ), 0 );
		vec4 v4 = texelFetch( batchingTexture, ivec2( x + 3, y ), 0 );
		return mat4( v1, v2, v3, v4 );
	}
	float getIndirectIndex( const in int i ) {
		int size = textureSize( batchingIdTexture, 0 ).x;
		int x = i % size;
		int y = i / size;
		return float( texelFetch( batchingIdTexture, ivec2( x, y ), 0 ).r );
	}
#endif
#ifdef USE_BATCHING_COLOR
	uniform sampler2D batchingColorTexture;
	vec3 getBatchingColor( const in float i ) {
		int size = textureSize( batchingColorTexture, 0 ).x;
		int j = int( i );
		int x = j % size;
		int y = j / size;
		return texelFetch( batchingColorTexture, ivec2( x, y ), 0 ).rgb;
	}
#endif`,H0e=`#ifdef USE_BATCHING
	mat4 batchingMatrix = getBatchingMatrix( getIndirectIndex( gl_DrawID ) );
#endif`,W0e=`vec3 transformed = vec3( position );
#ifdef USE_ALPHAHASH
	vPosition = vec3( position );
#endif`,q0e=`vec3 objectNormal = vec3( normal );
#ifdef USE_TANGENT
	vec3 objectTangent = vec3( tangent.xyz );
#endif`,X0e=`float G_BlinnPhong_Implicit( ) {
	return 0.25;
}
float D_BlinnPhong( const in float shininess, const in float dotNH ) {
	return RECIPROCAL_PI * ( shininess * 0.5 + 1.0 ) * pow( dotNH, shininess );
}
vec3 BRDF_BlinnPhong( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in vec3 specularColor, const in float shininess ) {
	vec3 halfDir = normalize( lightDir + viewDir );
	float dotNH = saturate( dot( normal, halfDir ) );
	float dotVH = saturate( dot( viewDir, halfDir ) );
	vec3 F = F_Schlick( specularColor, 1.0, dotVH );
	float G = G_BlinnPhong_Implicit( );
	float D = D_BlinnPhong( shininess, dotNH );
	return F * ( G * D );
} // validated`,K0e=`#ifdef USE_IRIDESCENCE
	const mat3 XYZ_TO_REC709 = mat3(
		 3.2404542, -0.9692660,  0.0556434,
		-1.5371385,  1.8760108, -0.2040259,
		-0.4985314,  0.0415560,  1.0572252
	);
	vec3 Fresnel0ToIor( vec3 fresnel0 ) {
		vec3 sqrtF0 = sqrt( fresnel0 );
		return ( vec3( 1.0 ) + sqrtF0 ) / ( vec3( 1.0 ) - sqrtF0 );
	}
	vec3 IorToFresnel0( vec3 transmittedIor, float incidentIor ) {
		return pow2( ( transmittedIor - vec3( incidentIor ) ) / ( transmittedIor + vec3( incidentIor ) ) );
	}
	float IorToFresnel0( float transmittedIor, float incidentIor ) {
		return pow2( ( transmittedIor - incidentIor ) / ( transmittedIor + incidentIor ));
	}
	vec3 evalSensitivity( float OPD, vec3 shift ) {
		float phase = 2.0 * PI * OPD * 1.0e-9;
		vec3 val = vec3( 5.4856e-13, 4.4201e-13, 5.2481e-13 );
		vec3 pos = vec3( 1.6810e+06, 1.7953e+06, 2.2084e+06 );
		vec3 var = vec3( 4.3278e+09, 9.3046e+09, 6.6121e+09 );
		vec3 xyz = val * sqrt( 2.0 * PI * var ) * cos( pos * phase + shift ) * exp( - pow2( phase ) * var );
		xyz.x += 9.7470e-14 * sqrt( 2.0 * PI * 4.5282e+09 ) * cos( 2.2399e+06 * phase + shift[ 0 ] ) * exp( - 4.5282e+09 * pow2( phase ) );
		xyz /= 1.0685e-7;
		vec3 rgb = XYZ_TO_REC709 * xyz;
		return rgb;
	}
	vec3 evalIridescence( float outsideIOR, float eta2, float cosTheta1, float thinFilmThickness, vec3 baseF0 ) {
		vec3 I;
		float iridescenceIOR = mix( outsideIOR, eta2, smoothstep( 0.0, 0.03, thinFilmThickness ) );
		float sinTheta2Sq = pow2( outsideIOR / iridescenceIOR ) * ( 1.0 - pow2( cosTheta1 ) );
		float cosTheta2Sq = 1.0 - sinTheta2Sq;
		if ( cosTheta2Sq < 0.0 ) {
			return vec3( 1.0 );
		}
		float cosTheta2 = sqrt( cosTheta2Sq );
		float R0 = IorToFresnel0( iridescenceIOR, outsideIOR );
		float R12 = F_Schlick( R0, 1.0, cosTheta1 );
		float T121 = 1.0 - R12;
		float phi12 = 0.0;
		if ( iridescenceIOR < outsideIOR ) phi12 = PI;
		float phi21 = PI - phi12;
		vec3 baseIOR = Fresnel0ToIor( clamp( baseF0, 0.0, 0.9999 ) );		vec3 R1 = IorToFresnel0( baseIOR, iridescenceIOR );
		vec3 R23 = F_Schlick( R1, 1.0, cosTheta2 );
		vec3 phi23 = vec3( 0.0 );
		if ( baseIOR[ 0 ] < iridescenceIOR ) phi23[ 0 ] = PI;
		if ( baseIOR[ 1 ] < iridescenceIOR ) phi23[ 1 ] = PI;
		if ( baseIOR[ 2 ] < iridescenceIOR ) phi23[ 2 ] = PI;
		float OPD = 2.0 * iridescenceIOR * thinFilmThickness * cosTheta2;
		vec3 phi = vec3( phi21 ) + phi23;
		vec3 R123 = clamp( R12 * R23, 1e-5, 0.9999 );
		vec3 r123 = sqrt( R123 );
		vec3 Rs = pow2( T121 ) * R23 / ( vec3( 1.0 ) - R123 );
		vec3 C0 = R12 + Rs;
		I = C0;
		vec3 Cm = Rs - T121;
		for ( int m = 1; m <= 2; ++ m ) {
			Cm *= r123;
			vec3 Sm = 2.0 * evalSensitivity( float( m ) * OPD, float( m ) * phi );
			I += Cm * Sm;
		}
		return max( I, vec3( 0.0 ) );
	}
#endif`,Y0e=`#ifdef USE_BUMPMAP
	uniform sampler2D bumpMap;
	uniform float bumpScale;
	vec2 dHdxy_fwd() {
		vec2 dSTdx = dFdx( vBumpMapUv );
		vec2 dSTdy = dFdy( vBumpMapUv );
		float Hll = bumpScale * texture2D( bumpMap, vBumpMapUv ).x;
		float dBx = bumpScale * texture2D( bumpMap, vBumpMapUv + dSTdx ).x - Hll;
		float dBy = bumpScale * texture2D( bumpMap, vBumpMapUv + dSTdy ).x - Hll;
		return vec2( dBx, dBy );
	}
	vec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy, float faceDirection ) {
		vec3 vSigmaX = normalize( dFdx( surf_pos.xyz ) );
		vec3 vSigmaY = normalize( dFdy( surf_pos.xyz ) );
		vec3 vN = surf_norm;
		vec3 R1 = cross( vSigmaY, vN );
		vec3 R2 = cross( vN, vSigmaX );
		float fDet = dot( vSigmaX, R1 ) * faceDirection;
		vec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );
		return normalize( abs( fDet ) * surf_norm - vGrad );
	}
#endif`,Z0e=`#if NUM_CLIPPING_PLANES > 0
	vec4 plane;
	#ifdef ALPHA_TO_COVERAGE
		float distanceToPlane, distanceGradient;
		float clipOpacity = 1.0;
		#pragma unroll_loop_start
		for ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {
			plane = clippingPlanes[ i ];
			distanceToPlane = - dot( vClipPosition, plane.xyz ) + plane.w;
			distanceGradient = fwidth( distanceToPlane ) / 2.0;
			clipOpacity *= smoothstep( - distanceGradient, distanceGradient, distanceToPlane );
			if ( clipOpacity == 0.0 ) discard;
		}
		#pragma unroll_loop_end
		#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES
			float unionClipOpacity = 1.0;
			#pragma unroll_loop_start
			for ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {
				plane = clippingPlanes[ i ];
				distanceToPlane = - dot( vClipPosition, plane.xyz ) + plane.w;
				distanceGradient = fwidth( distanceToPlane ) / 2.0;
				unionClipOpacity *= 1.0 - smoothstep( - distanceGradient, distanceGradient, distanceToPlane );
			}
			#pragma unroll_loop_end
			clipOpacity *= 1.0 - unionClipOpacity;
		#endif
		diffuseColor.a *= clipOpacity;
		if ( diffuseColor.a == 0.0 ) discard;
	#else
		#pragma unroll_loop_start
		for ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {
			plane = clippingPlanes[ i ];
			if ( dot( vClipPosition, plane.xyz ) > plane.w ) discard;
		}
		#pragma unroll_loop_end
		#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES
			bool clipped = true;
			#pragma unroll_loop_start
			for ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {
				plane = clippingPlanes[ i ];
				clipped = ( dot( vClipPosition, plane.xyz ) > plane.w ) && clipped;
			}
			#pragma unroll_loop_end
			if ( clipped ) discard;
		#endif
	#endif
#endif`,Q0e=`#if NUM_CLIPPING_PLANES > 0
	varying vec3 vClipPosition;
	uniform vec4 clippingPlanes[ NUM_CLIPPING_PLANES ];
#endif`,J0e=`#if NUM_CLIPPING_PLANES > 0
	varying vec3 vClipPosition;
#endif`,exe=`#if NUM_CLIPPING_PLANES > 0
	vClipPosition = - mvPosition.xyz;
#endif`,txe=`#if defined( USE_COLOR_ALPHA )
	diffuseColor *= vColor;
#elif defined( USE_COLOR )
	diffuseColor.rgb *= vColor;
#endif`,nxe=`#if defined( USE_COLOR_ALPHA )
	varying vec4 vColor;
#elif defined( USE_COLOR )
	varying vec3 vColor;
#endif`,rxe=`#if defined( USE_COLOR_ALPHA )
	varying vec4 vColor;
#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR ) || defined( USE_BATCHING_COLOR )
	varying vec3 vColor;
#endif`,ixe=`#if defined( USE_COLOR_ALPHA )
	vColor = vec4( 1.0 );
#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR ) || defined( USE_BATCHING_COLOR )
	vColor = vec3( 1.0 );
#endif
#ifdef USE_COLOR
	vColor *= color;
#endif
#ifdef USE_INSTANCING_COLOR
	vColor.xyz *= instanceColor.xyz;
#endif
#ifdef USE_BATCHING_COLOR
	vec3 batchingColor = getBatchingColor( getIndirectIndex( gl_DrawID ) );
	vColor.xyz *= batchingColor.xyz;
#endif`,sxe=`#define PI 3.141592653589793
#define PI2 6.283185307179586
#define PI_HALF 1.5707963267948966
#define RECIPROCAL_PI 0.3183098861837907
#define RECIPROCAL_PI2 0.15915494309189535
#define EPSILON 1e-6
#ifndef saturate
#define saturate( a ) clamp( a, 0.0, 1.0 )
#endif
#define whiteComplement( a ) ( 1.0 - saturate( a ) )
float pow2( const in float x ) { return x*x; }
vec3 pow2( const in vec3 x ) { return x*x; }
float pow3( const in float x ) { return x*x*x; }
float pow4( const in float x ) { float x2 = x*x; return x2*x2; }
float max3( const in vec3 v ) { return max( max( v.x, v.y ), v.z ); }
float average( const in vec3 v ) { return dot( v, vec3( 0.3333333 ) ); }
highp float rand( const in vec2 uv ) {
	const highp float a = 12.9898, b = 78.233, c = 43758.5453;
	highp float dt = dot( uv.xy, vec2( a,b ) ), sn = mod( dt, PI );
	return fract( sin( sn ) * c );
}
#ifdef HIGH_PRECISION
	float precisionSafeLength( vec3 v ) { return length( v ); }
#else
	float precisionSafeLength( vec3 v ) {
		float maxComponent = max3( abs( v ) );
		return length( v / maxComponent ) * maxComponent;
	}
#endif
struct IncidentLight {
	vec3 color;
	vec3 direction;
	bool visible;
};
struct ReflectedLight {
	vec3 directDiffuse;
	vec3 directSpecular;
	vec3 indirectDiffuse;
	vec3 indirectSpecular;
};
#ifdef USE_ALPHAHASH
	varying vec3 vPosition;
#endif
vec3 transformDirection( in vec3 dir, in mat4 matrix ) {
	return normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );
}
vec3 inverseTransformDirection( in vec3 dir, in mat4 matrix ) {
	return normalize( ( vec4( dir, 0.0 ) * matrix ).xyz );
}
mat3 transposeMat3( const in mat3 m ) {
	mat3 tmp;
	tmp[ 0 ] = vec3( m[ 0 ].x, m[ 1 ].x, m[ 2 ].x );
	tmp[ 1 ] = vec3( m[ 0 ].y, m[ 1 ].y, m[ 2 ].y );
	tmp[ 2 ] = vec3( m[ 0 ].z, m[ 1 ].z, m[ 2 ].z );
	return tmp;
}
bool isPerspectiveMatrix( mat4 m ) {
	return m[ 2 ][ 3 ] == - 1.0;
}
vec2 equirectUv( in vec3 dir ) {
	float u = atan( dir.z, dir.x ) * RECIPROCAL_PI2 + 0.5;
	float v = asin( clamp( dir.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;
	return vec2( u, v );
}
vec3 BRDF_Lambert( const in vec3 diffuseColor ) {
	return RECIPROCAL_PI * diffuseColor;
}
vec3 F_Schlick( const in vec3 f0, const in float f90, const in float dotVH ) {
	float fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );
	return f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );
}
float F_Schlick( const in float f0, const in float f90, const in float dotVH ) {
	float fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );
	return f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );
} // validated`,oxe=`#ifdef ENVMAP_TYPE_CUBE_UV
	#define cubeUV_minMipLevel 4.0
	#define cubeUV_minTileSize 16.0
	float getFace( vec3 direction ) {
		vec3 absDirection = abs( direction );
		float face = - 1.0;
		if ( absDirection.x > absDirection.z ) {
			if ( absDirection.x > absDirection.y )
				face = direction.x > 0.0 ? 0.0 : 3.0;
			else
				face = direction.y > 0.0 ? 1.0 : 4.0;
		} else {
			if ( absDirection.z > absDirection.y )
				face = direction.z > 0.0 ? 2.0 : 5.0;
			else
				face = direction.y > 0.0 ? 1.0 : 4.0;
		}
		return face;
	}
	vec2 getUV( vec3 direction, float face ) {
		vec2 uv;
		if ( face == 0.0 ) {
			uv = vec2( direction.z, direction.y ) / abs( direction.x );
		} else if ( face == 1.0 ) {
			uv = vec2( - direction.x, - direction.z ) / abs( direction.y );
		} else if ( face == 2.0 ) {
			uv = vec2( - direction.x, direction.y ) / abs( direction.z );
		} else if ( face == 3.0 ) {
			uv = vec2( - direction.z, direction.y ) / abs( direction.x );
		} else if ( face == 4.0 ) {
			uv = vec2( - direction.x, direction.z ) / abs( direction.y );
		} else {
			uv = vec2( direction.x, direction.y ) / abs( direction.z );
		}
		return 0.5 * ( uv + 1.0 );
	}
	vec3 bilinearCubeUV( sampler2D envMap, vec3 direction, float mipInt ) {
		float face = getFace( direction );
		float filterInt = max( cubeUV_minMipLevel - mipInt, 0.0 );
		mipInt = max( mipInt, cubeUV_minMipLevel );
		float faceSize = exp2( mipInt );
		highp vec2 uv = getUV( direction, face ) * ( faceSize - 2.0 ) + 1.0;
		if ( face > 2.0 ) {
			uv.y += faceSize;
			face -= 3.0;
		}
		uv.x += face * faceSize;
		uv.x += filterInt * 3.0 * cubeUV_minTileSize;
		uv.y += 4.0 * ( exp2( CUBEUV_MAX_MIP ) - faceSize );
		uv.x *= CUBEUV_TEXEL_WIDTH;
		uv.y *= CUBEUV_TEXEL_HEIGHT;
		#ifdef texture2DGradEXT
			return texture2DGradEXT( envMap, uv, vec2( 0.0 ), vec2( 0.0 ) ).rgb;
		#else
			return texture2D( envMap, uv ).rgb;
		#endif
	}
	#define cubeUV_r0 1.0
	#define cubeUV_m0 - 2.0
	#define cubeUV_r1 0.8
	#define cubeUV_m1 - 1.0
	#define cubeUV_r4 0.4
	#define cubeUV_m4 2.0
	#define cubeUV_r5 0.305
	#define cubeUV_m5 3.0
	#define cubeUV_r6 0.21
	#define cubeUV_m6 4.0
	float roughnessToMip( float roughness ) {
		float mip = 0.0;
		if ( roughness >= cubeUV_r1 ) {
			mip = ( cubeUV_r0 - roughness ) * ( cubeUV_m1 - cubeUV_m0 ) / ( cubeUV_r0 - cubeUV_r1 ) + cubeUV_m0;
		} else if ( roughness >= cubeUV_r4 ) {
			mip = ( cubeUV_r1 - roughness ) * ( cubeUV_m4 - cubeUV_m1 ) / ( cubeUV_r1 - cubeUV_r4 ) + cubeUV_m1;
		} else if ( roughness >= cubeUV_r5 ) {
			mip = ( cubeUV_r4 - roughness ) * ( cubeUV_m5 - cubeUV_m4 ) / ( cubeUV_r4 - cubeUV_r5 ) + cubeUV_m4;
		} else if ( roughness >= cubeUV_r6 ) {
			mip = ( cubeUV_r5 - roughness ) * ( cubeUV_m6 - cubeUV_m5 ) / ( cubeUV_r5 - cubeUV_r6 ) + cubeUV_m5;
		} else {
			mip = - 2.0 * log2( 1.16 * roughness );		}
		return mip;
	}
	vec4 textureCubeUV( sampler2D envMap, vec3 sampleDir, float roughness ) {
		float mip = clamp( roughnessToMip( roughness ), cubeUV_m0, CUBEUV_MAX_MIP );
		float mipF = fract( mip );
		float mipInt = floor( mip );
		vec3 color0 = bilinearCubeUV( envMap, sampleDir, mipInt );
		if ( mipF == 0.0 ) {
			return vec4( color0, 1.0 );
		} else {
			vec3 color1 = bilinearCubeUV( envMap, sampleDir, mipInt + 1.0 );
			return vec4( mix( color0, color1, mipF ), 1.0 );
		}
	}
#endif`,axe=`vec3 transformedNormal = objectNormal;
#ifdef USE_TANGENT
	vec3 transformedTangent = objectTangent;
#endif
#ifdef USE_BATCHING
	mat3 bm = mat3( batchingMatrix );
	transformedNormal /= vec3( dot( bm[ 0 ], bm[ 0 ] ), dot( bm[ 1 ], bm[ 1 ] ), dot( bm[ 2 ], bm[ 2 ] ) );
	transformedNormal = bm * transformedNormal;
	#ifdef USE_TANGENT
		transformedTangent = bm * transformedTangent;
	#endif
#endif
#ifdef USE_INSTANCING
	mat3 im = mat3( instanceMatrix );
	transformedNormal /= vec3( dot( im[ 0 ], im[ 0 ] ), dot( im[ 1 ], im[ 1 ] ), dot( im[ 2 ], im[ 2 ] ) );
	transformedNormal = im * transformedNormal;
	#ifdef USE_TANGENT
		transformedTangent = im * transformedTangent;
	#endif
#endif
transformedNormal = normalMatrix * transformedNormal;
#ifdef FLIP_SIDED
	transformedNormal = - transformedNormal;
#endif
#ifdef USE_TANGENT
	transformedTangent = ( modelViewMatrix * vec4( transformedTangent, 0.0 ) ).xyz;
	#ifdef FLIP_SIDED
		transformedTangent = - transformedTangent;
	#endif
#endif`,lxe=`#ifdef USE_DISPLACEMENTMAP
	uniform sampler2D displacementMap;
	uniform float displacementScale;
	uniform float displacementBias;
#endif`,cxe=`#ifdef USE_DISPLACEMENTMAP
	transformed += normalize( objectNormal ) * ( texture2D( displacementMap, vDisplacementMapUv ).x * displacementScale + displacementBias );
#endif`,uxe=`#ifdef USE_EMISSIVEMAP
	vec4 emissiveColor = texture2D( emissiveMap, vEmissiveMapUv );
	#ifdef DECODE_VIDEO_TEXTURE_EMISSIVE
		emissiveColor = sRGBTransferEOTF( emissiveColor );
	#endif
	totalEmissiveRadiance *= emissiveColor.rgb;
#endif`,hxe=`#ifdef USE_EMISSIVEMAP
	uniform sampler2D emissiveMap;
#endif`,fxe="gl_FragColor = linearToOutputTexel( gl_FragColor );",dxe=`vec4 LinearTransferOETF( in vec4 value ) {
	return value;
}
vec4 sRGBTransferEOTF( in vec4 value ) {
	return vec4( mix( pow( value.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), value.rgb * 0.0773993808, vec3( lessThanEqual( value.rgb, vec3( 0.04045 ) ) ) ), value.a );
}
vec4 sRGBTransferOETF( in vec4 value ) {
	return vec4( mix( pow( value.rgb, vec3( 0.41666 ) ) * 1.055 - vec3( 0.055 ), value.rgb * 12.92, vec3( lessThanEqual( value.rgb, vec3( 0.0031308 ) ) ) ), value.a );
}`,pxe=`#ifdef USE_ENVMAP
	#ifdef ENV_WORLDPOS
		vec3 cameraToFrag;
		if ( isOrthographic ) {
			cameraToFrag = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );
		} else {
			cameraToFrag = normalize( vWorldPosition - cameraPosition );
		}
		vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
		#ifdef ENVMAP_MODE_REFLECTION
			vec3 reflectVec = reflect( cameraToFrag, worldNormal );
		#else
			vec3 reflectVec = refract( cameraToFrag, worldNormal, refractionRatio );
		#endif
	#else
		vec3 reflectVec = vReflect;
	#endif
	#ifdef ENVMAP_TYPE_CUBE
		vec4 envColor = textureCube( envMap, envMapRotation * vec3( flipEnvMap * reflectVec.x, reflectVec.yz ) );
	#else
		vec4 envColor = vec4( 0.0 );
	#endif
	#ifdef ENVMAP_BLENDING_MULTIPLY
		outgoingLight = mix( outgoingLight, outgoingLight * envColor.xyz, specularStrength * reflectivity );
	#elif defined( ENVMAP_BLENDING_MIX )
		outgoingLight = mix( outgoingLight, envColor.xyz, specularStrength * reflectivity );
	#elif defined( ENVMAP_BLENDING_ADD )
		outgoingLight += envColor.xyz * specularStrength * reflectivity;
	#endif
#endif`,mxe=`#ifdef USE_ENVMAP
	uniform float envMapIntensity;
	uniform float flipEnvMap;
	uniform mat3 envMapRotation;
	#ifdef ENVMAP_TYPE_CUBE
		uniform samplerCube envMap;
	#else
		uniform sampler2D envMap;
	#endif
	
#endif`,gxe=`#ifdef USE_ENVMAP
	uniform float reflectivity;
	#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( LAMBERT )
		#define ENV_WORLDPOS
	#endif
	#ifdef ENV_WORLDPOS
		varying vec3 vWorldPosition;
		uniform float refractionRatio;
	#else
		varying vec3 vReflect;
	#endif
#endif`,yxe=`#ifdef USE_ENVMAP
	#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( LAMBERT )
		#define ENV_WORLDPOS
	#endif
	#ifdef ENV_WORLDPOS
		
		varying vec3 vWorldPosition;
	#else
		varying vec3 vReflect;
		uniform float refractionRatio;
	#endif
#endif`,vxe=`#ifdef USE_ENVMAP
	#ifdef ENV_WORLDPOS
		vWorldPosition = worldPosition.xyz;
	#else
		vec3 cameraToVertex;
		if ( isOrthographic ) {
			cameraToVertex = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );
		} else {
			cameraToVertex = normalize( worldPosition.xyz - cameraPosition );
		}
		vec3 worldNormal = inverseTransformDirection( transformedNormal, viewMatrix );
		#ifdef ENVMAP_MODE_REFLECTION
			vReflect = reflect( cameraToVertex, worldNormal );
		#else
			vReflect = refract( cameraToVertex, worldNormal, refractionRatio );
		#endif
	#endif
#endif`,xxe=`#ifdef USE_FOG
	vFogDepth = - mvPosition.z;
#endif`,bxe=`#ifdef USE_FOG
	varying float vFogDepth;
#endif`,_xe=`#ifdef USE_FOG
	#ifdef FOG_EXP2
		float fogFactor = 1.0 - exp( - fogDensity * fogDensity * vFogDepth * vFogDepth );
	#else
		float fogFactor = smoothstep( fogNear, fogFar, vFogDepth );
	#endif
	gl_FragColor.rgb = mix( gl_FragColor.rgb, fogColor, fogFactor );
#endif`,wxe=`#ifdef USE_FOG
	uniform vec3 fogColor;
	varying float vFogDepth;
	#ifdef FOG_EXP2
		uniform float fogDensity;
	#else
		uniform float fogNear;
		uniform float fogFar;
	#endif
#endif`,Sxe=`#ifdef USE_GRADIENTMAP
	uniform sampler2D gradientMap;
#endif
vec3 getGradientIrradiance( vec3 normal, vec3 lightDirection ) {
	float dotNL = dot( normal, lightDirection );
	vec2 coord = vec2( dotNL * 0.5 + 0.5, 0.0 );
	#ifdef USE_GRADIENTMAP
		return vec3( texture2D( gradientMap, coord ).r );
	#else
		vec2 fw = fwidth( coord ) * 0.5;
		return mix( vec3( 0.7 ), vec3( 1.0 ), smoothstep( 0.7 - fw.x, 0.7 + fw.x, coord.x ) );
	#endif
}`,Txe=`#ifdef USE_LIGHTMAP
	uniform sampler2D lightMap;
	uniform float lightMapIntensity;
#endif`,Exe=`LambertMaterial material;
material.diffuseColor = diffuseColor.rgb;
material.specularStrength = specularStrength;`,Mxe=`varying vec3 vViewPosition;
struct LambertMaterial {
	vec3 diffuseColor;
	float specularStrength;
};
void RE_Direct_Lambert( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in LambertMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometryNormal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Lambert( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in LambertMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_Lambert
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Lambert`,Axe=`uniform bool receiveShadow;
uniform vec3 ambientLightColor;
#if defined( USE_LIGHT_PROBES )
	uniform vec3 lightProbe[ 9 ];
#endif
vec3 shGetIrradianceAt( in vec3 normal, in vec3 shCoefficients[ 9 ] ) {
	float x = normal.x, y = normal.y, z = normal.z;
	vec3 result = shCoefficients[ 0 ] * 0.886227;
	result += shCoefficients[ 1 ] * 2.0 * 0.511664 * y;
	result += shCoefficients[ 2 ] * 2.0 * 0.511664 * z;
	result += shCoefficients[ 3 ] * 2.0 * 0.511664 * x;
	result += shCoefficients[ 4 ] * 2.0 * 0.429043 * x * y;
	result += shCoefficients[ 5 ] * 2.0 * 0.429043 * y * z;
	result += shCoefficients[ 6 ] * ( 0.743125 * z * z - 0.247708 );
	result += shCoefficients[ 7 ] * 2.0 * 0.429043 * x * z;
	result += shCoefficients[ 8 ] * 0.429043 * ( x * x - y * y );
	return result;
}
vec3 getLightProbeIrradiance( const in vec3 lightProbe[ 9 ], const in vec3 normal ) {
	vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
	vec3 irradiance = shGetIrradianceAt( worldNormal, lightProbe );
	return irradiance;
}
vec3 getAmbientLightIrradiance( const in vec3 ambientLightColor ) {
	vec3 irradiance = ambientLightColor;
	return irradiance;
}
float getDistanceAttenuation( const in float lightDistance, const in float cutoffDistance, const in float decayExponent ) {
	float distanceFalloff = 1.0 / max( pow( lightDistance, decayExponent ), 0.01 );
	if ( cutoffDistance > 0.0 ) {
		distanceFalloff *= pow2( saturate( 1.0 - pow4( lightDistance / cutoffDistance ) ) );
	}
	return distanceFalloff;
}
float getSpotAttenuation( const in float coneCosine, const in float penumbraCosine, const in float angleCosine ) {
	return smoothstep( coneCosine, penumbraCosine, angleCosine );
}
#if NUM_DIR_LIGHTS > 0
	struct DirectionalLight {
		vec3 direction;
		vec3 color;
	};
	uniform DirectionalLight directionalLights[ NUM_DIR_LIGHTS ];
	void getDirectionalLightInfo( const in DirectionalLight directionalLight, out IncidentLight light ) {
		light.color = directionalLight.color;
		light.direction = directionalLight.direction;
		light.visible = true;
	}
#endif
#if NUM_POINT_LIGHTS > 0
	struct PointLight {
		vec3 position;
		vec3 color;
		float distance;
		float decay;
	};
	uniform PointLight pointLights[ NUM_POINT_LIGHTS ];
	void getPointLightInfo( const in PointLight pointLight, const in vec3 geometryPosition, out IncidentLight light ) {
		vec3 lVector = pointLight.position - geometryPosition;
		light.direction = normalize( lVector );
		float lightDistance = length( lVector );
		light.color = pointLight.color;
		light.color *= getDistanceAttenuation( lightDistance, pointLight.distance, pointLight.decay );
		light.visible = ( light.color != vec3( 0.0 ) );
	}
#endif
#if NUM_SPOT_LIGHTS > 0
	struct SpotLight {
		vec3 position;
		vec3 direction;
		vec3 color;
		float distance;
		float decay;
		float coneCos;
		float penumbraCos;
	};
	uniform SpotLight spotLights[ NUM_SPOT_LIGHTS ];
	void getSpotLightInfo( const in SpotLight spotLight, const in vec3 geometryPosition, out IncidentLight light ) {
		vec3 lVector = spotLight.position - geometryPosition;
		light.direction = normalize( lVector );
		float angleCos = dot( light.direction, spotLight.direction );
		float spotAttenuation = getSpotAttenuation( spotLight.coneCos, spotLight.penumbraCos, angleCos );
		if ( spotAttenuation > 0.0 ) {
			float lightDistance = length( lVector );
			light.color = spotLight.color * spotAttenuation;
			light.color *= getDistanceAttenuation( lightDistance, spotLight.distance, spotLight.decay );
			light.visible = ( light.color != vec3( 0.0 ) );
		} else {
			light.color = vec3( 0.0 );
			light.visible = false;
		}
	}
#endif
#if NUM_RECT_AREA_LIGHTS > 0
	struct RectAreaLight {
		vec3 color;
		vec3 position;
		vec3 halfWidth;
		vec3 halfHeight;
	};
	uniform sampler2D ltc_1;	uniform sampler2D ltc_2;
	uniform RectAreaLight rectAreaLights[ NUM_RECT_AREA_LIGHTS ];
#endif
#if NUM_HEMI_LIGHTS > 0
	struct HemisphereLight {
		vec3 direction;
		vec3 skyColor;
		vec3 groundColor;
	};
	uniform HemisphereLight hemisphereLights[ NUM_HEMI_LIGHTS ];
	vec3 getHemisphereLightIrradiance( const in HemisphereLight hemiLight, const in vec3 normal ) {
		float dotNL = dot( normal, hemiLight.direction );
		float hemiDiffuseWeight = 0.5 * dotNL + 0.5;
		vec3 irradiance = mix( hemiLight.groundColor, hemiLight.skyColor, hemiDiffuseWeight );
		return irradiance;
	}
#endif`,Cxe=`#ifdef USE_ENVMAP
	vec3 getIBLIrradiance( const in vec3 normal ) {
		#ifdef ENVMAP_TYPE_CUBE_UV
			vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
			vec4 envMapColor = textureCubeUV( envMap, envMapRotation * worldNormal, 1.0 );
			return PI * envMapColor.rgb * envMapIntensity;
		#else
			return vec3( 0.0 );
		#endif
	}
	vec3 getIBLRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness ) {
		#ifdef ENVMAP_TYPE_CUBE_UV
			vec3 reflectVec = reflect( - viewDir, normal );
			reflectVec = normalize( mix( reflectVec, normal, roughness * roughness) );
			reflectVec = inverseTransformDirection( reflectVec, viewMatrix );
			vec4 envMapColor = textureCubeUV( envMap, envMapRotation * reflectVec, roughness );
			return envMapColor.rgb * envMapIntensity;
		#else
			return vec3( 0.0 );
		#endif
	}
	#ifdef USE_ANISOTROPY
		vec3 getIBLAnisotropyRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness, const in vec3 bitangent, const in float anisotropy ) {
			#ifdef ENVMAP_TYPE_CUBE_UV
				vec3 bentNormal = cross( bitangent, viewDir );
				bentNormal = normalize( cross( bentNormal, bitangent ) );
				bentNormal = normalize( mix( bentNormal, normal, pow2( pow2( 1.0 - anisotropy * ( 1.0 - roughness ) ) ) ) );
				return getIBLRadiance( viewDir, bentNormal, roughness );
			#else
				return vec3( 0.0 );
			#endif
		}
	#endif
#endif`,Pxe=`ToonMaterial material;
material.diffuseColor = diffuseColor.rgb;`,Rxe=`varying vec3 vViewPosition;
struct ToonMaterial {
	vec3 diffuseColor;
};
void RE_Direct_Toon( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {
	vec3 irradiance = getGradientIrradiance( geometryNormal, directLight.direction ) * directLight.color;
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Toon( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_Toon
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Toon`,Nxe=`BlinnPhongMaterial material;
material.diffuseColor = diffuseColor.rgb;
material.specularColor = specular;
material.specularShininess = shininess;
material.specularStrength = specularStrength;`,Oxe=`varying vec3 vViewPosition;
struct BlinnPhongMaterial {
	vec3 diffuseColor;
	vec3 specularColor;
	float specularShininess;
	float specularStrength;
};
void RE_Direct_BlinnPhong( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometryNormal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
	reflectedLight.directSpecular += irradiance * BRDF_BlinnPhong( directLight.direction, geometryViewDir, geometryNormal, material.specularColor, material.specularShininess ) * material.specularStrength;
}
void RE_IndirectDiffuse_BlinnPhong( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_BlinnPhong
#define RE_IndirectDiffuse		RE_IndirectDiffuse_BlinnPhong`,Dxe=`PhysicalMaterial material;
material.diffuseColor = diffuseColor.rgb * ( 1.0 - metalnessFactor );
vec3 dxy = max( abs( dFdx( nonPerturbedNormal ) ), abs( dFdy( nonPerturbedNormal ) ) );
float geometryRoughness = max( max( dxy.x, dxy.y ), dxy.z );
material.roughness = max( roughnessFactor, 0.0525 );material.roughness += geometryRoughness;
material.roughness = min( material.roughness, 1.0 );
#ifdef IOR
	material.ior = ior;
	#ifdef USE_SPECULAR
		float specularIntensityFactor = specularIntensity;
		vec3 specularColorFactor = specularColor;
		#ifdef USE_SPECULAR_COLORMAP
			specularColorFactor *= texture2D( specularColorMap, vSpecularColorMapUv ).rgb;
		#endif
		#ifdef USE_SPECULAR_INTENSITYMAP
			specularIntensityFactor *= texture2D( specularIntensityMap, vSpecularIntensityMapUv ).a;
		#endif
		material.specularF90 = mix( specularIntensityFactor, 1.0, metalnessFactor );
	#else
		float specularIntensityFactor = 1.0;
		vec3 specularColorFactor = vec3( 1.0 );
		material.specularF90 = 1.0;
	#endif
	material.specularColor = mix( min( pow2( ( material.ior - 1.0 ) / ( material.ior + 1.0 ) ) * specularColorFactor, vec3( 1.0 ) ) * specularIntensityFactor, diffuseColor.rgb, metalnessFactor );
#else
	material.specularColor = mix( vec3( 0.04 ), diffuseColor.rgb, metalnessFactor );
	material.specularF90 = 1.0;
#endif
#ifdef USE_CLEARCOAT
	material.clearcoat = clearcoat;
	material.clearcoatRoughness = clearcoatRoughness;
	material.clearcoatF0 = vec3( 0.04 );
	material.clearcoatF90 = 1.0;
	#ifdef USE_CLEARCOATMAP
		material.clearcoat *= texture2D( clearcoatMap, vClearcoatMapUv ).x;
	#endif
	#ifdef USE_CLEARCOAT_ROUGHNESSMAP
		material.clearcoatRoughness *= texture2D( clearcoatRoughnessMap, vClearcoatRoughnessMapUv ).y;
	#endif
	material.clearcoat = saturate( material.clearcoat );	material.clearcoatRoughness = max( material.clearcoatRoughness, 0.0525 );
	material.clearcoatRoughness += geometryRoughness;
	material.clearcoatRoughness = min( material.clearcoatRoughness, 1.0 );
#endif
#ifdef USE_DISPERSION
	material.dispersion = dispersion;
#endif
#ifdef USE_IRIDESCENCE
	material.iridescence = iridescence;
	material.iridescenceIOR = iridescenceIOR;
	#ifdef USE_IRIDESCENCEMAP
		material.iridescence *= texture2D( iridescenceMap, vIridescenceMapUv ).r;
	#endif
	#ifdef USE_IRIDESCENCE_THICKNESSMAP
		material.iridescenceThickness = (iridescenceThicknessMaximum - iridescenceThicknessMinimum) * texture2D( iridescenceThicknessMap, vIridescenceThicknessMapUv ).g + iridescenceThicknessMinimum;
	#else
		material.iridescenceThickness = iridescenceThicknessMaximum;
	#endif
#endif
#ifdef USE_SHEEN
	material.sheenColor = sheenColor;
	#ifdef USE_SHEEN_COLORMAP
		material.sheenColor *= texture2D( sheenColorMap, vSheenColorMapUv ).rgb;
	#endif
	material.sheenRoughness = clamp( sheenRoughness, 0.07, 1.0 );
	#ifdef USE_SHEEN_ROUGHNESSMAP
		material.sheenRoughness *= texture2D( sheenRoughnessMap, vSheenRoughnessMapUv ).a;
	#endif
#endif
#ifdef USE_ANISOTROPY
	#ifdef USE_ANISOTROPYMAP
		mat2 anisotropyMat = mat2( anisotropyVector.x, anisotropyVector.y, - anisotropyVector.y, anisotropyVector.x );
		vec3 anisotropyPolar = texture2D( anisotropyMap, vAnisotropyMapUv ).rgb;
		vec2 anisotropyV = anisotropyMat * normalize( 2.0 * anisotropyPolar.rg - vec2( 1.0 ) ) * anisotropyPolar.b;
	#else
		vec2 anisotropyV = anisotropyVector;
	#endif
	material.anisotropy = length( anisotropyV );
	if( material.anisotropy == 0.0 ) {
		anisotropyV = vec2( 1.0, 0.0 );
	} else {
		anisotropyV /= material.anisotropy;
		material.anisotropy = saturate( material.anisotropy );
	}
	material.alphaT = mix( pow2( material.roughness ), 1.0, pow2( material.anisotropy ) );
	material.anisotropyT = tbn[ 0 ] * anisotropyV.x + tbn[ 1 ] * anisotropyV.y;
	material.anisotropyB = tbn[ 1 ] * anisotropyV.x - tbn[ 0 ] * anisotropyV.y;
#endif`,kxe=`struct PhysicalMaterial {
	vec3 diffuseColor;
	float roughness;
	vec3 specularColor;
	float specularF90;
	float dispersion;
	#ifdef USE_CLEARCOAT
		float clearcoat;
		float clearcoatRoughness;
		vec3 clearcoatF0;
		float clearcoatF90;
	#endif
	#ifdef USE_IRIDESCENCE
		float iridescence;
		float iridescenceIOR;
		float iridescenceThickness;
		vec3 iridescenceFresnel;
		vec3 iridescenceF0;
	#endif
	#ifdef USE_SHEEN
		vec3 sheenColor;
		float sheenRoughness;
	#endif
	#ifdef IOR
		float ior;
	#endif
	#ifdef USE_TRANSMISSION
		float transmission;
		float transmissionAlpha;
		float thickness;
		float attenuationDistance;
		vec3 attenuationColor;
	#endif
	#ifdef USE_ANISOTROPY
		float anisotropy;
		float alphaT;
		vec3 anisotropyT;
		vec3 anisotropyB;
	#endif
};
vec3 clearcoatSpecularDirect = vec3( 0.0 );
vec3 clearcoatSpecularIndirect = vec3( 0.0 );
vec3 sheenSpecularDirect = vec3( 0.0 );
vec3 sheenSpecularIndirect = vec3(0.0 );
vec3 Schlick_to_F0( const in vec3 f, const in float f90, const in float dotVH ) {
    float x = clamp( 1.0 - dotVH, 0.0, 1.0 );
    float x2 = x * x;
    float x5 = clamp( x * x2 * x2, 0.0, 0.9999 );
    return ( f - vec3( f90 ) * x5 ) / ( 1.0 - x5 );
}
float V_GGX_SmithCorrelated( const in float alpha, const in float dotNL, const in float dotNV ) {
	float a2 = pow2( alpha );
	float gv = dotNL * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );
	float gl = dotNV * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );
	return 0.5 / max( gv + gl, EPSILON );
}
float D_GGX( const in float alpha, const in float dotNH ) {
	float a2 = pow2( alpha );
	float denom = pow2( dotNH ) * ( a2 - 1.0 ) + 1.0;
	return RECIPROCAL_PI * a2 / pow2( denom );
}
#ifdef USE_ANISOTROPY
	float V_GGX_SmithCorrelated_Anisotropic( const in float alphaT, const in float alphaB, const in float dotTV, const in float dotBV, const in float dotTL, const in float dotBL, const in float dotNV, const in float dotNL ) {
		float gv = dotNL * length( vec3( alphaT * dotTV, alphaB * dotBV, dotNV ) );
		float gl = dotNV * length( vec3( alphaT * dotTL, alphaB * dotBL, dotNL ) );
		float v = 0.5 / ( gv + gl );
		return saturate(v);
	}
	float D_GGX_Anisotropic( const in float alphaT, const in float alphaB, const in float dotNH, const in float dotTH, const in float dotBH ) {
		float a2 = alphaT * alphaB;
		highp vec3 v = vec3( alphaB * dotTH, alphaT * dotBH, a2 * dotNH );
		highp float v2 = dot( v, v );
		float w2 = a2 / v2;
		return RECIPROCAL_PI * a2 * pow2 ( w2 );
	}
#endif
#ifdef USE_CLEARCOAT
	vec3 BRDF_GGX_Clearcoat( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in PhysicalMaterial material) {
		vec3 f0 = material.clearcoatF0;
		float f90 = material.clearcoatF90;
		float roughness = material.clearcoatRoughness;
		float alpha = pow2( roughness );
		vec3 halfDir = normalize( lightDir + viewDir );
		float dotNL = saturate( dot( normal, lightDir ) );
		float dotNV = saturate( dot( normal, viewDir ) );
		float dotNH = saturate( dot( normal, halfDir ) );
		float dotVH = saturate( dot( viewDir, halfDir ) );
		vec3 F = F_Schlick( f0, f90, dotVH );
		float V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );
		float D = D_GGX( alpha, dotNH );
		return F * ( V * D );
	}
#endif
vec3 BRDF_GGX( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in PhysicalMaterial material ) {
	vec3 f0 = material.specularColor;
	float f90 = material.specularF90;
	float roughness = material.roughness;
	float alpha = pow2( roughness );
	vec3 halfDir = normalize( lightDir + viewDir );
	float dotNL = saturate( dot( normal, lightDir ) );
	float dotNV = saturate( dot( normal, viewDir ) );
	float dotNH = saturate( dot( normal, halfDir ) );
	float dotVH = saturate( dot( viewDir, halfDir ) );
	vec3 F = F_Schlick( f0, f90, dotVH );
	#ifdef USE_IRIDESCENCE
		F = mix( F, material.iridescenceFresnel, material.iridescence );
	#endif
	#ifdef USE_ANISOTROPY
		float dotTL = dot( material.anisotropyT, lightDir );
		float dotTV = dot( material.anisotropyT, viewDir );
		float dotTH = dot( material.anisotropyT, halfDir );
		float dotBL = dot( material.anisotropyB, lightDir );
		float dotBV = dot( material.anisotropyB, viewDir );
		float dotBH = dot( material.anisotropyB, halfDir );
		float V = V_GGX_SmithCorrelated_Anisotropic( material.alphaT, alpha, dotTV, dotBV, dotTL, dotBL, dotNV, dotNL );
		float D = D_GGX_Anisotropic( material.alphaT, alpha, dotNH, dotTH, dotBH );
	#else
		float V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );
		float D = D_GGX( alpha, dotNH );
	#endif
	return F * ( V * D );
}
vec2 LTC_Uv( const in vec3 N, const in vec3 V, const in float roughness ) {
	const float LUT_SIZE = 64.0;
	const float LUT_SCALE = ( LUT_SIZE - 1.0 ) / LUT_SIZE;
	const float LUT_BIAS = 0.5 / LUT_SIZE;
	float dotNV = saturate( dot( N, V ) );
	vec2 uv = vec2( roughness, sqrt( 1.0 - dotNV ) );
	uv = uv * LUT_SCALE + LUT_BIAS;
	return uv;
}
float LTC_ClippedSphereFormFactor( const in vec3 f ) {
	float l = length( f );
	return max( ( l * l + f.z ) / ( l + 1.0 ), 0.0 );
}
vec3 LTC_EdgeVectorFormFactor( const in vec3 v1, const in vec3 v2 ) {
	float x = dot( v1, v2 );
	float y = abs( x );
	float a = 0.8543985 + ( 0.4965155 + 0.0145206 * y ) * y;
	float b = 3.4175940 + ( 4.1616724 + y ) * y;
	float v = a / b;
	float theta_sintheta = ( x > 0.0 ) ? v : 0.5 * inversesqrt( max( 1.0 - x * x, 1e-7 ) ) - v;
	return cross( v1, v2 ) * theta_sintheta;
}
vec3 LTC_Evaluate( const in vec3 N, const in vec3 V, const in vec3 P, const in mat3 mInv, const in vec3 rectCoords[ 4 ] ) {
	vec3 v1 = rectCoords[ 1 ] - rectCoords[ 0 ];
	vec3 v2 = rectCoords[ 3 ] - rectCoords[ 0 ];
	vec3 lightNormal = cross( v1, v2 );
	if( dot( lightNormal, P - rectCoords[ 0 ] ) < 0.0 ) return vec3( 0.0 );
	vec3 T1, T2;
	T1 = normalize( V - N * dot( V, N ) );
	T2 = - cross( N, T1 );
	mat3 mat = mInv * transposeMat3( mat3( T1, T2, N ) );
	vec3 coords[ 4 ];
	coords[ 0 ] = mat * ( rectCoords[ 0 ] - P );
	coords[ 1 ] = mat * ( rectCoords[ 1 ] - P );
	coords[ 2 ] = mat * ( rectCoords[ 2 ] - P );
	coords[ 3 ] = mat * ( rectCoords[ 3 ] - P );
	coords[ 0 ] = normalize( coords[ 0 ] );
	coords[ 1 ] = normalize( coords[ 1 ] );
	coords[ 2 ] = normalize( coords[ 2 ] );
	coords[ 3 ] = normalize( coords[ 3 ] );
	vec3 vectorFormFactor = vec3( 0.0 );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 0 ], coords[ 1 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 1 ], coords[ 2 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 2 ], coords[ 3 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 3 ], coords[ 0 ] );
	float result = LTC_ClippedSphereFormFactor( vectorFormFactor );
	return vec3( result );
}
#if defined( USE_SHEEN )
float D_Charlie( float roughness, float dotNH ) {
	float alpha = pow2( roughness );
	float invAlpha = 1.0 / alpha;
	float cos2h = dotNH * dotNH;
	float sin2h = max( 1.0 - cos2h, 0.0078125 );
	return ( 2.0 + invAlpha ) * pow( sin2h, invAlpha * 0.5 ) / ( 2.0 * PI );
}
float V_Neubelt( float dotNV, float dotNL ) {
	return saturate( 1.0 / ( 4.0 * ( dotNL + dotNV - dotNL * dotNV ) ) );
}
vec3 BRDF_Sheen( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, vec3 sheenColor, const in float sheenRoughness ) {
	vec3 halfDir = normalize( lightDir + viewDir );
	float dotNL = saturate( dot( normal, lightDir ) );
	float dotNV = saturate( dot( normal, viewDir ) );
	float dotNH = saturate( dot( normal, halfDir ) );
	float D = D_Charlie( sheenRoughness, dotNH );
	float V = V_Neubelt( dotNV, dotNL );
	return sheenColor * ( D * V );
}
#endif
float IBLSheenBRDF( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {
	float dotNV = saturate( dot( normal, viewDir ) );
	float r2 = roughness * roughness;
	float a = roughness < 0.25 ? -339.2 * r2 + 161.4 * roughness - 25.9 : -8.48 * r2 + 14.3 * roughness - 9.95;
	float b = roughness < 0.25 ? 44.0 * r2 - 23.7 * roughness + 3.26 : 1.97 * r2 - 3.27 * roughness + 0.72;
	float DG = exp( a * dotNV + b ) + ( roughness < 0.25 ? 0.0 : 0.1 * ( roughness - 0.25 ) );
	return saturate( DG * RECIPROCAL_PI );
}
vec2 DFGApprox( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {
	float dotNV = saturate( dot( normal, viewDir ) );
	const vec4 c0 = vec4( - 1, - 0.0275, - 0.572, 0.022 );
	const vec4 c1 = vec4( 1, 0.0425, 1.04, - 0.04 );
	vec4 r = roughness * c0 + c1;
	float a004 = min( r.x * r.x, exp2( - 9.28 * dotNV ) ) * r.x + r.y;
	vec2 fab = vec2( - 1.04, 1.04 ) * a004 + r.zw;
	return fab;
}
vec3 EnvironmentBRDF( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness ) {
	vec2 fab = DFGApprox( normal, viewDir, roughness );
	return specularColor * fab.x + specularF90 * fab.y;
}
#ifdef USE_IRIDESCENCE
void computeMultiscatteringIridescence( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float iridescence, const in vec3 iridescenceF0, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {
#else
void computeMultiscattering( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {
#endif
	vec2 fab = DFGApprox( normal, viewDir, roughness );
	#ifdef USE_IRIDESCENCE
		vec3 Fr = mix( specularColor, iridescenceF0, iridescence );
	#else
		vec3 Fr = specularColor;
	#endif
	vec3 FssEss = Fr * fab.x + specularF90 * fab.y;
	float Ess = fab.x + fab.y;
	float Ems = 1.0 - Ess;
	vec3 Favg = Fr + ( 1.0 - Fr ) * 0.047619;	vec3 Fms = FssEss * Favg / ( 1.0 - Ems * Favg );
	singleScatter += FssEss;
	multiScatter += Fms * Ems;
}
#if NUM_RECT_AREA_LIGHTS > 0
	void RE_Direct_RectArea_Physical( const in RectAreaLight rectAreaLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
		vec3 normal = geometryNormal;
		vec3 viewDir = geometryViewDir;
		vec3 position = geometryPosition;
		vec3 lightPos = rectAreaLight.position;
		vec3 halfWidth = rectAreaLight.halfWidth;
		vec3 halfHeight = rectAreaLight.halfHeight;
		vec3 lightColor = rectAreaLight.color;
		float roughness = material.roughness;
		vec3 rectCoords[ 4 ];
		rectCoords[ 0 ] = lightPos + halfWidth - halfHeight;		rectCoords[ 1 ] = lightPos - halfWidth - halfHeight;
		rectCoords[ 2 ] = lightPos - halfWidth + halfHeight;
		rectCoords[ 3 ] = lightPos + halfWidth + halfHeight;
		vec2 uv = LTC_Uv( normal, viewDir, roughness );
		vec4 t1 = texture2D( ltc_1, uv );
		vec4 t2 = texture2D( ltc_2, uv );
		mat3 mInv = mat3(
			vec3( t1.x, 0, t1.y ),
			vec3(    0, 1,    0 ),
			vec3( t1.z, 0, t1.w )
		);
		vec3 fresnel = ( material.specularColor * t2.x + ( vec3( 1.0 ) - material.specularColor ) * t2.y );
		reflectedLight.directSpecular += lightColor * fresnel * LTC_Evaluate( normal, viewDir, position, mInv, rectCoords );
		reflectedLight.directDiffuse += lightColor * material.diffuseColor * LTC_Evaluate( normal, viewDir, position, mat3( 1.0 ), rectCoords );
	}
#endif
void RE_Direct_Physical( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometryNormal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	#ifdef USE_CLEARCOAT
		float dotNLcc = saturate( dot( geometryClearcoatNormal, directLight.direction ) );
		vec3 ccIrradiance = dotNLcc * directLight.color;
		clearcoatSpecularDirect += ccIrradiance * BRDF_GGX_Clearcoat( directLight.direction, geometryViewDir, geometryClearcoatNormal, material );
	#endif
	#ifdef USE_SHEEN
		sheenSpecularDirect += irradiance * BRDF_Sheen( directLight.direction, geometryViewDir, geometryNormal, material.sheenColor, material.sheenRoughness );
	#endif
	reflectedLight.directSpecular += irradiance * BRDF_GGX( directLight.direction, geometryViewDir, geometryNormal, material );
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Physical( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectSpecular_Physical( const in vec3 radiance, const in vec3 irradiance, const in vec3 clearcoatRadiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight) {
	#ifdef USE_CLEARCOAT
		clearcoatSpecularIndirect += clearcoatRadiance * EnvironmentBRDF( geometryClearcoatNormal, geometryViewDir, material.clearcoatF0, material.clearcoatF90, material.clearcoatRoughness );
	#endif
	#ifdef USE_SHEEN
		sheenSpecularIndirect += irradiance * material.sheenColor * IBLSheenBRDF( geometryNormal, geometryViewDir, material.sheenRoughness );
	#endif
	vec3 singleScattering = vec3( 0.0 );
	vec3 multiScattering = vec3( 0.0 );
	vec3 cosineWeightedIrradiance = irradiance * RECIPROCAL_PI;
	#ifdef USE_IRIDESCENCE
		computeMultiscatteringIridescence( geometryNormal, geometryViewDir, material.specularColor, material.specularF90, material.iridescence, material.iridescenceFresnel, material.roughness, singleScattering, multiScattering );
	#else
		computeMultiscattering( geometryNormal, geometryViewDir, material.specularColor, material.specularF90, material.roughness, singleScattering, multiScattering );
	#endif
	vec3 totalScattering = singleScattering + multiScattering;
	vec3 diffuse = material.diffuseColor * ( 1.0 - max( max( totalScattering.r, totalScattering.g ), totalScattering.b ) );
	reflectedLight.indirectSpecular += radiance * singleScattering;
	reflectedLight.indirectSpecular += multiScattering * cosineWeightedIrradiance;
	reflectedLight.indirectDiffuse += diffuse * cosineWeightedIrradiance;
}
#define RE_Direct				RE_Direct_Physical
#define RE_Direct_RectArea		RE_Direct_RectArea_Physical
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Physical
#define RE_IndirectSpecular		RE_IndirectSpecular_Physical
float computeSpecularOcclusion( const in float dotNV, const in float ambientOcclusion, const in float roughness ) {
	return saturate( pow( dotNV + ambientOcclusion, exp2( - 16.0 * roughness - 1.0 ) ) - 1.0 + ambientOcclusion );
}`,Ixe=`
vec3 geometryPosition = - vViewPosition;
vec3 geometryNormal = normal;
vec3 geometryViewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( vViewPosition );
vec3 geometryClearcoatNormal = vec3( 0.0 );
#ifdef USE_CLEARCOAT
	geometryClearcoatNormal = clearcoatNormal;
#endif
#ifdef USE_IRIDESCENCE
	float dotNVi = saturate( dot( normal, geometryViewDir ) );
	if ( material.iridescenceThickness == 0.0 ) {
		material.iridescence = 0.0;
	} else {
		material.iridescence = saturate( material.iridescence );
	}
	if ( material.iridescence > 0.0 ) {
		material.iridescenceFresnel = evalIridescence( 1.0, material.iridescenceIOR, dotNVi, material.iridescenceThickness, material.specularColor );
		material.iridescenceF0 = Schlick_to_F0( material.iridescenceFresnel, 1.0, dotNVi );
	}
#endif
IncidentLight directLight;
#if ( NUM_POINT_LIGHTS > 0 ) && defined( RE_Direct )
	PointLight pointLight;
	#if defined( USE_SHADOWMAP ) && NUM_POINT_LIGHT_SHADOWS > 0
	PointLightShadow pointLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {
		pointLight = pointLights[ i ];
		getPointLightInfo( pointLight, geometryPosition, directLight );
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_POINT_LIGHT_SHADOWS )
		pointLightShadow = pointLightShadows[ i ];
		directLight.color *= ( directLight.visible && receiveShadow ) ? getPointShadow( pointShadowMap[ i ], pointLightShadow.shadowMapSize, pointLightShadow.shadowIntensity, pointLightShadow.shadowBias, pointLightShadow.shadowRadius, vPointShadowCoord[ i ], pointLightShadow.shadowCameraNear, pointLightShadow.shadowCameraFar ) : 1.0;
		#endif
		RE_Direct( directLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_SPOT_LIGHTS > 0 ) && defined( RE_Direct )
	SpotLight spotLight;
	vec4 spotColor;
	vec3 spotLightCoord;
	bool inSpotLightMap;
	#if defined( USE_SHADOWMAP ) && NUM_SPOT_LIGHT_SHADOWS > 0
	SpotLightShadow spotLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {
		spotLight = spotLights[ i ];
		getSpotLightInfo( spotLight, geometryPosition, directLight );
		#if ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS )
		#define SPOT_LIGHT_MAP_INDEX UNROLLED_LOOP_INDEX
		#elif ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
		#define SPOT_LIGHT_MAP_INDEX NUM_SPOT_LIGHT_MAPS
		#else
		#define SPOT_LIGHT_MAP_INDEX ( UNROLLED_LOOP_INDEX - NUM_SPOT_LIGHT_SHADOWS + NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS )
		#endif
		#if ( SPOT_LIGHT_MAP_INDEX < NUM_SPOT_LIGHT_MAPS )
			spotLightCoord = vSpotLightCoord[ i ].xyz / vSpotLightCoord[ i ].w;
			inSpotLightMap = all( lessThan( abs( spotLightCoord * 2. - 1. ), vec3( 1.0 ) ) );
			spotColor = texture2D( spotLightMap[ SPOT_LIGHT_MAP_INDEX ], spotLightCoord.xy );
			directLight.color = inSpotLightMap ? directLight.color * spotColor.rgb : directLight.color;
		#endif
		#undef SPOT_LIGHT_MAP_INDEX
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
		spotLightShadow = spotLightShadows[ i ];
		directLight.color *= ( directLight.visible && receiveShadow ) ? getShadow( spotShadowMap[ i ], spotLightShadow.shadowMapSize, spotLightShadow.shadowIntensity, spotLightShadow.shadowBias, spotLightShadow.shadowRadius, vSpotLightCoord[ i ] ) : 1.0;
		#endif
		RE_Direct( directLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_DIR_LIGHTS > 0 ) && defined( RE_Direct )
	DirectionalLight directionalLight;
	#if defined( USE_SHADOWMAP ) && NUM_DIR_LIGHT_SHADOWS > 0
	DirectionalLightShadow directionalLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {
		directionalLight = directionalLights[ i ];
		getDirectionalLightInfo( directionalLight, directLight );
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_DIR_LIGHT_SHADOWS )
		directionalLightShadow = directionalLightShadows[ i ];
		directLight.color *= ( directLight.visible && receiveShadow ) ? getShadow( directionalShadowMap[ i ], directionalLightShadow.shadowMapSize, directionalLightShadow.shadowIntensity, directionalLightShadow.shadowBias, directionalLightShadow.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;
		#endif
		RE_Direct( directLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_RECT_AREA_LIGHTS > 0 ) && defined( RE_Direct_RectArea )
	RectAreaLight rectAreaLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_RECT_AREA_LIGHTS; i ++ ) {
		rectAreaLight = rectAreaLights[ i ];
		RE_Direct_RectArea( rectAreaLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if defined( RE_IndirectDiffuse )
	vec3 iblIrradiance = vec3( 0.0 );
	vec3 irradiance = getAmbientLightIrradiance( ambientLightColor );
	#if defined( USE_LIGHT_PROBES )
		irradiance += getLightProbeIrradiance( lightProbe, geometryNormal );
	#endif
	#if ( NUM_HEMI_LIGHTS > 0 )
		#pragma unroll_loop_start
		for ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {
			irradiance += getHemisphereLightIrradiance( hemisphereLights[ i ], geometryNormal );
		}
		#pragma unroll_loop_end
	#endif
#endif
#if defined( RE_IndirectSpecular )
	vec3 radiance = vec3( 0.0 );
	vec3 clearcoatRadiance = vec3( 0.0 );
#endif`,Lxe=`#if defined( RE_IndirectDiffuse )
	#ifdef USE_LIGHTMAP
		vec4 lightMapTexel = texture2D( lightMap, vLightMapUv );
		vec3 lightMapIrradiance = lightMapTexel.rgb * lightMapIntensity;
		irradiance += lightMapIrradiance;
	#endif
	#if defined( USE_ENVMAP ) && defined( STANDARD ) && defined( ENVMAP_TYPE_CUBE_UV )
		iblIrradiance += getIBLIrradiance( geometryNormal );
	#endif
#endif
#if defined( USE_ENVMAP ) && defined( RE_IndirectSpecular )
	#ifdef USE_ANISOTROPY
		radiance += getIBLAnisotropyRadiance( geometryViewDir, geometryNormal, material.roughness, material.anisotropyB, material.anisotropy );
	#else
		radiance += getIBLRadiance( geometryViewDir, geometryNormal, material.roughness );
	#endif
	#ifdef USE_CLEARCOAT
		clearcoatRadiance += getIBLRadiance( geometryViewDir, geometryClearcoatNormal, material.clearcoatRoughness );
	#endif
#endif`,Fxe=`#if defined( RE_IndirectDiffuse )
	RE_IndirectDiffuse( irradiance, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
#endif
#if defined( RE_IndirectSpecular )
	RE_IndirectSpecular( radiance, iblIrradiance, clearcoatRadiance, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
#endif`,Bxe=`#if defined( USE_LOGDEPTHBUF )
	gl_FragDepth = vIsPerspective == 0.0 ? gl_FragCoord.z : log2( vFragDepth ) * logDepthBufFC * 0.5;
#endif`,Uxe=`#if defined( USE_LOGDEPTHBUF )
	uniform float logDepthBufFC;
	varying float vFragDepth;
	varying float vIsPerspective;
#endif`,zxe=`#ifdef USE_LOGDEPTHBUF
	varying float vFragDepth;
	varying float vIsPerspective;
#endif`,$xe=`#ifdef USE_LOGDEPTHBUF
	vFragDepth = 1.0 + gl_Position.w;
	vIsPerspective = float( isPerspectiveMatrix( projectionMatrix ) );
#endif`,jxe=`#ifdef USE_MAP
	vec4 sampledDiffuseColor = texture2D( map, vMapUv );
	#ifdef DECODE_VIDEO_TEXTURE
		sampledDiffuseColor = sRGBTransferEOTF( sampledDiffuseColor );
	#endif
	diffuseColor *= sampledDiffuseColor;
#endif`,Vxe=`#ifdef USE_MAP
	uniform sampler2D map;
#endif`,Gxe=`#if defined( USE_MAP ) || defined( USE_ALPHAMAP )
	#if defined( USE_POINTS_UV )
		vec2 uv = vUv;
	#else
		vec2 uv = ( uvTransform * vec3( gl_PointCoord.x, 1.0 - gl_PointCoord.y, 1 ) ).xy;
	#endif
#endif
#ifdef USE_MAP
	diffuseColor *= texture2D( map, uv );
#endif
#ifdef USE_ALPHAMAP
	diffuseColor.a *= texture2D( alphaMap, uv ).g;
#endif`,Hxe=`#if defined( USE_POINTS_UV )
	varying vec2 vUv;
#else
	#if defined( USE_MAP ) || defined( USE_ALPHAMAP )
		uniform mat3 uvTransform;
	#endif
#endif
#ifdef USE_MAP
	uniform sampler2D map;
#endif
#ifdef USE_ALPHAMAP
	uniform sampler2D alphaMap;
#endif`,Wxe=`float metalnessFactor = metalness;
#ifdef USE_METALNESSMAP
	vec4 texelMetalness = texture2D( metalnessMap, vMetalnessMapUv );
	metalnessFactor *= texelMetalness.b;
#endif`,qxe=`#ifdef USE_METALNESSMAP
	uniform sampler2D metalnessMap;
#endif`,Xxe=`#ifdef USE_INSTANCING_MORPH
	float morphTargetInfluences[ MORPHTARGETS_COUNT ];
	float morphTargetBaseInfluence = texelFetch( morphTexture, ivec2( 0, gl_InstanceID ), 0 ).r;
	for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
		morphTargetInfluences[i] =  texelFetch( morphTexture, ivec2( i + 1, gl_InstanceID ), 0 ).r;
	}
#endif`,Kxe=`#if defined( USE_MORPHCOLORS )
	vColor *= morphTargetBaseInfluence;
	for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
		#if defined( USE_COLOR_ALPHA )
			if ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ) * morphTargetInfluences[ i ];
		#elif defined( USE_COLOR )
			if ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ).rgb * morphTargetInfluences[ i ];
		#endif
	}
#endif`,Yxe=`#ifdef USE_MORPHNORMALS
	objectNormal *= morphTargetBaseInfluence;
	for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
		if ( morphTargetInfluences[ i ] != 0.0 ) objectNormal += getMorph( gl_VertexID, i, 1 ).xyz * morphTargetInfluences[ i ];
	}
#endif`,Zxe=`#ifdef USE_MORPHTARGETS
	#ifndef USE_INSTANCING_MORPH
		uniform float morphTargetBaseInfluence;
		uniform float morphTargetInfluences[ MORPHTARGETS_COUNT ];
	#endif
	uniform sampler2DArray morphTargetsTexture;
	uniform ivec2 morphTargetsTextureSize;
	vec4 getMorph( const in int vertexIndex, const in int morphTargetIndex, const in int offset ) {
		int texelIndex = vertexIndex * MORPHTARGETS_TEXTURE_STRIDE + offset;
		int y = texelIndex / morphTargetsTextureSize.x;
		int x = texelIndex - y * morphTargetsTextureSize.x;
		ivec3 morphUV = ivec3( x, y, morphTargetIndex );
		return texelFetch( morphTargetsTexture, morphUV, 0 );
	}
#endif`,Qxe=`#ifdef USE_MORPHTARGETS
	transformed *= morphTargetBaseInfluence;
	for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
		if ( morphTargetInfluences[ i ] != 0.0 ) transformed += getMorph( gl_VertexID, i, 0 ).xyz * morphTargetInfluences[ i ];
	}
#endif`,Jxe=`float faceDirection = gl_FrontFacing ? 1.0 : - 1.0;
#ifdef FLAT_SHADED
	vec3 fdx = dFdx( vViewPosition );
	vec3 fdy = dFdy( vViewPosition );
	vec3 normal = normalize( cross( fdx, fdy ) );
#else
	vec3 normal = normalize( vNormal );
	#ifdef DOUBLE_SIDED
		normal *= faceDirection;
	#endif
#endif
#if defined( USE_NORMALMAP_TANGENTSPACE ) || defined( USE_CLEARCOAT_NORMALMAP ) || defined( USE_ANISOTROPY )
	#ifdef USE_TANGENT
		mat3 tbn = mat3( normalize( vTangent ), normalize( vBitangent ), normal );
	#else
		mat3 tbn = getTangentFrame( - vViewPosition, normal,
		#if defined( USE_NORMALMAP )
			vNormalMapUv
		#elif defined( USE_CLEARCOAT_NORMALMAP )
			vClearcoatNormalMapUv
		#else
			vUv
		#endif
		);
	#endif
	#if defined( DOUBLE_SIDED ) && ! defined( FLAT_SHADED )
		tbn[0] *= faceDirection;
		tbn[1] *= faceDirection;
	#endif
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	#ifdef USE_TANGENT
		mat3 tbn2 = mat3( normalize( vTangent ), normalize( vBitangent ), normal );
	#else
		mat3 tbn2 = getTangentFrame( - vViewPosition, normal, vClearcoatNormalMapUv );
	#endif
	#if defined( DOUBLE_SIDED ) && ! defined( FLAT_SHADED )
		tbn2[0] *= faceDirection;
		tbn2[1] *= faceDirection;
	#endif
#endif
vec3 nonPerturbedNormal = normal;`,ebe=`#ifdef USE_NORMALMAP_OBJECTSPACE
	normal = texture2D( normalMap, vNormalMapUv ).xyz * 2.0 - 1.0;
	#ifdef FLIP_SIDED
		normal = - normal;
	#endif
	#ifdef DOUBLE_SIDED
		normal = normal * faceDirection;
	#endif
	normal = normalize( normalMatrix * normal );
#elif defined( USE_NORMALMAP_TANGENTSPACE )
	vec3 mapN = texture2D( normalMap, vNormalMapUv ).xyz * 2.0 - 1.0;
	mapN.xy *= normalScale;
	normal = normalize( tbn * mapN );
#elif defined( USE_BUMPMAP )
	normal = perturbNormalArb( - vViewPosition, normal, dHdxy_fwd(), faceDirection );
#endif`,tbe=`#ifndef FLAT_SHADED
	varying vec3 vNormal;
	#ifdef USE_TANGENT
		varying vec3 vTangent;
		varying vec3 vBitangent;
	#endif
#endif`,nbe=`#ifndef FLAT_SHADED
	varying vec3 vNormal;
	#ifdef USE_TANGENT
		varying vec3 vTangent;
		varying vec3 vBitangent;
	#endif
#endif`,rbe=`#ifndef FLAT_SHADED
	vNormal = normalize( transformedNormal );
	#ifdef USE_TANGENT
		vTangent = normalize( transformedTangent );
		vBitangent = normalize( cross( vNormal, vTangent ) * tangent.w );
	#endif
#endif`,ibe=`#ifdef USE_NORMALMAP
	uniform sampler2D normalMap;
	uniform vec2 normalScale;
#endif
#ifdef USE_NORMALMAP_OBJECTSPACE
	uniform mat3 normalMatrix;
#endif
#if ! defined ( USE_TANGENT ) && ( defined ( USE_NORMALMAP_TANGENTSPACE ) || defined ( USE_CLEARCOAT_NORMALMAP ) || defined( USE_ANISOTROPY ) )
	mat3 getTangentFrame( vec3 eye_pos, vec3 surf_norm, vec2 uv ) {
		vec3 q0 = dFdx( eye_pos.xyz );
		vec3 q1 = dFdy( eye_pos.xyz );
		vec2 st0 = dFdx( uv.st );
		vec2 st1 = dFdy( uv.st );
		vec3 N = surf_norm;
		vec3 q1perp = cross( q1, N );
		vec3 q0perp = cross( N, q0 );
		vec3 T = q1perp * st0.x + q0perp * st1.x;
		vec3 B = q1perp * st0.y + q0perp * st1.y;
		float det = max( dot( T, T ), dot( B, B ) );
		float scale = ( det == 0.0 ) ? 0.0 : inversesqrt( det );
		return mat3( T * scale, B * scale, N );
	}
#endif`,sbe=`#ifdef USE_CLEARCOAT
	vec3 clearcoatNormal = nonPerturbedNormal;
#endif`,obe=`#ifdef USE_CLEARCOAT_NORMALMAP
	vec3 clearcoatMapN = texture2D( clearcoatNormalMap, vClearcoatNormalMapUv ).xyz * 2.0 - 1.0;
	clearcoatMapN.xy *= clearcoatNormalScale;
	clearcoatNormal = normalize( tbn2 * clearcoatMapN );
#endif`,abe=`#ifdef USE_CLEARCOATMAP
	uniform sampler2D clearcoatMap;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	uniform sampler2D clearcoatNormalMap;
	uniform vec2 clearcoatNormalScale;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	uniform sampler2D clearcoatRoughnessMap;
#endif`,lbe=`#ifdef USE_IRIDESCENCEMAP
	uniform sampler2D iridescenceMap;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	uniform sampler2D iridescenceThicknessMap;
#endif`,cbe=`#ifdef OPAQUE
diffuseColor.a = 1.0;
#endif
#ifdef USE_TRANSMISSION
diffuseColor.a *= material.transmissionAlpha;
#endif
gl_FragColor = vec4( outgoingLight, diffuseColor.a );`,ube=`vec3 packNormalToRGB( const in vec3 normal ) {
	return normalize( normal ) * 0.5 + 0.5;
}
vec3 unpackRGBToNormal( const in vec3 rgb ) {
	return 2.0 * rgb.xyz - 1.0;
}
const float PackUpscale = 256. / 255.;const float UnpackDownscale = 255. / 256.;const float ShiftRight8 = 1. / 256.;
const float Inv255 = 1. / 255.;
const vec4 PackFactors = vec4( 1.0, 256.0, 256.0 * 256.0, 256.0 * 256.0 * 256.0 );
const vec2 UnpackFactors2 = vec2( UnpackDownscale, 1.0 / PackFactors.g );
const vec3 UnpackFactors3 = vec3( UnpackDownscale / PackFactors.rg, 1.0 / PackFactors.b );
const vec4 UnpackFactors4 = vec4( UnpackDownscale / PackFactors.rgb, 1.0 / PackFactors.a );
vec4 packDepthToRGBA( const in float v ) {
	if( v <= 0.0 )
		return vec4( 0., 0., 0., 0. );
	if( v >= 1.0 )
		return vec4( 1., 1., 1., 1. );
	float vuf;
	float af = modf( v * PackFactors.a, vuf );
	float bf = modf( vuf * ShiftRight8, vuf );
	float gf = modf( vuf * ShiftRight8, vuf );
	return vec4( vuf * Inv255, gf * PackUpscale, bf * PackUpscale, af );
}
vec3 packDepthToRGB( const in float v ) {
	if( v <= 0.0 )
		return vec3( 0., 0., 0. );
	if( v >= 1.0 )
		return vec3( 1., 1., 1. );
	float vuf;
	float bf = modf( v * PackFactors.b, vuf );
	float gf = modf( vuf * ShiftRight8, vuf );
	return vec3( vuf * Inv255, gf * PackUpscale, bf );
}
vec2 packDepthToRG( const in float v ) {
	if( v <= 0.0 )
		return vec2( 0., 0. );
	if( v >= 1.0 )
		return vec2( 1., 1. );
	float vuf;
	float gf = modf( v * 256., vuf );
	return vec2( vuf * Inv255, gf );
}
float unpackRGBAToDepth( const in vec4 v ) {
	return dot( v, UnpackFactors4 );
}
float unpackRGBToDepth( const in vec3 v ) {
	return dot( v, UnpackFactors3 );
}
float unpackRGToDepth( const in vec2 v ) {
	return v.r * UnpackFactors2.r + v.g * UnpackFactors2.g;
}
vec4 pack2HalfToRGBA( const in vec2 v ) {
	vec4 r = vec4( v.x, fract( v.x * 255.0 ), v.y, fract( v.y * 255.0 ) );
	return vec4( r.x - r.y / 255.0, r.y, r.z - r.w / 255.0, r.w );
}
vec2 unpackRGBATo2Half( const in vec4 v ) {
	return vec2( v.x + ( v.y / 255.0 ), v.z + ( v.w / 255.0 ) );
}
float viewZToOrthographicDepth( const in float viewZ, const in float near, const in float far ) {
	return ( viewZ + near ) / ( near - far );
}
float orthographicDepthToViewZ( const in float depth, const in float near, const in float far ) {
	return depth * ( near - far ) - near;
}
float viewZToPerspectiveDepth( const in float viewZ, const in float near, const in float far ) {
	return ( ( near + viewZ ) * far ) / ( ( far - near ) * viewZ );
}
float perspectiveDepthToViewZ( const in float depth, const in float near, const in float far ) {
	return ( near * far ) / ( ( far - near ) * depth - far );
}`,hbe=`#ifdef PREMULTIPLIED_ALPHA
	gl_FragColor.rgb *= gl_FragColor.a;
#endif`,fbe=`vec4 mvPosition = vec4( transformed, 1.0 );
#ifdef USE_BATCHING
	mvPosition = batchingMatrix * mvPosition;
#endif
#ifdef USE_INSTANCING
	mvPosition = instanceMatrix * mvPosition;
#endif
mvPosition = modelViewMatrix * mvPosition;
gl_Position = projectionMatrix * mvPosition;`,dbe=`#ifdef DITHERING
	gl_FragColor.rgb = dithering( gl_FragColor.rgb );
#endif`,pbe=`#ifdef DITHERING
	vec3 dithering( vec3 color ) {
		float grid_position = rand( gl_FragCoord.xy );
		vec3 dither_shift_RGB = vec3( 0.25 / 255.0, -0.25 / 255.0, 0.25 / 255.0 );
		dither_shift_RGB = mix( 2.0 * dither_shift_RGB, -2.0 * dither_shift_RGB, grid_position );
		return color + dither_shift_RGB;
	}
#endif`,mbe=`float roughnessFactor = roughness;
#ifdef USE_ROUGHNESSMAP
	vec4 texelRoughness = texture2D( roughnessMap, vRoughnessMapUv );
	roughnessFactor *= texelRoughness.g;
#endif`,gbe=`#ifdef USE_ROUGHNESSMAP
	uniform sampler2D roughnessMap;
#endif`,ybe=`#if NUM_SPOT_LIGHT_COORDS > 0
	varying vec4 vSpotLightCoord[ NUM_SPOT_LIGHT_COORDS ];
#endif
#if NUM_SPOT_LIGHT_MAPS > 0
	uniform sampler2D spotLightMap[ NUM_SPOT_LIGHT_MAPS ];
#endif
#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
		uniform sampler2D directionalShadowMap[ NUM_DIR_LIGHT_SHADOWS ];
		varying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];
		struct DirectionalLightShadow {
			float shadowIntensity;
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
		uniform sampler2D spotShadowMap[ NUM_SPOT_LIGHT_SHADOWS ];
		struct SpotLightShadow {
			float shadowIntensity;
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		uniform sampler2D pointShadowMap[ NUM_POINT_LIGHT_SHADOWS ];
		varying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];
		struct PointLightShadow {
			float shadowIntensity;
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
			float shadowCameraNear;
			float shadowCameraFar;
		};
		uniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];
	#endif
	float texture2DCompare( sampler2D depths, vec2 uv, float compare ) {
		return step( compare, unpackRGBAToDepth( texture2D( depths, uv ) ) );
	}
	vec2 texture2DDistribution( sampler2D shadow, vec2 uv ) {
		return unpackRGBATo2Half( texture2D( shadow, uv ) );
	}
	float VSMShadow (sampler2D shadow, vec2 uv, float compare ){
		float occlusion = 1.0;
		vec2 distribution = texture2DDistribution( shadow, uv );
		float hard_shadow = step( compare , distribution.x );
		if (hard_shadow != 1.0 ) {
			float distance = compare - distribution.x ;
			float variance = max( 0.00000, distribution.y * distribution.y );
			float softness_probability = variance / (variance + distance * distance );			softness_probability = clamp( ( softness_probability - 0.3 ) / ( 0.95 - 0.3 ), 0.0, 1.0 );			occlusion = clamp( max( hard_shadow, softness_probability ), 0.0, 1.0 );
		}
		return occlusion;
	}
	float getShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowIntensity, float shadowBias, float shadowRadius, vec4 shadowCoord ) {
		float shadow = 1.0;
		shadowCoord.xyz /= shadowCoord.w;
		shadowCoord.z += shadowBias;
		bool inFrustum = shadowCoord.x >= 0.0 && shadowCoord.x <= 1.0 && shadowCoord.y >= 0.0 && shadowCoord.y <= 1.0;
		bool frustumTest = inFrustum && shadowCoord.z <= 1.0;
		if ( frustumTest ) {
		#if defined( SHADOWMAP_TYPE_PCF )
			vec2 texelSize = vec2( 1.0 ) / shadowMapSize;
			float dx0 = - texelSize.x * shadowRadius;
			float dy0 = - texelSize.y * shadowRadius;
			float dx1 = + texelSize.x * shadowRadius;
			float dy1 = + texelSize.y * shadowRadius;
			float dx2 = dx0 / 2.0;
			float dy2 = dy0 / 2.0;
			float dx3 = dx1 / 2.0;
			float dy3 = dy1 / 2.0;
			shadow = (
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy1 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy1 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy1 ), shadowCoord.z )
			) * ( 1.0 / 17.0 );
		#elif defined( SHADOWMAP_TYPE_PCF_SOFT )
			vec2 texelSize = vec2( 1.0 ) / shadowMapSize;
			float dx = texelSize.x;
			float dy = texelSize.y;
			vec2 uv = shadowCoord.xy;
			vec2 f = fract( uv * shadowMapSize + 0.5 );
			uv -= f * texelSize;
			shadow = (
				texture2DCompare( shadowMap, uv, shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + vec2( dx, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + vec2( 0.0, dy ), shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + texelSize, shadowCoord.z ) +
				mix( texture2DCompare( shadowMap, uv + vec2( -dx, 0.0 ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 0.0 ), shadowCoord.z ),
					 f.x ) +
				mix( texture2DCompare( shadowMap, uv + vec2( -dx, dy ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, dy ), shadowCoord.z ),
					 f.x ) +
				mix( texture2DCompare( shadowMap, uv + vec2( 0.0, -dy ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( 0.0, 2.0 * dy ), shadowCoord.z ),
					 f.y ) +
				mix( texture2DCompare( shadowMap, uv + vec2( dx, -dy ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( dx, 2.0 * dy ), shadowCoord.z ),
					 f.y ) +
				mix( mix( texture2DCompare( shadowMap, uv + vec2( -dx, -dy ), shadowCoord.z ),
						  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, -dy ), shadowCoord.z ),
						  f.x ),
					 mix( texture2DCompare( shadowMap, uv + vec2( -dx, 2.0 * dy ), shadowCoord.z ),
						  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 2.0 * dy ), shadowCoord.z ),
						  f.x ),
					 f.y )
			) * ( 1.0 / 9.0 );
		#elif defined( SHADOWMAP_TYPE_VSM )
			shadow = VSMShadow( shadowMap, shadowCoord.xy, shadowCoord.z );
		#else
			shadow = texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z );
		#endif
		}
		return mix( 1.0, shadow, shadowIntensity );
	}
	vec2 cubeToUV( vec3 v, float texelSizeY ) {
		vec3 absV = abs( v );
		float scaleToCube = 1.0 / max( absV.x, max( absV.y, absV.z ) );
		absV *= scaleToCube;
		v *= scaleToCube * ( 1.0 - 2.0 * texelSizeY );
		vec2 planar = v.xy;
		float almostATexel = 1.5 * texelSizeY;
		float almostOne = 1.0 - almostATexel;
		if ( absV.z >= almostOne ) {
			if ( v.z > 0.0 )
				planar.x = 4.0 - v.x;
		} else if ( absV.x >= almostOne ) {
			float signX = sign( v.x );
			planar.x = v.z * signX + 2.0 * signX;
		} else if ( absV.y >= almostOne ) {
			float signY = sign( v.y );
			planar.x = v.x + 2.0 * signY + 2.0;
			planar.y = v.z * signY - 2.0;
		}
		return vec2( 0.125, 0.25 ) * planar + vec2( 0.375, 0.75 );
	}
	float getPointShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowIntensity, float shadowBias, float shadowRadius, vec4 shadowCoord, float shadowCameraNear, float shadowCameraFar ) {
		float shadow = 1.0;
		vec3 lightToPosition = shadowCoord.xyz;
		
		float lightToPositionLength = length( lightToPosition );
		if ( lightToPositionLength - shadowCameraFar <= 0.0 && lightToPositionLength - shadowCameraNear >= 0.0 ) {
			float dp = ( lightToPositionLength - shadowCameraNear ) / ( shadowCameraFar - shadowCameraNear );			dp += shadowBias;
			vec3 bd3D = normalize( lightToPosition );
			vec2 texelSize = vec2( 1.0 ) / ( shadowMapSize * vec2( 4.0, 2.0 ) );
			#if defined( SHADOWMAP_TYPE_PCF ) || defined( SHADOWMAP_TYPE_PCF_SOFT ) || defined( SHADOWMAP_TYPE_VSM )
				vec2 offset = vec2( - 1, 1 ) * shadowRadius * texelSize.y;
				shadow = (
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyy, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyy, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyx, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyx, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxy, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxy, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxx, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxx, texelSize.y ), dp )
				) * ( 1.0 / 9.0 );
			#else
				shadow = texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp );
			#endif
		}
		return mix( 1.0, shadow, shadowIntensity );
	}
#endif`,vbe=`#if NUM_SPOT_LIGHT_COORDS > 0
	uniform mat4 spotLightMatrix[ NUM_SPOT_LIGHT_COORDS ];
	varying vec4 vSpotLightCoord[ NUM_SPOT_LIGHT_COORDS ];
#endif
#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
		uniform mat4 directionalShadowMatrix[ NUM_DIR_LIGHT_SHADOWS ];
		varying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];
		struct DirectionalLightShadow {
			float shadowIntensity;
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
		struct SpotLightShadow {
			float shadowIntensity;
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		uniform mat4 pointShadowMatrix[ NUM_POINT_LIGHT_SHADOWS ];
		varying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];
		struct PointLightShadow {
			float shadowIntensity;
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
			float shadowCameraNear;
			float shadowCameraFar;
		};
		uniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];
	#endif
#endif`,xbe=`#if ( defined( USE_SHADOWMAP ) && ( NUM_DIR_LIGHT_SHADOWS > 0 || NUM_POINT_LIGHT_SHADOWS > 0 ) ) || ( NUM_SPOT_LIGHT_COORDS > 0 )
	vec3 shadowWorldNormal = inverseTransformDirection( transformedNormal, viewMatrix );
	vec4 shadowWorldPosition;
#endif
#if defined( USE_SHADOWMAP )
	#if NUM_DIR_LIGHT_SHADOWS > 0
		#pragma unroll_loop_start
		for ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {
			shadowWorldPosition = worldPosition + vec4( shadowWorldNormal * directionalLightShadows[ i ].shadowNormalBias, 0 );
			vDirectionalShadowCoord[ i ] = directionalShadowMatrix[ i ] * shadowWorldPosition;
		}
		#pragma unroll_loop_end
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		#pragma unroll_loop_start
		for ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {
			shadowWorldPosition = worldPosition + vec4( shadowWorldNormal * pointLightShadows[ i ].shadowNormalBias, 0 );
			vPointShadowCoord[ i ] = pointShadowMatrix[ i ] * shadowWorldPosition;
		}
		#pragma unroll_loop_end
	#endif
#endif
#if NUM_SPOT_LIGHT_COORDS > 0
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHT_COORDS; i ++ ) {
		shadowWorldPosition = worldPosition;
		#if ( defined( USE_SHADOWMAP ) && UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
			shadowWorldPosition.xyz += shadowWorldNormal * spotLightShadows[ i ].shadowNormalBias;
		#endif
		vSpotLightCoord[ i ] = spotLightMatrix[ i ] * shadowWorldPosition;
	}
	#pragma unroll_loop_end
#endif`,bbe=`float getShadowMask() {
	float shadow = 1.0;
	#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
	DirectionalLightShadow directionalLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {
		directionalLight = directionalLightShadows[ i ];
		shadow *= receiveShadow ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowIntensity, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
	SpotLightShadow spotLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHT_SHADOWS; i ++ ) {
		spotLight = spotLightShadows[ i ];
		shadow *= receiveShadow ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowIntensity, spotLight.shadowBias, spotLight.shadowRadius, vSpotLightCoord[ i ] ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
	PointLightShadow pointLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {
		pointLight = pointLightShadows[ i ];
		shadow *= receiveShadow ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowIntensity, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ], pointLight.shadowCameraNear, pointLight.shadowCameraFar ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#endif
	return shadow;
}`,_be=`#ifdef USE_SKINNING
	mat4 boneMatX = getBoneMatrix( skinIndex.x );
	mat4 boneMatY = getBoneMatrix( skinIndex.y );
	mat4 boneMatZ = getBoneMatrix( skinIndex.z );
	mat4 boneMatW = getBoneMatrix( skinIndex.w );
#endif`,wbe=`#ifdef USE_SKINNING
	uniform mat4 bindMatrix;
	uniform mat4 bindMatrixInverse;
	uniform highp sampler2D boneTexture;
	mat4 getBoneMatrix( const in float i ) {
		int size = textureSize( boneTexture, 0 ).x;
		int j = int( i ) * 4;
		int x = j % size;
		int y = j / size;
		vec4 v1 = texelFetch( boneTexture, ivec2( x, y ), 0 );
		vec4 v2 = texelFetch( boneTexture, ivec2( x + 1, y ), 0 );
		vec4 v3 = texelFetch( boneTexture, ivec2( x + 2, y ), 0 );
		vec4 v4 = texelFetch( boneTexture, ivec2( x + 3, y ), 0 );
		return mat4( v1, v2, v3, v4 );
	}
#endif`,Sbe=`#ifdef USE_SKINNING
	vec4 skinVertex = bindMatrix * vec4( transformed, 1.0 );
	vec4 skinned = vec4( 0.0 );
	skinned += boneMatX * skinVertex * skinWeight.x;
	skinned += boneMatY * skinVertex * skinWeight.y;
	skinned += boneMatZ * skinVertex * skinWeight.z;
	skinned += boneMatW * skinVertex * skinWeight.w;
	transformed = ( bindMatrixInverse * skinned ).xyz;
#endif`,Tbe=`#ifdef USE_SKINNING
	mat4 skinMatrix = mat4( 0.0 );
	skinMatrix += skinWeight.x * boneMatX;
	skinMatrix += skinWeight.y * boneMatY;
	skinMatrix += skinWeight.z * boneMatZ;
	skinMatrix += skinWeight.w * boneMatW;
	skinMatrix = bindMatrixInverse * skinMatrix * bindMatrix;
	objectNormal = vec4( skinMatrix * vec4( objectNormal, 0.0 ) ).xyz;
	#ifdef USE_TANGENT
		objectTangent = vec4( skinMatrix * vec4( objectTangent, 0.0 ) ).xyz;
	#endif
#endif`,Ebe=`float specularStrength;
#ifdef USE_SPECULARMAP
	vec4 texelSpecular = texture2D( specularMap, vSpecularMapUv );
	specularStrength = texelSpecular.r;
#else
	specularStrength = 1.0;
#endif`,Mbe=`#ifdef USE_SPECULARMAP
	uniform sampler2D specularMap;
#endif`,Abe=`#if defined( TONE_MAPPING )
	gl_FragColor.rgb = toneMapping( gl_FragColor.rgb );
#endif`,Cbe=`#ifndef saturate
#define saturate( a ) clamp( a, 0.0, 1.0 )
#endif
uniform float toneMappingExposure;
vec3 LinearToneMapping( vec3 color ) {
	return saturate( toneMappingExposure * color );
}
vec3 ReinhardToneMapping( vec3 color ) {
	color *= toneMappingExposure;
	return saturate( color / ( vec3( 1.0 ) + color ) );
}
vec3 CineonToneMapping( vec3 color ) {
	color *= toneMappingExposure;
	color = max( vec3( 0.0 ), color - 0.004 );
	return pow( ( color * ( 6.2 * color + 0.5 ) ) / ( color * ( 6.2 * color + 1.7 ) + 0.06 ), vec3( 2.2 ) );
}
vec3 RRTAndODTFit( vec3 v ) {
	vec3 a = v * ( v + 0.0245786 ) - 0.000090537;
	vec3 b = v * ( 0.983729 * v + 0.4329510 ) + 0.238081;
	return a / b;
}
vec3 ACESFilmicToneMapping( vec3 color ) {
	const mat3 ACESInputMat = mat3(
		vec3( 0.59719, 0.07600, 0.02840 ),		vec3( 0.35458, 0.90834, 0.13383 ),
		vec3( 0.04823, 0.01566, 0.83777 )
	);
	const mat3 ACESOutputMat = mat3(
		vec3(  1.60475, -0.10208, -0.00327 ),		vec3( -0.53108,  1.10813, -0.07276 ),
		vec3( -0.07367, -0.00605,  1.07602 )
	);
	color *= toneMappingExposure / 0.6;
	color = ACESInputMat * color;
	color = RRTAndODTFit( color );
	color = ACESOutputMat * color;
	return saturate( color );
}
const mat3 LINEAR_REC2020_TO_LINEAR_SRGB = mat3(
	vec3( 1.6605, - 0.1246, - 0.0182 ),
	vec3( - 0.5876, 1.1329, - 0.1006 ),
	vec3( - 0.0728, - 0.0083, 1.1187 )
);
const mat3 LINEAR_SRGB_TO_LINEAR_REC2020 = mat3(
	vec3( 0.6274, 0.0691, 0.0164 ),
	vec3( 0.3293, 0.9195, 0.0880 ),
	vec3( 0.0433, 0.0113, 0.8956 )
);
vec3 agxDefaultContrastApprox( vec3 x ) {
	vec3 x2 = x * x;
	vec3 x4 = x2 * x2;
	return + 15.5 * x4 * x2
		- 40.14 * x4 * x
		+ 31.96 * x4
		- 6.868 * x2 * x
		+ 0.4298 * x2
		+ 0.1191 * x
		- 0.00232;
}
vec3 AgXToneMapping( vec3 color ) {
	const mat3 AgXInsetMatrix = mat3(
		vec3( 0.856627153315983, 0.137318972929847, 0.11189821299995 ),
		vec3( 0.0951212405381588, 0.761241990602591, 0.0767994186031903 ),
		vec3( 0.0482516061458583, 0.101439036467562, 0.811302368396859 )
	);
	const mat3 AgXOutsetMatrix = mat3(
		vec3( 1.1271005818144368, - 0.1413297634984383, - 0.14132976349843826 ),
		vec3( - 0.11060664309660323, 1.157823702216272, - 0.11060664309660294 ),
		vec3( - 0.016493938717834573, - 0.016493938717834257, 1.2519364065950405 )
	);
	const float AgxMinEv = - 12.47393;	const float AgxMaxEv = 4.026069;
	color *= toneMappingExposure;
	color = LINEAR_SRGB_TO_LINEAR_REC2020 * color;
	color = AgXInsetMatrix * color;
	color = max( color, 1e-10 );	color = log2( color );
	color = ( color - AgxMinEv ) / ( AgxMaxEv - AgxMinEv );
	color = clamp( color, 0.0, 1.0 );
	color = agxDefaultContrastApprox( color );
	color = AgXOutsetMatrix * color;
	color = pow( max( vec3( 0.0 ), color ), vec3( 2.2 ) );
	color = LINEAR_REC2020_TO_LINEAR_SRGB * color;
	color = clamp( color, 0.0, 1.0 );
	return color;
}
vec3 NeutralToneMapping( vec3 color ) {
	const float StartCompression = 0.8 - 0.04;
	const float Desaturation = 0.15;
	color *= toneMappingExposure;
	float x = min( color.r, min( color.g, color.b ) );
	float offset = x < 0.08 ? x - 6.25 * x * x : 0.04;
	color -= offset;
	float peak = max( color.r, max( color.g, color.b ) );
	if ( peak < StartCompression ) return color;
	float d = 1. - StartCompression;
	float newPeak = 1. - d * d / ( peak + d - StartCompression );
	color *= newPeak / peak;
	float g = 1. - 1. / ( Desaturation * ( peak - newPeak ) + 1. );
	return mix( color, vec3( newPeak ), g );
}
vec3 CustomToneMapping( vec3 color ) { return color; }`,Pbe=`#ifdef USE_TRANSMISSION
	material.transmission = transmission;
	material.transmissionAlpha = 1.0;
	material.thickness = thickness;
	material.attenuationDistance = attenuationDistance;
	material.attenuationColor = attenuationColor;
	#ifdef USE_TRANSMISSIONMAP
		material.transmission *= texture2D( transmissionMap, vTransmissionMapUv ).r;
	#endif
	#ifdef USE_THICKNESSMAP
		material.thickness *= texture2D( thicknessMap, vThicknessMapUv ).g;
	#endif
	vec3 pos = vWorldPosition;
	vec3 v = normalize( cameraPosition - pos );
	vec3 n = inverseTransformDirection( normal, viewMatrix );
	vec4 transmitted = getIBLVolumeRefraction(
		n, v, material.roughness, material.diffuseColor, material.specularColor, material.specularF90,
		pos, modelMatrix, viewMatrix, projectionMatrix, material.dispersion, material.ior, material.thickness,
		material.attenuationColor, material.attenuationDistance );
	material.transmissionAlpha = mix( material.transmissionAlpha, transmitted.a, material.transmission );
	totalDiffuse = mix( totalDiffuse, transmitted.rgb, material.transmission );
#endif`,Rbe=`#ifdef USE_TRANSMISSION
	uniform float transmission;
	uniform float thickness;
	uniform float attenuationDistance;
	uniform vec3 attenuationColor;
	#ifdef USE_TRANSMISSIONMAP
		uniform sampler2D transmissionMap;
	#endif
	#ifdef USE_THICKNESSMAP
		uniform sampler2D thicknessMap;
	#endif
	uniform vec2 transmissionSamplerSize;
	uniform sampler2D transmissionSamplerMap;
	uniform mat4 modelMatrix;
	uniform mat4 projectionMatrix;
	varying vec3 vWorldPosition;
	float w0( float a ) {
		return ( 1.0 / 6.0 ) * ( a * ( a * ( - a + 3.0 ) - 3.0 ) + 1.0 );
	}
	float w1( float a ) {
		return ( 1.0 / 6.0 ) * ( a *  a * ( 3.0 * a - 6.0 ) + 4.0 );
	}
	float w2( float a ){
		return ( 1.0 / 6.0 ) * ( a * ( a * ( - 3.0 * a + 3.0 ) + 3.0 ) + 1.0 );
	}
	float w3( float a ) {
		return ( 1.0 / 6.0 ) * ( a * a * a );
	}
	float g0( float a ) {
		return w0( a ) + w1( a );
	}
	float g1( float a ) {
		return w2( a ) + w3( a );
	}
	float h0( float a ) {
		return - 1.0 + w1( a ) / ( w0( a ) + w1( a ) );
	}
	float h1( float a ) {
		return 1.0 + w3( a ) / ( w2( a ) + w3( a ) );
	}
	vec4 bicubic( sampler2D tex, vec2 uv, vec4 texelSize, float lod ) {
		uv = uv * texelSize.zw + 0.5;
		vec2 iuv = floor( uv );
		vec2 fuv = fract( uv );
		float g0x = g0( fuv.x );
		float g1x = g1( fuv.x );
		float h0x = h0( fuv.x );
		float h1x = h1( fuv.x );
		float h0y = h0( fuv.y );
		float h1y = h1( fuv.y );
		vec2 p0 = ( vec2( iuv.x + h0x, iuv.y + h0y ) - 0.5 ) * texelSize.xy;
		vec2 p1 = ( vec2( iuv.x + h1x, iuv.y + h0y ) - 0.5 ) * texelSize.xy;
		vec2 p2 = ( vec2( iuv.x + h0x, iuv.y + h1y ) - 0.5 ) * texelSize.xy;
		vec2 p3 = ( vec2( iuv.x + h1x, iuv.y + h1y ) - 0.5 ) * texelSize.xy;
		return g0( fuv.y ) * ( g0x * textureLod( tex, p0, lod ) + g1x * textureLod( tex, p1, lod ) ) +
			g1( fuv.y ) * ( g0x * textureLod( tex, p2, lod ) + g1x * textureLod( tex, p3, lod ) );
	}
	vec4 textureBicubic( sampler2D sampler, vec2 uv, float lod ) {
		vec2 fLodSize = vec2( textureSize( sampler, int( lod ) ) );
		vec2 cLodSize = vec2( textureSize( sampler, int( lod + 1.0 ) ) );
		vec2 fLodSizeInv = 1.0 / fLodSize;
		vec2 cLodSizeInv = 1.0 / cLodSize;
		vec4 fSample = bicubic( sampler, uv, vec4( fLodSizeInv, fLodSize ), floor( lod ) );
		vec4 cSample = bicubic( sampler, uv, vec4( cLodSizeInv, cLodSize ), ceil( lod ) );
		return mix( fSample, cSample, fract( lod ) );
	}
	vec3 getVolumeTransmissionRay( const in vec3 n, const in vec3 v, const in float thickness, const in float ior, const in mat4 modelMatrix ) {
		vec3 refractionVector = refract( - v, normalize( n ), 1.0 / ior );
		vec3 modelScale;
		modelScale.x = length( vec3( modelMatrix[ 0 ].xyz ) );
		modelScale.y = length( vec3( modelMatrix[ 1 ].xyz ) );
		modelScale.z = length( vec3( modelMatrix[ 2 ].xyz ) );
		return normalize( refractionVector ) * thickness * modelScale;
	}
	float applyIorToRoughness( const in float roughness, const in float ior ) {
		return roughness * clamp( ior * 2.0 - 2.0, 0.0, 1.0 );
	}
	vec4 getTransmissionSample( const in vec2 fragCoord, const in float roughness, const in float ior ) {
		float lod = log2( transmissionSamplerSize.x ) * applyIorToRoughness( roughness, ior );
		return textureBicubic( transmissionSamplerMap, fragCoord.xy, lod );
	}
	vec3 volumeAttenuation( const in float transmissionDistance, const in vec3 attenuationColor, const in float attenuationDistance ) {
		if ( isinf( attenuationDistance ) ) {
			return vec3( 1.0 );
		} else {
			vec3 attenuationCoefficient = -log( attenuationColor ) / attenuationDistance;
			vec3 transmittance = exp( - attenuationCoefficient * transmissionDistance );			return transmittance;
		}
	}
	vec4 getIBLVolumeRefraction( const in vec3 n, const in vec3 v, const in float roughness, const in vec3 diffuseColor,
		const in vec3 specularColor, const in float specularF90, const in vec3 position, const in mat4 modelMatrix,
		const in mat4 viewMatrix, const in mat4 projMatrix, const in float dispersion, const in float ior, const in float thickness,
		const in vec3 attenuationColor, const in float attenuationDistance ) {
		vec4 transmittedLight;
		vec3 transmittance;
		#ifdef USE_DISPERSION
			float halfSpread = ( ior - 1.0 ) * 0.025 * dispersion;
			vec3 iors = vec3( ior - halfSpread, ior, ior + halfSpread );
			for ( int i = 0; i < 3; i ++ ) {
				vec3 transmissionRay = getVolumeTransmissionRay( n, v, thickness, iors[ i ], modelMatrix );
				vec3 refractedRayExit = position + transmissionRay;
				vec4 ndcPos = projMatrix * viewMatrix * vec4( refractedRayExit, 1.0 );
				vec2 refractionCoords = ndcPos.xy / ndcPos.w;
				refractionCoords += 1.0;
				refractionCoords /= 2.0;
				vec4 transmissionSample = getTransmissionSample( refractionCoords, roughness, iors[ i ] );
				transmittedLight[ i ] = transmissionSample[ i ];
				transmittedLight.a += transmissionSample.a;
				transmittance[ i ] = diffuseColor[ i ] * volumeAttenuation( length( transmissionRay ), attenuationColor, attenuationDistance )[ i ];
			}
			transmittedLight.a /= 3.0;
		#else
			vec3 transmissionRay = getVolumeTransmissionRay( n, v, thickness, ior, modelMatrix );
			vec3 refractedRayExit = position + transmissionRay;
			vec4 ndcPos = projMatrix * viewMatrix * vec4( refractedRayExit, 1.0 );
			vec2 refractionCoords = ndcPos.xy / ndcPos.w;
			refractionCoords += 1.0;
			refractionCoords /= 2.0;
			transmittedLight = getTransmissionSample( refractionCoords, roughness, ior );
			transmittance = diffuseColor * volumeAttenuation( length( transmissionRay ), attenuationColor, attenuationDistance );
		#endif
		vec3 attenuatedColor = transmittance * transmittedLight.rgb;
		vec3 F = EnvironmentBRDF( n, v, specularColor, specularF90, roughness );
		float transmittanceFactor = ( transmittance.r + transmittance.g + transmittance.b ) / 3.0;
		return vec4( ( 1.0 - F ) * attenuatedColor, 1.0 - ( 1.0 - transmittedLight.a ) * transmittanceFactor );
	}
#endif`,Nbe=`#if defined( USE_UV ) || defined( USE_ANISOTROPY )
	varying vec2 vUv;
#endif
#ifdef USE_MAP
	varying vec2 vMapUv;
#endif
#ifdef USE_ALPHAMAP
	varying vec2 vAlphaMapUv;
#endif
#ifdef USE_LIGHTMAP
	varying vec2 vLightMapUv;
#endif
#ifdef USE_AOMAP
	varying vec2 vAoMapUv;
#endif
#ifdef USE_BUMPMAP
	varying vec2 vBumpMapUv;
#endif
#ifdef USE_NORMALMAP
	varying vec2 vNormalMapUv;
#endif
#ifdef USE_EMISSIVEMAP
	varying vec2 vEmissiveMapUv;
#endif
#ifdef USE_METALNESSMAP
	varying vec2 vMetalnessMapUv;
#endif
#ifdef USE_ROUGHNESSMAP
	varying vec2 vRoughnessMapUv;
#endif
#ifdef USE_ANISOTROPYMAP
	varying vec2 vAnisotropyMapUv;
#endif
#ifdef USE_CLEARCOATMAP
	varying vec2 vClearcoatMapUv;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	varying vec2 vClearcoatNormalMapUv;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	varying vec2 vClearcoatRoughnessMapUv;
#endif
#ifdef USE_IRIDESCENCEMAP
	varying vec2 vIridescenceMapUv;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	varying vec2 vIridescenceThicknessMapUv;
#endif
#ifdef USE_SHEEN_COLORMAP
	varying vec2 vSheenColorMapUv;
#endif
#ifdef USE_SHEEN_ROUGHNESSMAP
	varying vec2 vSheenRoughnessMapUv;
#endif
#ifdef USE_SPECULARMAP
	varying vec2 vSpecularMapUv;
#endif
#ifdef USE_SPECULAR_COLORMAP
	varying vec2 vSpecularColorMapUv;
#endif
#ifdef USE_SPECULAR_INTENSITYMAP
	varying vec2 vSpecularIntensityMapUv;
#endif
#ifdef USE_TRANSMISSIONMAP
	uniform mat3 transmissionMapTransform;
	varying vec2 vTransmissionMapUv;
#endif
#ifdef USE_THICKNESSMAP
	uniform mat3 thicknessMapTransform;
	varying vec2 vThicknessMapUv;
#endif`,Obe=`#if defined( USE_UV ) || defined( USE_ANISOTROPY )
	varying vec2 vUv;
#endif
#ifdef USE_MAP
	uniform mat3 mapTransform;
	varying vec2 vMapUv;
#endif
#ifdef USE_ALPHAMAP
	uniform mat3 alphaMapTransform;
	varying vec2 vAlphaMapUv;
#endif
#ifdef USE_LIGHTMAP
	uniform mat3 lightMapTransform;
	varying vec2 vLightMapUv;
#endif
#ifdef USE_AOMAP
	uniform mat3 aoMapTransform;
	varying vec2 vAoMapUv;
#endif
#ifdef USE_BUMPMAP
	uniform mat3 bumpMapTransform;
	varying vec2 vBumpMapUv;
#endif
#ifdef USE_NORMALMAP
	uniform mat3 normalMapTransform;
	varying vec2 vNormalMapUv;
#endif
#ifdef USE_DISPLACEMENTMAP
	uniform mat3 displacementMapTransform;
	varying vec2 vDisplacementMapUv;
#endif
#ifdef USE_EMISSIVEMAP
	uniform mat3 emissiveMapTransform;
	varying vec2 vEmissiveMapUv;
#endif
#ifdef USE_METALNESSMAP
	uniform mat3 metalnessMapTransform;
	varying vec2 vMetalnessMapUv;
#endif
#ifdef USE_ROUGHNESSMAP
	uniform mat3 roughnessMapTransform;
	varying vec2 vRoughnessMapUv;
#endif
#ifdef USE_ANISOTROPYMAP
	uniform mat3 anisotropyMapTransform;
	varying vec2 vAnisotropyMapUv;
#endif
#ifdef USE_CLEARCOATMAP
	uniform mat3 clearcoatMapTransform;
	varying vec2 vClearcoatMapUv;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	uniform mat3 clearcoatNormalMapTransform;
	varying vec2 vClearcoatNormalMapUv;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	uniform mat3 clearcoatRoughnessMapTransform;
	varying vec2 vClearcoatRoughnessMapUv;
#endif
#ifdef USE_SHEEN_COLORMAP
	uniform mat3 sheenColorMapTransform;
	varying vec2 vSheenColorMapUv;
#endif
#ifdef USE_SHEEN_ROUGHNESSMAP
	uniform mat3 sheenRoughnessMapTransform;
	varying vec2 vSheenRoughnessMapUv;
#endif
#ifdef USE_IRIDESCENCEMAP
	uniform mat3 iridescenceMapTransform;
	varying vec2 vIridescenceMapUv;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	uniform mat3 iridescenceThicknessMapTransform;
	varying vec2 vIridescenceThicknessMapUv;
#endif
#ifdef USE_SPECULARMAP
	uniform mat3 specularMapTransform;
	varying vec2 vSpecularMapUv;
#endif
#ifdef USE_SPECULAR_COLORMAP
	uniform mat3 specularColorMapTransform;
	varying vec2 vSpecularColorMapUv;
#endif
#ifdef USE_SPECULAR_INTENSITYMAP
	uniform mat3 specularIntensityMapTransform;
	varying vec2 vSpecularIntensityMapUv;
#endif
#ifdef USE_TRANSMISSIONMAP
	uniform mat3 transmissionMapTransform;
	varying vec2 vTransmissionMapUv;
#endif
#ifdef USE_THICKNESSMAP
	uniform mat3 thicknessMapTransform;
	varying vec2 vThicknessMapUv;
#endif`,Dbe=`#if defined( USE_UV ) || defined( USE_ANISOTROPY )
	vUv = vec3( uv, 1 ).xy;
#endif
#ifdef USE_MAP
	vMapUv = ( mapTransform * vec3( MAP_UV, 1 ) ).xy;
#endif
#ifdef USE_ALPHAMAP
	vAlphaMapUv = ( alphaMapTransform * vec3( ALPHAMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_LIGHTMAP
	vLightMapUv = ( lightMapTransform * vec3( LIGHTMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_AOMAP
	vAoMapUv = ( aoMapTransform * vec3( AOMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_BUMPMAP
	vBumpMapUv = ( bumpMapTransform * vec3( BUMPMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_NORMALMAP
	vNormalMapUv = ( normalMapTransform * vec3( NORMALMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_DISPLACEMENTMAP
	vDisplacementMapUv = ( displacementMapTransform * vec3( DISPLACEMENTMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_EMISSIVEMAP
	vEmissiveMapUv = ( emissiveMapTransform * vec3( EMISSIVEMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_METALNESSMAP
	vMetalnessMapUv = ( metalnessMapTransform * vec3( METALNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_ROUGHNESSMAP
	vRoughnessMapUv = ( roughnessMapTransform * vec3( ROUGHNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_ANISOTROPYMAP
	vAnisotropyMapUv = ( anisotropyMapTransform * vec3( ANISOTROPYMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_CLEARCOATMAP
	vClearcoatMapUv = ( clearcoatMapTransform * vec3( CLEARCOATMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	vClearcoatNormalMapUv = ( clearcoatNormalMapTransform * vec3( CLEARCOAT_NORMALMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	vClearcoatRoughnessMapUv = ( clearcoatRoughnessMapTransform * vec3( CLEARCOAT_ROUGHNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_IRIDESCENCEMAP
	vIridescenceMapUv = ( iridescenceMapTransform * vec3( IRIDESCENCEMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	vIridescenceThicknessMapUv = ( iridescenceThicknessMapTransform * vec3( IRIDESCENCE_THICKNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SHEEN_COLORMAP
	vSheenColorMapUv = ( sheenColorMapTransform * vec3( SHEEN_COLORMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SHEEN_ROUGHNESSMAP
	vSheenRoughnessMapUv = ( sheenRoughnessMapTransform * vec3( SHEEN_ROUGHNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SPECULARMAP
	vSpecularMapUv = ( specularMapTransform * vec3( SPECULARMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SPECULAR_COLORMAP
	vSpecularColorMapUv = ( specularColorMapTransform * vec3( SPECULAR_COLORMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SPECULAR_INTENSITYMAP
	vSpecularIntensityMapUv = ( specularIntensityMapTransform * vec3( SPECULAR_INTENSITYMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_TRANSMISSIONMAP
	vTransmissionMapUv = ( transmissionMapTransform * vec3( TRANSMISSIONMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_THICKNESSMAP
	vThicknessMapUv = ( thicknessMapTransform * vec3( THICKNESSMAP_UV, 1 ) ).xy;
#endif`,kbe=`#if defined( USE_ENVMAP ) || defined( DISTANCE ) || defined ( USE_SHADOWMAP ) || defined ( USE_TRANSMISSION ) || NUM_SPOT_LIGHT_COORDS > 0
	vec4 worldPosition = vec4( transformed, 1.0 );
	#ifdef USE_BATCHING
		worldPosition = batchingMatrix * worldPosition;
	#endif
	#ifdef USE_INSTANCING
		worldPosition = instanceMatrix * worldPosition;
	#endif
	worldPosition = modelMatrix * worldPosition;
#endif`;const Ibe=`varying vec2 vUv;
uniform mat3 uvTransform;
void main() {
	vUv = ( uvTransform * vec3( uv, 1 ) ).xy;
	gl_Position = vec4( position.xy, 1.0, 1.0 );
}`,Lbe=`uniform sampler2D t2D;
uniform float backgroundIntensity;
varying vec2 vUv;
void main() {
	vec4 texColor = texture2D( t2D, vUv );
	#ifdef DECODE_VIDEO_TEXTURE
		texColor = vec4( mix( pow( texColor.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), texColor.rgb * 0.0773993808, vec3( lessThanEqual( texColor.rgb, vec3( 0.04045 ) ) ) ), texColor.w );
	#endif
	texColor.rgb *= backgroundIntensity;
	gl_FragColor = texColor;
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
}`,Fbe=`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
	gl_Position.z = gl_Position.w;
}`,Bbe=`#ifdef ENVMAP_TYPE_CUBE
	uniform samplerCube envMap;
#elif defined( ENVMAP_TYPE_CUBE_UV )
	uniform sampler2D envMap;
#endif
uniform float flipEnvMap;
uniform float backgroundBlurriness;
uniform float backgroundIntensity;
uniform mat3 backgroundRotation;
varying vec3 vWorldDirection;
#include <cube_uv_reflection_fragment>
void main() {
	#ifdef ENVMAP_TYPE_CUBE
		vec4 texColor = textureCube( envMap, backgroundRotation * vec3( flipEnvMap * vWorldDirection.x, vWorldDirection.yz ) );
	#elif defined( ENVMAP_TYPE_CUBE_UV )
		vec4 texColor = textureCubeUV( envMap, backgroundRotation * vWorldDirection, backgroundBlurriness );
	#else
		vec4 texColor = vec4( 0.0, 0.0, 0.0, 1.0 );
	#endif
	texColor.rgb *= backgroundIntensity;
	gl_FragColor = texColor;
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
}`,Ube=`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
	gl_Position.z = gl_Position.w;
}`,zbe=`uniform samplerCube tCube;
uniform float tFlip;
uniform float opacity;
varying vec3 vWorldDirection;
void main() {
	vec4 texColor = textureCube( tCube, vec3( tFlip * vWorldDirection.x, vWorldDirection.yz ) );
	gl_FragColor = texColor;
	gl_FragColor.a *= opacity;
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
}`,$be=`#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
varying vec2 vHighPrecisionZW;
void main() {
	#include <uv_vertex>
	#include <batching_vertex>
	#include <skinbase_vertex>
	#include <morphinstance_vertex>
	#ifdef USE_DISPLACEMENTMAP
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vHighPrecisionZW = gl_Position.zw;
}`,jbe=`#if DEPTH_PACKING == 3200
	uniform float opacity;
#endif
#include <common>
#include <packing>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
varying vec2 vHighPrecisionZW;
void main() {
	vec4 diffuseColor = vec4( 1.0 );
	#include <clipping_planes_fragment>
	#if DEPTH_PACKING == 3200
		diffuseColor.a = opacity;
	#endif
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <logdepthbuf_fragment>
	float fragCoordZ = 0.5 * vHighPrecisionZW[0] / vHighPrecisionZW[1] + 0.5;
	#if DEPTH_PACKING == 3200
		gl_FragColor = vec4( vec3( 1.0 - fragCoordZ ), opacity );
	#elif DEPTH_PACKING == 3201
		gl_FragColor = packDepthToRGBA( fragCoordZ );
	#elif DEPTH_PACKING == 3202
		gl_FragColor = vec4( packDepthToRGB( fragCoordZ ), 1.0 );
	#elif DEPTH_PACKING == 3203
		gl_FragColor = vec4( packDepthToRG( fragCoordZ ), 0.0, 1.0 );
	#endif
}`,Vbe=`#define DISTANCE
varying vec3 vWorldPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <batching_vertex>
	#include <skinbase_vertex>
	#include <morphinstance_vertex>
	#ifdef USE_DISPLACEMENTMAP
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <worldpos_vertex>
	#include <clipping_planes_vertex>
	vWorldPosition = worldPosition.xyz;
}`,Gbe=`#define DISTANCE
uniform vec3 referencePosition;
uniform float nearDistance;
uniform float farDistance;
varying vec3 vWorldPosition;
#include <common>
#include <packing>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <clipping_planes_pars_fragment>
void main () {
	vec4 diffuseColor = vec4( 1.0 );
	#include <clipping_planes_fragment>
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	float dist = length( vWorldPosition - referencePosition );
	dist = ( dist - nearDistance ) / ( farDistance - nearDistance );
	dist = saturate( dist );
	gl_FragColor = packDepthToRGBA( dist );
}`,Hbe=`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
}`,Wbe=`uniform sampler2D tEquirect;
varying vec3 vWorldDirection;
#include <common>
void main() {
	vec3 direction = normalize( vWorldDirection );
	vec2 sampleUV = equirectUv( direction );
	gl_FragColor = texture2D( tEquirect, sampleUV );
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
}`,qbe=`uniform float scale;
attribute float lineDistance;
varying float vLineDistance;
#include <common>
#include <uv_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	vLineDistance = scale * lineDistance;
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
}`,Xbe=`uniform vec3 diffuse;
uniform float opacity;
uniform float dashSize;
uniform float totalSize;
varying float vLineDistance;
#include <common>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	if ( mod( vLineDistance, totalSize ) > dashSize ) {
		discard;
	}
	vec3 outgoingLight = vec3( 0.0 );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	outgoingLight = diffuseColor.rgb;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
}`,Kbe=`#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#if defined ( USE_ENVMAP ) || defined ( USE_SKINNING )
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinbase_vertex>
		#include <skinnormal_vertex>
		#include <defaultnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <fog_vertex>
}`,Ybe=`uniform vec3 diffuse;
uniform float opacity;
#ifndef FLAT_SHADED
	varying vec3 vNormal;
#endif
#include <common>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <fog_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <specularmap_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	#ifdef USE_LIGHTMAP
		vec4 lightMapTexel = texture2D( lightMap, vLightMapUv );
		reflectedLight.indirectDiffuse += lightMapTexel.rgb * lightMapIntensity * RECIPROCAL_PI;
	#else
		reflectedLight.indirectDiffuse += vec3( 1.0 );
	#endif
	#include <aomap_fragment>
	reflectedLight.indirectDiffuse *= diffuseColor.rgb;
	vec3 outgoingLight = reflectedLight.indirectDiffuse;
	#include <envmap_fragment>
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,Zbe=`#define LAMBERT
varying vec3 vViewPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,Qbe=`#define LAMBERT
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float opacity;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_lambert_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <specularmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_lambert_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;
	#include <envmap_fragment>
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,Jbe=`#define MATCAP
varying vec3 vViewPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <color_pars_vertex>
#include <displacementmap_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
	vViewPosition = - mvPosition.xyz;
}`,e_e=`#define MATCAP
uniform vec3 diffuse;
uniform float opacity;
uniform sampler2D matcap;
varying vec3 vViewPosition;
#include <common>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <fog_pars_fragment>
#include <normal_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	vec3 viewDir = normalize( vViewPosition );
	vec3 x = normalize( vec3( viewDir.z, 0.0, - viewDir.x ) );
	vec3 y = cross( viewDir, x );
	vec2 uv = vec2( dot( x, normal ), dot( y, normal ) ) * 0.495 + 0.5;
	#ifdef USE_MATCAP
		vec4 matcapColor = texture2D( matcap, uv );
	#else
		vec4 matcapColor = vec4( vec3( mix( 0.2, 0.8, uv.y ) ), 1.0 );
	#endif
	vec3 outgoingLight = diffuseColor.rgb * matcapColor.rgb;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,t_e=`#define NORMAL
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )
	varying vec3 vViewPosition;
#endif
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphinstance_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )
	vViewPosition = - mvPosition.xyz;
#endif
}`,n_e=`#define NORMAL
uniform float opacity;
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )
	varying vec3 vViewPosition;
#endif
#include <packing>
#include <uv_pars_fragment>
#include <normal_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( 0.0, 0.0, 0.0, opacity );
	#include <clipping_planes_fragment>
	#include <logdepthbuf_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	gl_FragColor = vec4( packNormalToRGB( normal ), diffuseColor.a );
	#ifdef OPAQUE
		gl_FragColor.a = 1.0;
	#endif
}`,r_e=`#define PHONG
varying vec3 vViewPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphinstance_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,i_e=`#define PHONG
uniform vec3 diffuse;
uniform vec3 emissive;
uniform vec3 specular;
uniform float shininess;
uniform float opacity;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_phong_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <specularmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_phong_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;
	#include <envmap_fragment>
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,s_e=`#define STANDARD
varying vec3 vViewPosition;
#ifdef USE_TRANSMISSION
	varying vec3 vWorldPosition;
#endif
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
#ifdef USE_TRANSMISSION
	vWorldPosition = worldPosition.xyz;
#endif
}`,o_e=`#define STANDARD
#ifdef PHYSICAL
	#define IOR
	#define USE_SPECULAR
#endif
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float roughness;
uniform float metalness;
uniform float opacity;
#ifdef IOR
	uniform float ior;
#endif
#ifdef USE_SPECULAR
	uniform float specularIntensity;
	uniform vec3 specularColor;
	#ifdef USE_SPECULAR_COLORMAP
		uniform sampler2D specularColorMap;
	#endif
	#ifdef USE_SPECULAR_INTENSITYMAP
		uniform sampler2D specularIntensityMap;
	#endif
#endif
#ifdef USE_CLEARCOAT
	uniform float clearcoat;
	uniform float clearcoatRoughness;
#endif
#ifdef USE_DISPERSION
	uniform float dispersion;
#endif
#ifdef USE_IRIDESCENCE
	uniform float iridescence;
	uniform float iridescenceIOR;
	uniform float iridescenceThicknessMinimum;
	uniform float iridescenceThicknessMaximum;
#endif
#ifdef USE_SHEEN
	uniform vec3 sheenColor;
	uniform float sheenRoughness;
	#ifdef USE_SHEEN_COLORMAP
		uniform sampler2D sheenColorMap;
	#endif
	#ifdef USE_SHEEN_ROUGHNESSMAP
		uniform sampler2D sheenRoughnessMap;
	#endif
#endif
#ifdef USE_ANISOTROPY
	uniform vec2 anisotropyVector;
	#ifdef USE_ANISOTROPYMAP
		uniform sampler2D anisotropyMap;
	#endif
#endif
varying vec3 vViewPosition;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <iridescence_fragment>
#include <cube_uv_reflection_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_physical_pars_fragment>
#include <fog_pars_fragment>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_physical_pars_fragment>
#include <transmission_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <clearcoat_pars_fragment>
#include <iridescence_pars_fragment>
#include <roughnessmap_pars_fragment>
#include <metalnessmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <roughnessmap_fragment>
	#include <metalnessmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <clearcoat_normal_fragment_begin>
	#include <clearcoat_normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_physical_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 totalDiffuse = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse;
	vec3 totalSpecular = reflectedLight.directSpecular + reflectedLight.indirectSpecular;
	#include <transmission_fragment>
	vec3 outgoingLight = totalDiffuse + totalSpecular + totalEmissiveRadiance;
	#ifdef USE_SHEEN
		float sheenEnergyComp = 1.0 - 0.157 * max3( material.sheenColor );
		outgoingLight = outgoingLight * sheenEnergyComp + sheenSpecularDirect + sheenSpecularIndirect;
	#endif
	#ifdef USE_CLEARCOAT
		float dotNVcc = saturate( dot( geometryClearcoatNormal, geometryViewDir ) );
		vec3 Fcc = F_Schlick( material.clearcoatF0, material.clearcoatF90, dotNVcc );
		outgoingLight = outgoingLight * ( 1.0 - material.clearcoat * Fcc ) + ( clearcoatSpecularDirect + clearcoatSpecularIndirect ) * material.clearcoat;
	#endif
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,a_e=`#define TOON
varying vec3 vViewPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,l_e=`#define TOON
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float opacity;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <gradientmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_toon_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_toon_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,c_e=`uniform float size;
uniform float scale;
#include <common>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
#ifdef USE_POINTS_UV
	varying vec2 vUv;
	uniform mat3 uvTransform;
#endif
void main() {
	#ifdef USE_POINTS_UV
		vUv = ( uvTransform * vec3( uv, 1 ) ).xy;
	#endif
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <project_vertex>
	gl_PointSize = size;
	#ifdef USE_SIZEATTENUATION
		bool isPerspective = isPerspectiveMatrix( projectionMatrix );
		if ( isPerspective ) gl_PointSize *= ( scale / - mvPosition.z );
	#endif
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <worldpos_vertex>
	#include <fog_vertex>
}`,u_e=`uniform vec3 diffuse;
uniform float opacity;
#include <common>
#include <color_pars_fragment>
#include <map_particle_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	vec3 outgoingLight = vec3( 0.0 );
	#include <logdepthbuf_fragment>
	#include <map_particle_fragment>
	#include <color_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	outgoingLight = diffuseColor.rgb;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
}`,h_e=`#include <common>
#include <batching_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <shadowmap_pars_vertex>
void main() {
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphinstance_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,f_e=`uniform vec3 color;
uniform float opacity;
#include <common>
#include <packing>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <logdepthbuf_pars_fragment>
#include <shadowmap_pars_fragment>
#include <shadowmask_pars_fragment>
void main() {
	#include <logdepthbuf_fragment>
	gl_FragColor = vec4( color, opacity * ( 1.0 - getShadowMask() ) );
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
}`,d_e=`uniform float rotation;
uniform vec2 center;
#include <common>
#include <uv_pars_vertex>
#include <fog_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	vec4 mvPosition = modelViewMatrix[ 3 ];
	vec2 scale = vec2( length( modelMatrix[ 0 ].xyz ), length( modelMatrix[ 1 ].xyz ) );
	#ifndef USE_SIZEATTENUATION
		bool isPerspective = isPerspectiveMatrix( projectionMatrix );
		if ( isPerspective ) scale *= - mvPosition.z;
	#endif
	vec2 alignedPosition = ( position.xy - ( center - vec2( 0.5 ) ) ) * scale;
	vec2 rotatedPosition;
	rotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;
	rotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;
	mvPosition.xy += rotatedPosition;
	gl_Position = projectionMatrix * mvPosition;
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
}`,p_e=`uniform vec3 diffuse;
uniform float opacity;
#include <common>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	vec3 outgoingLight = vec3( 0.0 );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	outgoingLight = diffuseColor.rgb;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
}`,Zt={alphahash_fragment:L0e,alphahash_pars_fragment:F0e,alphamap_fragment:B0e,alphamap_pars_fragment:U0e,alphatest_fragment:z0e,alphatest_pars_fragment:$0e,aomap_fragment:j0e,aomap_pars_fragment:V0e,batching_pars_vertex:G0e,batching_vertex:H0e,begin_vertex:W0e,beginnormal_vertex:q0e,bsdfs:X0e,iridescence_fragment:K0e,bumpmap_pars_fragment:Y0e,clipping_planes_fragment:Z0e,clipping_planes_pars_fragment:Q0e,clipping_planes_pars_vertex:J0e,clipping_planes_vertex:exe,color_fragment:txe,color_pars_fragment:nxe,color_pars_vertex:rxe,color_vertex:ixe,common:sxe,cube_uv_reflection_fragment:oxe,defaultnormal_vertex:axe,displacementmap_pars_vertex:lxe,displacementmap_vertex:cxe,emissivemap_fragment:uxe,emissivemap_pars_fragment:hxe,colorspace_fragment:fxe,colorspace_pars_fragment:dxe,envmap_fragment:pxe,envmap_common_pars_fragment:mxe,envmap_pars_fragment:gxe,envmap_pars_vertex:yxe,envmap_physical_pars_fragment:Cxe,envmap_vertex:vxe,fog_vertex:xxe,fog_pars_vertex:bxe,fog_fragment:_xe,fog_pars_fragment:wxe,gradientmap_pars_fragment:Sxe,lightmap_pars_fragment:Txe,lights_lambert_fragment:Exe,lights_lambert_pars_fragment:Mxe,lights_pars_begin:Axe,lights_toon_fragment:Pxe,lights_toon_pars_fragment:Rxe,lights_phong_fragment:Nxe,lights_phong_pars_fragment:Oxe,lights_physical_fragment:Dxe,lights_physical_pars_fragment:kxe,lights_fragment_begin:Ixe,lights_fragment_maps:Lxe,lights_fragment_end:Fxe,logdepthbuf_fragment:Bxe,logdepthbuf_pars_fragment:Uxe,logdepthbuf_pars_vertex:zxe,logdepthbuf_vertex:$xe,map_fragment:jxe,map_pars_fragment:Vxe,map_particle_fragment:Gxe,map_particle_pars_fragment:Hxe,metalnessmap_fragment:Wxe,metalnessmap_pars_fragment:qxe,morphinstance_vertex:Xxe,morphcolor_vertex:Kxe,morphnormal_vertex:Yxe,morphtarget_pars_vertex:Zxe,morphtarget_vertex:Qxe,normal_fragment_begin:Jxe,normal_fragment_maps:ebe,normal_pars_fragment:tbe,normal_pars_vertex:nbe,normal_vertex:rbe,normalmap_pars_fragment:ibe,clearcoat_normal_fragment_begin:sbe,clearcoat_normal_fragment_maps:obe,clearcoat_pars_fragment:abe,iridescence_pars_fragment:lbe,opaque_fragment:cbe,packing:ube,premultiplied_alpha_fragment:hbe,project_vertex:fbe,dithering_fragment:dbe,dithering_pars_fragment:pbe,roughnessmap_fragment:mbe,roughnessmap_pars_fragment:gbe,shadowmap_pars_fragment:ybe,shadowmap_pars_vertex:vbe,shadowmap_vertex:xbe,shadowmask_pars_fragment:bbe,skinbase_vertex:_be,skinning_pars_vertex:wbe,skinning_vertex:Sbe,skinnormal_vertex:Tbe,specularmap_fragment:Ebe,specularmap_pars_fragment:Mbe,tonemapping_fragment:Abe,tonemapping_pars_fragment:Cbe,transmission_fragment:Pbe,transmission_pars_fragment:Rbe,uv_pars_fragment:Nbe,uv_pars_vertex:Obe,uv_vertex:Dbe,worldpos_vertex:kbe,background_vert:Ibe,background_frag:Lbe,backgroundCube_vert:Fbe,backgroundCube_frag:Bbe,cube_vert:Ube,cube_frag:zbe,depth_vert:$be,depth_frag:jbe,distanceRGBA_vert:Vbe,distanceRGBA_frag:Gbe,equirect_vert:Hbe,equirect_frag:Wbe,linedashed_vert:qbe,linedashed_frag:Xbe,meshbasic_vert:Kbe,meshbasic_frag:Ybe,meshlambert_vert:Zbe,meshlambert_frag:Qbe,meshmatcap_vert:Jbe,meshmatcap_frag:e_e,meshnormal_vert:t_e,meshnormal_frag:n_e,meshphong_vert:r_e,meshphong_frag:i_e,meshphysical_vert:s_e,meshphysical_frag:o_e,meshtoon_vert:a_e,meshtoon_frag:l_e,points_vert:c_e,points_frag:u_e,shadow_vert:h_e,shadow_frag:f_e,sprite_vert:d_e,sprite_frag:p_e},Xe={common:{diffuse:{value:new pt(16777215)},opacity:{value:1},map:{value:null},mapTransform:{value:new Bt},alphaMap:{value:null},alphaMapTransform:{value:new Bt},alphaTest:{value:0}},specularmap:{specularMap:{value:null},specularMapTransform:{value:new Bt}},envmap:{envMap:{value:null},envMapRotation:{value:new Bt},flipEnvMap:{value:-1},reflectivity:{value:1},ior:{value:1.5},refractionRatio:{value:.98}},aomap:{aoMap:{value:null},aoMapIntensity:{value:1},aoMapTransform:{value:new Bt}},lightmap:{lightMap:{value:null},lightMapIntensity:{value:1},lightMapTransform:{value:new Bt}},bumpmap:{bumpMap:{value:null},bumpMapTransform:{value:new Bt},bumpScale:{value:1}},normalmap:{normalMap:{value:null},normalMapTransform:{value:new Bt},normalScale:{value:new Fe(1,1)}},displacementmap:{displacementMap:{value:null},displacementMapTransform:{value:new Bt},displacementScale:{value:1},displacementBias:{value:0}},emissivemap:{emissiveMap:{value:null},emissiveMapTransform:{value:new Bt}},metalnessmap:{metalnessMap:{value:null},metalnessMapTransform:{value:new Bt}},roughnessmap:{roughnessMap:{value:null},roughnessMapTransform:{value:new Bt}},gradientmap:{gradientMap:{value:null}},fog:{fogDensity:{value:25e-5},fogNear:{value:1},fogFar:{value:2e3},fogColor:{value:new pt(16777215)}},lights:{ambientLightColor:{value:[]},lightProbe:{value:[]},directionalLights:{value:[],properties:{direction:{},color:{}}},directionalLightShadows:{value:[],properties:{shadowIntensity:1,shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},directionalShadowMap:{value:[]},directionalShadowMatrix:{value:[]},spotLights:{value:[],properties:{color:{},position:{},direction:{},distance:{},coneCos:{},penumbraCos:{},decay:{}}},spotLightShadows:{value:[],properties:{shadowIntensity:1,shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},spotLightMap:{value:[]},spotShadowMap:{value:[]},spotLightMatrix:{value:[]},pointLights:{value:[],properties:{color:{},position:{},decay:{},distance:{}}},pointLightShadows:{value:[],properties:{shadowIntensity:1,shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{},shadowCameraNear:{},shadowCameraFar:{}}},pointShadowMap:{value:[]},pointShadowMatrix:{value:[]},hemisphereLights:{value:[],properties:{direction:{},skyColor:{},groundColor:{}}},rectAreaLights:{value:[],properties:{color:{},position:{},width:{},height:{}}},ltc_1:{value:null},ltc_2:{value:null}},points:{diffuse:{value:new pt(16777215)},opacity:{value:1},size:{value:1},scale:{value:1},map:{value:null},alphaMap:{value:null},alphaMapTransform:{value:new Bt},alphaTest:{value:0},uvTransform:{value:new Bt}},sprite:{diffuse:{value:new pt(16777215)},opacity:{value:1},center:{value:new Fe(.5,.5)},rotation:{value:0},map:{value:null},mapTransform:{value:new Bt},alphaMap:{value:null},alphaMapTransform:{value:new Bt},alphaTest:{value:0}}},xl={basic:{uniforms:ms([Xe.common,Xe.specularmap,Xe.envmap,Xe.aomap,Xe.lightmap,Xe.fog]),vertexShader:Zt.meshbasic_vert,fragmentShader:Zt.meshbasic_frag},lambert:{uniforms:ms([Xe.common,Xe.specularmap,Xe.envmap,Xe.aomap,Xe.lightmap,Xe.emissivemap,Xe.bumpmap,Xe.normalmap,Xe.displacementmap,Xe.fog,Xe.lights,{emissive:{value:new pt(0)}}]),vertexShader:Zt.meshlambert_vert,fragmentShader:Zt.meshlambert_frag},phong:{uniforms:ms([Xe.common,Xe.specularmap,Xe.envmap,Xe.aomap,Xe.lightmap,Xe.emissivemap,Xe.bumpmap,Xe.normalmap,Xe.displacementmap,Xe.fog,Xe.lights,{emissive:{value:new pt(0)},specular:{value:new pt(1118481)},shininess:{value:30}}]),vertexShader:Zt.meshphong_vert,fragmentShader:Zt.meshphong_frag},standard:{uniforms:ms([Xe.common,Xe.envmap,Xe.aomap,Xe.lightmap,Xe.emissivemap,Xe.bumpmap,Xe.normalmap,Xe.displacementmap,Xe.roughnessmap,Xe.metalnessmap,Xe.fog,Xe.lights,{emissive:{value:new pt(0)},roughness:{value:1},metalness:{value:0},envMapIntensity:{value:1}}]),vertexShader:Zt.meshphysical_vert,fragmentShader:Zt.meshphysical_frag},toon:{uniforms:ms([Xe.common,Xe.aomap,Xe.lightmap,Xe.emissivemap,Xe.bumpmap,Xe.normalmap,Xe.displacementmap,Xe.gradientmap,Xe.fog,Xe.lights,{emissive:{value:new pt(0)}}]),vertexShader:Zt.meshtoon_vert,fragmentShader:Zt.meshtoon_frag},matcap:{uniforms:ms([Xe.common,Xe.bumpmap,Xe.normalmap,Xe.displacementmap,Xe.fog,{matcap:{value:null}}]),vertexShader:Zt.meshmatcap_vert,fragmentShader:Zt.meshmatcap_frag},points:{uniforms:ms([Xe.points,Xe.fog]),vertexShader:Zt.points_vert,fragmentShader:Zt.points_frag},dashed:{uniforms:ms([Xe.common,Xe.fog,{scale:{value:1},dashSize:{value:1},totalSize:{value:2}}]),vertexShader:Zt.linedashed_vert,fragmentShader:Zt.linedashed_frag},depth:{uniforms:ms([Xe.common,Xe.displacementmap]),vertexShader:Zt.depth_vert,fragmentShader:Zt.depth_frag},normal:{uniforms:ms([Xe.common,Xe.bumpmap,Xe.normalmap,Xe.displacementmap,{opacity:{value:1}}]),vertexShader:Zt.meshnormal_vert,fragmentShader:Zt.meshnormal_frag},sprite:{uniforms:ms([Xe.sprite,Xe.fog]),vertexShader:Zt.sprite_vert,fragmentShader:Zt.sprite_frag},background:{uniforms:{uvTransform:{value:new Bt},t2D:{value:null},backgroundIntensity:{value:1}},vertexShader:Zt.background_vert,fragmentShader:Zt.background_frag},backgroundCube:{uniforms:{envMap:{value:null},flipEnvMap:{value:-1},backgroundBlurriness:{value:0},backgroundIntensity:{value:1},backgroundRotation:{value:new Bt}},vertexShader:Zt.backgroundCube_vert,fragmentShader:Zt.backgroundCube_frag},cube:{uniforms:{tCube:{value:null},tFlip:{value:-1},opacity:{value:1}},vertexShader:Zt.cube_vert,fragmentShader:Zt.cube_frag},equirect:{uniforms:{tEquirect:{value:null}},vertexShader:Zt.equirect_vert,fragmentShader:Zt.equirect_frag},distanceRGBA:{uniforms:ms([Xe.common,Xe.displacementmap,{referencePosition:{value:new K},nearDistance:{value:1},farDistance:{value:1e3}}]),vertexShader:Zt.distanceRGBA_vert,fragmentShader:Zt.distanceRGBA_frag},shadow:{uniforms:ms([Xe.lights,Xe.fog,{color:{value:new pt(0)},opacity:{value:1}}]),vertexShader:Zt.shadow_vert,fragmentShader:Zt.shadow_frag}};xl.physical={uniforms:ms([xl.standard.uniforms,{clearcoat:{value:0},clearcoatMap:{value:null},clearcoatMapTransform:{value:new Bt},clearcoatNormalMap:{value:null},clearcoatNormalMapTransform:{value:new Bt},clearcoatNormalScale:{value:new Fe(1,1)},clearcoatRoughness:{value:0},clearcoatRoughnessMap:{value:null},clearcoatRoughnessMapTransform:{value:new Bt},dispersion:{value:0},iridescence:{value:0},iridescenceMap:{value:null},iridescenceMapTransform:{value:new Bt},iridescenceIOR:{value:1.3},iridescenceThicknessMinimum:{value:100},iridescenceThicknessMaximum:{value:400},iridescenceThicknessMap:{value:null},iridescenceThicknessMapTransform:{value:new Bt},sheen:{value:0},sheenColor:{value:new pt(0)},sheenColorMap:{value:null},sheenColorMapTransform:{value:new Bt},sheenRoughness:{value:1},sheenRoughnessMap:{value:null},sheenRoughnessMapTransform:{value:new Bt},transmission:{value:0},transmissionMap:{value:null},transmissionMapTransform:{value:new Bt},transmissionSamplerSize:{value:new Fe},transmissionSamplerMap:{value:null},thickness:{value:0},thicknessMap:{value:null},thicknessMapTransform:{value:new Bt},attenuationDistance:{value:0},attenuationColor:{value:new pt(0)},specularColor:{value:new pt(1,1,1)},specularColorMap:{value:null},specularColorMapTransform:{value:new Bt},specularIntensity:{value:1},specularIntensityMap:{value:null},specularIntensityMapTransform:{value:new Bt},anisotropyVector:{value:new Fe},anisotropyMap:{value:null},anisotropyMapTransform:{value:new Bt}}]),vertexShader:Zt.meshphysical_vert,fragmentShader:Zt.meshphysical_frag};const dS={r:0,b:0,g:0},uf=new so,m_e=new sn;function g_e(r,e,n,i,s,o,a){const l=new pt(0);let c=o===!0?0:1,u,h,f=null,d=0,p=null;function m(b){let w=b.isScene===!0?b.background:null;return w&&w.isTexture&&(w=(b.backgroundBlurriness>0?n:e).get(w)),w}function g(b){let w=!1;const _=m(b);_===null?y(l,c):_&&_.isColor&&(y(_,1),w=!0);const S=r.xr.getEnvironmentBlendMode();S==="additive"?i.buffers.color.setClear(0,0,0,1,a):S==="alpha-blend"&&i.buffers.color.setClear(0,0,0,0,a),(r.autoClear||w)&&(i.buffers.depth.setTest(!0),i.buffers.depth.setMask(!0),i.buffers.color.setMask(!0),r.clear(r.autoClearColor,r.autoClearDepth,r.autoClearStencil))}function v(b,w){const _=m(w);_&&(_.isCubeTexture||_.mapping===md)?(h===void 0&&(h=new Jn(new Dl(1,1,1),new Bl({name:"BackgroundCubeMaterial",uniforms:vg(xl.backgroundCube.uniforms),vertexShader:xl.backgroundCube.vertexShader,fragmentShader:xl.backgroundCube.fragmentShader,side:Fn,depthTest:!1,depthWrite:!1,fog:!1,allowOverride:!1})),h.geometry.deleteAttribute("normal"),h.geometry.deleteAttribute("uv"),h.onBeforeRender=function(S,T,E){this.matrixWorld.copyPosition(E.matrixWorld)},Object.defineProperty(h.material,"envMap",{get:function(){return this.uniforms.envMap.value}}),s.update(h)),uf.copy(w.backgroundRotation),uf.x*=-1,uf.y*=-1,uf.z*=-1,_.isCubeTexture&&_.isRenderTargetTexture===!1&&(uf.y*=-1,uf.z*=-1),h.material.uniforms.envMap.value=_,h.material.uniforms.flipEnvMap.value=_.isCubeTexture&&_.isRenderTargetTexture===!1?-1:1,h.material.uniforms.backgroundBlurriness.value=w.backgroundBlurriness,h.material.uniforms.backgroundIntensity.value=w.backgroundIntensity,h.material.uniforms.backgroundRotation.value.setFromMatrix4(m_e.makeRotationFromEuler(uf)),h.material.toneMapped=Qt.getTransfer(_.colorSpace)!==wn,(f!==_||d!==_.version||p!==r.toneMapping)&&(h.material.needsUpdate=!0,f=_,d=_.version,p=r.toneMapping),h.layers.enableAll(),b.unshift(h,h.geometry,h.material,0,0,null)):_&&_.isTexture&&(u===void 0&&(u=new Jn(new g_(2,2),new Bl({name:"BackgroundMaterial",uniforms:vg(xl.background.uniforms),vertexShader:xl.background.vertexShader,fragmentShader:xl.background.fragmentShader,side:no,depthTest:!1,depthWrite:!1,fog:!1,allowOverride:!1})),u.geometry.deleteAttribute("normal"),Object.defineProperty(u.material,"map",{get:function(){return this.uniforms.t2D.value}}),s.update(u)),u.material.uniforms.t2D.value=_,u.material.uniforms.backgroundIntensity.value=w.backgroundIntensity,u.material.toneMapped=Qt.getTransfer(_.colorSpace)!==wn,_.matrixAutoUpdate===!0&&_.updateMatrix(),u.material.uniforms.uvTransform.value.copy(_.matrix),(f!==_||d!==_.version||p!==r.toneMapping)&&(u.material.needsUpdate=!0,f=_,d=_.version,p=r.toneMapping),u.layers.enableAll(),b.unshift(u,u.geometry,u.material,0,0,null))}function y(b,w){b.getRGB(dS,EY(r)),i.buffers.color.setClear(dS.r,dS.g,dS.b,w,a)}function x(){h!==void 0&&(h.geometry.dispose(),h.material.dispose(),h=void 0),u!==void 0&&(u.geometry.dispose(),u.material.dispose(),u=void 0)}return{getClearColor:function(){return l},setClearColor:function(b,w=1){l.set(b),c=w,y(l,c)},getClearAlpha:function(){return c},setClearAlpha:function(b){c=b,y(l,c)},render:g,addToRenderList:v,dispose:x}}function y_e(r,e){const n=r.getParameter(r.MAX_VERTEX_ATTRIBS),i={},s=d(null);let o=s,a=!1;function l(A,P,D,B,C){let O=!1;const R=f(B,D,P);o!==R&&(o=R,u(o.object)),O=p(A,B,D,C),O&&m(A,B,D,C),C!==null&&e.update(C,r.ELEMENT_ARRAY_BUFFER),(O||a)&&(a=!1,w(A,P,D,B),C!==null&&r.bindBuffer(r.ELEMENT_ARRAY_BUFFER,e.get(C).buffer))}function c(){return r.createVertexArray()}function u(A){return r.bindVertexArray(A)}function h(A){return r.deleteVertexArray(A)}function f(A,P,D){const B=D.wireframe===!0;let C=i[A.id];C===void 0&&(C={},i[A.id]=C);let O=C[P.id];O===void 0&&(O={},C[P.id]=O);let R=O[B];return R===void 0&&(R=d(c()),O[B]=R),R}function d(A){const P=[],D=[],B=[];for(let C=0;C<n;C++)P[C]=0,D[C]=0,B[C]=0;return{geometry:null,program:null,wireframe:!1,newAttributes:P,enabledAttributes:D,attributeDivisors:B,object:A,attributes:{},index:null}}function p(A,P,D,B){const C=o.attributes,O=P.attributes;let R=0;const z=D.getAttributes();for(const U in z)if(z[U].location>=0){const H=C[U];let Y=O[U];if(Y===void 0&&(U==="instanceMatrix"&&A.instanceMatrix&&(Y=A.instanceMatrix),U==="instanceColor"&&A.instanceColor&&(Y=A.instanceColor)),H===void 0||H.attribute!==Y||Y&&H.data!==Y.data)return!0;R++}return o.attributesNum!==R||o.index!==B}function m(A,P,D,B){const C={},O=P.attributes;let R=0;const z=D.getAttributes();for(const U in z)if(z[U].location>=0){let H=O[U];H===void 0&&(U==="instanceMatrix"&&A.instanceMatrix&&(H=A.instanceMatrix),U==="instanceColor"&&A.instanceColor&&(H=A.instanceColor));const Y={};Y.attribute=H,H&&H.data&&(Y.data=H.data),C[U]=Y,R++}o.attributes=C,o.attributesNum=R,o.index=B}function g(){const A=o.newAttributes;for(let P=0,D=A.length;P<D;P++)A[P]=0}function v(A){y(A,0)}function y(A,P){const D=o.newAttributes,B=o.enabledAttributes,C=o.attributeDivisors;D[A]=1,B[A]===0&&(r.enableVertexAttribArray(A),B[A]=1),C[A]!==P&&(r.vertexAttribDivisor(A,P),C[A]=P)}function x(){const A=o.newAttributes,P=o.enabledAttributes;for(let D=0,B=P.length;D<B;D++)P[D]!==A[D]&&(r.disableVertexAttribArray(D),P[D]=0)}function b(A,P,D,B,C,O,R){R===!0?r.vertexAttribIPointer(A,P,D,C,O):r.vertexAttribPointer(A,P,D,B,C,O)}function w(A,P,D,B){g();const C=B.attributes,O=D.getAttributes(),R=P.defaultAttributeValues;for(const z in O){const U=O[z];if(U.location>=0){let G=C[z];if(G===void 0&&(z==="instanceMatrix"&&A.instanceMatrix&&(G=A.instanceMatrix),z==="instanceColor"&&A.instanceColor&&(G=A.instanceColor)),G!==void 0){const H=G.normalized,Y=G.itemSize,ee=e.get(G);if(ee===void 0)continue;const he=ee.buffer,q=ee.type,J=ee.bytesPerElement,se=q===r.INT||q===r.UNSIGNED_INT||G.gpuType===Si;if(G.isInterleavedBufferAttribute){const oe=G.data,Ee=oe.stride,ye=G.offset;if(oe.isInstancedInterleavedBuffer){for(let Ce=0;Ce<U.locationSize;Ce++)y(U.location+Ce,oe.meshPerAttribute);A.isInstancedMesh!==!0&&B._maxInstanceCount===void 0&&(B._maxInstanceCount=oe.meshPerAttribute*oe.count)}else for(let Ce=0;Ce<U.locationSize;Ce++)v(U.location+Ce);r.bindBuffer(r.ARRAY_BUFFER,he);for(let Ce=0;Ce<U.locationSize;Ce++)b(U.location+Ce,Y/U.locationSize,q,H,Ee*J,(ye+Y/U.locationSize*Ce)*J,se)}else{if(G.isInstancedBufferAttribute){for(let oe=0;oe<U.locationSize;oe++)y(U.location+oe,G.meshPerAttribute);A.isInstancedMesh!==!0&&B._maxInstanceCount===void 0&&(B._maxInstanceCount=G.meshPerAttribute*G.count)}else for(let oe=0;oe<U.locationSize;oe++)v(U.location+oe);r.bindBuffer(r.ARRAY_BUFFER,he);for(let oe=0;oe<U.locationSize;oe++)b(U.location+oe,Y/U.locationSize,q,H,Y*J,Y/U.locationSize*oe*J,se)}}else if(R!==void 0){const H=R[z];if(H!==void 0)switch(H.length){case 2:r.vertexAttrib2fv(U.location,H);break;case 3:r.vertexAttrib3fv(U.location,H);break;case 4:r.vertexAttrib4fv(U.location,H);break;default:r.vertexAttrib1fv(U.location,H)}}}}x()}function _(){E();for(const A in i){const P=i[A];for(const D in P){const B=P[D];for(const C in B)h(B[C].object),delete B[C];delete P[D]}delete i[A]}}function S(A){if(i[A.id]===void 0)return;const P=i[A.id];for(const D in P){const B=P[D];for(const C in B)h(B[C].object),delete B[C];delete P[D]}delete i[A.id]}function T(A){for(const P in i){const D=i[P];if(D[A.id]===void 0)continue;const B=D[A.id];for(const C in B)h(B[C].object),delete B[C];delete D[A.id]}}function E(){M(),a=!0,o!==s&&(o=s,u(o.object))}function M(){s.geometry=null,s.program=null,s.wireframe=!1}return{setup:l,reset:E,resetDefaultState:M,dispose:_,releaseStatesOfGeometry:S,releaseStatesOfProgram:T,initAttributes:g,enableAttribute:v,disableUnusedAttributes:x}}function v_e(r,e,n){let i;function s(u){i=u}function o(u,h){r.drawArrays(i,u,h),n.update(h,i,1)}function a(u,h,f){f!==0&&(r.drawArraysInstanced(i,u,h,f),n.update(h,i,f))}function l(u,h,f){if(f===0)return;e.get("WEBGL_multi_draw").multiDrawArraysWEBGL(i,u,0,h,0,f);let p=0;for(let m=0;m<f;m++)p+=h[m];n.update(p,i,1)}function c(u,h,f,d){if(f===0)return;const p=e.get("WEBGL_multi_draw");if(p===null)for(let m=0;m<u.length;m++)a(u[m],h[m],d[m]);else{p.multiDrawArraysInstancedWEBGL(i,u,0,h,0,d,0,f);let m=0;for(let g=0;g<f;g++)m+=h[g]*d[g];n.update(m,i,1)}}this.setMode=s,this.render=o,this.renderInstances=a,this.renderMultiDraw=l,this.renderMultiDrawInstances=c}function x_e(r,e,n,i){let s;function o(){if(s!==void 0)return s;if(e.has("EXT_texture_filter_anisotropic")===!0){const T=e.get("EXT_texture_filter_anisotropic");s=r.getParameter(T.MAX_TEXTURE_MAX_ANISOTROPY_EXT)}else s=0;return s}function a(T){return!(T!==Tr&&i.convert(T)!==r.getParameter(r.IMPLEMENTATION_COLOR_READ_FORMAT))}function l(T){const E=T===Ei&&(e.has("EXT_color_buffer_half_float")||e.has("EXT_color_buffer_float"));return!(T!==gr&&i.convert(T)!==r.getParameter(r.IMPLEMENTATION_COLOR_READ_TYPE)&&T!==Nr&&!E)}function c(T){if(T==="highp"){if(r.getShaderPrecisionFormat(r.VERTEX_SHADER,r.HIGH_FLOAT).precision>0&&r.getShaderPrecisionFormat(r.FRAGMENT_SHADER,r.HIGH_FLOAT).precision>0)return"highp";T="mediump"}return T==="mediump"&&r.getShaderPrecisionFormat(r.VERTEX_SHADER,r.MEDIUM_FLOAT).precision>0&&r.getShaderPrecisionFormat(r.FRAGMENT_SHADER,r.MEDIUM_FLOAT).precision>0?"mediump":"lowp"}let u=n.precision!==void 0?n.precision:"highp";const h=c(u);h!==u&&(console.warn("THREE.WebGLRenderer:",u,"not supported, using",h,"instead."),u=h);const f=n.logarithmicDepthBuffer===!0,d=n.reverseDepthBuffer===!0&&e.has("EXT_clip_control"),p=r.getParameter(r.MAX_TEXTURE_IMAGE_UNITS),m=r.getParameter(r.MAX_VERTEX_TEXTURE_IMAGE_UNITS),g=r.getParameter(r.MAX_TEXTURE_SIZE),v=r.getParameter(r.MAX_CUBE_MAP_TEXTURE_SIZE),y=r.getParameter(r.MAX_VERTEX_ATTRIBS),x=r.getParameter(r.MAX_VERTEX_UNIFORM_VECTORS),b=r.getParameter(r.MAX_VARYING_VECTORS),w=r.getParameter(r.MAX_FRAGMENT_UNIFORM_VECTORS),_=m>0,S=r.getParameter(r.MAX_SAMPLES);return{isWebGL2:!0,getMaxAnisotropy:o,getMaxPrecision:c,textureFormatReadable:a,textureTypeReadable:l,precision:u,logarithmicDepthBuffer:f,reverseDepthBuffer:d,maxTextures:p,maxVertexTextures:m,maxTextureSize:g,maxCubemapSize:v,maxAttributes:y,maxVertexUniforms:x,maxVaryings:b,maxFragmentUniforms:w,vertexTextures:_,maxSamples:S}}function b_e(r){const e=this;let n=null,i=0,s=!1,o=!1;const a=new To,l=new Bt,c={value:null,needsUpdate:!1};this.uniform=c,this.numPlanes=0,this.numIntersection=0,this.init=function(f,d){const p=f.length!==0||d||i!==0||s;return s=d,i=f.length,p},this.beginShadows=function(){o=!0,h(null)},this.endShadows=function(){o=!1},this.setGlobalState=function(f,d){n=h(f,d,0)},this.setState=function(f,d,p){const m=f.clippingPlanes,g=f.clipIntersection,v=f.clipShadows,y=r.get(f);if(!s||m===null||m.length===0||o&&!v)o?h(null):u();else{const x=o?0:i,b=x*4;let w=y.clippingState||null;c.value=w,w=h(m,d,b,p);for(let _=0;_!==b;++_)w[_]=n[_];y.clippingState=w,this.numIntersection=g?this.numPlanes:0,this.numPlanes+=x}};function u(){c.value!==n&&(c.value=n,c.needsUpdate=i>0),e.numPlanes=i,e.numIntersection=0}function h(f,d,p,m){const g=f!==null?f.length:0;let v=null;if(g!==0){if(v=c.value,m!==!0||v===null){const y=p+g*4,x=d.matrixWorldInverse;l.getNormalMatrix(x),(v===null||v.length<y)&&(v=new Float32Array(y));for(let b=0,w=p;b!==g;++b,w+=4)a.copy(f[b]).applyMatrix4(x,l),a.normal.toArray(v,w),v[w+3]=a.constant}c.value=v,c.needsUpdate=!0}return e.numPlanes=g,e.numIntersection=0,v}}function __e(r){let e=new WeakMap;function n(a,l){return l===dd?a.mapping=tl:l===pd&&(a.mapping=nl),a}function i(a){if(a&&a.isTexture){const l=a.mapping;if(l===dd||l===pd)if(e.has(a)){const c=e.get(a).texture;return n(c,a.mapping)}else{const c=a.image;if(c&&c.height>0){const u=new CY(c.height);return u.fromEquirectangularTexture(r,a),e.set(a,u),a.addEventListener("dispose",s),n(u.texture,a.mapping)}else return null}}return a}function s(a){const l=a.target;l.removeEventListener("dispose",s);const c=e.get(l);c!==void 0&&(e.delete(l),c.dispose())}function o(){e=new WeakMap}return{get:i,dispose:o}}const lm=4,UV=[.125,.215,.35,.446,.526,.582],Of=20,bR=new y_,zV=new pt;let _R=null,wR=0,SR=0,TR=!1;const Ef=(1+Math.sqrt(5))/2,bp=1/Ef,$V=[new K(-Ef,bp,0),new K(Ef,bp,0),new K(-bp,0,Ef),new K(bp,0,Ef),new K(0,Ef,-bp),new K(0,Ef,bp),new K(-1,1,-1),new K(1,1,-1),new K(-1,1,1),new K(1,1,1)],w_e=new K;let jV=class{constructor(e){this._renderer=e,this._pingPongRenderTarget=null,this._lodMax=0,this._cubeSize=0,this._lodPlanes=[],this._sizeLods=[],this._sigmas=[],this._blurMaterial=null,this._cubemapMaterial=null,this._equirectMaterial=null,this._compileMaterial(this._blurMaterial)}fromScene(e,n=0,i=.1,s=100,o={}){const{size:a=256,position:l=w_e}=o;_R=this._renderer.getRenderTarget(),wR=this._renderer.getActiveCubeFace(),SR=this._renderer.getActiveMipmapLevel(),TR=this._renderer.xr.enabled,this._renderer.xr.enabled=!1,this._setSize(a);const c=this._allocateTargets();return c.depthBuffer=!0,this._sceneToCubeUV(e,i,s,c,l),n>0&&this._blur(c,0,0,n),this._applyPMREM(c),this._cleanup(c),c}fromEquirectangular(e,n=null){return this._fromTexture(e,n)}fromCubemap(e,n=null){return this._fromTexture(e,n)}compileCubemapShader(){this._cubemapMaterial===null&&(this._cubemapMaterial=HV(),this._compileMaterial(this._cubemapMaterial))}compileEquirectangularShader(){this._equirectMaterial===null&&(this._equirectMaterial=GV(),this._compileMaterial(this._equirectMaterial))}dispose(){this._dispose(),this._cubemapMaterial!==null&&this._cubemapMaterial.dispose(),this._equirectMaterial!==null&&this._equirectMaterial.dispose()}_setSize(e){this._lodMax=Math.floor(Math.log2(e)),this._cubeSize=Math.pow(2,this._lodMax)}_dispose(){this._blurMaterial!==null&&this._blurMaterial.dispose(),this._pingPongRenderTarget!==null&&this._pingPongRenderTarget.dispose();for(let e=0;e<this._lodPlanes.length;e++)this._lodPlanes[e].dispose()}_cleanup(e){this._renderer.setRenderTarget(_R,wR,SR),this._renderer.xr.enabled=TR,e.scissorTest=!1,pS(e,0,0,e.width,e.height)}_fromTexture(e,n){e.mapping===tl||e.mapping===nl?this._setSize(e.image.length===0?16:e.image[0].width||e.image[0].image.width):this._setSize(e.image.width/4),_R=this._renderer.getRenderTarget(),wR=this._renderer.getActiveCubeFace(),SR=this._renderer.getActiveMipmapLevel(),TR=this._renderer.xr.enabled,this._renderer.xr.enabled=!1;const i=n||this._allocateTargets();return this._textureToCubeUV(e,i),this._applyPMREM(i),this._cleanup(i),i}_allocateTargets(){const e=3*Math.max(this._cubeSize,112),n=4*this._cubeSize,i={magFilter:li,minFilter:li,generateMipmaps:!1,type:Ei,format:Tr,colorSpace:Ol,depthBuffer:!1},s=VV(e,n,i);if(this._pingPongRenderTarget===null||this._pingPongRenderTarget.width!==e||this._pingPongRenderTarget.height!==n){this._pingPongRenderTarget!==null&&this._dispose(),this._pingPongRenderTarget=VV(e,n,i);const{_lodMax:o}=this;({sizeLods:this._sizeLods,lodPlanes:this._lodPlanes,sigmas:this._sigmas}=S_e(o)),this._blurMaterial=T_e(o,e,n)}return s}_compileMaterial(e){const n=new Jn(this._lodPlanes[0],e);this._renderer.compile(n,bR)}_sceneToCubeUV(e,n,i,s,o){const c=new Ti(90,1,n,i),u=[1,-1,1,1,1,1],h=[1,1,1,-1,-1,-1],f=this._renderer,d=f.autoClear,p=f.toneMapping;f.getClearColor(zV),f.toneMapping=io,f.autoClear=!1;const m=new As({name:"PMREM.Background",side:Fn,depthWrite:!1,depthTest:!1}),g=new Jn(new Dl,m);let v=!1;const y=e.background;y?y.isColor&&(m.color.copy(y),e.background=null,v=!0):(m.color.copy(zV),v=!0);for(let x=0;x<6;x++){const b=x%3;b===0?(c.up.set(0,u[x],0),c.position.set(o.x,o.y,o.z),c.lookAt(o.x+h[x],o.y,o.z)):b===1?(c.up.set(0,0,u[x]),c.position.set(o.x,o.y,o.z),c.lookAt(o.x,o.y+h[x],o.z)):(c.up.set(0,u[x],0),c.position.set(o.x,o.y,o.z),c.lookAt(o.x,o.y,o.z+h[x]));const w=this._cubeSize;pS(s,b*w,x>2?w:0,w,w),f.setRenderTarget(s),v&&f.render(g,c),f.render(e,c)}g.geometry.dispose(),g.material.dispose(),f.toneMapping=p,f.autoClear=d,e.background=y}_textureToCubeUV(e,n){const i=this._renderer,s=e.mapping===tl||e.mapping===nl;s?(this._cubemapMaterial===null&&(this._cubemapMaterial=HV()),this._cubemapMaterial.uniforms.flipEnvMap.value=e.isRenderTargetTexture===!1?-1:1):this._equirectMaterial===null&&(this._equirectMaterial=GV());const o=s?this._cubemapMaterial:this._equirectMaterial,a=new Jn(this._lodPlanes[0],o),l=o.uniforms;l.envMap.value=e;const c=this._cubeSize;pS(n,0,0,3*c,2*c),i.setRenderTarget(n),i.render(a,bR)}_applyPMREM(e){const n=this._renderer,i=n.autoClear;n.autoClear=!1;const s=this._lodPlanes.length;for(let o=1;o<s;o++){const a=Math.sqrt(this._sigmas[o]*this._sigmas[o]-this._sigmas[o-1]*this._sigmas[o-1]),l=$V[(s-o-1)%$V.length];this._blur(e,o-1,o,a,l)}n.autoClear=i}_blur(e,n,i,s,o){const a=this._pingPongRenderTarget;this._halfBlur(e,a,n,i,s,"latitudinal",o),this._halfBlur(a,e,i,i,s,"longitudinal",o)}_halfBlur(e,n,i,s,o,a,l){const c=this._renderer,u=this._blurMaterial;a!=="latitudinal"&&a!=="longitudinal"&&console.error("blur direction must be either latitudinal or longitudinal!");const h=3,f=new Jn(this._lodPlanes[s],u),d=u.uniforms,p=this._sizeLods[i]-1,m=isFinite(o)?Math.PI/(2*p):2*Math.PI/(2*Of-1),g=o/m,v=isFinite(o)?1+Math.floor(h*g):Of;v>Of&&console.warn(`sigmaRadians, ${o}, is too large and will clip, as it requested ${v} samples when the maximum is set to ${Of}`);const y=[];let x=0;for(let T=0;T<Of;++T){const E=T/g,M=Math.exp(-E*E/2);y.push(M),T===0?x+=M:T<v&&(x+=2*M)}for(let T=0;T<y.length;T++)y[T]=y[T]/x;d.envMap.value=e.texture,d.samples.value=v,d.weights.value=y,d.latitudinal.value=a==="latitudinal",l&&(d.poleAxis.value=l);const{_lodMax:b}=this;d.dTheta.value=m,d.mipInt.value=b-i;const w=this._sizeLods[s],_=3*w*(s>b-lm?s-b+lm:0),S=4*(this._cubeSize-w);pS(n,_,S,3*w,2*w),c.setRenderTarget(n),c.render(f,bR)}};function S_e(r){const e=[],n=[],i=[];let s=r;const o=r-lm+1+UV.length;for(let a=0;a<o;a++){const l=Math.pow(2,s);n.push(l);let c=1/l;a>r-lm?c=UV[a-r+lm-1]:a===0&&(c=0),i.push(c);const u=1/(l-2),h=-u,f=1+u,d=[h,h,f,h,f,f,h,h,f,f,h,f],p=6,m=6,g=3,v=2,y=1,x=new Float32Array(g*m*p),b=new Float32Array(v*m*p),w=new Float32Array(y*m*p);for(let S=0;S<p;S++){const T=S%3*2/3-1,E=S>2?0:-1,M=[T,E,0,T+2/3,E,0,T+2/3,E+1,0,T,E,0,T+2/3,E+1,0,T,E+1,0];x.set(M,g*m*S),b.set(d,v*m*S);const A=[S,S,S,S,S,S];w.set(A,y*m*S)}const _=new ji;_.setAttribute("position",new hi(x,g)),_.setAttribute("uv",new hi(b,v)),_.setAttribute("faceIndex",new hi(w,y)),e.push(_),s>lm&&s--}return{lodPlanes:e,sizeLods:n,sigmas:i}}function VV(r,e,n){const i=new Rh(r,e,n);return i.texture.mapping=md,i.texture.name="PMREM.cubeUv",i.scissorTest=!0,i}function pS(r,e,n,i,s){r.viewport.set(e,n,i,s),r.scissor.set(e,n,i,s)}function T_e(r,e,n){const i=new Float32Array(Of),s=new K(0,1,0);return new Bl({name:"SphericalGaussianBlur",defines:{n:Of,CUBEUV_TEXEL_WIDTH:1/e,CUBEUV_TEXEL_HEIGHT:1/n,CUBEUV_MAX_MIP:`${r}.0`},uniforms:{envMap:{value:null},samples:{value:1},weights:{value:i},latitudinal:{value:!1},dTheta:{value:0},mipInt:{value:0},poleAxis:{value:s}},vertexShader:VF(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			varying vec3 vOutputDirection;

			uniform sampler2D envMap;
			uniform int samples;
			uniform float weights[ n ];
			uniform bool latitudinal;
			uniform float dTheta;
			uniform float mipInt;
			uniform vec3 poleAxis;

			#define ENVMAP_TYPE_CUBE_UV
			#include <cube_uv_reflection_fragment>

			vec3 getSample( float theta, vec3 axis ) {

				float cosTheta = cos( theta );
				// Rodrigues' axis-angle rotation
				vec3 sampleDirection = vOutputDirection * cosTheta
					+ cross( axis, vOutputDirection ) * sin( theta )
					+ axis * dot( axis, vOutputDirection ) * ( 1.0 - cosTheta );

				return bilinearCubeUV( envMap, sampleDirection, mipInt );

			}

			void main() {

				vec3 axis = latitudinal ? poleAxis : cross( poleAxis, vOutputDirection );

				if ( all( equal( axis, vec3( 0.0 ) ) ) ) {

					axis = vec3( vOutputDirection.z, 0.0, - vOutputDirection.x );

				}

				axis = normalize( axis );

				gl_FragColor = vec4( 0.0, 0.0, 0.0, 1.0 );
				gl_FragColor.rgb += weights[ 0 ] * getSample( 0.0, axis );

				for ( int i = 1; i < n; i++ ) {

					if ( i >= samples ) {

						break;

					}

					float theta = dTheta * float( i );
					gl_FragColor.rgb += weights[ i ] * getSample( -1.0 * theta, axis );
					gl_FragColor.rgb += weights[ i ] * getSample( theta, axis );

				}

			}
		`,blending:ro,depthTest:!1,depthWrite:!1})}function GV(){return new Bl({name:"EquirectangularToCubeUV",uniforms:{envMap:{value:null}},vertexShader:VF(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			varying vec3 vOutputDirection;

			uniform sampler2D envMap;

			#include <common>

			void main() {

				vec3 outputDirection = normalize( vOutputDirection );
				vec2 uv = equirectUv( outputDirection );

				gl_FragColor = vec4( texture2D ( envMap, uv ).rgb, 1.0 );

			}
		`,blending:ro,depthTest:!1,depthWrite:!1})}function HV(){return new Bl({name:"CubemapToCubeUV",uniforms:{envMap:{value:null},flipEnvMap:{value:-1}},vertexShader:VF(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			uniform float flipEnvMap;

			varying vec3 vOutputDirection;

			uniform samplerCube envMap;

			void main() {

				gl_FragColor = textureCube( envMap, vec3( flipEnvMap * vOutputDirection.x, vOutputDirection.yz ) );

			}
		`,blending:ro,depthTest:!1,depthWrite:!1})}function VF(){return`

		precision mediump float;
		precision mediump int;

		attribute float faceIndex;

		varying vec3 vOutputDirection;

		// RH coordinate system; PMREM face-indexing convention
		vec3 getDirection( vec2 uv, float face ) {

			uv = 2.0 * uv - 1.0;

			vec3 direction = vec3( uv, 1.0 );

			if ( face == 0.0 ) {

				direction = direction.zyx; // ( 1, v, u ) pos x

			} else if ( face == 1.0 ) {

				direction = direction.xzy;
				direction.xz *= -1.0; // ( -u, 1, -v ) pos y

			} else if ( face == 2.0 ) {

				direction.x *= -1.0; // ( -u, v, 1 ) pos z

			} else if ( face == 3.0 ) {

				direction = direction.zyx;
				direction.xz *= -1.0; // ( -1, v, -u ) neg x

			} else if ( face == 4.0 ) {

				direction = direction.xzy;
				direction.xy *= -1.0; // ( -u, -1, v ) neg y

			} else if ( face == 5.0 ) {

				direction.z *= -1.0; // ( u, v, -1 ) neg z

			}

			return direction;

		}

		void main() {

			vOutputDirection = getDirection( uv, faceIndex );
			gl_Position = vec4( position, 1.0 );

		}
	`}function E_e(r){let e=new WeakMap,n=null;function i(l){if(l&&l.isTexture){const c=l.mapping,u=c===dd||c===pd,h=c===tl||c===nl;if(u||h){let f=e.get(l);const d=f!==void 0?f.texture.pmremVersion:0;if(l.isRenderTargetTexture&&l.pmremVersion!==d)return n===null&&(n=new jV(r)),f=u?n.fromEquirectangular(l,f):n.fromCubemap(l,f),f.texture.pmremVersion=l.pmremVersion,e.set(l,f),f.texture;if(f!==void 0)return f.texture;{const p=l.image;return u&&p&&p.height>0||h&&p&&s(p)?(n===null&&(n=new jV(r)),f=u?n.fromEquirectangular(l):n.fromCubemap(l),f.texture.pmremVersion=l.pmremVersion,e.set(l,f),l.addEventListener("dispose",o),f.texture):null}}}return l}function s(l){let c=0;const u=6;for(let h=0;h<u;h++)l[h]!==void 0&&c++;return c===u}function o(l){const c=l.target;c.removeEventListener("dispose",o);const u=e.get(c);u!==void 0&&(e.delete(c),u.dispose())}function a(){e=new WeakMap,n!==null&&(n.dispose(),n=null)}return{get:i,dispose:a}}function M_e(r){const e={};function n(i){if(e[i]!==void 0)return e[i];let s;switch(i){case"WEBGL_depth_texture":s=r.getExtension("WEBGL_depth_texture")||r.getExtension("MOZ_WEBGL_depth_texture")||r.getExtension("WEBKIT_WEBGL_depth_texture");break;case"EXT_texture_filter_anisotropic":s=r.getExtension("EXT_texture_filter_anisotropic")||r.getExtension("MOZ_EXT_texture_filter_anisotropic")||r.getExtension("WEBKIT_EXT_texture_filter_anisotropic");break;case"WEBGL_compressed_texture_s3tc":s=r.getExtension("WEBGL_compressed_texture_s3tc")||r.getExtension("MOZ_WEBGL_compressed_texture_s3tc")||r.getExtension("WEBKIT_WEBGL_compressed_texture_s3tc");break;case"WEBGL_compressed_texture_pvrtc":s=r.getExtension("WEBGL_compressed_texture_pvrtc")||r.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc");break;default:s=r.getExtension(i)}return e[i]=s,s}return{has:function(i){return n(i)!==null},init:function(){n("EXT_color_buffer_float"),n("WEBGL_clip_cull_distance"),n("OES_texture_float_linear"),n("EXT_color_buffer_half_float"),n("WEBGL_multisampled_render_to_texture"),n("WEBGL_render_shared_exponent")},get:function(i){const s=n(i);return s===null&&Ja("THREE.WebGLRenderer: "+i+" extension not supported."),s}}}function A_e(r,e,n,i){const s={},o=new WeakMap;function a(f){const d=f.target;d.index!==null&&e.remove(d.index);for(const m in d.attributes)e.remove(d.attributes[m]);d.removeEventListener("dispose",a),delete s[d.id];const p=o.get(d);p&&(e.remove(p),o.delete(d)),i.releaseStatesOfGeometry(d),d.isInstancedBufferGeometry===!0&&delete d._maxInstanceCount,n.memory.geometries--}function l(f,d){return s[d.id]===!0||(d.addEventListener("dispose",a),s[d.id]=!0,n.memory.geometries++),d}function c(f){const d=f.attributes;for(const p in d)e.update(d[p],r.ARRAY_BUFFER)}function u(f){const d=[],p=f.index,m=f.attributes.position;let g=0;if(p!==null){const x=p.array;g=p.version;for(let b=0,w=x.length;b<w;b+=3){const _=x[b+0],S=x[b+1],T=x[b+2];d.push(_,S,S,T,T,_)}}else if(m!==void 0){const x=m.array;g=m.version;for(let b=0,w=x.length/3-1;b<w;b+=3){const _=b+0,S=b+1,T=b+2;d.push(_,S,S,T,T,_)}}else return;const v=new(PF(d)?DF:OF)(d,1);v.version=g;const y=o.get(f);y&&e.remove(y),o.set(f,v)}function h(f){const d=o.get(f);if(d){const p=f.index;p!==null&&d.version<p.version&&u(f)}else u(f);return o.get(f)}return{get:l,update:c,getWireframeAttribute:h}}function C_e(r,e,n){let i;function s(d){i=d}let o,a;function l(d){o=d.type,a=d.bytesPerElement}function c(d,p){r.drawElements(i,p,o,d*a),n.update(p,i,1)}function u(d,p,m){m!==0&&(r.drawElementsInstanced(i,p,o,d*a,m),n.update(p,i,m))}function h(d,p,m){if(m===0)return;e.get("WEBGL_multi_draw").multiDrawElementsWEBGL(i,p,0,o,d,0,m);let v=0;for(let y=0;y<m;y++)v+=p[y];n.update(v,i,1)}function f(d,p,m,g){if(m===0)return;const v=e.get("WEBGL_multi_draw");if(v===null)for(let y=0;y<d.length;y++)u(d[y]/a,p[y],g[y]);else{v.multiDrawElementsInstancedWEBGL(i,p,0,o,d,0,g,0,m);let y=0;for(let x=0;x<m;x++)y+=p[x]*g[x];n.update(y,i,1)}}this.setMode=s,this.setIndex=l,this.render=c,this.renderInstances=u,this.renderMultiDraw=h,this.renderMultiDrawInstances=f}function P_e(r){const e={geometries:0,textures:0},n={frame:0,calls:0,triangles:0,points:0,lines:0};function i(o,a,l){switch(n.calls++,a){case r.TRIANGLES:n.triangles+=l*(o/3);break;case r.LINES:n.lines+=l*(o/2);break;case r.LINE_STRIP:n.lines+=l*(o-1);break;case r.LINE_LOOP:n.lines+=l*o;break;case r.POINTS:n.points+=l*o;break;default:console.error("THREE.WebGLInfo: Unknown draw mode:",a);break}}function s(){n.calls=0,n.triangles=0,n.points=0,n.lines=0}return{memory:e,render:n,programs:null,autoReset:!0,reset:s,update:i}}function R_e(r,e,n){const i=new WeakMap,s=new Nt;function o(a,l,c){const u=a.morphTargetInfluences,h=l.morphAttributes.position||l.morphAttributes.normal||l.morphAttributes.color,f=h!==void 0?h.length:0;let d=i.get(l);if(d===void 0||d.count!==f){let A=function(){E.dispose(),i.delete(l),l.removeEventListener("dispose",A)};var p=A;d!==void 0&&d.texture.dispose();const m=l.morphAttributes.position!==void 0,g=l.morphAttributes.normal!==void 0,v=l.morphAttributes.color!==void 0,y=l.morphAttributes.position||[],x=l.morphAttributes.normal||[],b=l.morphAttributes.color||[];let w=0;m===!0&&(w=1),g===!0&&(w=2),v===!0&&(w=3);let _=l.attributes.position.count*w,S=1;_>e.maxTextureSize&&(S=Math.ceil(_/e.maxTextureSize),_=e.maxTextureSize);const T=new Float32Array(_*S*4*f),E=new KM(T,_,S,f);E.type=Nr,E.needsUpdate=!0;const M=w*4;for(let P=0;P<f;P++){const D=y[P],B=x[P],C=b[P],O=_*S*4*P;for(let R=0;R<D.count;R++){const z=R*M;m===!0&&(s.fromBufferAttribute(D,R),T[O+z+0]=s.x,T[O+z+1]=s.y,T[O+z+2]=s.z,T[O+z+3]=0),g===!0&&(s.fromBufferAttribute(B,R),T[O+z+4]=s.x,T[O+z+5]=s.y,T[O+z+6]=s.z,T[O+z+7]=0),v===!0&&(s.fromBufferAttribute(C,R),T[O+z+8]=s.x,T[O+z+9]=s.y,T[O+z+10]=s.z,T[O+z+11]=C.itemSize===4?s.w:1)}}d={count:f,texture:E,size:new Fe(_,S)},i.set(l,d),l.addEventListener("dispose",A)}if(a.isInstancedMesh===!0&&a.morphTexture!==null)c.getUniforms().setValue(r,"morphTexture",a.morphTexture,n);else{let m=0;for(let v=0;v<u.length;v++)m+=u[v];const g=l.morphTargetsRelative?1:1-m;c.getUniforms().setValue(r,"morphTargetBaseInfluence",g),c.getUniforms().setValue(r,"morphTargetInfluences",u)}c.getUniforms().setValue(r,"morphTargetsTexture",d.texture,n),c.getUniforms().setValue(r,"morphTargetsTextureSize",d.size)}return{update:o}}function N_e(r,e,n,i){let s=new WeakMap;function o(c){const u=i.render.frame,h=c.geometry,f=e.get(c,h);if(s.get(f)!==u&&(e.update(f),s.set(f,u)),c.isInstancedMesh&&(c.hasEventListener("dispose",l)===!1&&c.addEventListener("dispose",l),s.get(c)!==u&&(n.update(c.instanceMatrix,r.ARRAY_BUFFER),c.instanceColor!==null&&n.update(c.instanceColor,r.ARRAY_BUFFER),s.set(c,u))),c.isSkinnedMesh){const d=c.skeleton;s.get(d)!==u&&(d.update(),s.set(d,u))}return f}function a(){s=new WeakMap}function l(c){const u=c.target;u.removeEventListener("dispose",l),n.remove(u.instanceMatrix),u.instanceColor!==null&&n.remove(u.instanceColor)}return{update:o,dispose:a}}const VY=new ui,WV=new ko(1,1),GY=new KM,HY=new Mve,WY=new ZM,qV=[],XV=[],KV=new Float32Array(16),YV=new Float32Array(9),ZV=new Float32Array(4);function xy(r,e,n){const i=r[0];if(i<=0||i>0)return r;const s=e*n;let o=qV[s];if(o===void 0&&(o=new Float32Array(s),qV[s]=o),e!==0){i.toArray(o,0);for(let a=1,l=0;a!==e;++a)l+=n,r[a].toArray(o,l)}return o}function di(r,e){if(r.length!==e.length)return!1;for(let n=0,i=r.length;n<i;n++)if(r[n]!==e[n])return!1;return!0}function pi(r,e){for(let n=0,i=e.length;n<i;n++)r[n]=e[n]}function tA(r,e){let n=XV[e];n===void 0&&(n=new Int32Array(e),XV[e]=n);for(let i=0;i!==e;++i)n[i]=r.allocateTextureUnit();return n}function O_e(r,e){const n=this.cache;n[0]!==e&&(r.uniform1f(this.addr,e),n[0]=e)}function D_e(r,e){const n=this.cache;if(e.x!==void 0)(n[0]!==e.x||n[1]!==e.y)&&(r.uniform2f(this.addr,e.x,e.y),n[0]=e.x,n[1]=e.y);else{if(di(n,e))return;r.uniform2fv(this.addr,e),pi(n,e)}}function k_e(r,e){const n=this.cache;if(e.x!==void 0)(n[0]!==e.x||n[1]!==e.y||n[2]!==e.z)&&(r.uniform3f(this.addr,e.x,e.y,e.z),n[0]=e.x,n[1]=e.y,n[2]=e.z);else if(e.r!==void 0)(n[0]!==e.r||n[1]!==e.g||n[2]!==e.b)&&(r.uniform3f(this.addr,e.r,e.g,e.b),n[0]=e.r,n[1]=e.g,n[2]=e.b);else{if(di(n,e))return;r.uniform3fv(this.addr,e),pi(n,e)}}function I_e(r,e){const n=this.cache;if(e.x!==void 0)(n[0]!==e.x||n[1]!==e.y||n[2]!==e.z||n[3]!==e.w)&&(r.uniform4f(this.addr,e.x,e.y,e.z,e.w),n[0]=e.x,n[1]=e.y,n[2]=e.z,n[3]=e.w);else{if(di(n,e))return;r.uniform4fv(this.addr,e),pi(n,e)}}function L_e(r,e){const n=this.cache,i=e.elements;if(i===void 0){if(di(n,e))return;r.uniformMatrix2fv(this.addr,!1,e),pi(n,e)}else{if(di(n,i))return;ZV.set(i),r.uniformMatrix2fv(this.addr,!1,ZV),pi(n,i)}}function F_e(r,e){const n=this.cache,i=e.elements;if(i===void 0){if(di(n,e))return;r.uniformMatrix3fv(this.addr,!1,e),pi(n,e)}else{if(di(n,i))return;YV.set(i),r.uniformMatrix3fv(this.addr,!1,YV),pi(n,i)}}function B_e(r,e){const n=this.cache,i=e.elements;if(i===void 0){if(di(n,e))return;r.uniformMatrix4fv(this.addr,!1,e),pi(n,e)}else{if(di(n,i))return;KV.set(i),r.uniformMatrix4fv(this.addr,!1,KV),pi(n,i)}}function U_e(r,e){const n=this.cache;n[0]!==e&&(r.uniform1i(this.addr,e),n[0]=e)}function z_e(r,e){const n=this.cache;if(e.x!==void 0)(n[0]!==e.x||n[1]!==e.y)&&(r.uniform2i(this.addr,e.x,e.y),n[0]=e.x,n[1]=e.y);else{if(di(n,e))return;r.uniform2iv(this.addr,e),pi(n,e)}}function $_e(r,e){const n=this.cache;if(e.x!==void 0)(n[0]!==e.x||n[1]!==e.y||n[2]!==e.z)&&(r.uniform3i(this.addr,e.x,e.y,e.z),n[0]=e.x,n[1]=e.y,n[2]=e.z);else{if(di(n,e))return;r.uniform3iv(this.addr,e),pi(n,e)}}function j_e(r,e){const n=this.cache;if(e.x!==void 0)(n[0]!==e.x||n[1]!==e.y||n[2]!==e.z||n[3]!==e.w)&&(r.uniform4i(this.addr,e.x,e.y,e.z,e.w),n[0]=e.x,n[1]=e.y,n[2]=e.z,n[3]=e.w);else{if(di(n,e))return;r.uniform4iv(this.addr,e),pi(n,e)}}function V_e(r,e){const n=this.cache;n[0]!==e&&(r.uniform1ui(this.addr,e),n[0]=e)}function G_e(r,e){const n=this.cache;if(e.x!==void 0)(n[0]!==e.x||n[1]!==e.y)&&(r.uniform2ui(this.addr,e.x,e.y),n[0]=e.x,n[1]=e.y);else{if(di(n,e))return;r.uniform2uiv(this.addr,e),pi(n,e)}}function H_e(r,e){const n=this.cache;if(e.x!==void 0)(n[0]!==e.x||n[1]!==e.y||n[2]!==e.z)&&(r.uniform3ui(this.addr,e.x,e.y,e.z),n[0]=e.x,n[1]=e.y,n[2]=e.z);else{if(di(n,e))return;r.uniform3uiv(this.addr,e),pi(n,e)}}function W_e(r,e){const n=this.cache;if(e.x!==void 0)(n[0]!==e.x||n[1]!==e.y||n[2]!==e.z||n[3]!==e.w)&&(r.uniform4ui(this.addr,e.x,e.y,e.z,e.w),n[0]=e.x,n[1]=e.y,n[2]=e.z,n[3]=e.w);else{if(di(n,e))return;r.uniform4uiv(this.addr,e),pi(n,e)}}function q_e(r,e,n){const i=this.cache,s=n.allocateTextureUnit();i[0]!==s&&(r.uniform1i(this.addr,s),i[0]=s);let o;this.type===r.SAMPLER_2D_SHADOW?(WV.compareFunction=XM,o=WV):o=VY,n.setTexture2D(e||o,s)}function X_e(r,e,n){const i=this.cache,s=n.allocateTextureUnit();i[0]!==s&&(r.uniform1i(this.addr,s),i[0]=s),n.setTexture3D(e||HY,s)}function K_e(r,e,n){const i=this.cache,s=n.allocateTextureUnit();i[0]!==s&&(r.uniform1i(this.addr,s),i[0]=s),n.setTextureCube(e||WY,s)}function Y_e(r,e,n){const i=this.cache,s=n.allocateTextureUnit();i[0]!==s&&(r.uniform1i(this.addr,s),i[0]=s),n.setTexture2DArray(e||GY,s)}function Z_e(r){switch(r){case 5126:return O_e;case 35664:return D_e;case 35665:return k_e;case 35666:return I_e;case 35674:return L_e;case 35675:return F_e;case 35676:return B_e;case 5124:case 35670:return U_e;case 35667:case 35671:return z_e;case 35668:case 35672:return $_e;case 35669:case 35673:return j_e;case 5125:return V_e;case 36294:return G_e;case 36295:return H_e;case 36296:return W_e;case 35678:case 36198:case 36298:case 36306:case 35682:return q_e;case 35679:case 36299:case 36307:return X_e;case 35680:case 36300:case 36308:case 36293:return K_e;case 36289:case 36303:case 36311:case 36292:return Y_e}}function Q_e(r,e){r.uniform1fv(this.addr,e)}function J_e(r,e){const n=xy(e,this.size,2);r.uniform2fv(this.addr,n)}function ewe(r,e){const n=xy(e,this.size,3);r.uniform3fv(this.addr,n)}function twe(r,e){const n=xy(e,this.size,4);r.uniform4fv(this.addr,n)}function nwe(r,e){const n=xy(e,this.size,4);r.uniformMatrix2fv(this.addr,!1,n)}function rwe(r,e){const n=xy(e,this.size,9);r.uniformMatrix3fv(this.addr,!1,n)}function iwe(r,e){const n=xy(e,this.size,16);r.uniformMatrix4fv(this.addr,!1,n)}function swe(r,e){r.uniform1iv(this.addr,e)}function owe(r,e){r.uniform2iv(this.addr,e)}function awe(r,e){r.uniform3iv(this.addr,e)}function lwe(r,e){r.uniform4iv(this.addr,e)}function cwe(r,e){r.uniform1uiv(this.addr,e)}function uwe(r,e){r.uniform2uiv(this.addr,e)}function hwe(r,e){r.uniform3uiv(this.addr,e)}function fwe(r,e){r.uniform4uiv(this.addr,e)}function dwe(r,e,n){const i=this.cache,s=e.length,o=tA(n,s);di(i,o)||(r.uniform1iv(this.addr,o),pi(i,o));for(let a=0;a!==s;++a)n.setTexture2D(e[a]||VY,o[a])}function pwe(r,e,n){const i=this.cache,s=e.length,o=tA(n,s);di(i,o)||(r.uniform1iv(this.addr,o),pi(i,o));for(let a=0;a!==s;++a)n.setTexture3D(e[a]||HY,o[a])}function mwe(r,e,n){const i=this.cache,s=e.length,o=tA(n,s);di(i,o)||(r.uniform1iv(this.addr,o),pi(i,o));for(let a=0;a!==s;++a)n.setTextureCube(e[a]||WY,o[a])}function gwe(r,e,n){const i=this.cache,s=e.length,o=tA(n,s);di(i,o)||(r.uniform1iv(this.addr,o),pi(i,o));for(let a=0;a!==s;++a)n.setTexture2DArray(e[a]||GY,o[a])}function ywe(r){switch(r){case 5126:return Q_e;case 35664:return J_e;case 35665:return ewe;case 35666:return twe;case 35674:return nwe;case 35675:return rwe;case 35676:return iwe;case 5124:case 35670:return swe;case 35667:case 35671:return owe;case 35668:case 35672:return awe;case 35669:case 35673:return lwe;case 5125:return cwe;case 36294:return uwe;case 36295:return hwe;case 36296:return fwe;case 35678:case 36198:case 36298:case 36306:case 35682:return dwe;case 35679:case 36299:case 36307:return pwe;case 35680:case 36300:case 36308:case 36293:return mwe;case 36289:case 36303:case 36311:case 36292:return gwe}}class vwe{constructor(e,n,i){this.id=e,this.addr=i,this.cache=[],this.type=n.type,this.setValue=Z_e(n.type)}}class xwe{constructor(e,n,i){this.id=e,this.addr=i,this.cache=[],this.type=n.type,this.size=n.size,this.setValue=ywe(n.type)}}class bwe{constructor(e){this.id=e,this.seq=[],this.map={}}setValue(e,n,i){const s=this.seq;for(let o=0,a=s.length;o!==a;++o){const l=s[o];l.setValue(e,n[l.id],i)}}}const ER=/(\w+)(\])?(\[|\.)?/g;function QV(r,e){r.seq.push(e),r.map[e.id]=e}function _we(r,e,n){const i=r.name,s=i.length;for(ER.lastIndex=0;;){const o=ER.exec(i),a=ER.lastIndex;let l=o[1];const c=o[2]==="]",u=o[3];if(c&&(l=l|0),u===void 0||u==="["&&a+2===s){QV(n,u===void 0?new vwe(l,r,e):new xwe(l,r,e));break}else{let f=n.map[l];f===void 0&&(f=new bwe(l),QV(n,f)),n=f}}}class N1{constructor(e,n){this.seq=[],this.map={};const i=e.getProgramParameter(n,e.ACTIVE_UNIFORMS);for(let s=0;s<i;++s){const o=e.getActiveUniform(n,s),a=e.getUniformLocation(n,o.name);_we(o,a,this)}}setValue(e,n,i,s){const o=this.map[n];o!==void 0&&o.setValue(e,i,s)}setOptional(e,n,i){const s=n[i];s!==void 0&&this.setValue(e,i,s)}static upload(e,n,i,s){for(let o=0,a=n.length;o!==a;++o){const l=n[o],c=i[l.id];c.needsUpdate!==!1&&l.setValue(e,c.value,s)}}static seqWithValue(e,n){const i=[];for(let s=0,o=e.length;s!==o;++s){const a=e[s];a.id in n&&i.push(a)}return i}}function JV(r,e,n){const i=r.createShader(e);return r.shaderSource(i,n),r.compileShader(i),i}const wwe=37297;let Swe=0;function Twe(r,e){const n=r.split(`
`),i=[],s=Math.max(e-6,0),o=Math.min(e+6,n.length);for(let a=s;a<o;a++){const l=a+1;i.push(`${l===e?">":" "} ${l}: ${n[a]}`)}return i.join(`
`)}const e4=new Bt;function Ewe(r){Qt._getMatrix(e4,Qt.workingColorSpace,r);const e=`mat3( ${e4.elements.map(n=>n.toFixed(4))} )`;switch(Qt.getTransfer(r)){case UT:return[e,"LinearTransferOETF"];case wn:return[e,"sRGBTransferOETF"];default:return console.warn("THREE.WebGLProgram: Unsupported color space: ",r),[e,"LinearTransferOETF"]}}function t4(r,e,n){const i=r.getShaderParameter(e,r.COMPILE_STATUS),s=r.getShaderInfoLog(e).trim();if(i&&s==="")return"";const o=/ERROR: 0:(\d+)/.exec(s);if(o){const a=parseInt(o[1]);return n.toUpperCase()+`

`+s+`

`+Twe(r.getShaderSource(e),a)}else return s}function Mwe(r,e){const n=Ewe(e);return[`vec4 ${r}( vec4 value ) {`,`	return ${n[1]}( vec4( value.rgb * ${n[0]}, value.a ) );`,"}"].join(`
`)}function Awe(r,e){let n;switch(e){case mY:n="Linear";break;case gY:n="Reinhard";break;case yY:n="Cineon";break;case vY:n="ACESFilmic";break;case xY:n="AgX";break;case bY:n="Neutral";break;case Uye:n="Custom";break;default:console.warn("THREE.WebGLProgram: Unsupported toneMapping:",e),n="Linear"}return"vec3 "+r+"( vec3 color ) { return "+n+"ToneMapping( color ); }"}const mS=new K;function Cwe(){Qt.getLuminanceCoefficients(mS);const r=mS.x.toFixed(4),e=mS.y.toFixed(4),n=mS.z.toFixed(4);return["float luminance( const in vec3 rgb ) {",`	const vec3 weights = vec3( ${r}, ${e}, ${n} );`,"	return dot( weights, rgb );","}"].join(`
`)}function Pwe(r){return[r.extensionClipCullDistance?"#extension GL_ANGLE_clip_cull_distance : require":"",r.extensionMultiDraw?"#extension GL_ANGLE_multi_draw : require":""].filter(r0).join(`
`)}function Rwe(r){const e=[];for(const n in r){const i=r[n];i!==!1&&e.push("#define "+n+" "+i)}return e.join(`
`)}function Nwe(r,e){const n={},i=r.getProgramParameter(e,r.ACTIVE_ATTRIBUTES);for(let s=0;s<i;s++){const o=r.getActiveAttrib(e,s),a=o.name;let l=1;o.type===r.FLOAT_MAT2&&(l=2),o.type===r.FLOAT_MAT3&&(l=3),o.type===r.FLOAT_MAT4&&(l=4),n[a]={type:o.type,location:r.getAttribLocation(e,a),locationSize:l}}return n}function r0(r){return r!==""}function n4(r,e){const n=e.numSpotLightShadows+e.numSpotLightMaps-e.numSpotLightShadowsWithMaps;return r.replace(/NUM_DIR_LIGHTS/g,e.numDirLights).replace(/NUM_SPOT_LIGHTS/g,e.numSpotLights).replace(/NUM_SPOT_LIGHT_MAPS/g,e.numSpotLightMaps).replace(/NUM_SPOT_LIGHT_COORDS/g,n).replace(/NUM_RECT_AREA_LIGHTS/g,e.numRectAreaLights).replace(/NUM_POINT_LIGHTS/g,e.numPointLights).replace(/NUM_HEMI_LIGHTS/g,e.numHemiLights).replace(/NUM_DIR_LIGHT_SHADOWS/g,e.numDirLightShadows).replace(/NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS/g,e.numSpotLightShadowsWithMaps).replace(/NUM_SPOT_LIGHT_SHADOWS/g,e.numSpotLightShadows).replace(/NUM_POINT_LIGHT_SHADOWS/g,e.numPointLightShadows)}function r4(r,e){return r.replace(/NUM_CLIPPING_PLANES/g,e.numClippingPlanes).replace(/UNION_CLIPPING_PLANES/g,e.numClippingPlanes-e.numClipIntersection)}const Owe=/^[ \t]*#include +<([\w\d./]+)>/gm;function qO(r){return r.replace(Owe,kwe)}const Dwe=new Map;function kwe(r,e){let n=Zt[e];if(n===void 0){const i=Dwe.get(e);if(i!==void 0)n=Zt[i],console.warn('THREE.WebGLRenderer: Shader chunk "%s" has been deprecated. Use "%s" instead.',e,i);else throw new Error("Can not resolve #include <"+e+">")}return qO(n)}const Iwe=/#pragma unroll_loop_start\s+for\s*\(\s*int\s+i\s*=\s*(\d+)\s*;\s*i\s*<\s*(\d+)\s*;\s*i\s*\+\+\s*\)\s*{([\s\S]+?)}\s+#pragma unroll_loop_end/g;function i4(r){return r.replace(Iwe,Lwe)}function Lwe(r,e,n,i){let s="";for(let o=parseInt(e);o<parseInt(n);o++)s+=i.replace(/\[\s*i\s*\]/g,"[ "+o+" ]").replace(/UNROLLED_LOOP_INDEX/g,o);return s}function s4(r){let e=`precision ${r.precision} float;
	precision ${r.precision} int;
	precision ${r.precision} sampler2D;
	precision ${r.precision} samplerCube;
	precision ${r.precision} sampler3D;
	precision ${r.precision} sampler2DArray;
	precision ${r.precision} sampler2DShadow;
	precision ${r.precision} samplerCubeShadow;
	precision ${r.precision} sampler2DArrayShadow;
	precision ${r.precision} isampler2D;
	precision ${r.precision} isampler3D;
	precision ${r.precision} isamplerCube;
	precision ${r.precision} isampler2DArray;
	precision ${r.precision} usampler2D;
	precision ${r.precision} usampler3D;
	precision ${r.precision} usamplerCube;
	precision ${r.precision} usampler2DArray;
	`;return r.precision==="highp"?e+=`
#define HIGH_PRECISION`:r.precision==="mediump"?e+=`
#define MEDIUM_PRECISION`:r.precision==="lowp"&&(e+=`
#define LOW_PRECISION`),e}function Fwe(r){let e="SHADOWMAP_TYPE_BASIC";return r.shadowMapType===aF?e="SHADOWMAP_TYPE_PCF":r.shadowMapType===kye?e="SHADOWMAP_TYPE_PCF_SOFT":r.shadowMapType===wo&&(e="SHADOWMAP_TYPE_VSM"),e}function Bwe(r){let e="ENVMAP_TYPE_CUBE";if(r.envMap)switch(r.envMapMode){case tl:case nl:e="ENVMAP_TYPE_CUBE";break;case md:e="ENVMAP_TYPE_CUBE_UV";break}return e}function Uwe(r){let e="ENVMAP_MODE_REFLECTION";if(r.envMap)switch(r.envMapMode){case nl:e="ENVMAP_MODE_REFRACTION";break}return e}function zwe(r){let e="ENVMAP_BLENDING_NONE";if(r.envMap)switch(r.combine){case c_:e="ENVMAP_BLENDING_MULTIPLY";break;case dY:e="ENVMAP_BLENDING_MIX";break;case pY:e="ENVMAP_BLENDING_ADD";break}return e}function $we(r){const e=r.envMapCubeUVHeight;if(e===null)return null;const n=Math.log2(e)-2,i=1/e;return{texelWidth:1/(3*Math.max(Math.pow(2,n),7*16)),texelHeight:i,maxMip:n}}function jwe(r,e,n,i){const s=r.getContext(),o=n.defines;let a=n.vertexShader,l=n.fragmentShader;const c=Fwe(n),u=Bwe(n),h=Uwe(n),f=zwe(n),d=$we(n),p=Pwe(n),m=Rwe(o),g=s.createProgram();let v,y,x=n.glslVersion?"#version "+n.glslVersion+`
`:"";n.isRawShaderMaterial?(v=["#define SHADER_TYPE "+n.shaderType,"#define SHADER_NAME "+n.shaderName,m].filter(r0).join(`
`),v.length>0&&(v+=`
`),y=["#define SHADER_TYPE "+n.shaderType,"#define SHADER_NAME "+n.shaderName,m].filter(r0).join(`
`),y.length>0&&(y+=`
`)):(v=[s4(n),"#define SHADER_TYPE "+n.shaderType,"#define SHADER_NAME "+n.shaderName,m,n.extensionClipCullDistance?"#define USE_CLIP_DISTANCE":"",n.batching?"#define USE_BATCHING":"",n.batchingColor?"#define USE_BATCHING_COLOR":"",n.instancing?"#define USE_INSTANCING":"",n.instancingColor?"#define USE_INSTANCING_COLOR":"",n.instancingMorph?"#define USE_INSTANCING_MORPH":"",n.useFog&&n.fog?"#define USE_FOG":"",n.useFog&&n.fogExp2?"#define FOG_EXP2":"",n.map?"#define USE_MAP":"",n.envMap?"#define USE_ENVMAP":"",n.envMap?"#define "+h:"",n.lightMap?"#define USE_LIGHTMAP":"",n.aoMap?"#define USE_AOMAP":"",n.bumpMap?"#define USE_BUMPMAP":"",n.normalMap?"#define USE_NORMALMAP":"",n.normalMapObjectSpace?"#define USE_NORMALMAP_OBJECTSPACE":"",n.normalMapTangentSpace?"#define USE_NORMALMAP_TANGENTSPACE":"",n.displacementMap?"#define USE_DISPLACEMENTMAP":"",n.emissiveMap?"#define USE_EMISSIVEMAP":"",n.anisotropy?"#define USE_ANISOTROPY":"",n.anisotropyMap?"#define USE_ANISOTROPYMAP":"",n.clearcoatMap?"#define USE_CLEARCOATMAP":"",n.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",n.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",n.iridescenceMap?"#define USE_IRIDESCENCEMAP":"",n.iridescenceThicknessMap?"#define USE_IRIDESCENCE_THICKNESSMAP":"",n.specularMap?"#define USE_SPECULARMAP":"",n.specularColorMap?"#define USE_SPECULAR_COLORMAP":"",n.specularIntensityMap?"#define USE_SPECULAR_INTENSITYMAP":"",n.roughnessMap?"#define USE_ROUGHNESSMAP":"",n.metalnessMap?"#define USE_METALNESSMAP":"",n.alphaMap?"#define USE_ALPHAMAP":"",n.alphaHash?"#define USE_ALPHAHASH":"",n.transmission?"#define USE_TRANSMISSION":"",n.transmissionMap?"#define USE_TRANSMISSIONMAP":"",n.thicknessMap?"#define USE_THICKNESSMAP":"",n.sheenColorMap?"#define USE_SHEEN_COLORMAP":"",n.sheenRoughnessMap?"#define USE_SHEEN_ROUGHNESSMAP":"",n.mapUv?"#define MAP_UV "+n.mapUv:"",n.alphaMapUv?"#define ALPHAMAP_UV "+n.alphaMapUv:"",n.lightMapUv?"#define LIGHTMAP_UV "+n.lightMapUv:"",n.aoMapUv?"#define AOMAP_UV "+n.aoMapUv:"",n.emissiveMapUv?"#define EMISSIVEMAP_UV "+n.emissiveMapUv:"",n.bumpMapUv?"#define BUMPMAP_UV "+n.bumpMapUv:"",n.normalMapUv?"#define NORMALMAP_UV "+n.normalMapUv:"",n.displacementMapUv?"#define DISPLACEMENTMAP_UV "+n.displacementMapUv:"",n.metalnessMapUv?"#define METALNESSMAP_UV "+n.metalnessMapUv:"",n.roughnessMapUv?"#define ROUGHNESSMAP_UV "+n.roughnessMapUv:"",n.anisotropyMapUv?"#define ANISOTROPYMAP_UV "+n.anisotropyMapUv:"",n.clearcoatMapUv?"#define CLEARCOATMAP_UV "+n.clearcoatMapUv:"",n.clearcoatNormalMapUv?"#define CLEARCOAT_NORMALMAP_UV "+n.clearcoatNormalMapUv:"",n.clearcoatRoughnessMapUv?"#define CLEARCOAT_ROUGHNESSMAP_UV "+n.clearcoatRoughnessMapUv:"",n.iridescenceMapUv?"#define IRIDESCENCEMAP_UV "+n.iridescenceMapUv:"",n.iridescenceThicknessMapUv?"#define IRIDESCENCE_THICKNESSMAP_UV "+n.iridescenceThicknessMapUv:"",n.sheenColorMapUv?"#define SHEEN_COLORMAP_UV "+n.sheenColorMapUv:"",n.sheenRoughnessMapUv?"#define SHEEN_ROUGHNESSMAP_UV "+n.sheenRoughnessMapUv:"",n.specularMapUv?"#define SPECULARMAP_UV "+n.specularMapUv:"",n.specularColorMapUv?"#define SPECULAR_COLORMAP_UV "+n.specularColorMapUv:"",n.specularIntensityMapUv?"#define SPECULAR_INTENSITYMAP_UV "+n.specularIntensityMapUv:"",n.transmissionMapUv?"#define TRANSMISSIONMAP_UV "+n.transmissionMapUv:"",n.thicknessMapUv?"#define THICKNESSMAP_UV "+n.thicknessMapUv:"",n.vertexTangents&&n.flatShading===!1?"#define USE_TANGENT":"",n.vertexColors?"#define USE_COLOR":"",n.vertexAlphas?"#define USE_COLOR_ALPHA":"",n.vertexUv1s?"#define USE_UV1":"",n.vertexUv2s?"#define USE_UV2":"",n.vertexUv3s?"#define USE_UV3":"",n.pointsUvs?"#define USE_POINTS_UV":"",n.flatShading?"#define FLAT_SHADED":"",n.skinning?"#define USE_SKINNING":"",n.morphTargets?"#define USE_MORPHTARGETS":"",n.morphNormals&&n.flatShading===!1?"#define USE_MORPHNORMALS":"",n.morphColors?"#define USE_MORPHCOLORS":"",n.morphTargetsCount>0?"#define MORPHTARGETS_TEXTURE_STRIDE "+n.morphTextureStride:"",n.morphTargetsCount>0?"#define MORPHTARGETS_COUNT "+n.morphTargetsCount:"",n.doubleSided?"#define DOUBLE_SIDED":"",n.flipSided?"#define FLIP_SIDED":"",n.shadowMapEnabled?"#define USE_SHADOWMAP":"",n.shadowMapEnabled?"#define "+c:"",n.sizeAttenuation?"#define USE_SIZEATTENUATION":"",n.numLightProbes>0?"#define USE_LIGHT_PROBES":"",n.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",n.reverseDepthBuffer?"#define USE_REVERSEDEPTHBUF":"","uniform mat4 modelMatrix;","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform mat4 viewMatrix;","uniform mat3 normalMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;","#ifdef USE_INSTANCING","	attribute mat4 instanceMatrix;","#endif","#ifdef USE_INSTANCING_COLOR","	attribute vec3 instanceColor;","#endif","#ifdef USE_INSTANCING_MORPH","	uniform sampler2D morphTexture;","#endif","attribute vec3 position;","attribute vec3 normal;","attribute vec2 uv;","#ifdef USE_UV1","	attribute vec2 uv1;","#endif","#ifdef USE_UV2","	attribute vec2 uv2;","#endif","#ifdef USE_UV3","	attribute vec2 uv3;","#endif","#ifdef USE_TANGENT","	attribute vec4 tangent;","#endif","#if defined( USE_COLOR_ALPHA )","	attribute vec4 color;","#elif defined( USE_COLOR )","	attribute vec3 color;","#endif","#ifdef USE_SKINNING","	attribute vec4 skinIndex;","	attribute vec4 skinWeight;","#endif",`
`].filter(r0).join(`
`),y=[s4(n),"#define SHADER_TYPE "+n.shaderType,"#define SHADER_NAME "+n.shaderName,m,n.useFog&&n.fog?"#define USE_FOG":"",n.useFog&&n.fogExp2?"#define FOG_EXP2":"",n.alphaToCoverage?"#define ALPHA_TO_COVERAGE":"",n.map?"#define USE_MAP":"",n.matcap?"#define USE_MATCAP":"",n.envMap?"#define USE_ENVMAP":"",n.envMap?"#define "+u:"",n.envMap?"#define "+h:"",n.envMap?"#define "+f:"",d?"#define CUBEUV_TEXEL_WIDTH "+d.texelWidth:"",d?"#define CUBEUV_TEXEL_HEIGHT "+d.texelHeight:"",d?"#define CUBEUV_MAX_MIP "+d.maxMip+".0":"",n.lightMap?"#define USE_LIGHTMAP":"",n.aoMap?"#define USE_AOMAP":"",n.bumpMap?"#define USE_BUMPMAP":"",n.normalMap?"#define USE_NORMALMAP":"",n.normalMapObjectSpace?"#define USE_NORMALMAP_OBJECTSPACE":"",n.normalMapTangentSpace?"#define USE_NORMALMAP_TANGENTSPACE":"",n.emissiveMap?"#define USE_EMISSIVEMAP":"",n.anisotropy?"#define USE_ANISOTROPY":"",n.anisotropyMap?"#define USE_ANISOTROPYMAP":"",n.clearcoat?"#define USE_CLEARCOAT":"",n.clearcoatMap?"#define USE_CLEARCOATMAP":"",n.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",n.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",n.dispersion?"#define USE_DISPERSION":"",n.iridescence?"#define USE_IRIDESCENCE":"",n.iridescenceMap?"#define USE_IRIDESCENCEMAP":"",n.iridescenceThicknessMap?"#define USE_IRIDESCENCE_THICKNESSMAP":"",n.specularMap?"#define USE_SPECULARMAP":"",n.specularColorMap?"#define USE_SPECULAR_COLORMAP":"",n.specularIntensityMap?"#define USE_SPECULAR_INTENSITYMAP":"",n.roughnessMap?"#define USE_ROUGHNESSMAP":"",n.metalnessMap?"#define USE_METALNESSMAP":"",n.alphaMap?"#define USE_ALPHAMAP":"",n.alphaTest?"#define USE_ALPHATEST":"",n.alphaHash?"#define USE_ALPHAHASH":"",n.sheen?"#define USE_SHEEN":"",n.sheenColorMap?"#define USE_SHEEN_COLORMAP":"",n.sheenRoughnessMap?"#define USE_SHEEN_ROUGHNESSMAP":"",n.transmission?"#define USE_TRANSMISSION":"",n.transmissionMap?"#define USE_TRANSMISSIONMAP":"",n.thicknessMap?"#define USE_THICKNESSMAP":"",n.vertexTangents&&n.flatShading===!1?"#define USE_TANGENT":"",n.vertexColors||n.instancingColor||n.batchingColor?"#define USE_COLOR":"",n.vertexAlphas?"#define USE_COLOR_ALPHA":"",n.vertexUv1s?"#define USE_UV1":"",n.vertexUv2s?"#define USE_UV2":"",n.vertexUv3s?"#define USE_UV3":"",n.pointsUvs?"#define USE_POINTS_UV":"",n.gradientMap?"#define USE_GRADIENTMAP":"",n.flatShading?"#define FLAT_SHADED":"",n.doubleSided?"#define DOUBLE_SIDED":"",n.flipSided?"#define FLIP_SIDED":"",n.shadowMapEnabled?"#define USE_SHADOWMAP":"",n.shadowMapEnabled?"#define "+c:"",n.premultipliedAlpha?"#define PREMULTIPLIED_ALPHA":"",n.numLightProbes>0?"#define USE_LIGHT_PROBES":"",n.decodeVideoTexture?"#define DECODE_VIDEO_TEXTURE":"",n.decodeVideoTextureEmissive?"#define DECODE_VIDEO_TEXTURE_EMISSIVE":"",n.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",n.reverseDepthBuffer?"#define USE_REVERSEDEPTHBUF":"","uniform mat4 viewMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;",n.toneMapping!==io?"#define TONE_MAPPING":"",n.toneMapping!==io?Zt.tonemapping_pars_fragment:"",n.toneMapping!==io?Awe("toneMapping",n.toneMapping):"",n.dithering?"#define DITHERING":"",n.opaque?"#define OPAQUE":"",Zt.colorspace_pars_fragment,Mwe("linearToOutputTexel",n.outputColorSpace),Cwe(),n.useDepthPacking?"#define DEPTH_PACKING "+n.depthPacking:"",`
`].filter(r0).join(`
`)),a=qO(a),a=n4(a,n),a=r4(a,n),l=qO(l),l=n4(l,n),l=r4(l,n),a=i4(a),l=i4(l),n.isRawShaderMaterial!==!0&&(x=`#version 300 es
`,v=[p,"#define attribute in","#define varying out","#define texture2D texture"].join(`
`)+`
`+v,y=["#define varying in",n.glslVersion===lV?"":"layout(location = 0) out highp vec4 pc_fragColor;",n.glslVersion===lV?"":"#define gl_FragColor pc_fragColor","#define gl_FragDepthEXT gl_FragDepth","#define texture2D texture","#define textureCube texture","#define texture2DProj textureProj","#define texture2DLodEXT textureLod","#define texture2DProjLodEXT textureProjLod","#define textureCubeLodEXT textureLod","#define texture2DGradEXT textureGrad","#define texture2DProjGradEXT textureProjGrad","#define textureCubeGradEXT textureGrad"].join(`
`)+`
`+y);const b=x+v+a,w=x+y+l,_=JV(s,s.VERTEX_SHADER,b),S=JV(s,s.FRAGMENT_SHADER,w);s.attachShader(g,_),s.attachShader(g,S),n.index0AttributeName!==void 0?s.bindAttribLocation(g,0,n.index0AttributeName):n.morphTargets===!0&&s.bindAttribLocation(g,0,"position"),s.linkProgram(g);function T(P){if(r.debug.checkShaderErrors){const D=s.getProgramInfoLog(g).trim(),B=s.getShaderInfoLog(_).trim(),C=s.getShaderInfoLog(S).trim();let O=!0,R=!0;if(s.getProgramParameter(g,s.LINK_STATUS)===!1)if(O=!1,typeof r.debug.onShaderError=="function")r.debug.onShaderError(s,g,_,S);else{const z=t4(s,_,"vertex"),U=t4(s,S,"fragment");console.error("THREE.WebGLProgram: Shader Error "+s.getError()+" - VALIDATE_STATUS "+s.getProgramParameter(g,s.VALIDATE_STATUS)+`

Material Name: `+P.name+`
Material Type: `+P.type+`

Program Info Log: `+D+`
`+z+`
`+U)}else D!==""?console.warn("THREE.WebGLProgram: Program Info Log:",D):(B===""||C==="")&&(R=!1);R&&(P.diagnostics={runnable:O,programLog:D,vertexShader:{log:B,prefix:v},fragmentShader:{log:C,prefix:y}})}s.deleteShader(_),s.deleteShader(S),E=new N1(s,g),M=Nwe(s,g)}let E;this.getUniforms=function(){return E===void 0&&T(this),E};let M;this.getAttributes=function(){return M===void 0&&T(this),M};let A=n.rendererExtensionParallelShaderCompile===!1;return this.isReady=function(){return A===!1&&(A=s.getProgramParameter(g,wwe)),A},this.destroy=function(){i.releaseStatesOfProgram(this),s.deleteProgram(g),this.program=void 0},this.type=n.shaderType,this.name=n.shaderName,this.id=Swe++,this.cacheKey=e,this.usedTimes=1,this.program=g,this.vertexShader=_,this.fragmentShader=S,this}let Vwe=0;class Gwe{constructor(){this.shaderCache=new Map,this.materialCache=new Map}update(e){const n=e.vertexShader,i=e.fragmentShader,s=this._getShaderStage(n),o=this._getShaderStage(i),a=this._getShaderCacheForMaterial(e);return a.has(s)===!1&&(a.add(s),s.usedTimes++),a.has(o)===!1&&(a.add(o),o.usedTimes++),this}remove(e){const n=this.materialCache.get(e);for(const i of n)i.usedTimes--,i.usedTimes===0&&this.shaderCache.delete(i.code);return this.materialCache.delete(e),this}getVertexShaderID(e){return this._getShaderStage(e.vertexShader).id}getFragmentShaderID(e){return this._getShaderStage(e.fragmentShader).id}dispose(){this.shaderCache.clear(),this.materialCache.clear()}_getShaderCacheForMaterial(e){const n=this.materialCache;let i=n.get(e);return i===void 0&&(i=new Set,n.set(e,i)),i}_getShaderStage(e){const n=this.shaderCache;let i=n.get(e);return i===void 0&&(i=new Hwe(e),n.set(e,i)),i}}class Hwe{constructor(e){this.id=Vwe++,this.code=e,this.usedTimes=0}}function Wwe(r,e,n,i,s,o,a){const l=new NF,c=new Gwe,u=new Set,h=[],f=s.logarithmicDepthBuffer,d=s.vertexTextures;let p=s.precision;const m={MeshDepthMaterial:"depth",MeshDistanceMaterial:"distanceRGBA",MeshNormalMaterial:"normal",MeshBasicMaterial:"basic",MeshLambertMaterial:"lambert",MeshPhongMaterial:"phong",MeshToonMaterial:"toon",MeshStandardMaterial:"physical",MeshPhysicalMaterial:"physical",MeshMatcapMaterial:"matcap",LineBasicMaterial:"basic",LineDashedMaterial:"dashed",PointsMaterial:"points",ShadowMaterial:"shadow",SpriteMaterial:"sprite"};function g(M){return u.add(M),M===0?"uv":`uv${M}`}function v(M,A,P,D,B){const C=D.fog,O=B.geometry,R=M.isMeshStandardMaterial?D.environment:null,z=(M.isMeshStandardMaterial?n:e).get(M.envMap||R),U=z&&z.mapping===md?z.image.height:null,G=m[M.type];M.precision!==null&&(p=s.getMaxPrecision(M.precision),p!==M.precision&&console.warn("THREE.WebGLProgram.getParameters:",M.precision,"not supported, using",p,"instead."));const H=O.morphAttributes.position||O.morphAttributes.normal||O.morphAttributes.color,Y=H!==void 0?H.length:0;let ee=0;O.morphAttributes.position!==void 0&&(ee=1),O.morphAttributes.normal!==void 0&&(ee=2),O.morphAttributes.color!==void 0&&(ee=3);let he,q,J,se;if(G){const Xt=xl[G];he=Xt.vertexShader,q=Xt.fragmentShader}else he=M.vertexShader,q=M.fragmentShader,c.update(M),J=c.getVertexShaderID(M),se=c.getFragmentShaderID(M);const oe=r.getRenderTarget(),Ee=r.state.buffers.depth.getReversed(),ye=B.isInstancedMesh===!0,Ce=B.isBatchedMesh===!0,Ge=!!M.map,_e=!!M.matcap,Ke=!!z,Q=!!M.aoMap,kt=!!M.lightMap,ct=!!M.bumpMap,gt=!!M.normalMap,ot=!!M.displacementMap,on=!!M.emissiveMap,X=!!M.metalnessMap,I=!!M.roughnessMap,k=M.anisotropy>0,ne=M.clearcoat>0,ae=M.dispersion>0,ce=M.iridescence>0,pe=M.sheen>0,ze=M.transmission>0,ke=k&&!!M.anisotropyMap,lt=ne&&!!M.clearcoatMap,wt=ne&&!!M.clearcoatNormalMap,De=ne&&!!M.clearcoatRoughnessMap,et=ce&&!!M.iridescenceMap,St=ce&&!!M.iridescenceThicknessMap,At=pe&&!!M.sheenColorMap,tt=pe&&!!M.sheenRoughnessMap,en=!!M.specularMap,$t=!!M.specularColorMap,fn=!!M.specularIntensityMap,ue=ze&&!!M.transmissionMap,Ye=ze&&!!M.thicknessMap,Se=!!M.gradientMap,Re=!!M.alphaMap,Je=M.alphaTest>0,Ze=!!M.alphaHash,Gt=!!M.extensions;let Vn=io;M.toneMapped&&(oe===null||oe.isXRRenderTarget===!0)&&(Vn=r.toneMapping);const yi={shaderID:G,shaderType:M.type,shaderName:M.name,vertexShader:he,fragmentShader:q,defines:M.defines,customVertexShaderID:J,customFragmentShaderID:se,isRawShaderMaterial:M.isRawShaderMaterial===!0,glslVersion:M.glslVersion,precision:p,batching:Ce,batchingColor:Ce&&B._colorsTexture!==null,instancing:ye,instancingColor:ye&&B.instanceColor!==null,instancingMorph:ye&&B.morphTexture!==null,supportsVertexTextures:d,outputColorSpace:oe===null?r.outputColorSpace:oe.isXRRenderTarget===!0?oe.texture.colorSpace:Ol,alphaToCoverage:!!M.alphaToCoverage,map:Ge,matcap:_e,envMap:Ke,envMapMode:Ke&&z.mapping,envMapCubeUVHeight:U,aoMap:Q,lightMap:kt,bumpMap:ct,normalMap:gt,displacementMap:d&&ot,emissiveMap:on,normalMapObjectSpace:gt&&M.normalMapType===_Y,normalMapTangentSpace:gt&&M.normalMapType===ou,metalnessMap:X,roughnessMap:I,anisotropy:k,anisotropyMap:ke,clearcoat:ne,clearcoatMap:lt,clearcoatNormalMap:wt,clearcoatRoughnessMap:De,dispersion:ae,iridescence:ce,iridescenceMap:et,iridescenceThicknessMap:St,sheen:pe,sheenColorMap:At,sheenRoughnessMap:tt,specularMap:en,specularColorMap:$t,specularIntensityMap:fn,transmission:ze,transmissionMap:ue,thicknessMap:Ye,gradientMap:Se,opaque:M.transparent===!1&&M.blending===Ro&&M.alphaToCoverage===!1,alphaMap:Re,alphaTest:Je,alphaHash:Ze,combine:M.combine,mapUv:Ge&&g(M.map.channel),aoMapUv:Q&&g(M.aoMap.channel),lightMapUv:kt&&g(M.lightMap.channel),bumpMapUv:ct&&g(M.bumpMap.channel),normalMapUv:gt&&g(M.normalMap.channel),displacementMapUv:ot&&g(M.displacementMap.channel),emissiveMapUv:on&&g(M.emissiveMap.channel),metalnessMapUv:X&&g(M.metalnessMap.channel),roughnessMapUv:I&&g(M.roughnessMap.channel),anisotropyMapUv:ke&&g(M.anisotropyMap.channel),clearcoatMapUv:lt&&g(M.clearcoatMap.channel),clearcoatNormalMapUv:wt&&g(M.clearcoatNormalMap.channel),clearcoatRoughnessMapUv:De&&g(M.clearcoatRoughnessMap.channel),iridescenceMapUv:et&&g(M.iridescenceMap.channel),iridescenceThicknessMapUv:St&&g(M.iridescenceThicknessMap.channel),sheenColorMapUv:At&&g(M.sheenColorMap.channel),sheenRoughnessMapUv:tt&&g(M.sheenRoughnessMap.channel),specularMapUv:en&&g(M.specularMap.channel),specularColorMapUv:$t&&g(M.specularColorMap.channel),specularIntensityMapUv:fn&&g(M.specularIntensityMap.channel),transmissionMapUv:ue&&g(M.transmissionMap.channel),thicknessMapUv:Ye&&g(M.thicknessMap.channel),alphaMapUv:Re&&g(M.alphaMap.channel),vertexTangents:!!O.attributes.tangent&&(gt||k),vertexColors:M.vertexColors,vertexAlphas:M.vertexColors===!0&&!!O.attributes.color&&O.attributes.color.itemSize===4,pointsUvs:B.isPoints===!0&&!!O.attributes.uv&&(Ge||Re),fog:!!C,useFog:M.fog===!0,fogExp2:!!C&&C.isFogExp2,flatShading:M.flatShading===!0,sizeAttenuation:M.sizeAttenuation===!0,logarithmicDepthBuffer:f,reverseDepthBuffer:Ee,skinning:B.isSkinnedMesh===!0,morphTargets:O.morphAttributes.position!==void 0,morphNormals:O.morphAttributes.normal!==void 0,morphColors:O.morphAttributes.color!==void 0,morphTargetsCount:Y,morphTextureStride:ee,numDirLights:A.directional.length,numPointLights:A.point.length,numSpotLights:A.spot.length,numSpotLightMaps:A.spotLightMap.length,numRectAreaLights:A.rectArea.length,numHemiLights:A.hemi.length,numDirLightShadows:A.directionalShadowMap.length,numPointLightShadows:A.pointShadowMap.length,numSpotLightShadows:A.spotShadowMap.length,numSpotLightShadowsWithMaps:A.numSpotLightShadowsWithMaps,numLightProbes:A.numLightProbes,numClippingPlanes:a.numPlanes,numClipIntersection:a.numIntersection,dithering:M.dithering,shadowMapEnabled:r.shadowMap.enabled&&P.length>0,shadowMapType:r.shadowMap.type,toneMapping:Vn,decodeVideoTexture:Ge&&M.map.isVideoTexture===!0&&Qt.getTransfer(M.map.colorSpace)===wn,decodeVideoTextureEmissive:on&&M.emissiveMap.isVideoTexture===!0&&Qt.getTransfer(M.emissiveMap.colorSpace)===wn,premultipliedAlpha:M.premultipliedAlpha,doubleSided:M.side===Es,flipSided:M.side===Fn,useDepthPacking:M.depthPacking>=0,depthPacking:M.depthPacking||0,index0AttributeName:M.index0AttributeName,extensionClipCullDistance:Gt&&M.extensions.clipCullDistance===!0&&i.has("WEBGL_clip_cull_distance"),extensionMultiDraw:(Gt&&M.extensions.multiDraw===!0||Ce)&&i.has("WEBGL_multi_draw"),rendererExtensionParallelShaderCompile:i.has("KHR_parallel_shader_compile"),customProgramCacheKey:M.customProgramCacheKey()};return yi.vertexUv1s=u.has(1),yi.vertexUv2s=u.has(2),yi.vertexUv3s=u.has(3),u.clear(),yi}function y(M){const A=[];if(M.shaderID?A.push(M.shaderID):(A.push(M.customVertexShaderID),A.push(M.customFragmentShaderID)),M.defines!==void 0)for(const P in M.defines)A.push(P),A.push(M.defines[P]);return M.isRawShaderMaterial===!1&&(x(A,M),b(A,M),A.push(r.outputColorSpace)),A.push(M.customProgramCacheKey),A.join()}function x(M,A){M.push(A.precision),M.push(A.outputColorSpace),M.push(A.envMapMode),M.push(A.envMapCubeUVHeight),M.push(A.mapUv),M.push(A.alphaMapUv),M.push(A.lightMapUv),M.push(A.aoMapUv),M.push(A.bumpMapUv),M.push(A.normalMapUv),M.push(A.displacementMapUv),M.push(A.emissiveMapUv),M.push(A.metalnessMapUv),M.push(A.roughnessMapUv),M.push(A.anisotropyMapUv),M.push(A.clearcoatMapUv),M.push(A.clearcoatNormalMapUv),M.push(A.clearcoatRoughnessMapUv),M.push(A.iridescenceMapUv),M.push(A.iridescenceThicknessMapUv),M.push(A.sheenColorMapUv),M.push(A.sheenRoughnessMapUv),M.push(A.specularMapUv),M.push(A.specularColorMapUv),M.push(A.specularIntensityMapUv),M.push(A.transmissionMapUv),M.push(A.thicknessMapUv),M.push(A.combine),M.push(A.fogExp2),M.push(A.sizeAttenuation),M.push(A.morphTargetsCount),M.push(A.morphAttributeCount),M.push(A.numDirLights),M.push(A.numPointLights),M.push(A.numSpotLights),M.push(A.numSpotLightMaps),M.push(A.numHemiLights),M.push(A.numRectAreaLights),M.push(A.numDirLightShadows),M.push(A.numPointLightShadows),M.push(A.numSpotLightShadows),M.push(A.numSpotLightShadowsWithMaps),M.push(A.numLightProbes),M.push(A.shadowMapType),M.push(A.toneMapping),M.push(A.numClippingPlanes),M.push(A.numClipIntersection),M.push(A.depthPacking)}function b(M,A){l.disableAll(),A.supportsVertexTextures&&l.enable(0),A.instancing&&l.enable(1),A.instancingColor&&l.enable(2),A.instancingMorph&&l.enable(3),A.matcap&&l.enable(4),A.envMap&&l.enable(5),A.normalMapObjectSpace&&l.enable(6),A.normalMapTangentSpace&&l.enable(7),A.clearcoat&&l.enable(8),A.iridescence&&l.enable(9),A.alphaTest&&l.enable(10),A.vertexColors&&l.enable(11),A.vertexAlphas&&l.enable(12),A.vertexUv1s&&l.enable(13),A.vertexUv2s&&l.enable(14),A.vertexUv3s&&l.enable(15),A.vertexTangents&&l.enable(16),A.anisotropy&&l.enable(17),A.alphaHash&&l.enable(18),A.batching&&l.enable(19),A.dispersion&&l.enable(20),A.batchingColor&&l.enable(21),M.push(l.mask),l.disableAll(),A.fog&&l.enable(0),A.useFog&&l.enable(1),A.flatShading&&l.enable(2),A.logarithmicDepthBuffer&&l.enable(3),A.reverseDepthBuffer&&l.enable(4),A.skinning&&l.enable(5),A.morphTargets&&l.enable(6),A.morphNormals&&l.enable(7),A.morphColors&&l.enable(8),A.premultipliedAlpha&&l.enable(9),A.shadowMapEnabled&&l.enable(10),A.doubleSided&&l.enable(11),A.flipSided&&l.enable(12),A.useDepthPacking&&l.enable(13),A.dithering&&l.enable(14),A.transmission&&l.enable(15),A.sheen&&l.enable(16),A.opaque&&l.enable(17),A.pointsUvs&&l.enable(18),A.decodeVideoTexture&&l.enable(19),A.decodeVideoTextureEmissive&&l.enable(20),A.alphaToCoverage&&l.enable(21),M.push(l.mask)}function w(M){const A=m[M.type];let P;if(A){const D=xl[A];P=MY.clone(D.uniforms)}else P=M.uniforms;return P}function _(M,A){let P;for(let D=0,B=h.length;D<B;D++){const C=h[D];if(C.cacheKey===A){P=C,++P.usedTimes;break}}return P===void 0&&(P=new jwe(r,A,M,o),h.push(P)),P}function S(M){if(--M.usedTimes===0){const A=h.indexOf(M);h[A]=h[h.length-1],h.pop(),M.destroy()}}function T(M){c.remove(M)}function E(){c.dispose()}return{getParameters:v,getProgramCacheKey:y,getUniforms:w,acquireProgram:_,releaseProgram:S,releaseShaderCache:T,programs:h,dispose:E}}function qwe(){let r=new WeakMap;function e(a){return r.has(a)}function n(a){let l=r.get(a);return l===void 0&&(l={},r.set(a,l)),l}function i(a){r.delete(a)}function s(a,l,c){r.get(a)[l]=c}function o(){r=new WeakMap}return{has:e,get:n,remove:i,update:s,dispose:o}}function Xwe(r,e){return r.groupOrder!==e.groupOrder?r.groupOrder-e.groupOrder:r.renderOrder!==e.renderOrder?r.renderOrder-e.renderOrder:r.material.id!==e.material.id?r.material.id-e.material.id:r.z!==e.z?r.z-e.z:r.id-e.id}function o4(r,e){return r.groupOrder!==e.groupOrder?r.groupOrder-e.groupOrder:r.renderOrder!==e.renderOrder?r.renderOrder-e.renderOrder:r.z!==e.z?e.z-r.z:r.id-e.id}function a4(){const r=[];let e=0;const n=[],i=[],s=[];function o(){e=0,n.length=0,i.length=0,s.length=0}function a(f,d,p,m,g,v){let y=r[e];return y===void 0?(y={id:f.id,object:f,geometry:d,material:p,groupOrder:m,renderOrder:f.renderOrder,z:g,group:v},r[e]=y):(y.id=f.id,y.object=f,y.geometry=d,y.material=p,y.groupOrder=m,y.renderOrder=f.renderOrder,y.z=g,y.group=v),e++,y}function l(f,d,p,m,g,v){const y=a(f,d,p,m,g,v);p.transmission>0?i.push(y):p.transparent===!0?s.push(y):n.push(y)}function c(f,d,p,m,g,v){const y=a(f,d,p,m,g,v);p.transmission>0?i.unshift(y):p.transparent===!0?s.unshift(y):n.unshift(y)}function u(f,d){n.length>1&&n.sort(f||Xwe),i.length>1&&i.sort(d||o4),s.length>1&&s.sort(d||o4)}function h(){for(let f=e,d=r.length;f<d;f++){const p=r[f];if(p.id===null)break;p.id=null,p.object=null,p.geometry=null,p.material=null,p.group=null}}return{opaque:n,transmissive:i,transparent:s,init:o,push:l,unshift:c,finish:h,sort:u}}function Kwe(){let r=new WeakMap;function e(i,s){const o=r.get(i);let a;return o===void 0?(a=new a4,r.set(i,[a])):s>=o.length?(a=new a4,o.push(a)):a=o[s],a}function n(){r=new WeakMap}return{get:e,dispose:n}}function Ywe(){const r={};return{get:function(e){if(r[e.id]!==void 0)return r[e.id];let n;switch(e.type){case"DirectionalLight":n={direction:new K,color:new pt};break;case"SpotLight":n={position:new K,direction:new K,color:new pt,distance:0,coneCos:0,penumbraCos:0,decay:0};break;case"PointLight":n={position:new K,color:new pt,distance:0,decay:0};break;case"HemisphereLight":n={direction:new K,skyColor:new pt,groundColor:new pt};break;case"RectAreaLight":n={color:new pt,position:new K,halfWidth:new K,halfHeight:new K};break}return r[e.id]=n,n}}}function Zwe(){const r={};return{get:function(e){if(r[e.id]!==void 0)return r[e.id];let n;switch(e.type){case"DirectionalLight":n={shadowIntensity:1,shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new Fe};break;case"SpotLight":n={shadowIntensity:1,shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new Fe};break;case"PointLight":n={shadowIntensity:1,shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new Fe,shadowCameraNear:1,shadowCameraFar:1e3};break}return r[e.id]=n,n}}}let Qwe=0;function Jwe(r,e){return(e.castShadow?2:0)-(r.castShadow?2:0)+(e.map?1:0)-(r.map?1:0)}function eSe(r){const e=new Ywe,n=Zwe(),i={version:0,hash:{directionalLength:-1,pointLength:-1,spotLength:-1,rectAreaLength:-1,hemiLength:-1,numDirectionalShadows:-1,numPointShadows:-1,numSpotShadows:-1,numSpotMaps:-1,numLightProbes:-1},ambient:[0,0,0],probe:[],directional:[],directionalShadow:[],directionalShadowMap:[],directionalShadowMatrix:[],spot:[],spotLightMap:[],spotShadow:[],spotShadowMap:[],spotLightMatrix:[],rectArea:[],rectAreaLTC1:null,rectAreaLTC2:null,point:[],pointShadow:[],pointShadowMap:[],pointShadowMatrix:[],hemi:[],numSpotLightShadowsWithMaps:0,numLightProbes:0};for(let u=0;u<9;u++)i.probe.push(new K);const s=new K,o=new sn,a=new sn;function l(u){let h=0,f=0,d=0;for(let M=0;M<9;M++)i.probe[M].set(0,0,0);let p=0,m=0,g=0,v=0,y=0,x=0,b=0,w=0,_=0,S=0,T=0;u.sort(Jwe);for(let M=0,A=u.length;M<A;M++){const P=u[M],D=P.color,B=P.intensity,C=P.distance,O=P.shadow&&P.shadow.map?P.shadow.map.texture:null;if(P.isAmbientLight)h+=D.r*B,f+=D.g*B,d+=D.b*B;else if(P.isLightProbe){for(let R=0;R<9;R++)i.probe[R].addScaledVector(P.sh.coefficients[R],B);T++}else if(P.isDirectionalLight){const R=e.get(P);if(R.color.copy(P.color).multiplyScalar(P.intensity),P.castShadow){const z=P.shadow,U=n.get(P);U.shadowIntensity=z.intensity,U.shadowBias=z.bias,U.shadowNormalBias=z.normalBias,U.shadowRadius=z.radius,U.shadowMapSize=z.mapSize,i.directionalShadow[p]=U,i.directionalShadowMap[p]=O,i.directionalShadowMatrix[p]=P.shadow.matrix,x++}i.directional[p]=R,p++}else if(P.isSpotLight){const R=e.get(P);R.position.setFromMatrixPosition(P.matrixWorld),R.color.copy(D).multiplyScalar(B),R.distance=C,R.coneCos=Math.cos(P.angle),R.penumbraCos=Math.cos(P.angle*(1-P.penumbra)),R.decay=P.decay,i.spot[g]=R;const z=P.shadow;if(P.map&&(i.spotLightMap[_]=P.map,_++,z.updateMatrices(P),P.castShadow&&S++),i.spotLightMatrix[g]=z.matrix,P.castShadow){const U=n.get(P);U.shadowIntensity=z.intensity,U.shadowBias=z.bias,U.shadowNormalBias=z.normalBias,U.shadowRadius=z.radius,U.shadowMapSize=z.mapSize,i.spotShadow[g]=U,i.spotShadowMap[g]=O,w++}g++}else if(P.isRectAreaLight){const R=e.get(P);R.color.copy(D).multiplyScalar(B),R.halfWidth.set(P.width*.5,0,0),R.halfHeight.set(0,P.height*.5,0),i.rectArea[v]=R,v++}else if(P.isPointLight){const R=e.get(P);if(R.color.copy(P.color).multiplyScalar(P.intensity),R.distance=P.distance,R.decay=P.decay,P.castShadow){const z=P.shadow,U=n.get(P);U.shadowIntensity=z.intensity,U.shadowBias=z.bias,U.shadowNormalBias=z.normalBias,U.shadowRadius=z.radius,U.shadowMapSize=z.mapSize,U.shadowCameraNear=z.camera.near,U.shadowCameraFar=z.camera.far,i.pointShadow[m]=U,i.pointShadowMap[m]=O,i.pointShadowMatrix[m]=P.shadow.matrix,b++}i.point[m]=R,m++}else if(P.isHemisphereLight){const R=e.get(P);R.skyColor.copy(P.color).multiplyScalar(B),R.groundColor.copy(P.groundColor).multiplyScalar(B),i.hemi[y]=R,y++}}v>0&&(r.has("OES_texture_float_linear")===!0?(i.rectAreaLTC1=Xe.LTC_FLOAT_1,i.rectAreaLTC2=Xe.LTC_FLOAT_2):(i.rectAreaLTC1=Xe.LTC_HALF_1,i.rectAreaLTC2=Xe.LTC_HALF_2)),i.ambient[0]=h,i.ambient[1]=f,i.ambient[2]=d;const E=i.hash;(E.directionalLength!==p||E.pointLength!==m||E.spotLength!==g||E.rectAreaLength!==v||E.hemiLength!==y||E.numDirectionalShadows!==x||E.numPointShadows!==b||E.numSpotShadows!==w||E.numSpotMaps!==_||E.numLightProbes!==T)&&(i.directional.length=p,i.spot.length=g,i.rectArea.length=v,i.point.length=m,i.hemi.length=y,i.directionalShadow.length=x,i.directionalShadowMap.length=x,i.pointShadow.length=b,i.pointShadowMap.length=b,i.spotShadow.length=w,i.spotShadowMap.length=w,i.directionalShadowMatrix.length=x,i.pointShadowMatrix.length=b,i.spotLightMatrix.length=w+_-S,i.spotLightMap.length=_,i.numSpotLightShadowsWithMaps=S,i.numLightProbes=T,E.directionalLength=p,E.pointLength=m,E.spotLength=g,E.rectAreaLength=v,E.hemiLength=y,E.numDirectionalShadows=x,E.numPointShadows=b,E.numSpotShadows=w,E.numSpotMaps=_,E.numLightProbes=T,i.version=Qwe++)}function c(u,h){let f=0,d=0,p=0,m=0,g=0;const v=h.matrixWorldInverse;for(let y=0,x=u.length;y<x;y++){const b=u[y];if(b.isDirectionalLight){const w=i.directional[f];w.direction.setFromMatrixPosition(b.matrixWorld),s.setFromMatrixPosition(b.target.matrixWorld),w.direction.sub(s),w.direction.transformDirection(v),f++}else if(b.isSpotLight){const w=i.spot[p];w.position.setFromMatrixPosition(b.matrixWorld),w.position.applyMatrix4(v),w.direction.setFromMatrixPosition(b.matrixWorld),s.setFromMatrixPosition(b.target.matrixWorld),w.direction.sub(s),w.direction.transformDirection(v),p++}else if(b.isRectAreaLight){const w=i.rectArea[m];w.position.setFromMatrixPosition(b.matrixWorld),w.position.applyMatrix4(v),a.identity(),o.copy(b.matrixWorld),o.premultiply(v),a.extractRotation(o),w.halfWidth.set(b.width*.5,0,0),w.halfHeight.set(0,b.height*.5,0),w.halfWidth.applyMatrix4(a),w.halfHeight.applyMatrix4(a),m++}else if(b.isPointLight){const w=i.point[d];w.position.setFromMatrixPosition(b.matrixWorld),w.position.applyMatrix4(v),d++}else if(b.isHemisphereLight){const w=i.hemi[g];w.direction.setFromMatrixPosition(b.matrixWorld),w.direction.transformDirection(v),g++}}}return{setup:l,setupView:c,state:i}}function l4(r){const e=new eSe(r),n=[],i=[];function s(h){u.camera=h,n.length=0,i.length=0}function o(h){n.push(h)}function a(h){i.push(h)}function l(){e.setup(n)}function c(h){e.setupView(n,h)}const u={lightsArray:n,shadowsArray:i,camera:null,lights:e,transmissionRenderTarget:{}};return{init:s,state:u,setupLights:l,setupLightsView:c,pushLight:o,pushShadow:a}}function tSe(r){let e=new WeakMap;function n(s,o=0){const a=e.get(s);let l;return a===void 0?(l=new l4(r),e.set(s,[l])):o>=a.length?(l=new l4(r),a.push(l)):l=a[o],l}function i(){e=new WeakMap}return{get:n,dispose:i}}const nSe=`void main() {
	gl_Position = vec4( position, 1.0 );
}`,rSe=`uniform sampler2D shadow_pass;
uniform vec2 resolution;
uniform float radius;
#include <packing>
void main() {
	const float samples = float( VSM_SAMPLES );
	float mean = 0.0;
	float squared_mean = 0.0;
	float uvStride = samples <= 1.0 ? 0.0 : 2.0 / ( samples - 1.0 );
	float uvStart = samples <= 1.0 ? 0.0 : - 1.0;
	for ( float i = 0.0; i < samples; i ++ ) {
		float uvOffset = uvStart + i * uvStride;
		#ifdef HORIZONTAL_PASS
			vec2 distribution = unpackRGBATo2Half( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( uvOffset, 0.0 ) * radius ) / resolution ) );
			mean += distribution.x;
			squared_mean += distribution.y * distribution.y + distribution.x * distribution.x;
		#else
			float depth = unpackRGBAToDepth( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( 0.0, uvOffset ) * radius ) / resolution ) );
			mean += depth;
			squared_mean += depth * depth;
		#endif
	}
	mean = mean / samples;
	squared_mean = squared_mean / samples;
	float std_dev = sqrt( squared_mean - mean * mean );
	gl_FragColor = pack2HalfToRGBA( vec2( mean, std_dev ) );
}`;function iSe(r,e,n){let i=new d_;const s=new Fe,o=new Fe,a=new Nt,l=new g0e({depthPacking:jye}),c=new y0e,u={},h=n.maxTextureSize,f={[no]:Fn,[Fn]:no,[Es]:Es},d=new Bl({defines:{VSM_SAMPLES:8},uniforms:{shadow_pass:{value:null},resolution:{value:new Fe},radius:{value:4}},vertexShader:nSe,fragmentShader:rSe}),p=d.clone();p.defines.HORIZONTAL_PASS=1;const m=new ji;m.setAttribute("position",new hi(new Float32Array([-1,-1,.5,3,-1,.5,-1,3,.5]),3));const g=new Jn(m,d),v=this;this.enabled=!1,this.autoUpdate=!0,this.needsUpdate=!1,this.type=aF;let y=this.type;this.render=function(S,T,E){if(v.enabled===!1||v.autoUpdate===!1&&v.needsUpdate===!1||S.length===0)return;const M=r.getRenderTarget(),A=r.getActiveCubeFace(),P=r.getActiveMipmapLevel(),D=r.state;D.setBlending(ro),D.buffers.color.setClear(1,1,1,1),D.buffers.depth.setTest(!0),D.setScissorTest(!1);const B=y!==wo&&this.type===wo,C=y===wo&&this.type!==wo;for(let O=0,R=S.length;O<R;O++){const z=S[O],U=z.shadow;if(U===void 0){console.warn("THREE.WebGLShadowMap:",z,"has no shadow.");continue}if(U.autoUpdate===!1&&U.needsUpdate===!1)continue;s.copy(U.mapSize);const G=U.getFrameExtents();if(s.multiply(G),o.copy(U.mapSize),(s.x>h||s.y>h)&&(s.x>h&&(o.x=Math.floor(h/G.x),s.x=o.x*G.x,U.mapSize.x=o.x),s.y>h&&(o.y=Math.floor(h/G.y),s.y=o.y*G.y,U.mapSize.y=o.y)),U.map===null||B===!0||C===!0){const Y=this.type!==wo?{minFilter:jn,magFilter:jn}:{};U.map!==null&&U.map.dispose(),U.map=new Rh(s.x,s.y,Y),U.map.texture.name=z.name+".shadowMap",U.camera.updateProjectionMatrix()}r.setRenderTarget(U.map),r.clear();const H=U.getViewportCount();for(let Y=0;Y<H;Y++){const ee=U.getViewport(Y);a.set(o.x*ee.x,o.y*ee.y,o.x*ee.z,o.y*ee.w),D.viewport(a),U.updateMatrices(z,Y),i=U.getFrustum(),w(T,E,U.camera,z,this.type)}U.isPointLightShadow!==!0&&this.type===wo&&x(U,E),U.needsUpdate=!1}y=this.type,v.needsUpdate=!1,r.setRenderTarget(M,A,P)};function x(S,T){const E=e.update(g);d.defines.VSM_SAMPLES!==S.blurSamples&&(d.defines.VSM_SAMPLES=S.blurSamples,p.defines.VSM_SAMPLES=S.blurSamples,d.needsUpdate=!0,p.needsUpdate=!0),S.mapPass===null&&(S.mapPass=new Rh(s.x,s.y)),d.uniforms.shadow_pass.value=S.map.texture,d.uniforms.resolution.value=S.mapSize,d.uniforms.radius.value=S.radius,r.setRenderTarget(S.mapPass),r.clear(),r.renderBufferDirect(T,null,E,d,g,null),p.uniforms.shadow_pass.value=S.mapPass.texture,p.uniforms.resolution.value=S.mapSize,p.uniforms.radius.value=S.radius,r.setRenderTarget(S.map),r.clear(),r.renderBufferDirect(T,null,E,p,g,null)}function b(S,T,E,M){let A=null;const P=E.isPointLight===!0?S.customDistanceMaterial:S.customDepthMaterial;if(P!==void 0)A=P;else if(A=E.isPointLight===!0?c:l,r.localClippingEnabled&&T.clipShadows===!0&&Array.isArray(T.clippingPlanes)&&T.clippingPlanes.length!==0||T.displacementMap&&T.displacementScale!==0||T.alphaMap&&T.alphaTest>0||T.map&&T.alphaTest>0||T.alphaToCoverage===!0){const D=A.uuid,B=T.uuid;let C=u[D];C===void 0&&(C={},u[D]=C);let O=C[B];O===void 0&&(O=A.clone(),C[B]=O,T.addEventListener("dispose",_)),A=O}if(A.visible=T.visible,A.wireframe=T.wireframe,M===wo?A.side=T.shadowSide!==null?T.shadowSide:T.side:A.side=T.shadowSide!==null?T.shadowSide:f[T.side],A.alphaMap=T.alphaMap,A.alphaTest=T.alphaToCoverage===!0?.5:T.alphaTest,A.map=T.map,A.clipShadows=T.clipShadows,A.clippingPlanes=T.clippingPlanes,A.clipIntersection=T.clipIntersection,A.displacementMap=T.displacementMap,A.displacementScale=T.displacementScale,A.displacementBias=T.displacementBias,A.wireframeLinewidth=T.wireframeLinewidth,A.linewidth=T.linewidth,E.isPointLight===!0&&A.isMeshDistanceMaterial===!0){const D=r.properties.get(A);D.light=E}return A}function w(S,T,E,M,A){if(S.visible===!1)return;if(S.layers.test(T.layers)&&(S.isMesh||S.isLine||S.isPoints)&&(S.castShadow||S.receiveShadow&&A===wo)&&(!S.frustumCulled||i.intersectsObject(S))){S.modelViewMatrix.multiplyMatrices(E.matrixWorldInverse,S.matrixWorld);const B=e.update(S),C=S.material;if(Array.isArray(C)){const O=B.groups;for(let R=0,z=O.length;R<z;R++){const U=O[R],G=C[U.materialIndex];if(G&&G.visible){const H=b(S,G,M,A);S.onBeforeShadow(r,S,T,E,B,H,U),r.renderBufferDirect(E,null,B,H,S,U),S.onAfterShadow(r,S,T,E,B,H,U)}}}else if(C.visible){const O=b(S,C,M,A);S.onBeforeShadow(r,S,T,E,B,O,null),r.renderBufferDirect(E,null,B,O,S,null),S.onAfterShadow(r,S,T,E,B,O,null)}}const D=S.children;for(let B=0,C=D.length;B<C;B++)w(D[B],T,E,M,A)}function _(S){S.target.removeEventListener("dispose",_);for(const E in u){const M=u[E],A=S.target.uuid;A in M&&(M[A].dispose(),delete M[A])}}}const sSe={[Dx]:kx,[Ix]:Bx,[Lx]:Ux,[Ch]:Fx,[kx]:Dx,[Bx]:Ix,[Ux]:Lx,[Fx]:Ch};function oSe(r,e){function n(){let ue=!1;const Ye=new Nt;let Se=null;const Re=new Nt(0,0,0,0);return{setMask:function(Je){Se!==Je&&!ue&&(r.colorMask(Je,Je,Je,Je),Se=Je)},setLocked:function(Je){ue=Je},setClear:function(Je,Ze,Gt,Vn,yi){yi===!0&&(Je*=Vn,Ze*=Vn,Gt*=Vn),Ye.set(Je,Ze,Gt,Vn),Re.equals(Ye)===!1&&(r.clearColor(Je,Ze,Gt,Vn),Re.copy(Ye))},reset:function(){ue=!1,Se=null,Re.set(-1,0,0,0)}}}function i(){let ue=!1,Ye=!1,Se=null,Re=null,Je=null;return{setReversed:function(Ze){if(Ye!==Ze){const Gt=e.get("EXT_clip_control");Ze?Gt.clipControlEXT(Gt.LOWER_LEFT_EXT,Gt.ZERO_TO_ONE_EXT):Gt.clipControlEXT(Gt.LOWER_LEFT_EXT,Gt.NEGATIVE_ONE_TO_ONE_EXT),Ye=Ze;const Vn=Je;Je=null,this.setClear(Vn)}},getReversed:function(){return Ye},setTest:function(Ze){Ze?oe(r.DEPTH_TEST):Ee(r.DEPTH_TEST)},setMask:function(Ze){Se!==Ze&&!ue&&(r.depthMask(Ze),Se=Ze)},setFunc:function(Ze){if(Ye&&(Ze=sSe[Ze]),Re!==Ze){switch(Ze){case Dx:r.depthFunc(r.NEVER);break;case kx:r.depthFunc(r.ALWAYS);break;case Ix:r.depthFunc(r.LESS);break;case Ch:r.depthFunc(r.LEQUAL);break;case Lx:r.depthFunc(r.EQUAL);break;case Fx:r.depthFunc(r.GEQUAL);break;case Bx:r.depthFunc(r.GREATER);break;case Ux:r.depthFunc(r.NOTEQUAL);break;default:r.depthFunc(r.LEQUAL)}Re=Ze}},setLocked:function(Ze){ue=Ze},setClear:function(Ze){Je!==Ze&&(Ye&&(Ze=1-Ze),r.clearDepth(Ze),Je=Ze)},reset:function(){ue=!1,Se=null,Re=null,Je=null,Ye=!1}}}function s(){let ue=!1,Ye=null,Se=null,Re=null,Je=null,Ze=null,Gt=null,Vn=null,yi=null;return{setTest:function(Xt){ue||(Xt?oe(r.STENCIL_TEST):Ee(r.STENCIL_TEST))},setMask:function(Xt){Ye!==Xt&&!ue&&(r.stencilMask(Xt),Ye=Xt)},setFunc:function(Xt,Us,ya){(Se!==Xt||Re!==Us||Je!==ya)&&(r.stencilFunc(Xt,Us,ya),Se=Xt,Re=Us,Je=ya)},setOp:function(Xt,Us,ya){(Ze!==Xt||Gt!==Us||Vn!==ya)&&(r.stencilOp(Xt,Us,ya),Ze=Xt,Gt=Us,Vn=ya)},setLocked:function(Xt){ue=Xt},setClear:function(Xt){yi!==Xt&&(r.clearStencil(Xt),yi=Xt)},reset:function(){ue=!1,Ye=null,Se=null,Re=null,Je=null,Ze=null,Gt=null,Vn=null,yi=null}}}const o=new n,a=new i,l=new s,c=new WeakMap,u=new WeakMap;let h={},f={},d=new WeakMap,p=[],m=null,g=!1,v=null,y=null,x=null,b=null,w=null,_=null,S=null,T=new pt(0,0,0),E=0,M=!1,A=null,P=null,D=null,B=null,C=null;const O=r.getParameter(r.MAX_COMBINED_TEXTURE_IMAGE_UNITS);let R=!1,z=0;const U=r.getParameter(r.VERSION);U.indexOf("WebGL")!==-1?(z=parseFloat(/^WebGL (\d)/.exec(U)[1]),R=z>=1):U.indexOf("OpenGL ES")!==-1&&(z=parseFloat(/^OpenGL ES (\d)/.exec(U)[1]),R=z>=2);let G=null,H={};const Y=r.getParameter(r.SCISSOR_BOX),ee=r.getParameter(r.VIEWPORT),he=new Nt().fromArray(Y),q=new Nt().fromArray(ee);function J(ue,Ye,Se,Re){const Je=new Uint8Array(4),Ze=r.createTexture();r.bindTexture(ue,Ze),r.texParameteri(ue,r.TEXTURE_MIN_FILTER,r.NEAREST),r.texParameteri(ue,r.TEXTURE_MAG_FILTER,r.NEAREST);for(let Gt=0;Gt<Se;Gt++)ue===r.TEXTURE_3D||ue===r.TEXTURE_2D_ARRAY?r.texImage3D(Ye,0,r.RGBA,1,1,Re,0,r.RGBA,r.UNSIGNED_BYTE,Je):r.texImage2D(Ye+Gt,0,r.RGBA,1,1,0,r.RGBA,r.UNSIGNED_BYTE,Je);return Ze}const se={};se[r.TEXTURE_2D]=J(r.TEXTURE_2D,r.TEXTURE_2D,1),se[r.TEXTURE_CUBE_MAP]=J(r.TEXTURE_CUBE_MAP,r.TEXTURE_CUBE_MAP_POSITIVE_X,6),se[r.TEXTURE_2D_ARRAY]=J(r.TEXTURE_2D_ARRAY,r.TEXTURE_2D_ARRAY,1,1),se[r.TEXTURE_3D]=J(r.TEXTURE_3D,r.TEXTURE_3D,1,1),o.setClear(0,0,0,1),a.setClear(1),l.setClear(0),oe(r.DEPTH_TEST),a.setFunc(Ch),ct(!1),gt(jO),oe(r.CULL_FACE),Q(ro);function oe(ue){h[ue]!==!0&&(r.enable(ue),h[ue]=!0)}function Ee(ue){h[ue]!==!1&&(r.disable(ue),h[ue]=!1)}function ye(ue,Ye){return f[ue]!==Ye?(r.bindFramebuffer(ue,Ye),f[ue]=Ye,ue===r.DRAW_FRAMEBUFFER&&(f[r.FRAMEBUFFER]=Ye),ue===r.FRAMEBUFFER&&(f[r.DRAW_FRAMEBUFFER]=Ye),!0):!1}function Ce(ue,Ye){let Se=p,Re=!1;if(ue){Se=d.get(Ye),Se===void 0&&(Se=[],d.set(Ye,Se));const Je=ue.textures;if(Se.length!==Je.length||Se[0]!==r.COLOR_ATTACHMENT0){for(let Ze=0,Gt=Je.length;Ze<Gt;Ze++)Se[Ze]=r.COLOR_ATTACHMENT0+Ze;Se.length=Je.length,Re=!0}}else Se[0]!==r.BACK&&(Se[0]=r.BACK,Re=!0);Re&&r.drawBuffers(Se)}function Ge(ue){return m!==ue?(r.useProgram(ue),m=ue,!0):!1}const _e={[ss]:r.FUNC_ADD,[lF]:r.FUNC_SUBTRACT,[cF]:r.FUNC_REVERSE_SUBTRACT};_e[hY]=r.MIN,_e[fY]=r.MAX;const Ke={[wc]:r.ZERO,[uF]:r.ONE,[hF]:r.SRC_COLOR,[Nx]:r.SRC_ALPHA,[yF]:r.SRC_ALPHA_SATURATE,[mF]:r.DST_COLOR,[dF]:r.DST_ALPHA,[fF]:r.ONE_MINUS_SRC_COLOR,[Ox]:r.ONE_MINUS_SRC_ALPHA,[gF]:r.ONE_MINUS_DST_COLOR,[pF]:r.ONE_MINUS_DST_ALPHA,[Iye]:r.CONSTANT_COLOR,[Lye]:r.ONE_MINUS_CONSTANT_COLOR,[Fye]:r.CONSTANT_ALPHA,[Bye]:r.ONE_MINUS_CONSTANT_ALPHA};function Q(ue,Ye,Se,Re,Je,Ze,Gt,Vn,yi,Xt){if(ue===ro){g===!0&&(Ee(r.BLEND),g=!1);return}if(g===!1&&(oe(r.BLEND),g=!0),ue!==Pm){if(ue!==v||Xt!==M){if((y!==ss||w!==ss)&&(r.blendEquation(r.FUNC_ADD),y=ss,w=ss),Xt)switch(ue){case Ro:r.blendFuncSeparate(r.ONE,r.ONE_MINUS_SRC_ALPHA,r.ONE,r.ONE_MINUS_SRC_ALPHA);break;case Jm:r.blendFunc(r.ONE,r.ONE);break;case eg:r.blendFuncSeparate(r.ZERO,r.ONE_MINUS_SRC_COLOR,r.ZERO,r.ONE);break;case tg:r.blendFuncSeparate(r.ZERO,r.SRC_COLOR,r.ZERO,r.SRC_ALPHA);break;default:console.error("THREE.WebGLState: Invalid blending: ",ue);break}else switch(ue){case Ro:r.blendFuncSeparate(r.SRC_ALPHA,r.ONE_MINUS_SRC_ALPHA,r.ONE,r.ONE_MINUS_SRC_ALPHA);break;case Jm:r.blendFunc(r.SRC_ALPHA,r.ONE);break;case eg:r.blendFuncSeparate(r.ZERO,r.ONE_MINUS_SRC_COLOR,r.ZERO,r.ONE);break;case tg:r.blendFunc(r.ZERO,r.SRC_COLOR);break;default:console.error("THREE.WebGLState: Invalid blending: ",ue);break}x=null,b=null,_=null,S=null,T.set(0,0,0),E=0,v=ue,M=Xt}return}Je=Je||Ye,Ze=Ze||Se,Gt=Gt||Re,(Ye!==y||Je!==w)&&(r.blendEquationSeparate(_e[Ye],_e[Je]),y=Ye,w=Je),(Se!==x||Re!==b||Ze!==_||Gt!==S)&&(r.blendFuncSeparate(Ke[Se],Ke[Re],Ke[Ze],Ke[Gt]),x=Se,b=Re,_=Ze,S=Gt),(Vn.equals(T)===!1||yi!==E)&&(r.blendColor(Vn.r,Vn.g,Vn.b,yi),T.copy(Vn),E=yi),v=ue,M=!1}function kt(ue,Ye){ue.side===Es?Ee(r.CULL_FACE):oe(r.CULL_FACE);let Se=ue.side===Fn;Ye&&(Se=!Se),ct(Se),ue.blending===Ro&&ue.transparent===!1?Q(ro):Q(ue.blending,ue.blendEquation,ue.blendSrc,ue.blendDst,ue.blendEquationAlpha,ue.blendSrcAlpha,ue.blendDstAlpha,ue.blendColor,ue.blendAlpha,ue.premultipliedAlpha),a.setFunc(ue.depthFunc),a.setTest(ue.depthTest),a.setMask(ue.depthWrite),o.setMask(ue.colorWrite);const Re=ue.stencilWrite;l.setTest(Re),Re&&(l.setMask(ue.stencilWriteMask),l.setFunc(ue.stencilFunc,ue.stencilRef,ue.stencilFuncMask),l.setOp(ue.stencilFail,ue.stencilZFail,ue.stencilZPass)),on(ue.polygonOffset,ue.polygonOffsetFactor,ue.polygonOffsetUnits),ue.alphaToCoverage===!0?oe(r.SAMPLE_ALPHA_TO_COVERAGE):Ee(r.SAMPLE_ALPHA_TO_COVERAGE)}function ct(ue){A!==ue&&(ue?r.frontFace(r.CW):r.frontFace(r.CCW),A=ue)}function gt(ue){ue!==cY?(oe(r.CULL_FACE),ue!==P&&(ue===jO?r.cullFace(r.BACK):ue===uY?r.cullFace(r.FRONT):r.cullFace(r.FRONT_AND_BACK))):Ee(r.CULL_FACE),P=ue}function ot(ue){ue!==D&&(R&&r.lineWidth(ue),D=ue)}function on(ue,Ye,Se){ue?(oe(r.POLYGON_OFFSET_FILL),(B!==Ye||C!==Se)&&(r.polygonOffset(Ye,Se),B=Ye,C=Se)):Ee(r.POLYGON_OFFSET_FILL)}function X(ue){ue?oe(r.SCISSOR_TEST):Ee(r.SCISSOR_TEST)}function I(ue){ue===void 0&&(ue=r.TEXTURE0+O-1),G!==ue&&(r.activeTexture(ue),G=ue)}function k(ue,Ye,Se){Se===void 0&&(G===null?Se=r.TEXTURE0+O-1:Se=G);let Re=H[Se];Re===void 0&&(Re={type:void 0,texture:void 0},H[Se]=Re),(Re.type!==ue||Re.texture!==Ye)&&(G!==Se&&(r.activeTexture(Se),G=Se),r.bindTexture(ue,Ye||se[ue]),Re.type=ue,Re.texture=Ye)}function ne(){const ue=H[G];ue!==void 0&&ue.type!==void 0&&(r.bindTexture(ue.type,null),ue.type=void 0,ue.texture=void 0)}function ae(){try{r.compressedTexImage2D(...arguments)}catch(ue){console.error("THREE.WebGLState:",ue)}}function ce(){try{r.compressedTexImage3D(...arguments)}catch(ue){console.error("THREE.WebGLState:",ue)}}function pe(){try{r.texSubImage2D(...arguments)}catch(ue){console.error("THREE.WebGLState:",ue)}}function ze(){try{r.texSubImage3D(...arguments)}catch(ue){console.error("THREE.WebGLState:",ue)}}function ke(){try{r.compressedTexSubImage2D(...arguments)}catch(ue){console.error("THREE.WebGLState:",ue)}}function lt(){try{r.compressedTexSubImage3D(...arguments)}catch(ue){console.error("THREE.WebGLState:",ue)}}function wt(){try{r.texStorage2D(...arguments)}catch(ue){console.error("THREE.WebGLState:",ue)}}function De(){try{r.texStorage3D(...arguments)}catch(ue){console.error("THREE.WebGLState:",ue)}}function et(){try{r.texImage2D(...arguments)}catch(ue){console.error("THREE.WebGLState:",ue)}}function St(){try{r.texImage3D(...arguments)}catch(ue){console.error("THREE.WebGLState:",ue)}}function At(ue){he.equals(ue)===!1&&(r.scissor(ue.x,ue.y,ue.z,ue.w),he.copy(ue))}function tt(ue){q.equals(ue)===!1&&(r.viewport(ue.x,ue.y,ue.z,ue.w),q.copy(ue))}function en(ue,Ye){let Se=u.get(Ye);Se===void 0&&(Se=new WeakMap,u.set(Ye,Se));let Re=Se.get(ue);Re===void 0&&(Re=r.getUniformBlockIndex(Ye,ue.name),Se.set(ue,Re))}function $t(ue,Ye){const Re=u.get(Ye).get(ue);c.get(Ye)!==Re&&(r.uniformBlockBinding(Ye,Re,ue.__bindingPointIndex),c.set(Ye,Re))}function fn(){r.disable(r.BLEND),r.disable(r.CULL_FACE),r.disable(r.DEPTH_TEST),r.disable(r.POLYGON_OFFSET_FILL),r.disable(r.SCISSOR_TEST),r.disable(r.STENCIL_TEST),r.disable(r.SAMPLE_ALPHA_TO_COVERAGE),r.blendEquation(r.FUNC_ADD),r.blendFunc(r.ONE,r.ZERO),r.blendFuncSeparate(r.ONE,r.ZERO,r.ONE,r.ZERO),r.blendColor(0,0,0,0),r.colorMask(!0,!0,!0,!0),r.clearColor(0,0,0,0),r.depthMask(!0),r.depthFunc(r.LESS),a.setReversed(!1),r.clearDepth(1),r.stencilMask(4294967295),r.stencilFunc(r.ALWAYS,0,4294967295),r.stencilOp(r.KEEP,r.KEEP,r.KEEP),r.clearStencil(0),r.cullFace(r.BACK),r.frontFace(r.CCW),r.polygonOffset(0,0),r.activeTexture(r.TEXTURE0),r.bindFramebuffer(r.FRAMEBUFFER,null),r.bindFramebuffer(r.DRAW_FRAMEBUFFER,null),r.bindFramebuffer(r.READ_FRAMEBUFFER,null),r.useProgram(null),r.lineWidth(1),r.scissor(0,0,r.canvas.width,r.canvas.height),r.viewport(0,0,r.canvas.width,r.canvas.height),h={},G=null,H={},f={},d=new WeakMap,p=[],m=null,g=!1,v=null,y=null,x=null,b=null,w=null,_=null,S=null,T=new pt(0,0,0),E=0,M=!1,A=null,P=null,D=null,B=null,C=null,he.set(0,0,r.canvas.width,r.canvas.height),q.set(0,0,r.canvas.width,r.canvas.height),o.reset(),a.reset(),l.reset()}return{buffers:{color:o,depth:a,stencil:l},enable:oe,disable:Ee,bindFramebuffer:ye,drawBuffers:Ce,useProgram:Ge,setBlending:Q,setMaterial:kt,setFlipSided:ct,setCullFace:gt,setLineWidth:ot,setPolygonOffset:on,setScissorTest:X,activeTexture:I,bindTexture:k,unbindTexture:ne,compressedTexImage2D:ae,compressedTexImage3D:ce,texImage2D:et,texImage3D:St,updateUBOMapping:en,uniformBlockBinding:$t,texStorage2D:wt,texStorage3D:De,texSubImage2D:pe,texSubImage3D:ze,compressedTexSubImage2D:ke,compressedTexSubImage3D:lt,scissor:At,viewport:tt,reset:fn}}function aSe(r,e,n,i,s,o,a){const l=e.has("WEBGL_multisampled_render_to_texture")?e.get("WEBGL_multisampled_render_to_texture"):null,c=typeof navigator>"u"?!1:/OculusBrowser/g.test(navigator.userAgent),u=new Fe,h=new WeakMap;let f;const d=new WeakMap;let p=!1;try{p=typeof OffscreenCanvas<"u"&&new OffscreenCanvas(1,1).getContext("2d")!==null}catch{}function m(I,k){return p?new OffscreenCanvas(I,k):Xx("canvas")}function g(I,k,ne){let ae=1;const ce=X(I);if((ce.width>ne||ce.height>ne)&&(ae=ne/Math.max(ce.width,ce.height)),ae<1)if(typeof HTMLImageElement<"u"&&I instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&I instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&I instanceof ImageBitmap||typeof VideoFrame<"u"&&I instanceof VideoFrame){const pe=Math.floor(ae*ce.width),ze=Math.floor(ae*ce.height);f===void 0&&(f=m(pe,ze));const ke=k?m(pe,ze):f;return ke.width=pe,ke.height=ze,ke.getContext("2d").drawImage(I,0,0,pe,ze),console.warn("THREE.WebGLRenderer: Texture has been resized from ("+ce.width+"x"+ce.height+") to ("+pe+"x"+ze+")."),ke}else return"data"in I&&console.warn("THREE.WebGLRenderer: Image in DataTexture is too big ("+ce.width+"x"+ce.height+")."),I;return I}function v(I){return I.generateMipmaps}function y(I){r.generateMipmap(I)}function x(I){return I.isWebGLCubeRenderTarget?r.TEXTURE_CUBE_MAP:I.isWebGL3DRenderTarget?r.TEXTURE_3D:I.isWebGLArrayRenderTarget||I.isCompressedArrayTexture?r.TEXTURE_2D_ARRAY:r.TEXTURE_2D}function b(I,k,ne,ae,ce=!1){if(I!==null){if(r[I]!==void 0)return r[I];console.warn("THREE.WebGLRenderer: Attempt to use non-existing WebGL internal format '"+I+"'")}let pe=k;if(k===r.RED&&(ne===r.FLOAT&&(pe=r.R32F),ne===r.HALF_FLOAT&&(pe=r.R16F),ne===r.UNSIGNED_BYTE&&(pe=r.R8)),k===r.RED_INTEGER&&(ne===r.UNSIGNED_BYTE&&(pe=r.R8UI),ne===r.UNSIGNED_SHORT&&(pe=r.R16UI),ne===r.UNSIGNED_INT&&(pe=r.R32UI),ne===r.BYTE&&(pe=r.R8I),ne===r.SHORT&&(pe=r.R16I),ne===r.INT&&(pe=r.R32I)),k===r.RG&&(ne===r.FLOAT&&(pe=r.RG32F),ne===r.HALF_FLOAT&&(pe=r.RG16F),ne===r.UNSIGNED_BYTE&&(pe=r.RG8)),k===r.RG_INTEGER&&(ne===r.UNSIGNED_BYTE&&(pe=r.RG8UI),ne===r.UNSIGNED_SHORT&&(pe=r.RG16UI),ne===r.UNSIGNED_INT&&(pe=r.RG32UI),ne===r.BYTE&&(pe=r.RG8I),ne===r.SHORT&&(pe=r.RG16I),ne===r.INT&&(pe=r.RG32I)),k===r.RGB_INTEGER&&(ne===r.UNSIGNED_BYTE&&(pe=r.RGB8UI),ne===r.UNSIGNED_SHORT&&(pe=r.RGB16UI),ne===r.UNSIGNED_INT&&(pe=r.RGB32UI),ne===r.BYTE&&(pe=r.RGB8I),ne===r.SHORT&&(pe=r.RGB16I),ne===r.INT&&(pe=r.RGB32I)),k===r.RGBA_INTEGER&&(ne===r.UNSIGNED_BYTE&&(pe=r.RGBA8UI),ne===r.UNSIGNED_SHORT&&(pe=r.RGBA16UI),ne===r.UNSIGNED_INT&&(pe=r.RGBA32UI),ne===r.BYTE&&(pe=r.RGBA8I),ne===r.SHORT&&(pe=r.RGBA16I),ne===r.INT&&(pe=r.RGBA32I)),k===r.RGB&&ne===r.UNSIGNED_INT_5_9_9_9_REV&&(pe=r.RGB9_E5),k===r.RGBA){const ze=ce?UT:Qt.getTransfer(ae);ne===r.FLOAT&&(pe=r.RGBA32F),ne===r.HALF_FLOAT&&(pe=r.RGBA16F),ne===r.UNSIGNED_BYTE&&(pe=ze===wn?r.SRGB8_ALPHA8:r.RGBA8),ne===r.UNSIGNED_SHORT_4_4_4_4&&(pe=r.RGBA4),ne===r.UNSIGNED_SHORT_5_5_5_1&&(pe=r.RGB5_A1)}return(pe===r.R16F||pe===r.R32F||pe===r.RG16F||pe===r.RG32F||pe===r.RGBA16F||pe===r.RGBA32F)&&e.get("EXT_color_buffer_float"),pe}function w(I,k){let ne;return I?k===null||k===In||k===No?ne=r.DEPTH24_STENCIL8:k===Nr?ne=r.DEPTH32F_STENCIL8:k===qa&&(ne=r.DEPTH24_STENCIL8,console.warn("DepthTexture: 16 bit depth attachment is not supported with stencil. Using 24-bit attachment.")):k===null||k===In||k===No?ne=r.DEPTH_COMPONENT24:k===Nr?ne=r.DEPTH_COMPONENT32F:k===qa&&(ne=r.DEPTH_COMPONENT16),ne}function _(I,k){return v(I)===!0||I.isFramebufferTexture&&I.minFilter!==jn&&I.minFilter!==li?Math.log2(Math.max(k.width,k.height))+1:I.mipmaps!==void 0&&I.mipmaps.length>0?I.mipmaps.length:I.isCompressedTexture&&Array.isArray(I.image)?k.mipmaps.length:1}function S(I){const k=I.target;k.removeEventListener("dispose",S),E(k),k.isVideoTexture&&h.delete(k)}function T(I){const k=I.target;k.removeEventListener("dispose",T),A(k)}function E(I){const k=i.get(I);if(k.__webglInit===void 0)return;const ne=I.source,ae=d.get(ne);if(ae){const ce=ae[k.__cacheKey];ce.usedTimes--,ce.usedTimes===0&&M(I),Object.keys(ae).length===0&&d.delete(ne)}i.remove(I)}function M(I){const k=i.get(I);r.deleteTexture(k.__webglTexture);const ne=I.source,ae=d.get(ne);delete ae[k.__cacheKey],a.memory.textures--}function A(I){const k=i.get(I);if(I.depthTexture&&(I.depthTexture.dispose(),i.remove(I.depthTexture)),I.isWebGLCubeRenderTarget)for(let ae=0;ae<6;ae++){if(Array.isArray(k.__webglFramebuffer[ae]))for(let ce=0;ce<k.__webglFramebuffer[ae].length;ce++)r.deleteFramebuffer(k.__webglFramebuffer[ae][ce]);else r.deleteFramebuffer(k.__webglFramebuffer[ae]);k.__webglDepthbuffer&&r.deleteRenderbuffer(k.__webglDepthbuffer[ae])}else{if(Array.isArray(k.__webglFramebuffer))for(let ae=0;ae<k.__webglFramebuffer.length;ae++)r.deleteFramebuffer(k.__webglFramebuffer[ae]);else r.deleteFramebuffer(k.__webglFramebuffer);if(k.__webglDepthbuffer&&r.deleteRenderbuffer(k.__webglDepthbuffer),k.__webglMultisampledFramebuffer&&r.deleteFramebuffer(k.__webglMultisampledFramebuffer),k.__webglColorRenderbuffer)for(let ae=0;ae<k.__webglColorRenderbuffer.length;ae++)k.__webglColorRenderbuffer[ae]&&r.deleteRenderbuffer(k.__webglColorRenderbuffer[ae]);k.__webglDepthRenderbuffer&&r.deleteRenderbuffer(k.__webglDepthRenderbuffer)}const ne=I.textures;for(let ae=0,ce=ne.length;ae<ce;ae++){const pe=i.get(ne[ae]);pe.__webglTexture&&(r.deleteTexture(pe.__webglTexture),a.memory.textures--),i.remove(ne[ae])}i.remove(I)}let P=0;function D(){P=0}function B(){const I=P;return I>=s.maxTextures&&console.warn("THREE.WebGLTextures: Trying to use "+I+" texture units while this GPU supports only "+s.maxTextures),P+=1,I}function C(I){const k=[];return k.push(I.wrapS),k.push(I.wrapT),k.push(I.wrapR||0),k.push(I.magFilter),k.push(I.minFilter),k.push(I.anisotropy),k.push(I.internalFormat),k.push(I.format),k.push(I.type),k.push(I.generateMipmaps),k.push(I.premultiplyAlpha),k.push(I.flipY),k.push(I.unpackAlignment),k.push(I.colorSpace),k.join()}function O(I,k){const ne=i.get(I);if(I.isVideoTexture&&ot(I),I.isRenderTargetTexture===!1&&I.version>0&&ne.__version!==I.version){const ae=I.image;if(ae===null)console.warn("THREE.WebGLRenderer: Texture marked for update but no image data found.");else if(ae.complete===!1)console.warn("THREE.WebGLRenderer: Texture marked for update but image is incomplete");else{q(ne,I,k);return}}n.bindTexture(r.TEXTURE_2D,ne.__webglTexture,r.TEXTURE0+k)}function R(I,k){const ne=i.get(I);if(I.version>0&&ne.__version!==I.version){q(ne,I,k);return}n.bindTexture(r.TEXTURE_2D_ARRAY,ne.__webglTexture,r.TEXTURE0+k)}function z(I,k){const ne=i.get(I);if(I.version>0&&ne.__version!==I.version){q(ne,I,k);return}n.bindTexture(r.TEXTURE_3D,ne.__webglTexture,r.TEXTURE0+k)}function U(I,k){const ne=i.get(I);if(I.version>0&&ne.__version!==I.version){J(ne,I,k);return}n.bindTexture(r.TEXTURE_CUBE_MAP,ne.__webglTexture,r.TEXTURE0+k)}const G={[gd]:r.REPEAT,[Tl]:r.CLAMP_TO_EDGE,[yd]:r.MIRRORED_REPEAT},H={[jn]:r.NEAREST,[xF]:r.NEAREST_MIPMAP_NEAREST,[Dc]:r.NEAREST_MIPMAP_LINEAR,[li]:r.LINEAR,[Rm]:r.LINEAR_MIPMAP_NEAREST,[Ks]:r.LINEAR_MIPMAP_LINEAR},Y={[wF]:r.NEVER,[AF]:r.ALWAYS,[qM]:r.LESS,[XM]:r.LEQUAL,[SF]:r.EQUAL,[MF]:r.GEQUAL,[TF]:r.GREATER,[EF]:r.NOTEQUAL};function ee(I,k){if(k.type===Nr&&e.has("OES_texture_float_linear")===!1&&(k.magFilter===li||k.magFilter===Rm||k.magFilter===Dc||k.magFilter===Ks||k.minFilter===li||k.minFilter===Rm||k.minFilter===Dc||k.minFilter===Ks)&&console.warn("THREE.WebGLRenderer: Unable to use linear filtering with floating point textures. OES_texture_float_linear not supported on this device."),r.texParameteri(I,r.TEXTURE_WRAP_S,G[k.wrapS]),r.texParameteri(I,r.TEXTURE_WRAP_T,G[k.wrapT]),(I===r.TEXTURE_3D||I===r.TEXTURE_2D_ARRAY)&&r.texParameteri(I,r.TEXTURE_WRAP_R,G[k.wrapR]),r.texParameteri(I,r.TEXTURE_MAG_FILTER,H[k.magFilter]),r.texParameteri(I,r.TEXTURE_MIN_FILTER,H[k.minFilter]),k.compareFunction&&(r.texParameteri(I,r.TEXTURE_COMPARE_MODE,r.COMPARE_REF_TO_TEXTURE),r.texParameteri(I,r.TEXTURE_COMPARE_FUNC,Y[k.compareFunction])),e.has("EXT_texture_filter_anisotropic")===!0){if(k.magFilter===jn||k.minFilter!==Dc&&k.minFilter!==Ks||k.type===Nr&&e.has("OES_texture_float_linear")===!1)return;if(k.anisotropy>1||i.get(k).__currentAnisotropy){const ne=e.get("EXT_texture_filter_anisotropic");r.texParameterf(I,ne.TEXTURE_MAX_ANISOTROPY_EXT,Math.min(k.anisotropy,s.getMaxAnisotropy())),i.get(k).__currentAnisotropy=k.anisotropy}}}function he(I,k){let ne=!1;I.__webglInit===void 0&&(I.__webglInit=!0,k.addEventListener("dispose",S));const ae=k.source;let ce=d.get(ae);ce===void 0&&(ce={},d.set(ae,ce));const pe=C(k);if(pe!==I.__cacheKey){ce[pe]===void 0&&(ce[pe]={texture:r.createTexture(),usedTimes:0},a.memory.textures++,ne=!0),ce[pe].usedTimes++;const ze=ce[I.__cacheKey];ze!==void 0&&(ce[I.__cacheKey].usedTimes--,ze.usedTimes===0&&M(k)),I.__cacheKey=pe,I.__webglTexture=ce[pe].texture}return ne}function q(I,k,ne){let ae=r.TEXTURE_2D;(k.isDataArrayTexture||k.isCompressedArrayTexture)&&(ae=r.TEXTURE_2D_ARRAY),k.isData3DTexture&&(ae=r.TEXTURE_3D);const ce=he(I,k),pe=k.source;n.bindTexture(ae,I.__webglTexture,r.TEXTURE0+ne);const ze=i.get(pe);if(pe.version!==ze.__version||ce===!0){n.activeTexture(r.TEXTURE0+ne);const ke=Qt.getPrimaries(Qt.workingColorSpace),lt=k.colorSpace===Eo?null:Qt.getPrimaries(k.colorSpace),wt=k.colorSpace===Eo||ke===lt?r.NONE:r.BROWSER_DEFAULT_WEBGL;r.pixelStorei(r.UNPACK_FLIP_Y_WEBGL,k.flipY),r.pixelStorei(r.UNPACK_PREMULTIPLY_ALPHA_WEBGL,k.premultiplyAlpha),r.pixelStorei(r.UNPACK_ALIGNMENT,k.unpackAlignment),r.pixelStorei(r.UNPACK_COLORSPACE_CONVERSION_WEBGL,wt);let De=g(k.image,!1,s.maxTextureSize);De=on(k,De);const et=o.convert(k.format,k.colorSpace),St=o.convert(k.type);let At=b(k.internalFormat,et,St,k.colorSpace,k.isVideoTexture);ee(ae,k);let tt;const en=k.mipmaps,$t=k.isVideoTexture!==!0,fn=ze.__version===void 0||ce===!0,ue=pe.dataReady,Ye=_(k,De);if(k.isDepthTexture)At=w(k.format===Do,k.type),fn&&($t?n.texStorage2D(r.TEXTURE_2D,1,At,De.width,De.height):n.texImage2D(r.TEXTURE_2D,0,At,De.width,De.height,0,et,St,null));else if(k.isDataTexture)if(en.length>0){$t&&fn&&n.texStorage2D(r.TEXTURE_2D,Ye,At,en[0].width,en[0].height);for(let Se=0,Re=en.length;Se<Re;Se++)tt=en[Se],$t?ue&&n.texSubImage2D(r.TEXTURE_2D,Se,0,0,tt.width,tt.height,et,St,tt.data):n.texImage2D(r.TEXTURE_2D,Se,At,tt.width,tt.height,0,et,St,tt.data);k.generateMipmaps=!1}else $t?(fn&&n.texStorage2D(r.TEXTURE_2D,Ye,At,De.width,De.height),ue&&n.texSubImage2D(r.TEXTURE_2D,0,0,0,De.width,De.height,et,St,De.data)):n.texImage2D(r.TEXTURE_2D,0,At,De.width,De.height,0,et,St,De.data);else if(k.isCompressedTexture)if(k.isCompressedArrayTexture){$t&&fn&&n.texStorage3D(r.TEXTURE_2D_ARRAY,Ye,At,en[0].width,en[0].height,De.depth);for(let Se=0,Re=en.length;Se<Re;Se++)if(tt=en[Se],k.format!==Tr)if(et!==null)if($t){if(ue)if(k.layerUpdates.size>0){const Je=BV(tt.width,tt.height,k.format,k.type);for(const Ze of k.layerUpdates){const Gt=tt.data.subarray(Ze*Je/tt.data.BYTES_PER_ELEMENT,(Ze+1)*Je/tt.data.BYTES_PER_ELEMENT);n.compressedTexSubImage3D(r.TEXTURE_2D_ARRAY,Se,0,0,Ze,tt.width,tt.height,1,et,Gt)}k.clearLayerUpdates()}else n.compressedTexSubImage3D(r.TEXTURE_2D_ARRAY,Se,0,0,0,tt.width,tt.height,De.depth,et,tt.data)}else n.compressedTexImage3D(r.TEXTURE_2D_ARRAY,Se,At,tt.width,tt.height,De.depth,0,tt.data,0,0);else console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()");else $t?ue&&n.texSubImage3D(r.TEXTURE_2D_ARRAY,Se,0,0,0,tt.width,tt.height,De.depth,et,St,tt.data):n.texImage3D(r.TEXTURE_2D_ARRAY,Se,At,tt.width,tt.height,De.depth,0,et,St,tt.data)}else{$t&&fn&&n.texStorage2D(r.TEXTURE_2D,Ye,At,en[0].width,en[0].height);for(let Se=0,Re=en.length;Se<Re;Se++)tt=en[Se],k.format!==Tr?et!==null?$t?ue&&n.compressedTexSubImage2D(r.TEXTURE_2D,Se,0,0,tt.width,tt.height,et,tt.data):n.compressedTexImage2D(r.TEXTURE_2D,Se,At,tt.width,tt.height,0,tt.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):$t?ue&&n.texSubImage2D(r.TEXTURE_2D,Se,0,0,tt.width,tt.height,et,St,tt.data):n.texImage2D(r.TEXTURE_2D,Se,At,tt.width,tt.height,0,et,St,tt.data)}else if(k.isDataArrayTexture)if($t){if(fn&&n.texStorage3D(r.TEXTURE_2D_ARRAY,Ye,At,De.width,De.height,De.depth),ue)if(k.layerUpdates.size>0){const Se=BV(De.width,De.height,k.format,k.type);for(const Re of k.layerUpdates){const Je=De.data.subarray(Re*Se/De.data.BYTES_PER_ELEMENT,(Re+1)*Se/De.data.BYTES_PER_ELEMENT);n.texSubImage3D(r.TEXTURE_2D_ARRAY,0,0,0,Re,De.width,De.height,1,et,St,Je)}k.clearLayerUpdates()}else n.texSubImage3D(r.TEXTURE_2D_ARRAY,0,0,0,0,De.width,De.height,De.depth,et,St,De.data)}else n.texImage3D(r.TEXTURE_2D_ARRAY,0,At,De.width,De.height,De.depth,0,et,St,De.data);else if(k.isData3DTexture)$t?(fn&&n.texStorage3D(r.TEXTURE_3D,Ye,At,De.width,De.height,De.depth),ue&&n.texSubImage3D(r.TEXTURE_3D,0,0,0,0,De.width,De.height,De.depth,et,St,De.data)):n.texImage3D(r.TEXTURE_3D,0,At,De.width,De.height,De.depth,0,et,St,De.data);else if(k.isFramebufferTexture){if(fn)if($t)n.texStorage2D(r.TEXTURE_2D,Ye,At,De.width,De.height);else{let Se=De.width,Re=De.height;for(let Je=0;Je<Ye;Je++)n.texImage2D(r.TEXTURE_2D,Je,At,Se,Re,0,et,St,null),Se>>=1,Re>>=1}}else if(en.length>0){if($t&&fn){const Se=X(en[0]);n.texStorage2D(r.TEXTURE_2D,Ye,At,Se.width,Se.height)}for(let Se=0,Re=en.length;Se<Re;Se++)tt=en[Se],$t?ue&&n.texSubImage2D(r.TEXTURE_2D,Se,0,0,et,St,tt):n.texImage2D(r.TEXTURE_2D,Se,At,et,St,tt);k.generateMipmaps=!1}else if($t){if(fn){const Se=X(De);n.texStorage2D(r.TEXTURE_2D,Ye,At,Se.width,Se.height)}ue&&n.texSubImage2D(r.TEXTURE_2D,0,0,0,et,St,De)}else n.texImage2D(r.TEXTURE_2D,0,At,et,St,De);v(k)&&y(ae),ze.__version=pe.version,k.onUpdate&&k.onUpdate(k)}I.__version=k.version}function J(I,k,ne){if(k.image.length!==6)return;const ae=he(I,k),ce=k.source;n.bindTexture(r.TEXTURE_CUBE_MAP,I.__webglTexture,r.TEXTURE0+ne);const pe=i.get(ce);if(ce.version!==pe.__version||ae===!0){n.activeTexture(r.TEXTURE0+ne);const ze=Qt.getPrimaries(Qt.workingColorSpace),ke=k.colorSpace===Eo?null:Qt.getPrimaries(k.colorSpace),lt=k.colorSpace===Eo||ze===ke?r.NONE:r.BROWSER_DEFAULT_WEBGL;r.pixelStorei(r.UNPACK_FLIP_Y_WEBGL,k.flipY),r.pixelStorei(r.UNPACK_PREMULTIPLY_ALPHA_WEBGL,k.premultiplyAlpha),r.pixelStorei(r.UNPACK_ALIGNMENT,k.unpackAlignment),r.pixelStorei(r.UNPACK_COLORSPACE_CONVERSION_WEBGL,lt);const wt=k.isCompressedTexture||k.image[0].isCompressedTexture,De=k.image[0]&&k.image[0].isDataTexture,et=[];for(let Re=0;Re<6;Re++)!wt&&!De?et[Re]=g(k.image[Re],!0,s.maxCubemapSize):et[Re]=De?k.image[Re].image:k.image[Re],et[Re]=on(k,et[Re]);const St=et[0],At=o.convert(k.format,k.colorSpace),tt=o.convert(k.type),en=b(k.internalFormat,At,tt,k.colorSpace),$t=k.isVideoTexture!==!0,fn=pe.__version===void 0||ae===!0,ue=ce.dataReady;let Ye=_(k,St);ee(r.TEXTURE_CUBE_MAP,k);let Se;if(wt){$t&&fn&&n.texStorage2D(r.TEXTURE_CUBE_MAP,Ye,en,St.width,St.height);for(let Re=0;Re<6;Re++){Se=et[Re].mipmaps;for(let Je=0;Je<Se.length;Je++){const Ze=Se[Je];k.format!==Tr?At!==null?$t?ue&&n.compressedTexSubImage2D(r.TEXTURE_CUBE_MAP_POSITIVE_X+Re,Je,0,0,Ze.width,Ze.height,At,Ze.data):n.compressedTexImage2D(r.TEXTURE_CUBE_MAP_POSITIVE_X+Re,Je,en,Ze.width,Ze.height,0,Ze.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .setTextureCube()"):$t?ue&&n.texSubImage2D(r.TEXTURE_CUBE_MAP_POSITIVE_X+Re,Je,0,0,Ze.width,Ze.height,At,tt,Ze.data):n.texImage2D(r.TEXTURE_CUBE_MAP_POSITIVE_X+Re,Je,en,Ze.width,Ze.height,0,At,tt,Ze.data)}}}else{if(Se=k.mipmaps,$t&&fn){Se.length>0&&Ye++;const Re=X(et[0]);n.texStorage2D(r.TEXTURE_CUBE_MAP,Ye,en,Re.width,Re.height)}for(let Re=0;Re<6;Re++)if(De){$t?ue&&n.texSubImage2D(r.TEXTURE_CUBE_MAP_POSITIVE_X+Re,0,0,0,et[Re].width,et[Re].height,At,tt,et[Re].data):n.texImage2D(r.TEXTURE_CUBE_MAP_POSITIVE_X+Re,0,en,et[Re].width,et[Re].height,0,At,tt,et[Re].data);for(let Je=0;Je<Se.length;Je++){const Gt=Se[Je].image[Re].image;$t?ue&&n.texSubImage2D(r.TEXTURE_CUBE_MAP_POSITIVE_X+Re,Je+1,0,0,Gt.width,Gt.height,At,tt,Gt.data):n.texImage2D(r.TEXTURE_CUBE_MAP_POSITIVE_X+Re,Je+1,en,Gt.width,Gt.height,0,At,tt,Gt.data)}}else{$t?ue&&n.texSubImage2D(r.TEXTURE_CUBE_MAP_POSITIVE_X+Re,0,0,0,At,tt,et[Re]):n.texImage2D(r.TEXTURE_CUBE_MAP_POSITIVE_X+Re,0,en,At,tt,et[Re]);for(let Je=0;Je<Se.length;Je++){const Ze=Se[Je];$t?ue&&n.texSubImage2D(r.TEXTURE_CUBE_MAP_POSITIVE_X+Re,Je+1,0,0,At,tt,Ze.image[Re]):n.texImage2D(r.TEXTURE_CUBE_MAP_POSITIVE_X+Re,Je+1,en,At,tt,Ze.image[Re])}}}v(k)&&y(r.TEXTURE_CUBE_MAP),pe.__version=ce.version,k.onUpdate&&k.onUpdate(k)}I.__version=k.version}function se(I,k,ne,ae,ce,pe){const ze=o.convert(ne.format,ne.colorSpace),ke=o.convert(ne.type),lt=b(ne.internalFormat,ze,ke,ne.colorSpace),wt=i.get(k),De=i.get(ne);if(De.__renderTarget=k,!wt.__hasExternalTextures){const et=Math.max(1,k.width>>pe),St=Math.max(1,k.height>>pe);ce===r.TEXTURE_3D||ce===r.TEXTURE_2D_ARRAY?n.texImage3D(ce,pe,lt,et,St,k.depth,0,ze,ke,null):n.texImage2D(ce,pe,lt,et,St,0,ze,ke,null)}n.bindFramebuffer(r.FRAMEBUFFER,I),gt(k)?l.framebufferTexture2DMultisampleEXT(r.FRAMEBUFFER,ae,ce,De.__webglTexture,0,ct(k)):(ce===r.TEXTURE_2D||ce>=r.TEXTURE_CUBE_MAP_POSITIVE_X&&ce<=r.TEXTURE_CUBE_MAP_NEGATIVE_Z)&&r.framebufferTexture2D(r.FRAMEBUFFER,ae,ce,De.__webglTexture,pe),n.bindFramebuffer(r.FRAMEBUFFER,null)}function oe(I,k,ne){if(r.bindRenderbuffer(r.RENDERBUFFER,I),k.depthBuffer){const ae=k.depthTexture,ce=ae&&ae.isDepthTexture?ae.type:null,pe=w(k.stencilBuffer,ce),ze=k.stencilBuffer?r.DEPTH_STENCIL_ATTACHMENT:r.DEPTH_ATTACHMENT,ke=ct(k);gt(k)?l.renderbufferStorageMultisampleEXT(r.RENDERBUFFER,ke,pe,k.width,k.height):ne?r.renderbufferStorageMultisample(r.RENDERBUFFER,ke,pe,k.width,k.height):r.renderbufferStorage(r.RENDERBUFFER,pe,k.width,k.height),r.framebufferRenderbuffer(r.FRAMEBUFFER,ze,r.RENDERBUFFER,I)}else{const ae=k.textures;for(let ce=0;ce<ae.length;ce++){const pe=ae[ce],ze=o.convert(pe.format,pe.colorSpace),ke=o.convert(pe.type),lt=b(pe.internalFormat,ze,ke,pe.colorSpace),wt=ct(k);ne&&gt(k)===!1?r.renderbufferStorageMultisample(r.RENDERBUFFER,wt,lt,k.width,k.height):gt(k)?l.renderbufferStorageMultisampleEXT(r.RENDERBUFFER,wt,lt,k.width,k.height):r.renderbufferStorage(r.RENDERBUFFER,lt,k.width,k.height)}}r.bindRenderbuffer(r.RENDERBUFFER,null)}function Ee(I,k){if(k&&k.isWebGLCubeRenderTarget)throw new Error("Depth Texture with cube render targets is not supported");if(n.bindFramebuffer(r.FRAMEBUFFER,I),!(k.depthTexture&&k.depthTexture.isDepthTexture))throw new Error("renderTarget.depthTexture must be an instance of THREE.DepthTexture");const ae=i.get(k.depthTexture);ae.__renderTarget=k,(!ae.__webglTexture||k.depthTexture.image.width!==k.width||k.depthTexture.image.height!==k.height)&&(k.depthTexture.image.width=k.width,k.depthTexture.image.height=k.height,k.depthTexture.needsUpdate=!0),O(k.depthTexture,0);const ce=ae.__webglTexture,pe=ct(k);if(k.depthTexture.format===Oo)gt(k)?l.framebufferTexture2DMultisampleEXT(r.FRAMEBUFFER,r.DEPTH_ATTACHMENT,r.TEXTURE_2D,ce,0,pe):r.framebufferTexture2D(r.FRAMEBUFFER,r.DEPTH_ATTACHMENT,r.TEXTURE_2D,ce,0);else if(k.depthTexture.format===Do)gt(k)?l.framebufferTexture2DMultisampleEXT(r.FRAMEBUFFER,r.DEPTH_STENCIL_ATTACHMENT,r.TEXTURE_2D,ce,0,pe):r.framebufferTexture2D(r.FRAMEBUFFER,r.DEPTH_STENCIL_ATTACHMENT,r.TEXTURE_2D,ce,0);else throw new Error("Unknown depthTexture format")}function ye(I){const k=i.get(I),ne=I.isWebGLCubeRenderTarget===!0;if(k.__boundDepthTexture!==I.depthTexture){const ae=I.depthTexture;if(k.__depthDisposeCallback&&k.__depthDisposeCallback(),ae){const ce=()=>{delete k.__boundDepthTexture,delete k.__depthDisposeCallback,ae.removeEventListener("dispose",ce)};ae.addEventListener("dispose",ce),k.__depthDisposeCallback=ce}k.__boundDepthTexture=ae}if(I.depthTexture&&!k.__autoAllocateDepthBuffer){if(ne)throw new Error("target.depthTexture not supported in Cube render targets");const ae=I.texture.mipmaps;ae&&ae.length>0?Ee(k.__webglFramebuffer[0],I):Ee(k.__webglFramebuffer,I)}else if(ne){k.__webglDepthbuffer=[];for(let ae=0;ae<6;ae++)if(n.bindFramebuffer(r.FRAMEBUFFER,k.__webglFramebuffer[ae]),k.__webglDepthbuffer[ae]===void 0)k.__webglDepthbuffer[ae]=r.createRenderbuffer(),oe(k.__webglDepthbuffer[ae],I,!1);else{const ce=I.stencilBuffer?r.DEPTH_STENCIL_ATTACHMENT:r.DEPTH_ATTACHMENT,pe=k.__webglDepthbuffer[ae];r.bindRenderbuffer(r.RENDERBUFFER,pe),r.framebufferRenderbuffer(r.FRAMEBUFFER,ce,r.RENDERBUFFER,pe)}}else{const ae=I.texture.mipmaps;if(ae&&ae.length>0?n.bindFramebuffer(r.FRAMEBUFFER,k.__webglFramebuffer[0]):n.bindFramebuffer(r.FRAMEBUFFER,k.__webglFramebuffer),k.__webglDepthbuffer===void 0)k.__webglDepthbuffer=r.createRenderbuffer(),oe(k.__webglDepthbuffer,I,!1);else{const ce=I.stencilBuffer?r.DEPTH_STENCIL_ATTACHMENT:r.DEPTH_ATTACHMENT,pe=k.__webglDepthbuffer;r.bindRenderbuffer(r.RENDERBUFFER,pe),r.framebufferRenderbuffer(r.FRAMEBUFFER,ce,r.RENDERBUFFER,pe)}}n.bindFramebuffer(r.FRAMEBUFFER,null)}function Ce(I,k,ne){const ae=i.get(I);k!==void 0&&se(ae.__webglFramebuffer,I,I.texture,r.COLOR_ATTACHMENT0,r.TEXTURE_2D,0),ne!==void 0&&ye(I)}function Ge(I){const k=I.texture,ne=i.get(I),ae=i.get(k);I.addEventListener("dispose",T);const ce=I.textures,pe=I.isWebGLCubeRenderTarget===!0,ze=ce.length>1;if(ze||(ae.__webglTexture===void 0&&(ae.__webglTexture=r.createTexture()),ae.__version=k.version,a.memory.textures++),pe){ne.__webglFramebuffer=[];for(let ke=0;ke<6;ke++)if(k.mipmaps&&k.mipmaps.length>0){ne.__webglFramebuffer[ke]=[];for(let lt=0;lt<k.mipmaps.length;lt++)ne.__webglFramebuffer[ke][lt]=r.createFramebuffer()}else ne.__webglFramebuffer[ke]=r.createFramebuffer()}else{if(k.mipmaps&&k.mipmaps.length>0){ne.__webglFramebuffer=[];for(let ke=0;ke<k.mipmaps.length;ke++)ne.__webglFramebuffer[ke]=r.createFramebuffer()}else ne.__webglFramebuffer=r.createFramebuffer();if(ze)for(let ke=0,lt=ce.length;ke<lt;ke++){const wt=i.get(ce[ke]);wt.__webglTexture===void 0&&(wt.__webglTexture=r.createTexture(),a.memory.textures++)}if(I.samples>0&&gt(I)===!1){ne.__webglMultisampledFramebuffer=r.createFramebuffer(),ne.__webglColorRenderbuffer=[],n.bindFramebuffer(r.FRAMEBUFFER,ne.__webglMultisampledFramebuffer);for(let ke=0;ke<ce.length;ke++){const lt=ce[ke];ne.__webglColorRenderbuffer[ke]=r.createRenderbuffer(),r.bindRenderbuffer(r.RENDERBUFFER,ne.__webglColorRenderbuffer[ke]);const wt=o.convert(lt.format,lt.colorSpace),De=o.convert(lt.type),et=b(lt.internalFormat,wt,De,lt.colorSpace,I.isXRRenderTarget===!0),St=ct(I);r.renderbufferStorageMultisample(r.RENDERBUFFER,St,et,I.width,I.height),r.framebufferRenderbuffer(r.FRAMEBUFFER,r.COLOR_ATTACHMENT0+ke,r.RENDERBUFFER,ne.__webglColorRenderbuffer[ke])}r.bindRenderbuffer(r.RENDERBUFFER,null),I.depthBuffer&&(ne.__webglDepthRenderbuffer=r.createRenderbuffer(),oe(ne.__webglDepthRenderbuffer,I,!0)),n.bindFramebuffer(r.FRAMEBUFFER,null)}}if(pe){n.bindTexture(r.TEXTURE_CUBE_MAP,ae.__webglTexture),ee(r.TEXTURE_CUBE_MAP,k);for(let ke=0;ke<6;ke++)if(k.mipmaps&&k.mipmaps.length>0)for(let lt=0;lt<k.mipmaps.length;lt++)se(ne.__webglFramebuffer[ke][lt],I,k,r.COLOR_ATTACHMENT0,r.TEXTURE_CUBE_MAP_POSITIVE_X+ke,lt);else se(ne.__webglFramebuffer[ke],I,k,r.COLOR_ATTACHMENT0,r.TEXTURE_CUBE_MAP_POSITIVE_X+ke,0);v(k)&&y(r.TEXTURE_CUBE_MAP),n.unbindTexture()}else if(ze){for(let ke=0,lt=ce.length;ke<lt;ke++){const wt=ce[ke],De=i.get(wt);n.bindTexture(r.TEXTURE_2D,De.__webglTexture),ee(r.TEXTURE_2D,wt),se(ne.__webglFramebuffer,I,wt,r.COLOR_ATTACHMENT0+ke,r.TEXTURE_2D,0),v(wt)&&y(r.TEXTURE_2D)}n.unbindTexture()}else{let ke=r.TEXTURE_2D;if((I.isWebGL3DRenderTarget||I.isWebGLArrayRenderTarget)&&(ke=I.isWebGL3DRenderTarget?r.TEXTURE_3D:r.TEXTURE_2D_ARRAY),n.bindTexture(ke,ae.__webglTexture),ee(ke,k),k.mipmaps&&k.mipmaps.length>0)for(let lt=0;lt<k.mipmaps.length;lt++)se(ne.__webglFramebuffer[lt],I,k,r.COLOR_ATTACHMENT0,ke,lt);else se(ne.__webglFramebuffer,I,k,r.COLOR_ATTACHMENT0,ke,0);v(k)&&y(ke),n.unbindTexture()}I.depthBuffer&&ye(I)}function _e(I){const k=I.textures;for(let ne=0,ae=k.length;ne<ae;ne++){const ce=k[ne];if(v(ce)){const pe=x(I),ze=i.get(ce).__webglTexture;n.bindTexture(pe,ze),y(pe),n.unbindTexture()}}}const Ke=[],Q=[];function kt(I){if(I.samples>0){if(gt(I)===!1){const k=I.textures,ne=I.width,ae=I.height;let ce=r.COLOR_BUFFER_BIT;const pe=I.stencilBuffer?r.DEPTH_STENCIL_ATTACHMENT:r.DEPTH_ATTACHMENT,ze=i.get(I),ke=k.length>1;if(ke)for(let wt=0;wt<k.length;wt++)n.bindFramebuffer(r.FRAMEBUFFER,ze.__webglMultisampledFramebuffer),r.framebufferRenderbuffer(r.FRAMEBUFFER,r.COLOR_ATTACHMENT0+wt,r.RENDERBUFFER,null),n.bindFramebuffer(r.FRAMEBUFFER,ze.__webglFramebuffer),r.framebufferTexture2D(r.DRAW_FRAMEBUFFER,r.COLOR_ATTACHMENT0+wt,r.TEXTURE_2D,null,0);n.bindFramebuffer(r.READ_FRAMEBUFFER,ze.__webglMultisampledFramebuffer);const lt=I.texture.mipmaps;lt&&lt.length>0?n.bindFramebuffer(r.DRAW_FRAMEBUFFER,ze.__webglFramebuffer[0]):n.bindFramebuffer(r.DRAW_FRAMEBUFFER,ze.__webglFramebuffer);for(let wt=0;wt<k.length;wt++){if(I.resolveDepthBuffer&&(I.depthBuffer&&(ce|=r.DEPTH_BUFFER_BIT),I.stencilBuffer&&I.resolveStencilBuffer&&(ce|=r.STENCIL_BUFFER_BIT)),ke){r.framebufferRenderbuffer(r.READ_FRAMEBUFFER,r.COLOR_ATTACHMENT0,r.RENDERBUFFER,ze.__webglColorRenderbuffer[wt]);const De=i.get(k[wt]).__webglTexture;r.framebufferTexture2D(r.DRAW_FRAMEBUFFER,r.COLOR_ATTACHMENT0,r.TEXTURE_2D,De,0)}r.blitFramebuffer(0,0,ne,ae,0,0,ne,ae,ce,r.NEAREST),c===!0&&(Ke.length=0,Q.length=0,Ke.push(r.COLOR_ATTACHMENT0+wt),I.depthBuffer&&I.resolveDepthBuffer===!1&&(Ke.push(pe),Q.push(pe),r.invalidateFramebuffer(r.DRAW_FRAMEBUFFER,Q)),r.invalidateFramebuffer(r.READ_FRAMEBUFFER,Ke))}if(n.bindFramebuffer(r.READ_FRAMEBUFFER,null),n.bindFramebuffer(r.DRAW_FRAMEBUFFER,null),ke)for(let wt=0;wt<k.length;wt++){n.bindFramebuffer(r.FRAMEBUFFER,ze.__webglMultisampledFramebuffer),r.framebufferRenderbuffer(r.FRAMEBUFFER,r.COLOR_ATTACHMENT0+wt,r.RENDERBUFFER,ze.__webglColorRenderbuffer[wt]);const De=i.get(k[wt]).__webglTexture;n.bindFramebuffer(r.FRAMEBUFFER,ze.__webglFramebuffer),r.framebufferTexture2D(r.DRAW_FRAMEBUFFER,r.COLOR_ATTACHMENT0+wt,r.TEXTURE_2D,De,0)}n.bindFramebuffer(r.DRAW_FRAMEBUFFER,ze.__webglMultisampledFramebuffer)}else if(I.depthBuffer&&I.resolveDepthBuffer===!1&&c){const k=I.stencilBuffer?r.DEPTH_STENCIL_ATTACHMENT:r.DEPTH_ATTACHMENT;r.invalidateFramebuffer(r.DRAW_FRAMEBUFFER,[k])}}}function ct(I){return Math.min(s.maxSamples,I.samples)}function gt(I){const k=i.get(I);return I.samples>0&&e.has("WEBGL_multisampled_render_to_texture")===!0&&k.__useRenderToTexture!==!1}function ot(I){const k=a.render.frame;h.get(I)!==k&&(h.set(I,k),I.update())}function on(I,k){const ne=I.colorSpace,ae=I.format,ce=I.type;return I.isCompressedTexture===!0||I.isVideoTexture===!0||ne!==Ol&&ne!==Eo&&(Qt.getTransfer(ne)===wn?(ae!==Tr||ce!==gr)&&console.warn("THREE.WebGLTextures: sRGB encoded textures have to use RGBAFormat and UnsignedByteType."):console.error("THREE.WebGLTextures: Unsupported texture color space:",ne)),k}function X(I){return typeof HTMLImageElement<"u"&&I instanceof HTMLImageElement?(u.width=I.naturalWidth||I.width,u.height=I.naturalHeight||I.height):typeof VideoFrame<"u"&&I instanceof VideoFrame?(u.width=I.displayWidth,u.height=I.displayHeight):(u.width=I.width,u.height=I.height),u}this.allocateTextureUnit=B,this.resetTextureUnits=D,this.setTexture2D=O,this.setTexture2DArray=R,this.setTexture3D=z,this.setTextureCube=U,this.rebindTextures=Ce,this.setupRenderTarget=Ge,this.updateRenderTargetMipmap=_e,this.updateMultisampleRenderTarget=kt,this.setupDepthRenderbuffer=ye,this.setupFrameBufferTexture=se,this.useMultisampledRTT=gt}function lSe(r,e){function n(i,s=Eo){let o;const a=Qt.getTransfer(s);if(i===gr)return r.UNSIGNED_BYTE;if(i===GM)return r.UNSIGNED_SHORT_4_4_4_4;if(i===HM)return r.UNSIGNED_SHORT_5_5_5_1;if(i===WM)return r.UNSIGNED_INT_5_9_9_9_REV;if(i===Jf)return r.BYTE;if(i===ed)return r.SHORT;if(i===qa)return r.UNSIGNED_SHORT;if(i===Si)return r.INT;if(i===In)return r.UNSIGNED_INT;if(i===Nr)return r.FLOAT;if(i===Ei)return r.HALF_FLOAT;if(i===bF)return r.ALPHA;if(i===u_)return r.RGB;if(i===Tr)return r.RGBA;if(i===Oo)return r.DEPTH_COMPONENT;if(i===Do)return r.DEPTH_STENCIL;if(i===h_)return r.RED;if(i===gy)return r.RED_INTEGER;if(i===kc)return r.RG;if(i===yy)return r.RG_INTEGER;if(i===vy)return r.RGBA_INTEGER;if(i===td||i===yh||i===vh||i===xh)if(a===wn)if(o=e.get("WEBGL_compressed_texture_s3tc_srgb"),o!==null){if(i===td)return o.COMPRESSED_SRGB_S3TC_DXT1_EXT;if(i===yh)return o.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT;if(i===vh)return o.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT;if(i===xh)return o.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT}else return null;else if(o=e.get("WEBGL_compressed_texture_s3tc"),o!==null){if(i===td)return o.COMPRESSED_RGB_S3TC_DXT1_EXT;if(i===yh)return o.COMPRESSED_RGBA_S3TC_DXT1_EXT;if(i===vh)return o.COMPRESSED_RGBA_S3TC_DXT3_EXT;if(i===xh)return o.COMPRESSED_RGBA_S3TC_DXT5_EXT}else return null;if(i===zx||i===$x||i===jx||i===Vx)if(o=e.get("WEBGL_compressed_texture_pvrtc"),o!==null){if(i===zx)return o.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;if(i===$x)return o.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;if(i===jx)return o.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;if(i===Vx)return o.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG}else return null;if(i===Gx||i===ng||i===rg)if(o=e.get("WEBGL_compressed_texture_etc"),o!==null){if(i===Gx||i===ng)return a===wn?o.COMPRESSED_SRGB8_ETC2:o.COMPRESSED_RGB8_ETC2;if(i===rg)return a===wn?o.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC:o.COMPRESSED_RGBA8_ETC2_EAC}else return null;if(i===ig||i===sg||i===og||i===ag||i===lg||i===cg||i===ug||i===hg||i===fg||i===dg||i===pg||i===mg||i===gg||i===yg)if(o=e.get("WEBGL_compressed_texture_astc"),o!==null){if(i===ig)return a===wn?o.COMPRESSED_SRGB8_ALPHA8_ASTC_4x4_KHR:o.COMPRESSED_RGBA_ASTC_4x4_KHR;if(i===sg)return a===wn?o.COMPRESSED_SRGB8_ALPHA8_ASTC_5x4_KHR:o.COMPRESSED_RGBA_ASTC_5x4_KHR;if(i===og)return a===wn?o.COMPRESSED_SRGB8_ALPHA8_ASTC_5x5_KHR:o.COMPRESSED_RGBA_ASTC_5x5_KHR;if(i===ag)return a===wn?o.COMPRESSED_SRGB8_ALPHA8_ASTC_6x5_KHR:o.COMPRESSED_RGBA_ASTC_6x5_KHR;if(i===lg)return a===wn?o.COMPRESSED_SRGB8_ALPHA8_ASTC_6x6_KHR:o.COMPRESSED_RGBA_ASTC_6x6_KHR;if(i===cg)return a===wn?o.COMPRESSED_SRGB8_ALPHA8_ASTC_8x5_KHR:o.COMPRESSED_RGBA_ASTC_8x5_KHR;if(i===ug)return a===wn?o.COMPRESSED_SRGB8_ALPHA8_ASTC_8x6_KHR:o.COMPRESSED_RGBA_ASTC_8x6_KHR;if(i===hg)return a===wn?o.COMPRESSED_SRGB8_ALPHA8_ASTC_8x8_KHR:o.COMPRESSED_RGBA_ASTC_8x8_KHR;if(i===fg)return a===wn?o.COMPRESSED_SRGB8_ALPHA8_ASTC_10x5_KHR:o.COMPRESSED_RGBA_ASTC_10x5_KHR;if(i===dg)return a===wn?o.COMPRESSED_SRGB8_ALPHA8_ASTC_10x6_KHR:o.COMPRESSED_RGBA_ASTC_10x6_KHR;if(i===pg)return a===wn?o.COMPRESSED_SRGB8_ALPHA8_ASTC_10x8_KHR:o.COMPRESSED_RGBA_ASTC_10x8_KHR;if(i===mg)return a===wn?o.COMPRESSED_SRGB8_ALPHA8_ASTC_10x10_KHR:o.COMPRESSED_RGBA_ASTC_10x10_KHR;if(i===gg)return a===wn?o.COMPRESSED_SRGB8_ALPHA8_ASTC_12x10_KHR:o.COMPRESSED_RGBA_ASTC_12x10_KHR;if(i===yg)return a===wn?o.COMPRESSED_SRGB8_ALPHA8_ASTC_12x12_KHR:o.COMPRESSED_RGBA_ASTC_12x12_KHR}else return null;if(i===nd||i===VO||i===GO)if(o=e.get("EXT_texture_compression_bptc"),o!==null){if(i===nd)return a===wn?o.COMPRESSED_SRGB_ALPHA_BPTC_UNORM_EXT:o.COMPRESSED_RGBA_BPTC_UNORM_EXT;if(i===VO)return o.COMPRESSED_RGB_BPTC_SIGNED_FLOAT_EXT;if(i===GO)return o.COMPRESSED_RGB_BPTC_UNSIGNED_FLOAT_EXT}else return null;if(i===_F||i===Hx||i===Wx||i===qx)if(o=e.get("EXT_texture_compression_rgtc"),o!==null){if(i===nd)return o.COMPRESSED_RED_RGTC1_EXT;if(i===Hx)return o.COMPRESSED_SIGNED_RED_RGTC1_EXT;if(i===Wx)return o.COMPRESSED_RED_GREEN_RGTC2_EXT;if(i===qx)return o.COMPRESSED_SIGNED_RED_GREEN_RGTC2_EXT}else return null;return i===No?r.UNSIGNED_INT_24_8:r[i]!==void 0?r[i]:null}return{convert:n}}const cSe=`
void main() {

	gl_Position = vec4( position, 1.0 );

}`,uSe=`
uniform sampler2DArray depthColor;
uniform float depthWidth;
uniform float depthHeight;

void main() {

	vec2 coord = vec2( gl_FragCoord.x / depthWidth, gl_FragCoord.y / depthHeight );

	if ( coord.x >= 1.0 ) {

		gl_FragDepth = texture( depthColor, vec3( coord.x - 1.0, coord.y, 1 ) ).r;

	} else {

		gl_FragDepth = texture( depthColor, vec3( coord.x, coord.y, 0 ) ).r;

	}

}`;class hSe{constructor(){this.texture=null,this.mesh=null,this.depthNear=0,this.depthFar=0}init(e,n,i){if(this.texture===null){const s=new ui,o=e.properties.get(s);o.__webglTexture=n.texture,(n.depthNear!==i.depthNear||n.depthFar!==i.depthFar)&&(this.depthNear=n.depthNear,this.depthFar=n.depthFar),this.texture=s}}getMesh(e){if(this.texture!==null&&this.mesh===null){const n=e.cameras[0].viewport,i=new Bl({vertexShader:cSe,fragmentShader:uSe,uniforms:{depthColor:{value:this.texture},depthWidth:{value:n.z},depthHeight:{value:n.w}}});this.mesh=new Jn(new g_(20,20),i)}return this.mesh}reset(){this.texture=null,this.mesh=null}getDepthTexture(){return this.texture}}class fSe extends gu{constructor(e,n){super();const i=this;let s=null,o=1,a=null,l="local-floor",c=1,u=null,h=null,f=null,d=null,p=null,m=null;const g=new hSe,v=n.getContextAttributes();let y=null,x=null;const b=[],w=[],_=new Fe;let S=null;const T=new Ti;T.viewport=new Nt;const E=new Ti;E.viewport=new Nt;const M=[T,E],A=new UY;let P=null,D=null;this.cameraAutoUpdate=!0,this.enabled=!1,this.isPresenting=!1,this.getController=function(q){let J=b[q];return J===void 0&&(J=new R1,b[q]=J),J.getTargetRaySpace()},this.getControllerGrip=function(q){let J=b[q];return J===void 0&&(J=new R1,b[q]=J),J.getGripSpace()},this.getHand=function(q){let J=b[q];return J===void 0&&(J=new R1,b[q]=J),J.getHandSpace()};function B(q){const J=w.indexOf(q.inputSource);if(J===-1)return;const se=b[J];se!==void 0&&(se.update(q.inputSource,q.frame,u||a),se.dispatchEvent({type:q.type,data:q.inputSource}))}function C(){s.removeEventListener("select",B),s.removeEventListener("selectstart",B),s.removeEventListener("selectend",B),s.removeEventListener("squeeze",B),s.removeEventListener("squeezestart",B),s.removeEventListener("squeezeend",B),s.removeEventListener("end",C),s.removeEventListener("inputsourceschange",O);for(let q=0;q<b.length;q++){const J=w[q];J!==null&&(w[q]=null,b[q].disconnect(J))}P=null,D=null,g.reset(),e.setRenderTarget(y),p=null,d=null,f=null,s=null,x=null,he.stop(),i.isPresenting=!1,e.setPixelRatio(S),e.setSize(_.width,_.height,!1),i.dispatchEvent({type:"sessionend"})}this.setFramebufferScaleFactor=function(q){o=q,i.isPresenting===!0&&console.warn("THREE.WebXRManager: Cannot change framebuffer scale while presenting.")},this.setReferenceSpaceType=function(q){l=q,i.isPresenting===!0&&console.warn("THREE.WebXRManager: Cannot change reference space type while presenting.")},this.getReferenceSpace=function(){return u||a},this.setReferenceSpace=function(q){u=q},this.getBaseLayer=function(){return d!==null?d:p},this.getBinding=function(){return f},this.getFrame=function(){return m},this.getSession=function(){return s},this.setSession=async function(q){if(s=q,s!==null){if(y=e.getRenderTarget(),s.addEventListener("select",B),s.addEventListener("selectstart",B),s.addEventListener("selectend",B),s.addEventListener("squeeze",B),s.addEventListener("squeezestart",B),s.addEventListener("squeezeend",B),s.addEventListener("end",C),s.addEventListener("inputsourceschange",O),v.xrCompatible!==!0&&await n.makeXRCompatible(),S=e.getPixelRatio(),e.getSize(_),typeof XRWebGLBinding<"u"&&"createProjectionLayer"in XRWebGLBinding.prototype){let se=null,oe=null,Ee=null;v.depth&&(Ee=v.stencil?n.DEPTH24_STENCIL8:n.DEPTH_COMPONENT24,se=v.stencil?Do:Oo,oe=v.stencil?No:In);const ye={colorFormat:n.RGBA8,depthFormat:Ee,scaleFactor:o};f=new XRWebGLBinding(s,n),d=f.createProjectionLayer(ye),s.updateRenderState({layers:[d]}),e.setPixelRatio(1),e.setSize(d.textureWidth,d.textureHeight,!1),x=new Rh(d.textureWidth,d.textureHeight,{format:Tr,type:gr,depthTexture:new ko(d.textureWidth,d.textureHeight,oe,void 0,void 0,void 0,void 0,void 0,void 0,se),stencilBuffer:v.stencil,colorSpace:e.outputColorSpace,samples:v.antialias?4:0,resolveDepthBuffer:d.ignoreDepthValues===!1,resolveStencilBuffer:d.ignoreDepthValues===!1})}else{const se={antialias:v.antialias,alpha:!0,depth:v.depth,stencil:v.stencil,framebufferScaleFactor:o};p=new XRWebGLLayer(s,n,se),s.updateRenderState({baseLayer:p}),e.setPixelRatio(1),e.setSize(p.framebufferWidth,p.framebufferHeight,!1),x=new Rh(p.framebufferWidth,p.framebufferHeight,{format:Tr,type:gr,colorSpace:e.outputColorSpace,stencilBuffer:v.stencil,resolveDepthBuffer:p.ignoreDepthValues===!1,resolveStencilBuffer:p.ignoreDepthValues===!1})}x.isXRRenderTarget=!0,this.setFoveation(c),u=null,a=await s.requestReferenceSpace(l),he.setContext(s),he.start(),i.isPresenting=!0,i.dispatchEvent({type:"sessionstart"})}},this.getEnvironmentBlendMode=function(){if(s!==null)return s.environmentBlendMode},this.getDepthTexture=function(){return g.getDepthTexture()};function O(q){for(let J=0;J<q.removed.length;J++){const se=q.removed[J],oe=w.indexOf(se);oe>=0&&(w[oe]=null,b[oe].disconnect(se))}for(let J=0;J<q.added.length;J++){const se=q.added[J];let oe=w.indexOf(se);if(oe===-1){for(let ye=0;ye<b.length;ye++)if(ye>=w.length){w.push(se),oe=ye;break}else if(w[ye]===null){w[ye]=se,oe=ye;break}if(oe===-1)break}const Ee=b[oe];Ee&&Ee.connect(se)}}const R=new K,z=new K;function U(q,J,se){R.setFromMatrixPosition(J.matrixWorld),z.setFromMatrixPosition(se.matrixWorld);const oe=R.distanceTo(z),Ee=J.projectionMatrix.elements,ye=se.projectionMatrix.elements,Ce=Ee[14]/(Ee[10]-1),Ge=Ee[14]/(Ee[10]+1),_e=(Ee[9]+1)/Ee[5],Ke=(Ee[9]-1)/Ee[5],Q=(Ee[8]-1)/Ee[0],kt=(ye[8]+1)/ye[0],ct=Ce*Q,gt=Ce*kt,ot=oe/(-Q+kt),on=ot*-Q;if(J.matrixWorld.decompose(q.position,q.quaternion,q.scale),q.translateX(on),q.translateZ(ot),q.matrixWorld.compose(q.position,q.quaternion,q.scale),q.matrixWorldInverse.copy(q.matrixWorld).invert(),Ee[10]===-1)q.projectionMatrix.copy(J.projectionMatrix),q.projectionMatrixInverse.copy(J.projectionMatrixInverse);else{const X=Ce+ot,I=Ge+ot,k=ct-on,ne=gt+(oe-on),ae=_e*Ge/I*X,ce=Ke*Ge/I*X;q.projectionMatrix.makePerspective(k,ne,ae,ce,X,I),q.projectionMatrixInverse.copy(q.projectionMatrix).invert()}}function G(q,J){J===null?q.matrixWorld.copy(q.matrix):q.matrixWorld.multiplyMatrices(J.matrixWorld,q.matrix),q.matrixWorldInverse.copy(q.matrixWorld).invert()}this.updateCamera=function(q){if(s===null)return;let J=q.near,se=q.far;g.texture!==null&&(g.depthNear>0&&(J=g.depthNear),g.depthFar>0&&(se=g.depthFar)),A.near=E.near=T.near=J,A.far=E.far=T.far=se,(P!==A.near||D!==A.far)&&(s.updateRenderState({depthNear:A.near,depthFar:A.far}),P=A.near,D=A.far),T.layers.mask=q.layers.mask|2,E.layers.mask=q.layers.mask|4,A.layers.mask=T.layers.mask|E.layers.mask;const oe=q.parent,Ee=A.cameras;G(A,oe);for(let ye=0;ye<Ee.length;ye++)G(Ee[ye],oe);Ee.length===2?U(A,T,E):A.projectionMatrix.copy(T.projectionMatrix),H(q,A,oe)};function H(q,J,se){se===null?q.matrix.copy(J.matrixWorld):(q.matrix.copy(se.matrixWorld),q.matrix.invert(),q.matrix.multiply(J.matrixWorld)),q.matrix.decompose(q.position,q.quaternion,q.scale),q.updateMatrixWorld(!0),q.projectionMatrix.copy(J.projectionMatrix),q.projectionMatrixInverse.copy(J.projectionMatrixInverse),q.isPerspectiveCamera&&(q.fov=vd*2*Math.atan(1/q.projectionMatrix.elements[5]),q.zoom=1)}this.getCamera=function(){return A},this.getFoveation=function(){if(!(d===null&&p===null))return c},this.setFoveation=function(q){c=q,d!==null&&(d.fixedFoveation=q),p!==null&&p.fixedFoveation!==void 0&&(p.fixedFoveation=q)},this.hasDepthSensing=function(){return g.texture!==null},this.getDepthSensingMesh=function(){return g.getMesh(A)};let Y=null;function ee(q,J){if(h=J.getViewerPose(u||a),m=J,h!==null){const se=h.views;p!==null&&(e.setRenderTargetFramebuffer(x,p.framebuffer),e.setRenderTarget(x));let oe=!1;se.length!==A.cameras.length&&(A.cameras.length=0,oe=!0);for(let Ce=0;Ce<se.length;Ce++){const Ge=se[Ce];let _e=null;if(p!==null)_e=p.getViewport(Ge);else{const Q=f.getViewSubImage(d,Ge);_e=Q.viewport,Ce===0&&(e.setRenderTargetTextures(x,Q.colorTexture,Q.depthStencilTexture),e.setRenderTarget(x))}let Ke=M[Ce];Ke===void 0&&(Ke=new Ti,Ke.layers.enable(Ce),Ke.viewport=new Nt,M[Ce]=Ke),Ke.matrix.fromArray(Ge.transform.matrix),Ke.matrix.decompose(Ke.position,Ke.quaternion,Ke.scale),Ke.projectionMatrix.fromArray(Ge.projectionMatrix),Ke.projectionMatrixInverse.copy(Ke.projectionMatrix).invert(),Ke.viewport.set(_e.x,_e.y,_e.width,_e.height),Ce===0&&(A.matrix.copy(Ke.matrix),A.matrix.decompose(A.position,A.quaternion,A.scale)),oe===!0&&A.cameras.push(Ke)}const Ee=s.enabledFeatures;if(Ee&&Ee.includes("depth-sensing")&&s.depthUsage=="gpu-optimized"&&f){const Ce=f.getDepthInformation(se[0]);Ce&&Ce.isValid&&Ce.texture&&g.init(e,Ce,s.renderState)}}for(let se=0;se<b.length;se++){const oe=w[se],Ee=b[se];oe!==null&&Ee!==void 0&&Ee.update(oe,J,u||a)}Y&&Y(q,J),J.detectedPlanes&&i.dispatchEvent({type:"planesdetected",data:J}),m=null}const he=new jY;he.setAnimationLoop(ee),this.setAnimationLoop=function(q){Y=q},this.dispose=function(){}}}const hf=new so,dSe=new sn;function pSe(r,e){function n(v,y){v.matrixAutoUpdate===!0&&v.updateMatrix(),y.value.copy(v.matrix)}function i(v,y){y.color.getRGB(v.fogColor.value,EY(r)),y.isFog?(v.fogNear.value=y.near,v.fogFar.value=y.far):y.isFogExp2&&(v.fogDensity.value=y.density)}function s(v,y,x,b,w){y.isMeshBasicMaterial||y.isMeshLambertMaterial?o(v,y):y.isMeshToonMaterial?(o(v,y),f(v,y)):y.isMeshPhongMaterial?(o(v,y),h(v,y)):y.isMeshStandardMaterial?(o(v,y),d(v,y),y.isMeshPhysicalMaterial&&p(v,y,w)):y.isMeshMatcapMaterial?(o(v,y),m(v,y)):y.isMeshDepthMaterial?o(v,y):y.isMeshDistanceMaterial?(o(v,y),g(v,y)):y.isMeshNormalMaterial?o(v,y):y.isLineBasicMaterial?(a(v,y),y.isLineDashedMaterial&&l(v,y)):y.isPointsMaterial?c(v,y,x,b):y.isSpriteMaterial?u(v,y):y.isShadowMaterial?(v.color.value.copy(y.color),v.opacity.value=y.opacity):y.isShaderMaterial&&(y.uniformsNeedUpdate=!1)}function o(v,y){v.opacity.value=y.opacity,y.color&&v.diffuse.value.copy(y.color),y.emissive&&v.emissive.value.copy(y.emissive).multiplyScalar(y.emissiveIntensity),y.map&&(v.map.value=y.map,n(y.map,v.mapTransform)),y.alphaMap&&(v.alphaMap.value=y.alphaMap,n(y.alphaMap,v.alphaMapTransform)),y.bumpMap&&(v.bumpMap.value=y.bumpMap,n(y.bumpMap,v.bumpMapTransform),v.bumpScale.value=y.bumpScale,y.side===Fn&&(v.bumpScale.value*=-1)),y.normalMap&&(v.normalMap.value=y.normalMap,n(y.normalMap,v.normalMapTransform),v.normalScale.value.copy(y.normalScale),y.side===Fn&&v.normalScale.value.negate()),y.displacementMap&&(v.displacementMap.value=y.displacementMap,n(y.displacementMap,v.displacementMapTransform),v.displacementScale.value=y.displacementScale,v.displacementBias.value=y.displacementBias),y.emissiveMap&&(v.emissiveMap.value=y.emissiveMap,n(y.emissiveMap,v.emissiveMapTransform)),y.specularMap&&(v.specularMap.value=y.specularMap,n(y.specularMap,v.specularMapTransform)),y.alphaTest>0&&(v.alphaTest.value=y.alphaTest);const x=e.get(y),b=x.envMap,w=x.envMapRotation;b&&(v.envMap.value=b,hf.copy(w),hf.x*=-1,hf.y*=-1,hf.z*=-1,b.isCubeTexture&&b.isRenderTargetTexture===!1&&(hf.y*=-1,hf.z*=-1),v.envMapRotation.value.setFromMatrix4(dSe.makeRotationFromEuler(hf)),v.flipEnvMap.value=b.isCubeTexture&&b.isRenderTargetTexture===!1?-1:1,v.reflectivity.value=y.reflectivity,v.ior.value=y.ior,v.refractionRatio.value=y.refractionRatio),y.lightMap&&(v.lightMap.value=y.lightMap,v.lightMapIntensity.value=y.lightMapIntensity,n(y.lightMap,v.lightMapTransform)),y.aoMap&&(v.aoMap.value=y.aoMap,v.aoMapIntensity.value=y.aoMapIntensity,n(y.aoMap,v.aoMapTransform))}function a(v,y){v.diffuse.value.copy(y.color),v.opacity.value=y.opacity,y.map&&(v.map.value=y.map,n(y.map,v.mapTransform))}function l(v,y){v.dashSize.value=y.dashSize,v.totalSize.value=y.dashSize+y.gapSize,v.scale.value=y.scale}function c(v,y,x,b){v.diffuse.value.copy(y.color),v.opacity.value=y.opacity,v.size.value=y.size*x,v.scale.value=b*.5,y.map&&(v.map.value=y.map,n(y.map,v.uvTransform)),y.alphaMap&&(v.alphaMap.value=y.alphaMap,n(y.alphaMap,v.alphaMapTransform)),y.alphaTest>0&&(v.alphaTest.value=y.alphaTest)}function u(v,y){v.diffuse.value.copy(y.color),v.opacity.value=y.opacity,v.rotation.value=y.rotation,y.map&&(v.map.value=y.map,n(y.map,v.mapTransform)),y.alphaMap&&(v.alphaMap.value=y.alphaMap,n(y.alphaMap,v.alphaMapTransform)),y.alphaTest>0&&(v.alphaTest.value=y.alphaTest)}function h(v,y){v.specular.value.copy(y.specular),v.shininess.value=Math.max(y.shininess,1e-4)}function f(v,y){y.gradientMap&&(v.gradientMap.value=y.gradientMap)}function d(v,y){v.metalness.value=y.metalness,y.metalnessMap&&(v.metalnessMap.value=y.metalnessMap,n(y.metalnessMap,v.metalnessMapTransform)),v.roughness.value=y.roughness,y.roughnessMap&&(v.roughnessMap.value=y.roughnessMap,n(y.roughnessMap,v.roughnessMapTransform)),y.envMap&&(v.envMapIntensity.value=y.envMapIntensity)}function p(v,y,x){v.ior.value=y.ior,y.sheen>0&&(v.sheenColor.value.copy(y.sheenColor).multiplyScalar(y.sheen),v.sheenRoughness.value=y.sheenRoughness,y.sheenColorMap&&(v.sheenColorMap.value=y.sheenColorMap,n(y.sheenColorMap,v.sheenColorMapTransform)),y.sheenRoughnessMap&&(v.sheenRoughnessMap.value=y.sheenRoughnessMap,n(y.sheenRoughnessMap,v.sheenRoughnessMapTransform))),y.clearcoat>0&&(v.clearcoat.value=y.clearcoat,v.clearcoatRoughness.value=y.clearcoatRoughness,y.clearcoatMap&&(v.clearcoatMap.value=y.clearcoatMap,n(y.clearcoatMap,v.clearcoatMapTransform)),y.clearcoatRoughnessMap&&(v.clearcoatRoughnessMap.value=y.clearcoatRoughnessMap,n(y.clearcoatRoughnessMap,v.clearcoatRoughnessMapTransform)),y.clearcoatNormalMap&&(v.clearcoatNormalMap.value=y.clearcoatNormalMap,n(y.clearcoatNormalMap,v.clearcoatNormalMapTransform),v.clearcoatNormalScale.value.copy(y.clearcoatNormalScale),y.side===Fn&&v.clearcoatNormalScale.value.negate())),y.dispersion>0&&(v.dispersion.value=y.dispersion),y.iridescence>0&&(v.iridescence.value=y.iridescence,v.iridescenceIOR.value=y.iridescenceIOR,v.iridescenceThicknessMinimum.value=y.iridescenceThicknessRange[0],v.iridescenceThicknessMaximum.value=y.iridescenceThicknessRange[1],y.iridescenceMap&&(v.iridescenceMap.value=y.iridescenceMap,n(y.iridescenceMap,v.iridescenceMapTransform)),y.iridescenceThicknessMap&&(v.iridescenceThicknessMap.value=y.iridescenceThicknessMap,n(y.iridescenceThicknessMap,v.iridescenceThicknessMapTransform))),y.transmission>0&&(v.transmission.value=y.transmission,v.transmissionSamplerMap.value=x.texture,v.transmissionSamplerSize.value.set(x.width,x.height),y.transmissionMap&&(v.transmissionMap.value=y.transmissionMap,n(y.transmissionMap,v.transmissionMapTransform)),v.thickness.value=y.thickness,y.thicknessMap&&(v.thicknessMap.value=y.thicknessMap,n(y.thicknessMap,v.thicknessMapTransform)),v.attenuationDistance.value=y.attenuationDistance,v.attenuationColor.value.copy(y.attenuationColor)),y.anisotropy>0&&(v.anisotropyVector.value.set(y.anisotropy*Math.cos(y.anisotropyRotation),y.anisotropy*Math.sin(y.anisotropyRotation)),y.anisotropyMap&&(v.anisotropyMap.value=y.anisotropyMap,n(y.anisotropyMap,v.anisotropyMapTransform))),v.specularIntensity.value=y.specularIntensity,v.specularColor.value.copy(y.specularColor),y.specularColorMap&&(v.specularColorMap.value=y.specularColorMap,n(y.specularColorMap,v.specularColorMapTransform)),y.specularIntensityMap&&(v.specularIntensityMap.value=y.specularIntensityMap,n(y.specularIntensityMap,v.specularIntensityMapTransform))}function m(v,y){y.matcap&&(v.matcap.value=y.matcap)}function g(v,y){const x=e.get(y).light;v.referencePosition.value.setFromMatrixPosition(x.matrixWorld),v.nearDistance.value=x.shadow.camera.near,v.farDistance.value=x.shadow.camera.far}return{refreshFogUniforms:i,refreshMaterialUniforms:s}}function mSe(r,e,n,i){let s={},o={},a=[];const l=r.getParameter(r.MAX_UNIFORM_BUFFER_BINDINGS);function c(x,b){const w=b.program;i.uniformBlockBinding(x,w)}function u(x,b){let w=s[x.id];w===void 0&&(m(x),w=h(x),s[x.id]=w,x.addEventListener("dispose",v));const _=b.program;i.updateUBOMapping(x,_);const S=e.render.frame;o[x.id]!==S&&(d(x),o[x.id]=S)}function h(x){const b=f();x.__bindingPointIndex=b;const w=r.createBuffer(),_=x.__size,S=x.usage;return r.bindBuffer(r.UNIFORM_BUFFER,w),r.bufferData(r.UNIFORM_BUFFER,_,S),r.bindBuffer(r.UNIFORM_BUFFER,null),r.bindBufferBase(r.UNIFORM_BUFFER,b,w),w}function f(){for(let x=0;x<l;x++)if(a.indexOf(x)===-1)return a.push(x),x;return console.error("THREE.WebGLRenderer: Maximum number of simultaneously usable uniforms groups reached."),0}function d(x){const b=s[x.id],w=x.uniforms,_=x.__cache;r.bindBuffer(r.UNIFORM_BUFFER,b);for(let S=0,T=w.length;S<T;S++){const E=Array.isArray(w[S])?w[S]:[w[S]];for(let M=0,A=E.length;M<A;M++){const P=E[M];if(p(P,S,M,_)===!0){const D=P.__offset,B=Array.isArray(P.value)?P.value:[P.value];let C=0;for(let O=0;O<B.length;O++){const R=B[O],z=g(R);typeof R=="number"||typeof R=="boolean"?(P.__data[0]=R,r.bufferSubData(r.UNIFORM_BUFFER,D+C,P.__data)):R.isMatrix3?(P.__data[0]=R.elements[0],P.__data[1]=R.elements[1],P.__data[2]=R.elements[2],P.__data[3]=0,P.__data[4]=R.elements[3],P.__data[5]=R.elements[4],P.__data[6]=R.elements[5],P.__data[7]=0,P.__data[8]=R.elements[6],P.__data[9]=R.elements[7],P.__data[10]=R.elements[8],P.__data[11]=0):(R.toArray(P.__data,C),C+=z.storage/Float32Array.BYTES_PER_ELEMENT)}r.bufferSubData(r.UNIFORM_BUFFER,D,P.__data)}}}r.bindBuffer(r.UNIFORM_BUFFER,null)}function p(x,b,w,_){const S=x.value,T=b+"_"+w;if(_[T]===void 0)return typeof S=="number"||typeof S=="boolean"?_[T]=S:_[T]=S.clone(),!0;{const E=_[T];if(typeof S=="number"||typeof S=="boolean"){if(E!==S)return _[T]=S,!0}else if(E.equals(S)===!1)return E.copy(S),!0}return!1}function m(x){const b=x.uniforms;let w=0;const _=16;for(let T=0,E=b.length;T<E;T++){const M=Array.isArray(b[T])?b[T]:[b[T]];for(let A=0,P=M.length;A<P;A++){const D=M[A],B=Array.isArray(D.value)?D.value:[D.value];for(let C=0,O=B.length;C<O;C++){const R=B[C],z=g(R),U=w%_,G=U%z.boundary,H=U+G;w+=G,H!==0&&_-H<z.storage&&(w+=_-H),D.__data=new Float32Array(z.storage/Float32Array.BYTES_PER_ELEMENT),D.__offset=w,w+=z.storage}}}const S=w%_;return S>0&&(w+=_-S),x.__size=w,x.__cache={},this}function g(x){const b={boundary:0,storage:0};return typeof x=="number"||typeof x=="boolean"?(b.boundary=4,b.storage=4):x.isVector2?(b.boundary=8,b.storage=8):x.isVector3||x.isColor?(b.boundary=16,b.storage=12):x.isVector4?(b.boundary=16,b.storage=16):x.isMatrix3?(b.boundary=48,b.storage=48):x.isMatrix4?(b.boundary=64,b.storage=64):x.isTexture?console.warn("THREE.WebGLRenderer: Texture samplers can not be part of an uniforms group."):console.warn("THREE.WebGLRenderer: Unsupported uniform value type.",x),b}function v(x){const b=x.target;b.removeEventListener("dispose",v);const w=a.indexOf(b.__bindingPointIndex);a.splice(w,1),r.deleteBuffer(s[b.id]),delete s[b.id],delete o[b.id]}function y(){for(const x in s)r.deleteBuffer(s[x]);a=[],s={},o={}}return{bind:c,update:u,dispose:y}}class gSe{constructor(e={}){const{canvas:n=wY(),context:i=null,depth:s=!0,stencil:o=!1,alpha:a=!1,antialias:l=!1,premultipliedAlpha:c=!0,preserveDrawingBuffer:u=!1,powerPreference:h="default",failIfMajorPerformanceCaveat:f=!1,reverseDepthBuffer:d=!1}=e;this.isWebGLRenderer=!0;let p;if(i!==null){if(typeof WebGLRenderingContext<"u"&&i instanceof WebGLRenderingContext)throw new Error("THREE.WebGLRenderer: WebGL 1 is not supported since r163.");p=i.getContextAttributes().alpha}else p=a;const m=new Uint32Array(4),g=new Int32Array(4);let v=null,y=null;const x=[],b=[];this.domElement=n,this.debug={checkShaderErrors:!0,onShaderError:null},this.autoClear=!0,this.autoClearColor=!0,this.autoClearDepth=!0,this.autoClearStencil=!0,this.sortObjects=!0,this.clippingPlanes=[],this.localClippingEnabled=!1,this.toneMapping=io,this.toneMappingExposure=1,this.transmissionResolutionScale=1;const w=this;let _=!1;this._outputColorSpace=vt;let S=0,T=0,E=null,M=-1,A=null;const P=new Nt,D=new Nt;let B=null;const C=new pt(0);let O=0,R=n.width,z=n.height,U=1,G=null,H=null;const Y=new Nt(0,0,R,z),ee=new Nt(0,0,R,z);let he=!1;const q=new d_;let J=!1,se=!1;const oe=new sn,Ee=new sn,ye=new K,Ce=new Nt,Ge={background:null,fog:null,environment:null,overrideMaterial:null,isScene:!0};let _e=!1;function Ke(){return E===null?U:1}let Q=i;function kt(V,le){return n.getContext(V,le)}try{const V={alpha:!0,depth:s,stencil:o,antialias:l,premultipliedAlpha:c,preserveDrawingBuffer:u,powerPreference:h,failIfMajorPerformanceCaveat:f};if("setAttribute"in n&&n.setAttribute("data-engine",`three.js r${my}`),n.addEventListener("webglcontextlost",Re,!1),n.addEventListener("webglcontextrestored",Je,!1),n.addEventListener("webglcontextcreationerror",Ze,!1),Q===null){const le="webgl2";if(Q=kt(le,V),Q===null)throw kt(le)?new Error("Error creating WebGL context with your selected attributes."):new Error("Error creating WebGL context.")}}catch(V){throw console.error("THREE.WebGLRenderer: "+V.message),V}let ct,gt,ot,on,X,I,k,ne,ae,ce,pe,ze,ke,lt,wt,De,et,St,At,tt,en,$t,fn,ue;function Ye(){ct=new M_e(Q),ct.init(),$t=new lSe(Q,ct),gt=new x_e(Q,ct,e,$t),ot=new oSe(Q,ct),gt.reverseDepthBuffer&&d&&ot.buffers.depth.setReversed(!0),on=new P_e(Q),X=new qwe,I=new aSe(Q,ct,ot,X,gt,$t,on),k=new __e(w),ne=new E_e(w),ae=new I0e(Q),fn=new y_e(Q,ae),ce=new A_e(Q,ae,on,fn),pe=new N_e(Q,ce,ae,on),At=new R_e(Q,gt,I),De=new b_e(X),ze=new Wwe(w,k,ne,ct,gt,fn,De),ke=new pSe(w,X),lt=new Kwe,wt=new tSe(ct),St=new g_e(w,k,ne,ot,pe,p,c),et=new iSe(w,pe,gt),ue=new mSe(Q,on,gt,ot),tt=new v_e(Q,ct,on),en=new C_e(Q,ct,on),on.programs=ze.programs,w.capabilities=gt,w.extensions=ct,w.properties=X,w.renderLists=lt,w.shadowMap=et,w.state=ot,w.info=on}Ye();const Se=new fSe(w,Q);this.xr=Se,this.getContext=function(){return Q},this.getContextAttributes=function(){return Q.getContextAttributes()},this.forceContextLoss=function(){const V=ct.get("WEBGL_lose_context");V&&V.loseContext()},this.forceContextRestore=function(){const V=ct.get("WEBGL_lose_context");V&&V.restoreContext()},this.getPixelRatio=function(){return U},this.setPixelRatio=function(V){V!==void 0&&(U=V,this.setSize(R,z,!1))},this.getSize=function(V){return V.set(R,z)},this.setSize=function(V,le,ge=!0){if(Se.isPresenting){console.warn("THREE.WebGLRenderer: Can't change size while VR device is presenting.");return}R=V,z=le,n.width=Math.floor(V*U),n.height=Math.floor(le*U),ge===!0&&(n.style.width=V+"px",n.style.height=le+"px"),this.setViewport(0,0,V,le)},this.getDrawingBufferSize=function(V){return V.set(R*U,z*U).floor()},this.setDrawingBufferSize=function(V,le,ge){R=V,z=le,U=ge,n.width=Math.floor(V*ge),n.height=Math.floor(le*ge),this.setViewport(0,0,V,le)},this.getCurrentViewport=function(V){return V.copy(P)},this.getViewport=function(V){return V.copy(Y)},this.setViewport=function(V,le,ge,ve){V.isVector4?Y.set(V.x,V.y,V.z,V.w):Y.set(V,le,ge,ve),ot.viewport(P.copy(Y).multiplyScalar(U).round())},this.getScissor=function(V){return V.copy(ee)},this.setScissor=function(V,le,ge,ve){V.isVector4?ee.set(V.x,V.y,V.z,V.w):ee.set(V,le,ge,ve),ot.scissor(D.copy(ee).multiplyScalar(U).round())},this.getScissorTest=function(){return he},this.setScissorTest=function(V){ot.setScissorTest(he=V)},this.setOpaqueSort=function(V){G=V},this.setTransparentSort=function(V){H=V},this.getClearColor=function(V){return V.copy(St.getClearColor())},this.setClearColor=function(){St.setClearColor(...arguments)},this.getClearAlpha=function(){return St.getClearAlpha()},this.setClearAlpha=function(){St.setClearAlpha(...arguments)},this.clear=function(V=!0,le=!0,ge=!0){let ve=0;if(V){let de=!1;if(E!==null){const Ue=E.texture.format;de=Ue===vy||Ue===yy||Ue===gy}if(de){const Ue=E.texture.type,qe=Ue===gr||Ue===In||Ue===qa||Ue===No||Ue===GM||Ue===HM,nt=St.getClearColor(),at=St.getClearAlpha(),It=nt.r,Ot=nt.g,xt=nt.b;qe?(m[0]=It,m[1]=Ot,m[2]=xt,m[3]=at,Q.clearBufferuiv(Q.COLOR,0,m)):(g[0]=It,g[1]=Ot,g[2]=xt,g[3]=at,Q.clearBufferiv(Q.COLOR,0,g))}else ve|=Q.COLOR_BUFFER_BIT}le&&(ve|=Q.DEPTH_BUFFER_BIT),ge&&(ve|=Q.STENCIL_BUFFER_BIT,this.state.buffers.stencil.setMask(4294967295)),Q.clear(ve)},this.clearColor=function(){this.clear(!0,!1,!1)},this.clearDepth=function(){this.clear(!1,!0,!1)},this.clearStencil=function(){this.clear(!1,!1,!0)},this.dispose=function(){n.removeEventListener("webglcontextlost",Re,!1),n.removeEventListener("webglcontextrestored",Je,!1),n.removeEventListener("webglcontextcreationerror",Ze,!1),St.dispose(),lt.dispose(),wt.dispose(),X.dispose(),k.dispose(),ne.dispose(),pe.dispose(),fn.dispose(),ue.dispose(),ze.dispose(),Se.dispose(),Se.removeEventListener("sessionstart",G_),Se.removeEventListener("sessionend",H_),Kl.stop()};function Re(V){V.preventDefault(),console.log("THREE.WebGLRenderer: Context Lost."),_=!0}function Je(){console.log("THREE.WebGLRenderer: Context Restored."),_=!1;const V=on.autoReset,le=et.enabled,ge=et.autoUpdate,ve=et.needsUpdate,de=et.type;Ye(),on.autoReset=V,et.enabled=le,et.autoUpdate=ge,et.needsUpdate=ve,et.type=de}function Ze(V){console.error("THREE.WebGLRenderer: A WebGL context could not be created. Reason: ",V.statusMessage)}function Gt(V){const le=V.target;le.removeEventListener("dispose",Gt),Vn(le)}function Vn(V){yi(V),X.remove(V)}function yi(V){const le=X.get(V).programs;le!==void 0&&(le.forEach(function(ge){ze.releaseProgram(ge)}),V.isShaderMaterial&&ze.releaseShaderCache(V))}this.renderBufferDirect=function(V,le,ge,ve,de,Ue){le===null&&(le=Ge);const qe=de.isMesh&&de.matrixWorld.determinant()<0,nt=vC(V,le,ge,ve,de);ot.setMaterial(ve,qe);let at=ge.index,It=1;if(ve.wireframe===!0){if(at=ce.getWireframeAttribute(ge),at===void 0)return;It=2}const Ot=ge.drawRange,xt=ge.attributes.position;let Yt=Ot.start*It,dn=(Ot.start+Ot.count)*It;Ue!==null&&(Yt=Math.max(Yt,Ue.start*It),dn=Math.min(dn,(Ue.start+Ue.count)*It)),at!==null?(Yt=Math.max(Yt,0),dn=Math.min(dn,at.count)):xt!=null&&(Yt=Math.max(Yt,0),dn=Math.min(dn,xt.count));const cr=dn-Yt;if(cr<0||cr===1/0)return;fn.setup(de,ve,nt,ge,at);let nr,ln=tt;if(at!==null&&(nr=ae.get(at),ln=en,ln.setIndex(nr)),de.isMesh)ve.wireframe===!0?(ot.setLineWidth(ve.wireframeLinewidth*Ke()),ln.setMode(Q.LINES)):ln.setMode(Q.TRIANGLES);else if(de.isLine){let Et=ve.linewidth;Et===void 0&&(Et=1),ot.setLineWidth(Et*Ke()),de.isLineSegments?ln.setMode(Q.LINES):de.isLineLoop?ln.setMode(Q.LINE_LOOP):ln.setMode(Q.LINE_STRIP)}else de.isPoints?ln.setMode(Q.POINTS):de.isSprite&&ln.setMode(Q.TRIANGLES);if(de.isBatchedMesh)if(de._multiDrawInstances!==null)Ja("THREE.WebGLRenderer: renderMultiDrawInstances has been deprecated and will be removed in r184. Append to renderMultiDraw arguments and use indirection."),ln.renderMultiDrawInstances(de._multiDrawStarts,de._multiDrawCounts,de._multiDrawCount,de._multiDrawInstances);else if(ct.get("WEBGL_multi_draw"))ln.renderMultiDraw(de._multiDrawStarts,de._multiDrawCounts,de._multiDrawCount);else{const Et=de._multiDrawStarts,ei=de._multiDrawCounts,pn=de._multiDrawCount,zs=at?ae.get(at).bytesPerElement:1,Bn=X.get(ve).currentProgram.getUniforms();for(let Ri=0;Ri<pn;Ri++)Bn.setValue(Q,"_gl_DrawID",Ri),ln.render(Et[Ri]/zs,ei[Ri])}else if(de.isInstancedMesh)ln.renderInstances(Yt,cr,de.count);else if(ge.isInstancedBufferGeometry){const Et=ge._maxInstanceCount!==void 0?ge._maxInstanceCount:1/0,ei=Math.min(ge.instanceCount,Et);ln.renderInstances(Yt,cr,ei)}else ln.render(Yt,cr)};function Xt(V,le,ge){V.transparent===!0&&V.side===Es&&V.forceSinglePass===!1?(V.side=Fn,V.needsUpdate=!0,zd(V,le,ge),V.side=no,V.needsUpdate=!0,zd(V,le,ge),V.side=Es):zd(V,le,ge)}this.compile=function(V,le,ge=null){ge===null&&(ge=V),y=wt.get(ge),y.init(le),b.push(y),ge.traverseVisible(function(de){de.isLight&&de.layers.test(le.layers)&&(y.pushLight(de),de.castShadow&&y.pushShadow(de))}),V!==ge&&V.traverseVisible(function(de){de.isLight&&de.layers.test(le.layers)&&(y.pushLight(de),de.castShadow&&y.pushShadow(de))}),y.setupLights();const ve=new Set;return V.traverse(function(de){if(!(de.isMesh||de.isPoints||de.isLine||de.isSprite))return;const Ue=de.material;if(Ue)if(Array.isArray(Ue))for(let qe=0;qe<Ue.length;qe++){const nt=Ue[qe];Xt(nt,ge,de),ve.add(nt)}else Xt(Ue,ge,de),ve.add(Ue)}),y=b.pop(),ve},this.compileAsync=function(V,le,ge=null){const ve=this.compile(V,le,ge);return new Promise(de=>{function Ue(){if(ve.forEach(function(qe){X.get(qe).currentProgram.isReady()&&ve.delete(qe)}),ve.size===0){de(V);return}setTimeout(Ue,10)}ct.get("KHR_parallel_shader_compile")!==null?Ue():setTimeout(Ue,10)})};let Us=null;function ya(V){Us&&Us(V)}function G_(){Kl.stop()}function H_(){Kl.start()}const Kl=new jY;Kl.setAnimationLoop(ya),typeof self<"u"&&Kl.setContext(self),this.setAnimationLoop=function(V){Us=V,Se.setAnimationLoop(V),V===null?Kl.stop():Kl.start()},Se.addEventListener("sessionstart",G_),Se.addEventListener("sessionend",H_),this.render=function(V,le){if(le!==void 0&&le.isCamera!==!0){console.error("THREE.WebGLRenderer.render: camera is not an instance of THREE.Camera.");return}if(_===!0)return;if(V.matrixWorldAutoUpdate===!0&&V.updateMatrixWorld(),le.parent===null&&le.matrixWorldAutoUpdate===!0&&le.updateMatrixWorld(),Se.enabled===!0&&Se.isPresenting===!0&&(Se.cameraAutoUpdate===!0&&Se.updateCamera(le),le=Se.getCamera()),V.isScene===!0&&V.onBeforeRender(w,V,le,E),y=wt.get(V,b.length),y.init(le),b.push(y),Ee.multiplyMatrices(le.projectionMatrix,le.matrixWorldInverse),q.setFromProjectionMatrix(Ee),se=this.localClippingEnabled,J=De.init(this.clippingPlanes,se),v=lt.get(V,x.length),v.init(),x.push(v),Se.enabled===!0&&Se.isPresenting===!0){const Ue=w.xr.getDepthSensingMesh();Ue!==null&&Fy(Ue,le,-1/0,w.sortObjects)}Fy(V,le,0,w.sortObjects),v.finish(),w.sortObjects===!0&&v.sort(G,H),_e=Se.enabled===!1||Se.isPresenting===!1||Se.hasDepthSensing()===!1,_e&&St.addToRenderList(v,V),this.info.render.frame++,J===!0&&De.beginShadows();const ge=y.state.shadowsArray;et.render(ge,V,le),J===!0&&De.endShadows(),this.info.autoReset===!0&&this.info.reset();const ve=v.opaque,de=v.transmissive;if(y.setupLights(),le.isArrayCamera){const Ue=le.cameras;if(de.length>0)for(let qe=0,nt=Ue.length;qe<nt;qe++){const at=Ue[qe];By(ve,de,V,at)}_e&&St.render(V);for(let qe=0,nt=Ue.length;qe<nt;qe++){const at=Ue[qe];W_(v,V,at,at.viewport)}}else de.length>0&&By(ve,de,V,le),_e&&St.render(V),W_(v,V,le);E!==null&&T===0&&(I.updateMultisampleRenderTarget(E),I.updateRenderTargetMipmap(E)),V.isScene===!0&&V.onAfterRender(w,V,le),fn.resetDefaultState(),M=-1,A=null,b.pop(),b.length>0?(y=b[b.length-1],J===!0&&De.setGlobalState(w.clippingPlanes,y.state.camera)):y=null,x.pop(),x.length>0?v=x[x.length-1]:v=null};function Fy(V,le,ge,ve){if(V.visible===!1)return;if(V.layers.test(le.layers)){if(V.isGroup)ge=V.renderOrder;else if(V.isLOD)V.autoUpdate===!0&&V.update(le);else if(V.isLight)y.pushLight(V),V.castShadow&&y.pushShadow(V);else if(V.isSprite){if(!V.frustumCulled||q.intersectsSprite(V)){ve&&Ce.setFromMatrixPosition(V.matrixWorld).applyMatrix4(Ee);const qe=pe.update(V),nt=V.material;nt.visible&&v.push(V,qe,nt,ge,Ce.z,null)}}else if((V.isMesh||V.isLine||V.isPoints)&&(!V.frustumCulled||q.intersectsObject(V))){const qe=pe.update(V),nt=V.material;if(ve&&(V.boundingSphere!==void 0?(V.boundingSphere===null&&V.computeBoundingSphere(),Ce.copy(V.boundingSphere.center)):(qe.boundingSphere===null&&qe.computeBoundingSphere(),Ce.copy(qe.boundingSphere.center)),Ce.applyMatrix4(V.matrixWorld).applyMatrix4(Ee)),Array.isArray(nt)){const at=qe.groups;for(let It=0,Ot=at.length;It<Ot;It++){const xt=at[It],Yt=nt[xt.materialIndex];Yt&&Yt.visible&&v.push(V,qe,Yt,ge,Ce.z,xt)}}else nt.visible&&v.push(V,qe,nt,ge,Ce.z,null)}}const Ue=V.children;for(let qe=0,nt=Ue.length;qe<nt;qe++)Fy(Ue[qe],le,ge,ve)}function W_(V,le,ge,ve){const de=V.opaque,Ue=V.transmissive,qe=V.transparent;y.setupLightsView(ge),J===!0&&De.setGlobalState(w.clippingPlanes,ge),ve&&ot.viewport(P.copy(ve)),de.length>0&&Ud(de,le,ge),Ue.length>0&&Ud(Ue,le,ge),qe.length>0&&Ud(qe,le,ge),ot.buffers.depth.setTest(!0),ot.buffers.depth.setMask(!0),ot.buffers.color.setMask(!0),ot.setPolygonOffset(!1)}function By(V,le,ge,ve){if((ge.isScene===!0?ge.overrideMaterial:null)!==null)return;y.state.transmissionRenderTarget[ve.id]===void 0&&(y.state.transmissionRenderTarget[ve.id]=new Rh(1,1,{generateMipmaps:!0,type:ct.has("EXT_color_buffer_half_float")||ct.has("EXT_color_buffer_float")?Ei:gr,minFilter:Ks,samples:4,stencilBuffer:o,resolveDepthBuffer:!1,resolveStencilBuffer:!1,colorSpace:Qt.workingColorSpace}));const Ue=y.state.transmissionRenderTarget[ve.id],qe=ve.viewport||P;Ue.setSize(qe.z*w.transmissionResolutionScale,qe.w*w.transmissionResolutionScale);const nt=w.getRenderTarget();w.setRenderTarget(Ue),w.getClearColor(C),O=w.getClearAlpha(),O<1&&w.setClearColor(16777215,.5),w.clear(),_e&&St.render(ge);const at=w.toneMapping;w.toneMapping=io;const It=ve.viewport;if(ve.viewport!==void 0&&(ve.viewport=void 0),y.setupLightsView(ve),J===!0&&De.setGlobalState(w.clippingPlanes,ve),Ud(V,ge,ve),I.updateMultisampleRenderTarget(Ue),I.updateRenderTargetMipmap(Ue),ct.has("WEBGL_multisampled_render_to_texture")===!1){let Ot=!1;for(let xt=0,Yt=le.length;xt<Yt;xt++){const dn=le[xt],cr=dn.object,nr=dn.geometry,ln=dn.material,Et=dn.group;if(ln.side===Es&&cr.layers.test(ve.layers)){const ei=ln.side;ln.side=Fn,ln.needsUpdate=!0,Uy(cr,ge,ve,nr,ln,Et),ln.side=ei,ln.needsUpdate=!0,Ot=!0}}Ot===!0&&(I.updateMultisampleRenderTarget(Ue),I.updateRenderTargetMipmap(Ue))}w.setRenderTarget(nt),w.setClearColor(C,O),It!==void 0&&(ve.viewport=It),w.toneMapping=at}function Ud(V,le,ge){const ve=le.isScene===!0?le.overrideMaterial:null;for(let de=0,Ue=V.length;de<Ue;de++){const qe=V[de],nt=qe.object,at=qe.geometry,It=qe.group;let Ot=qe.material;Ot.allowOverride===!0&&ve!==null&&(Ot=ve),nt.layers.test(ge.layers)&&Uy(nt,le,ge,at,Ot,It)}}function Uy(V,le,ge,ve,de,Ue){V.onBeforeRender(w,le,ge,ve,de,Ue),V.modelViewMatrix.multiplyMatrices(ge.matrixWorldInverse,V.matrixWorld),V.normalMatrix.getNormalMatrix(V.modelViewMatrix),de.onBeforeRender(w,le,ge,ve,V,Ue),de.transparent===!0&&de.side===Es&&de.forceSinglePass===!1?(de.side=Fn,de.needsUpdate=!0,w.renderBufferDirect(ge,le,ve,de,V,Ue),de.side=no,de.needsUpdate=!0,w.renderBufferDirect(ge,le,ve,de,V,Ue),de.side=Es):w.renderBufferDirect(ge,le,ve,de,V,Ue),V.onAfterRender(w,le,ge,ve,de,Ue)}function zd(V,le,ge){le.isScene!==!0&&(le=Ge);const ve=X.get(V),de=y.state.lights,Ue=y.state.shadowsArray,qe=de.state.version,nt=ze.getParameters(V,de.state,Ue,le,ge),at=ze.getProgramCacheKey(nt);let It=ve.programs;ve.environment=V.isMeshStandardMaterial?le.environment:null,ve.fog=le.fog,ve.envMap=(V.isMeshStandardMaterial?ne:k).get(V.envMap||ve.environment),ve.envMapRotation=ve.environment!==null&&V.envMap===null?le.environmentRotation:V.envMapRotation,It===void 0&&(V.addEventListener("dispose",Gt),It=new Map,ve.programs=It);let Ot=It.get(at);if(Ot!==void 0){if(ve.currentProgram===Ot&&ve.lightsStateVersion===qe)return X_(V,nt),Ot}else nt.uniforms=ze.getUniforms(V),V.onBeforeCompile(nt,w),Ot=ze.acquireProgram(nt,at),It.set(at,Ot),ve.uniforms=nt.uniforms;const xt=ve.uniforms;return(!V.isShaderMaterial&&!V.isRawShaderMaterial||V.clipping===!0)&&(xt.clippingPlanes=De.uniform),X_(V,nt),ve.needsLights=bC(V),ve.lightsStateVersion=qe,ve.needsLights&&(xt.ambientLightColor.value=de.state.ambient,xt.lightProbe.value=de.state.probe,xt.directionalLights.value=de.state.directional,xt.directionalLightShadows.value=de.state.directionalShadow,xt.spotLights.value=de.state.spot,xt.spotLightShadows.value=de.state.spotShadow,xt.rectAreaLights.value=de.state.rectArea,xt.ltc_1.value=de.state.rectAreaLTC1,xt.ltc_2.value=de.state.rectAreaLTC2,xt.pointLights.value=de.state.point,xt.pointLightShadows.value=de.state.pointShadow,xt.hemisphereLights.value=de.state.hemi,xt.directionalShadowMap.value=de.state.directionalShadowMap,xt.directionalShadowMatrix.value=de.state.directionalShadowMatrix,xt.spotShadowMap.value=de.state.spotShadowMap,xt.spotLightMatrix.value=de.state.spotLightMatrix,xt.spotLightMap.value=de.state.spotLightMap,xt.pointShadowMap.value=de.state.pointShadowMap,xt.pointShadowMatrix.value=de.state.pointShadowMatrix),ve.currentProgram=Ot,ve.uniformsList=null,Ot}function q_(V){if(V.uniformsList===null){const le=V.currentProgram.getUniforms();V.uniformsList=N1.seqWithValue(le.seq,V.uniforms)}return V.uniformsList}function X_(V,le){const ge=X.get(V);ge.outputColorSpace=le.outputColorSpace,ge.batching=le.batching,ge.batchingColor=le.batchingColor,ge.instancing=le.instancing,ge.instancingColor=le.instancingColor,ge.instancingMorph=le.instancingMorph,ge.skinning=le.skinning,ge.morphTargets=le.morphTargets,ge.morphNormals=le.morphNormals,ge.morphColors=le.morphColors,ge.morphTargetsCount=le.morphTargetsCount,ge.numClippingPlanes=le.numClippingPlanes,ge.numIntersection=le.numClipIntersection,ge.vertexAlphas=le.vertexAlphas,ge.vertexTangents=le.vertexTangents,ge.toneMapping=le.toneMapping}function vC(V,le,ge,ve,de){le.isScene!==!0&&(le=Ge),I.resetTextureUnits();const Ue=le.fog,qe=ve.isMeshStandardMaterial?le.environment:null,nt=E===null?w.outputColorSpace:E.isXRRenderTarget===!0?E.texture.colorSpace:Ol,at=(ve.isMeshStandardMaterial?ne:k).get(ve.envMap||qe),It=ve.vertexColors===!0&&!!ge.attributes.color&&ge.attributes.color.itemSize===4,Ot=!!ge.attributes.tangent&&(!!ve.normalMap||ve.anisotropy>0),xt=!!ge.morphAttributes.position,Yt=!!ge.morphAttributes.normal,dn=!!ge.morphAttributes.color;let cr=io;ve.toneMapped&&(E===null||E.isXRRenderTarget===!0)&&(cr=w.toneMapping);const nr=ge.morphAttributes.position||ge.morphAttributes.normal||ge.morphAttributes.color,ln=nr!==void 0?nr.length:0,Et=X.get(ve),ei=y.state.lights;if(J===!0&&(se===!0||V!==A)){const Lr=V===A&&ve.id===M;De.setState(ve,V,Lr)}let pn=!1;ve.version===Et.__version?(Et.needsLights&&Et.lightsStateVersion!==ei.state.version||Et.outputColorSpace!==nt||de.isBatchedMesh&&Et.batching===!1||!de.isBatchedMesh&&Et.batching===!0||de.isBatchedMesh&&Et.batchingColor===!0&&de.colorTexture===null||de.isBatchedMesh&&Et.batchingColor===!1&&de.colorTexture!==null||de.isInstancedMesh&&Et.instancing===!1||!de.isInstancedMesh&&Et.instancing===!0||de.isSkinnedMesh&&Et.skinning===!1||!de.isSkinnedMesh&&Et.skinning===!0||de.isInstancedMesh&&Et.instancingColor===!0&&de.instanceColor===null||de.isInstancedMesh&&Et.instancingColor===!1&&de.instanceColor!==null||de.isInstancedMesh&&Et.instancingMorph===!0&&de.morphTexture===null||de.isInstancedMesh&&Et.instancingMorph===!1&&de.morphTexture!==null||Et.envMap!==at||ve.fog===!0&&Et.fog!==Ue||Et.numClippingPlanes!==void 0&&(Et.numClippingPlanes!==De.numPlanes||Et.numIntersection!==De.numIntersection)||Et.vertexAlphas!==It||Et.vertexTangents!==Ot||Et.morphTargets!==xt||Et.morphNormals!==Yt||Et.morphColors!==dn||Et.toneMapping!==cr||Et.morphTargetsCount!==ln)&&(pn=!0):(pn=!0,Et.__version=ve.version);let zs=Et.currentProgram;pn===!0&&(zs=zd(ve,le,de));let Bn=!1,Ri=!1,Jh=!1;const On=zs.getUniforms(),us=Et.uniforms;if(ot.useProgram(zs.program)&&(Bn=!0,Ri=!0,Jh=!0),ve.id!==M&&(M=ve.id,Ri=!0),Bn||A!==V){ot.buffers.depth.getReversed()?(oe.copy(V.projectionMatrix),bve(oe),_ve(oe),On.setValue(Q,"projectionMatrix",oe)):On.setValue(Q,"projectionMatrix",V.projectionMatrix),On.setValue(Q,"viewMatrix",V.matrixWorldInverse);const ti=On.map.cameraPosition;ti!==void 0&&ti.setValue(Q,ye.setFromMatrixPosition(V.matrixWorld)),gt.logarithmicDepthBuffer&&On.setValue(Q,"logDepthBufFC",2/(Math.log(V.far+1)/Math.LN2)),(ve.isMeshPhongMaterial||ve.isMeshToonMaterial||ve.isMeshLambertMaterial||ve.isMeshBasicMaterial||ve.isMeshStandardMaterial||ve.isShaderMaterial)&&On.setValue(Q,"isOrthographic",V.isOrthographicCamera===!0),A!==V&&(A=V,Ri=!0,Jh=!0)}if(de.isSkinnedMesh){On.setOptional(Q,de,"bindMatrix"),On.setOptional(Q,de,"bindMatrixInverse");const Lr=de.skeleton;Lr&&(Lr.boneTexture===null&&Lr.computeBoneTexture(),On.setValue(Q,"boneTexture",Lr.boneTexture,I))}de.isBatchedMesh&&(On.setOptional(Q,de,"batchingTexture"),On.setValue(Q,"batchingTexture",de._matricesTexture,I),On.setOptional(Q,de,"batchingIdTexture"),On.setValue(Q,"batchingIdTexture",de._indirectTexture,I),On.setOptional(Q,de,"batchingColorTexture"),de._colorsTexture!==null&&On.setValue(Q,"batchingColorTexture",de._colorsTexture,I));const Gi=ge.morphAttributes;if((Gi.position!==void 0||Gi.normal!==void 0||Gi.color!==void 0)&&At.update(de,ge,zs),(Ri||Et.receiveShadow!==de.receiveShadow)&&(Et.receiveShadow=de.receiveShadow,On.setValue(Q,"receiveShadow",de.receiveShadow)),ve.isMeshGouraudMaterial&&ve.envMap!==null&&(us.envMap.value=at,us.flipEnvMap.value=at.isCubeTexture&&at.isRenderTargetTexture===!1?-1:1),ve.isMeshStandardMaterial&&ve.envMap===null&&le.environment!==null&&(us.envMapIntensity.value=le.environmentIntensity),Ri&&(On.setValue(Q,"toneMappingExposure",w.toneMappingExposure),Et.needsLights&&xC(us,Jh),Ue&&ve.fog===!0&&ke.refreshFogUniforms(us,Ue),ke.refreshMaterialUniforms(us,ve,U,z,y.state.transmissionRenderTarget[V.id]),N1.upload(Q,q_(Et),us,I)),ve.isShaderMaterial&&ve.uniformsNeedUpdate===!0&&(N1.upload(Q,q_(Et),us,I),ve.uniformsNeedUpdate=!1),ve.isSpriteMaterial&&On.setValue(Q,"center",de.center),On.setValue(Q,"modelViewMatrix",de.modelViewMatrix),On.setValue(Q,"normalMatrix",de.normalMatrix),On.setValue(Q,"modelMatrix",de.matrixWorld),ve.isShaderMaterial||ve.isRawShaderMaterial){const Lr=ve.uniformsGroups;for(let ti=0,$d=Lr.length;ti<$d;ti++){const Yl=Lr[ti];ue.update(Yl,zs),ue.bind(Yl,zs)}}return zs}function xC(V,le){V.ambientLightColor.needsUpdate=le,V.lightProbe.needsUpdate=le,V.directionalLights.needsUpdate=le,V.directionalLightShadows.needsUpdate=le,V.pointLights.needsUpdate=le,V.pointLightShadows.needsUpdate=le,V.spotLights.needsUpdate=le,V.spotLightShadows.needsUpdate=le,V.rectAreaLights.needsUpdate=le,V.hemisphereLights.needsUpdate=le}function bC(V){return V.isMeshLambertMaterial||V.isMeshToonMaterial||V.isMeshPhongMaterial||V.isMeshStandardMaterial||V.isShadowMaterial||V.isShaderMaterial&&V.lights===!0}this.getActiveCubeFace=function(){return S},this.getActiveMipmapLevel=function(){return T},this.getRenderTarget=function(){return E},this.setRenderTargetTextures=function(V,le,ge){const ve=X.get(V);ve.__autoAllocateDepthBuffer=V.resolveDepthBuffer===!1,ve.__autoAllocateDepthBuffer===!1&&(ve.__useRenderToTexture=!1),X.get(V.texture).__webglTexture=le,X.get(V.depthTexture).__webglTexture=ve.__autoAllocateDepthBuffer?void 0:ge,ve.__hasExternalTextures=!0},this.setRenderTargetFramebuffer=function(V,le){const ge=X.get(V);ge.__webglFramebuffer=le,ge.__useDefaultFramebuffer=le===void 0};const _C=Q.createFramebuffer();this.setRenderTarget=function(V,le=0,ge=0){E=V,S=le,T=ge;let ve=!0,de=null,Ue=!1,qe=!1;if(V){const at=X.get(V);if(at.__useDefaultFramebuffer!==void 0)ot.bindFramebuffer(Q.FRAMEBUFFER,null),ve=!1;else if(at.__webglFramebuffer===void 0)I.setupRenderTarget(V);else if(at.__hasExternalTextures)I.rebindTextures(V,X.get(V.texture).__webglTexture,X.get(V.depthTexture).__webglTexture);else if(V.depthBuffer){const xt=V.depthTexture;if(at.__boundDepthTexture!==xt){if(xt!==null&&X.has(xt)&&(V.width!==xt.image.width||V.height!==xt.image.height))throw new Error("WebGLRenderTarget: Attached DepthTexture is initialized to the incorrect size.");I.setupDepthRenderbuffer(V)}}const It=V.texture;(It.isData3DTexture||It.isDataArrayTexture||It.isCompressedArrayTexture)&&(qe=!0);const Ot=X.get(V).__webglFramebuffer;V.isWebGLCubeRenderTarget?(Array.isArray(Ot[le])?de=Ot[le][ge]:de=Ot[le],Ue=!0):V.samples>0&&I.useMultisampledRTT(V)===!1?de=X.get(V).__webglMultisampledFramebuffer:Array.isArray(Ot)?de=Ot[ge]:de=Ot,P.copy(V.viewport),D.copy(V.scissor),B=V.scissorTest}else P.copy(Y).multiplyScalar(U).floor(),D.copy(ee).multiplyScalar(U).floor(),B=he;if(ge!==0&&(de=_C),ot.bindFramebuffer(Q.FRAMEBUFFER,de)&&ve&&ot.drawBuffers(V,de),ot.viewport(P),ot.scissor(D),ot.setScissorTest(B),Ue){const at=X.get(V.texture);Q.framebufferTexture2D(Q.FRAMEBUFFER,Q.COLOR_ATTACHMENT0,Q.TEXTURE_CUBE_MAP_POSITIVE_X+le,at.__webglTexture,ge)}else if(qe){const at=X.get(V.texture),It=le;Q.framebufferTextureLayer(Q.FRAMEBUFFER,Q.COLOR_ATTACHMENT0,at.__webglTexture,ge,It)}else if(V!==null&&ge!==0){const at=X.get(V.texture);Q.framebufferTexture2D(Q.FRAMEBUFFER,Q.COLOR_ATTACHMENT0,Q.TEXTURE_2D,at.__webglTexture,ge)}M=-1},this.readRenderTargetPixels=function(V,le,ge,ve,de,Ue,qe){if(!(V&&V.isWebGLRenderTarget)){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.");return}let nt=X.get(V).__webglFramebuffer;if(V.isWebGLCubeRenderTarget&&qe!==void 0&&(nt=nt[qe]),nt){ot.bindFramebuffer(Q.FRAMEBUFFER,nt);try{const at=V.texture,It=at.format,Ot=at.type;if(!gt.textureFormatReadable(It)){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in RGBA or implementation defined format.");return}if(!gt.textureTypeReadable(Ot)){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in UnsignedByteType or implementation defined type.");return}le>=0&&le<=V.width-ve&&ge>=0&&ge<=V.height-de&&Q.readPixels(le,ge,ve,de,$t.convert(It),$t.convert(Ot),Ue)}finally{const at=E!==null?X.get(E).__webglFramebuffer:null;ot.bindFramebuffer(Q.FRAMEBUFFER,at)}}},this.readRenderTargetPixelsAsync=async function(V,le,ge,ve,de,Ue,qe){if(!(V&&V.isWebGLRenderTarget))throw new Error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.");let nt=X.get(V).__webglFramebuffer;if(V.isWebGLCubeRenderTarget&&qe!==void 0&&(nt=nt[qe]),nt)if(le>=0&&le<=V.width-ve&&ge>=0&&ge<=V.height-de){ot.bindFramebuffer(Q.FRAMEBUFFER,nt);const at=V.texture,It=at.format,Ot=at.type;if(!gt.textureFormatReadable(It))throw new Error("THREE.WebGLRenderer.readRenderTargetPixelsAsync: renderTarget is not in RGBA or implementation defined format.");if(!gt.textureTypeReadable(Ot))throw new Error("THREE.WebGLRenderer.readRenderTargetPixelsAsync: renderTarget is not in UnsignedByteType or implementation defined type.");const xt=Q.createBuffer();Q.bindBuffer(Q.PIXEL_PACK_BUFFER,xt),Q.bufferData(Q.PIXEL_PACK_BUFFER,Ue.byteLength,Q.STREAM_READ),Q.readPixels(le,ge,ve,de,$t.convert(It),$t.convert(Ot),0);const Yt=E!==null?X.get(E).__webglFramebuffer:null;ot.bindFramebuffer(Q.FRAMEBUFFER,Yt);const dn=Q.fenceSync(Q.SYNC_GPU_COMMANDS_COMPLETE,0);return Q.flush(),await xve(Q,dn,4),Q.bindBuffer(Q.PIXEL_PACK_BUFFER,xt),Q.getBufferSubData(Q.PIXEL_PACK_BUFFER,0,Ue),Q.deleteBuffer(xt),Q.deleteSync(dn),Ue}else throw new Error("THREE.WebGLRenderer.readRenderTargetPixelsAsync: requested read bounds are out of range.")},this.copyFramebufferToTexture=function(V,le=null,ge=0){const ve=Math.pow(2,-ge),de=Math.floor(V.image.width*ve),Ue=Math.floor(V.image.height*ve),qe=le!==null?le.x:0,nt=le!==null?le.y:0;I.setTexture2D(V,0),Q.copyTexSubImage2D(Q.TEXTURE_2D,ge,0,0,qe,nt,de,Ue),ot.unbindTexture()};const wC=Q.createFramebuffer(),SC=Q.createFramebuffer();this.copyTextureToTexture=function(V,le,ge=null,ve=null,de=0,Ue=null){Ue===null&&(de!==0?(Ja("WebGLRenderer: copyTextureToTexture function signature has changed to support src and dst mipmap levels."),Ue=de,de=0):Ue=0);let qe,nt,at,It,Ot,xt,Yt,dn,cr;const nr=V.isCompressedTexture?V.mipmaps[Ue]:V.image;if(ge!==null)qe=ge.max.x-ge.min.x,nt=ge.max.y-ge.min.y,at=ge.isBox3?ge.max.z-ge.min.z:1,It=ge.min.x,Ot=ge.min.y,xt=ge.isBox3?ge.min.z:0;else{const Gi=Math.pow(2,-de);qe=Math.floor(nr.width*Gi),nt=Math.floor(nr.height*Gi),V.isDataArrayTexture?at=nr.depth:V.isData3DTexture?at=Math.floor(nr.depth*Gi):at=1,It=0,Ot=0,xt=0}ve!==null?(Yt=ve.x,dn=ve.y,cr=ve.z):(Yt=0,dn=0,cr=0);const ln=$t.convert(le.format),Et=$t.convert(le.type);let ei;le.isData3DTexture?(I.setTexture3D(le,0),ei=Q.TEXTURE_3D):le.isDataArrayTexture||le.isCompressedArrayTexture?(I.setTexture2DArray(le,0),ei=Q.TEXTURE_2D_ARRAY):(I.setTexture2D(le,0),ei=Q.TEXTURE_2D),Q.pixelStorei(Q.UNPACK_FLIP_Y_WEBGL,le.flipY),Q.pixelStorei(Q.UNPACK_PREMULTIPLY_ALPHA_WEBGL,le.premultiplyAlpha),Q.pixelStorei(Q.UNPACK_ALIGNMENT,le.unpackAlignment);const pn=Q.getParameter(Q.UNPACK_ROW_LENGTH),zs=Q.getParameter(Q.UNPACK_IMAGE_HEIGHT),Bn=Q.getParameter(Q.UNPACK_SKIP_PIXELS),Ri=Q.getParameter(Q.UNPACK_SKIP_ROWS),Jh=Q.getParameter(Q.UNPACK_SKIP_IMAGES);Q.pixelStorei(Q.UNPACK_ROW_LENGTH,nr.width),Q.pixelStorei(Q.UNPACK_IMAGE_HEIGHT,nr.height),Q.pixelStorei(Q.UNPACK_SKIP_PIXELS,It),Q.pixelStorei(Q.UNPACK_SKIP_ROWS,Ot),Q.pixelStorei(Q.UNPACK_SKIP_IMAGES,xt);const On=V.isDataArrayTexture||V.isData3DTexture,us=le.isDataArrayTexture||le.isData3DTexture;if(V.isDepthTexture){const Gi=X.get(V),Lr=X.get(le),ti=X.get(Gi.__renderTarget),$d=X.get(Lr.__renderTarget);ot.bindFramebuffer(Q.READ_FRAMEBUFFER,ti.__webglFramebuffer),ot.bindFramebuffer(Q.DRAW_FRAMEBUFFER,$d.__webglFramebuffer);for(let Yl=0;Yl<at;Yl++)On&&(Q.framebufferTextureLayer(Q.READ_FRAMEBUFFER,Q.COLOR_ATTACHMENT0,X.get(V).__webglTexture,de,xt+Yl),Q.framebufferTextureLayer(Q.DRAW_FRAMEBUFFER,Q.COLOR_ATTACHMENT0,X.get(le).__webglTexture,Ue,cr+Yl)),Q.blitFramebuffer(It,Ot,qe,nt,Yt,dn,qe,nt,Q.DEPTH_BUFFER_BIT,Q.NEAREST);ot.bindFramebuffer(Q.READ_FRAMEBUFFER,null),ot.bindFramebuffer(Q.DRAW_FRAMEBUFFER,null)}else if(de!==0||V.isRenderTargetTexture||X.has(V)){const Gi=X.get(V),Lr=X.get(le);ot.bindFramebuffer(Q.READ_FRAMEBUFFER,wC),ot.bindFramebuffer(Q.DRAW_FRAMEBUFFER,SC);for(let ti=0;ti<at;ti++)On?Q.framebufferTextureLayer(Q.READ_FRAMEBUFFER,Q.COLOR_ATTACHMENT0,Gi.__webglTexture,de,xt+ti):Q.framebufferTexture2D(Q.READ_FRAMEBUFFER,Q.COLOR_ATTACHMENT0,Q.TEXTURE_2D,Gi.__webglTexture,de),us?Q.framebufferTextureLayer(Q.DRAW_FRAMEBUFFER,Q.COLOR_ATTACHMENT0,Lr.__webglTexture,Ue,cr+ti):Q.framebufferTexture2D(Q.DRAW_FRAMEBUFFER,Q.COLOR_ATTACHMENT0,Q.TEXTURE_2D,Lr.__webglTexture,Ue),de!==0?Q.blitFramebuffer(It,Ot,qe,nt,Yt,dn,qe,nt,Q.COLOR_BUFFER_BIT,Q.NEAREST):us?Q.copyTexSubImage3D(ei,Ue,Yt,dn,cr+ti,It,Ot,qe,nt):Q.copyTexSubImage2D(ei,Ue,Yt,dn,It,Ot,qe,nt);ot.bindFramebuffer(Q.READ_FRAMEBUFFER,null),ot.bindFramebuffer(Q.DRAW_FRAMEBUFFER,null)}else us?V.isDataTexture||V.isData3DTexture?Q.texSubImage3D(ei,Ue,Yt,dn,cr,qe,nt,at,ln,Et,nr.data):le.isCompressedArrayTexture?Q.compressedTexSubImage3D(ei,Ue,Yt,dn,cr,qe,nt,at,ln,nr.data):Q.texSubImage3D(ei,Ue,Yt,dn,cr,qe,nt,at,ln,Et,nr):V.isDataTexture?Q.texSubImage2D(Q.TEXTURE_2D,Ue,Yt,dn,qe,nt,ln,Et,nr.data):V.isCompressedTexture?Q.compressedTexSubImage2D(Q.TEXTURE_2D,Ue,Yt,dn,nr.width,nr.height,ln,nr.data):Q.texSubImage2D(Q.TEXTURE_2D,Ue,Yt,dn,qe,nt,ln,Et,nr);Q.pixelStorei(Q.UNPACK_ROW_LENGTH,pn),Q.pixelStorei(Q.UNPACK_IMAGE_HEIGHT,zs),Q.pixelStorei(Q.UNPACK_SKIP_PIXELS,Bn),Q.pixelStorei(Q.UNPACK_SKIP_ROWS,Ri),Q.pixelStorei(Q.UNPACK_SKIP_IMAGES,Jh),Ue===0&&le.generateMipmaps&&Q.generateMipmap(ei),ot.unbindTexture()},this.copyTextureToTexture3D=function(V,le,ge=null,ve=null,de=0){return Ja('WebGLRenderer: copyTextureToTexture3D function has been deprecated. Use "copyTextureToTexture" instead.'),this.copyTextureToTexture(V,le,ge,ve,de)},this.initRenderTarget=function(V){X.get(V).__webglFramebuffer===void 0&&I.setupRenderTarget(V)},this.initTexture=function(V){V.isCubeTexture?I.setTextureCube(V,0):V.isData3DTexture?I.setTexture3D(V,0):V.isDataArrayTexture||V.isCompressedArrayTexture?I.setTexture2DArray(V,0):I.setTexture2D(V,0),ot.unbindTexture()},this.resetState=function(){S=0,T=0,E=null,ot.reset(),fn.reset()},typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}get coordinateSystem(){return Ps}get outputColorSpace(){return this._outputColorSpace}set outputColorSpace(e){this._outputColorSpace=e;const n=this.getContext();n.drawingBufferColorSpace=Qt._getDrawingBufferColorSpace(e),n.unpackColorSpace=Qt._getUnpackColorSpace()}}let Pr=class{static roundNumber(e,n){const i=Math.pow(10,n);return Math.round(e*i)/i}static sample(e){return e[Math.floor(Math.random()*e.length)]}static distanceToSquared(e,n){var i=e.x-n.x,s=e.y-n.y,o=e.z-n.z;return i*i+s*s+o*o}static isPointInPoly(e,n){for(var i=!1,s=-1,o=e.length,a=o-1;++s<o;a=s)(e[s].z<=n.z&&n.z<e[a].z||e[a].z<=n.z&&n.z<e[s].z)&&n.x<(e[a].x-e[s].x)*(n.z-e[s].z)/(e[a].z-e[s].z)+e[s].x&&(i=!i);return i}static isVectorInPolygon(e,n,i){var s=1e5,o=-1e5,a=[];return n.vertexIds.forEach(l=>{s=Math.min(i[l].y,s),o=Math.max(i[l].y,o),a.push(i[l])}),!!(e.y<o+.5&&e.y>s-.5&&this.isPointInPoly(a,e))}static triarea2(e,n,i){return(i.x-e.x)*(n.z-e.z)-(n.x-e.x)*(i.z-e.z)}static vequal(e,n){return this.distanceToSquared(e,n)<1e-5}static mergeVertices(e,n=1e-4){n=Math.max(n,Number.EPSILON);for(var i={},s=e.getIndex(),o=e.getAttribute("position"),a=s?s.count:o.count,l=0,c=[],u=[],h=Math.log10(1/n),f=Math.pow(10,h),d=0;d<a;d++){var p=s?s.getX(d):d,m="";m+=~~(o.getX(p)*f)+",",m+=~~(o.getY(p)*f)+",",(m+=~~(o.getZ(p)*f)+",")in i?c.push(i[m]):(u.push(o.getX(p)),u.push(o.getY(p)),u.push(o.getZ(p)),i[m]=l,c.push(l),l++)}const g=new hi(new Float32Array(u),o.itemSize,o.normalized),v=new ji;return v.setAttribute("position",g),v.setIndex(c),v}},ySe=class{constructor(e){this.content=[],this.scoreFunction=e}push(e){this.content.push(e),this.sinkDown(this.content.length-1)}pop(){const e=this.content[0],n=this.content.pop();return this.content.length>0&&(this.content[0]=n,this.bubbleUp(0)),e}remove(e){const n=this.content.indexOf(e),i=this.content.pop();n!==this.content.length-1&&(this.content[n]=i,this.scoreFunction(i)<this.scoreFunction(e)?this.sinkDown(n):this.bubbleUp(n))}size(){return this.content.length}rescoreElement(e){this.sinkDown(this.content.indexOf(e))}sinkDown(e){const n=this.content[e];for(;e>0;){const i=(e+1>>1)-1,s=this.content[i];if(!(this.scoreFunction(n)<this.scoreFunction(s)))break;this.content[i]=n,this.content[e]=s,e=i}}bubbleUp(e){const n=this.content.length,i=this.content[e],s=this.scoreFunction(i);for(;;){const o=e+1<<1,a=o-1;let l,c=null;if(a<n&&(l=this.scoreFunction(this.content[a]),l<s&&(c=a)),o<n&&this.scoreFunction(this.content[o])<(c===null?s:l)&&(c=o),c===null)break;this.content[e]=this.content[c],this.content[c]=i,e=c}}},vSe=class{constructor(){this.portals=[]}push(e,n){n===void 0&&(n=e),this.portals.push({left:e,right:n})}stringPull(){const e=this.portals,n=[];let i,s,o,a=0,l=0,c=0;i=e[0].left,s=e[0].left,o=e[0].right,n.push(i);for(let u=1;u<e.length;u++){const h=e[u].left,f=e[u].right;if(Pr.triarea2(i,o,f)<=0){if(!(Pr.vequal(i,o)||Pr.triarea2(i,s,f)>0)){n.push(s),i=s,a=l,s=i,o=i,l=a,c=a,u=a;continue}o=f,c=u}if(Pr.triarea2(i,s,h)>=0){if(!(Pr.vequal(i,s)||Pr.triarea2(i,o,h)<0)){n.push(o),i=o,a=c,s=i,o=i,l=a,c=a,u=a;continue}s=h,l=u}}return n.length!==0&&Pr.vequal(n[n.length-1],e[e.length-1].left)||n.push(e[e.length-1].left),this.path=n,n}},XO=class{constructor(){this.zones={}}static createZone(e,n=1e-4){return(class{static buildZone(i,s){const o=this._buildNavigationMesh(i,s),a={};o.vertices.forEach(c=>{c.x=Pr.roundNumber(c.x,2),c.y=Pr.roundNumber(c.y,2),c.z=Pr.roundNumber(c.z,2)}),a.vertices=o.vertices;const l=this._buildPolygonGroups(o);return a.groups=new Array(l.length),l.forEach((c,u)=>{const h=new Map;c.forEach((d,p)=>{h.set(d,p)});const f=new Array(c.length);c.forEach((d,p)=>{const m=[];d.neighbours.forEach(y=>m.push(h.get(y)));const g=[];d.neighbours.forEach(y=>g.push(this._getSharedVerticesInOrder(d,y)));const v=new K(0,0,0);v.add(a.vertices[d.vertexIds[0]]),v.add(a.vertices[d.vertexIds[1]]),v.add(a.vertices[d.vertexIds[2]]),v.divideScalar(3),v.x=Pr.roundNumber(v.x,2),v.y=Pr.roundNumber(v.y,2),v.z=Pr.roundNumber(v.z,2),f[p]={id:p,neighbours:m,vertexIds:d.vertexIds,centroid:v,portals:g}}),a.groups[u]=f}),a}static _buildNavigationMesh(i,s){return i=Pr.mergeVertices(i,s),this._buildPolygonsFromGeometry(i)}static _spreadGroupId(i){let s=new Set([i]);for(;s.size>0;){const o=s;s=new Set,o.forEach(a=>{a.group=i.group,a.neighbours.forEach(l=>{l.group===void 0&&s.add(l)})})}}static _buildPolygonGroups(i){const s=[];return i.polygons.forEach(o=>{o.group!==void 0?s[o.group].push(o):(o.group=s.length,this._spreadGroupId(o),s.push([o]))}),s}static _buildPolygonNeighbours(i,s){const o=new Set,a=s[i.vertexIds[1]],l=s[i.vertexIds[2]];return s[i.vertexIds[0]].forEach(c=>{c!==i&&(a.includes(c)||l.includes(c))&&o.add(c)}),a.forEach(c=>{c!==i&&l.includes(c)&&o.add(c)}),o}static _buildPolygonsFromGeometry(i){const s=[],o=[],a=i.attributes.position,l=i.index,c=[];for(let u=0;u<a.count;u++)o.push(new K().fromBufferAttribute(a,u)),c[u]=[];for(let u=0;u<i.index.count;u+=3){const h=l.getX(u),f=l.getX(u+1),d=l.getX(u+2),p={vertexIds:[h,f,d],neighbours:null};s.push(p),c[h].push(p),c[f].push(p),c[d].push(p)}return s.forEach(u=>{u.neighbours=this._buildPolygonNeighbours(u,c)}),{polygons:s,vertices:o}}static _getSharedVerticesInOrder(i,s){const o=i.vertexIds,a=o[0],l=o[1],c=o[2],u=s.vertexIds,h=u.includes(a),f=u.includes(l),d=u.includes(c);return h&&f&&d?Array.from(o):h&&f?[a,l]:f&&d?[l,c]:h&&d?[c,a]:(console.warn("Error processing navigation mesh neighbors; neighbors with <2 shared vertices found."),[])}}).buildZone(e,n)}setZoneData(e,n){this.zones[e]=n}getRandomNode(e,n,i,s){if(!this.zones[e])return new K;i=i||null,s=s||0;const o=[];return this.zones[e].groups[n].forEach(a=>{i&&s?Pr.distanceToSquared(i,a.centroid)<s*s&&o.push(a.centroid):o.push(a.centroid)}),Pr.sample(o)||new K}getClosestNode(e,n,i,s=!1){const o=this.zones[n].vertices;let a=null,l=1/0;return this.zones[n].groups[i].forEach(c=>{const u=Pr.distanceToSquared(c.centroid,e);u<l&&(!s||Pr.isVectorInPolygon(e,c,o))&&(a=c,l=u)}),a}findPath(e,n,i,s){const o=this.zones[i].groups[s],a=this.zones[i].vertices,l=this.getClosestNode(e,i,s,!0),c=this.getClosestNode(n,i,s,!0);if(!l||!c)return null;const u=(class{static init(p){for(let m=0;m<p.length;m++){const g=p[m];g.f=0,g.g=0,g.h=0,g.cost=1,g.visited=!1,g.closed=!1,g.parent=null}}static cleanUp(p){for(let m=0;m<p.length;m++){const g=p[m];delete g.f,delete g.g,delete g.h,delete g.cost,delete g.visited,delete g.closed,delete g.parent}}static heap(){return new ySe(function(p){return p.f})}static search(p,m,g){this.init(p);const v=this.heap();for(v.push(m);v.size()>0;){const y=v.pop();if(y===g){let b=y;const w=[];for(;b.parent;)w.push(b),b=b.parent;return this.cleanUp(w),w.reverse()}y.closed=!0;const x=this.neighbours(p,y);for(let b=0,w=x.length;b<w;b++){const _=x[b];if(_.closed)continue;const S=y.g+_.cost,T=_.visited;if(!T||S<_.g){if(_.visited=!0,_.parent=y,!_.centroid||!g.centroid)throw new Error("Unexpected state");_.h=_.h||this.heuristic(_.centroid,g.centroid),_.g=S,_.f=_.g+_.h,T?v.rescoreElement(_):v.push(_)}}}return[]}static heuristic(p,m){return Pr.distanceToSquared(p,m)}static neighbours(p,m){const g=[];for(let v=0;v<m.neighbours.length;v++)g.push(p[m.neighbours[v]]);return g}}).search(o,l,c),h=function(p,m){for(var g=0;g<p.neighbours.length;g++)if(p.neighbours[g]===m.id)return p.portals[g]},f=new vSe;f.push(e);for(let p=0;p<u.length;p++){const m=u[p],g=u[p+1];if(g){const v=h(m,g);f.push(a[v[0]],a[v[1]])}}f.push(n),f.stringPull();const d=f.path.map(p=>new K(p.x,p.y,p.z));return d.shift(),d}};XO.prototype.getGroup=function(){const r=new To;return function(e,n,i=!1){if(!this.zones[e])return null;let s=null,o=Math.pow(50,2);const a=this.zones[e];for(let l=0;l<a.groups.length;l++){const c=a.groups[l];for(const u of c){if(i&&(r.setFromCoplanarPoints(a.vertices[u.vertexIds[0]],a.vertices[u.vertexIds[1]],a.vertices[u.vertexIds[2]]),Math.abs(r.distanceToPoint(n))<.01)&&Pr.isPointInPoly([a.vertices[u.vertexIds[0]],a.vertices[u.vertexIds[1]],a.vertices[u.vertexIds[2]]],n))return l;const h=Pr.distanceToSquared(u.centroid,n);h<o&&(s=l,o=h)}}return s}}(),XO.prototype.clampStep=function(){const r=new K,e=new To,n=new ta,i=new K;let s,o,a=new K;return function(l,c,u,h,f,d){const p=this.zones[h].vertices,m=this.zones[h].groups[f],g=[u],v={};v[u.id]=0,s=void 0,a.set(0,0,0),o=1/0,e.setFromCoplanarPoints(p[u.vertexIds[0]],p[u.vertexIds[1]],p[u.vertexIds[2]]),e.projectPoint(c,r),i.copy(r);for(let y=g.pop();y;y=g.pop()){n.set(p[y.vertexIds[0]],p[y.vertexIds[1]],p[y.vertexIds[2]]),n.closestPointToPoint(i,r),r.distanceToSquared(i)<o&&(s=y,a.copy(r),o=r.distanceToSquared(i));const x=v[y.id];if(!(x>2))for(let b=0;b<y.neighbours.length;b++){const w=m[y.neighbours[b]];w.id in v||(g.push(w),v[w.id]=x+1)}}return d.copy(a),s}}();let xSe=class extends Mr{constructor(){super(),this._playerMarker=new Jn(new xd(.25,32,32),new As({color:15631215})),this._targetMarker=new Jn(new Dl(.3,.3,.3),new As({color:14469912})),this._nodeMarker=new Jn(new Dl(.1,.8,.1),new As({color:4417387})),this._stepMarker=new Jn(new Dl(.1,1,.1),new As({color:14472114})),this._pathMarker=new Mr,this._pathLineMaterial=new p_({color:41903,linewidth:2}),this._pathPointMaterial=new As({color:41903}),this._pathPointGeometry=new xd(.08),this._markers=[this._playerMarker,this._targetMarker,this._nodeMarker,this._stepMarker,this._pathMarker],this._markers.forEach(e=>{e.visible=!1,this.add(e)})}setPath(e){for(;this._pathMarker.children.length;)this._pathMarker.children[0].visible=!1,this._pathMarker.remove(this._pathMarker.children[0]);e=[this._playerMarker.position].concat(e);const n=new ji;n.setAttribute("position",new hi(new Float32Array(3*e.length),3));for(let i=0;i<e.length;i++)n.attributes.position.setXYZ(i,e[i].x,e[i].y+.2,e[i].z);this._pathMarker.add(new RY(n,this._pathLineMaterial));for(let i=0;i<e.length-1;i++){const s=new Jn(this._pathPointGeometry,this._pathPointMaterial);s.position.copy(e[i]),s.position.y+=.2,this._pathMarker.add(s)}return this._pathMarker.visible=!0,this}setPlayerPosition(e){return this._playerMarker.position.copy(e),this._playerMarker.visible=!0,this}setTargetPosition(e){return this._targetMarker.position.copy(e),this._targetMarker.visible=!0,this}setNodePosition(e){return this._nodeMarker.position.copy(e),this._nodeMarker.visible=!0,this}setStepPosition(e){return this._stepMarker.position.copy(e),this._stepMarker.visible=!0,this}reset(){for(;this._pathMarker.children.length;)this._pathMarker.children[0].visible=!1,this._pathMarker.remove(this._pathMarker.children[0]);return this._markers.forEach(e=>{e.visible=!1}),this}};const bSe=Object.freeze(Object.defineProperty({__proto__:null,Pathfinding:XO,PathfindingHelper:xSe},Symbol.toStringTag,{value:"Module"})),_Se=Pie(bSe),{Pathfinding:qY}=_Se,pv=new qY,mv="level";AFRAME.registerSystem("nav",{init:function(){this.navMesh=null,this.agents=new Set},setNavMeshGeometry:function(r){this.navMesh=new THREE.Mesh(r),pv.setZoneData(mv,qY.createZone(r)),Array.from(this.agents).forEach(e=>e.updateNavLocation())},getNavMesh:function(){return this.navMesh},addAgent:function(r){this.agents.add(r)},removeAgent:function(r){this.agents.delete(r)},getPath:function(r,e,n){return this.navMesh?pv.findPath(r,e,mv,n):null},getGroup:function(r){return this.navMesh?pv.getGroup(mv,r):null},getNode:function(r,e){return this.navMesh?pv.getClosestNode(r,mv,e,!0):null},clampStep:function(r,e,n,i,s){if(this.navMesh){if(!i)return s.copy(e),this.getNode(e,n)}else return s.copy(e),null;return pv.clampStep(r,e,i,mv,n,s)}});AFRAME.registerPrimitive("a-grid",{defaultComponents:{geometry:{primitive:"plane",width:75,height:75},rotation:{x:-90,y:0,z:0},material:{src:"url(https://cdn.jsdelivr.net/gh/donmccurdy/aframe-extras@v1.16.3/assets/grid.png)",repeat:"75 75"}},mappings:{width:"geometry.width",height:"geometry.height",src:"material.src"}});AFRAME.registerPrimitive("a-ocean",{defaultComponents:{ocean:{},rotation:{x:-90,y:0,z:0}},mappings:{width:"ocean.width",depth:"ocean.depth",density:"ocean.density",amplitude:"ocean.amplitude",amplitudeVariance:"ocean.amplitudeVariance",speed:"ocean.speed",speedVariance:"ocean.speedVariance",color:"ocean.color",opacity:"ocean.opacity"}});AFRAME.registerComponent("ocean",{schema:{width:{default:10,min:0},depth:{default:10,min:0},density:{default:10},amplitude:{default:.1},amplitudeVariance:{default:.3},speed:{default:1},speedVariance:{default:2},color:{default:"#7AD2F7",type:"color"},opacity:{default:.8}},play:function(){const r=this.el,e=this.data;let n=r.components.material;const i=new THREE.PlaneGeometry(e.width,e.depth,e.density,e.density);this.waves=[];const s=i.getAttribute("position");for(let o=0;o<s.count;o++)this.waves.push({z:s.getZ(o),ang:Math.random()*Math.PI*2,amp:e.amplitude+Math.random()*e.amplitudeVariance,speed:(e.speed+Math.random()*e.speedVariance)/1e3});n||(n={},n.material=new THREE.MeshPhongMaterial({color:e.color,transparent:e.opacity<1,opacity:e.opacity,flatShading:!0})),this.mesh=new THREE.Mesh(i,n.material),r.setObject3D("mesh",this.mesh)},remove:function(){this.el.removeObject3D("mesh")},tick:function(r,e){if(!e)return;const n=this.mesh.geometry.getAttribute("position");for(let i=0;i<n.count;i++){const s=this.waves[i],o=s.z+Math.sin(s.ang)*s.amp;n.setZ(i,o),s.ang+=s.speed*e}n.needsUpdate=!0}});AFRAME.registerPrimitive("a-tube",{defaultComponents:{tube:{}},mappings:{path:"tube.path",segments:"tube.segments",radius:"tube.radius","radial-segments":"tube.radialSegments",closed:"tube.closed"}});AFRAME.registerComponent("tube",{schema:{path:{default:[]},segments:{default:64},radius:{default:1},radialSegments:{default:8},closed:{default:!1}},init:function(){const r=this.el,e=this.data;let n=r.components.material;if(!e.path.length){console.error("[a-tube] `path` property expected but not found.");return}const i=new THREE.CatmullRomCurve3(e.path.map(function(o){return o=o.split(" "),new THREE.Vector3(Number(o[0]),Number(o[1]),Number(o[2]))})),s=new THREE.TubeGeometry(i,e.segments,e.radius,e.radialSegments,e.closed);n||(n={},n.material=new THREE.MeshPhongMaterial),this.mesh=new THREE.Mesh(s,n.material),this.el.setObject3D("mesh",this.mesh)},update:function(r){Object.keys(r).length&&(this.remove(),this.init())},remove:function(){this.mesh&&this.el.removeObject3D("mesh")}});function XY(r,e,n){var i,s=1;r==null&&(r=0),e==null&&(e=0),n==null&&(n=0);function o(){var a,l=i.length,c,u=0,h=0,f=0;for(a=0;a<l;++a)c=i[a],u+=c.x||0,h+=c.y||0,f+=c.z||0;for(u=(u/l-r)*s,h=(h/l-e)*s,f=(f/l-n)*s,a=0;a<l;++a)c=i[a],u&&(c.x-=u),h&&(c.y-=h),f&&(c.z-=f)}return o.initialize=function(a){i=a},o.x=function(a){return arguments.length?(r=+a,o):r},o.y=function(a){return arguments.length?(e=+a,o):e},o.z=function(a){return arguments.length?(n=+a,o):n},o.strength=function(a){return arguments.length?(s=+a,o):s},o}function wSe(r){const e=+this._x.call(null,r);return KY(this.cover(e),e,r)}function KY(r,e,n){if(isNaN(e))return r;var i,s=r._root,o={data:n},a=r._x0,l=r._x1,c,u,h,f,d;if(!s)return r._root=o,r;for(;s.length;)if((h=e>=(c=(a+l)/2))?a=c:l=c,i=s,!(s=s[f=+h]))return i[f]=o,r;if(u=+r._x.call(null,s.data),e===u)return o.next=s,i?i[f]=o:r._root=o,r;do i=i?i[f]=new Array(2):r._root=new Array(2),(h=e>=(c=(a+l)/2))?a=c:l=c;while((f=+h)==(d=+(u>=c)));return i[d]=s,i[f]=o,r}function SSe(r){Array.isArray(r)||(r=Array.from(r));const e=r.length,n=new Float64Array(e);let i=1/0,s=-1/0;for(let o=0,a;o<e;++o)isNaN(a=+this._x.call(null,r[o]))||(n[o]=a,a<i&&(i=a),a>s&&(s=a));if(i>s)return this;this.cover(i).cover(s);for(let o=0;o<e;++o)KY(this,n[o],r[o]);return this}function TSe(r){if(isNaN(r=+r))return this;var e=this._x0,n=this._x1;if(isNaN(e))n=(e=Math.floor(r))+1;else{for(var i=n-e||1,s=this._root,o,a;e>r||r>=n;)switch(a=+(r<e),o=new Array(2),o[a]=s,s=o,i*=2,a){case 0:n=e+i;break;case 1:e=n-i;break}this._root&&this._root.length&&(this._root=s)}return this._x0=e,this._x1=n,this}function ESe(){var r=[];return this.visit(function(e){if(!e.length)do r.push(e.data);while(e=e.next)}),r}function MSe(r){return arguments.length?this.cover(+r[0][0]).cover(+r[1][0]):isNaN(this._x0)?void 0:[[this._x0],[this._x1]]}function qc(r,e,n){this.node=r,this.x0=e,this.x1=n}function ASe(r,e){var n,i=this._x0,s,o,a=this._x1,l=[],c=this._root,u,h;for(c&&l.push(new qc(c,i,a)),e==null?e=1/0:(i=r-e,a=r+e);u=l.pop();)if(!(!(c=u.node)||(s=u.x0)>a||(o=u.x1)<i))if(c.length){var f=(s+o)/2;l.push(new qc(c[1],f,o),new qc(c[0],s,f)),(h=+(r>=f))&&(u=l[l.length-1],l[l.length-1]=l[l.length-1-h],l[l.length-1-h]=u)}else{var d=Math.abs(r-+this._x.call(null,c.data));d<e&&(e=d,i=r-d,a=r+d,n=c.data)}return n}function CSe(r){if(isNaN(c=+this._x.call(null,r)))return this;var e,n=this._root,i,s,o,a=this._x0,l=this._x1,c,u,h,f,d;if(!n)return this;if(n.length)for(;;){if((h=c>=(u=(a+l)/2))?a=u:l=u,e=n,!(n=n[f=+h]))return this;if(!n.length)break;e[f+1&1]&&(i=e,d=f)}for(;n.data!==r;)if(s=n,!(n=n.next))return this;return(o=n.next)&&delete n.next,s?(o?s.next=o:delete s.next,this):e?(o?e[f]=o:delete e[f],(n=e[0]||e[1])&&n===(e[1]||e[0])&&!n.length&&(i?i[d]=n:this._root=n),this):(this._root=o,this)}function PSe(r){for(var e=0,n=r.length;e<n;++e)this.remove(r[e]);return this}function RSe(){return this._root}function NSe(){var r=0;return this.visit(function(e){if(!e.length)do++r;while(e=e.next)}),r}function OSe(r){var e=[],n,i=this._root,s,o,a;for(i&&e.push(new qc(i,this._x0,this._x1));n=e.pop();)if(!r(i=n.node,o=n.x0,a=n.x1)&&i.length){var l=(o+a)/2;(s=i[1])&&e.push(new qc(s,l,a)),(s=i[0])&&e.push(new qc(s,o,l))}return this}function DSe(r){var e=[],n=[],i;for(this._root&&e.push(new qc(this._root,this._x0,this._x1));i=e.pop();){var s=i.node;if(s.length){var o,a=i.x0,l=i.x1,c=(a+l)/2;(o=s[0])&&e.push(new qc(o,a,c)),(o=s[1])&&e.push(new qc(o,c,l))}n.push(i)}for(;i=n.pop();)r(i.node,i.x0,i.x1);return this}function kSe(r){return r[0]}function ISe(r){return arguments.length?(this._x=r,this):this._x}function YY(r,e){var n=new GF(e??kSe,NaN,NaN);return r==null?n:n.addAll(r)}function GF(r,e,n){this._x=r,this._x0=e,this._x1=n,this._root=void 0}function c4(r){for(var e={data:r.data},n=e;r=r.next;)n=n.next={data:r.data};return e}var lo=YY.prototype=GF.prototype;lo.copy=function(){var r=new GF(this._x,this._x0,this._x1),e=this._root,n,i;if(!e)return r;if(!e.length)return r._root=c4(e),r;for(n=[{source:e,target:r._root=new Array(2)}];e=n.pop();)for(var s=0;s<2;++s)(i=e.source[s])&&(i.length?n.push({source:i,target:e.target[s]=new Array(2)}):e.target[s]=c4(i));return r};lo.add=wSe;lo.addAll=SSe;lo.cover=TSe;lo.data=ESe;lo.extent=MSe;lo.find=ASe;lo.remove=CSe;lo.removeAll=PSe;lo.root=RSe;lo.size=NSe;lo.visit=OSe;lo.visitAfter=DSe;lo.x=ISe;function LSe(r){const e=+this._x.call(null,r),n=+this._y.call(null,r);return ZY(this.cover(e,n),e,n,r)}function ZY(r,e,n,i){if(isNaN(e)||isNaN(n))return r;var s,o=r._root,a={data:i},l=r._x0,c=r._y0,u=r._x1,h=r._y1,f,d,p,m,g,v,y,x;if(!o)return r._root=a,r;for(;o.length;)if((g=e>=(f=(l+u)/2))?l=f:u=f,(v=n>=(d=(c+h)/2))?c=d:h=d,s=o,!(o=o[y=v<<1|g]))return s[y]=a,r;if(p=+r._x.call(null,o.data),m=+r._y.call(null,o.data),e===p&&n===m)return a.next=o,s?s[y]=a:r._root=a,r;do s=s?s[y]=new Array(4):r._root=new Array(4),(g=e>=(f=(l+u)/2))?l=f:u=f,(v=n>=(d=(c+h)/2))?c=d:h=d;while((y=v<<1|g)===(x=(m>=d)<<1|p>=f));return s[x]=o,s[y]=a,r}function FSe(r){var e,n,i=r.length,s,o,a=new Array(i),l=new Array(i),c=1/0,u=1/0,h=-1/0,f=-1/0;for(n=0;n<i;++n)isNaN(s=+this._x.call(null,e=r[n]))||isNaN(o=+this._y.call(null,e))||(a[n]=s,l[n]=o,s<c&&(c=s),s>h&&(h=s),o<u&&(u=o),o>f&&(f=o));if(c>h||u>f)return this;for(this.cover(c,u).cover(h,f),n=0;n<i;++n)ZY(this,a[n],l[n],r[n]);return this}function BSe(r,e){if(isNaN(r=+r)||isNaN(e=+e))return this;var n=this._x0,i=this._y0,s=this._x1,o=this._y1;if(isNaN(n))s=(n=Math.floor(r))+1,o=(i=Math.floor(e))+1;else{for(var a=s-n||1,l=this._root,c,u;n>r||r>=s||i>e||e>=o;)switch(u=(e<i)<<1|r<n,c=new Array(4),c[u]=l,l=c,a*=2,u){case 0:s=n+a,o=i+a;break;case 1:n=s-a,o=i+a;break;case 2:s=n+a,i=o-a;break;case 3:n=s-a,i=o-a;break}this._root&&this._root.length&&(this._root=l)}return this._x0=n,this._y0=i,this._x1=s,this._y1=o,this}function USe(){var r=[];return this.visit(function(e){if(!e.length)do r.push(e.data);while(e=e.next)}),r}function zSe(r){return arguments.length?this.cover(+r[0][0],+r[0][1]).cover(+r[1][0],+r[1][1]):isNaN(this._x0)?void 0:[[this._x0,this._y0],[this._x1,this._y1]]}function Cs(r,e,n,i,s){this.node=r,this.x0=e,this.y0=n,this.x1=i,this.y1=s}function $Se(r,e,n){var i,s=this._x0,o=this._y0,a,l,c,u,h=this._x1,f=this._y1,d=[],p=this._root,m,g;for(p&&d.push(new Cs(p,s,o,h,f)),n==null?n=1/0:(s=r-n,o=e-n,h=r+n,f=e+n,n*=n);m=d.pop();)if(!(!(p=m.node)||(a=m.x0)>h||(l=m.y0)>f||(c=m.x1)<s||(u=m.y1)<o))if(p.length){var v=(a+c)/2,y=(l+u)/2;d.push(new Cs(p[3],v,y,c,u),new Cs(p[2],a,y,v,u),new Cs(p[1],v,l,c,y),new Cs(p[0],a,l,v,y)),(g=(e>=y)<<1|r>=v)&&(m=d[d.length-1],d[d.length-1]=d[d.length-1-g],d[d.length-1-g]=m)}else{var x=r-+this._x.call(null,p.data),b=e-+this._y.call(null,p.data),w=x*x+b*b;if(w<n){var _=Math.sqrt(n=w);s=r-_,o=e-_,h=r+_,f=e+_,i=p.data}}return i}function jSe(r){if(isNaN(h=+this._x.call(null,r))||isNaN(f=+this._y.call(null,r)))return this;var e,n=this._root,i,s,o,a=this._x0,l=this._y0,c=this._x1,u=this._y1,h,f,d,p,m,g,v,y;if(!n)return this;if(n.length)for(;;){if((m=h>=(d=(a+c)/2))?a=d:c=d,(g=f>=(p=(l+u)/2))?l=p:u=p,e=n,!(n=n[v=g<<1|m]))return this;if(!n.length)break;(e[v+1&3]||e[v+2&3]||e[v+3&3])&&(i=e,y=v)}for(;n.data!==r;)if(s=n,!(n=n.next))return this;return(o=n.next)&&delete n.next,s?(o?s.next=o:delete s.next,this):e?(o?e[v]=o:delete e[v],(n=e[0]||e[1]||e[2]||e[3])&&n===(e[3]||e[2]||e[1]||e[0])&&!n.length&&(i?i[y]=n:this._root=n),this):(this._root=o,this)}function VSe(r){for(var e=0,n=r.length;e<n;++e)this.remove(r[e]);return this}function GSe(){return this._root}function HSe(){var r=0;return this.visit(function(e){if(!e.length)do++r;while(e=e.next)}),r}function WSe(r){var e=[],n,i=this._root,s,o,a,l,c;for(i&&e.push(new Cs(i,this._x0,this._y0,this._x1,this._y1));n=e.pop();)if(!r(i=n.node,o=n.x0,a=n.y0,l=n.x1,c=n.y1)&&i.length){var u=(o+l)/2,h=(a+c)/2;(s=i[3])&&e.push(new Cs(s,u,h,l,c)),(s=i[2])&&e.push(new Cs(s,o,h,u,c)),(s=i[1])&&e.push(new Cs(s,u,a,l,h)),(s=i[0])&&e.push(new Cs(s,o,a,u,h))}return this}function qSe(r){var e=[],n=[],i;for(this._root&&e.push(new Cs(this._root,this._x0,this._y0,this._x1,this._y1));i=e.pop();){var s=i.node;if(s.length){var o,a=i.x0,l=i.y0,c=i.x1,u=i.y1,h=(a+c)/2,f=(l+u)/2;(o=s[0])&&e.push(new Cs(o,a,l,h,f)),(o=s[1])&&e.push(new Cs(o,h,l,c,f)),(o=s[2])&&e.push(new Cs(o,a,f,h,u)),(o=s[3])&&e.push(new Cs(o,h,f,c,u))}n.push(i)}for(;i=n.pop();)r(i.node,i.x0,i.y0,i.x1,i.y1);return this}function XSe(r){return r[0]}function KSe(r){return arguments.length?(this._x=r,this):this._x}function YSe(r){return r[1]}function ZSe(r){return arguments.length?(this._y=r,this):this._y}function QY(r,e,n){var i=new HF(e??XSe,n??YSe,NaN,NaN,NaN,NaN);return r==null?i:i.addAll(r)}function HF(r,e,n,i,s,o){this._x=r,this._y=e,this._x0=n,this._y0=i,this._x1=s,this._y1=o,this._root=void 0}function u4(r){for(var e={data:r.data},n=e;r=r.next;)n=n.next={data:r.data};return e}var Bs=QY.prototype=HF.prototype;Bs.copy=function(){var r=new HF(this._x,this._y,this._x0,this._y0,this._x1,this._y1),e=this._root,n,i;if(!e)return r;if(!e.length)return r._root=u4(e),r;for(n=[{source:e,target:r._root=new Array(4)}];e=n.pop();)for(var s=0;s<4;++s)(i=e.source[s])&&(i.length?n.push({source:i,target:e.target[s]=new Array(4)}):e.target[s]=u4(i));return r};Bs.add=LSe;Bs.addAll=FSe;Bs.cover=BSe;Bs.data=USe;Bs.extent=zSe;Bs.find=$Se;Bs.remove=jSe;Bs.removeAll=VSe;Bs.root=GSe;Bs.size=HSe;Bs.visit=WSe;Bs.visitAfter=qSe;Bs.x=KSe;Bs.y=ZSe;function QSe(r){const e=+this._x.call(null,r),n=+this._y.call(null,r),i=+this._z.call(null,r);return JY(this.cover(e,n,i),e,n,i,r)}function JY(r,e,n,i,s){if(isNaN(e)||isNaN(n)||isNaN(i))return r;var o,a=r._root,l={data:s},c=r._x0,u=r._y0,h=r._z0,f=r._x1,d=r._y1,p=r._z1,m,g,v,y,x,b,w,_,S,T,E;if(!a)return r._root=l,r;for(;a.length;)if((w=e>=(m=(c+f)/2))?c=m:f=m,(_=n>=(g=(u+d)/2))?u=g:d=g,(S=i>=(v=(h+p)/2))?h=v:p=v,o=a,!(a=a[T=S<<2|_<<1|w]))return o[T]=l,r;if(y=+r._x.call(null,a.data),x=+r._y.call(null,a.data),b=+r._z.call(null,a.data),e===y&&n===x&&i===b)return l.next=a,o?o[T]=l:r._root=l,r;do o=o?o[T]=new Array(8):r._root=new Array(8),(w=e>=(m=(c+f)/2))?c=m:f=m,(_=n>=(g=(u+d)/2))?u=g:d=g,(S=i>=(v=(h+p)/2))?h=v:p=v;while((T=S<<2|_<<1|w)===(E=(b>=v)<<2|(x>=g)<<1|y>=m));return o[E]=a,o[T]=l,r}function JSe(r){Array.isArray(r)||(r=Array.from(r));const e=r.length,n=new Float64Array(e),i=new Float64Array(e),s=new Float64Array(e);let o=1/0,a=1/0,l=1/0,c=-1/0,u=-1/0,h=-1/0;for(let f=0,d,p,m,g;f<e;++f)isNaN(p=+this._x.call(null,d=r[f]))||isNaN(m=+this._y.call(null,d))||isNaN(g=+this._z.call(null,d))||(n[f]=p,i[f]=m,s[f]=g,p<o&&(o=p),p>c&&(c=p),m<a&&(a=m),m>u&&(u=m),g<l&&(l=g),g>h&&(h=g));if(o>c||a>u||l>h)return this;this.cover(o,a,l).cover(c,u,h);for(let f=0;f<e;++f)JY(this,n[f],i[f],s[f],r[f]);return this}function e1e(r,e,n){if(isNaN(r=+r)||isNaN(e=+e)||isNaN(n=+n))return this;var i=this._x0,s=this._y0,o=this._z0,a=this._x1,l=this._y1,c=this._z1;if(isNaN(i))a=(i=Math.floor(r))+1,l=(s=Math.floor(e))+1,c=(o=Math.floor(n))+1;else{for(var u=a-i||1,h=this._root,f,d;i>r||r>=a||s>e||e>=l||o>n||n>=c;)switch(d=(n<o)<<2|(e<s)<<1|r<i,f=new Array(8),f[d]=h,h=f,u*=2,d){case 0:a=i+u,l=s+u,c=o+u;break;case 1:i=a-u,l=s+u,c=o+u;break;case 2:a=i+u,s=l-u,c=o+u;break;case 3:i=a-u,s=l-u,c=o+u;break;case 4:a=i+u,l=s+u,o=c-u;break;case 5:i=a-u,l=s+u,o=c-u;break;case 6:a=i+u,s=l-u,o=c-u;break;case 7:i=a-u,s=l-u,o=c-u;break}this._root&&this._root.length&&(this._root=h)}return this._x0=i,this._y0=s,this._z0=o,this._x1=a,this._y1=l,this._z1=c,this}function t1e(){var r=[];return this.visit(function(e){if(!e.length)do r.push(e.data);while(e=e.next)}),r}function n1e(r){return arguments.length?this.cover(+r[0][0],+r[0][1],+r[0][2]).cover(+r[1][0],+r[1][1],+r[1][2]):isNaN(this._x0)?void 0:[[this._x0,this._y0,this._z0],[this._x1,this._y1,this._z1]]}function Dn(r,e,n,i,s,o,a){this.node=r,this.x0=e,this.y0=n,this.z0=i,this.x1=s,this.y1=o,this.z1=a}function r1e(r,e,n,i){var s,o=this._x0,a=this._y0,l=this._z0,c,u,h,f,d,p,m=this._x1,g=this._y1,v=this._z1,y=[],x=this._root,b,w;for(x&&y.push(new Dn(x,o,a,l,m,g,v)),i==null?i=1/0:(o=r-i,a=e-i,l=n-i,m=r+i,g=e+i,v=n+i,i*=i);b=y.pop();)if(!(!(x=b.node)||(c=b.x0)>m||(u=b.y0)>g||(h=b.z0)>v||(f=b.x1)<o||(d=b.y1)<a||(p=b.z1)<l))if(x.length){var _=(c+f)/2,S=(u+d)/2,T=(h+p)/2;y.push(new Dn(x[7],_,S,T,f,d,p),new Dn(x[6],c,S,T,_,d,p),new Dn(x[5],_,u,T,f,S,p),new Dn(x[4],c,u,T,_,S,p),new Dn(x[3],_,S,h,f,d,T),new Dn(x[2],c,S,h,_,d,T),new Dn(x[1],_,u,h,f,S,T),new Dn(x[0],c,u,h,_,S,T)),(w=(n>=T)<<2|(e>=S)<<1|r>=_)&&(b=y[y.length-1],y[y.length-1]=y[y.length-1-w],y[y.length-1-w]=b)}else{var E=r-+this._x.call(null,x.data),M=e-+this._y.call(null,x.data),A=n-+this._z.call(null,x.data),P=E*E+M*M+A*A;if(P<i){var D=Math.sqrt(i=P);o=r-D,a=e-D,l=n-D,m=r+D,g=e+D,v=n+D,s=x.data}}return s}const i1e=(r,e,n,i,s,o)=>Math.sqrt((r-i)**2+(e-s)**2+(n-o)**2);function s1e(r,e,n,i){const s=[],o=r-i,a=e-i,l=n-i,c=r+i,u=e+i,h=n+i;return this.visit((f,d,p,m,g,v,y)=>{if(!f.length)do{const x=f.data;i1e(r,e,n,this._x(x),this._y(x),this._z(x))<=i&&s.push(x)}while(f=f.next);return d>c||p>u||m>h||g<o||v<a||y<l}),s}function o1e(r){if(isNaN(d=+this._x.call(null,r))||isNaN(p=+this._y.call(null,r))||isNaN(m=+this._z.call(null,r)))return this;var e,n=this._root,i,s,o,a=this._x0,l=this._y0,c=this._z0,u=this._x1,h=this._y1,f=this._z1,d,p,m,g,v,y,x,b,w,_,S;if(!n)return this;if(n.length)for(;;){if((x=d>=(g=(a+u)/2))?a=g:u=g,(b=p>=(v=(l+h)/2))?l=v:h=v,(w=m>=(y=(c+f)/2))?c=y:f=y,e=n,!(n=n[_=w<<2|b<<1|x]))return this;if(!n.length)break;(e[_+1&7]||e[_+2&7]||e[_+3&7]||e[_+4&7]||e[_+5&7]||e[_+6&7]||e[_+7&7])&&(i=e,S=_)}for(;n.data!==r;)if(s=n,!(n=n.next))return this;return(o=n.next)&&delete n.next,s?(o?s.next=o:delete s.next,this):e?(o?e[_]=o:delete e[_],(n=e[0]||e[1]||e[2]||e[3]||e[4]||e[5]||e[6]||e[7])&&n===(e[7]||e[6]||e[5]||e[4]||e[3]||e[2]||e[1]||e[0])&&!n.length&&(i?i[S]=n:this._root=n),this):(this._root=o,this)}function a1e(r){for(var e=0,n=r.length;e<n;++e)this.remove(r[e]);return this}function l1e(){return this._root}function c1e(){var r=0;return this.visit(function(e){if(!e.length)do++r;while(e=e.next)}),r}function u1e(r){var e=[],n,i=this._root,s,o,a,l,c,u,h;for(i&&e.push(new Dn(i,this._x0,this._y0,this._z0,this._x1,this._y1,this._z1));n=e.pop();)if(!r(i=n.node,o=n.x0,a=n.y0,l=n.z0,c=n.x1,u=n.y1,h=n.z1)&&i.length){var f=(o+c)/2,d=(a+u)/2,p=(l+h)/2;(s=i[7])&&e.push(new Dn(s,f,d,p,c,u,h)),(s=i[6])&&e.push(new Dn(s,o,d,p,f,u,h)),(s=i[5])&&e.push(new Dn(s,f,a,p,c,d,h)),(s=i[4])&&e.push(new Dn(s,o,a,p,f,d,h)),(s=i[3])&&e.push(new Dn(s,f,d,l,c,u,p)),(s=i[2])&&e.push(new Dn(s,o,d,l,f,u,p)),(s=i[1])&&e.push(new Dn(s,f,a,l,c,d,p)),(s=i[0])&&e.push(new Dn(s,o,a,l,f,d,p))}return this}function h1e(r){var e=[],n=[],i;for(this._root&&e.push(new Dn(this._root,this._x0,this._y0,this._z0,this._x1,this._y1,this._z1));i=e.pop();){var s=i.node;if(s.length){var o,a=i.x0,l=i.y0,c=i.z0,u=i.x1,h=i.y1,f=i.z1,d=(a+u)/2,p=(l+h)/2,m=(c+f)/2;(o=s[0])&&e.push(new Dn(o,a,l,c,d,p,m)),(o=s[1])&&e.push(new Dn(o,d,l,c,u,p,m)),(o=s[2])&&e.push(new Dn(o,a,p,c,d,h,m)),(o=s[3])&&e.push(new Dn(o,d,p,c,u,h,m)),(o=s[4])&&e.push(new Dn(o,a,l,m,d,p,f)),(o=s[5])&&e.push(new Dn(o,d,l,m,u,p,f)),(o=s[6])&&e.push(new Dn(o,a,p,m,d,h,f)),(o=s[7])&&e.push(new Dn(o,d,p,m,u,h,f))}n.push(i)}for(;i=n.pop();)r(i.node,i.x0,i.y0,i.z0,i.x1,i.y1,i.z1);return this}function f1e(r){return r[0]}function d1e(r){return arguments.length?(this._x=r,this):this._x}function p1e(r){return r[1]}function m1e(r){return arguments.length?(this._y=r,this):this._y}function g1e(r){return r[2]}function y1e(r){return arguments.length?(this._z=r,this):this._z}function eZ(r,e,n,i){var s=new WF(e??f1e,n??p1e,i??g1e,NaN,NaN,NaN,NaN,NaN,NaN);return r==null?s:s.addAll(r)}function WF(r,e,n,i,s,o,a,l,c){this._x=r,this._y=e,this._z=n,this._x0=i,this._y0=s,this._z0=o,this._x1=a,this._y1=l,this._z1=c,this._root=void 0}function h4(r){for(var e={data:r.data},n=e;r=r.next;)n=n.next={data:r.data};return e}var Vi=eZ.prototype=WF.prototype;Vi.copy=function(){var r=new WF(this._x,this._y,this._z,this._x0,this._y0,this._z0,this._x1,this._y1,this._z1),e=this._root,n,i;if(!e)return r;if(!e.length)return r._root=h4(e),r;for(n=[{source:e,target:r._root=new Array(8)}];e=n.pop();)for(var s=0;s<8;++s)(i=e.source[s])&&(i.length?n.push({source:i,target:e.target[s]=new Array(8)}):e.target[s]=h4(i));return r};Vi.add=QSe;Vi.addAll=JSe;Vi.cover=e1e;Vi.data=t1e;Vi.extent=n1e;Vi.find=r1e;Vi.findAllWithinRadius=s1e;Vi.remove=o1e;Vi.removeAll=a1e;Vi.root=l1e;Vi.size=c1e;Vi.visit=u1e;Vi.visitAfter=h1e;Vi.x=d1e;Vi.y=m1e;Vi.z=y1e;function Ic(r){return function(){return r}}function Sc(r){return(r()-.5)*1e-6}function v1e(r){return r.index}function f4(r,e){var n=r.get(e);if(!n)throw new Error("node not found: "+e);return n}function tZ(r){var e=v1e,n=d,i,s=Ic(30),o,a,l,c,u,h,f=1;r==null&&(r=[]);function d(y){return 1/Math.min(c[y.source.index],c[y.target.index])}function p(y){for(var x=0,b=r.length;x<f;++x)for(var w=0,_,S,T,E=0,M=0,A=0,P,D;w<b;++w)_=r[w],S=_.source,T=_.target,E=T.x+T.vx-S.x-S.vx||Sc(h),l>1&&(M=T.y+T.vy-S.y-S.vy||Sc(h)),l>2&&(A=T.z+T.vz-S.z-S.vz||Sc(h)),P=Math.sqrt(E*E+M*M+A*A),P=(P-o[w])/P*y*i[w],E*=P,M*=P,A*=P,T.vx-=E*(D=u[w]),l>1&&(T.vy-=M*D),l>2&&(T.vz-=A*D),S.vx+=E*(D=1-D),l>1&&(S.vy+=M*D),l>2&&(S.vz+=A*D)}function m(){if(a){var y,x=a.length,b=r.length,w=new Map(a.map((S,T)=>[e(S,T,a),S])),_;for(y=0,c=new Array(x);y<b;++y)_=r[y],_.index=y,typeof _.source!="object"&&(_.source=f4(w,_.source)),typeof _.target!="object"&&(_.target=f4(w,_.target)),c[_.source.index]=(c[_.source.index]||0)+1,c[_.target.index]=(c[_.target.index]||0)+1;for(y=0,u=new Array(b);y<b;++y)_=r[y],u[y]=c[_.source.index]/(c[_.source.index]+c[_.target.index]);i=new Array(b),g(),o=new Array(b),v()}}function g(){if(a)for(var y=0,x=r.length;y<x;++y)i[y]=+n(r[y],y,r)}function v(){if(a)for(var y=0,x=r.length;y<x;++y)o[y]=+s(r[y],y,r)}return p.initialize=function(y,...x){a=y,h=x.find(b=>typeof b=="function")||Math.random,l=x.find(b=>[1,2,3].includes(b))||2,m()},p.links=function(y){return arguments.length?(r=y,m(),p):r},p.id=function(y){return arguments.length?(e=y,p):e},p.iterations=function(y){return arguments.length?(f=+y,p):f},p.strength=function(y){return arguments.length?(n=typeof y=="function"?y:Ic(+y),g(),p):n},p.distance=function(y){return arguments.length?(s=typeof y=="function"?y:Ic(+y),v(),p):s},p}var x1e={value:()=>{}};function v_(){for(var r=0,e=arguments.length,n={},i;r<e;++r){if(!(i=arguments[r]+"")||i in n||/[\s.]/.test(i))throw new Error("illegal type: "+i);n[i]=[]}return new O1(n)}function O1(r){this._=r}function b1e(r,e){return r.trim().split(/^|\s+/).map(function(n){var i="",s=n.indexOf(".");if(s>=0&&(i=n.slice(s+1),n=n.slice(0,s)),n&&!e.hasOwnProperty(n))throw new Error("unknown type: "+n);return{type:n,name:i}})}O1.prototype=v_.prototype={constructor:O1,on:function(r,e){var n=this._,i=b1e(r+"",n),s,o=-1,a=i.length;if(arguments.length<2){for(;++o<a;)if((s=(r=i[o]).type)&&(s=_1e(n[s],r.name)))return s;return}if(e!=null&&typeof e!="function")throw new Error("invalid callback: "+e);for(;++o<a;)if(s=(r=i[o]).type)n[s]=d4(n[s],r.name,e);else if(e==null)for(s in n)n[s]=d4(n[s],r.name,null);return this},copy:function(){var r={},e=this._;for(var n in e)r[n]=e[n].slice();return new O1(r)},call:function(r,e){if((s=arguments.length-2)>0)for(var n=new Array(s),i=0,s,o;i<s;++i)n[i]=arguments[i+2];if(!this._.hasOwnProperty(r))throw new Error("unknown type: "+r);for(o=this._[r],i=0,s=o.length;i<s;++i)o[i].value.apply(e,n)},apply:function(r,e,n){if(!this._.hasOwnProperty(r))throw new Error("unknown type: "+r);for(var i=this._[r],s=0,o=i.length;s<o;++s)i[s].value.apply(e,n)}};function _1e(r,e){for(var n=0,i=r.length,s;n<i;++n)if((s=r[n]).name===e)return s.value}function d4(r,e,n){for(var i=0,s=r.length;i<s;++i)if(r[i].name===e){r[i]=x1e,r=r.slice(0,i).concat(r.slice(i+1));break}return n!=null&&r.push({name:e,value:n}),r}var xg=0,i0=0,gv=0,nZ=1e3,GT,s0,HT=0,bd=0,nA=0,Kx=typeof performance=="object"&&performance.now?performance:Date,rZ=typeof window=="object"&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(r){setTimeout(r,17)};function qF(){return bd||(rZ(w1e),bd=Kx.now()+nA)}function w1e(){bd=0}function WT(){this._call=this._time=this._next=null}WT.prototype=XF.prototype={constructor:WT,restart:function(r,e,n){if(typeof r!="function")throw new TypeError("callback is not a function");n=(n==null?qF():+n)+(e==null?0:+e),!this._next&&s0!==this&&(s0?s0._next=this:GT=this,s0=this),this._call=r,this._time=n,KO()},stop:function(){this._call&&(this._call=null,this._time=1/0,KO())}};function XF(r,e,n){var i=new WT;return i.restart(r,e,n),i}function S1e(){qF(),++xg;for(var r=GT,e;r;)(e=bd-r._time)>=0&&r._call.call(void 0,e),r=r._next;--xg}function p4(){bd=(HT=Kx.now())+nA,xg=i0=0;try{S1e()}finally{xg=0,E1e(),bd=0}}function T1e(){var r=Kx.now(),e=r-HT;e>nZ&&(nA-=e,HT=r)}function E1e(){for(var r,e=GT,n,i=1/0;e;)e._call?(i>e._time&&(i=e._time),r=e,e=e._next):(n=e._next,e._next=null,e=r?r._next=n:GT=n);s0=r,KO(i)}function KO(r){if(!xg){i0&&(i0=clearTimeout(i0));var e=r-bd;e>24?(r<1/0&&(i0=setTimeout(p4,r-Kx.now()-nA)),gv&&(gv=clearInterval(gv))):(gv||(HT=Kx.now(),gv=setInterval(T1e,nZ)),xg=1,rZ(p4))}}function m4(r,e,n){var i=new WT;return e=e==null?0:+e,i.restart(s=>{i.stop(),r(s+e)},e,n),i}const M1e=1664525,A1e=1013904223,g4=4294967296;function C1e(){let r=1;return()=>(r=(M1e*r+A1e)%g4)/g4}var y4=3;function MR(r){return r.x}function v4(r){return r.y}function P1e(r){return r.z}var R1e=10,N1e=Math.PI*(3-Math.sqrt(5)),O1e=Math.PI*20/(9+Math.sqrt(221));function iZ(r,e){e=e||2;var n=Math.min(y4,Math.max(1,Math.round(e))),i,s=1,o=.001,a=1-Math.pow(o,1/300),l=0,c=.6,u=new Map,h=XF(p),f=v_("tick","end"),d=C1e();r==null&&(r=[]);function p(){m(),f.call("tick",i),s<o&&(h.stop(),f.call("end",i))}function m(y){var x,b=r.length,w;y===void 0&&(y=1);for(var _=0;_<y;++_)for(s+=(l-s)*a,u.forEach(function(S){S(s)}),x=0;x<b;++x)w=r[x],w.fx==null?w.x+=w.vx*=c:(w.x=w.fx,w.vx=0),n>1&&(w.fy==null?w.y+=w.vy*=c:(w.y=w.fy,w.vy=0)),n>2&&(w.fz==null?w.z+=w.vz*=c:(w.z=w.fz,w.vz=0));return i}function g(){for(var y=0,x=r.length,b;y<x;++y){if(b=r[y],b.index=y,b.fx!=null&&(b.x=b.fx),b.fy!=null&&(b.y=b.fy),b.fz!=null&&(b.z=b.fz),isNaN(b.x)||n>1&&isNaN(b.y)||n>2&&isNaN(b.z)){var w=R1e*(n>2?Math.cbrt(.5+y):n>1?Math.sqrt(.5+y):y),_=y*N1e,S=y*O1e;n===1?b.x=w:n===2?(b.x=w*Math.cos(_),b.y=w*Math.sin(_)):(b.x=w*Math.sin(_)*Math.cos(S),b.y=w*Math.cos(_),b.z=w*Math.sin(_)*Math.sin(S))}(isNaN(b.vx)||n>1&&isNaN(b.vy)||n>2&&isNaN(b.vz))&&(b.vx=0,n>1&&(b.vy=0),n>2&&(b.vz=0))}}function v(y){return y.initialize&&y.initialize(r,d,n),y}return g(),i={tick:m,restart:function(){return h.restart(p),i},stop:function(){return h.stop(),i},numDimensions:function(y){return arguments.length?(n=Math.min(y4,Math.max(1,Math.round(y))),u.forEach(v),i):n},nodes:function(y){return arguments.length?(r=y,g(),u.forEach(v),i):r},alpha:function(y){return arguments.length?(s=+y,i):s},alphaMin:function(y){return arguments.length?(o=+y,i):o},alphaDecay:function(y){return arguments.length?(a=+y,i):+a},alphaTarget:function(y){return arguments.length?(l=+y,i):l},velocityDecay:function(y){return arguments.length?(c=1-y,i):1-c},randomSource:function(y){return arguments.length?(d=y,u.forEach(v),i):d},force:function(y,x){return arguments.length>1?(x==null?u.delete(y):u.set(y,v(x)),i):u.get(y)},find:function(){var y=Array.prototype.slice.call(arguments),x=y.shift()||0,b=(n>1?y.shift():null)||0,w=(n>2?y.shift():null)||0,_=y.shift()||1/0,S=0,T=r.length,E,M,A,P,D,B;for(_*=_,S=0;S<T;++S)D=r[S],E=x-D.x,M=b-(D.y||0),A=w-(D.z||0),P=E*E+M*M+A*A,P<_&&(B=D,_=P);return B},on:function(y,x){return arguments.length>1?(f.on(y,x),i):f.on(y)}}}function sZ(){var r,e,n,i,s,o=Ic(-30),a,l=1,c=1/0,u=.81;function h(m){var g,v=r.length,y=(e===1?YY(r,MR):e===2?QY(r,MR,v4):e===3?eZ(r,MR,v4,P1e):null).visitAfter(d);for(s=m,g=0;g<v;++g)n=r[g],y.visit(p)}function f(){if(r){var m,g=r.length,v;for(a=new Array(g),m=0;m<g;++m)v=r[m],a[v.index]=+o(v,m,r)}}function d(m){var g=0,v,y,x=0,b,w,_,S,T=m.length;if(T){for(b=w=_=S=0;S<T;++S)(v=m[S])&&(y=Math.abs(v.value))&&(g+=v.value,x+=y,b+=y*(v.x||0),w+=y*(v.y||0),_+=y*(v.z||0));g*=Math.sqrt(4/T),m.x=b/x,e>1&&(m.y=w/x),e>2&&(m.z=_/x)}else{v=m,v.x=v.data.x,e>1&&(v.y=v.data.y),e>2&&(v.z=v.data.z);do g+=a[v.data.index];while(v=v.next)}m.value=g}function p(m,g,v,y,x){if(!m.value)return!0;var b=[v,y,x][e-1],w=m.x-n.x,_=e>1?m.y-n.y:0,S=e>2?m.z-n.z:0,T=b-g,E=w*w+_*_+S*S;if(T*T/u<E)return E<c&&(w===0&&(w=Sc(i),E+=w*w),e>1&&_===0&&(_=Sc(i),E+=_*_),e>2&&S===0&&(S=Sc(i),E+=S*S),E<l&&(E=Math.sqrt(l*E)),n.vx+=w*m.value*s/E,e>1&&(n.vy+=_*m.value*s/E),e>2&&(n.vz+=S*m.value*s/E)),!0;if(m.length||E>=c)return;(m.data!==n||m.next)&&(w===0&&(w=Sc(i),E+=w*w),e>1&&_===0&&(_=Sc(i),E+=_*_),e>2&&S===0&&(S=Sc(i),E+=S*S),E<l&&(E=Math.sqrt(l*E)));do m.data!==n&&(T=a[m.data.index]*s/E,n.vx+=w*T,e>1&&(n.vy+=_*T),e>2&&(n.vz+=S*T));while(m=m.next)}return h.initialize=function(m,...g){r=m,i=g.find(v=>typeof v=="function")||Math.random,e=g.find(v=>[1,2,3].includes(v))||2,f()},h.strength=function(m){return arguments.length?(o=typeof m=="function"?m:Ic(+m),f(),h):o},h.distanceMin=function(m){return arguments.length?(l=m*m,h):Math.sqrt(l)},h.distanceMax=function(m){return arguments.length?(c=m*m,h):Math.sqrt(c)},h.theta=function(m){return arguments.length?(u=m*m,h):Math.sqrt(u)},h}function oZ(r,e,n,i){var s,o,a=Ic(.1),l,c;typeof r!="function"&&(r=Ic(+r)),e==null&&(e=0),n==null&&(n=0),i==null&&(i=0);function u(f){for(var d=0,p=s.length;d<p;++d){var m=s[d],g=m.x-e||1e-6,v=(m.y||0)-n||1e-6,y=(m.z||0)-i||1e-6,x=Math.sqrt(g*g+v*v+y*y),b=(c[d]-x)*l[d]*f/x;m.vx+=g*b,o>1&&(m.vy+=v*b),o>2&&(m.vz+=y*b)}}function h(){if(s){var f,d=s.length;for(l=new Array(d),c=new Array(d),f=0;f<d;++f)c[f]=+r(s[f],f,s),l[f]=isNaN(c[f])?0:+a(s[f],f,s)}}return u.initialize=function(f,...d){s=f,o=d.find(p=>[1,2,3].includes(p))||2,h()},u.strength=function(f){return arguments.length?(a=typeof f=="function"?f:Ic(+f),h(),u):a},u.radius=function(f){return arguments.length?(r=typeof f=="function"?f:Ic(+f),h(),u):r},u.x=function(f){return arguments.length?(e=+f,u):e},u.y=function(f){return arguments.length?(n=+f,u):n},u.z=function(f){return arguments.length?(i=+f,u):i},u}var KF=function(e){k1e(e);var n=D1e(e);return e.on=n.on,e.off=n.off,e.fire=n.fire,e};function D1e(r){var e=Object.create(null);return{on:function(n,i,s){if(typeof i!="function")throw new Error("callback is expected to be a function");var o=e[n];return o||(o=e[n]=[]),o.push({callback:i,ctx:s}),r},off:function(n,i){var s=typeof n>"u";if(s)return e=Object.create(null),r;if(e[n]){var o=typeof i!="function";if(o)delete e[n];else for(var a=e[n],l=0;l<a.length;++l)a[l].callback===i&&a.splice(l,1)}return r},fire:function(n){var i=e[n];if(!i)return r;var s;arguments.length>1&&(s=Array.prototype.splice.call(arguments,1));for(var o=0;o<i.length;++o){var a=i[o];a.callback.apply(a.ctx,s)}return r}}}function k1e(r){if(!r)throw new Error("Eventify cannot use falsy object as events subject");for(var e=["on","fire","off"],n=0;n<e.length;++n)if(r.hasOwnProperty(e[n]))throw new Error("Subject cannot be eventified, since it already has property '"+e[n]+"'")}var I1e=F1e,L1e=KF;function F1e(r){if(r=r||{},"uniqueLinkId"in r&&(console.warn("ngraph.graph: Starting from version 0.14 `uniqueLinkId` is deprecated.\nUse `multigraph` option instead\n",`
`,`Note: there is also change in default behavior: From now on each graph
is considered to be not a multigraph by default (each edge is unique).`),r.multigraph=r.uniqueLinkId),r.multigraph===void 0&&(r.multigraph=!1),typeof Map!="function")throw new Error("ngraph.graph requires `Map` to be defined. Please polyfill it before using ngraph");var e=new Map,n=new Map,i={},s=0,o=r.multigraph?w:b,a=[],l=R,c=R,u=R,h=R,f={version:20,addNode:g,addLink:x,removeLink:E,removeNode:y,getNode:v,getNodeCount:_,getLinkCount:S,getEdgeCount:S,getLinksCount:S,getNodesCount:_,getLinks:T,forEachNode:G,forEachLinkedNode:B,forEachLink:D,beginUpdate:u,endUpdate:h,clear:P,hasLink:A,hasNode:v,getLink:A};return L1e(f),d(),f;function d(){var H=f.on;f.on=Y;function Y(){return f.beginUpdate=u=z,f.endUpdate=h=U,l=p,c=m,f.on=H,H.apply(f,arguments)}}function p(H,Y){a.push({link:H,changeType:Y})}function m(H,Y){a.push({node:H,changeType:Y})}function g(H,Y){if(H===void 0)throw new Error("Invalid node identifier");u();var ee=v(H);return ee?(ee.data=Y,c(ee,"update")):(ee=new B1e(H,Y),c(ee,"add")),e.set(H,ee),h(),ee}function v(H){return e.get(H)}function y(H){var Y=v(H);if(!Y)return!1;u();var ee=Y.links;return ee&&(ee.forEach(M),Y.links=null),e.delete(H),c(Y,"remove"),h(),!0}function x(H,Y,ee){u();var he=v(H)||g(H),q=v(Y)||g(Y),J=o(H,Y,ee),se=n.has(J.id);return n.set(J.id,J),x4(he,J),H!==Y&&x4(q,J),l(J,se?"update":"add"),h(),J}function b(H,Y,ee){var he=gS(H,Y),q=n.get(he);return q?(q.data=ee,q):new b4(H,Y,ee,he)}function w(H,Y,ee){var he=gS(H,Y),q=i.hasOwnProperty(he);if(q||A(H,Y)){q||(i[he]=0);var J="@"+ ++i[he];he=gS(H+J,Y+J)}return new b4(H,Y,ee,he)}function _(){return e.size}function S(){return n.size}function T(H){var Y=v(H);return Y?Y.links:null}function E(H,Y){return Y!==void 0&&(H=A(H,Y)),M(H)}function M(H){if(!H||!n.get(H.id))return!1;u(),n.delete(H.id);var Y=v(H.fromId),ee=v(H.toId);return Y&&Y.links.delete(H),ee&&ee.links.delete(H),l(H,"remove"),h(),!0}function A(H,Y){if(!(H===void 0||Y===void 0))return n.get(gS(H,Y))}function P(){u(),G(function(H){y(H.id)}),h()}function D(H){if(typeof H=="function")for(var Y=n.values(),ee=Y.next();!ee.done;){if(H(ee.value))return!0;ee=Y.next()}}function B(H,Y,ee){var he=v(H);if(he&&he.links&&typeof Y=="function")return ee?O(he.links,H,Y):C(he.links,H,Y)}function C(H,Y,ee){for(var he,q=H.values(),J=q.next();!J.done;){var se=J.value,oe=se.fromId===Y?se.toId:se.fromId;if(he=ee(e.get(oe),se),he)return!0;J=q.next()}}function O(H,Y,ee){for(var he,q=H.values(),J=q.next();!J.done;){var se=J.value;if(se.fromId===Y&&(he=ee(e.get(se.toId),se),he))return!0;J=q.next()}}function R(){}function z(){s+=1}function U(){s-=1,s===0&&a.length>0&&(f.fire("changed",a),a.length=0)}function G(H){if(typeof H!="function")throw new Error("Function is expected to iterate over graph nodes. You passed "+H);for(var Y=e.values(),ee=Y.next();!ee.done;){if(H(ee.value))return!0;ee=Y.next()}}}function B1e(r,e){this.id=r,this.links=null,this.data=e}function x4(r,e){r.links?r.links.add(e):r.links=new Set([e])}function b4(r,e,n,i){this.fromId=r,this.toId=e,this.data=n,this.id=i}function gS(r,e){return r.toString()+" "+e.toString()}const U1e=hn(I1e);var YF={exports:{}},x_={exports:{}},aZ=function(e){return e===0?"x":e===1?"y":e===2?"z":"c"+(e+1)};const z1e=aZ;var by=function(e){return n;function n(i,s){let o=s&&s.indent||0,a=s&&s.join!==void 0?s.join:`
`,l=Array(o+1).join(" "),c=[];for(let u=0;u<e;++u){let h=z1e(u),f=u===0?"":l;c.push(f+i.replace(/{var}/g,h))}return c.join(a)}};const lZ=by;x_.exports=$1e;x_.exports.generateCreateBodyFunctionBody=cZ;x_.exports.getVectorCode=hZ;x_.exports.getBodyCode=uZ;function $1e(r,e){let n=cZ(r,e),{Body:i}=new Function(n)();return i}function cZ(r,e){return`
${hZ(r,e)}
${uZ(r)}
return {Body: Body, Vector: Vector};
`}function uZ(r){let e=lZ(r),n=e("{var}",{join:", "});return`
function Body(${n}) {
  this.isPinned = false;
  this.pos = new Vector(${n});
  this.force = new Vector();
  this.velocity = new Vector();
  this.mass = 1;

  this.springCount = 0;
  this.springLength = 0;
}

Body.prototype.reset = function() {
  this.force.reset();
  this.springCount = 0;
  this.springLength = 0;
}

Body.prototype.setPosition = function (${n}) {
  ${e("this.pos.{var} = {var} || 0;",{indent:2})}
};`}function hZ(r,e){let n=lZ(r),i="";return e&&(i=`${n(`
   var v{var};
Object.defineProperty(this, '{var}', {
  set: function(v) { 
    if (!Number.isFinite(v)) throw new Error('Cannot set non-numbers to {var}');
    v{var} = v; 
  },
  get: function() { return v{var}; }
});`)}`),`function Vector(${n("{var}",{join:", "})}) {
  ${i}
    if (typeof arguments[0] === 'object') {
      // could be another vector
      let v = arguments[0];
      ${n('if (!Number.isFinite(v.{var})) throw new Error("Expected value is not a finite number at Vector constructor ({var})");',{indent:4})}
      ${n("this.{var} = v.{var};",{indent:4})}
    } else {
      ${n('this.{var} = typeof {var} === "number" ? {var} : 0;',{indent:4})}
    }
  }
  
  Vector.prototype.reset = function () {
    ${n("this.{var} = ",{join:""})}0;
  };`}var j1e=x_.exports,jh={exports:{}};const ZF=by,zu=aZ;jh.exports=V1e;jh.exports.generateQuadTreeFunctionBody=fZ;jh.exports.getInsertStackCode=yZ;jh.exports.getQuadNodeCode=gZ;jh.exports.isSamePosition=dZ;jh.exports.getChildBodyCode=mZ;jh.exports.setChildBodyCode=pZ;function V1e(r){let e=fZ(r);return new Function(e)()}function fZ(r){let e=ZF(r),n=Math.pow(2,r);return`
${yZ()}
${gZ(r)}
${dZ(r)}
${mZ(r)}
${pZ(r)}

function createQuadTree(options, random) {
  options = options || {};
  options.gravity = typeof options.gravity === 'number' ? options.gravity : -1;
  options.theta = typeof options.theta === 'number' ? options.theta : 0.8;

  var gravity = options.gravity;
  var updateQueue = [];
  var insertStack = new InsertStack();
  var theta = options.theta;

  var nodesCache = [];
  var currentInCache = 0;
  var root = newNode();

  return {
    insertBodies: insertBodies,

    /**
     * Gets root node if it is present
     */
    getRoot: function() {
      return root;
    },

    updateBodyForce: update,

    options: function(newOptions) {
      if (newOptions) {
        if (typeof newOptions.gravity === 'number') {
          gravity = newOptions.gravity;
        }
        if (typeof newOptions.theta === 'number') {
          theta = newOptions.theta;
        }

        return this;
      }

      return {
        gravity: gravity,
        theta: theta
      };
    }
  };

  function newNode() {
    // To avoid pressure on GC we reuse nodes.
    var node = nodesCache[currentInCache];
    if (node) {
${a("      node.")}
      node.body = null;
      node.mass = ${e("node.mass_{var} = ",{join:""})}0;
      ${e("node.min_{var} = node.max_{var} = ",{join:""})}0;
    } else {
      node = new QuadNode();
      nodesCache[currentInCache] = node;
    }

    ++currentInCache;
    return node;
  }

  function update(sourceBody) {
    var queue = updateQueue;
    var v;
    ${e("var d{var};",{indent:4})}
    var r; 
    ${e("var f{var} = 0;",{indent:4})}
    var queueLength = 1;
    var shiftIdx = 0;
    var pushIdx = 1;

    queue[0] = root;

    while (queueLength) {
      var node = queue[shiftIdx];
      var body = node.body;

      queueLength -= 1;
      shiftIdx += 1;
      var differentBody = (body !== sourceBody);
      if (body && differentBody) {
        // If the current node is a leaf node (and it is not source body),
        // calculate the force exerted by the current node on body, and add this
        // amount to body's net force.
        ${e("d{var} = body.pos.{var} - sourceBody.pos.{var};",{indent:8})}
        r = Math.sqrt(${e("d{var} * d{var}",{join:" + "})});

        if (r === 0) {
          // Poor man's protection against zero distance.
          ${e("d{var} = (random.nextDouble() - 0.5) / 50;",{indent:10})}
          r = Math.sqrt(${e("d{var} * d{var}",{join:" + "})});
        }

        // This is standard gravitation force calculation but we divide
        // by r^3 to save two operations when normalizing force vector.
        v = gravity * body.mass * sourceBody.mass / (r * r * r);
        ${e("f{var} += v * d{var};",{indent:8})}
      } else if (differentBody) {
        // Otherwise, calculate the ratio s / r,  where s is the width of the region
        // represented by the internal node, and r is the distance between the body
        // and the node's center-of-mass
        ${e("d{var} = node.mass_{var} / node.mass - sourceBody.pos.{var};",{indent:8})}
        r = Math.sqrt(${e("d{var} * d{var}",{join:" + "})});

        if (r === 0) {
          // Sorry about code duplication. I don't want to create many functions
          // right away. Just want to see performance first.
          ${e("d{var} = (random.nextDouble() - 0.5) / 50;",{indent:10})}
          r = Math.sqrt(${e("d{var} * d{var}",{join:" + "})});
        }
        // If s / r < , treat this internal node as a single body, and calculate the
        // force it exerts on sourceBody, and add this amount to sourceBody's net force.
        if ((node.max_${zu(0)} - node.min_${zu(0)}) / r < theta) {
          // in the if statement above we consider node's width only
          // because the region was made into square during tree creation.
          // Thus there is no difference between using width or height.
          v = gravity * node.mass * sourceBody.mass / (r * r * r);
          ${e("f{var} += v * d{var};",{indent:10})}
        } else {
          // Otherwise, run the procedure recursively on each of the current node's children.

          // I intentionally unfolded this loop, to save several CPU cycles.
${o()}
        }
      }
    }

    ${e("sourceBody.force.{var} += f{var};",{indent:4})}
  }

  function insertBodies(bodies) {
    ${e("var {var}min = Number.MAX_VALUE;",{indent:4})}
    ${e("var {var}max = Number.MIN_VALUE;",{indent:4})}
    var i = bodies.length;

    // To reduce quad tree depth we are looking for exact bounding box of all particles.
    while (i--) {
      var pos = bodies[i].pos;
      ${e("if (pos.{var} < {var}min) {var}min = pos.{var};",{indent:6})}
      ${e("if (pos.{var} > {var}max) {var}max = pos.{var};",{indent:6})}
    }

    // Makes the bounds square.
    var maxSideLength = -Infinity;
    ${e("if ({var}max - {var}min > maxSideLength) maxSideLength = {var}max - {var}min ;",{indent:4})}

    currentInCache = 0;
    root = newNode();
    ${e("root.min_{var} = {var}min;",{indent:4})}
    ${e("root.max_{var} = {var}min + maxSideLength;",{indent:4})}

    i = bodies.length - 1;
    if (i >= 0) {
      root.body = bodies[i];
    }
    while (i--) {
      insert(bodies[i], root);
    }
  }

  function insert(newBody) {
    insertStack.reset();
    insertStack.push(root, newBody);

    while (!insertStack.isEmpty()) {
      var stackItem = insertStack.pop();
      var node = stackItem.node;
      var body = stackItem.body;

      if (!node.body) {
        // This is internal node. Update the total mass of the node and center-of-mass.
        ${e("var {var} = body.pos.{var};",{indent:8})}
        node.mass += body.mass;
        ${e("node.mass_{var} += body.mass * {var};",{indent:8})}

        // Recursively insert the body in the appropriate quadrant.
        // But first find the appropriate quadrant.
        var quadIdx = 0; // Assume we are in the 0's quad.
        ${e("var min_{var} = node.min_{var};",{indent:8})}
        ${e("var max_{var} = (min_{var} + node.max_{var}) / 2;",{indent:8})}

${s(8)}

        var child = getChild(node, quadIdx);

        if (!child) {
          // The node is internal but this quadrant is not taken. Add
          // subnode to it.
          child = newNode();
          ${e("child.min_{var} = min_{var};",{indent:10})}
          ${e("child.max_{var} = max_{var};",{indent:10})}
          child.body = body;

          setChild(node, quadIdx, child);
        } else {
          // continue searching in this quadrant.
          insertStack.push(child, body);
        }
      } else {
        // We are trying to add to the leaf node.
        // We have to convert current leaf into internal node
        // and continue adding two nodes.
        var oldBody = node.body;
        node.body = null; // internal nodes do not cary bodies

        if (isSamePosition(oldBody.pos, body.pos)) {
          // Prevent infinite subdivision by bumping one node
          // anywhere in this quadrant
          var retriesCount = 3;
          do {
            var offset = random.nextDouble();
            ${e("var d{var} = (node.max_{var} - node.min_{var}) * offset;",{indent:12})}

            ${e("oldBody.pos.{var} = node.min_{var} + d{var};",{indent:12})}
            retriesCount -= 1;
            // Make sure we don't bump it out of the box. If we do, next iteration should fix it
          } while (retriesCount > 0 && isSamePosition(oldBody.pos, body.pos));

          if (retriesCount === 0 && isSamePosition(oldBody.pos, body.pos)) {
            // This is very bad, we ran out of precision.
            // if we do not return from the method we'll get into
            // infinite loop here. So we sacrifice correctness of layout, and keep the app running
            // Next layout iteration should get larger bounding box in the first step and fix this
            return;
          }
        }
        // Next iteration should subdivide node further.
        insertStack.push(node, oldBody);
        insertStack.push(node, body);
      }
    }
  }
}
return createQuadTree;

`;function s(l){let c=[],u=Array(l+1).join(" ");for(let h=0;h<r;++h)c.push(u+`if (${zu(h)} > max_${zu(h)}) {`),c.push(u+`  quadIdx = quadIdx + ${Math.pow(2,h)};`),c.push(u+`  min_${zu(h)} = max_${zu(h)};`),c.push(u+`  max_${zu(h)} = node.max_${zu(h)};`),c.push(u+"}");return c.join(`
`)}function o(){let l=Array(11).join(" "),c=[];for(let u=0;u<n;++u)c.push(l+`if (node.quad${u}) {`),c.push(l+`  queue[pushIdx] = node.quad${u};`),c.push(l+"  queueLength += 1;"),c.push(l+"  pushIdx += 1;"),c.push(l+"}");return c.join(`
`)}function a(l){let c=[];for(let u=0;u<n;++u)c.push(`${l}quad${u} = null;`);return c.join(`
`)}}function dZ(r){let e=ZF(r);return`
  function isSamePosition(point1, point2) {
    ${e("var d{var} = Math.abs(point1.{var} - point2.{var});",{indent:2})}
  
    return ${e("d{var} < 1e-8",{join:" && "})};
  }  
`}function pZ(r){var e=Math.pow(2,r);return`
function setChild(node, idx, child) {
  ${n()}
}`;function n(){let i=[];for(let s=0;s<e;++s){let o=s===0?"  ":"  else ";i.push(`${o}if (idx === ${s}) node.quad${s} = child;`)}return i.join(`
`)}}function mZ(r){return`function getChild(node, idx) {
${e()}
  return null;
}`;function e(){let n=[],i=Math.pow(2,r);for(let s=0;s<i;++s)n.push(`  if (idx === ${s}) return node.quad${s};`);return n.join(`
`)}}function gZ(r){let e=ZF(r),n=Math.pow(2,r);var i=`
function QuadNode() {
  // body stored inside this node. In quad tree only leaf nodes (by construction)
  // contain bodies:
  this.body = null;

  // Child nodes are stored in quads. Each quad is presented by number:
  // 0 | 1
  // -----
  // 2 | 3
${s("  this.")}

  // Total mass of current node
  this.mass = 0;

  // Center of mass coordinates
  ${e("this.mass_{var} = 0;",{indent:2})}

  // bounding box coordinates
  ${e("this.min_{var} = 0;",{indent:2})}
  ${e("this.max_{var} = 0;",{indent:2})}
}
`;return i;function s(o){let a=[];for(let l=0;l<n;++l)a.push(`${o}quad${l} = null;`);return a.join(`
`)}}function yZ(){return`
/**
 * Our implementation of QuadTree is non-recursive to avoid GC hit
 * This data structure represent stack of elements
 * which we are trying to insert into quad tree.
 */
function InsertStack () {
    this.stack = [];
    this.popIdx = 0;
}

InsertStack.prototype = {
    isEmpty: function() {
        return this.popIdx === 0;
    },
    push: function (node, body) {
        var item = this.stack[this.popIdx];
        if (!item) {
            // we are trying to avoid memory pressure: create new element
            // only when absolutely necessary
            this.stack[this.popIdx] = new InsertStackElement(node, body);
        } else {
            item.node = node;
            item.body = body;
        }
        ++this.popIdx;
    },
    pop: function () {
        if (this.popIdx > 0) {
            return this.stack[--this.popIdx];
        }
    },
    reset: function () {
        this.popIdx = 0;
    }
};

function InsertStackElement(node, body) {
    this.node = node; // QuadTree node
    this.body = body; // physical body which needs to be inserted to node
}
`}var G1e=jh.exports,QF={exports:{}};QF.exports=W1e;QF.exports.generateFunctionBody=vZ;const H1e=by;function W1e(r){let e=vZ(r);return new Function("bodies","settings","random",e)}function vZ(r){let e=H1e(r);return`
  var boundingBox = {
    ${e("min_{var}: 0, max_{var}: 0,",{indent:4})}
  };

  return {
    box: boundingBox,

    update: updateBoundingBox,

    reset: resetBoundingBox,

    getBestNewPosition: function (neighbors) {
      var ${e("base_{var} = 0",{join:", "})};

      if (neighbors.length) {
        for (var i = 0; i < neighbors.length; ++i) {
          let neighborPos = neighbors[i].pos;
          ${e("base_{var} += neighborPos.{var};",{indent:10})}
        }

        ${e("base_{var} /= neighbors.length;",{indent:8})}
      } else {
        ${e("base_{var} = (boundingBox.min_{var} + boundingBox.max_{var}) / 2;",{indent:8})}
      }

      var springLength = settings.springLength;
      return {
        ${e("{var}: base_{var} + (random.nextDouble() - 0.5) * springLength,",{indent:8})}
      };
    }
  };

  function updateBoundingBox() {
    var i = bodies.length;
    if (i === 0) return; // No bodies - no borders.

    ${e("var max_{var} = -Infinity;",{indent:4})}
    ${e("var min_{var} = Infinity;",{indent:4})}

    while(i--) {
      // this is O(n), it could be done faster with quadtree, if we check the root node bounds
      var bodyPos = bodies[i].pos;
      ${e("if (bodyPos.{var} < min_{var}) min_{var} = bodyPos.{var};",{indent:6})}
      ${e("if (bodyPos.{var} > max_{var}) max_{var} = bodyPos.{var};",{indent:6})}
    }

    ${e("boundingBox.min_{var} = min_{var};",{indent:4})}
    ${e("boundingBox.max_{var} = max_{var};",{indent:4})}
  }

  function resetBoundingBox() {
    ${e("boundingBox.min_{var} = boundingBox.max_{var} = 0;",{indent:4})}
  }
`}var q1e=QF.exports,JF={exports:{}};const X1e=by;JF.exports=K1e;JF.exports.generateCreateDragForceFunctionBody=xZ;function K1e(r){let e=xZ(r);return new Function("options",e)}function xZ(r){return`
  if (!Number.isFinite(options.dragCoefficient)) throw new Error('dragCoefficient is not a finite number');

  return {
    update: function(body) {
      ${X1e(r)("body.force.{var} -= options.dragCoefficient * body.velocity.{var};",{indent:6})}
    }
  };
`}var Y1e=JF.exports,e3={exports:{}};const Z1e=by;e3.exports=Q1e;e3.exports.generateCreateSpringForceFunctionBody=bZ;function Q1e(r){let e=bZ(r);return new Function("options","random",e)}function bZ(r){let e=Z1e(r);return`
  if (!Number.isFinite(options.springCoefficient)) throw new Error('Spring coefficient is not a number');
  if (!Number.isFinite(options.springLength)) throw new Error('Spring length is not a number');

  return {
    /**
     * Updates forces acting on a spring
     */
    update: function (spring) {
      var body1 = spring.from;
      var body2 = spring.to;
      var length = spring.length < 0 ? options.springLength : spring.length;
      ${e("var d{var} = body2.pos.{var} - body1.pos.{var};",{indent:6})}
      var r = Math.sqrt(${e("d{var} * d{var}",{join:" + "})});

      if (r === 0) {
        ${e("d{var} = (random.nextDouble() - 0.5) / 50;",{indent:8})}
        r = Math.sqrt(${e("d{var} * d{var}",{join:" + "})});
      }

      var d = r - length;
      var coefficient = ((spring.coefficient > 0) ? spring.coefficient : options.springCoefficient) * d / r;

      ${e("body1.force.{var} += coefficient * d{var}",{indent:6})};
      body1.springCount += 1;
      body1.springLength += r;

      ${e("body2.force.{var} -= coefficient * d{var}",{indent:6})};
      body2.springCount += 1;
      body2.springLength += r;
    }
  };
`}var J1e=e3.exports,t3={exports:{}};const eTe=by;t3.exports=tTe;t3.exports.generateIntegratorFunctionBody=_Z;function tTe(r){let e=_Z(r);return new Function("bodies","timeStep","adaptiveTimeStepWeight",e)}function _Z(r){let e=eTe(r);return`
  var length = bodies.length;
  if (length === 0) return 0;

  ${e("var d{var} = 0, t{var} = 0;",{indent:2})}

  for (var i = 0; i < length; ++i) {
    var body = bodies[i];
    if (body.isPinned) continue;

    if (adaptiveTimeStepWeight && body.springCount) {
      timeStep = (adaptiveTimeStepWeight * body.springLength/body.springCount);
    }

    var coeff = timeStep / body.mass;

    ${e("body.velocity.{var} += coeff * body.force.{var};",{indent:4})}
    ${e("var v{var} = body.velocity.{var};",{indent:4})}
    var v = Math.sqrt(${e("v{var} * v{var}",{join:" + "})});

    if (v > 1) {
      // We normalize it so that we move within timeStep range. 
      // for the case when v <= 1 - we let velocity to fade out.
      ${e("body.velocity.{var} = v{var} / v;",{indent:6})}
    }

    ${e("d{var} = timeStep * body.velocity.{var};",{indent:4})}

    ${e("body.pos.{var} += d{var};",{indent:4})}

    ${e("t{var} += Math.abs(d{var});",{indent:4})}
  }

  return (${e("t{var} * t{var}",{join:" + "})})/length;
`}var nTe=t3.exports,AR,_4;function rTe(){if(_4)return AR;_4=1,AR=r;function r(e,n,i,s){this.from=e,this.to=n,this.length=i,this.coefficient=s}return AR}var CR,w4;function iTe(){if(w4)return CR;w4=1,CR=r;function r(e,n){var i;if(e||(e={}),n){for(i in n)if(n.hasOwnProperty(i)){var s=e.hasOwnProperty(i),o=typeof n[i],a=!s||typeof e[i]!==o;a?e[i]=n[i]:o==="object"&&(e[i]=r(e[i],n[i]))}}return e}return CR}var yv={exports:{}},S4;function sTe(){if(S4)return yv.exports;S4=1,yv.exports=r,yv.exports.random=r,yv.exports.randomIterator=l;function r(c){var u=typeof c=="number"?c:+new Date;return new e(u)}function e(c){this.seed=c}e.prototype.next=a,e.prototype.nextDouble=o,e.prototype.uniform=o,e.prototype.gaussian=n,e.prototype.random=o;function n(){var c,u,h;do u=this.nextDouble()*2-1,h=this.nextDouble()*2-1,c=u*u+h*h;while(c>=1||c===0);return u*Math.sqrt(-2*Math.log(c)/c)}e.prototype.levy=i;function i(){var c=1.5,u=Math.pow(s(1+c)*Math.sin(Math.PI*c/2)/(s((1+c)/2)*c*Math.pow(2,(c-1)/2)),1/c);return this.gaussian()*u/Math.pow(Math.abs(this.gaussian()),1/c)}function s(c){return Math.sqrt(2*Math.PI/c)*Math.pow(1/Math.E*(c+1/(12*c-1/(10*c))),c)}function o(){var c=this.seed;return c=c+2127912214+(c<<12)&4294967295,c=(c^3345072700^c>>>19)&4294967295,c=c+374761393+(c<<5)&4294967295,c=(c+3550635116^c<<9)&4294967295,c=c+4251993797+(c<<3)&4294967295,c=(c^3042594569^c>>>16)&4294967295,this.seed=c,(c&268435455)/268435456}function a(c){return Math.floor(this.nextDouble()*c)}function l(c,u){var h=u||r();if(typeof h.next!="function")throw new Error("customRandom does not match expected API: next() function is missing");return{forEach:d,shuffle:f};function f(){var p,m,g;for(p=c.length-1;p>0;--p)m=h.next(p+1),g=c[m],c[m]=c[p],c[p]=g;return c}function d(p){var m,g,v;for(m=c.length-1;m>0;--m)g=h.next(m+1),v=c[g],c[g]=c[m],c[m]=v,p(v);c.length&&p(c[0])}}return yv.exports}var wZ=fTe,oTe=j1e,aTe=G1e,lTe=q1e,cTe=Y1e,uTe=J1e,hTe=nTe,T4={};function fTe(r){var e=rTe(),n=iTe(),i=KF;if(r){if(r.springCoeff!==void 0)throw new Error("springCoeff was renamed to springCoefficient");if(r.dragCoeff!==void 0)throw new Error("dragCoeff was renamed to dragCoefficient")}r=n(r,{springLength:10,springCoefficient:.8,gravity:-12,theta:.8,dragCoefficient:.9,timeStep:.5,adaptiveTimeStepWeight:0,dimensions:2,debug:!1});var s=T4[r.dimensions];if(!s){var o=r.dimensions;s={Body:oTe(o,r.debug),createQuadTree:aTe(o),createBounds:lTe(o),createDragForce:cTe(o),createSpringForce:uTe(o),integrate:hTe(o)},T4[o]=s}var a=s.Body,l=s.createQuadTree,c=s.createBounds,u=s.createDragForce,h=s.createSpringForce,f=s.integrate,d=O=>new a(O),p=sTe().random(42),m=[],g=[],v=l(r,p),y=c(m,r,p),x=h(r,p),b=u(r),w=0,_=[],S=new Map,T=0;A("nbody",B),A("spring",C);var E={bodies:m,quadTree:v,springs:g,settings:r,addForce:A,removeForce:P,getForces:D,step:function(){for(var O=0;O<_.length;++O)_[O](T);var R=f(m,r.timeStep,r.adaptiveTimeStepWeight);return T+=1,R},addBody:function(O){if(!O)throw new Error("Body is required");return m.push(O),O},addBodyAt:function(O){if(!O)throw new Error("Body position is required");var R=d(O);return m.push(R),R},removeBody:function(O){if(O){var R=m.indexOf(O);if(!(R<0))return m.splice(R,1),m.length===0&&y.reset(),!0}},addSpring:function(O,R,z,U){if(!O||!R)throw new Error("Cannot add null spring to force simulator");typeof z!="number"&&(z=-1);var G=new e(O,R,z,U>=0?U:-1);return g.push(G),G},getTotalMovement:function(){return w},removeSpring:function(O){if(O){var R=g.indexOf(O);if(R>-1)return g.splice(R,1),!0}},getBestNewBodyPosition:function(O){return y.getBestNewPosition(O)},getBBox:M,getBoundingBox:M,invalidateBBox:function(){console.warn("invalidateBBox() is deprecated, bounds always recomputed on `getBBox()` call")},gravity:function(O){return O!==void 0?(r.gravity=O,v.options({gravity:O}),this):r.gravity},theta:function(O){return O!==void 0?(r.theta=O,v.options({theta:O}),this):r.theta},random:p};return dTe(r,E),i(E),E;function M(){return y.update(),y.box}function A(O,R){if(S.has(O))throw new Error("Force "+O+" is already added");S.set(O,R),_.push(R)}function P(O){var R=_.indexOf(S.get(O));R<0||(_.splice(R,1),S.delete(O))}function D(){return S}function B(){if(m.length!==0){v.insertBodies(m);for(var O=m.length;O--;){var R=m[O];R.isPinned||(R.reset(),v.updateBodyForce(R),b.update(R))}}}function C(){for(var O=g.length;O--;)x.update(g[O])}}function dTe(r,e){for(var n in r)pTe(r,e,n)}function pTe(r,e,n){if(r.hasOwnProperty(n)&&typeof e[n]!="function"){var i=Number.isFinite(r[n]);i?e[n]=function(s){if(s!==void 0){if(!Number.isFinite(s))throw new Error("Value of "+n+" should be a valid number.");return r[n]=s,e}return r[n]}:e[n]=function(s){return s!==void 0?(r[n]=s,e):r[n]}}}YF.exports=gTe;YF.exports.simulator=wZ;var mTe=KF;function gTe(r,e){if(!r)throw new Error("Graph structure cannot be undefined");var n=e&&e.createSimulator||wZ,i=n(e);if(Array.isArray(e))throw new Error("Physics settings is expected to be an object");var s=r.version>19?B:D;e&&typeof e.nodeMass=="function"&&(s=e.nodeMass);var o=new Map,a={},l=0,c=i.settings.springTransform||yTe;b(),v();var u=!1,h={step:function(){if(l===0)return f(!0),!0;var C=i.step();h.lastMove=C,h.fire("step");var O=C/l,R=O<=.01;return f(R),R},getNodePosition:function(C){return P(C).pos},setNodePosition:function(C){var O=P(C);O.setPosition.apply(O,Array.prototype.slice.call(arguments,1))},getLinkPosition:function(C){var O=a[C];if(O)return{from:O.from.pos,to:O.to.pos}},getGraphRect:function(){return i.getBBox()},forEachBody:d,pinNode:function(C,O){var R=P(C.id);R.isPinned=!!O},isNodePinned:function(C){return P(C.id).isPinned},dispose:function(){r.off("changed",x),h.fire("disposed")},getBody:g,getSpring:m,getForceVectorLength:p,simulator:i,graph:r,lastMove:0};return mTe(h),h;function f(C){u!==C&&(u=C,y(C))}function d(C){o.forEach(C)}function p(){var C=0,O=0;return d(function(R){C+=Math.abs(R.force.x),O+=Math.abs(R.force.y)}),Math.sqrt(C*C+O*O)}function m(C,O){var R;if(O===void 0)typeof C!="object"?R=C:R=C.id;else{var z=r.hasLink(C,O);if(!z)return;R=z.id}return a[R]}function g(C){return o.get(C)}function v(){r.on("changed",x)}function y(C){h.fire("stable",C)}function x(C){for(var O=0;O<C.length;++O){var R=C[O];R.changeType==="add"?(R.node&&w(R.node.id),R.link&&S(R.link)):R.changeType==="remove"&&(R.node&&_(R.node),R.link&&T(R.link))}l=r.getNodesCount()}function b(){l=0,r.forEachNode(function(C){w(C.id),l+=1}),r.forEachLink(S)}function w(C){var O=o.get(C);if(!O){var R=r.getNode(C);if(!R)throw new Error("initBody() was called with unknown node id");var z=R.position;if(!z){var U=E(R);z=i.getBestNewBodyPosition(U)}O=i.addBodyAt(z),O.id=C,o.set(C,O),M(C),A(R)&&(O.isPinned=!0)}}function _(C){var O=C.id,R=o.get(O);R&&(o.delete(O),i.removeBody(R))}function S(C){M(C.fromId),M(C.toId);var O=o.get(C.fromId),R=o.get(C.toId),z=i.addSpring(O,R,C.length);c(C,z),a[C.id]=z}function T(C){var O=a[C.id];if(O){var R=r.getNode(C.fromId),z=r.getNode(C.toId);R&&M(R.id),z&&M(z.id),delete a[C.id],i.removeSpring(O)}}function E(C){var O=[];if(!C.links)return O;for(var R=Math.min(C.links.length,2),z=0;z<R;++z){var U=C.links[z],G=U.fromId!==C.id?o.get(U.fromId):o.get(U.toId);G&&G.pos&&O.push(G)}return O}function M(C){var O=o.get(C);if(O.mass=s(C),Number.isNaN(O.mass))throw new Error("Node mass should be a number")}function A(C){return C&&(C.isPinned||C.data&&C.data.isPinned)}function P(C){var O=o.get(C);return O||(w(C),O=o.get(C)),O}function D(C){var O=r.getLinks(C);return O?1+O.length/3:1}function B(C){var O=r.getLinks(C);return O?1+O.size/3:1}}function yTe(){}var vTe=YF.exports;const xTe=hn(vTe);function qT(r){var e=typeof r;return r!=null&&(e=="object"||e=="function")}var bTe=typeof global=="object"&&global&&global.Object===Object&&global,_Te=typeof self=="object"&&self&&self.Object===Object&&self,SZ=bTe||_Te||Function("return this")(),PR=function(){return SZ.Date.now()},wTe=/\s/;function STe(r){for(var e=r.length;e--&&wTe.test(r.charAt(e)););return e}var TTe=/^\s+/;function ETe(r){return r&&r.slice(0,STe(r)+1).replace(TTe,"")}var XT=SZ.Symbol,TZ=Object.prototype,MTe=TZ.hasOwnProperty,ATe=TZ.toString,vv=XT?XT.toStringTag:void 0;function CTe(r){var e=MTe.call(r,vv),n=r[vv];try{r[vv]=void 0;var i=!0}catch{}var s=ATe.call(r);return i&&(e?r[vv]=n:delete r[vv]),s}var PTe=Object.prototype,RTe=PTe.toString;function NTe(r){return RTe.call(r)}var OTe="[object Null]",DTe="[object Undefined]",E4=XT?XT.toStringTag:void 0;function kTe(r){return r==null?r===void 0?DTe:OTe:E4&&E4 in Object(r)?CTe(r):NTe(r)}function ITe(r){return r!=null&&typeof r=="object"}var LTe="[object Symbol]";function FTe(r){return typeof r=="symbol"||ITe(r)&&kTe(r)==LTe}var M4=NaN,BTe=/^[-+]0x[0-9a-f]+$/i,UTe=/^0b[01]+$/i,zTe=/^0o[0-7]+$/i,$Te=parseInt;function A4(r){if(typeof r=="number")return r;if(FTe(r))return M4;if(qT(r)){var e=typeof r.valueOf=="function"?r.valueOf():r;r=qT(e)?e+"":e}if(typeof r!="string")return r===0?r:+r;r=ETe(r);var n=UTe.test(r);return n||zTe.test(r)?$Te(r.slice(2),n?2:8):BTe.test(r)?M4:+r}var jTe="Expected a function",VTe=Math.max,GTe=Math.min;function EZ(r,e,n){var i,s,o,a,l,c,u=0,h=!1,f=!1,d=!0;if(typeof r!="function")throw new TypeError(jTe);e=A4(e)||0,qT(n)&&(h=!!n.leading,f="maxWait"in n,o=f?VTe(A4(n.maxWait)||0,e):o,d="trailing"in n?!!n.trailing:d);function p(S){var T=i,E=s;return i=s=void 0,u=S,a=r.apply(E,T),a}function m(S){return u=S,l=setTimeout(y,e),h?p(S):a}function g(S){var T=S-c,E=S-u,M=e-T;return f?GTe(M,o-E):M}function v(S){var T=S-c,E=S-u;return c===void 0||T>=e||T<0||f&&E>=o}function y(){var S=PR();if(v(S))return x(S);l=setTimeout(y,g(S))}function x(S){return l=void 0,d&&i?p(S):(i=s=void 0,a)}function b(){l!==void 0&&clearTimeout(l),u=0,i=c=s=l=void 0}function w(){return l===void 0?a:x(PR())}function _(){var S=PR(),T=v(S);if(i=arguments,s=this,c=S,T){if(l===void 0)return m(c);if(f)return clearTimeout(l),l=setTimeout(y,e),p(c)}return l===void 0&&(l=setTimeout(y,e)),a}return _.cancel=b,_.flush=w,_}function C4(r,e){(e==null||e>r.length)&&(e=r.length);for(var n=0,i=Array(e);n<e;n++)i[n]=r[n];return i}function HTe(r){if(Array.isArray(r))return r}function WTe(r,e){if(!(r instanceof e))throw new TypeError("Cannot call a class as a function")}function qTe(r,e,n){return Object.defineProperty(r,"prototype",{writable:!1}),r}function XTe(r,e){var n=r==null?null:typeof Symbol<"u"&&r[Symbol.iterator]||r["@@iterator"];if(n!=null){var i,s,o,a,l=[],c=!0,u=!1;try{if(o=(n=n.call(r)).next,e!==0)for(;!(c=(i=o.call(n)).done)&&(l.push(i.value),l.length!==e);c=!0);}catch(h){u=!0,s=h}finally{try{if(!c&&n.return!=null&&(a=n.return(),Object(a)!==a))return}finally{if(u)throw s}}return l}}function KTe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function YTe(r,e){return HTe(r)||XTe(r,e)||ZTe(r,e)||KTe()}function ZTe(r,e){if(r){if(typeof r=="string")return C4(r,e);var n={}.toString.call(r).slice(8,-1);return n==="Object"&&r.constructor&&(n=r.constructor.name),n==="Map"||n==="Set"?Array.from(r):n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?C4(r,e):void 0}}var QTe=qTe(function r(e,n){var i=n.default,s=i===void 0?null:i,o=n.triggerUpdate,a=o===void 0?!0:o,l=n.onChange,c=l===void 0?function(u,h){}:l;WTe(this,r),this.name=e,this.defaultVal=s,this.triggerUpdate=a,this.onChange=c});function Vh(r){var e=r.stateInit,n=e===void 0?function(){return{}}:e,i=r.props,s=i===void 0?{}:i,o=r.methods,a=o===void 0?{}:o,l=r.aliases,c=l===void 0?{}:l,u=r.init,h=u===void 0?function(){}:u,f=r.update,d=f===void 0?function(){}:f,p=Object.keys(s).map(function(m){return new QTe(m,s[m])});return function m(){for(var g=arguments.length,v=new Array(g),y=0;y<g;y++)v[y]=arguments[y];var x=!!(this instanceof m&&this.constructor),b=x?v.shift():void 0,w=v[0],_=w===void 0?{}:w,S=Object.assign({},n instanceof Function?n(_):n,{initialised:!1}),T={};function E(P){return M(P,_),A(),E}var M=function(D,B){h.call(E,D,S,B),S.initialised=!0},A=EZ(function(){S.initialised&&(d.call(E,S,T),T={})},1);return p.forEach(function(P){E[P.name]=D(P);function D(B){var C=B.name,O=B.triggerUpdate,R=O===void 0?!1:O,z=B.onChange,U=z===void 0?function(Y,ee){}:z,G=B.defaultVal,H=G===void 0?null:G;return function(Y){var ee=S[C];if(!arguments.length)return ee;var he=Y===void 0?H:Y;return S[C]=he,U.call(E,he,S,ee),!T.hasOwnProperty(C)&&(T[C]=ee),R&&A(),E}}}),Object.keys(a).forEach(function(P){E[P]=function(){for(var D,B=arguments.length,C=new Array(B),O=0;O<B;O++)C[O]=arguments[O];return(D=a[P]).call.apply(D,[E,S].concat(C))}}),Object.entries(c).forEach(function(P){var D=YTe(P,2),B=D[0],C=D[1];return E[B]=E[C]}),E.resetProps=function(){return p.forEach(function(P){E[P.name](P.defaultVal)}),E},E.resetProps(),S._rerender=A,x&&b&&E(b),E}}var ht=function(r){return typeof r=="function"?r:typeof r=="string"?function(e){return e[r]}:function(e){return r}};function bh(r,e){return r==null||e==null?NaN:r<e?-1:r>e?1:r>=e?0:NaN}function JTe(r,e){return r==null||e==null?NaN:e<r?-1:e>r?1:e>=r?0:NaN}function n3(r){let e,n,i;r.length!==2?(e=bh,n=(l,c)=>bh(r(l),c),i=(l,c)=>r(l)-c):(e=r===bh||r===JTe?r:eEe,n=r,i=r);function s(l,c,u=0,h=l.length){if(u<h){if(e(c,c)!==0)return h;do{const f=u+h>>>1;n(l[f],c)<0?u=f+1:h=f}while(u<h)}return u}function o(l,c,u=0,h=l.length){if(u<h){if(e(c,c)!==0)return h;do{const f=u+h>>>1;n(l[f],c)<=0?u=f+1:h=f}while(u<h)}return u}function a(l,c,u=0,h=l.length){const f=s(l,c,u,h-1);return f>u&&i(l[f-1],c)>-i(l[f],c)?f-1:f}return{left:s,center:a,right:o}}function eEe(){return 0}function MZ(r){return r===null?NaN:+r}function*tEe(r,e){for(let n of r)n!=null&&(n=+n)>=n&&(yield n)}const nEe=n3(bh),b_=nEe.right;n3(MZ).center;class P4 extends Map{constructor(e,n=sEe){if(super(),Object.defineProperties(this,{_intern:{value:new Map},_key:{value:n}}),e!=null)for(const[i,s]of e)this.set(i,s)}get(e){return super.get(R4(this,e))}has(e){return super.has(R4(this,e))}set(e,n){return super.set(rEe(this,e),n)}delete(e){return super.delete(iEe(this,e))}}function R4({_intern:r,_key:e},n){const i=e(n);return r.has(i)?r.get(i):n}function rEe({_intern:r,_key:e},n){const i=e(n);return r.has(i)?r.get(i):(r.set(i,n),n)}function iEe({_intern:r,_key:e},n){const i=e(n);return r.has(i)&&(n=r.get(i),r.delete(i)),n}function sEe(r){return r!==null&&typeof r=="object"?r.valueOf():r}function oEe(r=bh){if(r===bh)return AZ;if(typeof r!="function")throw new TypeError("compare is not a function");return(e,n)=>{const i=r(e,n);return i||i===0?i:(r(n,n)===0)-(r(e,e)===0)}}function AZ(r,e){return(r==null||!(r>=r))-(e==null||!(e>=e))||(r<e?-1:r>e?1:0)}const aEe=Math.sqrt(50),lEe=Math.sqrt(10),cEe=Math.sqrt(2);function KT(r,e,n){const i=(e-r)/Math.max(0,n),s=Math.floor(Math.log10(i)),o=i/Math.pow(10,s),a=o>=aEe?10:o>=lEe?5:o>=cEe?2:1;let l,c,u;return s<0?(u=Math.pow(10,-s)/a,l=Math.round(r*u),c=Math.round(e*u),l/u<r&&++l,c/u>e&&--c,u=-u):(u=Math.pow(10,s)*a,l=Math.round(r/u),c=Math.round(e/u),l*u<r&&++l,c*u>e&&--c),c<l&&.5<=n&&n<2?KT(r,e,n*2):[l,c,u]}function YO(r,e,n){if(e=+e,r=+r,n=+n,!(n>0))return[];if(r===e)return[r];const i=e<r,[s,o,a]=i?KT(e,r,n):KT(r,e,n);if(!(o>=s))return[];const l=o-s+1,c=new Array(l);if(i)if(a<0)for(let u=0;u<l;++u)c[u]=(o-u)/-a;else for(let u=0;u<l;++u)c[u]=(o-u)*a;else if(a<0)for(let u=0;u<l;++u)c[u]=(s+u)/-a;else for(let u=0;u<l;++u)c[u]=(s+u)*a;return c}function ZO(r,e,n){return e=+e,r=+r,n=+n,KT(r,e,n)[2]}function QO(r,e,n){e=+e,r=+r,n=+n;const i=e<r,s=i?ZO(e,r,n):ZO(r,e,n);return(i?-1:1)*(s<0?1/-s:s)}function Yx(r,e){let n;if(e===void 0)for(const i of r)i!=null&&(n<i||n===void 0&&i>=i)&&(n=i);else{let i=-1;for(let s of r)(s=e(s,++i,r))!=null&&(n<s||n===void 0&&s>=s)&&(n=s)}return n}function Zx(r,e){let n;if(e===void 0)for(const i of r)i!=null&&(n>i||n===void 0&&i>=i)&&(n=i);else{let i=-1;for(let s of r)(s=e(s,++i,r))!=null&&(n>s||n===void 0&&s>=s)&&(n=s)}return n}function CZ(r,e,n=0,i=1/0,s){if(e=Math.floor(e),n=Math.floor(Math.max(0,n)),i=Math.floor(Math.min(r.length-1,i)),!(n<=e&&e<=i))return r;for(s=s===void 0?AZ:oEe(s);i>n;){if(i-n>600){const c=i-n+1,u=e-n+1,h=Math.log(c),f=.5*Math.exp(2*h/3),d=.5*Math.sqrt(h*f*(c-f)/c)*(u-c/2<0?-1:1),p=Math.max(n,Math.floor(e-u*f/c+d)),m=Math.min(i,Math.floor(e+(c-u)*f/c+d));CZ(r,e,p,m,s)}const o=r[e];let a=n,l=i;for(xv(r,n,e),s(r[i],o)>0&&xv(r,n,i);a<l;){for(xv(r,a,l),++a,--l;s(r[a],o)<0;)++a;for(;s(r[l],o)>0;)--l}s(r[n],o)===0?xv(r,n,l):(++l,xv(r,l,i)),l<=e&&(n=l+1),e<=l&&(i=l-1)}return r}function xv(r,e,n){const i=r[e];r[e]=r[n],r[n]=i}function uEe(r,e,n){if(r=Float64Array.from(tEe(r)),!(!(i=r.length)||isNaN(e=+e))){if(e<=0||i<2)return Zx(r);if(e>=1)return Yx(r);var i,s=(i-1)*e,o=Math.floor(s),a=Yx(CZ(r,o).subarray(0,o+1)),l=Zx(r.subarray(o+1));return a+(l-a)*(s-o)}}function hEe(r,e,n=MZ){if(!(!(i=r.length)||isNaN(e=+e))){if(e<=0||i<2)return+n(r[0],0,r);if(e>=1)return+n(r[i-1],i-1,r);var i,s=(i-1)*e,o=Math.floor(s),a=+n(r[o],o,r),l=+n(r[o+1],o+1,r);return a+(l-a)*(s-o)}}function fEe(r,e,n){r=+r,e=+e,n=(s=arguments.length)<2?(e=r,r=0,1):s<3?1:+n;for(var i=-1,s=Math.max(0,Math.ceil((e-r)/n))|0,o=new Array(s);++i<s;)o[i]=r+i*n;return o}function dEe(r,e){let n=0;for(let i of r)(i=+i)&&(n+=i);return n}function JO(r,e){(e==null||e>r.length)&&(e=r.length);for(var n=0,i=Array(e);n<e;n++)i[n]=r[n];return i}function pEe(r){if(Array.isArray(r))return r}function mEe(r){if(Array.isArray(r))return JO(r)}function PZ(r,e,n){if(typeof r=="function"?r===e:r.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}function gEe(r,e){if(e.has(r))throw new TypeError("Cannot initialize the same private elements twice on an object")}function yEe(r,e){if(!(r instanceof e))throw new TypeError("Cannot call a class as a function")}function Zi(r,e){return r.get(PZ(r,e))}function _p(r,e,n){gEe(r,e),e.set(r,n)}function yS(r,e,n){return r.set(PZ(r,e),n),n}function vEe(r,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(r,AEe(i.key),i)}}function xEe(r,e,n){return e&&vEe(r.prototype,e),Object.defineProperty(r,"prototype",{writable:!1}),r}function bEe(r){if(typeof Symbol<"u"&&r[Symbol.iterator]!=null||r["@@iterator"]!=null)return Array.from(r)}function _Ee(r,e){var n=r==null?null:typeof Symbol<"u"&&r[Symbol.iterator]||r["@@iterator"];if(n!=null){var i,s,o,a,l=[],c=!0,u=!1;try{if(o=(n=n.call(r)).next,e!==0)for(;!(c=(i=o.call(n)).done)&&(l.push(i.value),l.length!==e);c=!0);}catch(h){u=!0,s=h}finally{try{if(!c&&n.return!=null&&(a=n.return(),Object(a)!==a))return}finally{if(u)throw s}}return l}}function wEe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function SEe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function TEe(r,e){return pEe(r)||_Ee(r,e)||RZ(r,e)||wEe()}function EEe(r){return mEe(r)||bEe(r)||RZ(r)||SEe()}function MEe(r,e){if(typeof r!="object"||!r)return r;var n=r[Symbol.toPrimitive];if(n!==void 0){var i=n.call(r,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(r)}function AEe(r){var e=MEe(r,"string");return typeof e=="symbol"?e:e+""}function RZ(r,e){if(r){if(typeof r=="string")return JO(r,e);var n={}.toString.call(r).slice(8,-1);return n==="Object"&&r.constructor&&(n=r.constructor.name),n==="Map"||n==="Set"?Array.from(r):n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?JO(r,e):void 0}}var wp=new WeakMap,bv=new WeakMap,Sp=new WeakMap,RR=new WeakMap,NR=new WeakMap,OR=new WeakMap,CEe=function(){function r(){yEe(this,r),_p(this,wp,new Map),_p(this,bv,new Map),_p(this,Sp,function(e){return e}),_p(this,RR,function(){return{}}),_p(this,NR,function(){}),_p(this,OR,function(){})}return xEe(r,[{key:"getObj",value:function(n){return Zi(wp,this).get(Zi(Sp,this).call(this,n))}},{key:"getData",value:function(n){return Zi(bv,this).get(n)}},{key:"entries",value:function(){return EEe(Zi(bv,this).entries()).map(function(n){var i=TEe(n,2),s=i[0],o=i[1];return[o,s]})}},{key:"id",value:function(n){return yS(Sp,this,ht(n)),this}},{key:"onCreateObj",value:function(n){return yS(RR,this,n),this}},{key:"onUpdateObj",value:function(n){return yS(NR,this,n),this}},{key:"onRemoveObj",value:function(n){return yS(OR,this,n),this}},{key:"digest",value:function(n){var i=this;n.filter(function(o){return!Zi(wp,i).has(Zi(Sp,i).call(i,o))}).forEach(function(o){var a=Zi(RR,i).call(i,o);Zi(wp,i).set(Zi(Sp,i).call(i,o),a),Zi(bv,i).set(a,o)});var s=new Map(n.map(function(o){return[Zi(Sp,i).call(i,o),o]}));return Zi(wp,this).forEach(function(o,a){s.has(a)?Zi(NR,i).call(i,o,s.get(a)):(Zi(OR,i).call(i,o,a),Zi(wp,i).delete(a),Zi(bv,i).delete(o))}),this}},{key:"clear",value:function(){return this.digest([]),this}}])}();function ma(r,e){switch(arguments.length){case 0:break;case 1:this.range(r);break;default:this.range(e).domain(r);break}return this}function vu(r,e){switch(arguments.length){case 0:break;case 1:{typeof r=="function"?this.interpolator(r):this.range(r);break}default:{this.domain(r),typeof e=="function"?this.interpolator(e):this.range(e);break}}return this}const eD=Symbol("implicit");function __(){var r=new P4,e=[],n=[],i=eD;function s(o){let a=r.get(o);if(a===void 0){if(i!==eD)return i;r.set(o,a=e.push(o)-1)}return n[a%n.length]}return s.domain=function(o){if(!arguments.length)return e.slice();e=[],r=new P4;for(const a of o)r.has(a)||r.set(a,e.push(a)-1);return s},s.range=function(o){return arguments.length?(n=Array.from(o),s):n.slice()},s.unknown=function(o){return arguments.length?(i=o,s):i},s.copy=function(){return __(e,n).unknown(i)},ma.apply(s,arguments),s}function Qx(){var r=__().unknown(void 0),e=r.domain,n=r.range,i=0,s=1,o,a,l=!1,c=0,u=0,h=.5;delete r.unknown;function f(){var d=e().length,p=s<i,m=p?s:i,g=p?i:s;o=(g-m)/Math.max(1,d-c+u*2),l&&(o=Math.floor(o)),m+=(g-m-o*(d-c))*h,a=o*(1-c),l&&(m=Math.round(m),a=Math.round(a));var v=fEe(d).map(function(y){return m+o*y});return n(p?v.reverse():v)}return r.domain=function(d){return arguments.length?(e(d),f()):e()},r.range=function(d){return arguments.length?([i,s]=d,i=+i,s=+s,f()):[i,s]},r.rangeRound=function(d){return[i,s]=d,i=+i,s=+s,l=!0,f()},r.bandwidth=function(){return a},r.step=function(){return o},r.round=function(d){return arguments.length?(l=!!d,f()):l},r.padding=function(d){return arguments.length?(c=Math.min(1,u=+d),f()):c},r.paddingInner=function(d){return arguments.length?(c=Math.min(1,d),f()):c},r.paddingOuter=function(d){return arguments.length?(u=+d,f()):u},r.align=function(d){return arguments.length?(h=Math.max(0,Math.min(1,d)),f()):h},r.copy=function(){return Qx(e(),[i,s]).round(l).paddingInner(c).paddingOuter(u).align(h)},ma.apply(f(),arguments)}function NZ(r){var e=r.copy;return r.padding=r.paddingOuter,delete r.paddingInner,delete r.paddingOuter,r.copy=function(){return NZ(e())},r}function U0(){return NZ(Qx.apply(null,arguments).paddingInner(1))}function r3(r,e,n){r.prototype=e.prototype=n,n.constructor=r}function OZ(r,e){var n=Object.create(r.prototype);for(var i in e)n[i]=e[i];return n}function w_(){}var Jx=.7,YT=1/Jx,Om="\\s*([+-]?\\d+)\\s*",eb="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",kl="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",PEe=/^#([0-9a-f]{3,8})$/,REe=new RegExp(`^rgb\\(${Om},${Om},${Om}\\)$`),NEe=new RegExp(`^rgb\\(${kl},${kl},${kl}\\)$`),OEe=new RegExp(`^rgba\\(${Om},${Om},${Om},${eb}\\)$`),DEe=new RegExp(`^rgba\\(${kl},${kl},${kl},${eb}\\)$`),kEe=new RegExp(`^hsl\\(${eb},${kl},${kl}\\)$`),IEe=new RegExp(`^hsla\\(${eb},${kl},${kl},${eb}\\)$`),N4={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};r3(w_,_d,{copy(r){return Object.assign(new this.constructor,this,r)},displayable(){return this.rgb().displayable()},hex:O4,formatHex:O4,formatHex8:LEe,formatHsl:FEe,formatRgb:D4,toString:D4});function O4(){return this.rgb().formatHex()}function LEe(){return this.rgb().formatHex8()}function FEe(){return DZ(this).formatHsl()}function D4(){return this.rgb().formatRgb()}function _d(r){var e,n;return r=(r+"").trim().toLowerCase(),(e=PEe.exec(r))?(n=e[1].length,e=parseInt(e[1],16),n===6?k4(e):n===3?new Ys(e>>8&15|e>>4&240,e>>4&15|e&240,(e&15)<<4|e&15,1):n===8?vS(e>>24&255,e>>16&255,e>>8&255,(e&255)/255):n===4?vS(e>>12&15|e>>8&240,e>>8&15|e>>4&240,e>>4&15|e&240,((e&15)<<4|e&15)/255):null):(e=REe.exec(r))?new Ys(e[1],e[2],e[3],1):(e=NEe.exec(r))?new Ys(e[1]*255/100,e[2]*255/100,e[3]*255/100,1):(e=OEe.exec(r))?vS(e[1],e[2],e[3],e[4]):(e=DEe.exec(r))?vS(e[1]*255/100,e[2]*255/100,e[3]*255/100,e[4]):(e=kEe.exec(r))?F4(e[1],e[2]/100,e[3]/100,1):(e=IEe.exec(r))?F4(e[1],e[2]/100,e[3]/100,e[4]):N4.hasOwnProperty(r)?k4(N4[r]):r==="transparent"?new Ys(NaN,NaN,NaN,0):null}function k4(r){return new Ys(r>>16&255,r>>8&255,r&255,1)}function vS(r,e,n,i){return i<=0&&(r=e=n=NaN),new Ys(r,e,n,i)}function BEe(r){return r instanceof w_||(r=_d(r)),r?(r=r.rgb(),new Ys(r.r,r.g,r.b,r.opacity)):new Ys}function tD(r,e,n,i){return arguments.length===1?BEe(r):new Ys(r,e,n,i??1)}function Ys(r,e,n,i){this.r=+r,this.g=+e,this.b=+n,this.opacity=+i}r3(Ys,tD,OZ(w_,{brighter(r){return r=r==null?YT:Math.pow(YT,r),new Ys(this.r*r,this.g*r,this.b*r,this.opacity)},darker(r){return r=r==null?Jx:Math.pow(Jx,r),new Ys(this.r*r,this.g*r,this.b*r,this.opacity)},rgb(){return this},clamp(){return new Ys(rd(this.r),rd(this.g),rd(this.b),ZT(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:I4,formatHex:I4,formatHex8:UEe,formatRgb:L4,toString:L4}));function I4(){return`#${Hf(this.r)}${Hf(this.g)}${Hf(this.b)}`}function UEe(){return`#${Hf(this.r)}${Hf(this.g)}${Hf(this.b)}${Hf((isNaN(this.opacity)?1:this.opacity)*255)}`}function L4(){const r=ZT(this.opacity);return`${r===1?"rgb(":"rgba("}${rd(this.r)}, ${rd(this.g)}, ${rd(this.b)}${r===1?")":`, ${r})`}`}function ZT(r){return isNaN(r)?1:Math.max(0,Math.min(1,r))}function rd(r){return Math.max(0,Math.min(255,Math.round(r)||0))}function Hf(r){return r=rd(r),(r<16?"0":"")+r.toString(16)}function F4(r,e,n,i){return i<=0?r=e=n=NaN:n<=0||n>=1?r=e=NaN:e<=0&&(r=NaN),new Ha(r,e,n,i)}function DZ(r){if(r instanceof Ha)return new Ha(r.h,r.s,r.l,r.opacity);if(r instanceof w_||(r=_d(r)),!r)return new Ha;if(r instanceof Ha)return r;r=r.rgb();var e=r.r/255,n=r.g/255,i=r.b/255,s=Math.min(e,n,i),o=Math.max(e,n,i),a=NaN,l=o-s,c=(o+s)/2;return l?(e===o?a=(n-i)/l+(n<i)*6:n===o?a=(i-e)/l+2:a=(e-n)/l+4,l/=c<.5?o+s:2-o-s,a*=60):l=c>0&&c<1?0:a,new Ha(a,l,c,r.opacity)}function zEe(r,e,n,i){return arguments.length===1?DZ(r):new Ha(r,e,n,i??1)}function Ha(r,e,n,i){this.h=+r,this.s=+e,this.l=+n,this.opacity=+i}r3(Ha,zEe,OZ(w_,{brighter(r){return r=r==null?YT:Math.pow(YT,r),new Ha(this.h,this.s,this.l*r,this.opacity)},darker(r){return r=r==null?Jx:Math.pow(Jx,r),new Ha(this.h,this.s,this.l*r,this.opacity)},rgb(){var r=this.h%360+(this.h<0)*360,e=isNaN(r)||isNaN(this.s)?0:this.s,n=this.l,i=n+(n<.5?n:1-n)*e,s=2*n-i;return new Ys(DR(r>=240?r-240:r+120,s,i),DR(r,s,i),DR(r<120?r+240:r-120,s,i),this.opacity)},clamp(){return new Ha(B4(this.h),xS(this.s),xS(this.l),ZT(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const r=ZT(this.opacity);return`${r===1?"hsl(":"hsla("}${B4(this.h)}, ${xS(this.s)*100}%, ${xS(this.l)*100}%${r===1?")":`, ${r})`}`}}));function B4(r){return r=(r||0)%360,r<0?r+360:r}function xS(r){return Math.max(0,Math.min(1,r||0))}function DR(r,e,n){return(r<60?e+(n-e)*r/60:r<180?n:r<240?e+(n-e)*(240-r)/60:e)*255}const i3=r=>()=>r;function $Ee(r,e){return function(n){return r+n*e}}function jEe(r,e,n){return r=Math.pow(r,n),e=Math.pow(e,n)-r,n=1/n,function(i){return Math.pow(r+i*e,n)}}function VEe(r){return(r=+r)==1?kZ:function(e,n){return n-e?jEe(e,n,r):i3(isNaN(e)?n:e)}}function kZ(r,e){var n=e-r;return n?$Ee(r,n):i3(isNaN(r)?e:r)}const QT=function r(e){var n=VEe(e);function i(s,o){var a=n((s=tD(s)).r,(o=tD(o)).r),l=n(s.g,o.g),c=n(s.b,o.b),u=kZ(s.opacity,o.opacity);return function(h){return s.r=a(h),s.g=l(h),s.b=c(h),s.opacity=u(h),s+""}}return i.gamma=r,i}(1);function GEe(r,e){e||(e=[]);var n=r?Math.min(e.length,r.length):0,i=e.slice(),s;return function(o){for(s=0;s<n;++s)i[s]=r[s]*(1-o)+e[s]*o;return i}}function HEe(r){return ArrayBuffer.isView(r)&&!(r instanceof DataView)}function WEe(r,e){var n=e?e.length:0,i=r?Math.min(n,r.length):0,s=new Array(i),o=new Array(n),a;for(a=0;a<i;++a)s[a]=_y(r[a],e[a]);for(;a<n;++a)o[a]=e[a];return function(l){for(a=0;a<i;++a)o[a]=s[a](l);return o}}function qEe(r,e){var n=new Date;return r=+r,e=+e,function(i){return n.setTime(r*(1-i)+e*i),n}}function $a(r,e){return r=+r,e=+e,function(n){return r*(1-n)+e*n}}function XEe(r,e){var n={},i={},s;(r===null||typeof r!="object")&&(r={}),(e===null||typeof e!="object")&&(e={});for(s in e)s in r?n[s]=_y(r[s],e[s]):i[s]=e[s];return function(o){for(s in n)i[s]=n[s](o);return i}}var nD=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,kR=new RegExp(nD.source,"g");function KEe(r){return function(){return r}}function YEe(r){return function(e){return r(e)+""}}function IZ(r,e){var n=nD.lastIndex=kR.lastIndex=0,i,s,o,a=-1,l=[],c=[];for(r=r+"",e=e+"";(i=nD.exec(r))&&(s=kR.exec(e));)(o=s.index)>n&&(o=e.slice(n,o),l[a]?l[a]+=o:l[++a]=o),(i=i[0])===(s=s[0])?l[a]?l[a]+=s:l[++a]=s:(l[++a]=null,c.push({i:a,x:$a(i,s)})),n=kR.lastIndex;return n<e.length&&(o=e.slice(n),l[a]?l[a]+=o:l[++a]=o),l.length<2?c[0]?YEe(c[0].x):KEe(e):(e=c.length,function(u){for(var h=0,f;h<e;++h)l[(f=c[h]).i]=f.x(u);return l.join("")})}function _y(r,e){var n=typeof e,i;return e==null||n==="boolean"?i3(e):(n==="number"?$a:n==="string"?(i=_d(e))?(e=i,QT):IZ:e instanceof _d?QT:e instanceof Date?qEe:HEe(e)?GEe:Array.isArray(e)?WEe:typeof e.valueOf!="function"&&typeof e.toString!="function"||isNaN(e)?XEe:$a)(r,e)}function s3(r,e){return r=+r,e=+e,function(n){return Math.round(r*(1-n)+e*n)}}var U4=180/Math.PI,rD={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function LZ(r,e,n,i,s,o){var a,l,c;return(a=Math.sqrt(r*r+e*e))&&(r/=a,e/=a),(c=r*n+e*i)&&(n-=r*c,i-=e*c),(l=Math.sqrt(n*n+i*i))&&(n/=l,i/=l,c/=l),r*i<e*n&&(r=-r,e=-e,c=-c,a=-a),{translateX:s,translateY:o,rotate:Math.atan2(e,r)*U4,skewX:Math.atan(c)*U4,scaleX:a,scaleY:l}}var bS;function ZEe(r){const e=new(typeof DOMMatrix=="function"?DOMMatrix:WebKitCSSMatrix)(r+"");return e.isIdentity?rD:LZ(e.a,e.b,e.c,e.d,e.e,e.f)}function QEe(r){return r==null||(bS||(bS=document.createElementNS("http://www.w3.org/2000/svg","g")),bS.setAttribute("transform",r),!(r=bS.transform.baseVal.consolidate()))?rD:(r=r.matrix,LZ(r.a,r.b,r.c,r.d,r.e,r.f))}function FZ(r,e,n,i){function s(u){return u.length?u.pop()+" ":""}function o(u,h,f,d,p,m){if(u!==f||h!==d){var g=p.push("translate(",null,e,null,n);m.push({i:g-4,x:$a(u,f)},{i:g-2,x:$a(h,d)})}else(f||d)&&p.push("translate("+f+e+d+n)}function a(u,h,f,d){u!==h?(u-h>180?h+=360:h-u>180&&(u+=360),d.push({i:f.push(s(f)+"rotate(",null,i)-2,x:$a(u,h)})):h&&f.push(s(f)+"rotate("+h+i)}function l(u,h,f,d){u!==h?d.push({i:f.push(s(f)+"skewX(",null,i)-2,x:$a(u,h)}):h&&f.push(s(f)+"skewX("+h+i)}function c(u,h,f,d,p,m){if(u!==f||h!==d){var g=p.push(s(p)+"scale(",null,",",null,")");m.push({i:g-4,x:$a(u,f)},{i:g-2,x:$a(h,d)})}else(f!==1||d!==1)&&p.push(s(p)+"scale("+f+","+d+")")}return function(u,h){var f=[],d=[];return u=r(u),h=r(h),o(u.translateX,u.translateY,h.translateX,h.translateY,f,d),a(u.rotate,h.rotate,f,d),l(u.skewX,h.skewX,f,d),c(u.scaleX,u.scaleY,h.scaleX,h.scaleY,f,d),u=h=null,function(p){for(var m=-1,g=d.length,v;++m<g;)f[(v=d[m]).i]=v.x(p);return f.join("")}}}var JEe=FZ(ZEe,"px, ","px)","deg)"),eMe=FZ(QEe,", ",")",")"),tMe=1e-12;function z4(r){return((r=Math.exp(r))+1/r)/2}function nMe(r){return((r=Math.exp(r))-1/r)/2}function rMe(r){return((r=Math.exp(2*r))-1)/(r+1)}const iMe=function r(e,n,i){function s(o,a){var l=o[0],c=o[1],u=o[2],h=a[0],f=a[1],d=a[2],p=h-l,m=f-c,g=p*p+m*m,v,y;if(g<tMe)y=Math.log(d/u)/e,v=function(T){return[l+T*p,c+T*m,u*Math.exp(e*T*y)]};else{var x=Math.sqrt(g),b=(d*d-u*u+i*g)/(2*u*n*x),w=(d*d-u*u-i*g)/(2*d*n*x),_=Math.log(Math.sqrt(b*b+1)-b),S=Math.log(Math.sqrt(w*w+1)-w);y=(S-_)/e,v=function(T){var E=T*y,M=z4(_),A=u/(n*x)*(M*rMe(e*E+_)-nMe(_));return[l+A*p,c+A*m,u*M/z4(e*E+_)]}}return v.duration=y*1e3*e/Math.SQRT2,v}return s.rho=function(o){var a=Math.max(.001,+o),l=a*a,c=l*l;return r(a,l,c)},s}(Math.SQRT2,2,4);function sMe(r,e){e===void 0&&(e=r,r=_y);for(var n=0,i=e.length-1,s=e[0],o=new Array(i<0?0:i);n<i;)o[n]=r(s,s=e[++n]);return function(a){var l=Math.max(0,Math.min(i-1,Math.floor(a*=i)));return o[l](a-l)}}function oMe(r){return function(){return r}}function JT(r){return+r}var $4=[0,1];function Rs(r){return r}function iD(r,e){return(e-=r=+r)?function(n){return(n-r)/e}:oMe(isNaN(e)?NaN:.5)}function aMe(r,e){var n;return r>e&&(n=r,r=e,e=n),function(i){return Math.max(r,Math.min(e,i))}}function lMe(r,e,n){var i=r[0],s=r[1],o=e[0],a=e[1];return s<i?(i=iD(s,i),o=n(a,o)):(i=iD(i,s),o=n(o,a)),function(l){return o(i(l))}}function cMe(r,e,n){var i=Math.min(r.length,e.length)-1,s=new Array(i),o=new Array(i),a=-1;for(r[i]<r[0]&&(r=r.slice().reverse(),e=e.slice().reverse());++a<i;)s[a]=iD(r[a],r[a+1]),o[a]=n(e[a],e[a+1]);return function(l){var c=b_(r,l,1,i)-1;return o[c](s[c](l))}}function S_(r,e){return e.domain(r.domain()).range(r.range()).interpolate(r.interpolate()).clamp(r.clamp()).unknown(r.unknown())}function rA(){var r=$4,e=$4,n=_y,i,s,o,a=Rs,l,c,u;function h(){var d=Math.min(r.length,e.length);return a!==Rs&&(a=aMe(r[0],r[d-1])),l=d>2?cMe:lMe,c=u=null,f}function f(d){return d==null||isNaN(d=+d)?o:(c||(c=l(r.map(i),e,n)))(i(a(d)))}return f.invert=function(d){return a(s((u||(u=l(e,r.map(i),$a)))(d)))},f.domain=function(d){return arguments.length?(r=Array.from(d,JT),h()):r.slice()},f.range=function(d){return arguments.length?(e=Array.from(d),h()):e.slice()},f.rangeRound=function(d){return e=Array.from(d),n=s3,h()},f.clamp=function(d){return arguments.length?(a=d?!0:Rs,h()):a!==Rs},f.interpolate=function(d){return arguments.length?(n=d,h()):n},f.unknown=function(d){return arguments.length?(o=d,f):o},function(d,p){return i=d,s=p,h()}}function o3(){return rA()(Rs,Rs)}function uMe(r){return Math.abs(r=Math.round(r))>=1e21?r.toLocaleString("en").replace(/,/g,""):r.toString(10)}function eE(r,e){if((n=(r=e?r.toExponential(e-1):r.toExponential()).indexOf("e"))<0)return null;var n,i=r.slice(0,n);return[i.length>1?i[0]+i.slice(2):i,+r.slice(n+1)]}function bg(r){return r=eE(Math.abs(r)),r?r[1]:NaN}function hMe(r,e){return function(n,i){for(var s=n.length,o=[],a=0,l=r[0],c=0;s>0&&l>0&&(c+l+1>i&&(l=Math.max(1,i-c)),o.push(n.substring(s-=l,s+l)),!((c+=l+1)>i));)l=r[a=(a+1)%r.length];return o.reverse().join(e)}}function fMe(r){return function(e){return e.replace(/[0-9]/g,function(n){return r[+n]})}}var dMe=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function tb(r){if(!(e=dMe.exec(r)))throw new Error("invalid format: "+r);var e;return new a3({fill:e[1],align:e[2],sign:e[3],symbol:e[4],zero:e[5],width:e[6],comma:e[7],precision:e[8]&&e[8].slice(1),trim:e[9],type:e[10]})}tb.prototype=a3.prototype;function a3(r){this.fill=r.fill===void 0?" ":r.fill+"",this.align=r.align===void 0?">":r.align+"",this.sign=r.sign===void 0?"-":r.sign+"",this.symbol=r.symbol===void 0?"":r.symbol+"",this.zero=!!r.zero,this.width=r.width===void 0?void 0:+r.width,this.comma=!!r.comma,this.precision=r.precision===void 0?void 0:+r.precision,this.trim=!!r.trim,this.type=r.type===void 0?"":r.type+""}a3.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(this.width===void 0?"":Math.max(1,this.width|0))+(this.comma?",":"")+(this.precision===void 0?"":"."+Math.max(0,this.precision|0))+(this.trim?"~":"")+this.type};function pMe(r){e:for(var e=r.length,n=1,i=-1,s;n<e;++n)switch(r[n]){case".":i=s=n;break;case"0":i===0&&(i=n),s=n;break;default:if(!+r[n])break e;i>0&&(i=0);break}return i>0?r.slice(0,i)+r.slice(s+1):r}var BZ;function mMe(r,e){var n=eE(r,e);if(!n)return r+"";var i=n[0],s=n[1],o=s-(BZ=Math.max(-8,Math.min(8,Math.floor(s/3)))*3)+1,a=i.length;return o===a?i:o>a?i+new Array(o-a+1).join("0"):o>0?i.slice(0,o)+"."+i.slice(o):"0."+new Array(1-o).join("0")+eE(r,Math.max(0,e+o-1))[0]}function j4(r,e){var n=eE(r,e);if(!n)return r+"";var i=n[0],s=n[1];return s<0?"0."+new Array(-s).join("0")+i:i.length>s+1?i.slice(0,s+1)+"."+i.slice(s+1):i+new Array(s-i.length+2).join("0")}const V4={"%":(r,e)=>(r*100).toFixed(e),b:r=>Math.round(r).toString(2),c:r=>r+"",d:uMe,e:(r,e)=>r.toExponential(e),f:(r,e)=>r.toFixed(e),g:(r,e)=>r.toPrecision(e),o:r=>Math.round(r).toString(8),p:(r,e)=>j4(r*100,e),r:j4,s:mMe,X:r=>Math.round(r).toString(16).toUpperCase(),x:r=>Math.round(r).toString(16)};function G4(r){return r}var H4=Array.prototype.map,W4=["y","z","a","f","p","n","","m","","k","M","G","T","P","E","Z","Y"];function gMe(r){var e=r.grouping===void 0||r.thousands===void 0?G4:hMe(H4.call(r.grouping,Number),r.thousands+""),n=r.currency===void 0?"":r.currency[0]+"",i=r.currency===void 0?"":r.currency[1]+"",s=r.decimal===void 0?".":r.decimal+"",o=r.numerals===void 0?G4:fMe(H4.call(r.numerals,String)),a=r.percent===void 0?"%":r.percent+"",l=r.minus===void 0?"":r.minus+"",c=r.nan===void 0?"NaN":r.nan+"";function u(f){f=tb(f);var d=f.fill,p=f.align,m=f.sign,g=f.symbol,v=f.zero,y=f.width,x=f.comma,b=f.precision,w=f.trim,_=f.type;_==="n"?(x=!0,_="g"):V4[_]||(b===void 0&&(b=12),w=!0,_="g"),(v||d==="0"&&p==="=")&&(v=!0,d="0",p="=");var S=g==="$"?n:g==="#"&&/[boxX]/.test(_)?"0"+_.toLowerCase():"",T=g==="$"?i:/[%p]/.test(_)?a:"",E=V4[_],M=/[defgprs%]/.test(_);b=b===void 0?6:/[gprs]/.test(_)?Math.max(1,Math.min(21,b)):Math.max(0,Math.min(20,b));function A(P){var D=S,B=T,C,O,R;if(_==="c")B=E(P)+B,P="";else{P=+P;var z=P<0||1/P<0;if(P=isNaN(P)?c:E(Math.abs(P),b),w&&(P=pMe(P)),z&&+P==0&&m!=="+"&&(z=!1),D=(z?m==="("?m:l:m==="-"||m==="("?"":m)+D,B=(_==="s"?W4[8+BZ/3]:"")+B+(z&&m==="("?")":""),M){for(C=-1,O=P.length;++C<O;)if(R=P.charCodeAt(C),48>R||R>57){B=(R===46?s+P.slice(C+1):P.slice(C))+B,P=P.slice(0,C);break}}}x&&!v&&(P=e(P,1/0));var U=D.length+P.length+B.length,G=U<y?new Array(y-U+1).join(d):"";switch(x&&v&&(P=e(G+P,G.length?y-B.length:1/0),G=""),p){case"<":P=D+P+B+G;break;case"=":P=D+G+P+B;break;case"^":P=G.slice(0,U=G.length>>1)+D+P+B+G.slice(U);break;default:P=G+D+P+B;break}return o(P)}return A.toString=function(){return f+""},A}function h(f,d){var p=u((f=tb(f),f.type="f",f)),m=Math.max(-8,Math.min(8,Math.floor(bg(d)/3)))*3,g=Math.pow(10,-m),v=W4[8+m/3];return function(y){return p(g*y)+v}}return{format:u,formatPrefix:h}}var _S,l3,UZ;yMe({thousands:",",grouping:[3],currency:["$",""]});function yMe(r){return _S=gMe(r),l3=_S.format,UZ=_S.formatPrefix,_S}function vMe(r){return Math.max(0,-bg(Math.abs(r)))}function xMe(r,e){return Math.max(0,Math.max(-8,Math.min(8,Math.floor(bg(e)/3)))*3-bg(Math.abs(r)))}function bMe(r,e){return r=Math.abs(r),e=Math.abs(e)-r,Math.max(0,bg(e)-bg(r))+1}function zZ(r,e,n,i){var s=QO(r,e,n),o;switch(i=tb(i??",f"),i.type){case"s":{var a=Math.max(Math.abs(r),Math.abs(e));return i.precision==null&&!isNaN(o=xMe(s,a))&&(i.precision=o),UZ(i,a)}case"":case"e":case"g":case"p":case"r":{i.precision==null&&!isNaN(o=bMe(s,Math.max(Math.abs(r),Math.abs(e))))&&(i.precision=o-(i.type==="e"));break}case"f":case"%":{i.precision==null&&!isNaN(o=vMe(s))&&(i.precision=o-(i.type==="%")*2);break}}return l3(i)}function Gh(r){var e=r.domain;return r.ticks=function(n){var i=e();return YO(i[0],i[i.length-1],n??10)},r.tickFormat=function(n,i){var s=e();return zZ(s[0],s[s.length-1],n??10,i)},r.nice=function(n){n==null&&(n=10);var i=e(),s=0,o=i.length-1,a=i[s],l=i[o],c,u,h=10;for(l<a&&(u=a,a=l,l=u,u=s,s=o,o=u);h-- >0;){if(u=ZO(a,l,n),u===c)return i[s]=a,i[o]=l,e(i);if(u>0)a=Math.floor(a/u)*u,l=Math.ceil(l/u)*u;else if(u<0)a=Math.ceil(a*u)/u,l=Math.floor(l*u)/u;else break;c=u}return r},r}function tE(){var r=o3();return r.copy=function(){return S_(r,tE())},ma.apply(r,arguments),Gh(r)}function $Z(r){var e;function n(i){return i==null||isNaN(i=+i)?e:i}return n.invert=n,n.domain=n.range=function(i){return arguments.length?(r=Array.from(i,JT),n):r.slice()},n.unknown=function(i){return arguments.length?(e=i,n):e},n.copy=function(){return $Z(r).unknown(e)},r=arguments.length?Array.from(r,JT):[0,1],Gh(n)}function jZ(r,e){r=r.slice();var n=0,i=r.length-1,s=r[n],o=r[i],a;return o<s&&(a=n,n=i,i=a,a=s,s=o,o=a),r[n]=e.floor(s),r[i]=e.ceil(o),r}function q4(r){return Math.log(r)}function X4(r){return Math.exp(r)}function _Me(r){return-Math.log(-r)}function wMe(r){return-Math.exp(-r)}function SMe(r){return isFinite(r)?+("1e"+r):r<0?0:r}function TMe(r){return r===10?SMe:r===Math.E?Math.exp:e=>Math.pow(r,e)}function EMe(r){return r===Math.E?Math.log:r===10&&Math.log10||r===2&&Math.log2||(r=Math.log(r),e=>Math.log(e)/r)}function K4(r){return(e,n)=>-r(-e,n)}function c3(r){const e=r(q4,X4),n=e.domain;let i=10,s,o;function a(){return s=EMe(i),o=TMe(i),n()[0]<0?(s=K4(s),o=K4(o),r(_Me,wMe)):r(q4,X4),e}return e.base=function(l){return arguments.length?(i=+l,a()):i},e.domain=function(l){return arguments.length?(n(l),a()):n()},e.ticks=l=>{const c=n();let u=c[0],h=c[c.length-1];const f=h<u;f&&([u,h]=[h,u]);let d=s(u),p=s(h),m,g;const v=l==null?10:+l;let y=[];if(!(i%1)&&p-d<v){if(d=Math.floor(d),p=Math.ceil(p),u>0){for(;d<=p;++d)for(m=1;m<i;++m)if(g=d<0?m/o(-d):m*o(d),!(g<u)){if(g>h)break;y.push(g)}}else for(;d<=p;++d)for(m=i-1;m>=1;--m)if(g=d>0?m/o(-d):m*o(d),!(g<u)){if(g>h)break;y.push(g)}y.length*2<v&&(y=YO(u,h,v))}else y=YO(d,p,Math.min(p-d,v)).map(o);return f?y.reverse():y},e.tickFormat=(l,c)=>{if(l==null&&(l=10),c==null&&(c=i===10?"s":","),typeof c!="function"&&(!(i%1)&&(c=tb(c)).precision==null&&(c.trim=!0),c=l3(c)),l===1/0)return c;const u=Math.max(1,i*l/e.ticks().length);return h=>{let f=h/o(Math.round(s(h)));return f*i<i-.5&&(f*=i),f<=u?c(h):""}},e.nice=()=>n(jZ(n(),{floor:l=>o(Math.floor(s(l))),ceil:l=>o(Math.ceil(s(l)))})),e}function VZ(){const r=c3(rA()).domain([1,10]);return r.copy=()=>S_(r,VZ()).base(r.base()),ma.apply(r,arguments),r}function Y4(r){return function(e){return Math.sign(e)*Math.log1p(Math.abs(e/r))}}function Z4(r){return function(e){return Math.sign(e)*Math.expm1(Math.abs(e))*r}}function u3(r){var e=1,n=r(Y4(e),Z4(e));return n.constant=function(i){return arguments.length?r(Y4(e=+i),Z4(e)):e},Gh(n)}function GZ(){var r=u3(rA());return r.copy=function(){return S_(r,GZ()).constant(r.constant())},ma.apply(r,arguments)}function Q4(r){return function(e){return e<0?-Math.pow(-e,r):Math.pow(e,r)}}function MMe(r){return r<0?-Math.sqrt(-r):Math.sqrt(r)}function AMe(r){return r<0?-r*r:r*r}function h3(r){var e=r(Rs,Rs),n=1;function i(){return n===1?r(Rs,Rs):n===.5?r(MMe,AMe):r(Q4(n),Q4(1/n))}return e.exponent=function(s){return arguments.length?(n=+s,i()):n},Gh(e)}function f3(){var r=h3(rA());return r.copy=function(){return S_(r,f3()).exponent(r.exponent())},ma.apply(r,arguments),r}function CMe(){return f3.apply(null,arguments).exponent(.5)}function J4(r){return Math.sign(r)*r*r}function PMe(r){return Math.sign(r)*Math.sqrt(Math.abs(r))}function HZ(){var r=o3(),e=[0,1],n=!1,i;function s(o){var a=PMe(r(o));return isNaN(a)?i:n?Math.round(a):a}return s.invert=function(o){return r.invert(J4(o))},s.domain=function(o){return arguments.length?(r.domain(o),s):r.domain()},s.range=function(o){return arguments.length?(r.range((e=Array.from(o,JT)).map(J4)),s):e.slice()},s.rangeRound=function(o){return s.range(o).round(!0)},s.round=function(o){return arguments.length?(n=!!o,s):n},s.clamp=function(o){return arguments.length?(r.clamp(o),s):r.clamp()},s.unknown=function(o){return arguments.length?(i=o,s):i},s.copy=function(){return HZ(r.domain(),e).round(n).clamp(r.clamp()).unknown(i)},ma.apply(s,arguments),Gh(s)}function WZ(){var r=[],e=[],n=[],i;function s(){var a=0,l=Math.max(1,e.length);for(n=new Array(l-1);++a<l;)n[a-1]=hEe(r,a/l);return o}function o(a){return a==null||isNaN(a=+a)?i:e[b_(n,a)]}return o.invertExtent=function(a){var l=e.indexOf(a);return l<0?[NaN,NaN]:[l>0?n[l-1]:r[0],l<n.length?n[l]:r[r.length-1]]},o.domain=function(a){if(!arguments.length)return r.slice();r=[];for(let l of a)l!=null&&!isNaN(l=+l)&&r.push(l);return r.sort(bh),s()},o.range=function(a){return arguments.length?(e=Array.from(a),s()):e.slice()},o.unknown=function(a){return arguments.length?(i=a,o):i},o.quantiles=function(){return n.slice()},o.copy=function(){return WZ().domain(r).range(e).unknown(i)},ma.apply(o,arguments)}function qZ(){var r=0,e=1,n=1,i=[.5],s=[0,1],o;function a(c){return c!=null&&c<=c?s[b_(i,c,0,n)]:o}function l(){var c=-1;for(i=new Array(n);++c<n;)i[c]=((c+1)*e-(c-n)*r)/(n+1);return a}return a.domain=function(c){return arguments.length?([r,e]=c,r=+r,e=+e,l()):[r,e]},a.range=function(c){return arguments.length?(n=(s=Array.from(c)).length-1,l()):s.slice()},a.invertExtent=function(c){var u=s.indexOf(c);return u<0?[NaN,NaN]:u<1?[r,i[0]]:u>=n?[i[n-1],e]:[i[u-1],i[u]]},a.unknown=function(c){return arguments.length&&(o=c),a},a.thresholds=function(){return i.slice()},a.copy=function(){return qZ().domain([r,e]).range(s).unknown(o)},ma.apply(Gh(a),arguments)}function XZ(){var r=[.5],e=[0,1],n,i=1;function s(o){return o!=null&&o<=o?e[b_(r,o,0,i)]:n}return s.domain=function(o){return arguments.length?(r=Array.from(o),i=Math.min(r.length,e.length-1),s):r.slice()},s.range=function(o){return arguments.length?(e=Array.from(o),i=Math.min(r.length,e.length-1),s):e.slice()},s.invertExtent=function(o){var a=e.indexOf(o);return[r[a-1],r[a]]},s.unknown=function(o){return arguments.length?(n=o,s):n},s.copy=function(){return XZ().domain(r).range(e).unknown(n)},ma.apply(s,arguments)}const IR=new Date,LR=new Date;function gi(r,e,n,i){function s(o){return r(o=arguments.length===0?new Date:new Date(+o)),o}return s.floor=o=>(r(o=new Date(+o)),o),s.ceil=o=>(r(o=new Date(o-1)),e(o,1),r(o),o),s.round=o=>{const a=s(o),l=s.ceil(o);return o-a<l-o?a:l},s.offset=(o,a)=>(e(o=new Date(+o),a==null?1:Math.floor(a)),o),s.range=(o,a,l)=>{const c=[];if(o=s.ceil(o),l=l==null?1:Math.floor(l),!(o<a)||!(l>0))return c;let u;do c.push(u=new Date(+o)),e(o,l),r(o);while(u<o&&o<a);return c},s.filter=o=>gi(a=>{if(a>=a)for(;r(a),!o(a);)a.setTime(a-1)},(a,l)=>{if(a>=a)if(l<0)for(;++l<=0;)for(;e(a,-1),!o(a););else for(;--l>=0;)for(;e(a,1),!o(a););}),n&&(s.count=(o,a)=>(IR.setTime(+o),LR.setTime(+a),r(IR),r(LR),Math.floor(n(IR,LR))),s.every=o=>(o=Math.floor(o),!isFinite(o)||!(o>0)?null:o>1?s.filter(i?a=>i(a)%o===0:a=>s.count(0,a)%o===0):s)),s}const nE=gi(()=>{},(r,e)=>{r.setTime(+r+e)},(r,e)=>e-r);nE.every=r=>(r=Math.floor(r),!isFinite(r)||!(r>0)?null:r>1?gi(e=>{e.setTime(Math.floor(e/r)*r)},(e,n)=>{e.setTime(+e+n*r)},(e,n)=>(n-e)/r):nE);nE.range;const Lc=1e3,sa=Lc*60,Fc=sa*60,au=Fc*24,d3=au*7,eG=au*30,FR=au*365,Wf=gi(r=>{r.setTime(r-r.getMilliseconds())},(r,e)=>{r.setTime(+r+e*Lc)},(r,e)=>(e-r)/Lc,r=>r.getUTCSeconds());Wf.range;const p3=gi(r=>{r.setTime(r-r.getMilliseconds()-r.getSeconds()*Lc)},(r,e)=>{r.setTime(+r+e*sa)},(r,e)=>(e-r)/sa,r=>r.getMinutes());p3.range;const m3=gi(r=>{r.setUTCSeconds(0,0)},(r,e)=>{r.setTime(+r+e*sa)},(r,e)=>(e-r)/sa,r=>r.getUTCMinutes());m3.range;const g3=gi(r=>{r.setTime(r-r.getMilliseconds()-r.getSeconds()*Lc-r.getMinutes()*sa)},(r,e)=>{r.setTime(+r+e*Fc)},(r,e)=>(e-r)/Fc,r=>r.getHours());g3.range;const y3=gi(r=>{r.setUTCMinutes(0,0,0)},(r,e)=>{r.setTime(+r+e*Fc)},(r,e)=>(e-r)/Fc,r=>r.getUTCHours());y3.range;const T_=gi(r=>r.setHours(0,0,0,0),(r,e)=>r.setDate(r.getDate()+e),(r,e)=>(e-r-(e.getTimezoneOffset()-r.getTimezoneOffset())*sa)/au,r=>r.getDate()-1);T_.range;const iA=gi(r=>{r.setUTCHours(0,0,0,0)},(r,e)=>{r.setUTCDate(r.getUTCDate()+e)},(r,e)=>(e-r)/au,r=>r.getUTCDate()-1);iA.range;const KZ=gi(r=>{r.setUTCHours(0,0,0,0)},(r,e)=>{r.setUTCDate(r.getUTCDate()+e)},(r,e)=>(e-r)/au,r=>Math.floor(r/au));KZ.range;function kd(r){return gi(e=>{e.setDate(e.getDate()-(e.getDay()+7-r)%7),e.setHours(0,0,0,0)},(e,n)=>{e.setDate(e.getDate()+n*7)},(e,n)=>(n-e-(n.getTimezoneOffset()-e.getTimezoneOffset())*sa)/d3)}const sA=kd(0),rE=kd(1),RMe=kd(2),NMe=kd(3),_g=kd(4),OMe=kd(5),DMe=kd(6);sA.range;rE.range;RMe.range;NMe.range;_g.range;OMe.range;DMe.range;function Id(r){return gi(e=>{e.setUTCDate(e.getUTCDate()-(e.getUTCDay()+7-r)%7),e.setUTCHours(0,0,0,0)},(e,n)=>{e.setUTCDate(e.getUTCDate()+n*7)},(e,n)=>(n-e)/d3)}const oA=Id(0),iE=Id(1),kMe=Id(2),IMe=Id(3),wg=Id(4),LMe=Id(5),FMe=Id(6);oA.range;iE.range;kMe.range;IMe.range;wg.range;LMe.range;FMe.range;const v3=gi(r=>{r.setDate(1),r.setHours(0,0,0,0)},(r,e)=>{r.setMonth(r.getMonth()+e)},(r,e)=>e.getMonth()-r.getMonth()+(e.getFullYear()-r.getFullYear())*12,r=>r.getMonth());v3.range;const x3=gi(r=>{r.setUTCDate(1),r.setUTCHours(0,0,0,0)},(r,e)=>{r.setUTCMonth(r.getUTCMonth()+e)},(r,e)=>e.getUTCMonth()-r.getUTCMonth()+(e.getUTCFullYear()-r.getUTCFullYear())*12,r=>r.getUTCMonth());x3.range;const lu=gi(r=>{r.setMonth(0,1),r.setHours(0,0,0,0)},(r,e)=>{r.setFullYear(r.getFullYear()+e)},(r,e)=>e.getFullYear()-r.getFullYear(),r=>r.getFullYear());lu.every=r=>!isFinite(r=Math.floor(r))||!(r>0)?null:gi(e=>{e.setFullYear(Math.floor(e.getFullYear()/r)*r),e.setMonth(0,1),e.setHours(0,0,0,0)},(e,n)=>{e.setFullYear(e.getFullYear()+n*r)});lu.range;const cu=gi(r=>{r.setUTCMonth(0,1),r.setUTCHours(0,0,0,0)},(r,e)=>{r.setUTCFullYear(r.getUTCFullYear()+e)},(r,e)=>e.getUTCFullYear()-r.getUTCFullYear(),r=>r.getUTCFullYear());cu.every=r=>!isFinite(r=Math.floor(r))||!(r>0)?null:gi(e=>{e.setUTCFullYear(Math.floor(e.getUTCFullYear()/r)*r),e.setUTCMonth(0,1),e.setUTCHours(0,0,0,0)},(e,n)=>{e.setUTCFullYear(e.getUTCFullYear()+n*r)});cu.range;function YZ(r,e,n,i,s,o){const a=[[Wf,1,Lc],[Wf,5,5*Lc],[Wf,15,15*Lc],[Wf,30,30*Lc],[o,1,sa],[o,5,5*sa],[o,15,15*sa],[o,30,30*sa],[s,1,Fc],[s,3,3*Fc],[s,6,6*Fc],[s,12,12*Fc],[i,1,au],[i,2,2*au],[n,1,d3],[e,1,eG],[e,3,3*eG],[r,1,FR]];function l(u,h,f){const d=h<u;d&&([u,h]=[h,u]);const p=f&&typeof f.range=="function"?f:c(u,h,f),m=p?p.range(u,+h+1):[];return d?m.reverse():m}function c(u,h,f){const d=Math.abs(h-u)/f,p=n3(([,,v])=>v).right(a,d);if(p===a.length)return r.every(QO(u/FR,h/FR,f));if(p===0)return nE.every(Math.max(QO(u,h,f),1));const[m,g]=a[d/a[p-1][2]<a[p][2]/d?p-1:p];return m.every(g)}return[l,c]}const[BMe,UMe]=YZ(cu,x3,oA,KZ,y3,m3),[zMe,$Me]=YZ(lu,v3,sA,T_,g3,p3);function BR(r){if(0<=r.y&&r.y<100){var e=new Date(-1,r.m,r.d,r.H,r.M,r.S,r.L);return e.setFullYear(r.y),e}return new Date(r.y,r.m,r.d,r.H,r.M,r.S,r.L)}function UR(r){if(0<=r.y&&r.y<100){var e=new Date(Date.UTC(-1,r.m,r.d,r.H,r.M,r.S,r.L));return e.setUTCFullYear(r.y),e}return new Date(Date.UTC(r.y,r.m,r.d,r.H,r.M,r.S,r.L))}function _v(r,e,n){return{y:r,m:e,d:n,H:0,M:0,S:0,L:0}}function jMe(r){var e=r.dateTime,n=r.date,i=r.time,s=r.periods,o=r.days,a=r.shortDays,l=r.months,c=r.shortMonths,u=wv(s),h=Sv(s),f=wv(o),d=Sv(o),p=wv(a),m=Sv(a),g=wv(l),v=Sv(l),y=wv(c),x=Sv(c),b={a:z,A:U,b:G,B:H,c:null,d:oG,e:oG,f:hAe,g:_Ae,G:SAe,H:lAe,I:cAe,j:uAe,L:ZZ,m:fAe,M:dAe,p:Y,q:ee,Q:cG,s:uG,S:pAe,u:mAe,U:gAe,V:yAe,w:vAe,W:xAe,x:null,X:null,y:bAe,Y:wAe,Z:TAe,"%":lG},w={a:he,A:q,b:J,B:se,c:null,d:aG,e:aG,f:CAe,g:BAe,G:zAe,H:EAe,I:MAe,j:AAe,L:JZ,m:PAe,M:RAe,p:oe,q:Ee,Q:cG,s:uG,S:NAe,u:OAe,U:DAe,V:kAe,w:IAe,W:LAe,x:null,X:null,y:FAe,Y:UAe,Z:$Ae,"%":lG},_={a:A,A:P,b:D,B,c:C,d:iG,e:iG,f:iAe,g:rG,G:nG,H:sG,I:sG,j:eAe,L:rAe,m:JMe,M:tAe,p:M,q:QMe,Q:oAe,s:aAe,S:nAe,u:qMe,U:XMe,V:KMe,w:WMe,W:YMe,x:O,X:R,y:rG,Y:nG,Z:ZMe,"%":sAe};b.x=S(n,b),b.X=S(i,b),b.c=S(e,b),w.x=S(n,w),w.X=S(i,w),w.c=S(e,w);function S(ye,Ce){return function(Ge){var _e=[],Ke=-1,Q=0,kt=ye.length,ct,gt,ot;for(Ge instanceof Date||(Ge=new Date(+Ge));++Ke<kt;)ye.charCodeAt(Ke)===37&&(_e.push(ye.slice(Q,Ke)),(gt=tG[ct=ye.charAt(++Ke)])!=null?ct=ye.charAt(++Ke):gt=ct==="e"?" ":"0",(ot=Ce[ct])&&(ct=ot(Ge,gt)),_e.push(ct),Q=Ke+1);return _e.push(ye.slice(Q,Ke)),_e.join("")}}function T(ye,Ce){return function(Ge){var _e=_v(1900,void 0,1),Ke=E(_e,ye,Ge+="",0),Q,kt;if(Ke!=Ge.length)return null;if("Q"in _e)return new Date(_e.Q);if("s"in _e)return new Date(_e.s*1e3+("L"in _e?_e.L:0));if(Ce&&!("Z"in _e)&&(_e.Z=0),"p"in _e&&(_e.H=_e.H%12+_e.p*12),_e.m===void 0&&(_e.m="q"in _e?_e.q:0),"V"in _e){if(_e.V<1||_e.V>53)return null;"w"in _e||(_e.w=1),"Z"in _e?(Q=UR(_v(_e.y,0,1)),kt=Q.getUTCDay(),Q=kt>4||kt===0?iE.ceil(Q):iE(Q),Q=iA.offset(Q,(_e.V-1)*7),_e.y=Q.getUTCFullYear(),_e.m=Q.getUTCMonth(),_e.d=Q.getUTCDate()+(_e.w+6)%7):(Q=BR(_v(_e.y,0,1)),kt=Q.getDay(),Q=kt>4||kt===0?rE.ceil(Q):rE(Q),Q=T_.offset(Q,(_e.V-1)*7),_e.y=Q.getFullYear(),_e.m=Q.getMonth(),_e.d=Q.getDate()+(_e.w+6)%7)}else("W"in _e||"U"in _e)&&("w"in _e||(_e.w="u"in _e?_e.u%7:"W"in _e?1:0),kt="Z"in _e?UR(_v(_e.y,0,1)).getUTCDay():BR(_v(_e.y,0,1)).getDay(),_e.m=0,_e.d="W"in _e?(_e.w+6)%7+_e.W*7-(kt+5)%7:_e.w+_e.U*7-(kt+6)%7);return"Z"in _e?(_e.H+=_e.Z/100|0,_e.M+=_e.Z%100,UR(_e)):BR(_e)}}function E(ye,Ce,Ge,_e){for(var Ke=0,Q=Ce.length,kt=Ge.length,ct,gt;Ke<Q;){if(_e>=kt)return-1;if(ct=Ce.charCodeAt(Ke++),ct===37){if(ct=Ce.charAt(Ke++),gt=_[ct in tG?Ce.charAt(Ke++):ct],!gt||(_e=gt(ye,Ge,_e))<0)return-1}else if(ct!=Ge.charCodeAt(_e++))return-1}return _e}function M(ye,Ce,Ge){var _e=u.exec(Ce.slice(Ge));return _e?(ye.p=h.get(_e[0].toLowerCase()),Ge+_e[0].length):-1}function A(ye,Ce,Ge){var _e=p.exec(Ce.slice(Ge));return _e?(ye.w=m.get(_e[0].toLowerCase()),Ge+_e[0].length):-1}function P(ye,Ce,Ge){var _e=f.exec(Ce.slice(Ge));return _e?(ye.w=d.get(_e[0].toLowerCase()),Ge+_e[0].length):-1}function D(ye,Ce,Ge){var _e=y.exec(Ce.slice(Ge));return _e?(ye.m=x.get(_e[0].toLowerCase()),Ge+_e[0].length):-1}function B(ye,Ce,Ge){var _e=g.exec(Ce.slice(Ge));return _e?(ye.m=v.get(_e[0].toLowerCase()),Ge+_e[0].length):-1}function C(ye,Ce,Ge){return E(ye,e,Ce,Ge)}function O(ye,Ce,Ge){return E(ye,n,Ce,Ge)}function R(ye,Ce,Ge){return E(ye,i,Ce,Ge)}function z(ye){return a[ye.getDay()]}function U(ye){return o[ye.getDay()]}function G(ye){return c[ye.getMonth()]}function H(ye){return l[ye.getMonth()]}function Y(ye){return s[+(ye.getHours()>=12)]}function ee(ye){return 1+~~(ye.getMonth()/3)}function he(ye){return a[ye.getUTCDay()]}function q(ye){return o[ye.getUTCDay()]}function J(ye){return c[ye.getUTCMonth()]}function se(ye){return l[ye.getUTCMonth()]}function oe(ye){return s[+(ye.getUTCHours()>=12)]}function Ee(ye){return 1+~~(ye.getUTCMonth()/3)}return{format:function(ye){var Ce=S(ye+="",b);return Ce.toString=function(){return ye},Ce},parse:function(ye){var Ce=T(ye+="",!1);return Ce.toString=function(){return ye},Ce},utcFormat:function(ye){var Ce=S(ye+="",w);return Ce.toString=function(){return ye},Ce},utcParse:function(ye){var Ce=T(ye+="",!0);return Ce.toString=function(){return ye},Ce}}}var tG={"-":"",_:" ",0:"0"},Pi=/^\s*\d+/,VMe=/^%/,GMe=/[\\^$*+?|[\]().{}]/g;function vn(r,e,n){var i=r<0?"-":"",s=(i?-r:r)+"",o=s.length;return i+(o<n?new Array(n-o+1).join(e)+s:s)}function HMe(r){return r.replace(GMe,"\\$&")}function wv(r){return new RegExp("^(?:"+r.map(HMe).join("|")+")","i")}function Sv(r){return new Map(r.map((e,n)=>[e.toLowerCase(),n]))}function WMe(r,e,n){var i=Pi.exec(e.slice(n,n+1));return i?(r.w=+i[0],n+i[0].length):-1}function qMe(r,e,n){var i=Pi.exec(e.slice(n,n+1));return i?(r.u=+i[0],n+i[0].length):-1}function XMe(r,e,n){var i=Pi.exec(e.slice(n,n+2));return i?(r.U=+i[0],n+i[0].length):-1}function KMe(r,e,n){var i=Pi.exec(e.slice(n,n+2));return i?(r.V=+i[0],n+i[0].length):-1}function YMe(r,e,n){var i=Pi.exec(e.slice(n,n+2));return i?(r.W=+i[0],n+i[0].length):-1}function nG(r,e,n){var i=Pi.exec(e.slice(n,n+4));return i?(r.y=+i[0],n+i[0].length):-1}function rG(r,e,n){var i=Pi.exec(e.slice(n,n+2));return i?(r.y=+i[0]+(+i[0]>68?1900:2e3),n+i[0].length):-1}function ZMe(r,e,n){var i=/^(Z)|([+-]\d\d)(?::?(\d\d))?/.exec(e.slice(n,n+6));return i?(r.Z=i[1]?0:-(i[2]+(i[3]||"00")),n+i[0].length):-1}function QMe(r,e,n){var i=Pi.exec(e.slice(n,n+1));return i?(r.q=i[0]*3-3,n+i[0].length):-1}function JMe(r,e,n){var i=Pi.exec(e.slice(n,n+2));return i?(r.m=i[0]-1,n+i[0].length):-1}function iG(r,e,n){var i=Pi.exec(e.slice(n,n+2));return i?(r.d=+i[0],n+i[0].length):-1}function eAe(r,e,n){var i=Pi.exec(e.slice(n,n+3));return i?(r.m=0,r.d=+i[0],n+i[0].length):-1}function sG(r,e,n){var i=Pi.exec(e.slice(n,n+2));return i?(r.H=+i[0],n+i[0].length):-1}function tAe(r,e,n){var i=Pi.exec(e.slice(n,n+2));return i?(r.M=+i[0],n+i[0].length):-1}function nAe(r,e,n){var i=Pi.exec(e.slice(n,n+2));return i?(r.S=+i[0],n+i[0].length):-1}function rAe(r,e,n){var i=Pi.exec(e.slice(n,n+3));return i?(r.L=+i[0],n+i[0].length):-1}function iAe(r,e,n){var i=Pi.exec(e.slice(n,n+6));return i?(r.L=Math.floor(i[0]/1e3),n+i[0].length):-1}function sAe(r,e,n){var i=VMe.exec(e.slice(n,n+1));return i?n+i[0].length:-1}function oAe(r,e,n){var i=Pi.exec(e.slice(n));return i?(r.Q=+i[0],n+i[0].length):-1}function aAe(r,e,n){var i=Pi.exec(e.slice(n));return i?(r.s=+i[0],n+i[0].length):-1}function oG(r,e){return vn(r.getDate(),e,2)}function lAe(r,e){return vn(r.getHours(),e,2)}function cAe(r,e){return vn(r.getHours()%12||12,e,2)}function uAe(r,e){return vn(1+T_.count(lu(r),r),e,3)}function ZZ(r,e){return vn(r.getMilliseconds(),e,3)}function hAe(r,e){return ZZ(r,e)+"000"}function fAe(r,e){return vn(r.getMonth()+1,e,2)}function dAe(r,e){return vn(r.getMinutes(),e,2)}function pAe(r,e){return vn(r.getSeconds(),e,2)}function mAe(r){var e=r.getDay();return e===0?7:e}function gAe(r,e){return vn(sA.count(lu(r)-1,r),e,2)}function QZ(r){var e=r.getDay();return e>=4||e===0?_g(r):_g.ceil(r)}function yAe(r,e){return r=QZ(r),vn(_g.count(lu(r),r)+(lu(r).getDay()===4),e,2)}function vAe(r){return r.getDay()}function xAe(r,e){return vn(rE.count(lu(r)-1,r),e,2)}function bAe(r,e){return vn(r.getFullYear()%100,e,2)}function _Ae(r,e){return r=QZ(r),vn(r.getFullYear()%100,e,2)}function wAe(r,e){return vn(r.getFullYear()%1e4,e,4)}function SAe(r,e){var n=r.getDay();return r=n>=4||n===0?_g(r):_g.ceil(r),vn(r.getFullYear()%1e4,e,4)}function TAe(r){var e=r.getTimezoneOffset();return(e>0?"-":(e*=-1,"+"))+vn(e/60|0,"0",2)+vn(e%60,"0",2)}function aG(r,e){return vn(r.getUTCDate(),e,2)}function EAe(r,e){return vn(r.getUTCHours(),e,2)}function MAe(r,e){return vn(r.getUTCHours()%12||12,e,2)}function AAe(r,e){return vn(1+iA.count(cu(r),r),e,3)}function JZ(r,e){return vn(r.getUTCMilliseconds(),e,3)}function CAe(r,e){return JZ(r,e)+"000"}function PAe(r,e){return vn(r.getUTCMonth()+1,e,2)}function RAe(r,e){return vn(r.getUTCMinutes(),e,2)}function NAe(r,e){return vn(r.getUTCSeconds(),e,2)}function OAe(r){var e=r.getUTCDay();return e===0?7:e}function DAe(r,e){return vn(oA.count(cu(r)-1,r),e,2)}function eQ(r){var e=r.getUTCDay();return e>=4||e===0?wg(r):wg.ceil(r)}function kAe(r,e){return r=eQ(r),vn(wg.count(cu(r),r)+(cu(r).getUTCDay()===4),e,2)}function IAe(r){return r.getUTCDay()}function LAe(r,e){return vn(iE.count(cu(r)-1,r),e,2)}function FAe(r,e){return vn(r.getUTCFullYear()%100,e,2)}function BAe(r,e){return r=eQ(r),vn(r.getUTCFullYear()%100,e,2)}function UAe(r,e){return vn(r.getUTCFullYear()%1e4,e,4)}function zAe(r,e){var n=r.getUTCDay();return r=n>=4||n===0?wg(r):wg.ceil(r),vn(r.getUTCFullYear()%1e4,e,4)}function $Ae(){return"+0000"}function lG(){return"%"}function cG(r){return+r}function uG(r){return Math.floor(+r/1e3)}var Tp,tQ,nQ;jAe({dateTime:"%x, %X",date:"%-m/%-d/%Y",time:"%-I:%M:%S %p",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]});function jAe(r){return Tp=jMe(r),tQ=Tp.format,Tp.parse,nQ=Tp.utcFormat,Tp.utcParse,Tp}function VAe(r){return new Date(r)}function GAe(r){return r instanceof Date?+r:+new Date(+r)}function b3(r,e,n,i,s,o,a,l,c,u){var h=o3(),f=h.invert,d=h.domain,p=u(".%L"),m=u(":%S"),g=u("%I:%M"),v=u("%I %p"),y=u("%a %d"),x=u("%b %d"),b=u("%B"),w=u("%Y");function _(S){return(c(S)<S?p:l(S)<S?m:a(S)<S?g:o(S)<S?v:i(S)<S?s(S)<S?y:x:n(S)<S?b:w)(S)}return h.invert=function(S){return new Date(f(S))},h.domain=function(S){return arguments.length?d(Array.from(S,GAe)):d().map(VAe)},h.ticks=function(S){var T=d();return r(T[0],T[T.length-1],S??10)},h.tickFormat=function(S,T){return T==null?_:u(T)},h.nice=function(S){var T=d();return(!S||typeof S.range!="function")&&(S=e(T[0],T[T.length-1],S??10)),S?d(jZ(T,S)):h},h.copy=function(){return S_(h,b3(r,e,n,i,s,o,a,l,c,u))},h}function HAe(){return ma.apply(b3(zMe,$Me,lu,v3,sA,T_,g3,p3,Wf,tQ).domain([new Date(2e3,0,1),new Date(2e3,0,2)]),arguments)}function WAe(){return ma.apply(b3(BMe,UMe,cu,x3,oA,iA,y3,m3,Wf,nQ).domain([Date.UTC(2e3,0,1),Date.UTC(2e3,0,2)]),arguments)}function aA(){var r=0,e=1,n,i,s,o,a=Rs,l=!1,c;function u(f){return f==null||isNaN(f=+f)?c:a(s===0?.5:(f=(o(f)-n)*s,l?Math.max(0,Math.min(1,f)):f))}u.domain=function(f){return arguments.length?([r,e]=f,n=o(r=+r),i=o(e=+e),s=n===i?0:1/(i-n),u):[r,e]},u.clamp=function(f){return arguments.length?(l=!!f,u):l},u.interpolator=function(f){return arguments.length?(a=f,u):a};function h(f){return function(d){var p,m;return arguments.length?([p,m]=d,a=f(p,m),u):[a(0),a(1)]}}return u.range=h(_y),u.rangeRound=h(s3),u.unknown=function(f){return arguments.length?(c=f,u):c},function(f){return o=f,n=f(r),i=f(e),s=n===i?0:1/(i-n),u}}function Hh(r,e){return e.domain(r.domain()).interpolator(r.interpolator()).clamp(r.clamp()).unknown(r.unknown())}function rQ(){var r=Gh(aA()(Rs));return r.copy=function(){return Hh(r,rQ())},vu.apply(r,arguments)}function iQ(){var r=c3(aA()).domain([1,10]);return r.copy=function(){return Hh(r,iQ()).base(r.base())},vu.apply(r,arguments)}function sQ(){var r=u3(aA());return r.copy=function(){return Hh(r,sQ()).constant(r.constant())},vu.apply(r,arguments)}function _3(){var r=h3(aA());return r.copy=function(){return Hh(r,_3()).exponent(r.exponent())},vu.apply(r,arguments)}function qAe(){return _3.apply(null,arguments).exponent(.5)}function oQ(){var r=[],e=Rs;function n(i){if(i!=null&&!isNaN(i=+i))return e((b_(r,i,1)-1)/(r.length-1))}return n.domain=function(i){if(!arguments.length)return r.slice();r=[];for(let s of i)s!=null&&!isNaN(s=+s)&&r.push(s);return r.sort(bh),n},n.interpolator=function(i){return arguments.length?(e=i,n):e},n.range=function(){return r.map((i,s)=>e(s/(r.length-1)))},n.quantiles=function(i){return Array.from({length:i+1},(s,o)=>uEe(r,o/i))},n.copy=function(){return oQ(e).domain(r)},vu.apply(n,arguments)}function lA(){var r=0,e=.5,n=1,i=1,s,o,a,l,c,u=Rs,h,f=!1,d;function p(g){return isNaN(g=+g)?d:(g=.5+((g=+h(g))-o)*(i*g<i*o?l:c),u(f?Math.max(0,Math.min(1,g)):g))}p.domain=function(g){return arguments.length?([r,e,n]=g,s=h(r=+r),o=h(e=+e),a=h(n=+n),l=s===o?0:.5/(o-s),c=o===a?0:.5/(a-o),i=o<s?-1:1,p):[r,e,n]},p.clamp=function(g){return arguments.length?(f=!!g,p):f},p.interpolator=function(g){return arguments.length?(u=g,p):u};function m(g){return function(v){var y,x,b;return arguments.length?([y,x,b]=v,u=sMe(g,[y,x,b]),p):[u(0),u(.5),u(1)]}}return p.range=m(_y),p.rangeRound=m(s3),p.unknown=function(g){return arguments.length?(d=g,p):d},function(g){return h=g,s=g(r),o=g(e),a=g(n),l=s===o?0:.5/(o-s),c=o===a?0:.5/(a-o),i=o<s?-1:1,p}}function aQ(){var r=Gh(lA()(Rs));return r.copy=function(){return Hh(r,aQ())},vu.apply(r,arguments)}function lQ(){var r=c3(lA()).domain([.1,1,10]);return r.copy=function(){return Hh(r,lQ()).base(r.base())},vu.apply(r,arguments)}function cQ(){var r=u3(lA());return r.copy=function(){return Hh(r,cQ()).constant(r.constant())},vu.apply(r,arguments)}function w3(){var r=h3(lA());return r.copy=function(){return Hh(r,w3()).exponent(r.exponent())},vu.apply(r,arguments)}function XAe(){return w3.apply(null,arguments).exponent(.5)}function KAe(r){for(var e=r.length/6|0,n=new Array(e),i=0;i<e;)n[i]="#"+r.slice(i*6,++i*6);return n}const uQ=KAe("a6cee31f78b4b2df8a33a02cfb9a99e31a1cfdbf6fff7f00cab2d66a3d9affff99b15928");function sE(r){"@babel/helpers - typeof";return sE=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},sE(r)}var YAe=/^\s+/,ZAe=/\s+$/;function mt(r,e){if(r=r||"",e=e||{},r instanceof mt)return r;if(!(this instanceof mt))return new mt(r,e);var n=QAe(r);this._originalInput=r,this._r=n.r,this._g=n.g,this._b=n.b,this._a=n.a,this._roundA=Math.round(100*this._a)/100,this._format=e.format||n.format,this._gradientType=e.gradientType,this._r<1&&(this._r=Math.round(this._r)),this._g<1&&(this._g=Math.round(this._g)),this._b<1&&(this._b=Math.round(this._b)),this._ok=n.ok}mt.prototype={isDark:function(){return this.getBrightness()<128},isLight:function(){return!this.isDark()},isValid:function(){return this._ok},getOriginalInput:function(){return this._originalInput},getFormat:function(){return this._format},getAlpha:function(){return this._a},getBrightness:function(){var e=this.toRgb();return(e.r*299+e.g*587+e.b*114)/1e3},getLuminance:function(){var e=this.toRgb(),n,i,s,o,a,l;return n=e.r/255,i=e.g/255,s=e.b/255,n<=.03928?o=n/12.92:o=Math.pow((n+.055)/1.055,2.4),i<=.03928?a=i/12.92:a=Math.pow((i+.055)/1.055,2.4),s<=.03928?l=s/12.92:l=Math.pow((s+.055)/1.055,2.4),.2126*o+.7152*a+.0722*l},setAlpha:function(e){return this._a=hQ(e),this._roundA=Math.round(100*this._a)/100,this},toHsv:function(){var e=fG(this._r,this._g,this._b);return{h:e.h*360,s:e.s,v:e.v,a:this._a}},toHsvString:function(){var e=fG(this._r,this._g,this._b),n=Math.round(e.h*360),i=Math.round(e.s*100),s=Math.round(e.v*100);return this._a==1?"hsv("+n+", "+i+"%, "+s+"%)":"hsva("+n+", "+i+"%, "+s+"%, "+this._roundA+")"},toHsl:function(){var e=hG(this._r,this._g,this._b);return{h:e.h*360,s:e.s,l:e.l,a:this._a}},toHslString:function(){var e=hG(this._r,this._g,this._b),n=Math.round(e.h*360),i=Math.round(e.s*100),s=Math.round(e.l*100);return this._a==1?"hsl("+n+", "+i+"%, "+s+"%)":"hsla("+n+", "+i+"%, "+s+"%, "+this._roundA+")"},toHex:function(e){return dG(this._r,this._g,this._b,e)},toHexString:function(e){return"#"+this.toHex(e)},toHex8:function(e){return nCe(this._r,this._g,this._b,this._a,e)},toHex8String:function(e){return"#"+this.toHex8(e)},toRgb:function(){return{r:Math.round(this._r),g:Math.round(this._g),b:Math.round(this._b),a:this._a}},toRgbString:function(){return this._a==1?"rgb("+Math.round(this._r)+", "+Math.round(this._g)+", "+Math.round(this._b)+")":"rgba("+Math.round(this._r)+", "+Math.round(this._g)+", "+Math.round(this._b)+", "+this._roundA+")"},toPercentageRgb:function(){return{r:Math.round(ir(this._r,255)*100)+"%",g:Math.round(ir(this._g,255)*100)+"%",b:Math.round(ir(this._b,255)*100)+"%",a:this._a}},toPercentageRgbString:function(){return this._a==1?"rgb("+Math.round(ir(this._r,255)*100)+"%, "+Math.round(ir(this._g,255)*100)+"%, "+Math.round(ir(this._b,255)*100)+"%)":"rgba("+Math.round(ir(this._r,255)*100)+"%, "+Math.round(ir(this._g,255)*100)+"%, "+Math.round(ir(this._b,255)*100)+"%, "+this._roundA+")"},toName:function(){return this._a===0?"transparent":this._a<1?!1:pCe[dG(this._r,this._g,this._b,!0)]||!1},toFilter:function(e){var n="#"+pG(this._r,this._g,this._b,this._a),i=n,s=this._gradientType?"GradientType = 1, ":"";if(e){var o=mt(e);i="#"+pG(o._r,o._g,o._b,o._a)}return"progid:DXImageTransform.Microsoft.gradient("+s+"startColorstr="+n+",endColorstr="+i+")"},toString:function(e){var n=!!e;e=e||this._format;var i=!1,s=this._a<1&&this._a>=0,o=!n&&s&&(e==="hex"||e==="hex6"||e==="hex3"||e==="hex4"||e==="hex8"||e==="name");return o?e==="name"&&this._a===0?this.toName():this.toRgbString():(e==="rgb"&&(i=this.toRgbString()),e==="prgb"&&(i=this.toPercentageRgbString()),(e==="hex"||e==="hex6")&&(i=this.toHexString()),e==="hex3"&&(i=this.toHexString(!0)),e==="hex4"&&(i=this.toHex8String(!0)),e==="hex8"&&(i=this.toHex8String()),e==="name"&&(i=this.toName()),e==="hsl"&&(i=this.toHslString()),e==="hsv"&&(i=this.toHsvString()),i||this.toHexString())},clone:function(){return mt(this.toString())},_applyModification:function(e,n){var i=e.apply(null,[this].concat([].slice.call(n)));return this._r=i._r,this._g=i._g,this._b=i._b,this.setAlpha(i._a),this},lighten:function(){return this._applyModification(oCe,arguments)},brighten:function(){return this._applyModification(aCe,arguments)},darken:function(){return this._applyModification(lCe,arguments)},desaturate:function(){return this._applyModification(rCe,arguments)},saturate:function(){return this._applyModification(iCe,arguments)},greyscale:function(){return this._applyModification(sCe,arguments)},spin:function(){return this._applyModification(cCe,arguments)},_applyCombination:function(e,n){return e.apply(null,[this].concat([].slice.call(n)))},analogous:function(){return this._applyCombination(fCe,arguments)},complement:function(){return this._applyCombination(uCe,arguments)},monochromatic:function(){return this._applyCombination(dCe,arguments)},splitcomplement:function(){return this._applyCombination(hCe,arguments)},triad:function(){return this._applyCombination(mG,[3])},tetrad:function(){return this._applyCombination(mG,[4])}};mt.fromRatio=function(r,e){if(sE(r)=="object"){var n={};for(var i in r)r.hasOwnProperty(i)&&(i==="a"?n[i]=r[i]:n[i]=o0(r[i]));r=n}return mt(r,e)};function QAe(r){var e={r:0,g:0,b:0},n=1,i=null,s=null,o=null,a=!1,l=!1;return typeof r=="string"&&(r=vCe(r)),sE(r)=="object"&&(dc(r.r)&&dc(r.g)&&dc(r.b)?(e=JAe(r.r,r.g,r.b),a=!0,l=String(r.r).substr(-1)==="%"?"prgb":"rgb"):dc(r.h)&&dc(r.s)&&dc(r.v)?(i=o0(r.s),s=o0(r.v),e=tCe(r.h,i,s),a=!0,l="hsv"):dc(r.h)&&dc(r.s)&&dc(r.l)&&(i=o0(r.s),o=o0(r.l),e=eCe(r.h,i,o),a=!0,l="hsl"),r.hasOwnProperty("a")&&(n=r.a)),n=hQ(n),{ok:a,format:r.format||l,r:Math.min(255,Math.max(e.r,0)),g:Math.min(255,Math.max(e.g,0)),b:Math.min(255,Math.max(e.b,0)),a:n}}function JAe(r,e,n){return{r:ir(r,255)*255,g:ir(e,255)*255,b:ir(n,255)*255}}function hG(r,e,n){r=ir(r,255),e=ir(e,255),n=ir(n,255);var i=Math.max(r,e,n),s=Math.min(r,e,n),o,a,l=(i+s)/2;if(i==s)o=a=0;else{var c=i-s;switch(a=l>.5?c/(2-i-s):c/(i+s),i){case r:o=(e-n)/c+(e<n?6:0);break;case e:o=(n-r)/c+2;break;case n:o=(r-e)/c+4;break}o/=6}return{h:o,s:a,l}}function eCe(r,e,n){var i,s,o;r=ir(r,360),e=ir(e,100),n=ir(n,100);function a(u,h,f){return f<0&&(f+=1),f>1&&(f-=1),f<1/6?u+(h-u)*6*f:f<1/2?h:f<2/3?u+(h-u)*(2/3-f)*6:u}if(e===0)i=s=o=n;else{var l=n<.5?n*(1+e):n+e-n*e,c=2*n-l;i=a(c,l,r+1/3),s=a(c,l,r),o=a(c,l,r-1/3)}return{r:i*255,g:s*255,b:o*255}}function fG(r,e,n){r=ir(r,255),e=ir(e,255),n=ir(n,255);var i=Math.max(r,e,n),s=Math.min(r,e,n),o,a,l=i,c=i-s;if(a=i===0?0:c/i,i==s)o=0;else{switch(i){case r:o=(e-n)/c+(e<n?6:0);break;case e:o=(n-r)/c+2;break;case n:o=(r-e)/c+4;break}o/=6}return{h:o,s:a,v:l}}function tCe(r,e,n){r=ir(r,360)*6,e=ir(e,100),n=ir(n,100);var i=Math.floor(r),s=r-i,o=n*(1-e),a=n*(1-s*e),l=n*(1-(1-s)*e),c=i%6,u=[n,a,o,o,l,n][c],h=[l,n,n,a,o,o][c],f=[o,o,l,n,n,a][c];return{r:u*255,g:h*255,b:f*255}}function dG(r,e,n,i){var s=[Xa(Math.round(r).toString(16)),Xa(Math.round(e).toString(16)),Xa(Math.round(n).toString(16))];return i&&s[0].charAt(0)==s[0].charAt(1)&&s[1].charAt(0)==s[1].charAt(1)&&s[2].charAt(0)==s[2].charAt(1)?s[0].charAt(0)+s[1].charAt(0)+s[2].charAt(0):s.join("")}function nCe(r,e,n,i,s){var o=[Xa(Math.round(r).toString(16)),Xa(Math.round(e).toString(16)),Xa(Math.round(n).toString(16)),Xa(fQ(i))];return s&&o[0].charAt(0)==o[0].charAt(1)&&o[1].charAt(0)==o[1].charAt(1)&&o[2].charAt(0)==o[2].charAt(1)&&o[3].charAt(0)==o[3].charAt(1)?o[0].charAt(0)+o[1].charAt(0)+o[2].charAt(0)+o[3].charAt(0):o.join("")}function pG(r,e,n,i){var s=[Xa(fQ(i)),Xa(Math.round(r).toString(16)),Xa(Math.round(e).toString(16)),Xa(Math.round(n).toString(16))];return s.join("")}mt.equals=function(r,e){return!r||!e?!1:mt(r).toRgbString()==mt(e).toRgbString()};mt.random=function(){return mt.fromRatio({r:Math.random(),g:Math.random(),b:Math.random()})};function rCe(r,e){e=e===0?0:e||10;var n=mt(r).toHsl();return n.s-=e/100,n.s=cA(n.s),mt(n)}function iCe(r,e){e=e===0?0:e||10;var n=mt(r).toHsl();return n.s+=e/100,n.s=cA(n.s),mt(n)}function sCe(r){return mt(r).desaturate(100)}function oCe(r,e){e=e===0?0:e||10;var n=mt(r).toHsl();return n.l+=e/100,n.l=cA(n.l),mt(n)}function aCe(r,e){e=e===0?0:e||10;var n=mt(r).toRgb();return n.r=Math.max(0,Math.min(255,n.r-Math.round(255*-(e/100)))),n.g=Math.max(0,Math.min(255,n.g-Math.round(255*-(e/100)))),n.b=Math.max(0,Math.min(255,n.b-Math.round(255*-(e/100)))),mt(n)}function lCe(r,e){e=e===0?0:e||10;var n=mt(r).toHsl();return n.l-=e/100,n.l=cA(n.l),mt(n)}function cCe(r,e){var n=mt(r).toHsl(),i=(n.h+e)%360;return n.h=i<0?360+i:i,mt(n)}function uCe(r){var e=mt(r).toHsl();return e.h=(e.h+180)%360,mt(e)}function mG(r,e){if(isNaN(e)||e<=0)throw new Error("Argument to polyad must be a positive number");for(var n=mt(r).toHsl(),i=[mt(r)],s=360/e,o=1;o<e;o++)i.push(mt({h:(n.h+o*s)%360,s:n.s,l:n.l}));return i}function hCe(r){var e=mt(r).toHsl(),n=e.h;return[mt(r),mt({h:(n+72)%360,s:e.s,l:e.l}),mt({h:(n+216)%360,s:e.s,l:e.l})]}function fCe(r,e,n){e=e||6,n=n||30;var i=mt(r).toHsl(),s=360/n,o=[mt(r)];for(i.h=(i.h-(s*e>>1)+720)%360;--e;)i.h=(i.h+s)%360,o.push(mt(i));return o}function dCe(r,e){e=e||6;for(var n=mt(r).toHsv(),i=n.h,s=n.s,o=n.v,a=[],l=1/e;e--;)a.push(mt({h:i,s,v:o})),o=(o+l)%1;return a}mt.mix=function(r,e,n){n=n===0?0:n||50;var i=mt(r).toRgb(),s=mt(e).toRgb(),o=n/100,a={r:(s.r-i.r)*o+i.r,g:(s.g-i.g)*o+i.g,b:(s.b-i.b)*o+i.b,a:(s.a-i.a)*o+i.a};return mt(a)};mt.readability=function(r,e){var n=mt(r),i=mt(e);return(Math.max(n.getLuminance(),i.getLuminance())+.05)/(Math.min(n.getLuminance(),i.getLuminance())+.05)};mt.isReadable=function(r,e,n){var i=mt.readability(r,e),s,o;switch(o=!1,s=xCe(n),s.level+s.size){case"AAsmall":case"AAAlarge":o=i>=4.5;break;case"AAlarge":o=i>=3;break;case"AAAsmall":o=i>=7;break}return o};mt.mostReadable=function(r,e,n){var i=null,s=0,o,a,l,c;n=n||{},a=n.includeFallbackColors,l=n.level,c=n.size;for(var u=0;u<e.length;u++)o=mt.readability(r,e[u]),o>s&&(s=o,i=mt(e[u]));return mt.isReadable(r,i,{level:l,size:c})||!a?i:(n.includeFallbackColors=!1,mt.mostReadable(r,["#fff","#000"],n))};var sD=mt.names={aliceblue:"f0f8ff",antiquewhite:"faebd7",aqua:"0ff",aquamarine:"7fffd4",azure:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"000",blanchedalmond:"ffebcd",blue:"00f",blueviolet:"8a2be2",brown:"a52a2a",burlywood:"deb887",burntsienna:"ea7e5d",cadetblue:"5f9ea0",chartreuse:"7fff00",chocolate:"d2691e",coral:"ff7f50",cornflowerblue:"6495ed",cornsilk:"fff8dc",crimson:"dc143c",cyan:"0ff",darkblue:"00008b",darkcyan:"008b8b",darkgoldenrod:"b8860b",darkgray:"a9a9a9",darkgreen:"006400",darkgrey:"a9a9a9",darkkhaki:"bdb76b",darkmagenta:"8b008b",darkolivegreen:"556b2f",darkorange:"ff8c00",darkorchid:"9932cc",darkred:"8b0000",darksalmon:"e9967a",darkseagreen:"8fbc8f",darkslateblue:"483d8b",darkslategray:"2f4f4f",darkslategrey:"2f4f4f",darkturquoise:"00ced1",darkviolet:"9400d3",deeppink:"ff1493",deepskyblue:"00bfff",dimgray:"696969",dimgrey:"696969",dodgerblue:"1e90ff",firebrick:"b22222",floralwhite:"fffaf0",forestgreen:"228b22",fuchsia:"f0f",gainsboro:"dcdcdc",ghostwhite:"f8f8ff",gold:"ffd700",goldenrod:"daa520",gray:"808080",green:"008000",greenyellow:"adff2f",grey:"808080",honeydew:"f0fff0",hotpink:"ff69b4",indianred:"cd5c5c",indigo:"4b0082",ivory:"fffff0",khaki:"f0e68c",lavender:"e6e6fa",lavenderblush:"fff0f5",lawngreen:"7cfc00",lemonchiffon:"fffacd",lightblue:"add8e6",lightcoral:"f08080",lightcyan:"e0ffff",lightgoldenrodyellow:"fafad2",lightgray:"d3d3d3",lightgreen:"90ee90",lightgrey:"d3d3d3",lightpink:"ffb6c1",lightsalmon:"ffa07a",lightseagreen:"20b2aa",lightskyblue:"87cefa",lightslategray:"789",lightslategrey:"789",lightsteelblue:"b0c4de",lightyellow:"ffffe0",lime:"0f0",limegreen:"32cd32",linen:"faf0e6",magenta:"f0f",maroon:"800000",mediumaquamarine:"66cdaa",mediumblue:"0000cd",mediumorchid:"ba55d3",mediumpurple:"9370db",mediumseagreen:"3cb371",mediumslateblue:"7b68ee",mediumspringgreen:"00fa9a",mediumturquoise:"48d1cc",mediumvioletred:"c71585",midnightblue:"191970",mintcream:"f5fffa",mistyrose:"ffe4e1",moccasin:"ffe4b5",navajowhite:"ffdead",navy:"000080",oldlace:"fdf5e6",olive:"808000",olivedrab:"6b8e23",orange:"ffa500",orangered:"ff4500",orchid:"da70d6",palegoldenrod:"eee8aa",palegreen:"98fb98",paleturquoise:"afeeee",palevioletred:"db7093",papayawhip:"ffefd5",peachpuff:"ffdab9",peru:"cd853f",pink:"ffc0cb",plum:"dda0dd",powderblue:"b0e0e6",purple:"800080",rebeccapurple:"663399",red:"f00",rosybrown:"bc8f8f",royalblue:"4169e1",saddlebrown:"8b4513",salmon:"fa8072",sandybrown:"f4a460",seagreen:"2e8b57",seashell:"fff5ee",sienna:"a0522d",silver:"c0c0c0",skyblue:"87ceeb",slateblue:"6a5acd",slategray:"708090",slategrey:"708090",snow:"fffafa",springgreen:"00ff7f",steelblue:"4682b4",tan:"d2b48c",teal:"008080",thistle:"d8bfd8",tomato:"ff6347",turquoise:"40e0d0",violet:"ee82ee",wheat:"f5deb3",white:"fff",whitesmoke:"f5f5f5",yellow:"ff0",yellowgreen:"9acd32"},pCe=mt.hexNames=mCe(sD);function mCe(r){var e={};for(var n in r)r.hasOwnProperty(n)&&(e[r[n]]=n);return e}function hQ(r){return r=parseFloat(r),(isNaN(r)||r<0||r>1)&&(r=1),r}function ir(r,e){gCe(r)&&(r="100%");var n=yCe(r);return r=Math.min(e,Math.max(0,parseFloat(r))),n&&(r=parseInt(r*e,10)/100),Math.abs(r-e)<1e-6?1:r%e/parseFloat(e)}function cA(r){return Math.min(1,Math.max(0,r))}function yo(r){return parseInt(r,16)}function gCe(r){return typeof r=="string"&&r.indexOf(".")!=-1&&parseFloat(r)===1}function yCe(r){return typeof r=="string"&&r.indexOf("%")!=-1}function Xa(r){return r.length==1?"0"+r:""+r}function o0(r){return r<=1&&(r=r*100+"%"),r}function fQ(r){return Math.round(parseFloat(r)*255).toString(16)}function gG(r){return yo(r)/255}var Pa=function(){var r="[-\\+]?\\d+%?",e="[-\\+]?\\d*\\.\\d+%?",n="(?:"+e+")|(?:"+r+")",i="[\\s|\\(]+("+n+")[,|\\s]+("+n+")[,|\\s]+("+n+")\\s*\\)?",s="[\\s|\\(]+("+n+")[,|\\s]+("+n+")[,|\\s]+("+n+")[,|\\s]+("+n+")\\s*\\)?";return{CSS_UNIT:new RegExp(n),rgb:new RegExp("rgb"+i),rgba:new RegExp("rgba"+s),hsl:new RegExp("hsl"+i),hsla:new RegExp("hsla"+s),hsv:new RegExp("hsv"+i),hsva:new RegExp("hsva"+s),hex3:/^#?([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,hex6:/^#?([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/,hex4:/^#?([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,hex8:/^#?([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/}}();function dc(r){return!!Pa.CSS_UNIT.exec(r)}function vCe(r){r=r.replace(YAe,"").replace(ZAe,"").toLowerCase();var e=!1;if(sD[r])r=sD[r],e=!0;else if(r=="transparent")return{r:0,g:0,b:0,a:0,format:"name"};var n;return(n=Pa.rgb.exec(r))?{r:n[1],g:n[2],b:n[3]}:(n=Pa.rgba.exec(r))?{r:n[1],g:n[2],b:n[3],a:n[4]}:(n=Pa.hsl.exec(r))?{h:n[1],s:n[2],l:n[3]}:(n=Pa.hsla.exec(r))?{h:n[1],s:n[2],l:n[3],a:n[4]}:(n=Pa.hsv.exec(r))?{h:n[1],s:n[2],v:n[3]}:(n=Pa.hsva.exec(r))?{h:n[1],s:n[2],v:n[3],a:n[4]}:(n=Pa.hex8.exec(r))?{r:yo(n[1]),g:yo(n[2]),b:yo(n[3]),a:gG(n[4]),format:e?"name":"hex8"}:(n=Pa.hex6.exec(r))?{r:yo(n[1]),g:yo(n[2]),b:yo(n[3]),format:e?"name":"hex"}:(n=Pa.hex4.exec(r))?{r:yo(n[1]+""+n[1]),g:yo(n[2]+""+n[2]),b:yo(n[3]+""+n[3]),a:gG(n[4]+""+n[4]),format:e?"name":"hex8"}:(n=Pa.hex3.exec(r))?{r:yo(n[1]+""+n[1]),g:yo(n[2]+""+n[2]),b:yo(n[3]+""+n[3]),format:e?"name":"hex"}:!1}function xCe(r){var e,n;return r=r||{level:"AA",size:"small"},e=(r.level||"AA").toUpperCase(),n=(r.size||"small").toLowerCase(),e!=="AA"&&e!=="AAA"&&(e="AA"),n!=="small"&&n!=="large"&&(n="small"),{level:e,size:n}}function oD(r,e){(e==null||e>r.length)&&(e=r.length);for(var n=0,i=Array(e);n<e;n++)i[n]=r[n];return i}function bCe(r){if(Array.isArray(r))return r}function _Ce(r){if(Array.isArray(r))return oD(r)}function dQ(r,e,n){if(typeof r=="function"?r===e:r.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}function wCe(r){if(r===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return r}function pQ(r,e,n){return e=Sg(e),RCe(r,S3()?Reflect.construct(e,n||[],Sg(r).constructor):e.apply(r,n))}function SCe(r,e){if(e.has(r))throw new TypeError("Cannot initialize the same private elements twice on an object")}function mQ(r,e){if(!(r instanceof e))throw new TypeError("Cannot call a class as a function")}function zR(r,e){return r.get(dQ(r,e))}function yG(r,e,n){SCe(r,e),e.set(r,n)}function vG(r,e,n){return r.set(dQ(r,e),n),n}function gQ(r,e,n){if(S3())return Reflect.construct.apply(null,arguments);var i=[null];i.push.apply(i,e);var s=new(r.bind.apply(r,i));return s}function TCe(r,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(r,xQ(i.key),i)}}function yQ(r,e,n){return e&&TCe(r.prototype,e),Object.defineProperty(r,"prototype",{writable:!1}),r}function uA(r,e,n){return(e=xQ(e))in r?Object.defineProperty(r,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):r[e]=n,r}function aD(){return aD=typeof Reflect<"u"&&Reflect.get?Reflect.get.bind():function(r,e,n){var i=NCe(r,e);if(i){var s=Object.getOwnPropertyDescriptor(i,e);return s.get?s.get.call(arguments.length<3?r:n):s.value}},aD.apply(null,arguments)}function Sg(r){return Sg=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},Sg(r)}function vQ(r,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");r.prototype=Object.create(e&&e.prototype,{constructor:{value:r,writable:!0,configurable:!0}}),Object.defineProperty(r,"prototype",{writable:!1}),e&&lD(r,e)}function S3(){try{var r=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(S3=function(){return!!r})()}function ECe(r){if(typeof Symbol<"u"&&r[Symbol.iterator]!=null||r["@@iterator"]!=null)return Array.from(r)}function MCe(r,e){var n=r==null?null:typeof Symbol<"u"&&r[Symbol.iterator]||r["@@iterator"];if(n!=null){var i,s,o,a,l=[],c=!0,u=!1;try{if(o=(n=n.call(r)).next,e!==0)for(;!(c=(i=o.call(n)).done)&&(l.push(i.value),l.length!==e);c=!0);}catch(h){u=!0,s=h}finally{try{if(!c&&n.return!=null&&(a=n.return(),Object(a)!==a))return}finally{if(u)throw s}}return l}}function ACe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function CCe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function xG(r,e){var n=Object.keys(r);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(r);e&&(i=i.filter(function(s){return Object.getOwnPropertyDescriptor(r,s).enumerable})),n.push.apply(n,i)}return n}function PCe(r){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?xG(Object(n),!0).forEach(function(i){uA(r,i,n[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(n)):xG(Object(n)).forEach(function(i){Object.defineProperty(r,i,Object.getOwnPropertyDescriptor(n,i))})}return r}function RCe(r,e){if(e&&(typeof e=="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return wCe(r)}function lD(r,e){return lD=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},lD(r,e)}function z0(r,e){return bCe(r)||MCe(r,e)||bQ(r,e)||ACe()}function NCe(r,e){for(;!{}.hasOwnProperty.call(r,e)&&(r=Sg(r))!==null;);return r}function $R(r,e,n,i){var s=aD(Sg(r.prototype),e,n);return typeof s=="function"?function(o){return s.apply(n,o)}:s}function La(r){return _Ce(r)||ECe(r)||bQ(r)||CCe()}function OCe(r,e){if(typeof r!="object"||!r)return r;var n=r[Symbol.toPrimitive];if(n!==void 0){var i=n.call(r,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(r)}function xQ(r){var e=OCe(r,"string");return typeof e=="symbol"?e:e+""}function cD(r){"@babel/helpers - typeof";return cD=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},cD(r)}function bQ(r,e){if(r){if(typeof r=="string")return oD(r,e);var n={}.toString.call(r).slice(8,-1);return n==="Object"&&r.constructor&&(n=r.constructor.name),n==="Map"||n==="Set"?Array.from(r):n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?oD(r,e):void 0}}var _Q=function(e){e instanceof Array?e.forEach(_Q):(e.map&&e.map.dispose(),e.dispose())},wQ=function(e){e.geometry&&e.geometry.dispose(),e.material&&_Q(e.material),e.texture&&e.texture.dispose(),e.children&&e.children.forEach(wQ)},uD=function(e){for(;e.children.length;){var n=e.children[0];e.remove(n),wQ(n)}},jR=new WeakMap,wS=new WeakMap,Tv=function(r){function e(n){var i,s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},o=s.dataBindAttr,a=o===void 0?"__data":o,l=s.objBindAttr,c=l===void 0?"__threeObj":l;return mQ(this,e),i=pQ(this,e),uA(i,"scene",void 0),yG(i,jR,void 0),yG(i,wS,void 0),i.scene=n,vG(jR,i,a),vG(wS,i,c),i.onRemoveObj(function(){}),i}return vQ(e,r),yQ(e,[{key:"onCreateObj",value:function(i){var s=this;return $R(e,"onCreateObj",this)([function(o){var a=i(o);return o[zR(wS,s)]=a,a[zR(jR,s)]=o,s.scene.add(a),a}]),this}},{key:"onRemoveObj",value:function(i){var s=this;return $R(e,"onRemoveObj",this)([function(o,a){var l=$R(e,"getData",s)([o]);i(o,a),s.scene.remove(o),uD(o),delete l[zR(wS,s)]}]),this}}])}(CEe),Ev=function(e){return isNaN(e)?parseInt(mt(e).toHex(),16):e},VR=function(e){return isNaN(e)?mt(e).getAlpha():1},DCe=__(uQ);function bG(r,e,n){!e||typeof n!="string"||r.filter(function(i){return!i[n]}).forEach(function(i){i[n]=DCe(e(i))})}function kCe(r,e){var n=r.nodes,i=r.links,s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},o=s.nodeFilter,a=o===void 0?function(){return!0}:o,l=s.onLoopError,c=l===void 0?function(p){throw"Invalid DAG structure! Found cycle in node path: ".concat(p.join(" -> "),".")}:l,u={};n.forEach(function(p){return u[e(p)]={data:p,out:[],depth:-1,skip:!a(p)}}),i.forEach(function(p){var m=p.source,g=p.target,v=w(m),y=w(g);if(!u.hasOwnProperty(v))throw"Missing source node with id: ".concat(v);if(!u.hasOwnProperty(y))throw"Missing target node with id: ".concat(y);var x=u[v],b=u[y];x.out.push(b);function w(_){return cD(_)==="object"?e(_):_}});var h=[];d(Object.values(u));var f=Object.assign.apply(Object,[{}].concat(La(Object.entries(u).filter(function(p){var m=z0(p,2),g=m[1];return!g.skip}).map(function(p){var m=z0(p,2),g=m[0],v=m[1];return uA({},g,v.depth)}))));return f;function d(p){for(var m=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],g=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,v=function(){var w=p[y];if(m.indexOf(w)!==-1){var _=[].concat(La(m.slice(m.indexOf(w))),[w]).map(function(S){return e(S.data)});return h.some(function(S){return S.length===_.length&&S.every(function(T,E){return T===_[E]})})||(h.push(_),c(_)),1}g>w.depth&&(w.depth=g,d(w.out,[].concat(La(m),[w]),g+(w.skip?0:1)))},y=0,x=p.length;y<x;y++)v()}}var Ct=window.THREE?window.THREE:{Group:am,Mesh:Jn,MeshLambertMaterial:IY,Color:pt,BufferGeometry:ji,BufferAttribute:hi,Matrix4:sn,Vector3:K,SphereGeometry:xd,CylinderGeometry:m_,TubeGeometry:zF,ConeGeometry:FF,Line:RY,LineBasicMaterial:p_,QuadraticBezierCurve3:UF,CubicBezierCurve3:DY,Box3:Od},_G={graph:U1e,forcelayout:xTe},ICe=2,GR=new Ct.BufferGeometry().setAttribute?"setAttribute":"addAttribute",SS=new Ct.BufferGeometry().applyMatrix4?"applyMatrix4":"applyMatrix",LCe=Vh({props:{jsonUrl:{onChange:function(e,n){var i=this;e&&!n.fetchingJson&&(n.fetchingJson=!0,n.onLoading(),fetch(e).then(function(s){return s.json()}).then(function(s){n.fetchingJson=!1,n.onFinishLoading(s),i.graphData(s)}))},triggerUpdate:!1},graphData:{default:{nodes:[],links:[]},onChange:function(e,n){n.engineRunning=!1}},numDimensions:{default:3,onChange:function(e,n){var i=n.d3ForceLayout.force("charge");i&&i.strength(e>2?-60:-30),e<3&&s(n.graphData.nodes,"z"),e<2&&s(n.graphData.nodes,"y");function s(o,a){o.forEach(function(l){delete l[a],delete l["v".concat(a)]})}}},dagMode:{onChange:function(e,n){!e&&n.forceEngine==="d3"&&(n.graphData.nodes||[]).forEach(function(i){return i.fx=i.fy=i.fz=void 0})}},dagLevelDistance:{},dagNodeFilter:{default:function(e){return!0}},onDagError:{triggerUpdate:!1},nodeRelSize:{default:4},nodeId:{default:"id"},nodeVal:{default:"val"},nodeResolution:{default:8},nodeColor:{default:"color"},nodeAutoColorBy:{},nodeOpacity:{default:.75},nodeVisibility:{default:!0},nodeThreeObject:{},nodeThreeObjectExtend:{default:!1},nodePositionUpdate:{triggerUpdate:!1},linkSource:{default:"source"},linkTarget:{default:"target"},linkVisibility:{default:!0},linkColor:{default:"color"},linkAutoColorBy:{},linkOpacity:{default:.2},linkWidth:{},linkResolution:{default:6},linkCurvature:{default:0,triggerUpdate:!1},linkCurveRotation:{default:0,triggerUpdate:!1},linkMaterial:{},linkThreeObject:{},linkThreeObjectExtend:{default:!1},linkPositionUpdate:{triggerUpdate:!1},linkDirectionalArrowLength:{default:0},linkDirectionalArrowColor:{},linkDirectionalArrowRelPos:{default:.5,triggerUpdate:!1},linkDirectionalArrowResolution:{default:8},linkDirectionalParticles:{default:0},linkDirectionalParticleSpeed:{default:.01,triggerUpdate:!1},linkDirectionalParticleWidth:{default:.5},linkDirectionalParticleColor:{},linkDirectionalParticleResolution:{default:4},forceEngine:{default:"d3"},d3AlphaMin:{default:0},d3AlphaDecay:{default:.0228,triggerUpdate:!1,onChange:function(e,n){n.d3ForceLayout.alphaDecay(e)}},d3AlphaTarget:{default:0,triggerUpdate:!1,onChange:function(e,n){n.d3ForceLayout.alphaTarget(e)}},d3VelocityDecay:{default:.4,triggerUpdate:!1,onChange:function(e,n){n.d3ForceLayout.velocityDecay(e)}},ngraphPhysics:{default:{timeStep:20,gravity:-1.2,theta:.8,springLength:30,springCoefficient:8e-4,dragCoefficient:.02}},warmupTicks:{default:0,triggerUpdate:!1},cooldownTicks:{default:1/0,triggerUpdate:!1},cooldownTime:{default:15e3,triggerUpdate:!1},onLoading:{default:function(){},triggerUpdate:!1},onFinishLoading:{default:function(){},triggerUpdate:!1},onUpdate:{default:function(){},triggerUpdate:!1},onFinishUpdate:{default:function(){},triggerUpdate:!1},onEngineTick:{default:function(){},triggerUpdate:!1},onEngineStop:{default:function(){},triggerUpdate:!1}},methods:{refresh:function(e){return e._flushObjects=!0,e._rerender(),this},d3Force:function(e,n,i){return i===void 0?e.d3ForceLayout.force(n):(e.d3ForceLayout.force(n,i),this)},d3ReheatSimulation:function(e){return e.d3ForceLayout.alpha(1),this.resetCountdown(),this},resetCountdown:function(e){return e.cntTicks=0,e.startTickTime=new Date,e.engineRunning=!0,this},tickFrame:function(e){var n=e.forceEngine!=="ngraph";return e.engineRunning&&i(),s(),o(),this;function i(){++e.cntTicks>e.cooldownTicks||new Date-e.startTickTime>e.cooldownTime||n&&e.d3AlphaMin>0&&e.d3ForceLayout.alpha()<e.d3AlphaMin?(e.engineRunning=!1,e.onEngineStop()):(e.layout[n?"tick":"step"](),e.onEngineTick());var a=ht(e.nodeThreeObjectExtend);e.nodeDataMapper.entries().forEach(function(d){var p=z0(d,2),m=p[0],g=p[1];if(g){var v=n?m:e.layout.getNodePosition(m[e.nodeId]),y=a(m);(!e.nodePositionUpdate||!e.nodePositionUpdate(y?g.children[0]:g,{x:v.x,y:v.y,z:v.z},m)||y)&&(g.position.x=v.x,g.position.y=v.y||0,g.position.z=v.z||0)}});var l=ht(e.linkWidth),c=ht(e.linkCurvature),u=ht(e.linkCurveRotation),h=ht(e.linkThreeObjectExtend);e.linkDataMapper.entries().forEach(function(d){var p=z0(d,2),m=p[0],g=p[1];if(g){var v=n?m:e.layout.getLinkPosition(e.layout.graph.getLink(m.source,m.target).id),y=v[n?"source":"from"],x=v[n?"target":"to"];if(!(!y||!x||!y.hasOwnProperty("x")||!x.hasOwnProperty("x"))){f(m);var b=h(m);if(!(e.linkPositionUpdate&&e.linkPositionUpdate(b?g.children[1]:g,{start:{x:y.x,y:y.y,z:y.z},end:{x:x.x,y:x.y,z:x.z}},m)&&!b)){var w=30,_=m.__curve,S=g.children.length?g.children[0]:g;if(S.type==="Line"){if(_){var E=_.getPoints(w);S.geometry.getAttribute("position").array.length!==E.length*3&&S.geometry[GR]("position",new Ct.BufferAttribute(new Float32Array(E.length*3),3)),S.geometry.setFromPoints(E)}else{var T=S.geometry.getAttribute("position");(!T||!T.array||T.array.length!==6)&&S.geometry[GR]("position",T=new Ct.BufferAttribute(new Float32Array(2*3),3)),T.array[0]=y.x,T.array[1]=y.y||0,T.array[2]=y.z||0,T.array[3]=x.x,T.array[4]=x.y||0,T.array[5]=x.z||0,T.needsUpdate=!0}S.geometry.computeBoundingSphere()}else if(S.type==="Mesh")if(_){S.geometry.type.match(/^Tube(Buffer)?Geometry$/)||(S.position.set(0,0,0),S.rotation.set(0,0,0),S.scale.set(1,1,1));var O=Math.ceil(l(m)*10)/10,R=O/2,z=new Ct.TubeGeometry(_,w,R,e.linkResolution,!1);S.geometry.dispose(),S.geometry=z}else{if(!S.geometry.type.match(/^Cylinder(Buffer)?Geometry$/)){var M=Math.ceil(l(m)*10)/10,A=M/2,P=new Ct.CylinderGeometry(A,A,1,e.linkResolution,1,!1);P[SS](new Ct.Matrix4().makeTranslation(0,1/2,0)),P[SS](new Ct.Matrix4().makeRotationX(Math.PI/2)),S.geometry.dispose(),S.geometry=P}var D=new Ct.Vector3(y.x,y.y||0,y.z||0),B=new Ct.Vector3(x.x,x.y||0,x.z||0),C=D.distanceTo(B);S.position.x=D.x,S.position.y=D.y,S.position.z=D.z,S.scale.z=C,S.parent.localToWorld(B),S.lookAt(B)}}}}});function f(d){var p=n?d:e.layout.getLinkPosition(e.layout.graph.getLink(d.source,d.target).id),m=p[n?"source":"from"],g=p[n?"target":"to"];if(!(!m||!g||!m.hasOwnProperty("x")||!g.hasOwnProperty("x"))){var v=c(d);if(!v)d.__curve=null;else{var y=new Ct.Vector3(m.x,m.y||0,m.z||0),x=new Ct.Vector3(g.x,g.y||0,g.z||0),b=y.distanceTo(x),w,_=u(d);if(b>0){var S=g.x-m.x,T=g.y-m.y||0,E=new Ct.Vector3().subVectors(x,y),M=E.clone().multiplyScalar(v).cross(S!==0||T!==0?new Ct.Vector3(0,0,1):new Ct.Vector3(0,1,0)).applyAxisAngle(E.normalize(),_).add(new Ct.Vector3().addVectors(y,x).divideScalar(2));w=new Ct.QuadraticBezierCurve3(y,M,x)}else{var A=v*70,P=-_,D=P+Math.PI/2;w=new Ct.CubicBezierCurve3(y,new Ct.Vector3(A*Math.cos(D),A*Math.sin(D),0).add(y),new Ct.Vector3(A*Math.cos(P),A*Math.sin(P),0).add(y),x)}d.__curve=w}}}}function s(){var a=ht(e.linkDirectionalArrowRelPos),l=ht(e.linkDirectionalArrowLength),c=ht(e.nodeVal);e.arrowDataMapper.entries().forEach(function(u){var h=z0(u,2),f=h[0],d=h[1];if(d){var p=n?f:e.layout.getLinkPosition(e.layout.graph.getLink(f.source,f.target).id),m=p[n?"source":"from"],g=p[n?"target":"to"];if(!(!m||!g||!m.hasOwnProperty("x")||!g.hasOwnProperty("x"))){var v=Math.cbrt(Math.max(0,c(m)||1))*e.nodeRelSize,y=Math.cbrt(Math.max(0,c(g)||1))*e.nodeRelSize,x=l(f),b=a(f),w=f.__curve?function(A){return f.__curve.getPoint(A)}:function(A){var P=function(B,C,O,R){return C[B]+(O[B]-C[B])*R||0};return{x:P("x",m,g,A),y:P("y",m,g,A),z:P("z",m,g,A)}},_=f.__curve?f.__curve.getLength():Math.sqrt(["x","y","z"].map(function(A){return Math.pow((g[A]||0)-(m[A]||0),2)}).reduce(function(A,P){return A+P},0)),S=v+x+(_-v-y-x)*b,T=w(S/_),E=w((S-x)/_);["x","y","z"].forEach(function(A){return d.position[A]=E[A]});var M=gQ(Ct.Vector3,La(["x","y","z"].map(function(A){return T[A]})));d.parent.localToWorld(M),d.lookAt(M)}}})}function o(){var a=ht(e.linkDirectionalParticleSpeed);e.graphData.links.forEach(function(l){var c=e.particlesDataMapper.getObj(l),u=c&&c.children,h=l.__singleHopPhotonsObj&&l.__singleHopPhotonsObj.children;if(!((!h||!h.length)&&(!u||!u.length))){var f=n?l:e.layout.getLinkPosition(e.layout.graph.getLink(l.source,l.target).id),d=f[n?"source":"from"],p=f[n?"target":"to"];if(!(!d||!p||!d.hasOwnProperty("x")||!p.hasOwnProperty("x"))){var m=a(l),g=l.__curve?function(y){return l.__curve.getPoint(y)}:function(y){var x=function(w,_,S,T){return _[w]+(S[w]-_[w])*T||0};return{x:x("x",d,p,y),y:x("y",d,p,y),z:x("z",d,p,y)}},v=[].concat(La(u||[]),La(h||[]));v.forEach(function(y,x){var b=y.parent.__linkThreeObjType==="singleHopPhotons";if(y.hasOwnProperty("__progressRatio")||(y.__progressRatio=b?0:x/u.length),y.__progressRatio+=m,y.__progressRatio>=1)if(!b)y.__progressRatio=y.__progressRatio%1;else{y.parent.remove(y),uD(y);return}var w=y.__progressRatio,_=g(w);["x","y","z"].forEach(function(S){return y.position[S]=_[S]})})}}})}},emitParticle:function(e,n){if(n&&e.graphData.links.includes(n)){if(!n.__singleHopPhotonsObj){var i=new Ct.Group;i.__linkThreeObjType="singleHopPhotons",n.__singleHopPhotonsObj=i,e.graphScene.add(i)}var s=ht(e.linkDirectionalParticleWidth),o=Math.ceil(s(n)*10)/10/2,a=e.linkDirectionalParticleResolution,l=new Ct.SphereGeometry(o,a,a),c=ht(e.linkColor),u=ht(e.linkDirectionalParticleColor),h=u(n)||c(n)||"#f0f0f0",f=new Ct.Color(Ev(h)),d=e.linkOpacity*3,p=new Ct.MeshLambertMaterial({color:f,transparent:!0,opacity:d});n.__singleHopPhotonsObj.add(new Ct.Mesh(l,p))}return this},getGraphBbox:function(e){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:function(){return!0};if(!e.initialised)return null;var i=function s(o){var a=[];if(o.geometry){o.geometry.computeBoundingBox();var l=new Ct.Box3;l.copy(o.geometry.boundingBox).applyMatrix4(o.matrixWorld),a.push(l)}return a.concat.apply(a,La((o.children||[]).filter(function(c){return!c.hasOwnProperty("__graphObjType")||c.__graphObjType==="node"&&n(c.__data)}).map(s)))}(e.graphScene);return i.length?Object.assign.apply(Object,La(["x","y","z"].map(function(s){return uA({},s,[Zx(i,function(o){return o.min[s]}),Yx(i,function(o){return o.max[s]})])}))):null}},stateInit:function(){return{d3ForceLayout:iZ().force("link",tZ()).force("charge",sZ()).force("center",XY()).force("dagRadial",null).stop(),engineRunning:!1}},init:function(e,n){n.graphScene=e,n.nodeDataMapper=new Tv(e,{objBindAttr:"__threeObj"}),n.linkDataMapper=new Tv(e,{objBindAttr:"__lineObj"}),n.arrowDataMapper=new Tv(e,{objBindAttr:"__arrowObj"}),n.particlesDataMapper=new Tv(e,{objBindAttr:"__photonsObj"})},update:function(e,n){var i=function(J){return J.some(function(se){return n.hasOwnProperty(se)})};if(e.engineRunning=!1,typeof e.onUpdate=="function"&&e.onUpdate(),e.nodeAutoColorBy!==null&&i(["nodeAutoColorBy","graphData","nodeColor"])&&bG(e.graphData.nodes,ht(e.nodeAutoColorBy),e.nodeColor),e.linkAutoColorBy!==null&&i(["linkAutoColorBy","graphData","linkColor"])&&bG(e.graphData.links,ht(e.linkAutoColorBy),e.linkColor),e._flushObjects||i(["graphData","nodeThreeObject","nodeThreeObjectExtend","nodeVal","nodeColor","nodeVisibility","nodeRelSize","nodeResolution","nodeOpacity"])){var s=ht(e.nodeThreeObject),o=ht(e.nodeThreeObjectExtend),a=ht(e.nodeVal),l=ht(e.nodeColor),c=ht(e.nodeVisibility),u={},h={};(e._flushObjects||i(["nodeThreeObject","nodeThreeObjectExtend"]))&&e.nodeDataMapper.clear(),e.nodeDataMapper.onCreateObj(function(q){var J=s(q),se=o(q);J&&e.nodeThreeObject===J&&(J=J.clone());var oe;return J&&!se?oe=J:(oe=new Ct.Mesh,oe.__graphDefaultObj=!0,J&&se&&oe.add(J)),oe.__graphObjType="node",oe}).onUpdateObj(function(q,J){if(q.__graphDefaultObj){var se=a(J)||1,oe=Math.cbrt(se)*e.nodeRelSize,Ee=e.nodeResolution;(!q.geometry.type.match(/^Sphere(Buffer)?Geometry$/)||q.geometry.parameters.radius!==oe||q.geometry.parameters.widthSegments!==Ee)&&(u.hasOwnProperty(se)||(u[se]=new Ct.SphereGeometry(oe,Ee,Ee)),q.geometry.dispose(),q.geometry=u[se]);var ye=l(J),Ce=new Ct.Color(Ev(ye||"#ffffaa")),Ge=e.nodeOpacity*VR(ye);(q.material.type!=="MeshLambertMaterial"||!q.material.color.equals(Ce)||q.material.opacity!==Ge)&&(h.hasOwnProperty(ye)||(h[ye]=new Ct.MeshLambertMaterial({color:Ce,transparent:!0,opacity:Ge})),q.material.dispose(),q.material=h[ye])}}).digest(e.graphData.nodes.filter(c))}if(e._flushObjects||i(["graphData","linkThreeObject","linkThreeObjectExtend","linkMaterial","linkColor","linkWidth","linkVisibility","linkResolution","linkOpacity","linkDirectionalArrowLength","linkDirectionalArrowColor","linkDirectionalArrowResolution","linkDirectionalParticles","linkDirectionalParticleWidth","linkDirectionalParticleColor","linkDirectionalParticleResolution"])){var f=ht(e.linkThreeObject),d=ht(e.linkThreeObjectExtend),p=ht(e.linkMaterial),m=ht(e.linkVisibility),g=ht(e.linkColor),v=ht(e.linkWidth),y={},x={},b={},w=e.graphData.links.filter(m);if((e._flushObjects||i(["linkThreeObject","linkThreeObjectExtend","linkWidth"]))&&e.linkDataMapper.clear(),e.linkDataMapper.onRemoveObj(function(q){var J=q.__data&&q.__data.__singleHopPhotonsObj;J&&(J.parent.remove(J),uD(J),delete q.__data.__singleHopPhotonsObj)}).onCreateObj(function(q){var J=f(q),se=d(q);J&&e.linkThreeObject===J&&(J=J.clone());var oe;if(!J||se){var Ee=!!v(q);if(Ee)oe=new Ct.Mesh;else{var ye=new Ct.BufferGeometry;ye[GR]("position",new Ct.BufferAttribute(new Float32Array(2*3),3)),oe=new Ct.Line(ye)}}var Ce;return J?se?(Ce=new Ct.Group,Ce.__graphDefaultObj=!0,Ce.add(oe),Ce.add(J)):Ce=J:(Ce=oe,Ce.__graphDefaultObj=!0),Ce.renderOrder=10,Ce.__graphObjType="link",Ce}).onUpdateObj(function(q,J){if(q.__graphDefaultObj){var se=q.children.length?q.children[0]:q,oe=Math.ceil(v(J)*10)/10,Ee=!!oe;if(Ee){var ye=oe/2,Ce=e.linkResolution;if(!se.geometry.type.match(/^Cylinder(Buffer)?Geometry$/)||se.geometry.parameters.radiusTop!==ye||se.geometry.parameters.radialSegments!==Ce){if(!y.hasOwnProperty(oe)){var Ge=new Ct.CylinderGeometry(ye,ye,1,Ce,1,!1);Ge[SS](new Ct.Matrix4().makeTranslation(0,1/2,0)),Ge[SS](new Ct.Matrix4().makeRotationX(Math.PI/2)),y[oe]=Ge}se.geometry.dispose(),se.geometry=y[oe]}}var _e=p(J);if(_e)se.material=_e;else{var Ke=g(J),Q=new Ct.Color(Ev(Ke||"#f0f0f0")),kt=e.linkOpacity*VR(Ke),ct=Ee?"MeshLambertMaterial":"LineBasicMaterial";if(se.material.type!==ct||!se.material.color.equals(Q)||se.material.opacity!==kt){var gt=Ee?x:b;gt.hasOwnProperty(Ke)||(gt[Ke]=new Ct[ct]({color:Q,transparent:kt<1,opacity:kt,depthWrite:kt>=1})),se.material.dispose(),se.material=gt[Ke]}}}}).digest(w),e.linkDirectionalArrowLength||n.hasOwnProperty("linkDirectionalArrowLength")){var _=ht(e.linkDirectionalArrowLength),S=ht(e.linkDirectionalArrowColor);e.arrowDataMapper.onCreateObj(function(){var q=new Ct.Mesh(void 0,new Ct.MeshLambertMaterial({transparent:!0}));return q.__linkThreeObjType="arrow",q}).onUpdateObj(function(q,J){var se=_(J),oe=e.linkDirectionalArrowResolution;if(!q.geometry.type.match(/^Cone(Buffer)?Geometry$/)||q.geometry.parameters.height!==se||q.geometry.parameters.radialSegments!==oe){var Ee=new Ct.ConeGeometry(se*.25,se,oe);Ee.translate(0,se/2,0),Ee.rotateX(Math.PI/2),q.geometry.dispose(),q.geometry=Ee}var ye=S(J)||g(J)||"#f0f0f0";q.material.color=new Ct.Color(Ev(ye)),q.material.opacity=e.linkOpacity*3*VR(ye)}).digest(w.filter(_))}if(e.linkDirectionalParticles||n.hasOwnProperty("linkDirectionalParticles")){var T=ht(e.linkDirectionalParticles),E=ht(e.linkDirectionalParticleWidth),M=ht(e.linkDirectionalParticleColor),A={},P={};e.particlesDataMapper.onCreateObj(function(){var q=new Ct.Group;return q.__linkThreeObjType="photons",q.__photonDataMapper=new Tv(q),q}).onUpdateObj(function(q,J){var se=Math.round(Math.abs(T(J))),oe=!!q.children.length&&q.children[0],Ee=Math.ceil(E(J)*10)/10/2,ye=e.linkDirectionalParticleResolution,Ce;oe&&oe.geometry.parameters.radius===Ee&&oe.geometry.parameters.widthSegments===ye?Ce=oe.geometry:(P.hasOwnProperty(Ee)||(P[Ee]=new Ct.SphereGeometry(Ee,ye,ye)),Ce=P[Ee],oe&&oe.geometry.dispose());var Ge=M(J)||g(J)||"#f0f0f0",_e=new Ct.Color(Ev(Ge)),Ke=e.linkOpacity*3,Q;oe&&oe.material.color.equals(_e)&&oe.material.opacity===Ke?Q=oe.material:(A.hasOwnProperty(Ge)||(A[Ge]=new Ct.MeshLambertMaterial({color:_e,transparent:!0,opacity:Ke})),Q=A[Ge],oe&&oe.material.dispose()),q.__photonDataMapper.id(function(kt){return kt.idx}).onCreateObj(function(){return new Ct.Mesh(Ce,Q)}).onUpdateObj(function(kt){kt.geometry=Ce,kt.material=Q}).digest(La(new Array(se)).map(function(kt,ct){return{idx:ct}}))}).digest(w.filter(T))}}if(e._flushObjects=!1,i(["graphData","nodeId","linkSource","linkTarget","numDimensions","forceEngine","dagMode","dagNodeFilter","dagLevelDistance"])){e.engineRunning=!1,e.graphData.links.forEach(function(q){q.source=q[e.linkSource],q.target=q[e.linkTarget]});var D=e.forceEngine!=="ngraph",B;if(D){(B=e.d3ForceLayout).stop().alpha(1).numDimensions(e.numDimensions).nodes(e.graphData.nodes);var C=e.d3ForceLayout.force("link");C&&C.id(function(q){return q[e.nodeId]}).links(e.graphData.links);var O=e.dagMode&&kCe(e.graphData,function(q){return q[e.nodeId]},{nodeFilter:e.dagNodeFilter,onLoopError:e.onDagError||void 0}),R=Math.max.apply(Math,La(Object.values(O||[]))),z=e.dagLevelDistance||e.graphData.nodes.length/(R||1)*ICe*(["radialin","radialout"].indexOf(e.dagMode)!==-1?.7:1);if(["lr","rl","td","bu","zin","zout"].includes(n.dagMode)){var U=["lr","rl"].includes(n.dagMode)?"fx":["td","bu"].includes(n.dagMode)?"fy":"fz";e.graphData.nodes.filter(e.dagNodeFilter).forEach(function(q){return delete q[U]})}if(["lr","rl","td","bu","zin","zout"].includes(e.dagMode)){var G=["rl","td","zout"].includes(e.dagMode),H=function(J){return(O[J[e.nodeId]]-R/2)*z*(G?-1:1)},Y=["lr","rl"].includes(e.dagMode)?"fx":["td","bu"].includes(e.dagMode)?"fy":"fz";e.graphData.nodes.filter(e.dagNodeFilter).forEach(function(q){return q[Y]=H(q)})}e.d3ForceLayout.force("dagRadial",["radialin","radialout"].indexOf(e.dagMode)!==-1?oZ(function(q){var J=O[q[e.nodeId]]||-1;return(e.dagMode==="radialin"?R-J:J)*z}).strength(function(q){return e.dagNodeFilter(q)?1:0}):null)}else{var ee=_G.graph();e.graphData.nodes.forEach(function(q){ee.addNode(q[e.nodeId])}),e.graphData.links.forEach(function(q){ee.addLink(q.source,q.target)}),B=_G.forcelayout(ee,PCe({dimensions:e.numDimensions},e.ngraphPhysics)),B.graph=ee}for(var he=0;he<e.warmupTicks&&!(D&&e.d3AlphaMin>0&&e.d3ForceLayout.alpha()<e.d3AlphaMin);he++)B[D?"tick":"step"]();e.layout=B,this.resetCountdown()}e.engineRunning=!0,e.onFinishUpdate()}});function FCe(r){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Object,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,i=function(s){function o(){var a;mQ(this,o);for(var l=arguments.length,c=new Array(l),u=0;u<l;u++)c[u]=arguments[u];return a=pQ(this,o,[].concat(c)),a.__kapsuleInstance=gQ(r,[].concat(La(n?[a]:[]),c)),a}return vQ(o,s),yQ(o)}(e);return Object.keys(r()).forEach(function(s){return i.prototype[s]=function(){var o,a=(o=this.__kapsuleInstance)[s].apply(o,arguments);return a===this.__kapsuleInstance?this:a}}),i}var BCe=window.THREE?window.THREE:{Group:am},cm=FCe(LCe,BCe.Group,!0);if(typeof AFRAME>"u")throw new Error("Component attempted to register before AFRAME was available.");var HR=function(e){return typeof e=="string"?JSON.parse(e):e},Na=function(e){if(typeof e=="function")return e;var n=eval;try{var i=n("("+e+")");return i}catch{}return null},xr=function(e){return isNaN(parseFloat(e))?Na(e)?Na(e):e:parseFloat(e)};AFRAME.components.hasOwnProperty("forcegraph")||AFRAME.registerComponent("forcegraph",{schema:{jsonUrl:{type:"string",default:""},nodes:{parse:HR,default:[]},links:{parse:HR,default:[]},numDimensions:{type:"number",default:3},dagMode:{type:"string",default:""},dagLevelDistance:{type:"number",default:0},dagNodeFilter:{parse:Na,default:function(){return!0}},onDagError:{parse:Na,default:void 0},nodeRelSize:{type:"number",default:4},nodeId:{type:"string",default:"id"},nodeVal:{parse:xr,default:"val"},nodeResolution:{type:"number",default:8},nodeVisibility:{parse:xr,default:!0},nodeColor:{parse:xr,default:"color"},nodeAutoColorBy:{parse:xr,default:""},nodeOpacity:{type:"number",default:.75},nodeThreeObject:{parse:xr,default:null},nodeThreeObjectExtend:{parse:xr,default:!1},linkSource:{type:"string",default:"source"},linkTarget:{type:"string",default:"target"},linkVisibility:{parse:xr,default:!0},linkColor:{parse:xr,default:"color"},linkAutoColorBy:{parse:xr,default:""},linkOpacity:{type:"number",default:.2},linkWidth:{parse:xr,default:0},linkResolution:{type:"number",default:6},linkCurvature:{parse:xr,default:0},linkCurveRotation:{parse:xr,default:0},linkMaterial:{parse:xr,default:null},linkThreeObject:{parse:xr,default:null},linkThreeObjectExtend:{parse:xr,default:!1},linkPositionUpdate:{parse:Na,default:null},linkDirectionalArrowLength:{parse:xr,default:0},linkDirectionalArrowColor:{parse:xr,default:null},linkDirectionalArrowRelPos:{parse:xr,default:.5},linkDirectionalArrowResolution:{type:"number",default:8},linkDirectionalParticles:{parse:xr,default:0},linkDirectionalParticleSpeed:{parse:xr,default:.01},linkDirectionalParticleWidth:{parse:xr,default:.5},linkDirectionalParticleColor:{parse:xr,default:null},linkDirectionalParticleResolution:{type:"number",default:4},onNodeHover:{parse:Na,default:function(){}},onLinkHover:{parse:Na,default:function(){}},onNodeClick:{parse:Na,default:function(){}},onLinkClick:{parse:Na,default:function(){}},forceEngine:{type:"string",default:"d3"},d3AlphaMin:{type:"number",default:0},d3AlphaDecay:{type:"number",default:.0228},d3VelocityDecay:{type:"number",default:.4},ngraphPhysics:{parse:HR,default:null},warmupTicks:{type:"int",default:0},cooldownTicks:{type:"int",default:1e18},cooldownTime:{type:"int",default:15e3},onEngineTick:{parse:Na,default:function(){}},onEngineStop:{parse:Na,default:function(){}}},getGraphBbox:function(e){return this.forceGraph||(this.forceGraph=new cm),this.forceGraph.getGraphBbox(e)},emitParticle:function(){this.forceGraph||(this.forceGraph=new cm);var e=this.forceGraph,n=e.emitParticle.apply(e,arguments);return n===e?this:n},d3Force:function(){this.forceGraph||(this.forceGraph=new cm);var e=this.forceGraph,n=e.d3Force.apply(e,arguments);return n===e?this:n},d3ReheatSimulation:function(){return this.forceGraph&&this.forceGraph.d3ReheatSimulation(),this},refresh:function(){return this.forceGraph&&this.forceGraph.refresh(),this},init:function(){var e=this,n=this.state={};n.infoEl=document.createElement("a-text"),n.infoEl.setAttribute("position","0 -0.1 -1"),n.infoEl.setAttribute("width",1),n.infoEl.setAttribute("align","center"),n.infoEl.setAttribute("color","lavender");var i=document.querySelector("a-entity[camera], a-camera");i.appendChild(n.infoEl),n.cameraObj=i.object3D.children.filter(function(s){return s.type==="PerspectiveCamera"})[0],this.el.sceneEl.addEventListener("camera-set-active",function(s){n.cameraObj=s.detail.cameraEl.components.camera.camera}),this.forceGraph||(this.forceGraph=new cm),this.forceGraph.onFinishUpdate(function(){return e.el.setObject3D("forcegraphGroup",e.forceGraph)}).onLoading(function(){return n.infoEl.setAttribute("value","Loading...")}).onFinishLoading(function(){return n.infoEl.setAttribute("value","")}),this.el.addEventListener("raycaster-intersected",function(s){return n.hoverDetail=s.detail}),this.el.addEventListener("raycaster-intersected-cleared",function(s){return n.hoverDetail=s.detail}),this.el.addEventListener("click",function(){return n.hoverObj&&e.data["on"+(n.hoverObj.__graphObjType==="node"?"Node":"Link")+"Click"](n.hoverObj.__data)})},remove:function(){this.state.infoEl.remove(),this.el.removeObject3D("forcegraphGroup")},update:function(e){var n=this,i=this.data,s=AFRAME.utils.diff(i,e),o=["jsonUrl","numDimensions","dagMode","dagLevelDistance","dagNodeFilter","onDagError","nodeRelSize","nodeId","nodeVal","nodeResolution","nodeVisibility","nodeColor","nodeAutoColorBy","nodeOpacity","nodeThreeObject","nodeThreeObjectExtend","linkSource","linkTarget","linkVisibility","linkColor","linkAutoColorBy","linkOpacity","linkWidth","linkResolution","linkCurvature","linkCurveRotation","linkMaterial","linkThreeObject","linkThreeObjectExtend","linkPositionUpdate","linkDirectionalArrowLength","linkDirectionalArrowColor","linkDirectionalArrowRelPos","linkDirectionalArrowResolution","linkDirectionalParticles","linkDirectionalParticleSpeed","linkDirectionalParticleWidth","linkDirectionalParticleColor","linkDirectionalParticleResolution","forceEngine","d3AlphaMin","d3AphaDecay","d3VelocityDecay","ngraphPhysics","warmupTicks","cooldownTicks","cooldownTime","onEngineTick","onEngineStop"];o.filter(function(a){return a in s}).forEach(function(a){n.forceGraph[a](i[a]!==""?i[a]:null)}),("nodes"in s||"links"in s)&&n.forceGraph.graphData({nodes:i.nodes,links:i.links})},tick:function(e,n){for(var i=this.state,s=this.data,o=i.hoverDetail?i.hoverDetail.getIntersection?i.hoverDetail.getIntersection(this.el):i.hoverDetail.intersection||void 0:void 0,a=o?o.object:void 0;a&&!a.hasOwnProperty("__graphObjType");)a=a.parent;if(a!==i.hoverObj){var l=i.hoverObj?i.hoverObj.__graphObjType:null,c=i.hoverObj?i.hoverObj.__data:null,u=a?a.__graphObjType:null,h=a?a.__data:null;l&&l!==u&&s["on"+(l==="node"?"Node":"Link")+"Hover"](null,c),u&&s["on"+(u==="node"?"Node":"Link")+"Hover"](h,l===u?c:null),i.hoverObj=a}this.forceGraph.tickFrame()}});function oo(){return oo=Object.assign?Object.assign.bind():function(r){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var i in n)({}).hasOwnProperty.call(n,i)&&(r[i]=n[i])}return r},oo.apply(null,arguments)}function UCe(r){if(r===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return r}function nb(r,e){return nb=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},nb(r,e)}function zCe(r,e){r.prototype=Object.create(e.prototype),r.prototype.constructor=r,nb(r,e)}function hD(r){return hD=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},hD(r)}function $Ce(r){try{return Function.toString.call(r).indexOf("[native code]")!==-1}catch{return typeof r=="function"}}function SQ(){try{var r=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(SQ=function(){return!!r})()}function jCe(r,e,n){if(SQ())return Reflect.construct.apply(null,arguments);var i=[null];i.push.apply(i,e);var s=new(r.bind.apply(r,i));return n&&nb(s,n.prototype),s}function fD(r){var e=typeof Map=="function"?new Map:void 0;return fD=function(i){if(i===null||!$Ce(i))return i;if(typeof i!="function")throw new TypeError("Super expression must either be null or a function");if(e!==void 0){if(e.has(i))return e.get(i);e.set(i,s)}function s(){return jCe(i,arguments,hD(this).constructor)}return s.prototype=Object.create(i.prototype,{constructor:{value:s,enumerable:!1,writable:!0,configurable:!0}}),nb(s,i)},fD(r)}var El=function(r){zCe(e,r);function e(n){var i;return i=r.call(this,"An error occurred. See https://github.com/styled-components/polished/blob/main/src/internalHelpers/errors.md#"+n+" for more information.")||this,UCe(i)}return e}(fD(Error));function WR(r){return Math.round(r*255)}function VCe(r,e,n){return WR(r)+","+WR(e)+","+WR(n)}function rb(r,e,n,i){if(i===void 0&&(i=VCe),e===0)return i(n,n,n);var s=(r%360+360)%360/60,o=(1-Math.abs(2*n-1))*e,a=o*(1-Math.abs(s%2-1)),l=0,c=0,u=0;s>=0&&s<1?(l=o,c=a):s>=1&&s<2?(l=a,c=o):s>=2&&s<3?(c=o,u=a):s>=3&&s<4?(c=a,u=o):s>=4&&s<5?(l=a,u=o):s>=5&&s<6&&(l=o,u=a);var h=n-o/2,f=l+h,d=c+h,p=u+h;return i(f,d,p)}var wG={aliceblue:"f0f8ff",antiquewhite:"faebd7",aqua:"00ffff",aquamarine:"7fffd4",azure:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"000",blanchedalmond:"ffebcd",blue:"0000ff",blueviolet:"8a2be2",brown:"a52a2a",burlywood:"deb887",cadetblue:"5f9ea0",chartreuse:"7fff00",chocolate:"d2691e",coral:"ff7f50",cornflowerblue:"6495ed",cornsilk:"fff8dc",crimson:"dc143c",cyan:"00ffff",darkblue:"00008b",darkcyan:"008b8b",darkgoldenrod:"b8860b",darkgray:"a9a9a9",darkgreen:"006400",darkgrey:"a9a9a9",darkkhaki:"bdb76b",darkmagenta:"8b008b",darkolivegreen:"556b2f",darkorange:"ff8c00",darkorchid:"9932cc",darkred:"8b0000",darksalmon:"e9967a",darkseagreen:"8fbc8f",darkslateblue:"483d8b",darkslategray:"2f4f4f",darkslategrey:"2f4f4f",darkturquoise:"00ced1",darkviolet:"9400d3",deeppink:"ff1493",deepskyblue:"00bfff",dimgray:"696969",dimgrey:"696969",dodgerblue:"1e90ff",firebrick:"b22222",floralwhite:"fffaf0",forestgreen:"228b22",fuchsia:"ff00ff",gainsboro:"dcdcdc",ghostwhite:"f8f8ff",gold:"ffd700",goldenrod:"daa520",gray:"808080",green:"008000",greenyellow:"adff2f",grey:"808080",honeydew:"f0fff0",hotpink:"ff69b4",indianred:"cd5c5c",indigo:"4b0082",ivory:"fffff0",khaki:"f0e68c",lavender:"e6e6fa",lavenderblush:"fff0f5",lawngreen:"7cfc00",lemonchiffon:"fffacd",lightblue:"add8e6",lightcoral:"f08080",lightcyan:"e0ffff",lightgoldenrodyellow:"fafad2",lightgray:"d3d3d3",lightgreen:"90ee90",lightgrey:"d3d3d3",lightpink:"ffb6c1",lightsalmon:"ffa07a",lightseagreen:"20b2aa",lightskyblue:"87cefa",lightslategray:"789",lightslategrey:"789",lightsteelblue:"b0c4de",lightyellow:"ffffe0",lime:"0f0",limegreen:"32cd32",linen:"faf0e6",magenta:"f0f",maroon:"800000",mediumaquamarine:"66cdaa",mediumblue:"0000cd",mediumorchid:"ba55d3",mediumpurple:"9370db",mediumseagreen:"3cb371",mediumslateblue:"7b68ee",mediumspringgreen:"00fa9a",mediumturquoise:"48d1cc",mediumvioletred:"c71585",midnightblue:"191970",mintcream:"f5fffa",mistyrose:"ffe4e1",moccasin:"ffe4b5",navajowhite:"ffdead",navy:"000080",oldlace:"fdf5e6",olive:"808000",olivedrab:"6b8e23",orange:"ffa500",orangered:"ff4500",orchid:"da70d6",palegoldenrod:"eee8aa",palegreen:"98fb98",paleturquoise:"afeeee",palevioletred:"db7093",papayawhip:"ffefd5",peachpuff:"ffdab9",peru:"cd853f",pink:"ffc0cb",plum:"dda0dd",powderblue:"b0e0e6",purple:"800080",rebeccapurple:"639",red:"f00",rosybrown:"bc8f8f",royalblue:"4169e1",saddlebrown:"8b4513",salmon:"fa8072",sandybrown:"f4a460",seagreen:"2e8b57",seashell:"fff5ee",sienna:"a0522d",silver:"c0c0c0",skyblue:"87ceeb",slateblue:"6a5acd",slategray:"708090",slategrey:"708090",snow:"fffafa",springgreen:"00ff7f",steelblue:"4682b4",tan:"d2b48c",teal:"008080",thistle:"d8bfd8",tomato:"ff6347",turquoise:"40e0d0",violet:"ee82ee",wheat:"f5deb3",white:"fff",whitesmoke:"f5f5f5",yellow:"ff0",yellowgreen:"9acd32"};function GCe(r){if(typeof r!="string")return r;var e=r.toLowerCase();return wG[e]?"#"+wG[e]:r}var HCe=/^#[a-fA-F0-9]{6}$/,WCe=/^#[a-fA-F0-9]{8}$/,qCe=/^#[a-fA-F0-9]{3}$/,XCe=/^#[a-fA-F0-9]{4}$/,qR=/^rgb\(\s*(\d{1,3})\s*(?:,)?\s*(\d{1,3})\s*(?:,)?\s*(\d{1,3})\s*\)$/i,KCe=/^rgb(?:a)?\(\s*(\d{1,3})\s*(?:,)?\s*(\d{1,3})\s*(?:,)?\s*(\d{1,3})\s*(?:,|\/)\s*([-+]?\d*[.]?\d+[%]?)\s*\)$/i,YCe=/^hsl\(\s*(\d{0,3}[.]?[0-9]+(?:deg)?)\s*(?:,)?\s*(\d{1,3}[.]?[0-9]?)%\s*(?:,)?\s*(\d{1,3}[.]?[0-9]?)%\s*\)$/i,ZCe=/^hsl(?:a)?\(\s*(\d{0,3}[.]?[0-9]+(?:deg)?)\s*(?:,)?\s*(\d{1,3}[.]?[0-9]?)%\s*(?:,)?\s*(\d{1,3}[.]?[0-9]?)%\s*(?:,|\/)\s*([-+]?\d*[.]?\d+[%]?)\s*\)$/i;function Nh(r){if(typeof r!="string")throw new El(3);var e=GCe(r);if(e.match(HCe))return{red:parseInt(""+e[1]+e[2],16),green:parseInt(""+e[3]+e[4],16),blue:parseInt(""+e[5]+e[6],16)};if(e.match(WCe)){var n=parseFloat((parseInt(""+e[7]+e[8],16)/255).toFixed(2));return{red:parseInt(""+e[1]+e[2],16),green:parseInt(""+e[3]+e[4],16),blue:parseInt(""+e[5]+e[6],16),alpha:n}}if(e.match(qCe))return{red:parseInt(""+e[1]+e[1],16),green:parseInt(""+e[2]+e[2],16),blue:parseInt(""+e[3]+e[3],16)};if(e.match(XCe)){var i=parseFloat((parseInt(""+e[4]+e[4],16)/255).toFixed(2));return{red:parseInt(""+e[1]+e[1],16),green:parseInt(""+e[2]+e[2],16),blue:parseInt(""+e[3]+e[3],16),alpha:i}}var s=qR.exec(e);if(s)return{red:parseInt(""+s[1],10),green:parseInt(""+s[2],10),blue:parseInt(""+s[3],10)};var o=KCe.exec(e.substring(0,50));if(o)return{red:parseInt(""+o[1],10),green:parseInt(""+o[2],10),blue:parseInt(""+o[3],10),alpha:parseFloat(""+o[4])>1?parseFloat(""+o[4])/100:parseFloat(""+o[4])};var a=YCe.exec(e);if(a){var l=parseInt(""+a[1],10),c=parseInt(""+a[2],10)/100,u=parseInt(""+a[3],10)/100,h="rgb("+rb(l,c,u)+")",f=qR.exec(h);if(!f)throw new El(4,e,h);return{red:parseInt(""+f[1],10),green:parseInt(""+f[2],10),blue:parseInt(""+f[3],10)}}var d=ZCe.exec(e.substring(0,50));if(d){var p=parseInt(""+d[1],10),m=parseInt(""+d[2],10)/100,g=parseInt(""+d[3],10)/100,v="rgb("+rb(p,m,g)+")",y=qR.exec(v);if(!y)throw new El(4,e,v);return{red:parseInt(""+y[1],10),green:parseInt(""+y[2],10),blue:parseInt(""+y[3],10),alpha:parseFloat(""+d[4])>1?parseFloat(""+d[4])/100:parseFloat(""+d[4])}}throw new El(5)}function QCe(r){var e=r.red/255,n=r.green/255,i=r.blue/255,s=Math.max(e,n,i),o=Math.min(e,n,i),a=(s+o)/2;if(s===o)return r.alpha!==void 0?{hue:0,saturation:0,lightness:a,alpha:r.alpha}:{hue:0,saturation:0,lightness:a};var l,c=s-o,u=a>.5?c/(2-s-o):c/(s+o);switch(s){case e:l=(n-i)/c+(n<i?6:0);break;case n:l=(i-e)/c+2;break;default:l=(e-n)/c+4;break}return l*=60,r.alpha!==void 0?{hue:l,saturation:u,lightness:a,alpha:r.alpha}:{hue:l,saturation:u,lightness:a}}function Wh(r){return QCe(Nh(r))}var JCe=function(e){return e.length===7&&e[1]===e[2]&&e[3]===e[4]&&e[5]===e[6]?"#"+e[1]+e[3]+e[5]:e},dD=JCe;function Mf(r){var e=r.toString(16);return e.length===1?"0"+e:e}function XR(r){return Mf(Math.round(r*255))}function ePe(r,e,n){return dD("#"+XR(r)+XR(e)+XR(n))}function oE(r,e,n){return rb(r,e,n,ePe)}function tPe(r,e,n){if(typeof r=="number"&&typeof e=="number"&&typeof n=="number")return oE(r,e,n);if(typeof r=="object"&&e===void 0&&n===void 0)return oE(r.hue,r.saturation,r.lightness);throw new El(1)}function nPe(r,e,n,i){if(typeof r=="number"&&typeof e=="number"&&typeof n=="number"&&typeof i=="number")return i>=1?oE(r,e,n):"rgba("+rb(r,e,n)+","+i+")";if(typeof r=="object"&&e===void 0&&n===void 0&&i===void 0)return r.alpha>=1?oE(r.hue,r.saturation,r.lightness):"rgba("+rb(r.hue,r.saturation,r.lightness)+","+r.alpha+")";throw new El(2)}function pD(r,e,n){if(typeof r=="number"&&typeof e=="number"&&typeof n=="number")return dD("#"+Mf(r)+Mf(e)+Mf(n));if(typeof r=="object"&&e===void 0&&n===void 0)return dD("#"+Mf(r.red)+Mf(r.green)+Mf(r.blue));throw new El(6)}function hA(r,e,n,i){if(typeof r=="string"&&typeof e=="number"){var s=Nh(r);return"rgba("+s.red+","+s.green+","+s.blue+","+e+")"}else{if(typeof r=="number"&&typeof e=="number"&&typeof n=="number"&&typeof i=="number")return i>=1?pD(r,e,n):"rgba("+r+","+e+","+n+","+i+")";if(typeof r=="object"&&e===void 0&&n===void 0&&i===void 0)return r.alpha>=1?pD(r.red,r.green,r.blue):"rgba("+r.red+","+r.green+","+r.blue+","+r.alpha+")"}throw new El(7)}var rPe=function(e){return typeof e.red=="number"&&typeof e.green=="number"&&typeof e.blue=="number"&&(typeof e.alpha!="number"||typeof e.alpha>"u")},iPe=function(e){return typeof e.red=="number"&&typeof e.green=="number"&&typeof e.blue=="number"&&typeof e.alpha=="number"},sPe=function(e){return typeof e.hue=="number"&&typeof e.saturation=="number"&&typeof e.lightness=="number"&&(typeof e.alpha!="number"||typeof e.alpha>"u")},oPe=function(e){return typeof e.hue=="number"&&typeof e.saturation=="number"&&typeof e.lightness=="number"&&typeof e.alpha=="number"};function qh(r){if(typeof r!="object")throw new El(8);if(iPe(r))return hA(r);if(rPe(r))return pD(r);if(oPe(r))return nPe(r);if(sPe(r))return tPe(r);throw new El(8)}function TQ(r,e,n){return function(){var s=n.concat(Array.prototype.slice.call(arguments));return s.length>=e?r.apply(this,s):TQ(r,e,s)}}function zo(r){return TQ(r,r.length,[])}function aPe(r,e){if(e==="transparent")return e;var n=Wh(e);return qh(oo({},n,{hue:n.hue+parseFloat(r)}))}zo(aPe);function wy(r,e,n){return Math.max(r,Math.min(e,n))}function lPe(r,e){if(e==="transparent")return e;var n=Wh(e);return qh(oo({},n,{lightness:wy(0,1,n.lightness-parseFloat(r))}))}zo(lPe);function cPe(r,e){if(e==="transparent")return e;var n=Wh(e);return qh(oo({},n,{saturation:wy(0,1,n.saturation-parseFloat(r))}))}zo(cPe);function uPe(r,e){if(e==="transparent")return e;var n=Wh(e);return qh(oo({},n,{lightness:wy(0,1,n.lightness+parseFloat(r))}))}zo(uPe);function hPe(r,e,n){if(e==="transparent")return n;if(n==="transparent")return e;if(r===0)return n;var i=Nh(e),s=oo({},i,{alpha:typeof i.alpha=="number"?i.alpha:1}),o=Nh(n),a=oo({},o,{alpha:typeof o.alpha=="number"?o.alpha:1}),l=s.alpha-a.alpha,c=parseFloat(r)*2-1,u=c*l===-1?c:c+l,h=1+c*l,f=(u/h+1)/2,d=1-f,p={red:Math.floor(s.red*f+a.red*d),green:Math.floor(s.green*f+a.green*d),blue:Math.floor(s.blue*f+a.blue*d),alpha:s.alpha*parseFloat(r)+a.alpha*(1-parseFloat(r))};return hA(p)}var fPe=zo(hPe),EQ=fPe;function dPe(r,e){if(e==="transparent")return e;var n=Nh(e),i=typeof n.alpha=="number"?n.alpha:1,s=oo({},n,{alpha:wy(0,1,(i*100+parseFloat(r)*100)/100)});return hA(s)}var pPe=zo(dPe),MQ=pPe;function mPe(r,e){if(e==="transparent")return e;var n=Wh(e);return qh(oo({},n,{saturation:wy(0,1,n.saturation+parseFloat(r))}))}zo(mPe);function gPe(r,e){return e==="transparent"?e:qh(oo({},Wh(e),{hue:parseFloat(r)}))}zo(gPe);function yPe(r,e){return e==="transparent"?e:qh(oo({},Wh(e),{lightness:parseFloat(r)}))}zo(yPe);function vPe(r,e){return e==="transparent"?e:qh(oo({},Wh(e),{saturation:parseFloat(r)}))}zo(vPe);function xPe(r,e){return e==="transparent"?e:EQ(parseFloat(r),"rgb(0, 0, 0)",e)}zo(xPe);function bPe(r,e){return e==="transparent"?e:EQ(parseFloat(r),"rgb(255, 255, 255)",e)}zo(bPe);function _Pe(r,e){if(e==="transparent")return e;var n=Nh(e),i=typeof n.alpha=="number"?n.alpha:1,s=oo({},n,{alpha:wy(0,1,+(i*100-parseFloat(r)*100).toFixed(2)/100)});return hA(s)}zo(_Pe);function wPe(r,e){e===void 0&&(e={});var n=e.insertAt;if(!(typeof document>"u")){var i=document.head||document.getElementsByTagName("head")[0],s=document.createElement("style");s.type="text/css",n==="top"&&i.firstChild?i.insertBefore(s,i.firstChild):i.appendChild(s),s.styleSheet?s.styleSheet.cssText=r:s.appendChild(document.createTextNode(r))}}var SPe=`.graph-nav-info {
  position: absolute;
  bottom: 5px;
  width: 100%;
  text-align: center;
  color: slategrey;
  opacity: 0.7;
  font-size: 10px;
  font-family: Sans-serif;
  z-index: 1000;
}`;wPe(SPe);function mD(r,e){(e==null||e>r.length)&&(e=r.length);for(var n=0,i=Array(e);n<e;n++)i[n]=r[n];return i}function TPe(r){if(Array.isArray(r))return r}function EPe(r){if(Array.isArray(r))return mD(r)}function a0(r,e,n){return(e=NPe(e))in r?Object.defineProperty(r,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):r[e]=n,r}function MPe(r){if(typeof Symbol<"u"&&r[Symbol.iterator]!=null||r["@@iterator"]!=null)return Array.from(r)}function APe(r,e){var n=r==null?null:typeof Symbol<"u"&&r[Symbol.iterator]||r["@@iterator"];if(n!=null){var i,s,o,a,l=[],c=!0,u=!1;try{if(o=(n=n.call(r)).next,e!==0)for(;!(c=(i=o.call(n)).done)&&(l.push(i.value),l.length!==e);c=!0);}catch(h){u=!0,s=h}finally{try{if(!c&&n.return!=null&&(a=n.return(),Object(a)!==a))return}finally{if(u)throw s}}return l}}function CPe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function PPe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function SG(r,e){var n=Object.keys(r);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(r);e&&(i=i.filter(function(s){return Object.getOwnPropertyDescriptor(r,s).enumerable})),n.push.apply(n,i)}return n}function TG(r){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?SG(Object(n),!0).forEach(function(i){a0(r,i,n[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(n)):SG(Object(n)).forEach(function(i){Object.defineProperty(r,i,Object.getOwnPropertyDescriptor(n,i))})}return r}function KR(r,e){return TPe(r)||APe(r,e)||AQ(r,e)||CPe()}function TS(r){return EPe(r)||MPe(r)||AQ(r)||PPe()}function RPe(r,e){if(typeof r!="object"||!r)return r;var n=r[Symbol.toPrimitive];if(n!==void 0){var i=n.call(r,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(r)}function NPe(r){var e=RPe(r,"string");return typeof e=="symbol"?e:e+""}function AQ(r,e){if(r){if(typeof r=="string")return mD(r,e);var n={}.toString.call(r).slice(8,-1);return n==="Object"&&r.constructor&&(n=r.constructor.name),n==="Map"||n==="Set"?Array.from(r):n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?mD(r,e):void 0}}var OPe=Vh({props:{width:{default:window.innerWidth,triggerUpdate:!1,onChange:function(e,n){n.container&&(n.container.style.width="".concat(e,"px"))}},height:{default:window.innerHeight,triggerUpdate:!1,onChange:function(e,n){n.container&&(n.container.style.height="".concat(e,"px"))}},jsonUrl:{},graphData:{default:{nodes:[],links:[]}},numDimensions:{default:3},dagMode:{},dagLevelDistance:{},dagNodeFilter:{default:function(){return!0}},onDagError:{default:void 0},backgroundColor:{default:"#002"},showNavInfo:{default:!0},nodeRelSize:{default:4},nodeId:{default:"id"},nodeLabel:{default:"name"},nodeDesc:{default:"desc"},onNodeHover:{},onNodeClick:{},nodeVal:{default:"val"},nodeResolution:{default:8},nodeVisibility:{default:!0},nodeColor:{default:"color"},nodeAutoColorBy:{},nodeOpacity:{default:.75},nodeThreeObject:{},nodeThreeObjectExtend:{default:!1},linkSource:{default:"source"},linkTarget:{default:"target"},linkLabel:{default:"name"},linkDesc:{default:"desc"},onLinkHover:{},onLinkClick:{},linkVisibility:{default:!0},linkColor:{default:"color"},linkAutoColorBy:{},linkOpacity:{default:.2},linkWidth:{default:0},linkResolution:{default:6},linkCurvature:{default:0},linkCurveRotation:{default:0},linkMaterial:{},linkThreeObject:{},linkThreeObjectExtend:{default:!1},linkPositionUpdate:{},linkDirectionalArrowLength:{default:0},linkDirectionalArrowColor:{},linkDirectionalArrowRelPos:{default:.5},linkDirectionalArrowResolution:{default:8},linkDirectionalParticles:{default:0},linkDirectionalParticleSpeed:{default:.01},linkDirectionalParticleWidth:{default:.5},linkDirectionalParticleColor:{},linkDirectionalParticleResolution:{default:4},forceEngine:{default:"d3"},d3AlphaMin:{default:0},d3AlphaDecay:{default:.0228},d3VelocityDecay:{default:.4},ngraphPhysics:{},warmupTicks:{default:0},cooldownTicks:{},cooldownTime:{default:15e3},onEngineTick:{},onEngineStop:{}},methods:TG(TG({},Object.assign.apply(Object,[{}].concat(TS(["getGraphBbox","emitParticle","d3Force","d3ReheatSimulation","refresh"].map(function(r){return a0({},r,function(e){for(var n=e.forcegraph.components.forcegraph,i=arguments.length,s=new Array(i>1?i-1:0),o=1;o<i;o++)s[o-1]=arguments[o];var a=n[r].apply(n,s);return a===n?this:a})}))))),{},{_destructor:function(){this.graphData({nodes:[],links:[]})}}),init:function(e,n){e.innerHTML="",n.container=document.createElement("div"),e.appendChild(n.container),n.container.style.position="relative",n.container.style.width="".concat(n.width,"px"),n.container.style.height="".concat(n.height,"px"),n.container.appendChild(n.navInfo=document.createElement("div")),n.navInfo.className="graph-nav-info",n.navInfo.textContent="Mouse drag: look, gamepad/arrow/wasd keys: move";var i=document.createElement("a-scene");i.setAttribute("embedded",""),i.appendChild(n.sky=document.createElement("a-sky")),n.sky.setAttribute("radius",3e3);var s;i.appendChild(s=document.createElement("a-entity")),s.setAttribute("position","0 0 300"),s.setAttribute("movement-controls","controls: gamepad, touch; fly: true; speed: 7");var o;s.appendChild(o=document.createElement("a-entity")),o.setAttribute("camera",""),o.setAttribute("position","0 0 0"),o.setAttribute("look-controls","pointerLockEnabled: false"),o.setAttribute("wasd-controls","fly: true; acceleration: 700");var a;o.appendChild(a=document.createElement("a-text")),a.setAttribute("position","0 -0.3 -1"),a.setAttribute("width",2),a.setAttribute("align","center"),a.setAttribute("color","lavender"),a.setAttribute("value","");var l;o.appendChild(l=document.createElement("a-text")),l.setAttribute("position","0 -0.4 -1"),l.setAttribute("width",1.3),l.setAttribute("align","center"),l.setAttribute("color","lavender"),l.setAttribute("value",""),n.raycasterEls=[];var c;i.appendChild(c=document.createElement("a-entity")),c.setAttribute("cursor","rayOrigin: mouse; mouseCursorStylesEnabled: true"),c.setAttribute("raycaster","objects: [forcegraph]; interval: 100"),n.raycasterEls.push(c),["left","right"].forEach(function(u){var h;s.appendChild(h=document.createElement("a-entity")),h.setAttribute("laser-controls","hand: ".concat(u,"; model: false;")),h.setAttribute("raycaster","objects: [forcegraph]; interval: 100; lineColor: steelblue; lineOpacity: 0.85"),n.raycasterEls.push(h)}),i.appendChild(n.forcegraph=document.createElement("a-entity")),n.forcegraph.setAttribute("forcegraph",null),n.container.appendChild(i),n.forcegraph.setAttribute("forcegraph",Object.assign.apply(Object,TS(["node","link"].map(function(u){var h={node:"Node",link:"Link"}[u];return a0({},"on".concat(h,"Hover"),function(d,p){var m=d&&ht(n["".concat(u,"Label")])(d)||"",g=d&&ht(n["".concat(u,"Desc")])(d)||"";a.setAttribute("value",m),l.setAttribute("value",g),n["on".concat(h,"Hover")]&&n["on".concat(h,"Hover")](d,p)})}))))},update:function(e,n){if(n.hasOwnProperty("backgroundColor")){var i=Nh(e.backgroundColor).alpha;i===void 0&&(i=1),e.sky.setAttribute("color",MQ(1,e.backgroundColor)),e.sky.setAttribute("opacity",i)}n.hasOwnProperty("showNavInfo")&&(e.navInfo.style.display=e.showNavInfo?null:"none");var s=["onNodeHover","onLinkHover","onNodeClick","onLinkClick"].some(function(l){return e[l]})||["nodeLabel","linkLabel"].some(function(l){return e[l]!=="name"})||["nodeDesc","linkDesc"].some(function(l){return e[l]!=="desc"});e.raycasterEls.forEach(function(l){return l.setAttribute("raycaster",s?"objects: [forcegraph]; interval: 100":"objects: __none__")});var o=["jsonUrl","numDimensions","dagMode","dagLevelDistance","dagNodeFilter","onDagError","nodeRelSize","nodeId","onNodeClick","nodeVal","nodeResolution","nodeVisibility","nodeColor","nodeAutoColorBy","nodeOpacity","nodeThreeObject","nodeThreeObjectExtend","linkSource","linkTarget","onLinkClick","linkVisibility","linkColor","linkAutoColorBy","linkOpacity","linkWidth","linkResolution","linkCurvature","linkCurveRotation","linkMaterial","linkThreeObject","linkThreeObjectExtend","linkPositionUpdate","linkDirectionalArrowLength","linkDirectionalArrowColor","linkDirectionalArrowRelPos","linkDirectionalArrowResolution","linkDirectionalParticles","linkDirectionalParticleSpeed","linkDirectionalParticleWidth","linkDirectionalParticleColor","linkDirectionalParticleResolution","forceEngine","d3AlphaMin","d3AlphaDecay","d3VelocityDecay","ngraphPhysics","warmupTicks","cooldownTicks","cooldownTime","onEngineTick","onEngineStop"],a=Object.assign.apply(Object,[{}].concat(TS(Object.entries(e).filter(function(l){var c=KR(l,2),u=c[0],h=c[1];return n.hasOwnProperty(u)&&o.indexOf(u)!==-1&&h!==void 0&&h!==null}).map(function(l){var c=KR(l,2),u=c[0],h=c[1];return a0({},u,h)})),TS(Object.entries(e.graphData).map(function(l){var c=KR(l,2),u=c[0],h=c[1];return a0({},u,h)}))));e.forcegraph.setAttribute("forcegraph",a)}}),CQ={exports:{}},DPe="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED",kPe=DPe,IPe=kPe;function PQ(){}function RQ(){}RQ.resetWarningCache=PQ;var LPe=function(){function r(i,s,o,a,l,c){if(c!==IPe){var u=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw u.name="Invariant Violation",u}}r.isRequired=r;function e(){return r}var n={array:r,bigint:r,bool:r,func:r,number:r,object:r,string:r,symbol:r,any:r,arrayOf:e,element:r,elementType:r,instanceOf:e,node:r,objectOf:e,oneOf:e,oneOfType:e,shape:e,exact:e,checkPropTypes:RQ,resetWarningCache:PQ};return n.PropTypes=n,n};CQ.exports=LPe();var FPe=CQ.exports;const ie=hn(FPe);function gD(r,e){(e==null||e>r.length)&&(e=r.length);for(var n=0,i=Array(e);n<e;n++)i[n]=r[n];return i}function BPe(r){if(Array.isArray(r))return r}function UPe(r){if(Array.isArray(r))return gD(r)}function D1(r,e,n){return(e=HPe(e))in r?Object.defineProperty(r,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):r[e]=n,r}function zPe(r){if(typeof Symbol<"u"&&r[Symbol.iterator]!=null||r["@@iterator"]!=null)return Array.from(r)}function $Pe(r,e){var n=r==null?null:typeof Symbol<"u"&&r[Symbol.iterator]||r["@@iterator"];if(n!=null){var i,s,o,a,l=[],c=!0,u=!1;try{if(o=(n=n.call(r)).next,e!==0)for(;!(c=(i=o.call(n)).done)&&(l.push(i.value),l.length!==e);c=!0);}catch(h){u=!0,s=h}finally{try{if(!c&&n.return!=null&&(a=n.return(),Object(a)!==a))return}finally{if(u)throw s}}return l}}function jPe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function VPe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function EG(r,e){var n=Object.keys(r);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(r);e&&(i=i.filter(function(s){return Object.getOwnPropertyDescriptor(r,s).enumerable})),n.push.apply(n,i)}return n}function MG(r){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?EG(Object(n),!0).forEach(function(i){D1(r,i,n[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(n)):EG(Object(n)).forEach(function(i){Object.defineProperty(r,i,Object.getOwnPropertyDescriptor(n,i))})}return r}function ES(r,e){return BPe(r)||$Pe(r,e)||NQ(r,e)||jPe()}function MS(r){return UPe(r)||zPe(r)||NQ(r)||VPe()}function GPe(r,e){if(typeof r!="object"||!r)return r;var n=r[Symbol.toPrimitive];if(n!==void 0){var i=n.call(r,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(r)}function HPe(r){var e=GPe(r,"string");return typeof e=="symbol"?e:e+""}function NQ(r,e){if(r){if(typeof r=="string")return gD(r,e);var n={}.toString.call(r).slice(8,-1);return n==="Object"&&r.constructor&&(n=r.constructor.name),n==="Map"||n==="Set"?Array.from(r):n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?gD(r,e):void 0}}var WPe=Vh({props:{width:{},height:{},yOffset:{default:1.5},glScale:{default:200},jsonUrl:{},graphData:{default:{nodes:[],links:[]}},numDimensions:{default:3},dagMode:{},dagLevelDistance:{},dagNodeFilter:{default:function(){return!0}},onDagError:{default:void 0},nodeRelSize:{default:4},nodeId:{default:"id"},nodeVal:{default:"val"},nodeResolution:{default:8},nodeVisibility:{default:!0},nodeColor:{default:"color"},nodeAutoColorBy:{},nodeOpacity:{default:.75},nodeThreeObject:{},nodeThreeObjectExtend:{default:!1},linkSource:{default:"source"},linkTarget:{default:"target"},linkVisibility:{default:!0},linkColor:{default:"color"},linkAutoColorBy:{},linkOpacity:{default:.2},linkWidth:{default:0},linkResolution:{default:6},linkCurvature:{default:0},linkCurveRotation:{default:0},linkMaterial:{},linkThreeObject:{},linkThreeObjectExtend:{default:!1},linkPositionUpdate:{},linkDirectionalArrowLength:{default:0},linkDirectionalArrowColor:{},linkDirectionalArrowRelPos:{default:.5},linkDirectionalArrowResolution:{default:8},linkDirectionalParticles:{default:0},linkDirectionalParticleSpeed:{default:.01},linkDirectionalParticleWidth:{default:.5},linkDirectionalParticleColor:{},linkDirectionalParticleResolution:{default:4},onNodeHover:{},onNodeClick:{},onLinkHover:{},onLinkClick:{},forceEngine:{default:"d3"},d3AlphaMin:{default:0},d3AlphaDecay:{default:.0228},d3VelocityDecay:{default:.4},ngraphPhysics:{},warmupTicks:{default:0},cooldownTicks:{},cooldownTime:{default:15e3},onEngineTick:{},onEngineStop:{}},methods:MG(MG({},Object.assign.apply(Object,[{}].concat(MS(["getGraphBbox","emitParticle","d3Force","d3ReheatSimulation","refresh"].map(function(r){return D1({},r,function(e){for(var n=e.forcegraph.components.forcegraph,i=arguments.length,s=new Array(i>1?i-1:0),o=1;o<i;o++)s[o-1]=arguments[o];var a=n[r].apply(n,s);return a===n?this:a})}))))),{},{_destructor:function(){this.graphData({nodes:[],links:[]})}}),init:function(e,n){var i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},s=i.markerAttrs,o=s===void 0?{preset:"hiro"}:s;e.innerHTML="",n.container=document.createElement("div"),e.appendChild(n.container);var a=document.createElement("a-scene");a.setAttribute("embedded",""),a.setAttribute("vr-mode-ui","enabled: false"),a.setAttribute("arjs","debugUIEnabled: false;");var l=document.createElement("a-marker");Object.entries(o).forEach(function(h){var f=ES(h,2),d=f[0],p=f[1];return l.setAttribute(d,p)}),a.appendChild(l);var c;a.appendChild(c=document.createElement("a-entity")),c.setAttribute("cursor"),c.setAttribute("raycaster","objects: [forcegraph]"),n.forcegraph=document.createElement("a-entity"),n.forcegraph.setAttribute("forcegraph",null),l.appendChild(n.forcegraph);var u=document.createElement("a-entity");u.setAttribute("camera",""),a.appendChild(u),n.container.appendChild(a)},update:function(e,n){n.hasOwnProperty("width")&&e.width&&(e.container.style.width="".concat(e.width,"px")),n.hasOwnProperty("height")&&e.height&&(e.container.style.height="".concat(e.height,"px")),n.hasOwnProperty("glScale")&&e.forcegraph.setAttribute("scale",MS(new Array(3)).map(function(){return 1/e.glScale}).join(" ")),n.hasOwnProperty("yOffset")&&e.forcegraph.setAttribute("position","0 ".concat(e.yOffset," 0"));var i=["jsonUrl","numDimensions","dagMode","dagLevelDistance","dagNodeFilter","onDagError","nodeRelSize","nodeId","nodeVal","nodeResolution","nodeVisibility","nodeColor","nodeAutoColorBy","nodeOpacity","nodeThreeObject","nodeThreeObjectExtend","linkSource","linkTarget","linkVisibility","linkColor","linkAutoColorBy","linkOpacity","linkWidth","linkResolution","linkCurvature","linkCurveRotation","linkMaterial","linkThreeObject","linkThreeObjectExtend","linkPositionUpdate","linkDirectionalArrowLength","linkDirectionalArrowColor","linkDirectionalArrowRelPos","linkDirectionalArrowResolution","linkDirectionalParticles","linkDirectionalParticleSpeed","linkDirectionalParticleWidth","linkDirectionalParticleColor","linkDirectionalParticleResolution","onNodeHover","onNodeClick","onLinkHover","onLinkClick","forceEngine","d3AlphaMin","d3AlphaDecay","d3VelocityDecay","ngraphPhysics","warmupTicks","cooldownTicks","cooldownTime","onEngineTick","onEngineStop"],s=Object.assign.apply(Object,[{}].concat(MS(Object.entries(e).filter(function(o){var a=ES(o,2),l=a[0],c=a[1];return n.hasOwnProperty(l)&&i.indexOf(l)!==-1&&c!==void 0&&c!==null}).map(function(o){var a=ES(o,2),l=a[0],c=a[1];return D1({},l,c)})),MS(Object.entries(e.graphData).map(function(o){var a=ES(o,2),l=a[0],c=a[1];return D1({},l,c)}))));e.forcegraph.setAttribute("forcegraph",s)}});const Dm=new To,Mc=new Fe,OQ=new K,YR=new Fe,k1=new Fe,aE=new K,yD=new K,DQ=new sn,kQ=new K,IQ=new K;let Ws=null,dl=null;const Ac=[],_h={NONE:-1,PAN:0,ROTATE:1};class qPe extends eA{constructor(e,n,i=null){super(n,i),this.objects=e,this.recursive=!0,this.transformGroup=!1,this.rotateSpeed=1,this.raycaster=new $Y,this.mouseButtons={LEFT:Ui.PAN,MIDDLE:Ui.PAN,RIGHT:Ui.ROTATE},this.touches={ONE:Oc.PAN},this._onPointerMove=XPe.bind(this),this._onPointerDown=KPe.bind(this),this._onPointerCancel=YPe.bind(this),this._onContextMenu=ZPe.bind(this),i!==null&&this.connect(i)}connect(e){super.connect(e),this.domElement.addEventListener("pointermove",this._onPointerMove),this.domElement.addEventListener("pointerdown",this._onPointerDown),this.domElement.addEventListener("pointerup",this._onPointerCancel),this.domElement.addEventListener("pointerleave",this._onPointerCancel),this.domElement.addEventListener("contextmenu",this._onContextMenu),this.domElement.style.touchAction="none"}disconnect(){this.domElement.removeEventListener("pointermove",this._onPointerMove),this.domElement.removeEventListener("pointerdown",this._onPointerDown),this.domElement.removeEventListener("pointerup",this._onPointerCancel),this.domElement.removeEventListener("pointerleave",this._onPointerCancel),this.domElement.removeEventListener("contextmenu",this._onContextMenu),this.domElement.style.touchAction="auto",this.domElement.style.cursor=""}dispose(){this.disconnect()}_updatePointer(e){const n=this.domElement.getBoundingClientRect();Mc.x=(e.clientX-n.left)/n.width*2-1,Mc.y=-(e.clientY-n.top)/n.height*2+1}_updateState(e){let n;if(e.pointerType==="touch")n=this.touches.ONE;else switch(e.button){case 0:n=this.mouseButtons.LEFT;break;case 1:n=this.mouseButtons.MIDDLE;break;case 2:n=this.mouseButtons.RIGHT;break;default:n=null}switch(n){case Ui.PAN:case Oc.PAN:this.state=_h.PAN;break;case Ui.ROTATE:case Oc.ROTATE:this.state=_h.ROTATE;break;default:this.state=_h.NONE}}getRaycaster(){return console.warn("THREE.DragControls: getRaycaster() has been deprecated. Use controls.raycaster instead."),this.raycaster}setObjects(e){console.warn("THREE.DragControls: setObjects() has been deprecated. Use controls.objects instead."),this.objects=e}getObjects(){return console.warn("THREE.DragControls: getObjects() has been deprecated. Use controls.objects instead."),this.objects}activate(){console.warn("THREE.DragControls: activate() has been renamed to connect()."),this.connect()}deactivate(){console.warn("THREE.DragControls: deactivate() has been renamed to disconnect()."),this.disconnect()}set mode(e){console.warn("THREE.DragControls: The .mode property has been removed. Define the type of transformation via the .mouseButtons or .touches properties.")}get mode(){console.warn("THREE.DragControls: The .mode property has been removed. Define the type of transformation via the .mouseButtons or .touches properties.")}}function XPe(r){const e=this.object,n=this.domElement,i=this.raycaster;if(this.enabled!==!1){if(this._updatePointer(r),i.setFromCamera(Mc,e),Ws)this.state===_h.PAN?i.ray.intersectPlane(Dm,aE)&&Ws.position.copy(aE.sub(OQ).applyMatrix4(DQ)):this.state===_h.ROTATE&&(YR.subVectors(Mc,k1).multiplyScalar(this.rotateSpeed),Ws.rotateOnWorldAxis(kQ,YR.x),Ws.rotateOnWorldAxis(IQ.normalize(),-YR.y)),this.dispatchEvent({type:"drag",object:Ws}),k1.copy(Mc);else if(r.pointerType==="mouse"||r.pointerType==="pen")if(Ac.length=0,i.setFromCamera(Mc,e),i.intersectObjects(this.objects,this.recursive,Ac),Ac.length>0){const s=Ac[0].object;Dm.setFromNormalAndCoplanarPoint(e.getWorldDirection(Dm.normal),yD.setFromMatrixPosition(s.matrixWorld)),dl!==s&&dl!==null&&(this.dispatchEvent({type:"hoveroff",object:dl}),n.style.cursor="auto",dl=null),dl!==s&&(this.dispatchEvent({type:"hoveron",object:s}),n.style.cursor="pointer",dl=s)}else dl!==null&&(this.dispatchEvent({type:"hoveroff",object:dl}),n.style.cursor="auto",dl=null);k1.copy(Mc)}}function KPe(r){const e=this.object,n=this.domElement,i=this.raycaster;this.enabled!==!1&&(this._updatePointer(r),this._updateState(r),Ac.length=0,i.setFromCamera(Mc,e),i.intersectObjects(this.objects,this.recursive,Ac),Ac.length>0&&(this.transformGroup===!0?Ws=LQ(Ac[0].object):Ws=Ac[0].object,Dm.setFromNormalAndCoplanarPoint(e.getWorldDirection(Dm.normal),yD.setFromMatrixPosition(Ws.matrixWorld)),i.ray.intersectPlane(Dm,aE)&&(this.state===_h.PAN?(DQ.copy(Ws.parent.matrixWorld).invert(),OQ.copy(aE).sub(yD.setFromMatrixPosition(Ws.matrixWorld))):this.state===_h.ROTATE&&(kQ.set(0,1,0).applyQuaternion(e.quaternion).normalize(),IQ.set(1,0,0).applyQuaternion(e.quaternion).normalize())),n.style.cursor="move",this.dispatchEvent({type:"dragstart",object:Ws})),k1.copy(Mc))}function YPe(){this.enabled!==!1&&(Ws&&(this.dispatchEvent({type:"dragend",object:Ws}),Ws=null),this.domElement.style.cursor=dl?"pointer":"auto",this.state=_h.NONE)}function ZPe(r){this.enabled!==!1&&r.preventDefault()}function LQ(r,e=null){return r.isGroup&&(e=r),r.parent===null?e:LQ(r.parent,e)}/**
 * @license
 * Copyright 2010-2025 Three.js Authors
 * SPDX-License-Identifier: MIT
 */const QPe=["alphaMap","alphaTest","anisotropy","anisotropyMap","anisotropyRotation","aoMap","attenuationColor","attenuationDistance","bumpMap","clearcoat","clearcoatMap","clearcoatNormalMap","clearcoatNormalScale","clearcoatRoughness","color","dispersion","displacementMap","emissive","emissiveMap","envMap","gradientMap","ior","iridescence","iridescenceIOR","iridescenceMap","iridescenceThicknessMap","lightMap","map","matcap","metalness","metalnessMap","normalMap","normalScale","opacity","roughness","roughnessMap","sheen","sheenColor","sheenColorMap","sheenRoughnessMap","shininess","specular","specularColor","specularColorMap","specularIntensity","specularIntensityMap","specularMap","thickness","transmission","transmissionMap"];class JPe{constructor(e){this.renderObjects=new WeakMap,this.hasNode=this.containsNode(e),this.hasAnimation=e.object.isSkinnedMesh===!0,this.refreshUniforms=QPe,this.renderId=0}firstInitialization(e){return this.renderObjects.has(e)===!1?(this.getRenderObjectData(e),!0):!1}needsVelocity(e){const n=e.getMRT();return n!==null&&n.has("velocity")}getRenderObjectData(e){let n=this.renderObjects.get(e);if(n===void 0){const{geometry:i,material:s,object:o}=e;if(n={material:this.getMaterialData(s),geometry:{id:i.id,attributes:this.getAttributesData(i.attributes),indexVersion:i.index?i.index.version:null,drawRange:{start:i.drawRange.start,count:i.drawRange.count}},worldMatrix:o.matrixWorld.clone()},o.center&&(n.center=o.center.clone()),o.morphTargetInfluences&&(n.morphTargetInfluences=o.morphTargetInfluences.slice()),e.bundle!==null&&(n.version=e.bundle.version),n.material.transmission>0){const{width:a,height:l}=e.context;n.bufferWidth=a,n.bufferHeight=l}this.renderObjects.set(e,n)}return n}getAttributesData(e){const n={};for(const i in e){const s=e[i];n[i]={version:s.version}}return n}containsNode(e){const n=e.material;for(const i in n)if(n[i]&&n[i].isNode)return!0;return e.renderer.overrideNodes.modelViewMatrix!==null||e.renderer.overrideNodes.modelNormalViewMatrix!==null}getMaterialData(e){const n={};for(const i of this.refreshUniforms){const s=e[i];s!=null&&(typeof s=="object"&&s.clone!==void 0?s.isTexture===!0?n[i]={id:s.id,version:s.version}:n[i]=s.clone():n[i]=s)}return n}equals(e){const{object:n,material:i,geometry:s}=e,o=this.getRenderObjectData(e);if(o.worldMatrix.equals(n.matrixWorld)!==!0)return o.worldMatrix.copy(n.matrixWorld),!1;const a=o.material;for(const g in a){const v=a[g],y=i[g];if(v.equals!==void 0){if(v.equals(y)===!1)return v.copy(y),!1}else if(y.isTexture===!0){if(v.id!==y.id||v.version!==y.version)return v.id=y.id,v.version=y.version,!1}else if(v!==y)return a[g]=y,!1}if(a.transmission>0){const{width:g,height:v}=e.context;if(o.bufferWidth!==g||o.bufferHeight!==v)return o.bufferWidth=g,o.bufferHeight=v,!1}const l=o.geometry,c=s.attributes,u=l.attributes,h=Object.keys(u),f=Object.keys(c);if(l.id!==s.id)return l.id=s.id,!1;if(h.length!==f.length)return o.geometry.attributes=this.getAttributesData(c),!1;for(const g of h){const v=u[g],y=c[g];if(y===void 0)return delete u[g],!1;if(v.version!==y.version)return v.version=y.version,!1}const d=s.index,p=l.indexVersion,m=d?d.version:null;if(p!==m)return l.indexVersion=m,!1;if(l.drawRange.start!==s.drawRange.start||l.drawRange.count!==s.drawRange.count)return l.drawRange.start=s.drawRange.start,l.drawRange.count=s.drawRange.count,!1;if(o.morphTargetInfluences){let g=!1;for(let v=0;v<o.morphTargetInfluences.length;v++)o.morphTargetInfluences[v]!==n.morphTargetInfluences[v]&&(g=!0);if(g)return!0}return o.center&&o.center.equals(n.center)===!1?(o.center.copy(n.center),!0):(e.bundle!==null&&(o.version=e.bundle.version),!0)}needsRefresh(e,n){if(this.hasNode||this.hasAnimation||this.firstInitialization(e)||this.needsVelocity(n.renderer))return!0;const{renderId:i}=n;if(this.renderId!==i)return this.renderId=i,!0;const s=e.object.static===!0,o=e.bundle!==null&&e.bundle.static===!0&&this.getRenderObjectData(e).version===e.bundle.version;return s||o?!1:this.equals(e)!==!0}}function ib(r,e=0){let n=3735928559^e,i=1103547991^e;if(r instanceof Array)for(let s=0,o;s<r.length;s++)o=r[s],n=Math.imul(n^o,2654435761),i=Math.imul(i^o,1597334677);else for(let s=0,o;s<r.length;s++)o=r.charCodeAt(s),n=Math.imul(n^o,2654435761),i=Math.imul(i^o,1597334677);return n=Math.imul(n^n>>>16,2246822507),n^=Math.imul(i^i>>>13,3266489909),i=Math.imul(i^i>>>16,2246822507),i^=Math.imul(n^n>>>13,3266489909),4294967296*(2097151&i)+(n>>>0)}const eRe=r=>ib(r),T3=r=>ib(r),sb=(...r)=>ib(r);function FQ(r,e=!1){const n=[];r.isNode===!0&&(n.push(r.id),r=r.getSelf());for(const{property:i,childNode:s}of lE(r))n.push(ib(i.slice(0,-4)),s.getCacheKey(e));return ib(n)}function*lE(r,e=!1){for(const n in r){if(n.startsWith("_")===!0)continue;const i=r[n];if(Array.isArray(i)===!0)for(let s=0;s<i.length;s++){const o=i[s];o&&(o.isNode===!0||e&&typeof o.toJSON=="function")&&(yield{property:n,index:s,childNode:o})}else if(i&&i.isNode===!0)yield{property:n,childNode:i};else if(typeof i=="object")for(const s in i){const o=i[s];o&&(o.isNode===!0||e&&typeof o.toJSON=="function")&&(yield{property:n,index:s,childNode:o})}}}const tRe=new Map([[1,"float"],[2,"vec2"],[3,"vec3"],[4,"vec4"],[9,"mat3"],[16,"mat4"]]),AG=new WeakMap;function nRe(r){return tRe.get(r)}function cE(r){if(r==null)return null;const e=typeof r;return r.isNode===!0?"node":e==="number"?"float":e==="boolean"?"bool":e==="string"?"string":e==="function"?"shader":r.isVector2===!0?"vec2":r.isVector3===!0?"vec3":r.isVector4===!0?"vec4":r.isMatrix2===!0?"mat2":r.isMatrix3===!0?"mat3":r.isMatrix4===!0?"mat4":r.isColor===!0?"color":r instanceof ArrayBuffer?"ArrayBuffer":null}function BQ(r,...e){const n=r?r.slice(-4):void 0;return e.length===1&&(n==="vec2"?e=[e[0],e[0]]:n==="vec3"?e=[e[0],e[0],e[0]]:n==="vec4"&&(e=[e[0],e[0],e[0],e[0]])),r==="color"?new pt(...e):n==="vec2"?new Fe(...e):n==="vec3"?new K(...e):n==="vec4"?new Nt(...e):n==="mat2"?new JM(...e):n==="mat3"?new Bt(...e):n==="mat4"?new sn(...e):r==="bool"?e[0]||!1:r==="float"||r==="int"||r==="uint"?e[0]||0:r==="string"?e[0]||"":r==="ArrayBuffer"?iRe(e[0]):null}function UQ(r){let e=AG.get(r);return e===void 0&&(e={},AG.set(r,e)),e}function rRe(r){let e="";const n=new Uint8Array(r);for(let i=0;i<n.length;i++)e+=String.fromCharCode(n[i]);return btoa(e)}function iRe(r){return Uint8Array.from(atob(r),e=>e.charCodeAt(0)).buffer}const CG={VERTEX:"vertex",FRAGMENT:"fragment"},Jt={NONE:"none",FRAME:"frame",RENDER:"render",OBJECT:"object"},Bc={READ_ONLY:"readOnly",WRITE_ONLY:"writeOnly",READ_WRITE:"readWrite"},sRe=["fragment","vertex"],PG=["setup","analyze","generate"],RG=[...sRe,"compute"],Sy=["x","y","z","w"];let oRe=0,Vt=class extends gu{static get type(){return"Node"}constructor(e=null){super(),this.nodeType=e,this.updateType=Jt.NONE,this.updateBeforeType=Jt.NONE,this.updateAfterType=Jt.NONE,this.uuid=$T.generateUUID(),this.version=0,this.global=!1,this.parents=!1,this.isNode=!0,this._cacheKey=null,this._cacheKeyVersion=0,Object.defineProperty(this,"id",{value:oRe++})}set needsUpdate(e){e===!0&&this.version++}get type(){return this.constructor.type}onUpdate(e,n){return this.updateType=n,this.update=e.bind(this.getSelf()),this}onFrameUpdate(e){return this.onUpdate(e,Jt.FRAME)}onRenderUpdate(e){return this.onUpdate(e,Jt.RENDER)}onObjectUpdate(e){return this.onUpdate(e,Jt.OBJECT)}onReference(e){return this.updateReference=e.bind(this.getSelf()),this}getSelf(){return this.self||this}updateReference(){return this}isGlobal(){return this.global}*getChildren(){for(const{childNode:e}of lE(this))yield e}dispose(){this.dispatchEvent({type:"dispose"})}traverse(e){e(this);for(const n of this.getChildren())n.traverse(e)}getCacheKey(e=!1){return e=e||this.version!==this._cacheKeyVersion,(e===!0||this._cacheKey===null)&&(this._cacheKey=sb(FQ(this,e),this.customCacheKey()),this._cacheKeyVersion=this.version),this._cacheKey}customCacheKey(){return 0}getScope(){return this}getHash(){return this.uuid}getUpdateType(){return this.updateType}getUpdateBeforeType(){return this.updateBeforeType}getUpdateAfterType(){return this.updateAfterType}getElementType(e){const n=this.getNodeType(e);return e.getElementType(n)}getMemberType(){return"void"}getNodeType(e){const n=e.getNodeProperties(this);return n.outputNode?n.outputNode.getNodeType(e):this.nodeType}getShared(e){const n=this.getHash(e);return e.getNodeFromHash(n)||this}setup(e){const n=e.getNodeProperties(this);let i=0;for(const s of this.getChildren())n["node"+i++]=s;return n.outputNode||null}analyze(e){if(e.increaseUsage(this)===1){const i=e.getNodeProperties(this);for(const s of Object.values(i))s&&s.isNode===!0&&s.build(e)}}generate(e,n){const{outputNode:i}=e.getNodeProperties(this);if(i&&i.isNode===!0)return i.build(e,n)}updateBefore(){console.warn("Abstract function.")}updateAfter(){console.warn("Abstract function.")}update(){console.warn("Abstract function.")}build(e,n=null){const i=this.getShared(e);if(this!==i)return i.build(e,n);e.addNode(this),e.addChain(this);let s=null;const o=e.getBuildStage();if(o==="setup"){this.updateReference(e);const a=e.getNodeProperties(this);if(a.initialized!==!0){a.initialized=!0;const l=this.setup(e),c=l&&l.isNode===!0;for(const u of Object.values(a))if(u&&u.isNode===!0){if(u.parents===!0){const h=e.getNodeProperties(u);h.parents=h.parents||[],h.parents.push(this)}u.build(e)}c&&l.build(e),a.outputNode=l}s=a.outputNode||null}else if(o==="analyze")this.analyze(e);else if(o==="generate")if(this.generate.length===1){const l=this.getNodeType(e),c=e.getDataFromNode(this);s=c.snippet,s===void 0?c.generated===void 0?(c.generated=!0,s=this.generate(e)||"",c.snippet=s):(console.warn("THREE.Node: Recursion detected.",this),s=""):c.flowCodes!==void 0&&e.context.nodeBlock!==void 0&&e.addFlowCodeHierarchy(this,e.context.nodeBlock),s=e.format(s,l,n)}else s=this.generate(e,n)||"";return e.removeChain(this),e.addSequentialNode(this),s}getSerializeChildren(){return lE(this)}serialize(e){const n=this.getSerializeChildren(),i={};for(const{property:s,index:o,childNode:a}of n)o!==void 0?(i[s]===void 0&&(i[s]=Number.isInteger(o)?[]:{}),i[s][o]=a.toJSON(e.meta).uuid):i[s]=a.toJSON(e.meta).uuid;Object.keys(i).length>0&&(e.inputNodes=i)}deserialize(e){if(e.inputNodes!==void 0){const n=e.meta.nodes;for(const i in e.inputNodes)if(Array.isArray(e.inputNodes[i])){const s=[];for(const o of e.inputNodes[i])s.push(n[o]);this[i]=s}else if(typeof e.inputNodes[i]=="object"){const s={};for(const o in e.inputNodes[i]){const a=e.inputNodes[i][o];s[o]=n[a]}this[i]=s}else{const s=e.inputNodes[i];this[i]=n[s]}}}toJSON(e){const{uuid:n,type:i}=this,s=e===void 0||typeof e=="string";s&&(e={textures:{},images:{},nodes:{}});let o=e.nodes[n];o===void 0&&(o={uuid:n,type:i,meta:e,metadata:{version:4.6,type:"Node",generator:"Node.toJSON"}},s!==!0&&(e.nodes[o.uuid]=o),this.serialize(o),delete o.meta);function a(l){const c=[];for(const u in l){const h=l[u];delete h.metadata,c.push(h)}return c}if(s){const l=a(e.textures),c=a(e.images),u=a(e.nodes);l.length>0&&(o.textures=l),c.length>0&&(o.images=c),u.length>0&&(o.nodes=u)}return o}};class E_ extends Vt{static get type(){return"ArrayElementNode"}constructor(e,n){super(),this.node=e,this.indexNode=n,this.isArrayElementNode=!0}getNodeType(e){return this.node.getElementType(e)}generate(e){const n=this.indexNode.getNodeType(e),i=this.node.build(e),s=this.indexNode.build(e,!e.isVector(n)&&e.isInteger(n)?n:"uint");return`${i}[ ${s} ]`}}class zQ extends Vt{static get type(){return"ConvertNode"}constructor(e,n){super(),this.node=e,this.convertTo=n}getNodeType(e){const n=this.node.getNodeType(e);let i=null;for(const s of this.convertTo.split("|"))(i===null||e.getTypeLength(n)===e.getTypeLength(s))&&(i=s);return i}serialize(e){super.serialize(e),e.convertTo=this.convertTo}deserialize(e){super.deserialize(e),this.convertTo=e.convertTo}generate(e,n){const i=this.node,s=this.getNodeType(e),o=i.build(e,s);return e.format(o,s,n)}}class Qr extends Vt{static get type(){return"TempNode"}constructor(e=null){super(e),this.isTempNode=!0}hasDependencies(e){return e.getDataFromNode(this).usageCount>1}build(e,n){if(e.getBuildStage()==="generate"){const s=e.getVectorType(this.getNodeType(e,n)),o=e.getDataFromNode(this);if(o.propertyName!==void 0)return e.format(o.propertyName,s,n);if(s!=="void"&&n!=="void"&&this.hasDependencies(e)){const a=super.build(e,s),l=e.getVarFromNode(this,null,s),c=e.getPropertyName(l);return e.addLineFlowCode(`${c} = ${a}`,this),o.snippet=a,o.propertyName=c,e.format(o.propertyName,s,n)}}return super.build(e,n)}}class aRe extends Qr{static get type(){return"JoinNode"}constructor(e=[],n=null){super(n),this.nodes=e}getNodeType(e){return this.nodeType!==null?e.getVectorType(this.nodeType):e.getTypeFromLength(this.nodes.reduce((n,i)=>n+e.getTypeLength(i.getNodeType(e)),0))}generate(e,n){const i=this.getNodeType(e),s=e.getTypeLength(i),o=this.nodes,a=e.getComponentType(i),l=[];let c=0;for(const h of o){if(c>=s){console.error(`THREE.TSL: Length of parameters exceeds maximum length of function '${i}()' type.`);break}let f=h.getNodeType(e),d=e.getTypeLength(f),p;c+d>s&&(console.error(`THREE.TSL: Length of '${i}()' data exceeds maximum length of output type.`),d=s-c,f=e.getTypeFromLength(d)),c+=d,p=h.build(e,f);const m=e.getComponentType(f);m!==a&&(p=e.format(p,m,a)),l.push(p)}const u=`${e.getType(i)}( ${l.join(", ")} )`;return e.format(u,i,n)}}const lRe=Sy.join("");class NG extends Vt{static get type(){return"SplitNode"}constructor(e,n="x"){super(),this.node=e,this.components=n,this.isSplitNode=!0}getVectorLength(){let e=this.components.length;for(const n of this.components)e=Math.max(Sy.indexOf(n)+1,e);return e}getComponentType(e){return e.getComponentType(this.node.getNodeType(e))}getNodeType(e){return e.getTypeFromLength(this.components.length,this.getComponentType(e))}generate(e,n){const i=this.node,s=e.getTypeLength(i.getNodeType(e));let o=null;if(s>1){let a=null;this.getVectorLength()>=s&&(a=e.getTypeFromLength(this.getVectorLength(),this.getComponentType(e)));const c=i.build(e,a);this.components.length===s&&this.components===lRe.slice(0,this.components.length)?o=e.format(c,a,n):o=e.format(`${c}.${this.components}`,this.getNodeType(e),n)}else o=i.build(e,n);return o}serialize(e){super.serialize(e),e.components=this.components}deserialize(e){super.deserialize(e),this.components=e.components}}class cRe extends Qr{static get type(){return"SetNode"}constructor(e,n,i){super(),this.sourceNode=e,this.components=n,this.targetNode=i}getNodeType(e){return this.sourceNode.getNodeType(e)}generate(e){const{sourceNode:n,components:i,targetNode:s}=this,o=this.getNodeType(e),a=e.getComponentType(s.getNodeType(e)),l=e.getTypeFromLength(i.length,a),c=s.build(e,l),u=n.build(e,o),h=e.getTypeLength(o),f=[];for(let d=0;d<h;d++){const p=Sy[d];p===i[0]?(f.push(c),d+=i.length-1):f.push(u+"."+p)}return`${e.getType(o)}( ${f.join(", ")} )`}}class uRe extends Qr{static get type(){return"FlipNode"}constructor(e,n){super(),this.sourceNode=e,this.components=n}getNodeType(e){return this.sourceNode.getNodeType(e)}generate(e){const{components:n,sourceNode:i}=this,s=this.getNodeType(e),o=i.build(e),a=e.getVarFromNode(this),l=e.getPropertyName(a);e.addLineFlowCode(l+" = "+o,this);const c=e.getTypeLength(s),u=[];let h=0;for(let f=0;f<c;f++){const d=Sy[f];d===n[h]?(u.push("1.0 - "+(l+"."+d)),h++):u.push(l+"."+d)}return`${e.getType(s)}( ${u.join(", ")} )`}}class E3 extends Vt{static get type(){return"InputNode"}constructor(e,n=null){super(n),this.isInputNode=!0,this.value=e,this.precision=null}getNodeType(){return this.nodeType===null?cE(this.value):this.nodeType}getInputType(e){return this.getNodeType(e)}setPrecision(e){return this.precision=e,this}serialize(e){super.serialize(e),e.value=this.value,this.value&&this.value.toArray&&(e.value=this.value.toArray()),e.valueType=cE(this.value),e.nodeType=this.nodeType,e.valueType==="ArrayBuffer"&&(e.value=rRe(e.value)),e.precision=this.precision}deserialize(e){super.deserialize(e),this.nodeType=e.nodeType,this.value=Array.isArray(e.value)?BQ(e.valueType,...e.value):e.value,this.precision=e.precision||null,this.value&&this.value.fromArray&&(this.value=this.value.fromArray(e.value))}generate(){console.warn("Abstract function.")}}const OG=/float|u?int/;class xu extends E3{static get type(){return"ConstNode"}constructor(e,n=null){super(e,n),this.isConstNode=!0}generateConst(e){return e.generateConst(this.getNodeType(e),this.value)}generate(e,n){const i=this.getNodeType(e);return OG.test(i)&&OG.test(n)?e.generateConst(n,this.value):e.format(this.generateConst(e),i,n)}}class hRe extends Vt{static get type(){return"MemberNode"}constructor(e,n){super(),this.node=e,this.property=n,this.isMemberNode=!0}getNodeType(e){return this.node.getMemberType(e,this.property)}generate(e){return this.node.build(e)+"."+this.property}}let Tg=null;const um=new Map;function be(r,e){if(um.has(r)){console.warn(`THREE.TSL: Redefinition of method chaining '${r}'.`);return}if(typeof e!="function")throw new Error(`THREE.TSL: Node element ${r} is not a function`);um.set(r,e)}const $Q=r=>r.replace(/r|s/g,"x").replace(/g|t/g,"y").replace(/b|p/g,"z").replace(/a|q/g,"w"),DG=r=>$Q(r).split("").sort().join(""),jQ={setup(r,e){const n=e.shift();return r(pA(n),...e)},get(r,e,n){if(typeof e=="string"&&r[e]===void 0){if(r.isStackNode!==!0&&e==="assign")return(...i)=>(Tg.assign(n,...i),n);if(um.has(e)){const i=um.get(e);return r.isStackNode?(...s)=>n.add(i(...s)):(...s)=>i(n,...s)}else{if(e==="self")return r;if(e.endsWith("Assign")&&um.has(e.slice(0,e.length-6))){const i=um.get(e.slice(0,e.length-6));return r.isStackNode?(...s)=>n.assign(s[0],i(...s)):(...s)=>n.assign(i(n,...s))}else{if(/^[xyzwrgbastpq]{1,4}$/.test(e)===!0)return e=$Q(e),Le(new NG(n,e));if(/^set[XYZWRGBASTPQ]{1,4}$/.test(e)===!0)return e=DG(e.slice(3).toLowerCase()),i=>Le(new cRe(r,e,i));if(/^flip[XYZWRGBASTPQ]{1,4}$/.test(e)===!0)return e=DG(e.slice(4).toLowerCase()),()=>Le(new uRe(Le(r),e));if(e==="width"||e==="height"||e==="depth")return e==="width"?e="x":e==="height"?e="y":e==="depth"&&(e="z"),Le(new NG(r,e));if(/^\d+$/.test(e)===!0)return Le(new E_(n,new xu(Number(e),"uint")));if(/^get$/.test(e)===!0)return i=>Le(new hRe(n,i))}}}return Reflect.get(r,e,n)},set(r,e,n,i){return typeof e=="string"&&r[e]===void 0&&(/^[xyzwrgbastpq]{1,4}$/.test(e)===!0||e==="width"||e==="height"||e==="depth"||/^\d+$/.test(e)===!0)?(i[e].assign(n),!0):Reflect.set(r,e,n,i)}},ZR=new WeakMap,kG=new WeakMap,fRe=function(r,e=null){const n=cE(r);if(n==="node"){let i=ZR.get(r);return i===void 0&&(i=new Proxy(r,jQ),ZR.set(r,i),ZR.set(i,i)),i}else{if(e===null&&(n==="float"||n==="boolean")||n&&n!=="shader"&&n!=="string")return Le(vD(r,e));if(n==="shader")return Oe(r)}return r},dRe=function(r,e=null){for(const n in r)r[n]=Le(r[n],e);return r},pRe=function(r,e=null){const n=r.length;for(let i=0;i<n;i++)r[i]=Le(r[i],e);return r},mRe=function(r,e=null,n=null,i=null){const s=h=>Le(i!==null?Object.assign(h,i):h);let o,a=e,l,c;function u(h){let f;return a?f=/[a-z]/i.test(a)?a+"()":a:f=r.type,l!==void 0&&h.length<l?(console.error(`THREE.TSL: "${f}" parameter length is less than minimum required.`),h.concat(new Array(l-h.length).fill(0))):c!==void 0&&h.length>c?(console.error(`THREE.TSL: "${f}" parameter length exceeds limit.`),h.slice(0,c)):h}return e===null?o=(...h)=>s(new r(...km(u(h)))):n!==null?(n=Le(n),o=(...h)=>s(new r(e,...km(u(h)),n))):o=(...h)=>s(new r(e,...km(u(h)))),o.setParameterLength=(...h)=>(h.length===1?l=c=h[0]:h.length===2&&([l,c]=h),o),o.setName=h=>(a=h,o),o},gRe=function(r,...e){return Le(new r(...km(e)))};class yRe extends Vt{constructor(e,n){super(),this.shaderNode=e,this.inputNodes=n,this.isShaderCallNodeInternal=!0}getNodeType(e){return this.shaderNode.nodeType||this.getOutputNode(e).getNodeType(e)}getMemberType(e,n){return this.getOutputNode(e).getMemberType(e,n)}call(e){const{shaderNode:n,inputNodes:i}=this,s=e.getNodeProperties(n);if(s.onceOutput)return s.onceOutput;let o=null;if(n.layout){let a=kG.get(e.constructor);a===void 0&&(a=new WeakMap,kG.set(e.constructor,a));let l=a.get(n);l===void 0&&(l=Le(e.buildFunctionNode(n)),a.set(n,l)),e.addInclude(l),o=Le(l.call(i))}else{const a=n.jsFunc,l=i!==null||a.length>1?a(i||[],e):a(e);o=Le(l)}return n.once&&(s.onceOutput=o),o}getOutputNode(e){const n=e.getNodeProperties(this);return n.outputNode===null&&(n.outputNode=this.setupOutput(e)),n.outputNode}setup(e){return this.getOutputNode(e)}setupOutput(e){return e.addStack(),e.stack.outputNode=this.call(e),e.removeStack()}generate(e,n){return this.getOutputNode(e).build(e,n)}}class vRe extends Vt{constructor(e,n){super(n),this.jsFunc=e,this.layout=null,this.global=!0,this.once=!1}setLayout(e){return this.layout=e,this}call(e=null){return pA(e),Le(new yRe(this,e))}setup(){return this.call()}}const xRe=[!1,!0],bRe=[0,1,2,3],_Re=[-1,-2],VQ=[.5,1.5,1/3,1e-6,1e6,Math.PI,Math.PI*2,1/Math.PI,2/Math.PI,1/(Math.PI*2),Math.PI/2],M3=new Map;for(const r of xRe)M3.set(r,new xu(r));const A3=new Map;for(const r of bRe)A3.set(r,new xu(r,"uint"));const C3=new Map([...A3].map(r=>new xu(r.value,"int")));for(const r of _Re)C3.set(r,new xu(r,"int"));const fA=new Map([...C3].map(r=>new xu(r.value)));for(const r of VQ)fA.set(r,new xu(r));for(const r of VQ)fA.set(-r,new xu(-r));const dA={bool:M3,uint:A3,ints:C3,float:fA},IG=new Map([...M3,...fA]),vD=(r,e)=>IG.has(r)?IG.get(r):r.isNode===!0?r:new xu(r,e),wRe=r=>{try{return r.getNodeType()}catch{return}},Jr=function(r,e=null){return(...n)=>{if((n.length===0||!["bool","float","int","uint"].includes(r)&&n.every(s=>typeof s!="object"))&&(n=[BQ(r,...n)]),n.length===1&&e!==null&&e.has(n[0]))return Le(e.get(n[0]));if(n.length===1){const s=vD(n[0],r);return wRe(s)===r?Le(s):Le(new zQ(s,r))}const i=n.map(s=>vD(s));return Le(new aRe(i,r))}},LG=r=>typeof r=="object"&&r!==null?r.value:r,SRe=r=>r!=null?r.nodeType||r.convertTo||(typeof r=="string"?r:null):null;function l0(r,e){return new Proxy(new vRe(r,e),jQ)}const Le=(r,e=null)=>fRe(r,e),pA=(r,e=null)=>new dRe(r,e),km=(r,e=null)=>new pRe(r,e),Ne=(...r)=>new mRe(...r),je=(...r)=>new gRe(...r);let TRe=0;const Oe=(r,e=null)=>{let n=null;e!==null&&(typeof e=="object"?n=e.return:(typeof e=="string"?n=e:console.error("THREE.TSL: Invalid layout type."),e=null));const i=new l0(r,n),s=(...o)=>{let a;pA(o),o[0]&&o[0].isNode?a=[...o]:a=o[0];const l=i.call(a);return n==="void"&&l.toStack(),l};if(s.shaderNode=i,s.setLayout=o=>(i.setLayout(o),s),s.once=()=>(i.once=!0,s),e!==null){if(typeof e.inputs!="object"){const o={name:"fn"+TRe++,type:n,inputs:[]};for(const a in e)a!=="return"&&o.inputs.push({name:a,type:e[a]});e=o}s.setLayout(e)}return s};be("toGlobal",r=>(r.global=!0,r));const uE=r=>{Tg=r},GQ=()=>Tg,kr=(...r)=>Tg.If(...r);function HQ(r){return Tg&&Tg.add(r),r}be("toStack",HQ);const ERe=new Jr("color"),Te=new Jr("float",dA.float),zn=new Jr("int",dA.ints),MRe=new Jr("uint",dA.uint),WQ=new Jr("bool",dA.bool),Ve=new Jr("vec2"),Tc=new Jr("ivec2"),ARe=new Jr("uvec2"),CRe=new Jr("bvec2"),Ae=new Jr("vec3"),PRe=new Jr("ivec3"),RRe=new Jr("uvec3"),NRe=new Jr("bvec3"),jt=new Jr("vec4"),ORe=new Jr("ivec4"),DRe=new Jr("uvec4"),kRe=new Jr("bvec4"),P3=new Jr("mat2"),Ds=new Jr("mat3"),Im=new Jr("mat4");be("toColor",ERe);be("toFloat",Te);be("toInt",zn);be("toUint",MRe);be("toBool",WQ);be("toVec2",Ve);be("toIVec2",Tc);be("toUVec2",ARe);be("toBVec2",CRe);be("toVec3",Ae);be("toIVec3",PRe);be("toUVec3",RRe);be("toBVec3",NRe);be("toVec4",jt);be("toIVec4",ORe);be("toUVec4",DRe);be("toBVec4",kRe);be("toMat2",P3);be("toMat3",Ds);be("toMat4",Im);const IRe=Ne(E_).setParameterLength(2),LRe=(r,e)=>Le(new zQ(Le(r),e));be("element",IRe);be("convert",LRe);be("append",r=>(console.warn("THREE.TSL: .append() has been renamed to .toStack()."),HQ(r)));class Tn extends Vt{static get type(){return"PropertyNode"}constructor(e,n=null,i=!1){super(e),this.name=n,this.varying=i,this.isPropertyNode=!0}getHash(e){return this.name||super.getHash(e)}isGlobal(){return!0}generate(e){let n;return this.varying===!0?(n=e.getVaryingFromNode(this,this.name),n.needsInterpolation=!0):n=e.getVarFromNode(this,this.name),e.getPropertyName(n)}}const M_=(r,e)=>Le(new Tn(r,e)),hE=(r,e)=>Le(new Tn(r,e,!0)),bn=je(Tn,"vec4","DiffuseColor"),FG=je(Tn,"vec3","EmissiveColor"),Cc=je(Tn,"float","Roughness"),fE=je(Tn,"float","Metalness"),xD=je(Tn,"float","Clearcoat"),dE=je(Tn,"float","ClearcoatRoughness"),hm=je(Tn,"vec3","Sheen"),R3=je(Tn,"float","SheenRoughness"),N3=je(Tn,"float","Iridescence"),qQ=je(Tn,"float","IridescenceIOR"),XQ=je(Tn,"float","IridescenceThickness"),bD=je(Tn,"float","AlphaT"),Af=je(Tn,"float","Anisotropy"),I1=je(Tn,"vec3","AnisotropyT"),Lm=je(Tn,"vec3","AnisotropyB"),bo=je(Tn,"color","SpecularColor"),pE=je(Tn,"float","SpecularF90"),_D=je(Tn,"float","Shininess"),$0=je(Tn,"vec4","Output"),QR=je(Tn,"float","dashSize"),BG=je(Tn,"float","gapSize"),L1=je(Tn,"float","IOR"),wD=je(Tn,"float","Transmission"),KQ=je(Tn,"float","Thickness"),YQ=je(Tn,"float","AttenuationDistance"),ZQ=je(Tn,"color","AttenuationColor"),QQ=je(Tn,"float","Dispersion");class JQ extends Vt{static get type(){return"UniformGroupNode"}constructor(e,n=!1,i=1){super("string"),this.name=e,this.shared=n,this.order=i,this.isUniformGroup=!0}serialize(e){super.serialize(e),e.name=this.name,e.version=this.version,e.shared=this.shared}deserialize(e){super.deserialize(e),this.name=e.name,this.version=e.version,this.shared=e.shared}}const FRe=r=>new JQ(r),O3=(r,e=0)=>new JQ(r,!0,e),BRe=O3("frame"),Lt=O3("render"),eJ=FRe("object");class A_ extends E3{static get type(){return"UniformNode"}constructor(e,n=null){super(e,n),this.isUniformNode=!0,this.name="",this.groupNode=eJ}label(e){return this.name=e,this}setGroup(e){return this.groupNode=e,this}getGroup(){return this.groupNode}getUniformHash(e){return this.getHash(e)}onUpdate(e,n){const i=this.getSelf();return e=e.bind(i),super.onUpdate(s=>{const o=e(s,i);o!==void 0&&(this.value=o)},n)}generate(e,n){const i=this.getNodeType(e),s=this.getUniformHash(e);let o=e.getNodeFromHash(s);o===void 0&&(e.setHashNode(this,s),o=this);const a=o.getInputType(e),l=e.getUniformFromNode(o,a,e.shaderStage,this.name||e.context.label),c=e.getPropertyName(l);return e.context.label!==void 0&&delete e.context.label,e.format(c,i,n)}}const Ft=(r,e)=>{const n=SRe(e||r),i=r&&r.isNode===!0?r.node&&r.node.value||r.value:r;return Le(new A_(i,n))};class UG extends Qr{static get type(){return"ArrayNode"}constructor(e,n,i=null){super(e),this.count=n,this.values=i,this.isArrayNode=!0}getNodeType(e){return this.nodeType===null&&(this.nodeType=this.values[0].getNodeType(e)),this.nodeType}getElementType(e){return this.getNodeType(e)}generate(e){const n=this.getNodeType(e);return e.generateArray(n,this.count,this.values)}}const URe=(...r)=>{let e;if(r.length===1){const n=r[0];e=new UG(null,n.length,n)}else{const n=r[0],i=r[1];e=new UG(n,i)}return Le(e)};be("toArray",(r,e)=>URe(Array(e).fill(r)));class zRe extends Qr{static get type(){return"AssignNode"}constructor(e,n){super(),this.targetNode=e,this.sourceNode=n}hasDependencies(){return!1}getNodeType(e,n){return n!=="void"?this.targetNode.getNodeType(e):"void"}needsSplitAssign(e){const{targetNode:n}=this;if(e.isAvailable("swizzleAssign")===!1&&n.isSplitNode&&n.components.length>1){const i=e.getTypeLength(n.node.getNodeType(e));return Sy.join("").slice(0,i)!==n.components}return!1}generate(e,n){const{targetNode:i,sourceNode:s}=this,o=this.needsSplitAssign(e),a=i.getNodeType(e),l=i.context({assign:!0}).build(e),c=s.build(e,a),u=s.getNodeType(e),h=e.getDataFromNode(this);let f;if(h.initialized===!0)n!=="void"&&(f=l);else if(o){const d=e.getVarFromNode(this,null,a),p=e.getPropertyName(d);e.addLineFlowCode(`${p} = ${c}`,this);const m=i.node.context({assign:!0}).build(e);for(let g=0;g<i.components.length;g++){const v=i.components[g];e.addLineFlowCode(`${m}.${v} = ${p}[ ${g} ]`,this)}n!=="void"&&(f=l)}else f=`${l} = ${c}`,(n==="void"||u==="void")&&(e.addLineFlowCode(f,this),n!=="void"&&(f=l));return h.initialized=!0,e.format(f,a,n)}}const $Re=Ne(zRe).setParameterLength(2);be("assign",$Re);class jRe extends Qr{static get type(){return"FunctionCallNode"}constructor(e=null,n={}){super(),this.functionNode=e,this.parameters=n}setParameters(e){return this.parameters=e,this}getParameters(){return this.parameters}getNodeType(e){return this.functionNode.getNodeType(e)}generate(e){const n=[],i=this.functionNode,s=i.getInputs(e),o=this.parameters,a=(c,u)=>{const h=u.type,f=h==="pointer";let d;return f?d="&"+c.build(e):d=c.build(e,h),d};if(Array.isArray(o)){if(o.length>s.length)console.error("THREE.TSL: The number of provided parameters exceeds the expected number of inputs in 'Fn()'."),o.length=s.length;else if(o.length<s.length)for(console.error("THREE.TSL: The number of provided parameters is less than the expected number of inputs in 'Fn()'.");o.length<s.length;)o.push(Te(0));for(let c=0;c<o.length;c++)n.push(a(o[c],s[c]))}else for(const c of s){const u=o[c.name];u!==void 0?n.push(a(u,c)):(console.error(`THREE.TSL: Input '${c.name}' not found in 'Fn()'.`),n.push(a(Te(0),c)))}return`${i.build(e,"property")}( ${n.join(", ")} )`}}const VRe=(r,...e)=>(e=e.length>1||e[0]&&e[0].isNode===!0?km(e):pA(e[0]),Le(new jRe(Le(r),e)));be("call",VRe);const GRe={"==":"equal","!=":"notEqual","<":"lessThan",">":"greaterThan","<=":"lessThanEqual",">=":"greaterThanEqual","%":"mod"};class lr extends Qr{static get type(){return"OperatorNode"}constructor(e,n,i,...s){if(super(),s.length>0){let o=new lr(e,n,i);for(let a=0;a<s.length-1;a++)o=new lr(e,o,s[a]);n=o,i=s[s.length-1]}this.op=e,this.aNode=n,this.bNode=i,this.isOperatorNode=!0}getOperatorMethod(e,n){return e.getMethod(GRe[this.op],n)}getNodeType(e){const n=this.op,i=this.aNode,s=this.bNode,o=i.getNodeType(e),a=typeof s<"u"?s.getNodeType(e):null;if(o==="void"||a==="void")return"void";if(n==="%")return o;if(n==="~"||n==="&"||n==="|"||n==="^"||n===">>"||n==="<<")return e.getIntegerType(o);if(n==="!"||n==="&&"||n==="||"||n==="^^")return"bool";if(n==="=="||n==="!="||n==="<"||n===">"||n==="<="||n===">="){const l=Math.max(e.getTypeLength(o),e.getTypeLength(a));return l>1?`bvec${l}`:"bool"}else{if(e.isMatrix(o)){if(a==="float")return o;if(e.isVector(a))return e.getVectorFromMatrix(o);if(e.isMatrix(a))return o}else if(e.isMatrix(a)){if(o==="float")return a;if(e.isVector(o))return e.getVectorFromMatrix(a)}return e.getTypeLength(a)>e.getTypeLength(o)?a:o}}generate(e,n){const i=this.op,s=this.aNode,o=this.bNode,a=this.getNodeType(e);let l=null,c=null;a!=="void"?(l=s.getNodeType(e),c=typeof o<"u"?o.getNodeType(e):null,i==="<"||i===">"||i==="<="||i===">="||i==="=="||i==="!="?e.isVector(l)?c=l:e.isVector(c)?l=c:l!==c&&(l=c="float"):i===">>"||i==="<<"?(l=a,c=e.changeComponentType(c,"uint")):i==="%"?(l=a,c=e.isInteger(l)&&e.isInteger(c)?c:l):e.isMatrix(l)?c==="float"?c="float":e.isVector(c)?c=e.getVectorFromMatrix(l):e.isMatrix(c)||(l=c=a):e.isMatrix(c)?l==="float"?l="float":e.isVector(l)?l=e.getVectorFromMatrix(c):l=c=a:l=c=a):l=c=a;const u=s.build(e,l),h=typeof o<"u"?o.build(e,c):null,f=e.getFunctionOperator(i);if(n!=="void"){const d=e.renderer.coordinateSystem===Ps;if(i==="=="||i==="!="||i==="<"||i===">"||i==="<="||i===">=")return d?e.isVector(l)?e.format(`${this.getOperatorMethod(e,n)}( ${u}, ${h} )`,a,n):e.format(`( ${u} ${i} ${h} )`,a,n):e.format(`( ${u} ${i} ${h} )`,a,n);if(i==="%")return e.isInteger(c)?e.format(`( ${u} % ${h} )`,a,n):e.format(`${this.getOperatorMethod(e,a)}( ${u}, ${h} )`,a,n);if(i==="!"||i==="~")return e.format(`(${i}${u})`,l,n);if(f)return e.format(`${f}( ${u}, ${h} )`,a,n);if(e.isMatrix(l)&&c==="float")return e.format(`( ${h} ${i} ${u} )`,a,n);if(l==="float"&&e.isMatrix(c))return e.format(`${u} ${i} ${h}`,a,n);{let p=`( ${u} ${i} ${h} )`;return!d&&a==="bool"&&e.isVector(l)&&e.isVector(c)&&(p=`all${p}`),e.format(p,a,n)}}else if(l!=="void")return f?e.format(`${f}( ${u}, ${h} )`,a,n):e.isMatrix(l)&&c==="float"?e.format(`${h} ${i} ${u}`,a,n):e.format(`${u} ${i} ${h}`,a,n)}serialize(e){super.serialize(e),e.op=this.op}deserialize(e){super.deserialize(e),this.op=e.op}}const ks=Ne(lr,"+").setParameterLength(2,1/0).setName("add"),qs=Ne(lr,"-").setParameterLength(2,1/0).setName("sub"),rn=Ne(lr,"*").setParameterLength(2,1/0).setName("mul"),uu=Ne(lr,"/").setParameterLength(2,1/0).setName("div"),mA=Ne(lr,"%").setParameterLength(2).setName("mod"),tJ=Ne(lr,"==").setParameterLength(2).setName("equal"),HRe=Ne(lr,"!=").setParameterLength(2).setName("notEqual"),WRe=Ne(lr,"<").setParameterLength(2).setName("lessThan"),qRe=Ne(lr,">").setParameterLength(2).setName("greaterThan"),XRe=Ne(lr,"<=").setParameterLength(2).setName("lessThanEqual"),KRe=Ne(lr,">=").setParameterLength(2).setName("greaterThanEqual"),YRe=Ne(lr,"&&").setParameterLength(2,1/0).setName("and"),ZRe=Ne(lr,"||").setParameterLength(2,1/0).setName("or"),QRe=Ne(lr,"!").setParameterLength(1).setName("not"),JRe=Ne(lr,"^^").setParameterLength(2).setName("xor"),eNe=Ne(lr,"&").setParameterLength(2).setName("bitAnd"),tNe=Ne(lr,"~").setParameterLength(2).setName("bitNot"),nNe=Ne(lr,"|").setParameterLength(2).setName("bitOr"),rNe=Ne(lr,"^").setParameterLength(2).setName("bitXor"),iNe=Ne(lr,"<<").setParameterLength(2).setName("shiftLeft"),sNe=Ne(lr,">>").setParameterLength(2).setName("shiftRight"),oNe=Oe(([r])=>(r.addAssign(1),r)),aNe=Oe(([r])=>(r.subAssign(1),r)),lNe=Oe(([r])=>{const e=zn(r).toConst();return r.addAssign(1),e}),cNe=Oe(([r])=>{const e=zn(r).toConst();return r.subAssign(1),e});be("add",ks);be("sub",qs);be("mul",rn);be("div",uu);be("mod",mA);be("equal",tJ);be("notEqual",HRe);be("lessThan",WRe);be("greaterThan",qRe);be("lessThanEqual",XRe);be("greaterThanEqual",KRe);be("and",YRe);be("or",ZRe);be("not",QRe);be("xor",JRe);be("bitAnd",eNe);be("bitNot",tNe);be("bitOr",nNe);be("bitXor",rNe);be("shiftLeft",iNe);be("shiftRight",sNe);be("incrementBefore",oNe);be("decrementBefore",aNe);be("increment",lNe);be("decrement",cNe);const uNe=(r,e)=>(console.warn('THREE.TSL: "remainder()" is deprecated. Use "mod( int( ... ) )" instead.'),mA(r,e)),hNe=(r,e)=>(console.warn('THREE.TSL: "modInt()" is deprecated. Use "mod( int( ... ) )" instead.'),mA(zn(r),zn(e)));be("remainder",uNe);be("modInt",hNe);class fe extends Qr{static get type(){return"MathNode"}constructor(e,n,i=null,s=null){if(super(),(e===fe.MAX||e===fe.MIN)&&arguments.length>3){let o=new fe(e,n,i);for(let a=2;a<arguments.length-1;a++)o=new fe(e,o,arguments[a]);n=o,i=arguments[arguments.length-1],s=null}this.method=e,this.aNode=n,this.bNode=i,this.cNode=s,this.isMathNode=!0}getInputType(e){const n=this.aNode.getNodeType(e),i=this.bNode?this.bNode.getNodeType(e):null,s=this.cNode?this.cNode.getNodeType(e):null,o=e.isMatrix(n)?0:e.getTypeLength(n),a=e.isMatrix(i)?0:e.getTypeLength(i),l=e.isMatrix(s)?0:e.getTypeLength(s);return o>a&&o>l?n:a>l?i:l>o?s:n}getNodeType(e){const n=this.method;return n===fe.LENGTH||n===fe.DISTANCE||n===fe.DOT?"float":n===fe.CROSS?"vec3":n===fe.ALL||n===fe.ANY?"bool":n===fe.EQUALS?e.changeComponentType(this.aNode.getNodeType(e),"bool"):this.getInputType(e)}generate(e,n){let i=this.method;const s=this.getNodeType(e),o=this.getInputType(e),a=this.aNode,l=this.bNode,c=this.cNode,u=e.renderer.coordinateSystem;if(i===fe.TRANSFORM_DIRECTION){let h=a,f=l;e.isMatrix(h.getNodeType(e))?f=jt(Ae(f),0):h=jt(Ae(h),0);const d=rn(h,f).xyz;return ab(d).build(e,n)}else{if(i===fe.NEGATE)return e.format("( - "+a.build(e,o)+" )",s,n);if(i===fe.ONE_MINUS)return qs(1,a).build(e,n);if(i===fe.RECIPROCAL)return uu(1,a).build(e,n);if(i===fe.DIFFERENCE)return Jo(qs(a,l)).build(e,n);{const h=[];return i===fe.CROSS?h.push(a.build(e,s),l.build(e,s)):u===Ps&&i===fe.STEP?h.push(a.build(e,e.getTypeLength(a.getNodeType(e))===1?"float":o),l.build(e,o)):u===Ps&&(i===fe.MIN||i===fe.MAX)?h.push(a.build(e,o),l.build(e,e.getTypeLength(l.getNodeType(e))===1?"float":o)):i===fe.REFRACT?h.push(a.build(e,o),l.build(e,o),c.build(e,"float")):i===fe.MIX?h.push(a.build(e,o),l.build(e,o),c.build(e,e.getTypeLength(c.getNodeType(e))===1?"float":o)):(u===Ph&&i===fe.ATAN&&l!==null&&(i="atan2"),e.shaderStage!=="fragment"&&(i===fe.DFDX||i===fe.DFDY)&&(console.warn(`THREE.TSL: '${i}' is not supported in the ${e.shaderStage} stage.`),i="/*"+i+"*/"),h.push(a.build(e,o)),l!==null&&h.push(l.build(e,o)),c!==null&&h.push(c.build(e,o))),e.format(`${e.getMethod(i,s)}( ${h.join(", ")} )`,s,n)}}}serialize(e){super.serialize(e),e.method=this.method}deserialize(e){super.deserialize(e),this.method=e.method}}fe.ALL="all";fe.ANY="any";fe.RADIANS="radians";fe.DEGREES="degrees";fe.EXP="exp";fe.EXP2="exp2";fe.LOG="log";fe.LOG2="log2";fe.SQRT="sqrt";fe.INVERSE_SQRT="inversesqrt";fe.FLOOR="floor";fe.CEIL="ceil";fe.NORMALIZE="normalize";fe.FRACT="fract";fe.SIN="sin";fe.COS="cos";fe.TAN="tan";fe.ASIN="asin";fe.ACOS="acos";fe.ATAN="atan";fe.ABS="abs";fe.SIGN="sign";fe.LENGTH="length";fe.NEGATE="negate";fe.ONE_MINUS="oneMinus";fe.DFDX="dFdx";fe.DFDY="dFdy";fe.ROUND="round";fe.RECIPROCAL="reciprocal";fe.TRUNC="trunc";fe.FWIDTH="fwidth";fe.TRANSPOSE="transpose";fe.BITCAST="bitcast";fe.EQUALS="equals";fe.MIN="min";fe.MAX="max";fe.STEP="step";fe.REFLECT="reflect";fe.DISTANCE="distance";fe.DIFFERENCE="difference";fe.DOT="dot";fe.CROSS="cross";fe.POW="pow";fe.TRANSFORM_DIRECTION="transformDirection";fe.MIX="mix";fe.CLAMP="clamp";fe.REFRACT="refract";fe.SMOOTHSTEP="smoothstep";fe.FACEFORWARD="faceforward";const fNe=Te(1e-6),dNe=Te(Math.PI),pNe=Ne(fe,fe.ALL).setParameterLength(1),mNe=Ne(fe,fe.ANY).setParameterLength(1),gNe=Ne(fe,fe.RADIANS).setParameterLength(1),yNe=Ne(fe,fe.DEGREES).setParameterLength(1),nJ=Ne(fe,fe.EXP).setParameterLength(1),ob=Ne(fe,fe.EXP2).setParameterLength(1),rJ=Ne(fe,fe.LOG).setParameterLength(1),Xc=Ne(fe,fe.LOG2).setParameterLength(1),D3=Ne(fe,fe.SQRT).setParameterLength(1),vNe=Ne(fe,fe.INVERSE_SQRT).setParameterLength(1),id=Ne(fe,fe.FLOOR).setParameterLength(1),k3=Ne(fe,fe.CEIL).setParameterLength(1),ab=Ne(fe,fe.NORMALIZE).setParameterLength(1),Xh=Ne(fe,fe.FRACT).setParameterLength(1),ja=Ne(fe,fe.SIN).setParameterLength(1),Ku=Ne(fe,fe.COS).setParameterLength(1),xNe=Ne(fe,fe.TAN).setParameterLength(1),bNe=Ne(fe,fe.ASIN).setParameterLength(1),_Ne=Ne(fe,fe.ACOS).setParameterLength(1),iJ=Ne(fe,fe.ATAN).setParameterLength(1,2),Jo=Ne(fe,fe.ABS).setParameterLength(1),mE=Ne(fe,fe.SIGN).setParameterLength(1),wh=Ne(fe,fe.LENGTH).setParameterLength(1),wNe=Ne(fe,fe.NEGATE).setParameterLength(1),SNe=Ne(fe,fe.ONE_MINUS).setParameterLength(1),sJ=Ne(fe,fe.DFDX).setParameterLength(1),oJ=Ne(fe,fe.DFDY).setParameterLength(1),TNe=Ne(fe,fe.ROUND).setParameterLength(1),ENe=Ne(fe,fe.RECIPROCAL).setParameterLength(1),MNe=Ne(fe,fe.TRUNC).setParameterLength(1),ANe=Ne(fe,fe.FWIDTH).setParameterLength(1),CNe=Ne(fe,fe.TRANSPOSE).setParameterLength(1),PNe=(r,e)=>(console.warn('THREE.TSL: "equals" is deprecated. Use "equal" inside a vector instead, like: "bvec*( equal( ... ) )"'),tJ(r,e)),lb=Ne(fe,fe.MIN).setParameterLength(2,1/0),ao=Ne(fe,fe.MAX).setParameterLength(2,1/0),aJ=Ne(fe,fe.STEP).setParameterLength(2),RNe=Ne(fe,fe.REFLECT).setParameterLength(2),NNe=Ne(fe,fe.DISTANCE).setParameterLength(2),ONe=Ne(fe,fe.DIFFERENCE).setParameterLength(2),I3=Ne(fe,fe.DOT).setParameterLength(2),lJ=Ne(fe,fe.CROSS).setParameterLength(2),gA=Ne(fe,fe.POW).setParameterLength(2),cJ=Ne(fe,fe.POW,2).setParameterLength(1),DNe=Ne(fe,fe.POW,3).setParameterLength(1),kNe=Ne(fe,fe.POW,4).setParameterLength(1),INe=Ne(fe,fe.TRANSFORM_DIRECTION).setParameterLength(2),LNe=r=>rn(mE(r),gA(Jo(r),1/3)),uJ=r=>I3(r,r),Yn=Ne(fe,fe.MIX).setParameterLength(3),hu=(r,e=0,n=1)=>Le(new fe(fe.CLAMP,Le(r),Le(e),Le(n))),FNe=r=>hu(r),hJ=Ne(fe,fe.REFRACT).setParameterLength(3),Oh=Ne(fe,fe.SMOOTHSTEP).setParameterLength(3),BNe=Ne(fe,fe.FACEFORWARD).setParameterLength(3),UNe=Oe(([r])=>{const i=43758.5453,s=I3(r.xy,Ve(12.9898,78.233)),o=mA(s,dNe);return Xh(ja(o).mul(i))}),zNe=(r,e,n)=>Yn(e,n,r),$Ne=(r,e,n)=>Oh(e,n,r),jNe=(r,e)=>(console.warn('THREE.TSL: "atan2" is overloaded. Use "atan" instead.'),iJ(r,e));be("all",pNe);be("any",mNe);be("equals",PNe);be("radians",gNe);be("degrees",yNe);be("exp",nJ);be("exp2",ob);be("log",rJ);be("log2",Xc);be("sqrt",D3);be("inverseSqrt",vNe);be("floor",id);be("ceil",k3);be("normalize",ab);be("fract",Xh);be("sin",ja);be("cos",Ku);be("tan",xNe);be("asin",bNe);be("acos",_Ne);be("atan",iJ);be("abs",Jo);be("sign",mE);be("length",wh);be("lengthSq",uJ);be("negate",wNe);be("oneMinus",SNe);be("dFdx",sJ);be("dFdy",oJ);be("round",TNe);be("reciprocal",ENe);be("trunc",MNe);be("fwidth",ANe);be("atan2",jNe);be("min",lb);be("max",ao);be("step",aJ);be("reflect",RNe);be("distance",NNe);be("dot",I3);be("cross",lJ);be("pow",gA);be("pow2",cJ);be("pow3",DNe);be("pow4",kNe);be("transformDirection",INe);be("mix",zNe);be("clamp",hu);be("refract",hJ);be("smoothstep",$Ne);be("faceForward",BNe);be("difference",ONe);be("saturate",FNe);be("cbrt",LNe);be("transpose",CNe);be("rand",UNe);class VNe extends Vt{static get type(){return"ConditionalNode"}constructor(e,n,i=null){super(),this.condNode=e,this.ifNode=n,this.elseNode=i}getNodeType(e){const{ifNode:n,elseNode:i}=e.getNodeProperties(this);if(n===void 0)return this.setup(e),this.getNodeType(e);const s=n.getNodeType(e);if(i!==null){const o=i.getNodeType(e);if(e.getTypeLength(o)>e.getTypeLength(s))return o}return s}setup(e){const n=this.condNode.cache(),i=this.ifNode.cache(),s=this.elseNode?this.elseNode.cache():null,o=e.context.nodeBlock;e.getDataFromNode(i).parentNodeBlock=o,s!==null&&(e.getDataFromNode(s).parentNodeBlock=o);const a=e.getNodeProperties(this);a.condNode=n,a.ifNode=i.context({nodeBlock:i}),a.elseNode=s?s.context({nodeBlock:s}):null}generate(e,n){const i=this.getNodeType(e),s=e.getDataFromNode(this);if(s.nodeProperty!==void 0)return s.nodeProperty;const{condNode:o,ifNode:a,elseNode:l}=e.getNodeProperties(this),c=e.currentFunctionNode,u=n!=="void",h=u?M_(i).build(e):"";s.nodeProperty=h;const f=o.build(e,"bool");e.addFlowCode(`
${e.tab}if ( ${f} ) {

`).addFlowTab();let d=a.build(e,i);if(d&&(u?d=h+" = "+d+";":(d="return "+d+";",c===null&&(console.warn("THREE.TSL: Return statement used in an inline 'Fn()'. Define a layout struct to allow return values."),d="// "+d))),e.removeFlowTab().addFlowCode(e.tab+"	"+d+`

`+e.tab+"}"),l!==null){e.addFlowCode(` else {

`).addFlowTab();let p=l.build(e,i);p&&(u?p=h+" = "+p+";":(p="return "+p+";",c===null&&(console.warn("THREE.TSL: Return statement used in an inline 'Fn()'. Define a layout struct to allow return values."),p="// "+p))),e.removeFlowTab().addFlowCode(e.tab+"	"+p+`

`+e.tab+`}

`)}else e.addFlowCode(`

`);return e.format(h,i,n)}}const Ns=Ne(VNe).setParameterLength(2,3);be("select",Ns);const GNe=(...r)=>(console.warn("THREE.TSL: cond() has been renamed to select()."),Ns(...r));be("cond",GNe);class fJ extends Vt{static get type(){return"ContextNode"}constructor(e,n={}){super(),this.isContextNode=!0,this.node=e,this.value=n}getScope(){return this.node.getScope()}getNodeType(e){return this.node.getNodeType(e)}analyze(e){this.node.build(e)}setup(e){const n=e.getContext();e.setContext({...e.context,...this.value});const i=this.node.build(e);return e.setContext(n),i}generate(e,n){const i=e.getContext();e.setContext({...e.context,...this.value});const s=this.node.build(e,n);return e.setContext(i),s}}const L3=Ne(fJ).setParameterLength(1,2),HNe=(r,e)=>L3(r,{label:e});be("context",L3);be("label",HNe);class F1 extends Vt{static get type(){return"VarNode"}constructor(e,n=null,i=!1){super(),this.node=e,this.name=n,this.global=!0,this.isVarNode=!0,this.readOnly=i}getMemberType(e,n){return this.node.getMemberType(e,n)}getElementType(e){return this.node.getElementType(e)}getNodeType(e){return this.node.getNodeType(e)}generate(e){const{node:n,name:i,readOnly:s}=this,{renderer:o}=e,a=o.backend.isWebGPUBackend===!0;let l=!1,c=!1;s&&(l=e.isDeterministic(n),c=a?s:l);const u=e.getVectorType(this.getNodeType(e)),h=n.build(e,u),f=e.getVarFromNode(this,i,u,void 0,c),d=e.getPropertyName(f);let p=d;if(c)if(a)p=l?`const ${d}`:`let ${d}`;else{const m=e.getArrayCount(n);p=`const ${e.getVar(f.type,d,m)}`}return e.addLineFlowCode(`${p} = ${h}`,this),d}}const F3=Ne(F1),WNe=(r,e=null)=>F3(r,e).toStack(),qNe=(r,e=null)=>F3(r,e,!0).toStack();be("toVar",WNe);be("toConst",qNe);const XNe=r=>(console.warn('TSL: "temp( node )" is deprecated. Use "Var( node )" or "node.toVar()" instead.'),F3(r));be("temp",XNe);class KNe extends Vt{static get type(){return"VaryingNode"}constructor(e,n=null){super(),this.node=e,this.name=n,this.isVaryingNode=!0,this.interpolationType=null,this.interpolationSampling=null}isGlobal(){return!0}setInterpolation(e,n=null){return this.interpolationType=e,this.interpolationSampling=n,this}getHash(e){return this.name||super.getHash(e)}getNodeType(e){return this.node.getNodeType(e)}setupVarying(e){const n=e.getNodeProperties(this);let i=n.varying;if(i===void 0){const s=this.name,o=this.getNodeType(e),a=this.interpolationType,l=this.interpolationSampling;n.varying=i=e.getVaryingFromNode(this,s,o,a,l),n.node=this.node}return i.needsInterpolation||(i.needsInterpolation=e.shaderStage==="fragment"),i}setup(e){this.setupVarying(e)}analyze(e){return this.setupVarying(e),this.node.analyze(e)}generate(e){const n=e.getNodeProperties(this),i=this.setupVarying(e),s=e.shaderStage==="fragment"&&n.reassignPosition===!0&&e.context.needsPositionReassign;if(n.propertyName===void 0||s){const o=this.getNodeType(e),a=e.getPropertyName(i,CG.VERTEX);e.flowNodeFromShaderStage(CG.VERTEX,this.node,o,a),n.propertyName=a,s?n.reassignPosition=!1:n.reassignPosition===void 0&&e.context.isPositionNodeInput&&(n.reassignPosition=!0)}return e.getPropertyName(i)}}const ol=Ne(KNe).setParameterLength(1,2),YNe=r=>ol(r);be("toVarying",ol);be("toVertexStage",YNe);be("varying",(...r)=>(console.warn("THREE.TSL: .varying() has been renamed to .toVarying()."),ol(...r)));be("vertexStage",(...r)=>(console.warn("THREE.TSL: .vertexStage() has been renamed to .toVertexStage()."),ol(...r)));const ZNe=Oe(([r])=>{const e=r.mul(.9478672986).add(.0521327014).pow(2.4),n=r.mul(.0773993808),i=r.lessThanEqual(.04045);return Yn(e,n,i)}).setLayout({name:"sRGBTransferEOTF",type:"vec3",inputs:[{name:"color",type:"vec3"}]}),QNe=Oe(([r])=>{const e=r.pow(.41666).mul(1.055).sub(.055),n=r.mul(12.92),i=r.lessThanEqual(.0031308);return Yn(e,n,i)}).setLayout({name:"sRGBTransferOETF",type:"vec3",inputs:[{name:"color",type:"vec3"}]}),C_="WorkingColorSpace",B3="OutputColorSpace";class yA extends Qr{static get type(){return"ColorSpaceNode"}constructor(e,n,i){super("vec4"),this.colorNode=e,this.source=n,this.target=i}resolveColorSpace(e,n){return n===C_?Qt.workingColorSpace:n===B3?e.context.outputColorSpace||e.renderer.outputColorSpace:n}setup(e){const{colorNode:n}=this,i=this.resolveColorSpace(e,this.source),s=this.resolveColorSpace(e,this.target);let o=n;return Qt.enabled===!1||i===s||!i||!s||(Qt.getTransfer(i)===wn&&(o=jt(ZNe(o.rgb),o.a)),Qt.getPrimaries(i)!==Qt.getPrimaries(s)&&(o=jt(Ds(Qt._getMatrix(new Bt,i,s)).mul(o.rgb),o.a)),Qt.getTransfer(s)===wn&&(o=jt(QNe(o.rgb),o.a))),o}}const JNe=r=>Le(new yA(Le(r),C_,B3)),e2e=r=>Le(new yA(Le(r),B3,C_)),t2e=(r,e)=>Le(new yA(Le(r),C_,e)),U3=(r,e)=>Le(new yA(Le(r),e,C_));be("toOutputColorSpace",JNe);be("toWorkingColorSpace",e2e);be("workingToColorSpace",t2e);be("colorSpaceToWorking",U3);let n2e=class extends E_{static get type(){return"ReferenceElementNode"}constructor(e,n){super(e,n),this.referenceNode=e,this.isReferenceElementNode=!0}getNodeType(){return this.referenceNode.uniformType}generate(e){const n=super.generate(e),i=this.referenceNode.getNodeType(),s=this.getNodeType();return e.format(n,i,s)}};class dJ extends Vt{static get type(){return"ReferenceBaseNode"}constructor(e,n,i=null,s=null){super(),this.property=e,this.uniformType=n,this.object=i,this.count=s,this.properties=e.split("."),this.reference=i,this.node=null,this.group=null,this.updateType=Jt.OBJECT}setGroup(e){return this.group=e,this}element(e){return Le(new n2e(this,Le(e)))}setNodeType(e){const n=Ft(null,e).getSelf();this.group!==null&&n.setGroup(this.group),this.node=n}getNodeType(e){return this.node===null&&(this.updateReference(e),this.updateValue()),this.node.getNodeType(e)}getValueFromReference(e=this.reference){const{properties:n}=this;let i=e[n[0]];for(let s=1;s<n.length;s++)i=i[n[s]];return i}updateReference(e){return this.reference=this.object!==null?this.object:e.object,this.reference}setup(){return this.updateValue(),this.node}update(){this.updateValue()}updateValue(){this.node===null&&this.setNodeType(this.uniformType);const e=this.getValueFromReference();Array.isArray(e)?this.node.array=e:this.node.value=e}}const r2e=(r,e,n)=>Le(new dJ(r,e,n));class i2e extends dJ{static get type(){return"RendererReferenceNode"}constructor(e,n,i=null){super(e,n,i),this.renderer=i,this.setGroup(Lt)}updateReference(e){return this.reference=this.renderer!==null?this.renderer:e.renderer,this.reference}}const s2e=(r,e,n=null)=>Le(new i2e(r,e,n));class o2e extends Qr{static get type(){return"ToneMappingNode"}constructor(e,n=l2e,i=null){super("vec3"),this.toneMapping=e,this.exposureNode=n,this.colorNode=i}customCacheKey(){return sb(this.toneMapping)}setup(e){const n=this.colorNode||e.context.color,i=this.toneMapping;if(i===io)return n;let s=null;const o=e.renderer.library.getToneMappingFunction(i);return o!==null?s=jt(o(n.rgb,this.exposureNode),n.a):(console.error("ToneMappingNode: Unsupported Tone Mapping configuration.",i),s=n),s}}const a2e=(r,e,n)=>Le(new o2e(r,Le(e),Le(n))),l2e=s2e("toneMappingExposure","float");be("toneMapping",(r,e,n)=>a2e(e,n,r));class c2e extends E3{static get type(){return"BufferAttributeNode"}constructor(e,n=null,i=0,s=0){super(e,n),this.isBufferNode=!0,this.bufferType=n,this.bufferStride=i,this.bufferOffset=s,this.usage=zT,this.instanced=!1,this.attribute=null,this.global=!0,e&&e.isBufferAttribute===!0&&(this.attribute=e,this.usage=e.usage,this.instanced=e.isInstancedBufferAttribute)}getHash(e){if(this.bufferStride===0&&this.bufferOffset===0){let n=e.globalCache.getData(this.value);return n===void 0&&(n={node:this},e.globalCache.setData(this.value,n)),n.node.uuid}return this.uuid}getNodeType(e){return this.bufferType===null&&(this.bufferType=e.getTypeFromAttribute(this.attribute)),this.bufferType}setup(e){if(this.attribute!==null)return;const n=this.getNodeType(e),i=this.value,s=e.getTypeLength(n),o=this.bufferStride||s,a=this.bufferOffset,l=i.isInterleavedBuffer===!0?i:new PY(i,o),c=new IF(l,s,a);l.setUsage(this.usage),this.attribute=c,this.attribute.isInstancedBufferAttribute=this.instanced}generate(e){const n=this.getNodeType(e),i=e.getBufferAttributeFromNode(this,n),s=e.getPropertyName(i);let o=null;return e.shaderStage==="vertex"||e.shaderStage==="compute"?(this.name=s,o=s):o=ol(this).build(e,n),o}getInputType(){return"bufferAttribute"}setUsage(e){return this.usage=e,this.attribute&&this.attribute.isBufferAttribute===!0&&(this.attribute.usage=e),this}setInstanced(e){return this.instanced=e,this}}const z3=(r,e=null,n=0,i=0)=>Le(new c2e(r,e,n,i)),u2e=(r,e=null,n=0,i=0)=>z3(r,e,n,i).setUsage(om),zG=(r,e=null,n=0,i=0)=>z3(r,e,n,i).setInstanced(!0),$G=(r,e=null,n=0,i=0)=>u2e(r,e,n,i).setInstanced(!0);be("toAttribute",r=>z3(r.value));class h2e extends Vt{static get type(){return"ComputeNode"}constructor(e,n,i=[64]){super("void"),this.isComputeNode=!0,this.computeNode=e,this.count=n,this.workgroupSize=i,this.dispatchCount=0,this.version=1,this.name="",this.updateBeforeType=Jt.OBJECT,this.onInitFunction=null,this.updateDispatchCount()}dispose(){this.dispatchEvent({type:"dispose"})}label(e){return this.name=e,this}updateDispatchCount(){const{count:e,workgroupSize:n}=this;let i=n[0];for(let s=1;s<n.length;s++)i*=n[s];this.dispatchCount=Math.ceil(e/i)}onInit(e){return this.onInitFunction=e,this}updateBefore({renderer:e}){e.compute(this)}setup(e){const n=this.computeNode.build(e);if(n){const i=e.getNodeProperties(this);i.outputComputeNode=n.outputNode,n.outputNode=null}return n}generate(e,n){const{shaderStage:i}=e;if(i==="compute"){const s=this.computeNode.build(e,"void");s!==""&&e.addLineFlowCode(s,this)}else{const o=e.getNodeProperties(this).outputComputeNode;if(o)return o.build(e,n)}}}const f2e=(r,e,n)=>Le(new h2e(Le(r),e,n));be("compute",f2e);class d2e extends Vt{static get type(){return"CacheNode"}constructor(e,n=!0){super(),this.node=e,this.parent=n,this.isCacheNode=!0}getNodeType(e){const n=e.getCache(),i=e.getCacheFromNode(this,this.parent);e.setCache(i);const s=this.node.getNodeType(e);return e.setCache(n),s}build(e,...n){const i=e.getCache(),s=e.getCacheFromNode(this,this.parent);e.setCache(s);const o=this.node.build(e,...n);return e.setCache(i),o}}const B1=(r,e)=>Le(new d2e(Le(r),e));be("cache",B1);class p2e extends Vt{static get type(){return"BypassNode"}constructor(e,n){super(),this.isBypassNode=!0,this.outputNode=e,this.callNode=n}getNodeType(e){return this.outputNode.getNodeType(e)}generate(e){const n=this.callNode.build(e,"void");return n!==""&&e.addLineFlowCode(n,this),this.outputNode.build(e)}}const m2e=Ne(p2e).setParameterLength(2);be("bypass",m2e);class pJ extends Vt{static get type(){return"RemapNode"}constructor(e,n,i,s=Te(0),o=Te(1)){super(),this.node=e,this.inLowNode=n,this.inHighNode=i,this.outLowNode=s,this.outHighNode=o,this.doClamp=!0}setup(){const{node:e,inLowNode:n,inHighNode:i,outLowNode:s,outHighNode:o,doClamp:a}=this;let l=e.sub(n).div(i.sub(n));return a===!0&&(l=l.clamp()),l.mul(o.sub(s)).add(s)}}const g2e=Ne(pJ,null,null,{doClamp:!1}).setParameterLength(3,5),y2e=Ne(pJ).setParameterLength(3,5);be("remap",g2e);be("remapClamp",y2e);class U1 extends Vt{static get type(){return"ExpressionNode"}constructor(e="",n="void"){super(n),this.snippet=e}generate(e,n){const i=this.getNodeType(e),s=this.snippet;if(i==="void")e.addLineFlowCode(s,this);else return e.format(s,i,n)}}const Eg=Ne(U1).setParameterLength(1,2),v2e=r=>(r?Ns(r,Eg("discard")):Eg("discard")).toStack();be("discard",v2e);class x2e extends Qr{static get type(){return"RenderOutputNode"}constructor(e,n,i){super("vec4"),this.colorNode=e,this.toneMapping=n,this.outputColorSpace=i,this.isRenderOutputNode=!0}setup({context:e}){let n=this.colorNode||e.color;const i=(this.toneMapping!==null?this.toneMapping:e.toneMapping)||io,s=(this.outputColorSpace!==null?this.outputColorSpace:e.outputColorSpace)||Eo;return i!==io&&(n=n.toneMapping(i)),s!==Eo&&s!==Qt.workingColorSpace&&(n=n.workingToColorSpace(s)),n}}const b2e=(r,e=null,n=null)=>Le(new x2e(Le(r),e,n));be("renderOutput",b2e);class _2e extends Qr{static get type(){return"DebugNode"}constructor(e,n=null){super(),this.node=e,this.callback=n}getNodeType(e){return this.node.getNodeType(e)}setup(e){return this.node.build(e)}analyze(e){return this.node.build(e)}generate(e){const n=this.callback,i=this.node.build(e),s="--- TSL debug - "+e.shaderStage+" shader ---",o="-".repeat(s.length);let a="";return a+="// #"+s+`#
`,a+=e.flow.code.replace(/^\t/mg,"")+`
`,a+="/* ... */ "+i+` /* ... */
`,a+="// #"+o+`#
`,n!==null?n(e,a):console.log(a),i}}const w2e=(r,e=null)=>Le(new _2e(Le(r),e));be("debug",w2e);class mJ extends Vt{static get type(){return"AttributeNode"}constructor(e,n=null){super(n),this.global=!0,this._attributeName=e}getHash(e){return this.getAttributeName(e)}getNodeType(e){let n=this.nodeType;if(n===null){const i=this.getAttributeName(e);if(e.hasGeometryAttribute(i)){const s=e.geometry.getAttribute(i);n=e.getTypeFromAttribute(s)}else n="float"}return n}setAttributeName(e){return this._attributeName=e,this}getAttributeName(){return this._attributeName}generate(e){const n=this.getAttributeName(e),i=this.getNodeType(e);if(e.hasGeometryAttribute(n)===!0){const o=e.geometry.getAttribute(n),a=e.getTypeFromAttribute(o),l=e.getAttribute(n,a);return e.shaderStage==="vertex"?e.format(l.name,a,i):ol(this).build(e,i)}else return console.warn(`AttributeNode: Vertex attribute "${n}" not found on geometry.`),e.generateConst(i)}serialize(e){super.serialize(e),e.global=this.global,e._attributeName=this._attributeName}deserialize(e){super.deserialize(e),this.global=e.global,this._attributeName=e._attributeName}}const Dh=(r,e=null)=>Le(new mJ(r,e)),P_=(r=0)=>Dh("uv"+(r>0?r:""),"vec2");class S2e extends Vt{static get type(){return"TextureSizeNode"}constructor(e,n=null){super("uvec2"),this.isTextureSizeNode=!0,this.textureNode=e,this.levelNode=n}generate(e,n){const i=this.textureNode.build(e,"property"),s=this.levelNode===null?"0":this.levelNode.build(e,"int");return e.format(`${e.getMethod("textureDimensions")}( ${i}, ${s} )`,this.getNodeType(e),n)}}const Fm=Ne(S2e).setParameterLength(1,2);class T2e extends A_{static get type(){return"MaxMipLevelNode"}constructor(e){super(0),this._textureNode=e,this.updateType=Jt.FRAME}get textureNode(){return this._textureNode}get texture(){return this._textureNode.value}update(){const e=this.texture,n=e.images,i=n&&n.length>0?n[0]&&n[0].image||n[0]:e.image;if(i&&i.width!==void 0){const{width:s,height:o}=i;this.value=Math.log2(Math.max(s,o))}}}const E2e=Ne(T2e).setParameterLength(1);class Ty extends A_{static get type(){return"TextureNode"}constructor(e,n=null,i=null,s=null){super(e),this.isTextureNode=!0,this.uvNode=n,this.levelNode=i,this.biasNode=s,this.compareNode=null,this.depthNode=null,this.gradNode=null,this.sampler=!0,this.updateMatrix=!1,this.updateType=Jt.NONE,this.referenceNode=null,this._value=e,this._matrixUniform=null,this.setUpdateMatrix(n===null)}set value(e){this.referenceNode?this.referenceNode.value=e:this._value=e}get value(){return this.referenceNode?this.referenceNode.value:this._value}getUniformHash(){return this.value.uuid}getNodeType(){return this.value.isDepthTexture===!0?"float":this.value.type===In?"uvec4":this.value.type===Si?"ivec4":"vec4"}getInputType(){return"texture"}getDefaultUV(){return P_(this.value.channel)}updateReference(){return this.value}getTransformedUV(e){return this._matrixUniform===null&&(this._matrixUniform=Ft(this.value.matrix)),this._matrixUniform.mul(Ae(e,1)).xy}setUpdateMatrix(e){return this.updateMatrix=e,this.updateType=e?Jt.OBJECT:Jt.NONE,this}setupUV(e,n){const i=this.value;return e.isFlipY()&&(i.image instanceof ImageBitmap&&i.flipY===!0||i.isRenderTargetTexture===!0||i.isFramebufferTexture===!0||i.isDepthTexture===!0)&&(this.sampler?n=n.flipY():n=n.setY(zn(Fm(this,this.levelNode).y).sub(n.y).sub(1))),n}setup(e){const n=e.getNodeProperties(this);n.referenceNode=this.referenceNode;const i=this.value;if(!i||i.isTexture!==!0)throw new Error("THREE.TSL: `texture( value )` function expects a valid instance of THREE.Texture().");let s=this.uvNode;(s===null||e.context.forceUVContext===!0)&&e.context.getUV&&(s=e.context.getUV(this,e)),s||(s=this.getDefaultUV()),this.updateMatrix===!0&&(s=this.getTransformedUV(s)),s=this.setupUV(e,s);let o=this.levelNode;o===null&&e.context.getTextureLevel&&(o=e.context.getTextureLevel(this)),n.uvNode=s,n.levelNode=o,n.biasNode=this.biasNode,n.compareNode=this.compareNode,n.gradNode=this.gradNode,n.depthNode=this.depthNode}generateUV(e,n){return n.build(e,this.sampler===!0?"vec2":"ivec2")}generateSnippet(e,n,i,s,o,a,l,c){const u=this.value;let h;return s?h=e.generateTextureLevel(u,n,i,s,a):o?h=e.generateTextureBias(u,n,i,o,a):c?h=e.generateTextureGrad(u,n,i,c,a):l?h=e.generateTextureCompare(u,n,i,l,a):this.sampler===!1?h=e.generateTextureLoad(u,n,i,a):h=e.generateTexture(u,n,i,a),h}generate(e,n){const i=this.value,s=e.getNodeProperties(this),o=super.generate(e,"property");if(/^sampler/.test(n))return o+"_sampler";if(e.isReference(n))return o;{const a=e.getDataFromNode(this);let l=a.propertyName;if(l===void 0){const{uvNode:h,levelNode:f,biasNode:d,compareNode:p,depthNode:m,gradNode:g}=s,v=this.generateUV(e,h),y=f?f.build(e,"float"):null,x=d?d.build(e,"float"):null,b=m?m.build(e,"int"):null,w=p?p.build(e,"float"):null,_=g?[g[0].build(e,"vec2"),g[1].build(e,"vec2")]:null,S=e.getVarFromNode(this);l=e.getPropertyName(S);const T=this.generateSnippet(e,o,v,y,x,b,w,_);e.addLineFlowCode(`${l} = ${T}`,this),a.snippet=T,a.propertyName=l}let c=l;const u=this.getNodeType(e);return e.needsToWorkingColorSpace(i)&&(c=U3(Eg(c,u),i.colorSpace).setup(e).build(e,u)),e.format(c,u,n)}}setSampler(e){return this.sampler=e,this}getSampler(){return this.sampler}uv(e){return console.warn("THREE.TextureNode: .uv() has been renamed. Use .sample() instead."),this.sample(e)}sample(e){const n=this.clone();return n.uvNode=Le(e),n.referenceNode=this.getSelf(),Le(n)}blur(e){const n=this.clone();n.biasNode=Le(e).mul(E2e(n)),n.referenceNode=this.getSelf();const i=n.value;return n.generateMipmaps===!1&&(i&&i.generateMipmaps===!1||i.minFilter===jn||i.magFilter===jn)&&(console.warn("THREE.TSL: texture().blur() requires mipmaps and sampling. Use .generateMipmaps=true and .minFilter/.magFilter=THREE.LinearFilter in the Texture."),n.biasNode=null),Le(n)}level(e){const n=this.clone();return n.levelNode=Le(e),n.referenceNode=this.getSelf(),Le(n)}size(e){return Fm(this,e)}bias(e){const n=this.clone();return n.biasNode=Le(e),n.referenceNode=this.getSelf(),Le(n)}compare(e){const n=this.clone();return n.compareNode=Le(e),n.referenceNode=this.getSelf(),Le(n)}grad(e,n){const i=this.clone();return i.gradNode=[Le(e),Le(n)],i.referenceNode=this.getSelf(),Le(i)}depth(e){const n=this.clone();return n.depthNode=Le(e),n.referenceNode=this.getSelf(),Le(n)}serialize(e){super.serialize(e),e.value=this.value.toJSON(e.meta).uuid,e.sampler=this.sampler,e.updateMatrix=this.updateMatrix,e.updateType=this.updateType}deserialize(e){super.deserialize(e),this.value=e.meta.textures[e.value],this.sampler=e.sampler,this.updateMatrix=e.updateMatrix,this.updateType=e.updateType}update(){const e=this.value,n=this._matrixUniform;n!==null&&(n.value=e.matrix),e.matrixAutoUpdate===!0&&e.updateMatrix()}clone(){const e=new this.constructor(this.value,this.uvNode,this.levelNode,this.biasNode);return e.sampler=this.sampler,e.depthNode=this.depthNode,e.compareNode=this.compareNode,e.gradNode=this.gradNode,e}}const cn=Ne(Ty).setParameterLength(1,4),Oa=(...r)=>cn(...r).setSampler(!1);class gJ extends A_{static get type(){return"BufferNode"}constructor(e,n,i=0){super(e,n),this.isBufferNode=!0,this.bufferType=n,this.bufferCount=i}getElementType(e){return this.getNodeType(e)}getInputType(){return"buffer"}}const yJ=(r,e,n)=>Le(new gJ(r,e,n));class M2e extends E_{static get type(){return"UniformArrayElementNode"}constructor(e,n){super(e,n),this.isArrayBufferElementNode=!0}generate(e){const n=super.generate(e),i=this.getNodeType(),s=this.node.getPaddedType();return e.format(n,s,i)}}class A2e extends gJ{static get type(){return"UniformArrayNode"}constructor(e,n=null){super(null),this.array=e,this.elementType=n===null?cE(e[0]):n,this.paddedType=this.getPaddedType(),this.updateType=Jt.RENDER,this.isArrayBufferNode=!0}getNodeType(){return this.paddedType}getElementType(){return this.elementType}getPaddedType(){const e=this.elementType;let n="vec4";return e==="mat2"?n="mat2":/mat/.test(e)===!0?n="mat4":e.charAt(0)==="i"?n="ivec4":e.charAt(0)==="u"&&(n="uvec4"),n}update(){const{array:e,value:n}=this,i=this.elementType;if(i==="float"||i==="int"||i==="uint")for(let s=0;s<e.length;s++){const o=s*4;n[o]=e[s]}else if(i==="color")for(let s=0;s<e.length;s++){const o=s*4,a=e[s];n[o]=a.r,n[o+1]=a.g,n[o+2]=a.b||0}else if(i==="mat2")for(let s=0;s<e.length;s++){const o=s*4,a=e[s];n[o]=a.elements[0],n[o+1]=a.elements[1],n[o+2]=a.elements[2],n[o+3]=a.elements[3]}else if(i==="mat3")for(let s=0;s<e.length;s++){const o=s*16,a=e[s];n[o]=a.elements[0],n[o+1]=a.elements[1],n[o+2]=a.elements[2],n[o+4]=a.elements[3],n[o+5]=a.elements[4],n[o+6]=a.elements[5],n[o+8]=a.elements[6],n[o+9]=a.elements[7],n[o+10]=a.elements[8],n[o+15]=1}else if(i==="mat4")for(let s=0;s<e.length;s++){const o=s*16,a=e[s];for(let l=0;l<a.elements.length;l++)n[o+l]=a.elements[l]}else for(let s=0;s<e.length;s++){const o=s*4,a=e[s];n[o]=a.x,n[o+1]=a.y,n[o+2]=a.z||0,n[o+3]=a.w||0}}setup(e){const n=this.array.length,i=this.elementType;let s=Float32Array;const o=this.paddedType,a=e.getTypeLength(o);return i.charAt(0)==="i"&&(s=Int32Array),i.charAt(0)==="u"&&(s=Uint32Array),this.value=new s(n*a),this.bufferCount=n,this.bufferType=o,super.setup(e)}element(e){return Le(new M2e(this,Le(e)))}}const _l=(r,e)=>Le(new A2e(r,e));class C2e extends Vt{constructor(e){super("float"),this.name=e,this.isBuiltinNode=!0}generate(){return this.name}}const vA=Ne(C2e).setParameterLength(1),vJ=Ft(0,"uint").label("u_cameraIndex").setGroup(O3("cameraIndex")).toVarying("v_cameraIndex"),Df=Ft("float").label("cameraNear").setGroup(Lt).onRenderUpdate(({camera:r})=>r.near),kf=Ft("float").label("cameraFar").setGroup(Lt).onRenderUpdate(({camera:r})=>r.far),$3=Oe(({camera:r})=>{let e;if(r.isArrayCamera&&r.cameras.length>0){const n=[];for(const s of r.cameras)n.push(s.projectionMatrix);e=_l(n).setGroup(Lt).label("cameraProjectionMatrices").element(r.isMultiViewCamera?vA("gl_ViewID_OVR"):vJ).toVar("cameraProjectionMatrix")}else e=Ft("mat4").label("cameraProjectionMatrix").setGroup(Lt).onRenderUpdate(({camera:n})=>n.projectionMatrix);return e}).once()(),bu=Oe(({camera:r})=>{let e;if(r.isArrayCamera&&r.cameras.length>0){const n=[];for(const s of r.cameras)n.push(s.matrixWorldInverse);e=_l(n).setGroup(Lt).label("cameraViewMatrices").element(r.isMultiViewCamera?vA("gl_ViewID_OVR"):vJ).toVar("cameraViewMatrix")}else e=Ft("mat4").label("cameraViewMatrix").setGroup(Lt).onRenderUpdate(({camera:n})=>n.matrixWorldInverse);return e}).once()(),P2e=Ft(new K).label("cameraPosition").setGroup(Lt).onRenderUpdate(({camera:r},e)=>e.value.setFromMatrixPosition(r.matrixWorld)),jG=new f_;class Cn extends Vt{static get type(){return"Object3DNode"}constructor(e,n=null){super(),this.scope=e,this.object3d=n,this.updateType=Jt.OBJECT,this._uniformNode=new A_(null)}getNodeType(){const e=this.scope;if(e===Cn.WORLD_MATRIX)return"mat4";if(e===Cn.POSITION||e===Cn.VIEW_POSITION||e===Cn.DIRECTION||e===Cn.SCALE)return"vec3";if(e===Cn.RADIUS)return"float"}update(e){const n=this.object3d,i=this._uniformNode,s=this.scope;if(s===Cn.WORLD_MATRIX)i.value=n.matrixWorld;else if(s===Cn.POSITION)i.value=i.value||new K,i.value.setFromMatrixPosition(n.matrixWorld);else if(s===Cn.SCALE)i.value=i.value||new K,i.value.setFromMatrixScale(n.matrixWorld);else if(s===Cn.DIRECTION)i.value=i.value||new K,n.getWorldDirection(i.value);else if(s===Cn.VIEW_POSITION){const o=e.camera;i.value=i.value||new K,i.value.setFromMatrixPosition(n.matrixWorld),i.value.applyMatrix4(o.matrixWorldInverse)}else if(s===Cn.RADIUS){const o=e.object.geometry;o.boundingSphere===null&&o.computeBoundingSphere(),jG.copy(o.boundingSphere).applyMatrix4(n.matrixWorld),i.value=jG.radius}}generate(e){const n=this.scope;return n===Cn.WORLD_MATRIX?this._uniformNode.nodeType="mat4":n===Cn.POSITION||n===Cn.VIEW_POSITION||n===Cn.DIRECTION||n===Cn.SCALE?this._uniformNode.nodeType="vec3":n===Cn.RADIUS&&(this._uniformNode.nodeType="float"),this._uniformNode.build(e)}serialize(e){super.serialize(e),e.scope=this.scope}deserialize(e){super.deserialize(e),this.scope=e.scope}}Cn.WORLD_MATRIX="worldMatrix";Cn.POSITION="position";Cn.SCALE="scale";Cn.VIEW_POSITION="viewPosition";Cn.DIRECTION="direction";Cn.RADIUS="radius";const R2e=Ne(Cn,Cn.POSITION).setParameterLength(1);class da extends Cn{static get type(){return"ModelNode"}constructor(e){super(e)}update(e){this.object3d=e.object,super.update(e)}}da.DIRECTION;const wd=je(da,da.WORLD_MATRIX);da.POSITION;da.SCALE;da.VIEW_POSITION;da.RADIUS;const N2e=Ft(new Bt).onObjectUpdate(({object:r},e)=>e.value.getNormalMatrix(r.matrixWorld)),xA=Oe(r=>r.renderer.overrideNodes.modelViewMatrix||O2e).once()().toVar("modelViewMatrix"),O2e=bu.mul(wd),VG=Oe(r=>(r.context.isHighPrecisionModelViewMatrix=!0,Ft("mat4").onObjectUpdate(({object:e,camera:n})=>e.modelViewMatrix.multiplyMatrices(n.matrixWorldInverse,e.matrixWorld)))).once()().toVar("highpModelViewMatrix"),GG=Oe(r=>{const e=r.context.isHighPrecisionModelViewMatrix;return Ft("mat3").onObjectUpdate(({object:n,camera:i})=>(e!==!0&&n.modelViewMatrix.multiplyMatrices(i.matrixWorldInverse,n.matrixWorld),n.normalMatrix.getNormalMatrix(n.modelViewMatrix)))}).once()().toVar("highpModelNormalViewMatrix"),bA=Dh("position","vec3"),os=bA.toVarying("positionLocal"),HG=bA.toVarying("positionPrevious"),cb=wd.mul(os).xyz.toVarying("v_positionWorld").context({needsPositionReassign:!0}),xJ=os.transformDirection(wd).toVarying("v_positionWorldDirection").normalize().toVar("positionWorldDirection").context({needsPositionReassign:!0}),Kr=Oe(r=>r.context.setupPositionView(),"vec3").once()().toVarying("v_positionView").context({needsPositionReassign:!0}),dr=Kr.negate().toVarying("v_positionViewDirection").normalize().toVar("positionViewDirection");class D2e extends Vt{static get type(){return"FrontFacingNode"}constructor(){super("bool"),this.isFrontFacingNode=!0}generate(e){const{renderer:n,material:i}=e;return n.coordinateSystem===Ps&&i.side===Fn?"false":e.getFrontFacing()}}const k2e=je(D2e),_A=Te(k2e).mul(2).sub(1),bJ=Dh("normal","vec3"),Ul=Oe(r=>r.geometry.hasAttribute("normal")===!1?(console.warn('THREE.TSL: Vertex attribute "normal" not found on geometry.'),Ae(0,1,0)):bJ,"vec3").once()().toVar("normalLocal"),I2e=Kr.dFdx().cross(Kr.dFdy()).normalize().toVar("normalFlat"),il=Oe(r=>{let e;return r.material.flatShading===!0?e=I2e:e=ol(wJ(Ul),"v_normalView").normalize(),e},"vec3").once()().toVar("normalView"),_J=Oe(r=>{let e=il.transformDirection(bu);return r.material.flatShading!==!0&&(e=ol(e,"v_normalWorld")),e},"vec3").once()().normalize().toVar("normalWorld"),qr=Oe(r=>{let e=r.context.setupNormal().context({getUV:null});return r.material.flatShading!==!0&&(e=e.mul(_A)),e},"vec3").once()().toVar("transformedNormalView"),j3=qr.transformDirection(bu).toVar("transformedNormalWorld"),c0=Oe(r=>{let e=r.context.setupClearcoatNormal().context({getUV:null});return r.material.flatShading!==!0&&(e=e.mul(_A)),e},"vec3").once()().toVar("transformedClearcoatNormalView"),L2e=Oe(([r,e=wd])=>{const n=Ds(e),i=r.div(Ae(n[0].dot(n[0]),n[1].dot(n[1]),n[2].dot(n[2])));return n.mul(i).xyz}),wJ=Oe(([r],e)=>{const n=e.renderer.overrideNodes.modelNormalViewMatrix;if(n!==null)return n.transformDirection(r);const i=N2e.mul(r);return bu.transformDirection(i)}),WG=new so,JR=new sn,F2e=Ft(0).onReference(({material:r})=>r).onObjectUpdate(({material:r})=>r.refractionRatio),eN=Ft(1).onReference(({material:r})=>r).onObjectUpdate(function({material:r,scene:e}){return r.envMap?r.envMapIntensity:e.environmentIntensity}),SJ=Ft(new sn).onReference(function(r){return r.material}).onObjectUpdate(function({material:r,scene:e}){const n=e.environment!==null&&r.envMap===null?e.environmentRotation:r.envMapRotation;return n?(WG.copy(n),JR.makeRotationFromEuler(WG)):JR.identity(),JR}),B2e=dr.negate().reflect(qr),U2e=dr.negate().refract(qr,F2e),z2e=B2e.transformDirection(bu).toVar("reflectVector"),$2e=U2e.transformDirection(bu).toVar("reflectVector");class j2e extends Ty{static get type(){return"CubeTextureNode"}constructor(e,n=null,i=null,s=null){super(e,n,i,s),this.isCubeTextureNode=!0}getInputType(){return"cubeTexture"}getDefaultUV(){const e=this.value;return e.mapping===tl?z2e:e.mapping===nl?$2e:(console.error('THREE.CubeTextureNode: Mapping "%s" not supported.',e.mapping),Ae(0,0,0))}setUpdateMatrix(){}setupUV(e,n){const i=this.value;return(e.renderer.coordinateSystem===Ph||!i.isRenderTargetTexture)&&(n=Ae(n.x.negate(),n.yz)),SJ.mul(n)}generateUV(e,n){return n.build(e,"vec3")}}const ub=Ne(j2e).setParameterLength(1,4).setName("cubeTexture");class V2e extends E_{static get type(){return"ReferenceElementNode"}constructor(e,n){super(e,n),this.referenceNode=e,this.isReferenceElementNode=!0}getNodeType(){return this.referenceNode.uniformType}generate(e){const n=super.generate(e),i=this.referenceNode.getNodeType(),s=this.getNodeType();return e.format(n,i,s)}}class V3 extends Vt{static get type(){return"ReferenceNode"}constructor(e,n,i=null,s=null){super(),this.property=e,this.uniformType=n,this.object=i,this.count=s,this.properties=e.split("."),this.reference=i,this.node=null,this.group=null,this.name=null,this.updateType=Jt.OBJECT}element(e){return Le(new V2e(this,Le(e)))}setGroup(e){return this.group=e,this}label(e){return this.name=e,this}setNodeType(e){let n=null;this.count!==null?n=yJ(null,e,this.count):Array.isArray(this.getValueFromReference())?n=_l(null,e):e==="texture"?n=cn(null):e==="cubeTexture"?n=ub(null):n=Ft(null,e),this.group!==null&&n.setGroup(this.group),this.name!==null&&n.label(this.name),this.node=n.getSelf()}getNodeType(e){return this.node===null&&(this.updateReference(e),this.updateValue()),this.node.getNodeType(e)}getValueFromReference(e=this.reference){const{properties:n}=this;let i=e[n[0]];for(let s=1;s<n.length;s++)i=i[n[s]];return i}updateReference(e){return this.reference=this.object!==null?this.object:e.object,this.reference}setup(){return this.updateValue(),this.node}update(){this.updateValue()}updateValue(){this.node===null&&this.setNodeType(this.uniformType);const e=this.getValueFromReference();Array.isArray(e)?this.node.array=e:this.node.value=e}}const kn=(r,e,n)=>Le(new V3(r,e,n)),qG=(r,e,n,i)=>Le(new V3(r,e,i,n));class G2e extends V3{static get type(){return"MaterialReferenceNode"}constructor(e,n,i=null){super(e,n,i),this.material=i,this.isMaterialReferenceNode=!0}updateReference(e){return this.reference=this.material!==null?this.material:e.material,this.reference}}const eh=(r,e,n=null)=>Le(new G2e(r,e,n)),TJ=Oe(r=>(r.geometry.hasAttribute("tangent")===!1&&r.geometry.computeTangents(),Dh("tangent","vec4")))(),G3=TJ.xyz.toVar("tangentLocal"),EJ=xA.mul(jt(G3,0)).xyz.toVarying("v_tangentView").normalize().toVar("tangentView"),H2e=Oe(([r,e],n)=>{let i=r.mul(TJ.w).xyz;return n.material.flatShading!==!0&&(i=ol(r,e)),i}).once(),W2e=H2e(il.cross(EJ),"v_bitangentView").normalize().toVar("bitangentView"),u0=Ds(EJ,W2e,il),q2e=(()=>{let r=Lm.cross(dr);return r=r.cross(Lm).normalize(),r=Yn(r,qr,Af.mul(Cc.oneMinus()).oneMinus().pow2().pow2()).normalize(),r})(),X2e=Oe(r=>{const{eye_pos:e,surf_norm:n,mapN:i,uv:s}=r,o=e.dFdx(),a=e.dFdy(),l=s.dFdx(),c=s.dFdy(),u=n,h=a.cross(u),f=u.cross(o),d=h.mul(l.x).add(f.mul(c.x)),p=h.mul(l.y).add(f.mul(c.y)),m=d.dot(d).max(p.dot(p)),g=_A.mul(m.inverseSqrt());return ks(d.mul(i.x,g),p.mul(i.y,g),u.mul(i.z)).normalize()});class K2e extends Qr{static get type(){return"NormalMapNode"}constructor(e,n=null){super("vec3"),this.node=e,this.scaleNode=n,this.normalMapType=ou}setup(e){const{normalMapType:n,scaleNode:i}=this;let s=this.node.mul(2).sub(1);i!==null&&(s=Ae(s.xy.mul(i),s.z));let o=null;return n===_Y?o=wJ(s):n===ou&&(e.hasGeometryAttribute("tangent")===!0?o=u0.mul(s).normalize():o=X2e({eye_pos:Kr,surf_norm:il,mapN:s,uv:P_()})),o}}const XG=Ne(K2e).setParameterLength(1,2),Y2e=Oe(({textureNode:r,bumpScale:e})=>{const n=s=>r.cache().context({getUV:o=>s(o.uvNode||P_()),forceUVContext:!0}),i=Te(n(s=>s));return Ve(Te(n(s=>s.add(s.dFdx()))).sub(i),Te(n(s=>s.add(s.dFdy()))).sub(i)).mul(e)}),Z2e=Oe(r=>{const{surf_pos:e,surf_norm:n,dHdxy:i}=r,s=e.dFdx().normalize(),o=e.dFdy().normalize(),a=n,l=o.cross(a),c=a.cross(s),u=s.dot(l).mul(_A),h=u.sign().mul(i.x.mul(l).add(i.y.mul(c)));return u.abs().mul(n).sub(h).normalize()});class Q2e extends Qr{static get type(){return"BumpMapNode"}constructor(e,n=null){super("vec3"),this.textureNode=e,this.scaleNode=n}setup(){const e=this.scaleNode!==null?this.scaleNode:1,n=Y2e({textureNode:this.textureNode,bumpScale:e});return Z2e({surf_pos:Kr,surf_norm:il,dHdxy:n})}}const J2e=Ne(Q2e).setParameterLength(1,2),KG=new Map;class we extends Vt{static get type(){return"MaterialNode"}constructor(e){super(),this.scope=e}getCache(e,n){let i=KG.get(e);return i===void 0&&(i=eh(e,n),KG.set(e,i)),i}getFloat(e){return this.getCache(e,"float")}getColor(e){return this.getCache(e,"color")}getTexture(e){return this.getCache(e==="map"?"map":e+"Map","texture")}setup(e){const n=e.context.material,i=this.scope;let s=null;if(i===we.COLOR){const o=n.color!==void 0?this.getColor(i):Ae();n.map&&n.map.isTexture===!0?s=o.mul(this.getTexture("map")):s=o}else if(i===we.OPACITY){const o=this.getFloat(i);n.alphaMap&&n.alphaMap.isTexture===!0?s=o.mul(this.getTexture("alpha")):s=o}else if(i===we.SPECULAR_STRENGTH)n.specularMap&&n.specularMap.isTexture===!0?s=this.getTexture("specular").r:s=Te(1);else if(i===we.SPECULAR_INTENSITY){const o=this.getFloat(i);n.specularIntensityMap&&n.specularIntensityMap.isTexture===!0?s=o.mul(this.getTexture(i).a):s=o}else if(i===we.SPECULAR_COLOR){const o=this.getColor(i);n.specularColorMap&&n.specularColorMap.isTexture===!0?s=o.mul(this.getTexture(i).rgb):s=o}else if(i===we.ROUGHNESS){const o=this.getFloat(i);n.roughnessMap&&n.roughnessMap.isTexture===!0?s=o.mul(this.getTexture(i).g):s=o}else if(i===we.METALNESS){const o=this.getFloat(i);n.metalnessMap&&n.metalnessMap.isTexture===!0?s=o.mul(this.getTexture(i).b):s=o}else if(i===we.EMISSIVE){const o=this.getFloat("emissiveIntensity"),a=this.getColor(i).mul(o);n.emissiveMap&&n.emissiveMap.isTexture===!0?s=a.mul(this.getTexture(i)):s=a}else if(i===we.NORMAL)n.normalMap?(s=XG(this.getTexture("normal"),this.getCache("normalScale","vec2")),s.normalMapType=n.normalMapType):n.bumpMap?s=J2e(this.getTexture("bump").r,this.getFloat("bumpScale")):s=il;else if(i===we.CLEARCOAT){const o=this.getFloat(i);n.clearcoatMap&&n.clearcoatMap.isTexture===!0?s=o.mul(this.getTexture(i).r):s=o}else if(i===we.CLEARCOAT_ROUGHNESS){const o=this.getFloat(i);n.clearcoatRoughnessMap&&n.clearcoatRoughnessMap.isTexture===!0?s=o.mul(this.getTexture(i).r):s=o}else if(i===we.CLEARCOAT_NORMAL)n.clearcoatNormalMap?s=XG(this.getTexture(i),this.getCache(i+"Scale","vec2")):s=il;else if(i===we.SHEEN){const o=this.getColor("sheenColor").mul(this.getFloat("sheen"));n.sheenColorMap&&n.sheenColorMap.isTexture===!0?s=o.mul(this.getTexture("sheenColor").rgb):s=o}else if(i===we.SHEEN_ROUGHNESS){const o=this.getFloat(i);n.sheenRoughnessMap&&n.sheenRoughnessMap.isTexture===!0?s=o.mul(this.getTexture(i).a):s=o,s=s.clamp(.07,1)}else if(i===we.ANISOTROPY)if(n.anisotropyMap&&n.anisotropyMap.isTexture===!0){const o=this.getTexture(i);s=P3(Mv.x,Mv.y,Mv.y.negate(),Mv.x).mul(o.rg.mul(2).sub(Ve(1)).normalize().mul(o.b))}else s=Mv;else if(i===we.IRIDESCENCE_THICKNESS){const o=kn("1","float",n.iridescenceThicknessRange);if(n.iridescenceThicknessMap){const a=kn("0","float",n.iridescenceThicknessRange);s=o.sub(a).mul(this.getTexture(i).g).add(a)}else s=o}else if(i===we.TRANSMISSION){const o=this.getFloat(i);n.transmissionMap?s=o.mul(this.getTexture(i).r):s=o}else if(i===we.THICKNESS){const o=this.getFloat(i);n.thicknessMap?s=o.mul(this.getTexture(i).g):s=o}else if(i===we.IOR)s=this.getFloat(i);else if(i===we.LIGHT_MAP)s=this.getTexture(i).rgb.mul(this.getFloat("lightMapIntensity"));else if(i===we.AO)s=this.getTexture(i).r.sub(1).mul(this.getFloat("aoMapIntensity")).add(1);else{const o=this.getNodeType(e);s=this.getCache(i,o)}return s}}we.ALPHA_TEST="alphaTest";we.COLOR="color";we.OPACITY="opacity";we.SHININESS="shininess";we.SPECULAR="specular";we.SPECULAR_STRENGTH="specularStrength";we.SPECULAR_INTENSITY="specularIntensity";we.SPECULAR_COLOR="specularColor";we.REFLECTIVITY="reflectivity";we.ROUGHNESS="roughness";we.METALNESS="metalness";we.NORMAL="normal";we.CLEARCOAT="clearcoat";we.CLEARCOAT_ROUGHNESS="clearcoatRoughness";we.CLEARCOAT_NORMAL="clearcoatNormal";we.EMISSIVE="emissive";we.ROTATION="rotation";we.SHEEN="sheen";we.SHEEN_ROUGHNESS="sheenRoughness";we.ANISOTROPY="anisotropy";we.IRIDESCENCE="iridescence";we.IRIDESCENCE_IOR="iridescenceIOR";we.IRIDESCENCE_THICKNESS="iridescenceThickness";we.IOR="ior";we.TRANSMISSION="transmission";we.THICKNESS="thickness";we.ATTENUATION_DISTANCE="attenuationDistance";we.ATTENUATION_COLOR="attenuationColor";we.LINE_SCALE="scale";we.LINE_DASH_SIZE="dashSize";we.LINE_GAP_SIZE="gapSize";we.LINE_WIDTH="linewidth";we.LINE_DASH_OFFSET="dashOffset";we.POINT_SIZE="size";we.DISPERSION="dispersion";we.LIGHT_MAP="light";we.AO="ao";const eOe=je(we,we.ALPHA_TEST),tOe=je(we,we.COLOR),nOe=je(we,we.SHININESS),rOe=je(we,we.EMISSIVE),MJ=je(we,we.OPACITY),iOe=je(we,we.SPECULAR),YG=je(we,we.SPECULAR_INTENSITY),sOe=je(we,we.SPECULAR_COLOR),z1=je(we,we.SPECULAR_STRENGTH),tN=je(we,we.REFLECTIVITY),oOe=je(we,we.ROUGHNESS),aOe=je(we,we.METALNESS),lOe=je(we,we.NORMAL),cOe=je(we,we.CLEARCOAT),uOe=je(we,we.CLEARCOAT_ROUGHNESS),hOe=je(we,we.CLEARCOAT_NORMAL),fOe=je(we,we.ROTATION),dOe=je(we,we.SHEEN),pOe=je(we,we.SHEEN_ROUGHNESS),mOe=je(we,we.ANISOTROPY),gOe=je(we,we.IRIDESCENCE),yOe=je(we,we.IRIDESCENCE_IOR),vOe=je(we,we.IRIDESCENCE_THICKNESS),xOe=je(we,we.TRANSMISSION),bOe=je(we,we.THICKNESS),_Oe=je(we,we.IOR),wOe=je(we,we.ATTENUATION_DISTANCE),SOe=je(we,we.ATTENUATION_COLOR),TOe=je(we,we.LINE_SCALE),EOe=je(we,we.LINE_DASH_SIZE),MOe=je(we,we.LINE_GAP_SIZE);we.LINE_WIDTH;const AOe=je(we,we.LINE_DASH_OFFSET),COe=je(we,we.POINT_SIZE),POe=je(we,we.DISPERSION),AJ=je(we,we.LIGHT_MAP),ROe=je(we,we.AO),Mv=Ft(new Fe).onReference(function(r){return r.material}).onRenderUpdate(function({material:r}){this.value.set(r.anisotropy*Math.cos(r.anisotropyRotation),r.anisotropy*Math.sin(r.anisotropyRotation))}),CJ=Oe(r=>r.context.setupModelViewProjection(),"vec4").once()().toVarying("v_modelViewProjection");class Zn extends Vt{static get type(){return"IndexNode"}constructor(e){super("uint"),this.scope=e,this.isIndexNode=!0}generate(e){const n=this.getNodeType(e),i=this.scope;let s;if(i===Zn.VERTEX)s=e.getVertexIndex();else if(i===Zn.INSTANCE)s=e.getInstanceIndex();else if(i===Zn.DRAW)s=e.getDrawIndex();else if(i===Zn.INVOCATION_LOCAL)s=e.getInvocationLocalIndex();else if(i===Zn.INVOCATION_SUBGROUP)s=e.getInvocationSubgroupIndex();else if(i===Zn.SUBGROUP)s=e.getSubgroupIndex();else throw new Error("THREE.IndexNode: Unknown scope: "+i);let o;return e.shaderStage==="vertex"||e.shaderStage==="compute"?o=s:o=ol(this).build(e,n),o}}Zn.VERTEX="vertex";Zn.INSTANCE="instance";Zn.SUBGROUP="subgroup";Zn.INVOCATION_LOCAL="invocationLocal";Zn.INVOCATION_SUBGROUP="invocationSubgroup";Zn.DRAW="draw";const NOe=je(Zn,Zn.VERTEX),H3=je(Zn,Zn.INSTANCE);Zn.SUBGROUP;Zn.INVOCATION_SUBGROUP;Zn.INVOCATION_LOCAL;const OOe=je(Zn,Zn.DRAW);class DOe extends Vt{static get type(){return"InstanceNode"}constructor(e,n,i=null){super("void"),this.count=e,this.instanceMatrix=n,this.instanceColor=i,this.instanceMatrixNode=null,this.instanceColorNode=null,this.updateType=Jt.FRAME,this.buffer=null,this.bufferColor=null}setup(e){const{count:n,instanceMatrix:i,instanceColor:s}=this;let{instanceMatrixNode:o,instanceColorNode:a}=this;if(o===null){if(n<=1e3)o=yJ(i.array,"mat4",Math.max(n,1)).element(H3);else{const c=new D0e(i.array,16,1);this.buffer=c;const u=i.usage===om?$G:zG,h=[u(c,"vec4",16,0),u(c,"vec4",16,4),u(c,"vec4",16,8),u(c,"vec4",16,12)];o=Im(...h)}this.instanceMatrixNode=o}if(s&&a===null){const c=new Hve(s.array,3),u=s.usage===om?$G:zG;this.bufferColor=c,a=Ae(u(c,"vec3",3,0)),this.instanceColorNode=a}const l=o.mul(os).xyz;if(os.assign(l),e.hasGeometryAttribute("normal")){const c=L2e(Ul,o);Ul.assign(c)}this.instanceColorNode!==null&&hE("vec3","vInstanceColor").assign(this.instanceColorNode)}update(){this.instanceMatrix.usage!==om&&this.buffer!==null&&this.instanceMatrix.version!==this.buffer.version&&(this.buffer.version=this.instanceMatrix.version),this.instanceColor&&this.instanceColor.usage!==om&&this.bufferColor!==null&&this.instanceColor.version!==this.bufferColor.version&&(this.bufferColor.version=this.instanceColor.version)}}class kOe extends DOe{static get type(){return"InstancedMeshNode"}constructor(e){const{count:n,instanceMatrix:i,instanceColor:s}=e;super(n,i,s),this.instancedMesh=e}}const IOe=Ne(kOe).setParameterLength(1);class LOe extends Vt{static get type(){return"BatchNode"}constructor(e){super("void"),this.batchMesh=e,this.batchingIdNode=null}setup(e){this.batchingIdNode===null&&(e.getDrawIndex()===null?this.batchingIdNode=H3:this.batchingIdNode=OOe);const i=Oe(([m])=>{const g=zn(Fm(Oa(this.batchMesh._indirectTexture),0).x),v=zn(m).mod(g),y=zn(m).div(g);return Oa(this.batchMesh._indirectTexture,Tc(v,y)).x}).setLayout({name:"getIndirectIndex",type:"uint",inputs:[{name:"id",type:"int"}]})(zn(this.batchingIdNode)),s=this.batchMesh._matricesTexture,o=zn(Fm(Oa(s),0).x),a=Te(i).mul(4).toInt().toVar(),l=a.mod(o),c=a.div(o),u=Im(Oa(s,Tc(l,c)),Oa(s,Tc(l.add(1),c)),Oa(s,Tc(l.add(2),c)),Oa(s,Tc(l.add(3),c))),h=this.batchMesh._colorsTexture;if(h!==null){const g=Oe(([v])=>{const y=zn(Fm(Oa(h),0).x),x=v,b=x.mod(y),w=x.div(y);return Oa(h,Tc(b,w)).rgb}).setLayout({name:"getBatchingColor",type:"vec3",inputs:[{name:"id",type:"int"}]})(i);hE("vec3","vBatchColor").assign(g)}const f=Ds(u);os.assign(u.mul(os));const d=Ul.div(Ae(f[0].dot(f[0]),f[1].dot(f[1]),f[2].dot(f[2]))),p=f.mul(d).xyz;Ul.assign(p),e.hasGeometryAttribute("tangent")&&G3.mulAssign(f)}}const FOe=Ne(LOe).setParameterLength(1),ZG=new WeakMap;class BOe extends Vt{static get type(){return"SkinningNode"}constructor(e){super("void"),this.skinnedMesh=e,this.updateType=Jt.OBJECT,this.skinIndexNode=Dh("skinIndex","uvec4"),this.skinWeightNode=Dh("skinWeight","vec4"),this.bindMatrixNode=kn("bindMatrix","mat4"),this.bindMatrixInverseNode=kn("bindMatrixInverse","mat4"),this.boneMatricesNode=qG("skeleton.boneMatrices","mat4",e.skeleton.bones.length),this.positionNode=os,this.toPositionNode=os,this.previousBoneMatricesNode=null}getSkinnedPosition(e=this.boneMatricesNode,n=this.positionNode){const{skinIndexNode:i,skinWeightNode:s,bindMatrixNode:o,bindMatrixInverseNode:a}=this,l=e.element(i.x),c=e.element(i.y),u=e.element(i.z),h=e.element(i.w),f=o.mul(n),d=ks(l.mul(s.x).mul(f),c.mul(s.y).mul(f),u.mul(s.z).mul(f),h.mul(s.w).mul(f));return a.mul(d).xyz}getSkinnedNormal(e=this.boneMatricesNode,n=Ul){const{skinIndexNode:i,skinWeightNode:s,bindMatrixNode:o,bindMatrixInverseNode:a}=this,l=e.element(i.x),c=e.element(i.y),u=e.element(i.z),h=e.element(i.w);let f=ks(s.x.mul(l),s.y.mul(c),s.z.mul(u),s.w.mul(h));return f=a.mul(f).mul(o),f.transformDirection(n).xyz}getPreviousSkinnedPosition(e){const n=e.object;return this.previousBoneMatricesNode===null&&(n.skeleton.previousBoneMatrices=new Float32Array(n.skeleton.boneMatrices),this.previousBoneMatricesNode=qG("skeleton.previousBoneMatrices","mat4",n.skeleton.bones.length)),this.getSkinnedPosition(this.previousBoneMatricesNode,HG)}needsPreviousBoneMatrices(e){const n=e.renderer.getMRT();return n&&n.has("velocity")||UQ(e.object).useVelocity===!0}setup(e){this.needsPreviousBoneMatrices(e)&&HG.assign(this.getPreviousSkinnedPosition(e));const n=this.getSkinnedPosition();if(this.toPositionNode&&this.toPositionNode.assign(n),e.hasGeometryAttribute("normal")){const i=this.getSkinnedNormal();Ul.assign(i),e.hasGeometryAttribute("tangent")&&G3.assign(i)}return n}generate(e,n){if(n!=="void")return super.generate(e,n)}update(e){const n=e.object&&e.object.skeleton?e.object.skeleton:this.skinnedMesh.skeleton;ZG.get(n)!==e.frameId&&(ZG.set(n,e.frameId),this.previousBoneMatricesNode!==null&&n.previousBoneMatrices.set(n.boneMatrices),n.update())}}const UOe=r=>Le(new BOe(r));class zOe extends Vt{static get type(){return"LoopNode"}constructor(e=[]){super(),this.params=e}getVarName(e){return String.fromCharCode(105+e)}getProperties(e){const n=e.getNodeProperties(this);if(n.stackNode!==void 0)return n;const i={};for(let a=0,l=this.params.length-1;a<l;a++){const c=this.params[a],u=c.isNode!==!0&&c.name||this.getVarName(a),h=c.isNode!==!0&&c.type||"int";i[u]=Eg(u,h)}const s=e.addStack();n.returnsNode=this.params[this.params.length-1](i,e),n.stackNode=s;const o=this.params[0];return o.isNode!==!0&&typeof o.update=="function"&&(n.updateNode=Oe(this.params[0].update)(i)),e.removeStack(),n}getNodeType(e){const{returnsNode:n}=this.getProperties(e);return n?n.getNodeType(e):"void"}setup(e){this.getProperties(e)}generate(e){const n=this.getProperties(e),i=this.params,s=n.stackNode;for(let l=0,c=i.length-1;l<c;l++){const u=i[l];let h=!1,f=null,d=null,p=null,m=null,g=null,v=null;u.isNode?u.getNodeType(e)==="bool"?(h=!0,m="bool",d=u.build(e,m)):(m="int",p=this.getVarName(l),f="0",d=u.build(e,m),g="<"):(m=u.type||"int",p=u.name||this.getVarName(l),f=u.start,d=u.end,g=u.condition,v=u.update,typeof f=="number"?f=e.generateConst(m,f):f&&f.isNode&&(f=f.build(e,m)),typeof d=="number"?d=e.generateConst(m,d):d&&d.isNode&&(d=d.build(e,m)),f!==void 0&&d===void 0?(f=f+" - 1",d="0",g=">="):d!==void 0&&f===void 0&&(f="0",g="<"),g===void 0&&(Number(f)>Number(d)?g=">=":g="<"));let y;if(h)y=`while ( ${d} )`;else{const x={start:f,end:d},b=x.start,w=x.end;let _;const S=()=>g.includes("<")?"+=":"-=";if(v!=null)switch(typeof v){case"function":_=e.flowStagesNode(n.updateNode,"void").code.replace(/\t|;/g,"");break;case"number":_=p+" "+S()+" "+e.generateConst(m,v);break;case"string":_=p+" "+v;break;default:v.isNode?_=p+" "+S()+" "+v.build(e):(console.error("THREE.TSL: 'Loop( { update: ... } )' is not a function, string or number."),_="break /* invalid update */")}else m==="int"||m==="uint"?v=g.includes("<")?"++":"--":v=S()+" 1.",_=p+" "+v;const T=e.getVar(m,p)+" = "+b,E=p+" "+g+" "+w;y=`for ( ${T}; ${E}; ${_} )`}e.addFlowCode((l===0?`
`:"")+e.tab+y+` {

`).addFlowTab()}const o=s.build(e,"void"),a=n.returnsNode?n.returnsNode.build(e):"";e.removeFlowTab().addFlowCode(`
`+e.tab+o);for(let l=0,c=this.params.length-1;l<c;l++)e.addFlowCode((l===0?"":e.tab)+`}

`).removeFlowTab();return e.addFlowTab(),a}}const Wa=(...r)=>Le(new zOe(km(r,"int"))).toStack(),$Oe=()=>Eg("break").toStack(),nN=new WeakMap,go=new Nt,QG=Oe(({bufferMap:r,influence:e,stride:n,width:i,depth:s,offset:o})=>{const a=zn(NOe).mul(n).add(o),l=a.div(i),c=a.sub(l.mul(i));return Oa(r,Tc(c,l)).depth(s).xyz.mul(e)});function jOe(r){const e=r.morphAttributes.position!==void 0,n=r.morphAttributes.normal!==void 0,i=r.morphAttributes.color!==void 0,s=r.morphAttributes.position||r.morphAttributes.normal||r.morphAttributes.color,o=s!==void 0?s.length:0;let a=nN.get(r);if(a===void 0||a.count!==o){let x=function(){v.dispose(),nN.delete(r),r.removeEventListener("dispose",x)};var l=x;a!==void 0&&a.texture.dispose();const c=r.morphAttributes.position||[],u=r.morphAttributes.normal||[],h=r.morphAttributes.color||[];let f=0;e===!0&&(f=1),n===!0&&(f=2),i===!0&&(f=3);let d=r.attributes.position.count*f,p=1;const m=4096;d>m&&(p=Math.ceil(d/m),d=m);const g=new Float32Array(d*p*4*o),v=new KM(g,d,p,o);v.type=Nr,v.needsUpdate=!0;const y=f*4;for(let b=0;b<o;b++){const w=c[b],_=u[b],S=h[b],T=d*p*4*b;for(let E=0;E<w.count;E++){const M=E*y;e===!0&&(go.fromBufferAttribute(w,E),g[T+M+0]=go.x,g[T+M+1]=go.y,g[T+M+2]=go.z,g[T+M+3]=0),n===!0&&(go.fromBufferAttribute(_,E),g[T+M+4]=go.x,g[T+M+5]=go.y,g[T+M+6]=go.z,g[T+M+7]=0),i===!0&&(go.fromBufferAttribute(S,E),g[T+M+8]=go.x,g[T+M+9]=go.y,g[T+M+10]=go.z,g[T+M+11]=S.itemSize===4?go.w:1)}}a={count:o,texture:v,stride:f,size:new Fe(d,p)},nN.set(r,a),r.addEventListener("dispose",x)}return a}class VOe extends Vt{static get type(){return"MorphNode"}constructor(e){super("void"),this.mesh=e,this.morphBaseInfluence=Ft(1),this.updateType=Jt.OBJECT}setup(e){const{geometry:n}=e,i=n.morphAttributes.position!==void 0,s=n.hasAttribute("normal")&&n.morphAttributes.normal!==void 0,o=n.morphAttributes.position||n.morphAttributes.normal||n.morphAttributes.color,a=o!==void 0?o.length:0,{texture:l,stride:c,size:u}=jOe(n);i===!0&&os.mulAssign(this.morphBaseInfluence),s===!0&&Ul.mulAssign(this.morphBaseInfluence);const h=zn(u.width);Wa(a,({i:f})=>{const d=Te(0).toVar();this.mesh.count>1&&this.mesh.morphTexture!==null&&this.mesh.morphTexture!==void 0?d.assign(Oa(this.mesh.morphTexture,Tc(zn(f).add(1),zn(H3))).r):d.assign(kn("morphTargetInfluences","float").element(f).toVar()),kr(d.notEqual(0),()=>{i===!0&&os.addAssign(QG({bufferMap:l,influence:d,stride:c,width:h,depth:f,offset:zn(0)})),s===!0&&Ul.addAssign(QG({bufferMap:l,influence:d,stride:c,width:h,depth:f,offset:zn(1)}))})})}update(){const e=this.morphBaseInfluence;this.mesh.geometry.morphTargetsRelative?e.value=1:e.value=1-this.mesh.morphTargetInfluences.reduce((n,i)=>n+i,0)}}const GOe=Ne(VOe).setParameterLength(1);class Ey extends Vt{static get type(){return"LightingNode"}constructor(){super("vec3"),this.isLightingNode=!0}}class HOe extends Ey{static get type(){return"AONode"}constructor(e=null){super(),this.aoNode=e}setup(e){e.context.ambientOcclusion.mulAssign(this.aoNode)}}class WOe extends fJ{static get type(){return"LightingContextNode"}constructor(e,n=null,i=null,s=null){super(e),this.lightingModel=n,this.backdropNode=i,this.backdropAlphaNode=s,this._value=null}getContext(){const{backdropNode:e,backdropAlphaNode:n}=this,i=Ae().toVar("directDiffuse"),s=Ae().toVar("directSpecular"),o=Ae().toVar("indirectDiffuse"),a=Ae().toVar("indirectSpecular"),l={directDiffuse:i,directSpecular:s,indirectDiffuse:o,indirectSpecular:a};return{radiance:Ae().toVar("radiance"),irradiance:Ae().toVar("irradiance"),iblIrradiance:Ae().toVar("iblIrradiance"),ambientOcclusion:Te(1).toVar("ambientOcclusion"),reflectedLight:l,backdrop:e,backdropAlpha:n}}setup(e){return this.value=this._value||(this._value=this.getContext()),this.value.lightingModel=this.lightingModel||e.context.lightingModel,super.setup(e)}}const qOe=Ne(WOe);class XOe extends Ey{static get type(){return"IrradianceNode"}constructor(e){super(),this.node=e}setup(e){e.context.irradiance.addAssign(this.node)}}let Av,Cv;class Wr extends Vt{static get type(){return"ScreenNode"}constructor(e){super(),this.scope=e,this.isViewportNode=!0}getNodeType(){return this.scope===Wr.VIEWPORT?"vec4":"vec2"}getUpdateType(){let e=Jt.NONE;return(this.scope===Wr.SIZE||this.scope===Wr.VIEWPORT)&&(e=Jt.RENDER),this.updateType=e,e}update({renderer:e}){const n=e.getRenderTarget();this.scope===Wr.VIEWPORT?n!==null?Cv.copy(n.viewport):(e.getViewport(Cv),Cv.multiplyScalar(e.getPixelRatio())):n!==null?(Av.width=n.width,Av.height=n.height):e.getDrawingBufferSize(Av)}setup(){const e=this.scope;let n=null;return e===Wr.SIZE?n=Ft(Av||(Av=new Fe)):e===Wr.VIEWPORT?n=Ft(Cv||(Cv=new Nt)):n=Ve(wA.div(SD)),n}generate(e){if(this.scope===Wr.COORDINATE){let n=e.getFragCoord();if(e.isFlipY()){const i=e.getNodeProperties(SD).outputNode.build(e);n=`${e.getType("vec2")}( ${n}.x, ${i}.y - ${n}.y )`}return n}return super.generate(e)}}Wr.COORDINATE="coordinate";Wr.VIEWPORT="viewport";Wr.SIZE="size";Wr.UV="uv";const Bm=je(Wr,Wr.UV),SD=je(Wr,Wr.SIZE),wA=je(Wr,Wr.COORDINATE),j0=je(Wr,Wr.VIEWPORT);j0.zw;j0.xy;const Pv=new Fe;class PJ extends Ty{static get type(){return"ViewportTextureNode"}constructor(e=Bm,n=null,i=null){i===null&&(i=new Kve,i.minFilter=Ks),super(i,e,n),this.generateMipmaps=!1,this.isOutputTextureNode=!0,this.updateBeforeType=Jt.FRAME}updateBefore(e){const n=e.renderer;n.getDrawingBufferSize(Pv);const i=this.value;(i.image.width!==Pv.width||i.image.height!==Pv.height)&&(i.image.width=Pv.width,i.image.height=Pv.height,i.needsUpdate=!0);const s=i.generateMipmaps;i.generateMipmaps=this.generateMipmaps,n.copyFramebufferToTexture(i),i.generateMipmaps=s}clone(){const e=new this.constructor(this.uvNode,this.levelNode,this.value);return e.generateMipmaps=this.generateMipmaps,e}}const RJ=Ne(PJ,null,null,{generateMipmaps:!0}).setParameterLength(0,3);let rN=null;class KOe extends PJ{static get type(){return"ViewportDepthTextureNode"}constructor(e=Bm,n=null){rN===null&&(rN=new ko),super(e,n,rN)}}const YOe=Ne(KOe).setParameterLength(0,2);class Zs extends Vt{static get type(){return"ViewportDepthNode"}constructor(e,n=null){super("float"),this.scope=e,this.valueNode=n,this.isViewportDepthNode=!0}generate(e){const{scope:n}=this;return n===Zs.DEPTH_BASE?e.getFragDepth():super.generate(e)}setup({camera:e}){const{scope:n}=this,i=this.valueNode;let s=null;if(n===Zs.DEPTH_BASE)i!==null&&(s=DJ().assign(i));else if(n===Zs.DEPTH)e.isPerspectiveCamera?s=ZOe(Kr.z,Df,kf):s=V0(Kr.z,Df,kf);else if(n===Zs.LINEAR_DEPTH)if(i!==null)if(e.isPerspectiveCamera){const o=NJ(i,Df,kf);s=V0(o,Df,kf)}else s=i;else s=V0(Kr.z,Df,kf);return s}}Zs.DEPTH_BASE="depthBase";Zs.DEPTH="depth";Zs.LINEAR_DEPTH="linearDepth";const V0=(r,e,n)=>r.add(e).div(e.sub(n)),ZOe=(r,e,n)=>e.add(r).mul(n).div(n.sub(e).mul(r)),NJ=(r,e,n)=>e.mul(n).div(n.sub(e).mul(r).sub(n)),OJ=(r,e,n)=>{e=e.max(1e-6).toVar();const i=Xc(r.negate().div(e)),s=Xc(n.div(e));return i.div(s)},DJ=Ne(Zs,Zs.DEPTH_BASE),kJ=je(Zs,Zs.DEPTH),QOe=Ne(Zs,Zs.LINEAR_DEPTH).setParameterLength(0,1);YOe();kJ.assign=r=>DJ(r);class la extends Vt{static get type(){return"ClippingNode"}constructor(e=la.DEFAULT){super(),this.scope=e}setup(e){super.setup(e);const n=e.clippingContext,{intersectionPlanes:i,unionPlanes:s}=n;return this.hardwareClipping=e.material.hardwareClipping,this.scope===la.ALPHA_TO_COVERAGE?this.setupAlphaToCoverage(i,s):this.scope===la.HARDWARE?this.setupHardwareClipping(s,e):this.setupDefault(i,s)}setupAlphaToCoverage(e,n){return Oe(()=>{const i=Te().toVar("distanceToPlane"),s=Te().toVar("distanceToGradient"),o=Te(1).toVar("clipOpacity"),a=n.length;if(this.hardwareClipping===!1&&a>0){const c=_l(n);Wa(a,({i:u})=>{const h=c.element(u);i.assign(Kr.dot(h.xyz).negate().add(h.w)),s.assign(i.fwidth().div(2)),o.mulAssign(Oh(s.negate(),s,i))})}const l=e.length;if(l>0){const c=_l(e),u=Te(1).toVar("intersectionClipOpacity");Wa(l,({i:h})=>{const f=c.element(h);i.assign(Kr.dot(f.xyz).negate().add(f.w)),s.assign(i.fwidth().div(2)),u.mulAssign(Oh(s.negate(),s,i).oneMinus())}),o.mulAssign(u.oneMinus())}bn.a.mulAssign(o),bn.a.equal(0).discard()})()}setupDefault(e,n){return Oe(()=>{const i=n.length;if(this.hardwareClipping===!1&&i>0){const o=_l(n);Wa(i,({i:a})=>{const l=o.element(a);Kr.dot(l.xyz).greaterThan(l.w).discard()})}const s=e.length;if(s>0){const o=_l(e),a=WQ(!0).toVar("clipped");Wa(s,({i:l})=>{const c=o.element(l);a.assign(Kr.dot(c.xyz).greaterThan(c.w).and(a))}),a.discard()}})()}setupHardwareClipping(e,n){const i=e.length;return n.enableHardwareClipping(i),Oe(()=>{const s=_l(e),o=vA(n.getClipDistance());Wa(i,({i:a})=>{const l=s.element(a),c=Kr.dot(l.xyz).sub(l.w).negate();o.element(a).assign(c)})})()}}la.ALPHA_TO_COVERAGE="alphaToCoverage";la.DEFAULT="default";la.HARDWARE="hardware";const JOe=()=>Le(new la),eDe=()=>Le(new la(la.ALPHA_TO_COVERAGE)),tDe=()=>Le(new la(la.HARDWARE)),nDe=.05,JG=Oe(([r])=>Xh(rn(1e4,ja(rn(17,r.x).add(rn(.1,r.y)))).mul(ks(.1,Jo(ja(rn(13,r.y).add(r.x))))))),e5=Oe(([r])=>JG(Ve(JG(r.xy),r.z))),rDe=Oe(([r])=>{const e=ao(wh(sJ(r.xyz)),wh(oJ(r.xyz))),n=Te(1).div(Te(nDe).mul(e)).toVar("pixScale"),i=Ve(ob(id(Xc(n))),ob(k3(Xc(n)))),s=Ve(e5(id(i.x.mul(r.xyz))),e5(id(i.y.mul(r.xyz)))),o=Xh(Xc(n)),a=ks(rn(o.oneMinus(),s.x),rn(o,s.y)),l=lb(o,o.oneMinus()),c=Ae(a.mul(a).div(rn(2,l).mul(qs(1,l))),a.sub(rn(.5,l)).div(qs(1,l)),qs(1,qs(1,a).mul(qs(1,a)).div(rn(2,l).mul(qs(1,l))))),u=a.lessThan(l.oneMinus()).select(a.lessThan(l).select(c.x,c.y),c.z);return hu(u,1e-6,1)}).setLayout({name:"getAlphaHashThreshold",type:"float",inputs:[{name:"position",type:"vec3"}]});class iDe extends mJ{static get type(){return"VertexColorNode"}constructor(e){super(null,"vec4"),this.isVertexColorNode=!0,this.index=e}getAttributeName(){const e=this.index;return"color"+(e>0?e:"")}generate(e){const n=this.getAttributeName(e),i=e.hasGeometryAttribute(n);let s;return i===!0?s=super.generate(e):s=e.generateConst(this.nodeType,new Nt(1,1,1,1)),s}serialize(e){super.serialize(e),e.index=this.index}deserialize(e){super.deserialize(e),this.index=e.index}}const sDe=(r=0)=>Le(new iDe(r));class mi extends cs{static get type(){return"NodeMaterial"}get type(){return this.constructor.type}set type(e){}constructor(){super(),this.isNodeMaterial=!0,this.fog=!0,this.lights=!1,this.hardwareClipping=!1,this.lightsNode=null,this.envNode=null,this.aoNode=null,this.colorNode=null,this.normalNode=null,this.opacityNode=null,this.backdropNode=null,this.backdropAlphaNode=null,this.alphaTestNode=null,this.positionNode=null,this.geometryNode=null,this.depthNode=null,this.receivedShadowPositionNode=null,this.castShadowPositionNode=null,this.receivedShadowNode=null,this.castShadowNode=null,this.outputNode=null,this.mrtNode=null,this.fragmentNode=null,this.vertexNode=null,Object.defineProperty(this,"shadowPositionNode",{get:()=>this.receivedShadowPositionNode,set:e=>{console.warn('THREE.NodeMaterial: ".shadowPositionNode" was renamed to ".receivedShadowPositionNode".'),this.receivedShadowPositionNode=e}})}customProgramCacheKey(){return this.type+FQ(this)}build(e){this.setup(e)}setupObserver(e){return new JPe(e)}setup(e){e.context.setupNormal=()=>this.setupNormal(e),e.context.setupPositionView=()=>this.setupPositionView(e),e.context.setupModelViewProjection=()=>this.setupModelViewProjection(e);const n=e.renderer,i=n.getRenderTarget();e.addStack();const s=this.vertexNode||this.setupVertex(e);e.stack.outputNode=s,this.setupHardwareClipping(e),this.geometryNode!==null&&(e.stack.outputNode=e.stack.outputNode.bypass(this.geometryNode)),e.addFlow("vertex",e.removeStack()),e.addStack();let o;const a=this.setupClipping(e);if((this.depthWrite===!0||this.depthTest===!0)&&(i!==null?i.depthBuffer===!0&&this.setupDepth(e):n.depth===!0&&this.setupDepth(e)),this.fragmentNode===null){this.setupDiffuseColor(e),this.setupVariants(e);const l=this.setupLighting(e);a!==null&&e.stack.add(a);const c=jt(l,bn.a).max(0);o=this.setupOutput(e,c),$0.assign(o);const u=this.outputNode!==null;if(u&&(o=this.outputNode),i!==null){const h=n.getMRT(),f=this.mrtNode;h!==null?(u&&$0.assign(o),o=h,f!==null&&(o=h.merge(f))):f!==null&&(o=f)}}else{let l=this.fragmentNode;l.isOutputStructNode!==!0&&(l=jt(l)),o=this.setupOutput(e,l)}e.stack.outputNode=o,e.addFlow("fragment",e.removeStack()),e.observer=this.setupObserver(e)}setupClipping(e){if(e.clippingContext===null)return null;const{unionPlanes:n,intersectionPlanes:i}=e.clippingContext;let s=null;if(n.length>0||i.length>0){const o=e.renderer.samples;this.alphaToCoverage&&o>1?s=eDe():e.stack.add(JOe())}return s}setupHardwareClipping(e){if(this.hardwareClipping=!1,e.clippingContext===null)return;const n=e.clippingContext.unionPlanes.length;n>0&&n<=8&&e.isAvailable("clipDistance")&&(e.stack.add(tDe()),this.hardwareClipping=!0)}setupDepth(e){const{renderer:n,camera:i}=e;let s=this.depthNode;if(s===null){const o=n.getMRT();o&&o.has("depth")?s=o.get("depth"):n.logarithmicDepthBuffer===!0&&(i.isPerspectiveCamera?s=OJ(Kr.z,Df,kf):s=V0(Kr.z,Df,kf))}s!==null&&kJ.assign(s).toStack()}setupPositionView(){return xA.mul(os).xyz}setupModelViewProjection(){return $3.mul(Kr)}setupVertex(e){return e.addStack(),this.setupPosition(e),e.context.vertex=e.removeStack(),CJ}setupPosition(e){const{object:n,geometry:i}=e;if((i.morphAttributes.position||i.morphAttributes.normal||i.morphAttributes.color)&&GOe(n).toStack(),n.isSkinnedMesh===!0&&UOe(n).toStack(),this.displacementMap){const s=eh("displacementMap","texture"),o=eh("displacementScale","float"),a=eh("displacementBias","float");os.addAssign(Ul.normalize().mul(s.x.mul(o).add(a)))}return n.isBatchedMesh&&FOe(n).toStack(),n.isInstancedMesh&&n.instanceMatrix&&n.instanceMatrix.isInstancedBufferAttribute===!0&&IOe(n).toStack(),this.positionNode!==null&&os.assign(this.positionNode.context({isPositionNodeInput:!0})),os}setupDiffuseColor({object:e,geometry:n}){let i=this.colorNode?jt(this.colorNode):tOe;this.vertexColors===!0&&n.hasAttribute("color")&&(i=i.mul(sDe())),e.instanceColor&&(i=hE("vec3","vInstanceColor").mul(i)),e.isBatchedMesh&&e._colorsTexture&&(i=hE("vec3","vBatchColor").mul(i)),bn.assign(i);const s=this.opacityNode?Te(this.opacityNode):MJ;if(bn.a.assign(bn.a.mul(s)),this.alphaTestNode!==null||this.alphaTest>0){const o=this.alphaTestNode!==null?Te(this.alphaTestNode):eOe;bn.a.lessThanEqual(o).discard()}this.alphaHash===!0&&bn.a.lessThan(rDe(os)).discard(),this.transparent===!1&&this.blending===Ro&&this.alphaToCoverage===!1&&bn.a.assign(1)}setupVariants(){}setupOutgoingLight(){return this.lights===!0?Ae(0):bn.rgb}setupNormal(){return this.normalNode?Ae(this.normalNode):lOe}setupEnvironment(){let e=null;return this.envNode?e=this.envNode:this.envMap&&(e=this.envMap.isCubeTexture?eh("envMap","cubeTexture"):eh("envMap","texture")),e}setupLightMap(e){let n=null;return e.material.lightMap&&(n=new XOe(AJ)),n}setupLights(e){const n=[],i=this.setupEnvironment(e);i&&i.isLightingNode&&n.push(i);const s=this.setupLightMap(e);if(s&&s.isLightingNode&&n.push(s),this.aoNode!==null||e.material.aoMap){const a=this.aoNode!==null?this.aoNode:ROe;n.push(new HOe(a))}let o=this.lightsNode||e.lightsNode;return n.length>0&&(o=e.renderer.lighting.createNode([...o.getLights(),...n])),o}setupLightingModel(){}setupLighting(e){const{material:n}=e,{backdropNode:i,backdropAlphaNode:s,emissiveNode:o}=this,l=this.lights===!0||this.lightsNode!==null?this.setupLights(e):null;let c=this.setupOutgoingLight(e);if(l&&l.getScope().hasLights){const u=this.setupLightingModel(e)||null;c=qOe(l,u,i,s)}else i!==null&&(c=Ae(s!==null?Yn(c,i,s):i));return(o&&o.isNode===!0||n.emissive&&n.emissive.isColor===!0)&&(FG.assign(Ae(o||rOe)),c=c.add(FG)),c}setupFog(e,n){const i=e.fogNode;return i&&($0.assign(n),n=jt(i)),n}setupOutput(e,n){return this.fog===!0&&(n=this.setupFog(e,n)),n}setDefaultValues(e){for(const i in e){const s=e[i];this[i]===void 0&&(this[i]=s,s&&s.clone&&(this[i]=s.clone()))}const n=Object.getOwnPropertyDescriptors(e.constructor.prototype);for(const i in n)Object.getOwnPropertyDescriptor(this.constructor.prototype,i)===void 0&&n[i].get!==void 0&&Object.defineProperty(this.constructor.prototype,i,n[i])}toJSON(e){const n=e===void 0||typeof e=="string";n&&(e={textures:{},images:{},nodes:{}});const i=cs.prototype.toJSON.call(this,e),s=lE(this);i.inputNodes={};for(const{property:a,childNode:l}of s)i.inputNodes[a]=l.toJSON(e).uuid;function o(a){const l=[];for(const c in a){const u=a[c];delete u.metadata,l.push(u)}return l}if(n){const a=o(e.textures),l=o(e.images),c=o(e.nodes);a.length>0&&(i.textures=a),l.length>0&&(i.images=l),c.length>0&&(i.nodes=c)}return i}copy(e){return this.lightsNode=e.lightsNode,this.envNode=e.envNode,this.colorNode=e.colorNode,this.normalNode=e.normalNode,this.opacityNode=e.opacityNode,this.backdropNode=e.backdropNode,this.backdropAlphaNode=e.backdropAlphaNode,this.alphaTestNode=e.alphaTestNode,this.positionNode=e.positionNode,this.geometryNode=e.geometryNode,this.depthNode=e.depthNode,this.receivedShadowPositionNode=e.receivedShadowPositionNode,this.castShadowPositionNode=e.castShadowPositionNode,this.receivedShadowNode=e.receivedShadowNode,this.castShadowNode=e.castShadowNode,this.outputNode=e.outputNode,this.mrtNode=e.mrtNode,this.fragmentNode=e.fragmentNode,this.vertexNode=e.vertexNode,super.copy(e)}}const oDe=new p_;class aDe extends mi{static get type(){return"LineBasicNodeMaterial"}constructor(e){super(),this.isLineBasicNodeMaterial=!0,this.setDefaultValues(oDe),this.setValues(e)}}const lDe=new x0e;class cDe extends mi{static get type(){return"LineDashedNodeMaterial"}constructor(e){super(),this.isLineDashedNodeMaterial=!0,this.setDefaultValues(lDe),this.dashOffset=0,this.offsetNode=null,this.dashScaleNode=null,this.dashSizeNode=null,this.gapSizeNode=null,this.setValues(e)}setupVariants(){const e=this.offsetNode?Te(this.offsetNode):AOe,n=this.dashScaleNode?Te(this.dashScaleNode):TOe,i=this.dashSizeNode?Te(this.dashSizeNode):EOe,s=this.gapSizeNode?Te(this.gapSizeNode):MOe;QR.assign(i),BG.assign(s);const o=ol(Dh("lineDistance").mul(n));(e?o.add(e):o).mod(QR.add(BG)).greaterThan(QR).discard()}}const uDe=r=>Le(r).mul(.5).add(.5),hDe=new m0e;class fDe extends mi{static get type(){return"MeshNormalNodeMaterial"}constructor(e){super(),this.isMeshNormalNodeMaterial=!0,this.setDefaultValues(hDe),this.setValues(e)}setupDiffuseColor(){const e=this.opacityNode?Te(this.opacityNode):MJ;bn.assign(U3(jt(uDe(qr),e),vt))}}class dDe extends Qr{static get type(){return"EquirectUVNode"}constructor(e=xJ){super("vec2"),this.dirNode=e}setup(){const e=this.dirNode,n=e.z.atan(e.x).mul(1/(Math.PI*2)).add(.5),i=e.y.clamp(-1,1).asin().mul(1/Math.PI).add(.5);return Ve(n,i)}}const IJ=Ne(dDe).setParameterLength(0,1);class LJ extends CY{constructor(e=1,n={}){super(e,n),this.isCubeRenderTarget=!0}fromEquirectangularTexture(e,n){const i=n.minFilter,s=n.generateMipmaps;n.generateMipmaps=!0,this.texture.type=n.type,this.texture.colorSpace=n.colorSpace,this.texture.generateMipmaps=n.generateMipmaps,this.texture.minFilter=n.minFilter,this.texture.magFilter=n.magFilter;const o=new Dl(5,5,5),a=IJ(xJ),l=new mi;l.colorNode=cn(n,a,0),l.side=Fn,l.blending=ro;const c=new Jn(o,l),u=new QM;u.add(c),n.minFilter===Ks&&(n.minFilter=li);const h=new AY(1,10,this),f=e.getMRT();return e.setMRT(null),h.update(e,u),e.setMRT(f),n.minFilter=i,n.currentGenerateMipmaps=s,c.geometry.dispose(),c.material.dispose(),this}}const G0=new WeakMap;class pDe extends Qr{static get type(){return"CubeMapNode"}constructor(e){super("vec3"),this.envNode=e,this._cubeTexture=null,this._cubeTextureNode=ub(null);const n=new ZM;n.isRenderTargetTexture=!0,this._defaultTexture=n,this.updateBeforeType=Jt.RENDER}updateBefore(e){const{renderer:n,material:i}=e,s=this.envNode;if(s.isTextureNode||s.isMaterialReferenceNode){const o=s.isTextureNode?s.value:i[s.property];if(o&&o.isTexture){const a=o.mapping;if(a===dd||a===pd){if(G0.has(o)){const l=G0.get(o);t5(l,o.mapping),this._cubeTexture=l}else{const l=o.image;if(mDe(l)){const c=new LJ(l.height);c.fromEquirectangularTexture(n,o),t5(c.texture,o.mapping),this._cubeTexture=c.texture,G0.set(o,c.texture),o.addEventListener("dispose",FJ)}else this._cubeTexture=this._defaultTexture}this._cubeTextureNode.value=this._cubeTexture}else this._cubeTextureNode=this.envNode}}}setup(e){return this.updateBefore(e),this._cubeTextureNode}}function mDe(r){return r==null?!1:r.height>0}function FJ(r){const e=r.target;e.removeEventListener("dispose",FJ);const n=G0.get(e);n!==void 0&&(G0.delete(e),n.dispose())}function t5(r,e){e===dd?r.mapping=tl:e===pd&&(r.mapping=nl)}const BJ=Ne(pDe).setParameterLength(1);class W3 extends Ey{static get type(){return"BasicEnvironmentNode"}constructor(e=null){super(),this.envNode=e}setup(e){e.context.environment=BJ(this.envNode)}}class gDe extends Ey{static get type(){return"BasicLightMapNode"}constructor(e=null){super(),this.lightMapNode=e}setup(e){const n=Te(1/Math.PI);e.context.irradianceLightMap=this.lightMapNode.mul(n)}}class SA{start(e){e.lightsNode.setupLights(e,e.lightsNode.getLightNodes(e)),this.indirect(e)}finish(){}direct(){}directRectArea(){}indirect(){}ambientOcclusion(){}}class UJ extends SA{constructor(){super()}indirect({context:e}){const n=e.ambientOcclusion,i=e.reflectedLight,s=e.irradianceLightMap;i.indirectDiffuse.assign(jt(0)),s?i.indirectDiffuse.addAssign(s):i.indirectDiffuse.addAssign(jt(1,1,1,0)),i.indirectDiffuse.mulAssign(n),i.indirectDiffuse.mulAssign(bn.rgb)}finish(e){const{material:n,context:i}=e,s=i.outgoingLight,o=e.context.environment;if(o)switch(n.combine){case c_:s.rgb.assign(Yn(s.rgb,s.rgb.mul(o.rgb),z1.mul(tN)));break;case dY:s.rgb.assign(Yn(s.rgb,o.rgb,z1.mul(tN)));break;case pY:s.rgb.addAssign(o.rgb.mul(z1.mul(tN)));break;default:console.warn("THREE.BasicLightingModel: Unsupported .combine value:",n.combine);break}}}const yDe=new As;class vDe extends mi{static get type(){return"MeshBasicNodeMaterial"}constructor(e){super(),this.isMeshBasicNodeMaterial=!0,this.lights=!0,this.setDefaultValues(yDe),this.setValues(e)}setupNormal(){return il}setupEnvironment(e){const n=super.setupEnvironment(e);return n?new W3(n):null}setupLightMap(e){let n=null;return e.material.lightMap&&(n=new gDe(AJ)),n}setupOutgoingLight(){return bn.rgb}setupLightingModel(){return new UJ}}const hb=Oe(({f0:r,f90:e,dotVH:n})=>{const i=n.mul(-5.55473).sub(6.98316).mul(n).exp2();return r.mul(i.oneMinus()).add(e.mul(i))}),Mg=Oe(r=>r.diffuseColor.mul(1/Math.PI)),xDe=()=>Te(.25),bDe=Oe(({dotNH:r})=>_D.mul(Te(.5)).add(1).mul(Te(1/Math.PI)).mul(r.pow(_D))),_De=Oe(({lightDirection:r})=>{const e=r.add(dr).normalize(),n=qr.dot(e).clamp(),i=dr.dot(e).clamp(),s=hb({f0:bo,f90:1,dotVH:i}),o=xDe(),a=bDe({dotNH:n});return s.mul(o).mul(a)});class zJ extends UJ{constructor(e=!0){super(),this.specular=e}direct({lightDirection:e,lightColor:n,reflectedLight:i}){const o=qr.dot(e).clamp().mul(n);i.directDiffuse.addAssign(o.mul(Mg({diffuseColor:bn.rgb}))),this.specular===!0&&i.directSpecular.addAssign(o.mul(_De({lightDirection:e})).mul(z1))}indirect(e){const{ambientOcclusion:n,irradiance:i,reflectedLight:s}=e.context;s.indirectDiffuse.addAssign(i.mul(Mg({diffuseColor:bn}))),s.indirectDiffuse.mulAssign(n)}}const wDe=new IY;class SDe extends mi{static get type(){return"MeshLambertNodeMaterial"}constructor(e){super(),this.isMeshLambertNodeMaterial=!0,this.lights=!0,this.setDefaultValues(wDe),this.setValues(e)}setupEnvironment(e){const n=super.setupEnvironment(e);return n?new W3(n):null}setupLightingModel(){return new zJ(!1)}}const TDe=new d0e;class EDe extends mi{static get type(){return"MeshPhongNodeMaterial"}constructor(e){super(),this.isMeshPhongNodeMaterial=!0,this.lights=!0,this.shininessNode=null,this.specularNode=null,this.setDefaultValues(TDe),this.setValues(e)}setupEnvironment(e){const n=super.setupEnvironment(e);return n?new W3(n):null}setupLightingModel(){return new zJ}setupVariants(){const e=(this.shininessNode?Te(this.shininessNode):nOe).max(1e-4);_D.assign(e);const n=this.specularNode||iOe;bo.assign(n)}copy(e){return this.shininessNode=e.shininessNode,this.specularNode=e.specularNode,super.copy(e)}}const MDe=Oe(r=>{if(r.geometry.hasAttribute("normal")===!1)return Te(0);const e=il.dFdx().abs().max(il.dFdy().abs());return e.x.max(e.y).max(e.z)}),$J=Oe(r=>{const{roughness:e}=r,n=MDe();let i=e.max(.0525);return i=i.add(n),i=i.min(1),i}),ADe=Oe(({alpha:r,dotNL:e,dotNV:n})=>{const i=r.pow2(),s=e.mul(i.add(i.oneMinus().mul(n.pow2())).sqrt()),o=n.mul(i.add(i.oneMinus().mul(e.pow2())).sqrt());return uu(.5,s.add(o).max(fNe))}).setLayout({name:"V_GGX_SmithCorrelated",type:"float",inputs:[{name:"alpha",type:"float"},{name:"dotNL",type:"float"},{name:"dotNV",type:"float"}]}),CDe=Oe(({alphaT:r,alphaB:e,dotTV:n,dotBV:i,dotTL:s,dotBL:o,dotNV:a,dotNL:l})=>{const c=l.mul(Ae(r.mul(n),e.mul(i),a).length()),u=a.mul(Ae(r.mul(s),e.mul(o),l).length());return uu(.5,c.add(u)).saturate()}).setLayout({name:"V_GGX_SmithCorrelated_Anisotropic",type:"float",inputs:[{name:"alphaT",type:"float",qualifier:"in"},{name:"alphaB",type:"float",qualifier:"in"},{name:"dotTV",type:"float",qualifier:"in"},{name:"dotBV",type:"float",qualifier:"in"},{name:"dotTL",type:"float",qualifier:"in"},{name:"dotBL",type:"float",qualifier:"in"},{name:"dotNV",type:"float",qualifier:"in"},{name:"dotNL",type:"float",qualifier:"in"}]}),PDe=Oe(({alpha:r,dotNH:e})=>{const n=r.pow2(),i=e.pow2().mul(n.oneMinus()).oneMinus();return n.div(i.pow2()).mul(1/Math.PI)}).setLayout({name:"D_GGX",type:"float",inputs:[{name:"alpha",type:"float"},{name:"dotNH",type:"float"}]}),RDe=Te(1/Math.PI),NDe=Oe(({alphaT:r,alphaB:e,dotNH:n,dotTH:i,dotBH:s})=>{const o=r.mul(e),a=Ae(e.mul(i),r.mul(s),o.mul(n)),l=a.dot(a),c=o.div(l);return RDe.mul(o.mul(c.pow2()))}).setLayout({name:"D_GGX_Anisotropic",type:"float",inputs:[{name:"alphaT",type:"float",qualifier:"in"},{name:"alphaB",type:"float",qualifier:"in"},{name:"dotNH",type:"float",qualifier:"in"},{name:"dotTH",type:"float",qualifier:"in"},{name:"dotBH",type:"float",qualifier:"in"}]}),n5=Oe(r=>{const{lightDirection:e,f0:n,f90:i,roughness:s,f:o,USE_IRIDESCENCE:a,USE_ANISOTROPY:l}=r,c=r.normalView||qr,u=s.pow2(),h=e.add(dr).normalize(),f=c.dot(e).clamp(),d=c.dot(dr).clamp(),p=c.dot(h).clamp(),m=dr.dot(h).clamp();let g=hb({f0:n,f90:i,dotVH:m}),v,y;if(LG(a)&&(g=N3.mix(g,o)),LG(l)){const x=I1.dot(e),b=I1.dot(dr),w=I1.dot(h),_=Lm.dot(e),S=Lm.dot(dr),T=Lm.dot(h);v=CDe({alphaT:bD,alphaB:u,dotTV:b,dotBV:S,dotTL:x,dotBL:_,dotNV:d,dotNL:f}),y=NDe({alphaT:bD,alphaB:u,dotNH:p,dotTH:w,dotBH:T})}else v=ADe({alpha:u,dotNL:f,dotNV:d}),y=PDe({alpha:u,dotNH:p});return g.mul(v).mul(y)}),jJ=Oe(({roughness:r,dotNV:e})=>{const n=jt(-1,-.0275,-.572,.022),i=jt(1,.0425,1.04,-.04),s=r.mul(n).add(i),o=s.x.mul(s.x).min(e.mul(-9.28).exp2()).mul(s.x).add(s.y);return Ve(-1.04,1.04).mul(o).add(s.zw)}).setLayout({name:"DFGApprox",type:"vec2",inputs:[{name:"roughness",type:"float"},{name:"dotNV",type:"vec3"}]}),VJ=Oe(r=>{const{dotNV:e,specularColor:n,specularF90:i,roughness:s}=r,o=jJ({dotNV:e,roughness:s});return n.mul(o.x).add(i.mul(o.y))}),ODe=Oe(({f:r,f90:e,dotVH:n})=>{const i=n.oneMinus().saturate(),s=i.mul(i),o=i.mul(s,s).clamp(0,.9999);return r.sub(Ae(e).mul(o)).div(o.oneMinus())}).setLayout({name:"Schlick_to_F0",type:"vec3",inputs:[{name:"f",type:"vec3"},{name:"f90",type:"float"},{name:"dotVH",type:"float"}]}),DDe=Oe(({roughness:r,dotNH:e})=>{const n=r.pow2(),i=Te(1).div(n),o=e.pow2().oneMinus().max(.0078125);return Te(2).add(i).mul(o.pow(i.mul(.5))).div(2*Math.PI)}).setLayout({name:"D_Charlie",type:"float",inputs:[{name:"roughness",type:"float"},{name:"dotNH",type:"float"}]}),kDe=Oe(({dotNV:r,dotNL:e})=>Te(1).div(Te(4).mul(e.add(r).sub(e.mul(r))))).setLayout({name:"V_Neubelt",type:"float",inputs:[{name:"dotNV",type:"float"},{name:"dotNL",type:"float"}]}),IDe=Oe(({lightDirection:r})=>{const e=r.add(dr).normalize(),n=qr.dot(r).clamp(),i=qr.dot(dr).clamp(),s=qr.dot(e).clamp(),o=DDe({roughness:R3,dotNH:s}),a=kDe({dotNV:i,dotNL:n});return hm.mul(o).mul(a)}),LDe=Oe(({N:r,V:e,roughness:n})=>{const o=.0078125,a=r.dot(e).saturate(),l=Ve(n,a.oneMinus().sqrt());return l.assign(l.mul(.984375).add(o)),l}).setLayout({name:"LTC_Uv",type:"vec2",inputs:[{name:"N",type:"vec3"},{name:"V",type:"vec3"},{name:"roughness",type:"float"}]}),FDe=Oe(({f:r})=>{const e=r.length();return ao(e.mul(e).add(r.z).div(e.add(1)),0)}).setLayout({name:"LTC_ClippedSphereFormFactor",type:"float",inputs:[{name:"f",type:"vec3"}]}),AS=Oe(({v1:r,v2:e})=>{const n=r.dot(e),i=n.abs().toVar(),s=i.mul(.0145206).add(.4965155).mul(i).add(.8543985).toVar(),o=i.add(4.1616724).mul(i).add(3.417594).toVar(),a=s.div(o),l=n.greaterThan(0).select(a,ao(n.mul(n).oneMinus(),1e-7).inverseSqrt().mul(.5).sub(a));return r.cross(e).mul(l)}).setLayout({name:"LTC_EdgeVectorFormFactor",type:"vec3",inputs:[{name:"v1",type:"vec3"},{name:"v2",type:"vec3"}]}),r5=Oe(({N:r,V:e,P:n,mInv:i,p0:s,p1:o,p2:a,p3:l})=>{const c=o.sub(s).toVar(),u=l.sub(s).toVar(),h=c.cross(u),f=Ae().toVar();return kr(h.dot(n.sub(s)).greaterThanEqual(0),()=>{const d=e.sub(r.mul(e.dot(r))).normalize(),p=r.cross(d).negate(),m=i.mul(Ds(d,p,r).transpose()).toVar(),g=m.mul(s.sub(n)).normalize().toVar(),v=m.mul(o.sub(n)).normalize().toVar(),y=m.mul(a.sub(n)).normalize().toVar(),x=m.mul(l.sub(n)).normalize().toVar(),b=Ae(0).toVar();b.addAssign(AS({v1:g,v2:v})),b.addAssign(AS({v1:v,v2:y})),b.addAssign(AS({v1:y,v2:x})),b.addAssign(AS({v1:x,v2:g})),f.assign(Ae(FDe({f:b})))}),f}).setLayout({name:"LTC_Evaluate",type:"vec3",inputs:[{name:"N",type:"vec3"},{name:"V",type:"vec3"},{name:"P",type:"vec3"},{name:"mInv",type:"mat3"},{name:"p0",type:"vec3"},{name:"p1",type:"vec3"},{name:"p2",type:"vec3"},{name:"p3",type:"vec3"}]}),TA=1/6,GJ=r=>rn(TA,rn(r,rn(r,r.negate().add(3)).sub(3)).add(1)),TD=r=>rn(TA,rn(r,rn(r,rn(3,r).sub(6))).add(4)),HJ=r=>rn(TA,rn(r,rn(r,rn(-3,r).add(3)).add(3)).add(1)),ED=r=>rn(TA,gA(r,3)),i5=r=>GJ(r).add(TD(r)),s5=r=>HJ(r).add(ED(r)),o5=r=>ks(-1,TD(r).div(GJ(r).add(TD(r)))),a5=r=>ks(1,ED(r).div(HJ(r).add(ED(r)))),l5=(r,e,n)=>{const i=r.uvNode,s=rn(i,e.zw).add(.5),o=id(s),a=Xh(s),l=i5(a.x),c=s5(a.x),u=o5(a.x),h=a5(a.x),f=o5(a.y),d=a5(a.y),p=Ve(o.x.add(u),o.y.add(f)).sub(.5).mul(e.xy),m=Ve(o.x.add(h),o.y.add(f)).sub(.5).mul(e.xy),g=Ve(o.x.add(u),o.y.add(d)).sub(.5).mul(e.xy),v=Ve(o.x.add(h),o.y.add(d)).sub(.5).mul(e.xy),y=i5(a.y).mul(ks(l.mul(r.sample(p).level(n)),c.mul(r.sample(m).level(n)))),x=s5(a.y).mul(ks(l.mul(r.sample(g).level(n)),c.mul(r.sample(v).level(n))));return y.add(x)},BDe=Oe(([r,e=Te(3)])=>{const n=Ve(r.size(zn(e))),i=Ve(r.size(zn(e.add(1)))),s=uu(1,n),o=uu(1,i),a=l5(r,jt(s,n),id(e)),l=l5(r,jt(o,i),k3(e));return Xh(e).mix(a,l)}),c5=Oe(([r,e,n,i,s])=>{const o=Ae(hJ(e.negate(),ab(r),uu(1,i))),a=Ae(wh(s[0].xyz),wh(s[1].xyz),wh(s[2].xyz));return ab(o).mul(n.mul(a))}).setLayout({name:"getVolumeTransmissionRay",type:"vec3",inputs:[{name:"n",type:"vec3"},{name:"v",type:"vec3"},{name:"thickness",type:"float"},{name:"ior",type:"float"},{name:"modelMatrix",type:"mat4"}]}),UDe=Oe(([r,e])=>r.mul(hu(e.mul(2).sub(2),0,1))).setLayout({name:"applyIorToRoughness",type:"float",inputs:[{name:"roughness",type:"float"},{name:"ior",type:"float"}]}),zDe=RJ(),$De=RJ(),u5=Oe(([r,e,n],{material:i})=>{const o=(i.side===Fn?zDe:$De).sample(r),a=Xc(SD.x).mul(UDe(e,n));return BDe(o,a)}),h5=Oe(([r,e,n])=>(kr(n.notEqual(0),()=>{const i=rJ(e).negate().div(n);return nJ(i.negate().mul(r))}),Ae(1))).setLayout({name:"volumeAttenuation",type:"vec3",inputs:[{name:"transmissionDistance",type:"float"},{name:"attenuationColor",type:"vec3"},{name:"attenuationDistance",type:"float"}]}),jDe=Oe(([r,e,n,i,s,o,a,l,c,u,h,f,d,p,m])=>{let g,v;if(m){g=jt().toVar(),v=Ae().toVar();const _=h.sub(1).mul(m.mul(.025)),S=Ae(h.sub(_),h,h.add(_));Wa({start:0,end:3},({i:T})=>{const E=S.element(T),M=c5(r,e,f,E,l),A=a.add(M),P=u.mul(c.mul(jt(A,1))),D=Ve(P.xy.div(P.w)).toVar();D.addAssign(1),D.divAssign(2),D.assign(Ve(D.x,D.y.oneMinus()));const B=u5(D,n,E);g.element(T).assign(B.element(T)),g.a.addAssign(B.a),v.element(T).assign(i.element(T).mul(h5(wh(M),d,p).element(T)))}),g.a.divAssign(3)}else{const _=c5(r,e,f,h,l),S=a.add(_),T=u.mul(c.mul(jt(S,1))),E=Ve(T.xy.div(T.w)).toVar();E.addAssign(1),E.divAssign(2),E.assign(Ve(E.x,E.y.oneMinus())),g=u5(E,n,h),v=i.mul(h5(wh(_),d,p))}const y=v.rgb.mul(g.rgb),x=r.dot(e).clamp(),b=Ae(VJ({dotNV:x,specularColor:s,specularF90:o,roughness:n})),w=v.r.add(v.g,v.b).div(3);return jt(b.oneMinus().mul(y),g.a.oneMinus().mul(w).oneMinus())}),VDe=Ds(3.2404542,-.969266,.0556434,-1.5371385,1.8760108,-.2040259,-.4985314,.041556,1.0572252),GDe=r=>{const e=r.sqrt();return Ae(1).add(e).div(Ae(1).sub(e))},f5=(r,e)=>r.sub(e).div(r.add(e)).pow2(),HDe=(r,e)=>{const n=r.mul(2*Math.PI*1e-9),i=Ae(54856e-17,44201e-17,52481e-17),s=Ae(1681e3,1795300,2208400),o=Ae(43278e5,93046e5,66121e5),a=Te(9747e-17*Math.sqrt(2*Math.PI*45282e5)).mul(n.mul(2239900).add(e.x).cos()).mul(n.pow2().mul(-45282e5).exp());let l=i.mul(o.mul(2*Math.PI).sqrt()).mul(s.mul(n).add(e).cos()).mul(n.pow2().negate().mul(o).exp());return l=Ae(l.x.add(a),l.y,l.z).div(10685e-11),VDe.mul(l)},WDe=Oe(({outsideIOR:r,eta2:e,cosTheta1:n,thinFilmThickness:i,baseF0:s})=>{const o=Yn(r,e,Oh(0,.03,i)),l=r.div(o).pow2().mul(n.pow2().oneMinus()).oneMinus();kr(l.lessThan(0),()=>Ae(1));const c=l.sqrt(),u=f5(o,r),h=hb({f0:u,f90:1,dotVH:n}),f=h.oneMinus(),d=o.lessThan(r).select(Math.PI,0),p=Te(Math.PI).sub(d),m=GDe(s.clamp(0,.9999)),g=f5(m,o.toVec3()),v=hb({f0:g,f90:1,dotVH:c}),y=Ae(m.x.lessThan(o).select(Math.PI,0),m.y.lessThan(o).select(Math.PI,0),m.z.lessThan(o).select(Math.PI,0)),x=o.mul(i,c,2),b=Ae(p).add(y),w=h.mul(v).clamp(1e-5,.9999),_=w.sqrt(),S=f.pow2().mul(v).div(Ae(1).sub(w)),E=h.add(S).toVar(),M=S.sub(f).toVar();return Wa({start:1,end:2,condition:"<=",name:"m"},({m:A})=>{M.mulAssign(_);const P=HDe(Te(A).mul(x),Te(A).mul(b)).mul(2);E.addAssign(M.mul(P))}),E.max(Ae(0))}).setLayout({name:"evalIridescence",type:"vec3",inputs:[{name:"outsideIOR",type:"float"},{name:"eta2",type:"float"},{name:"cosTheta1",type:"float"},{name:"thinFilmThickness",type:"float"},{name:"baseF0",type:"vec3"}]}),qDe=Oe(({normal:r,viewDir:e,roughness:n})=>{const i=r.dot(e).saturate(),s=n.pow2(),o=Ns(n.lessThan(.25),Te(-339.2).mul(s).add(Te(161.4).mul(n)).sub(25.9),Te(-8.48).mul(s).add(Te(14.3).mul(n)).sub(9.95)),a=Ns(n.lessThan(.25),Te(44).mul(s).sub(Te(23.7).mul(n)).add(3.26),Te(1.97).mul(s).sub(Te(3.27).mul(n)).add(.72));return Ns(n.lessThan(.25),0,Te(.1).mul(n).sub(.025)).add(o.mul(i).add(a).exp()).mul(1/Math.PI).saturate()}),iN=Ae(.04),sN=Te(1);class WJ extends SA{constructor(e=!1,n=!1,i=!1,s=!1,o=!1,a=!1){super(),this.clearcoat=e,this.sheen=n,this.iridescence=i,this.anisotropy=s,this.transmission=o,this.dispersion=a,this.clearcoatRadiance=null,this.clearcoatSpecularDirect=null,this.clearcoatSpecularIndirect=null,this.sheenSpecularDirect=null,this.sheenSpecularIndirect=null,this.iridescenceFresnel=null,this.iridescenceF0=null}start(e){if(this.clearcoat===!0&&(this.clearcoatRadiance=Ae().toVar("clearcoatRadiance"),this.clearcoatSpecularDirect=Ae().toVar("clearcoatSpecularDirect"),this.clearcoatSpecularIndirect=Ae().toVar("clearcoatSpecularIndirect")),this.sheen===!0&&(this.sheenSpecularDirect=Ae().toVar("sheenSpecularDirect"),this.sheenSpecularIndirect=Ae().toVar("sheenSpecularIndirect")),this.iridescence===!0){const n=qr.dot(dr).clamp();this.iridescenceFresnel=WDe({outsideIOR:Te(1),eta2:qQ,cosTheta1:n,thinFilmThickness:XQ,baseF0:bo}),this.iridescenceF0=ODe({f:this.iridescenceFresnel,f90:1,dotVH:n})}if(this.transmission===!0){const n=cb,i=P2e.sub(cb).normalize(),s=j3,o=e.context;o.backdrop=jDe(s,i,Cc,bn,bo,pE,n,wd,bu,$3,L1,KQ,ZQ,YQ,this.dispersion?QQ:null),o.backdropAlpha=wD,bn.a.mulAssign(Yn(1,o.backdrop.a,wD))}super.start(e)}computeMultiscattering(e,n,i){const s=qr.dot(dr).clamp(),o=jJ({roughness:Cc,dotNV:s}),l=(this.iridescenceF0?N3.mix(bo,this.iridescenceF0):bo).mul(o.x).add(i.mul(o.y)),u=o.x.add(o.y).oneMinus(),h=bo.add(bo.oneMinus().mul(.047619)),f=l.mul(h).div(u.mul(h).oneMinus());e.addAssign(l),n.addAssign(f.mul(u))}direct({lightDirection:e,lightColor:n,reflectedLight:i}){const o=qr.dot(e).clamp().mul(n);if(this.sheen===!0&&this.sheenSpecularDirect.addAssign(o.mul(IDe({lightDirection:e}))),this.clearcoat===!0){const l=c0.dot(e).clamp().mul(n);this.clearcoatSpecularDirect.addAssign(l.mul(n5({lightDirection:e,f0:iN,f90:sN,roughness:dE,normalView:c0})))}i.directDiffuse.addAssign(o.mul(Mg({diffuseColor:bn.rgb}))),i.directSpecular.addAssign(o.mul(n5({lightDirection:e,f0:bo,f90:1,roughness:Cc,iridescence:this.iridescence,f:this.iridescenceFresnel,USE_IRIDESCENCE:this.iridescence,USE_ANISOTROPY:this.anisotropy})))}directRectArea({lightColor:e,lightPosition:n,halfWidth:i,halfHeight:s,reflectedLight:o,ltc_1:a,ltc_2:l}){const c=n.add(i).sub(s),u=n.sub(i).sub(s),h=n.sub(i).add(s),f=n.add(i).add(s),d=qr,p=dr,m=Kr.toVar(),g=LDe({N:d,V:p,roughness:Cc}),v=a.sample(g).toVar(),y=l.sample(g).toVar(),x=Ds(Ae(v.x,0,v.y),Ae(0,1,0),Ae(v.z,0,v.w)).toVar(),b=bo.mul(y.x).add(bo.oneMinus().mul(y.y)).toVar();o.directSpecular.addAssign(e.mul(b).mul(r5({N:d,V:p,P:m,mInv:x,p0:c,p1:u,p2:h,p3:f}))),o.directDiffuse.addAssign(e.mul(bn).mul(r5({N:d,V:p,P:m,mInv:Ds(1,0,0,0,1,0,0,0,1),p0:c,p1:u,p2:h,p3:f})))}indirect(e){this.indirectDiffuse(e),this.indirectSpecular(e),this.ambientOcclusion(e)}indirectDiffuse(e){const{irradiance:n,reflectedLight:i}=e.context;i.indirectDiffuse.addAssign(n.mul(Mg({diffuseColor:bn})))}indirectSpecular(e){const{radiance:n,iblIrradiance:i,reflectedLight:s}=e.context;if(this.sheen===!0&&this.sheenSpecularIndirect.addAssign(i.mul(hm,qDe({normal:qr,viewDir:dr,roughness:R3}))),this.clearcoat===!0){const h=c0.dot(dr).clamp(),f=VJ({dotNV:h,specularColor:iN,specularF90:sN,roughness:dE});this.clearcoatSpecularIndirect.addAssign(this.clearcoatRadiance.mul(f))}const o=Ae().toVar("singleScattering"),a=Ae().toVar("multiScattering"),l=i.mul(1/Math.PI);this.computeMultiscattering(o,a,pE);const c=o.add(a),u=bn.mul(c.r.max(c.g).max(c.b).oneMinus());s.indirectSpecular.addAssign(n.mul(o)),s.indirectSpecular.addAssign(a.mul(l)),s.indirectDiffuse.addAssign(u.mul(l))}ambientOcclusion(e){const{ambientOcclusion:n,reflectedLight:i}=e.context,o=qr.dot(dr).clamp().add(n),a=Cc.mul(-16).oneMinus().negate().exp2(),l=n.sub(o.pow(a).oneMinus()).clamp();this.clearcoat===!0&&this.clearcoatSpecularIndirect.mulAssign(n),this.sheen===!0&&this.sheenSpecularIndirect.mulAssign(n),i.indirectDiffuse.mulAssign(n),i.indirectSpecular.mulAssign(l)}finish({context:e}){const{outgoingLight:n}=e;if(this.clearcoat===!0){const i=c0.dot(dr).clamp(),s=hb({dotVH:i,f0:iN,f90:sN}),o=n.mul(xD.mul(s).oneMinus()).add(this.clearcoatSpecularDirect.add(this.clearcoatSpecularIndirect).mul(xD));n.assign(o)}if(this.sheen===!0){const i=hm.r.max(hm.g).max(hm.b).mul(.157).oneMinus(),s=n.mul(i).add(this.sheenSpecularDirect,this.sheenSpecularIndirect);n.assign(s)}}}const d5=Te(1),MD=Te(-2),CS=Te(.8),oN=Te(-1),PS=Te(.4),aN=Te(2),RS=Te(.305),lN=Te(3),p5=Te(.21),XDe=Te(4),m5=Te(4),KDe=Te(16),YDe=Oe(([r])=>{const e=Ae(Jo(r)).toVar(),n=Te(-1).toVar();return kr(e.x.greaterThan(e.z),()=>{kr(e.x.greaterThan(e.y),()=>{n.assign(Ns(r.x.greaterThan(0),0,3))}).Else(()=>{n.assign(Ns(r.y.greaterThan(0),1,4))})}).Else(()=>{kr(e.z.greaterThan(e.y),()=>{n.assign(Ns(r.z.greaterThan(0),2,5))}).Else(()=>{n.assign(Ns(r.y.greaterThan(0),1,4))})}),n}).setLayout({name:"getFace",type:"float",inputs:[{name:"direction",type:"vec3"}]}),ZDe=Oe(([r,e])=>{const n=Ve().toVar();return kr(e.equal(0),()=>{n.assign(Ve(r.z,r.y).div(Jo(r.x)))}).ElseIf(e.equal(1),()=>{n.assign(Ve(r.x.negate(),r.z.negate()).div(Jo(r.y)))}).ElseIf(e.equal(2),()=>{n.assign(Ve(r.x.negate(),r.y).div(Jo(r.z)))}).ElseIf(e.equal(3),()=>{n.assign(Ve(r.z.negate(),r.y).div(Jo(r.x)))}).ElseIf(e.equal(4),()=>{n.assign(Ve(r.x.negate(),r.z).div(Jo(r.y)))}).Else(()=>{n.assign(Ve(r.x,r.y).div(Jo(r.z)))}),rn(.5,n.add(1))}).setLayout({name:"getUV",type:"vec2",inputs:[{name:"direction",type:"vec3"},{name:"face",type:"float"}]}),QDe=Oe(([r])=>{const e=Te(0).toVar();return kr(r.greaterThanEqual(CS),()=>{e.assign(d5.sub(r).mul(oN.sub(MD)).div(d5.sub(CS)).add(MD))}).ElseIf(r.greaterThanEqual(PS),()=>{e.assign(CS.sub(r).mul(aN.sub(oN)).div(CS.sub(PS)).add(oN))}).ElseIf(r.greaterThanEqual(RS),()=>{e.assign(PS.sub(r).mul(lN.sub(aN)).div(PS.sub(RS)).add(aN))}).ElseIf(r.greaterThanEqual(p5),()=>{e.assign(RS.sub(r).mul(XDe.sub(lN)).div(RS.sub(p5)).add(lN))}).Else(()=>{e.assign(Te(-2).mul(Xc(rn(1.16,r))))}),e}).setLayout({name:"roughnessToMip",type:"float",inputs:[{name:"roughness",type:"float"}]}),JDe=Oe(([r,e])=>{const n=r.toVar();n.assign(rn(2,n).sub(1));const i=Ae(n,1).toVar();return kr(e.equal(0),()=>{i.assign(i.zyx)}).ElseIf(e.equal(1),()=>{i.assign(i.xzy),i.xz.mulAssign(-1)}).ElseIf(e.equal(2),()=>{i.x.mulAssign(-1)}).ElseIf(e.equal(3),()=>{i.assign(i.zyx),i.xz.mulAssign(-1)}).ElseIf(e.equal(4),()=>{i.assign(i.xzy),i.xy.mulAssign(-1)}).ElseIf(e.equal(5),()=>{i.z.mulAssign(-1)}),i}).setLayout({name:"getDirection",type:"vec3",inputs:[{name:"uv",type:"vec2"},{name:"face",type:"float"}]}),eke=Oe(([r,e,n,i,s,o])=>{const a=Te(n),l=Ae(e),c=hu(QDe(a),MD,o),u=Xh(c),h=id(c),f=Ae(AD(r,l,h,i,s,o)).toVar();return kr(u.notEqual(0),()=>{const d=Ae(AD(r,l,h.add(1),i,s,o)).toVar();f.assign(Yn(f,d,u))}),f}),AD=Oe(([r,e,n,i,s,o])=>{const a=Te(n).toVar(),l=Ae(e),c=Te(YDe(l)).toVar(),u=Te(ao(m5.sub(a),0)).toVar();a.assign(ao(a,m5));const h=Te(ob(a)).toVar(),f=Ve(ZDe(l,c).mul(h.sub(2)).add(1)).toVar();return kr(c.greaterThan(2),()=>{f.y.addAssign(h),c.subAssign(3)}),f.x.addAssign(c.mul(h)),f.x.addAssign(u.mul(rn(3,KDe))),f.y.addAssign(rn(4,ob(o).sub(h))),f.x.mulAssign(i),f.y.mulAssign(s),r.sample(f).grad(Ve(),Ve())}),cN=Oe(({envMap:r,mipInt:e,outputDirection:n,theta:i,axis:s,CUBEUV_TEXEL_WIDTH:o,CUBEUV_TEXEL_HEIGHT:a,CUBEUV_MAX_MIP:l})=>{const c=Ku(i),u=n.mul(c).add(s.cross(n).mul(ja(i))).add(s.mul(s.dot(n).mul(c.oneMinus())));return AD(r,u,e,o,a,l)}),tke=Oe(({n:r,latitudinal:e,poleAxis:n,outputDirection:i,weights:s,samples:o,dTheta:a,mipInt:l,envMap:c,CUBEUV_TEXEL_WIDTH:u,CUBEUV_TEXEL_HEIGHT:h,CUBEUV_MAX_MIP:f})=>{const d=Ae(Ns(e,n,lJ(n,i))).toVar();kr(d.equal(Ae(0)),()=>{d.assign(Ae(i.z,0,i.x.negate()))}),d.assign(ab(d));const p=Ae().toVar();return p.addAssign(s.element(0).mul(cN({theta:0,axis:d,outputDirection:i,mipInt:l,envMap:c,CUBEUV_TEXEL_WIDTH:u,CUBEUV_TEXEL_HEIGHT:h,CUBEUV_MAX_MIP:f}))),Wa({start:zn(1),end:r},({i:m})=>{kr(m.greaterThanEqual(o),()=>{$Oe()});const g=Te(a.mul(Te(m))).toVar();p.addAssign(s.element(m).mul(cN({theta:g.mul(-1),axis:d,outputDirection:i,mipInt:l,envMap:c,CUBEUV_TEXEL_WIDTH:u,CUBEUV_TEXEL_HEIGHT:h,CUBEUV_MAX_MIP:f}))),p.addAssign(s.element(m).mul(cN({theta:g,axis:d,outputDirection:i,mipInt:l,envMap:c,CUBEUV_TEXEL_WIDTH:u,CUBEUV_TEXEL_HEIGHT:h,CUBEUV_MAX_MIP:f})))}),jt(p,1)}),fm=4,g5=[.125,.215,.35,.446,.526,.582],If=20,uN=new y_(-1,1,1,-1,0,1),nke=new Ti(90,1),y5=new pt;let hN=null,fN=0,dN=0;const Cf=(1+Math.sqrt(5))/2,Ep=1/Cf,v5=[new K(-Cf,Ep,0),new K(Cf,Ep,0),new K(-Ep,0,Cf),new K(Ep,0,Cf),new K(0,Cf,-Ep),new K(0,Cf,Ep),new K(-1,1,-1),new K(1,1,-1),new K(-1,1,1),new K(1,1,1)],rke=new K,qJ=new WeakMap,ike=[3,1,5,0,4,2],pN=JDe(P_(),Dh("faceIndex")).normalize(),q3=Ae(pN.x,pN.y,pN.z);class ske{constructor(e){this._renderer=e,this._pingPongRenderTarget=null,this._lodMax=0,this._cubeSize=0,this._lodPlanes=[],this._sizeLods=[],this._sigmas=[],this._lodMeshes=[],this._blurMaterial=null,this._cubemapMaterial=null,this._equirectMaterial=null,this._backgroundBox=null}get _hasInitialized(){return this._renderer.hasInitialized()}fromScene(e,n=0,i=.1,s=100,o={}){const{size:a=256,position:l=rke,renderTarget:c=null}=o;if(this._setSize(a),this._hasInitialized===!1){console.warn("THREE.PMREMGenerator: .fromScene() called before the backend is initialized. Try using .fromSceneAsync() instead.");const h=c||this._allocateTargets();return o.renderTarget=h,this.fromSceneAsync(e,n,i,s,o),h}hN=this._renderer.getRenderTarget(),fN=this._renderer.getActiveCubeFace(),dN=this._renderer.getActiveMipmapLevel();const u=c||this._allocateTargets();return u.depthBuffer=!0,this._sceneToCubeUV(e,i,s,u,l),n>0&&this._blur(u,0,0,n),this._applyPMREM(u),this._cleanup(u),u}async fromSceneAsync(e,n=0,i=.1,s=100,o={}){return this._hasInitialized===!1&&await this._renderer.init(),this.fromScene(e,n,i,s,o)}fromEquirectangular(e,n=null){if(this._hasInitialized===!1){console.warn("THREE.PMREMGenerator: .fromEquirectangular() called before the backend is initialized. Try using .fromEquirectangularAsync() instead."),this._setSizeFromTexture(e);const i=n||this._allocateTargets();return this.fromEquirectangularAsync(e,i),i}return this._fromTexture(e,n)}async fromEquirectangularAsync(e,n=null){return this._hasInitialized===!1&&await this._renderer.init(),this._fromTexture(e,n)}fromCubemap(e,n=null){if(this._hasInitialized===!1){console.warn("THREE.PMREMGenerator: .fromCubemap() called before the backend is initialized. Try using .fromCubemapAsync() instead."),this._setSizeFromTexture(e);const i=n||this._allocateTargets();return this.fromCubemapAsync(e,n),i}return this._fromTexture(e,n)}async fromCubemapAsync(e,n=null){return this._hasInitialized===!1&&await this._renderer.init(),this._fromTexture(e,n)}async compileCubemapShader(){this._cubemapMaterial===null&&(this._cubemapMaterial=b5(),await this._compileMaterial(this._cubemapMaterial))}async compileEquirectangularShader(){this._equirectMaterial===null&&(this._equirectMaterial=_5(),await this._compileMaterial(this._equirectMaterial))}dispose(){this._dispose(),this._cubemapMaterial!==null&&this._cubemapMaterial.dispose(),this._equirectMaterial!==null&&this._equirectMaterial.dispose(),this._backgroundBox!==null&&(this._backgroundBox.geometry.dispose(),this._backgroundBox.material.dispose())}_setSizeFromTexture(e){e.mapping===tl||e.mapping===nl?this._setSize(e.image.length===0?16:e.image[0].width||e.image[0].image.width):this._setSize(e.image.width/4)}_setSize(e){this._lodMax=Math.floor(Math.log2(e)),this._cubeSize=Math.pow(2,this._lodMax)}_dispose(){this._blurMaterial!==null&&this._blurMaterial.dispose(),this._pingPongRenderTarget!==null&&this._pingPongRenderTarget.dispose();for(let e=0;e<this._lodPlanes.length;e++)this._lodPlanes[e].dispose()}_cleanup(e){this._renderer.setRenderTarget(hN,fN,dN),e.scissorTest=!1,NS(e,0,0,e.width,e.height)}_fromTexture(e,n){this._setSizeFromTexture(e),hN=this._renderer.getRenderTarget(),fN=this._renderer.getActiveCubeFace(),dN=this._renderer.getActiveMipmapLevel();const i=n||this._allocateTargets();return this._textureToCubeUV(e,i),this._applyPMREM(i),this._cleanup(i),i}_allocateTargets(){const e=3*Math.max(this._cubeSize,112),n=4*this._cubeSize,i={magFilter:li,minFilter:li,generateMipmaps:!1,type:Ei,format:Tr,colorSpace:Ol},s=x5(e,n,i);if(this._pingPongRenderTarget===null||this._pingPongRenderTarget.width!==e||this._pingPongRenderTarget.height!==n){this._pingPongRenderTarget!==null&&this._dispose(),this._pingPongRenderTarget=x5(e,n,i);const{_lodMax:o}=this;({sizeLods:this._sizeLods,lodPlanes:this._lodPlanes,sigmas:this._sigmas,lodMeshes:this._lodMeshes}=oke(o)),this._blurMaterial=ake(o,e,n)}return s}async _compileMaterial(e){const n=new Jn(this._lodPlanes[0],e);await this._renderer.compile(n,uN)}_sceneToCubeUV(e,n,i,s,o){const a=nke;a.near=n,a.far=i;const l=[1,1,1,1,-1,1],c=[1,-1,1,-1,1,-1],u=this._renderer,h=u.autoClear;u.getClearColor(y5),u.autoClear=!1;let f=this._backgroundBox;if(f===null){const m=new As({name:"PMREM.Background",side:Fn,depthWrite:!1,depthTest:!1});f=new Jn(new Dl,m)}let d=!1;const p=e.background;p?p.isColor&&(f.material.color.copy(p),e.background=null,d=!0):(f.material.color.copy(y5),d=!0),u.setRenderTarget(s),u.clear(),d&&u.render(f,a);for(let m=0;m<6;m++){const g=m%3;g===0?(a.up.set(0,l[m],0),a.position.set(o.x,o.y,o.z),a.lookAt(o.x+c[m],o.y,o.z)):g===1?(a.up.set(0,0,l[m]),a.position.set(o.x,o.y,o.z),a.lookAt(o.x,o.y+c[m],o.z)):(a.up.set(0,l[m],0),a.position.set(o.x,o.y,o.z),a.lookAt(o.x,o.y,o.z+c[m]));const v=this._cubeSize;NS(s,g*v,m>2?v:0,v,v),u.render(e,a)}u.autoClear=h,e.background=p}_textureToCubeUV(e,n){const i=this._renderer,s=e.mapping===tl||e.mapping===nl;s?this._cubemapMaterial===null&&(this._cubemapMaterial=b5(e)):this._equirectMaterial===null&&(this._equirectMaterial=_5(e));const o=s?this._cubemapMaterial:this._equirectMaterial;o.fragmentNode.value=e;const a=this._lodMeshes[0];a.material=o;const l=this._cubeSize;NS(n,0,0,3*l,2*l),i.setRenderTarget(n),i.render(a,uN)}_applyPMREM(e){const n=this._renderer,i=n.autoClear;n.autoClear=!1;const s=this._lodPlanes.length;for(let o=1;o<s;o++){const a=Math.sqrt(this._sigmas[o]*this._sigmas[o]-this._sigmas[o-1]*this._sigmas[o-1]),l=v5[(s-o-1)%v5.length];this._blur(e,o-1,o,a,l)}n.autoClear=i}_blur(e,n,i,s,o){const a=this._pingPongRenderTarget;this._halfBlur(e,a,n,i,s,"latitudinal",o),this._halfBlur(a,e,i,i,s,"longitudinal",o)}_halfBlur(e,n,i,s,o,a,l){const c=this._renderer,u=this._blurMaterial;a!=="latitudinal"&&a!=="longitudinal"&&console.error("blur direction must be either latitudinal or longitudinal!");const h=3,f=this._lodMeshes[s];f.material=u;const d=qJ.get(u),p=this._sizeLods[i]-1,m=isFinite(o)?Math.PI/(2*p):2*Math.PI/(2*If-1),g=o/m,v=isFinite(o)?1+Math.floor(h*g):If;v>If&&console.warn(`sigmaRadians, ${o}, is too large and will clip, as it requested ${v} samples when the maximum is set to ${If}`);const y=[];let x=0;for(let T=0;T<If;++T){const E=T/g,M=Math.exp(-E*E/2);y.push(M),T===0?x+=M:T<v&&(x+=2*M)}for(let T=0;T<y.length;T++)y[T]=y[T]/x;e.texture.frame=(e.texture.frame||0)+1,d.envMap.value=e.texture,d.samples.value=v,d.weights.array=y,d.latitudinal.value=a==="latitudinal"?1:0,l&&(d.poleAxis.value=l);const{_lodMax:b}=this;d.dTheta.value=m,d.mipInt.value=b-i;const w=this._sizeLods[s],_=3*w*(s>b-fm?s-b+fm:0),S=4*(this._cubeSize-w);NS(n,_,S,3*w,2*w),c.setRenderTarget(n),c.render(f,uN)}}function oke(r){const e=[],n=[],i=[],s=[];let o=r;const a=r-fm+1+g5.length;for(let l=0;l<a;l++){const c=Math.pow(2,o);n.push(c);let u=1/c;l>r-fm?u=g5[l-r+fm-1]:l===0&&(u=0),i.push(u);const h=1/(c-2),f=-h,d=1+h,p=[f,f,d,f,d,d,f,f,d,d,f,d],m=6,g=6,v=3,y=2,x=1,b=new Float32Array(v*g*m),w=new Float32Array(y*g*m),_=new Float32Array(x*g*m);for(let T=0;T<m;T++){const E=T%3*2/3-1,M=T>2?0:-1,A=[E,M,0,E+2/3,M,0,E+2/3,M+1,0,E,M,0,E+2/3,M+1,0,E,M+1,0],P=ike[T];b.set(A,v*g*P),w.set(p,y*g*P);const D=[P,P,P,P,P,P];_.set(D,x*g*P)}const S=new ji;S.setAttribute("position",new hi(b,v)),S.setAttribute("uv",new hi(w,y)),S.setAttribute("faceIndex",new hi(_,x)),e.push(S),s.push(new Jn(S,null)),o>fm&&o--}return{lodPlanes:e,sizeLods:n,sigmas:i,lodMeshes:s}}function x5(r,e,n){const i=new $h(r,e,n);return i.texture.mapping=md,i.texture.name="PMREM.cubeUv",i.texture.isPMREMTexture=!0,i.scissorTest=!0,i}function NS(r,e,n,i,s){r.viewport.set(e,n,i,s),r.scissor.set(e,n,i,s)}function X3(r){const e=new mi;return e.depthTest=!1,e.depthWrite=!1,e.blending=ro,e.name=`PMREM_${r}`,e}function ake(r,e,n){const i=_l(new Array(If).fill(0)),s=Ft(new K(0,1,0)),o=Ft(0),a=Te(If),l=Ft(0),c=Ft(1),u=cn(null),h=Ft(0),f=Te(1/e),d=Te(1/n),p=Te(r),m={n:a,latitudinal:l,weights:i,poleAxis:s,outputDirection:q3,dTheta:o,samples:c,envMap:u,mipInt:h,CUBEUV_TEXEL_WIDTH:f,CUBEUV_TEXEL_HEIGHT:d,CUBEUV_MAX_MIP:p},g=X3("blur");return g.fragmentNode=tke({...m,latitudinal:l.equal(1)}),qJ.set(g,m),g}function b5(r){const e=X3("cubemap");return e.fragmentNode=ub(r,q3),e}function _5(r){const e=X3("equirect");return e.fragmentNode=cn(r,IJ(q3),0),e}const w5=new WeakMap;function lke(r){const e=Math.log2(r)-2,n=1/r;return{texelWidth:1/(3*Math.max(Math.pow(2,e),7*16)),texelHeight:n,maxMip:e}}function cke(r,e,n){const i=uke(e);let s=i.get(r);if((s!==void 0?s.pmremVersion:-1)!==r.pmremVersion){const a=r.image;if(r.isCubeTexture)if(fke(a))s=n.fromCubemap(r,s);else return null;else if(dke(a))s=n.fromEquirectangular(r,s);else return null;s.pmremVersion=r.pmremVersion,i.set(r,s)}return s.texture}function uke(r){let e=w5.get(r);return e===void 0&&(e=new WeakMap,w5.set(r,e)),e}class hke extends Qr{static get type(){return"PMREMNode"}constructor(e,n=null,i=null){super("vec3"),this._value=e,this._pmrem=null,this.uvNode=n,this.levelNode=i,this._generator=null;const s=new ui;s.isRenderTargetTexture=!0,this._texture=cn(s),this._width=Ft(0),this._height=Ft(0),this._maxMip=Ft(0),this.updateBeforeType=Jt.RENDER}set value(e){this._value=e,this._pmrem=null}get value(){return this._value}updateFromTexture(e){const n=lke(e.image.height);this._texture.value=e,this._width.value=n.texelWidth,this._height.value=n.texelHeight,this._maxMip.value=n.maxMip}updateBefore(e){let n=this._pmrem;const i=n?n.pmremVersion:-1,s=this._value;i!==s.pmremVersion&&(s.isPMREMTexture===!0?n=s:n=cke(s,e.renderer,this._generator),n!==null&&(this._pmrem=n,this.updateFromTexture(n)))}setup(e){this._generator===null&&(this._generator=new ske(e.renderer)),this.updateBefore(e);let n=this.uvNode;n===null&&e.context.getUV&&(n=e.context.getUV(this)),n=SJ.mul(Ae(n.x,n.y.negate(),n.z));let i=this.levelNode;return i===null&&e.context.getTextureLevel&&(i=e.context.getTextureLevel(this)),eke(this._texture,n,i,this._width,this._height,this._maxMip)}dispose(){super.dispose(),this._generator!==null&&this._generator.dispose()}}function fke(r){if(r==null)return!1;let e=0;const n=6;for(let i=0;i<n;i++)r[i]!==void 0&&e++;return e===n}function dke(r){return r==null?!1:r.height>0}const XJ=Ne(hke).setParameterLength(1,3),S5=new WeakMap;class pke extends Ey{static get type(){return"EnvironmentNode"}constructor(e=null){super(),this.envNode=e}setup(e){const{material:n}=e;let i=this.envNode;if(i.isTextureNode||i.isMaterialReferenceNode){const f=i.isTextureNode?i.value:n[i.property];let d=S5.get(f);d===void 0&&(d=XJ(f),S5.set(f,d)),i=d}const o=n.useAnisotropy===!0||n.anisotropy>0?q2e:qr,a=i.context(T5(Cc,o)).mul(eN),l=i.context(mke(j3)).mul(Math.PI).mul(eN),c=B1(a),u=B1(l);e.context.radiance.addAssign(c),e.context.iblIrradiance.addAssign(u);const h=e.context.lightingModel.clearcoatRadiance;if(h){const f=i.context(T5(dE,c0)).mul(eN),d=B1(f);h.addAssign(d)}}}const T5=(r,e)=>{let n=null;return{getUV:()=>(n===null&&(n=dr.negate().reflect(e),n=r.mul(r).mix(n,e).normalize(),n=n.transformDirection(bu)),n),getTextureLevel:()=>r}},mke=r=>({getUV:()=>r,getTextureLevel:()=>Te(1)}),gke=new kY;class KJ extends mi{static get type(){return"MeshStandardNodeMaterial"}constructor(e){super(),this.isMeshStandardNodeMaterial=!0,this.lights=!0,this.emissiveNode=null,this.metalnessNode=null,this.roughnessNode=null,this.setDefaultValues(gke),this.setValues(e)}setupEnvironment(e){let n=super.setupEnvironment(e);return n===null&&e.environmentNode&&(n=e.environmentNode),n?new pke(n):null}setupLightingModel(){return new WJ}setupSpecular(){const e=Yn(Ae(.04),bn.rgb,fE);bo.assign(e),pE.assign(1)}setupVariants(){const e=this.metalnessNode?Te(this.metalnessNode):aOe;fE.assign(e);let n=this.roughnessNode?Te(this.roughnessNode):oOe;n=$J({roughness:n}),Cc.assign(n),this.setupSpecular(),bn.assign(jt(bn.rgb.mul(e.oneMinus()),bn.a))}copy(e){return this.emissiveNode=e.emissiveNode,this.metalnessNode=e.metalnessNode,this.roughnessNode=e.roughnessNode,super.copy(e)}}const yke=new f0e;class vke extends KJ{static get type(){return"MeshPhysicalNodeMaterial"}constructor(e){super(),this.isMeshPhysicalNodeMaterial=!0,this.clearcoatNode=null,this.clearcoatRoughnessNode=null,this.clearcoatNormalNode=null,this.sheenNode=null,this.sheenRoughnessNode=null,this.iridescenceNode=null,this.iridescenceIORNode=null,this.iridescenceThicknessNode=null,this.specularIntensityNode=null,this.specularColorNode=null,this.iorNode=null,this.transmissionNode=null,this.thicknessNode=null,this.attenuationDistanceNode=null,this.attenuationColorNode=null,this.dispersionNode=null,this.anisotropyNode=null,this.setDefaultValues(yke),this.setValues(e)}get useClearcoat(){return this.clearcoat>0||this.clearcoatNode!==null}get useIridescence(){return this.iridescence>0||this.iridescenceNode!==null}get useSheen(){return this.sheen>0||this.sheenNode!==null}get useAnisotropy(){return this.anisotropy>0||this.anisotropyNode!==null}get useTransmission(){return this.transmission>0||this.transmissionNode!==null}get useDispersion(){return this.dispersion>0||this.dispersionNode!==null}setupSpecular(){const e=this.iorNode?Te(this.iorNode):_Oe;L1.assign(e),bo.assign(Yn(lb(cJ(L1.sub(1).div(L1.add(1))).mul(sOe),Ae(1)).mul(YG),bn.rgb,fE)),pE.assign(Yn(YG,1,fE))}setupLightingModel(){return new WJ(this.useClearcoat,this.useSheen,this.useIridescence,this.useAnisotropy,this.useTransmission,this.useDispersion)}setupVariants(e){if(super.setupVariants(e),this.useClearcoat){const n=this.clearcoatNode?Te(this.clearcoatNode):cOe,i=this.clearcoatRoughnessNode?Te(this.clearcoatRoughnessNode):uOe;xD.assign(n),dE.assign($J({roughness:i}))}if(this.useSheen){const n=this.sheenNode?Ae(this.sheenNode):dOe,i=this.sheenRoughnessNode?Te(this.sheenRoughnessNode):pOe;hm.assign(n),R3.assign(i)}if(this.useIridescence){const n=this.iridescenceNode?Te(this.iridescenceNode):gOe,i=this.iridescenceIORNode?Te(this.iridescenceIORNode):yOe,s=this.iridescenceThicknessNode?Te(this.iridescenceThicknessNode):vOe;N3.assign(n),qQ.assign(i),XQ.assign(s)}if(this.useAnisotropy){const n=(this.anisotropyNode?Ve(this.anisotropyNode):mOe).toVar();Af.assign(n.length()),kr(Af.equal(0),()=>{n.assign(Ve(1,0))}).Else(()=>{n.divAssign(Ve(Af)),Af.assign(Af.saturate())}),bD.assign(Af.pow2().mix(Cc.pow2(),1)),I1.assign(u0[0].mul(n.x).add(u0[1].mul(n.y))),Lm.assign(u0[1].mul(n.x).sub(u0[0].mul(n.y)))}if(this.useTransmission){const n=this.transmissionNode?Te(this.transmissionNode):xOe,i=this.thicknessNode?Te(this.thicknessNode):bOe,s=this.attenuationDistanceNode?Te(this.attenuationDistanceNode):wOe,o=this.attenuationColorNode?Ae(this.attenuationColorNode):SOe;if(wD.assign(n),KQ.assign(i),YQ.assign(s),ZQ.assign(o),this.useDispersion){const a=this.dispersionNode?Te(this.dispersionNode):POe;QQ.assign(a)}}}setupClearcoatNormal(){return this.clearcoatNormalNode?Ae(this.clearcoatNormalNode):hOe}setup(e){e.context.setupClearcoatNormal=()=>this.setupClearcoatNormal(e),super.setup(e)}copy(e){return this.clearcoatNode=e.clearcoatNode,this.clearcoatRoughnessNode=e.clearcoatRoughnessNode,this.clearcoatNormalNode=e.clearcoatNormalNode,this.sheenNode=e.sheenNode,this.sheenRoughnessNode=e.sheenRoughnessNode,this.iridescenceNode=e.iridescenceNode,this.iridescenceIORNode=e.iridescenceIORNode,this.iridescenceThicknessNode=e.iridescenceThicknessNode,this.specularIntensityNode=e.specularIntensityNode,this.specularColorNode=e.specularColorNode,this.transmissionNode=e.transmissionNode,this.thicknessNode=e.thicknessNode,this.attenuationDistanceNode=e.attenuationDistanceNode,this.attenuationColorNode=e.attenuationColorNode,this.dispersionNode=e.dispersionNode,this.anisotropyNode=e.anisotropyNode,super.copy(e)}}const xke=Oe(({normal:r,lightDirection:e,builder:n})=>{const i=r.dot(e),s=Ve(i.mul(.5).add(.5),0);if(n.material.gradientMap){const o=eh("gradientMap","texture").context({getUV:()=>s});return Ae(o.r)}else{const o=s.fwidth().mul(.5);return Yn(Ae(.7),Ae(1),Oh(Te(.7).sub(o.x),Te(.7).add(o.x),s.x))}});class bke extends SA{direct({lightDirection:e,lightColor:n,reflectedLight:i},s){const o=xke({normal:bJ,lightDirection:e,builder:s}).mul(n);i.directDiffuse.addAssign(o.mul(Mg({diffuseColor:bn.rgb})))}indirect(e){const{ambientOcclusion:n,irradiance:i,reflectedLight:s}=e.context;s.indirectDiffuse.addAssign(i.mul(Mg({diffuseColor:bn}))),s.indirectDiffuse.mulAssign(n)}}const _ke=new p0e;class wke extends mi{static get type(){return"MeshToonNodeMaterial"}constructor(e){super(),this.isMeshToonNodeMaterial=!0,this.lights=!0,this.setDefaultValues(_ke),this.setValues(e)}setupLightingModel(){return new bke}}class Ske extends Qr{static get type(){return"MatcapUVNode"}constructor(){super("vec2")}setup(){const e=Ae(dr.z,0,dr.x.negate()).normalize(),n=dr.cross(e);return Ve(e.dot(qr),n.dot(qr)).mul(.495).add(.5)}}const Tke=je(Ske),Eke=new v0e;class Mke extends mi{static get type(){return"MeshMatcapNodeMaterial"}constructor(e){super(),this.isMeshMatcapNodeMaterial=!0,this.setDefaultValues(Eke),this.setValues(e)}setupVariants(e){const n=Tke;let i;e.material.matcap?i=eh("matcap","texture").context({getUV:()=>n}):i=Ae(Yn(.2,.8,n.y)),bn.rgb.mulAssign(i.rgb)}}class Ake extends Qr{static get type(){return"RotateNode"}constructor(e,n){super(),this.positionNode=e,this.rotationNode=n}getNodeType(e){return this.positionNode.getNodeType(e)}setup(e){const{rotationNode:n,positionNode:i}=this;if(this.getNodeType(e)==="vec2"){const o=n.cos(),a=n.sin();return P3(o,a,a.negate(),o).mul(i)}else{const o=n,a=Im(jt(1,0,0,0),jt(0,Ku(o.x),ja(o.x).negate(),0),jt(0,ja(o.x),Ku(o.x),0),jt(0,0,0,1)),l=Im(jt(Ku(o.y),0,ja(o.y),0),jt(0,1,0,0),jt(ja(o.y).negate(),0,Ku(o.y),0),jt(0,0,0,1)),c=Im(jt(Ku(o.z),ja(o.z).negate(),0,0),jt(ja(o.z),Ku(o.z),0,0),jt(0,0,1,0),jt(0,0,0,1));return a.mul(l).mul(c).mul(jt(i,1)).xyz}}}const YJ=Ne(Ake).setParameterLength(2),Cke=new Vve;class ZJ extends mi{static get type(){return"SpriteNodeMaterial"}constructor(e){super(),this.isSpriteNodeMaterial=!0,this._useSizeAttenuation=!0,this.positionNode=null,this.rotationNode=null,this.scaleNode=null,this.transparent=!0,this.setDefaultValues(Cke),this.setValues(e)}setupPositionView(e){const{object:n,camera:i}=e,s=this.sizeAttenuation,{positionNode:o,rotationNode:a,scaleNode:l}=this,c=xA.mul(Ae(o||0));let u=Ve(wd[0].xyz.length(),wd[1].xyz.length());if(l!==null&&(u=u.mul(Ve(l))),s===!1)if(i.isPerspectiveCamera)u=u.mul(c.z.negate());else{const p=Te(2).div($3.element(1).element(1));u=u.mul(p.mul(2))}let h=bA.xy;if(n.center&&n.center.isVector2===!0){const p=r2e("center","vec2",n);h=h.sub(p.sub(.5))}h=h.mul(u);const f=Te(a||fOe),d=YJ(h,f);return jt(c.xy.add(d),c.zw)}copy(e){return this.positionNode=e.positionNode,this.rotationNode=e.rotationNode,this.scaleNode=e.scaleNode,super.copy(e)}get sizeAttenuation(){return this._useSizeAttenuation}set sizeAttenuation(e){this._useSizeAttenuation!==e&&(this._useSizeAttenuation=e,this.needsUpdate=!0)}}const Pke=new Xve;class Rke extends ZJ{static get type(){return"PointsNodeMaterial"}constructor(e){super(),this.sizeNode=null,this.isPointsNodeMaterial=!0,this.setDefaultValues(Pke),this.setValues(e)}setupPositionView(){const{positionNode:e}=this;return xA.mul(Ae(e||os)).xyz}setupVertex(e){const n=super.setupVertex(e);if(e.material.isNodeMaterial!==!0)return n;const{rotationNode:i,scaleNode:s,sizeNode:o}=this,a=bA.xy.toVar(),l=j0.z.div(j0.w);if(i&&i.isNode){const u=Te(i);a.assign(YJ(a,u))}let c=o!==null?Ve(o):COe;return this.sizeAttenuation===!0&&(c=c.mul(c.div(Kr.z.negate()))),s&&s.isNode&&(c=c.mul(Ve(s))),a.mulAssign(c.mul(2)),a.assign(a.div(j0.z)),a.y.assign(a.y.mul(l)),a.assign(a.mul(n.w)),n.addAssign(jt(a,0,0)),n}get alphaToCoverage(){return this._useAlphaToCoverage}set alphaToCoverage(e){this._useAlphaToCoverage!==e&&(this._useAlphaToCoverage=e,this.needsUpdate=!0)}}class Nke extends SA{constructor(){super(),this.shadowNode=Te(1).toVar("shadowMask")}direct({lightNode:e}){this.shadowNode.mulAssign(e.shadowNode)}finish({context:e}){bn.a.mulAssign(this.shadowNode.oneMinus()),e.outgoingLight.rgb.assign(bn.rgb)}}const Oke=new h0e;class Dke extends mi{static get type(){return"ShadowNodeMaterial"}constructor(e){super(),this.isShadowNodeMaterial=!0,this.lights=!0,this.transparent=!0,this.setDefaultValues(Oke),this.setValues(e)}setupLightingModel(){return new Nke}}M_("vec3");M_("vec3");M_("vec3");class kke{constructor(e,n){this.nodes=e,this.info=n,this._context=typeof self<"u"?self:null,this._animationLoop=null,this._requestId=null}start(){const e=(n,i)=>{this._requestId=this._context.requestAnimationFrame(e),this.info.autoReset===!0&&this.info.reset(),this.nodes.nodeFrame.update(),this.info.frame=this.nodes.nodeFrame.frameId,this._animationLoop!==null&&this._animationLoop(n,i)};e()}stop(){this._context.cancelAnimationFrame(this._requestId),this._requestId=null}getAnimationLoop(){return this._animationLoop}setAnimationLoop(e){this._animationLoop=e}getContext(){return this._context}setContext(e){this._context=e}dispose(){this.stop()}}class sl{constructor(){this.weakMap=new WeakMap}get(e){let n=this.weakMap;for(let i=0;i<e.length-1;i++)if(n=n.get(e[i]),n===void 0)return;return n.get(e[e.length-1])}set(e,n){let i=this.weakMap;for(let s=0;s<e.length-1;s++){const o=e[s];i.has(o)===!1&&i.set(o,new WeakMap),i=i.get(o)}return i.set(e[e.length-1],n),this}delete(e){let n=this.weakMap;for(let i=0;i<e.length-1;i++)if(n=n.get(e[i]),n===void 0)return!1;return n.delete(e[e.length-1])}}let Ike=0;function Lke(r){const e=Object.keys(r);let n=Object.getPrototypeOf(r);for(;n;){const i=Object.getOwnPropertyDescriptors(n);for(const s in i)if(i[s]!==void 0){const o=i[s];o&&typeof o.get=="function"&&e.push(s)}n=Object.getPrototypeOf(n)}return e}class Fke{constructor(e,n,i,s,o,a,l,c,u,h){this.id=Ike++,this._nodes=e,this._geometries=n,this.renderer=i,this.object=s,this.material=o,this.scene=a,this.camera=l,this.lightsNode=c,this.context=u,this.geometry=s.geometry,this.version=o.version,this.drawRange=null,this.attributes=null,this.pipeline=null,this.group=null,this.vertexBuffers=null,this.drawParams=null,this.bundle=null,this.clippingContext=h,this.clippingContextCacheKey=h!==null?h.cacheKey:"",this.initialNodesCacheKey=this.getDynamicCacheKey(),this.initialCacheKey=this.getCacheKey(),this._nodeBuilderState=null,this._bindings=null,this._monitor=null,this.onDispose=null,this.isRenderObject=!0,this.onMaterialDispose=()=>{this.dispose()},this.material.addEventListener("dispose",this.onMaterialDispose)}updateClipping(e){this.clippingContext=e}get clippingNeedsUpdate(){return this.clippingContext===null||this.clippingContext.cacheKey===this.clippingContextCacheKey?!1:(this.clippingContextCacheKey=this.clippingContext.cacheKey,!0)}get hardwareClippingPlanes(){return this.material.hardwareClipping===!0?this.clippingContext.unionClippingCount:0}getNodeBuilderState(){return this._nodeBuilderState||(this._nodeBuilderState=this._nodes.getForRender(this))}getMonitor(){return this._monitor||(this._monitor=this.getNodeBuilderState().observer)}getBindings(){return this._bindings||(this._bindings=this.getNodeBuilderState().createBindings())}getBindingGroup(e){for(const n of this.getBindings())if(n.name===e)return n}getIndex(){return this._geometries.getIndex(this)}getIndirect(){return this._geometries.getIndirect(this)}getChainArray(){return[this.object,this.material,this.context,this.lightsNode]}setGeometry(e){this.geometry=e,this.attributes=null}getAttributes(){if(this.attributes!==null)return this.attributes;const e=this.getNodeBuilderState().nodeAttributes,n=this.geometry,i=[],s=new Set;for(const o of e){const a=o.node&&o.node.attribute?o.node.attribute:n.getAttribute(o.name);if(a===void 0)continue;i.push(a);const l=a.isInterleavedBufferAttribute?a.data:a;s.add(l)}return this.attributes=i,this.vertexBuffers=Array.from(s.values()),i}getVertexBuffers(){return this.vertexBuffers===null&&this.getAttributes(),this.vertexBuffers}getDrawParameters(){const{object:e,material:n,geometry:i,group:s,drawRange:o}=this,a=this.drawParams||(this.drawParams={vertexCount:0,firstVertex:0,instanceCount:0,firstInstance:0}),l=this.getIndex(),c=l!==null;let u=1;if(i.isInstancedBufferGeometry===!0?u=i.instanceCount:e.count!==void 0&&(u=Math.max(0,e.count)),u===0)return null;if(a.instanceCount=u,e.isBatchedMesh===!0)return a;let h=1;n.wireframe===!0&&!e.isPoints&&!e.isLineSegments&&!e.isLine&&!e.isLineLoop&&(h=2);let f=o.start*h,d=(o.start+o.count)*h;s!==null&&(f=Math.max(f,s.start*h),d=Math.min(d,(s.start+s.count)*h));const p=i.attributes.position;let m=1/0;c?m=l.count:p!=null&&(m=p.count),f=Math.max(f,0),d=Math.min(d,m);const g=d-f;return g<0||g===1/0?null:(a.vertexCount=g,a.firstVertex=f,a)}getGeometryCacheKey(){const{geometry:e}=this;let n="";for(const i of Object.keys(e.attributes).sort()){const s=e.attributes[i];n+=i+",",s.data&&(n+=s.data.stride+","),s.offset&&(n+=s.offset+","),s.itemSize&&(n+=s.itemSize+","),s.normalized&&(n+="n,")}for(const i of Object.keys(e.morphAttributes).sort()){const s=e.morphAttributes[i];n+="morph-"+i+",";for(let o=0,a=s.length;o<a;o++){const l=s[o];n+=l.id+","}}return e.index&&(n+="index,"),n}getMaterialCacheKey(){const{object:e,material:n}=this;let i=n.customProgramCacheKey();for(const s of Lke(n)){if(/^(is[A-Z]|_)|^(visible|version|uuid|name|opacity|userData)$/.test(s))continue;const o=n[s];let a;if(o!==null){const l=typeof o;l==="number"?a=o!==0?"1":"0":l==="object"?(a="{",o.isTexture&&(a+=o.mapping),a+="}"):a=String(o)}else a=String(o);i+=a+","}return i+=this.clippingContextCacheKey+",",e.geometry&&(i+=this.getGeometryCacheKey()),e.skeleton&&(i+=e.skeleton.bones.length+","),e.isBatchedMesh&&(i+=e._matricesTexture.uuid+",",e._colorsTexture!==null&&(i+=e._colorsTexture.uuid+",")),e.count>1&&(i+=e.uuid+","),i+=e.receiveShadow+",",eRe(i)}get needsGeometryUpdate(){return this.geometry.id!==this.object.geometry.id}get needsUpdate(){return this.initialNodesCacheKey!==this.getDynamicCacheKey()||this.clippingNeedsUpdate}getDynamicCacheKey(){let e=0;return this.material.isShadowPassMaterial!==!0&&(e=this._nodes.getCacheKey(this.scene,this.lightsNode)),this.camera.isArrayCamera&&(e=sb(e,this.camera.cameras.length)),this.object.receiveShadow&&(e=sb(e,1)),e}getCacheKey(){return this.getMaterialCacheKey()+this.getDynamicCacheKey()}dispose(){this.material.removeEventListener("dispose",this.onMaterialDispose),this.onDispose()}}const ff=[];class Bke{constructor(e,n,i,s,o,a){this.renderer=e,this.nodes=n,this.geometries=i,this.pipelines=s,this.bindings=o,this.info=a,this.chainMaps={}}get(e,n,i,s,o,a,l,c){const u=this.getChainMap(c);ff[0]=e,ff[1]=n,ff[2]=a,ff[3]=o;let h=u.get(ff);return h===void 0?(h=this.createRenderObject(this.nodes,this.geometries,this.renderer,e,n,i,s,o,a,l,c),u.set(ff,h)):(h.updateClipping(l),h.needsGeometryUpdate&&h.setGeometry(e.geometry),(h.version!==n.version||h.needsUpdate)&&(h.initialCacheKey!==h.getCacheKey()?(h.dispose(),h=this.get(e,n,i,s,o,a,l,c)):h.version=n.version)),ff.length=0,h}getChainMap(e="default"){return this.chainMaps[e]||(this.chainMaps[e]=new sl)}dispose(){this.chainMaps={}}createRenderObject(e,n,i,s,o,a,l,c,u,h,f){const d=this.getChainMap(f),p=new Fke(e,n,i,s,o,a,l,c,u,h);return p.onDispose=()=>{this.pipelines.delete(p),this.bindings.delete(p),this.nodes.delete(p),d.delete(p.getChainArray())},p}}class Kh{constructor(){this.data=new WeakMap}get(e){let n=this.data.get(e);return n===void 0&&(n={},this.data.set(e,n)),n}delete(e){let n=null;return this.data.has(e)&&(n=this.data.get(e),this.data.delete(e)),n}has(e){return this.data.has(e)}dispose(){this.data=new WeakMap}}const oa={VERTEX:1,INDEX:2,STORAGE:3,INDIRECT:4},th=16,Uke=211,zke=212;class $ke extends Kh{constructor(e){super(),this.backend=e}delete(e){const n=super.delete(e);return n!==null&&this.backend.destroyAttribute(e),n}update(e,n){const i=this.get(e);if(i.version===void 0)n===oa.VERTEX?this.backend.createAttribute(e):n===oa.INDEX?this.backend.createIndexAttribute(e):n===oa.STORAGE?this.backend.createStorageAttribute(e):n===oa.INDIRECT&&this.backend.createIndirectStorageAttribute(e),i.version=this._getBufferAttribute(e).version;else{const s=this._getBufferAttribute(e);(i.version<s.version||s.usage===om)&&(this.backend.updateAttribute(e),i.version=s.version)}}_getBufferAttribute(e){return e.isInterleavedBufferAttribute&&(e=e.data),e}}function QJ(r){return r.index!==null?r.index.version:r.attributes.position.version}function E5(r){const e=[],n=r.index,i=r.attributes.position;if(n!==null){const o=n.array;for(let a=0,l=o.length;a<l;a+=3){const c=o[a+0],u=o[a+1],h=o[a+2];e.push(c,u,u,h,h,c)}}else{const o=i.array;for(let a=0,l=o.length/3-1;a<l;a+=3){const c=a+0,u=a+1,h=a+2;e.push(c,u,u,h,h,c)}}const s=new(PF(e)?DF:OF)(e,1);return s.version=QJ(r),s}class jke extends Kh{constructor(e,n){super(),this.attributes=e,this.info=n,this.wireframes=new WeakMap,this.attributeCall=new WeakMap}has(e){const n=e.geometry;return super.has(n)&&this.get(n).initialized===!0}updateForRender(e){this.has(e)===!1&&this.initGeometry(e),this.updateAttributes(e)}initGeometry(e){const n=e.geometry,i=this.get(n);i.initialized=!0,this.info.memory.geometries++;const s=()=>{this.info.memory.geometries--;const o=n.index,a=e.getAttributes();o!==null&&this.attributes.delete(o);for(const c of a)this.attributes.delete(c);const l=this.wireframes.get(n);l!==void 0&&this.attributes.delete(l),n.removeEventListener("dispose",s)};n.addEventListener("dispose",s)}updateAttributes(e){const n=e.getAttributes();for(const o of n)o.isStorageBufferAttribute||o.isStorageInstancedBufferAttribute?this.updateAttribute(o,oa.STORAGE):this.updateAttribute(o,oa.VERTEX);const i=this.getIndex(e);i!==null&&this.updateAttribute(i,oa.INDEX);const s=e.geometry.indirect;s!==null&&this.updateAttribute(s,oa.INDIRECT)}updateAttribute(e,n){const i=this.info.render.calls;e.isInterleavedBufferAttribute?this.attributeCall.get(e)===void 0?(this.attributes.update(e,n),this.attributeCall.set(e,i)):this.attributeCall.get(e.data)!==i&&(this.attributes.update(e,n),this.attributeCall.set(e.data,i),this.attributeCall.set(e,i)):this.attributeCall.get(e)!==i&&(this.attributes.update(e,n),this.attributeCall.set(e,i))}getIndirect(e){return e.geometry.indirect}getIndex(e){const{geometry:n,material:i}=e;let s=n.index;if(i.wireframe===!0){const o=this.wireframes;let a=o.get(n);a===void 0?(a=E5(n),o.set(n,a)):a.version!==QJ(n)&&(this.attributes.delete(a),a=E5(n),o.set(n,a)),s=a}return s}}class Vke{constructor(){this.autoReset=!0,this.frame=0,this.calls=0,this.render={calls:0,frameCalls:0,drawCalls:0,triangles:0,points:0,lines:0,timestamp:0},this.compute={calls:0,frameCalls:0,timestamp:0},this.memory={geometries:0,textures:0}}update(e,n,i){this.render.drawCalls++,e.isMesh||e.isSprite?this.render.triangles+=i*(n/3):e.isPoints?this.render.points+=i*n:e.isLineSegments?this.render.lines+=i*(n/2):e.isLine?this.render.lines+=i*(n-1):console.error("THREE.WebGPUInfo: Unknown object type.")}reset(){this.render.drawCalls=0,this.render.frameCalls=0,this.compute.frameCalls=0,this.render.triangles=0,this.render.points=0,this.render.lines=0}dispose(){this.reset(),this.calls=0,this.render.calls=0,this.compute.calls=0,this.render.timestamp=0,this.compute.timestamp=0,this.memory.geometries=0,this.memory.textures=0}}class JJ{constructor(e){this.cacheKey=e,this.usedTimes=0}}class Gke extends JJ{constructor(e,n,i){super(e),this.vertexProgram=n,this.fragmentProgram=i}}class Hke extends JJ{constructor(e,n){super(e),this.computeProgram=n,this.isComputePipeline=!0}}let Wke=0;class mN{constructor(e,n,i,s=null,o=null){this.id=Wke++,this.code=e,this.stage=n,this.name=i,this.transforms=s,this.attributes=o,this.usedTimes=0}}class qke extends Kh{constructor(e,n){super(),this.backend=e,this.nodes=n,this.bindings=null,this.caches=new Map,this.programs={vertex:new Map,fragment:new Map,compute:new Map}}getForCompute(e,n){const{backend:i}=this,s=this.get(e);if(this._needsComputeUpdate(e)){const o=s.pipeline;o&&(o.usedTimes--,o.computeProgram.usedTimes--);const a=this.nodes.getForCompute(e);let l=this.programs.compute.get(a.computeShader);l===void 0&&(o&&o.computeProgram.usedTimes===0&&this._releaseProgram(o.computeProgram),l=new mN(a.computeShader,"compute",e.name,a.transforms,a.nodeAttributes),this.programs.compute.set(a.computeShader,l),i.createProgram(l));const c=this._getComputeCacheKey(e,l);let u=this.caches.get(c);u===void 0&&(o&&o.usedTimes===0&&this._releasePipeline(o),u=this._getComputePipeline(e,l,c,n)),u.usedTimes++,l.usedTimes++,s.version=e.version,s.pipeline=u}return s.pipeline}getForRender(e,n=null){const{backend:i}=this,s=this.get(e);if(this._needsRenderUpdate(e)){const o=s.pipeline;o&&(o.usedTimes--,o.vertexProgram.usedTimes--,o.fragmentProgram.usedTimes--);const a=e.getNodeBuilderState(),l=e.material?e.material.name:"";let c=this.programs.vertex.get(a.vertexShader);c===void 0&&(o&&o.vertexProgram.usedTimes===0&&this._releaseProgram(o.vertexProgram),c=new mN(a.vertexShader,"vertex",l),this.programs.vertex.set(a.vertexShader,c),i.createProgram(c));let u=this.programs.fragment.get(a.fragmentShader);u===void 0&&(o&&o.fragmentProgram.usedTimes===0&&this._releaseProgram(o.fragmentProgram),u=new mN(a.fragmentShader,"fragment",l),this.programs.fragment.set(a.fragmentShader,u),i.createProgram(u));const h=this._getRenderCacheKey(e,c,u);let f=this.caches.get(h);f===void 0?(o&&o.usedTimes===0&&this._releasePipeline(o),f=this._getRenderPipeline(e,c,u,h,n)):e.pipeline=f,f.usedTimes++,c.usedTimes++,u.usedTimes++,s.pipeline=f}return s.pipeline}delete(e){const n=this.get(e).pipeline;return n&&(n.usedTimes--,n.usedTimes===0&&this._releasePipeline(n),n.isComputePipeline?(n.computeProgram.usedTimes--,n.computeProgram.usedTimes===0&&this._releaseProgram(n.computeProgram)):(n.fragmentProgram.usedTimes--,n.vertexProgram.usedTimes--,n.vertexProgram.usedTimes===0&&this._releaseProgram(n.vertexProgram),n.fragmentProgram.usedTimes===0&&this._releaseProgram(n.fragmentProgram))),super.delete(e)}dispose(){super.dispose(),this.caches=new Map,this.programs={vertex:new Map,fragment:new Map,compute:new Map}}updateForRender(e){this.getForRender(e)}_getComputePipeline(e,n,i,s){i=i||this._getComputeCacheKey(e,n);let o=this.caches.get(i);return o===void 0&&(o=new Hke(i,n),this.caches.set(i,o),this.backend.createComputePipeline(o,s)),o}_getRenderPipeline(e,n,i,s,o){s=s||this._getRenderCacheKey(e,n,i);let a=this.caches.get(s);return a===void 0&&(a=new Gke(s,n,i),this.caches.set(s,a),e.pipeline=a,this.backend.createRenderPipeline(e,o)),a}_getComputeCacheKey(e,n){return e.id+","+n.id}_getRenderCacheKey(e,n,i){return n.id+","+i.id+","+this.backend.getRenderCacheKey(e)}_releasePipeline(e){this.caches.delete(e.cacheKey)}_releaseProgram(e){const n=e.code,i=e.stage;this.programs[i].delete(n)}_needsComputeUpdate(e){const n=this.get(e);return n.pipeline===void 0||n.version!==e.version}_needsRenderUpdate(e){return this.get(e).pipeline===void 0||this.backend.needsRenderUpdate(e)}}class Xke extends Kh{constructor(e,n,i,s,o,a){super(),this.backend=e,this.textures=i,this.pipelines=o,this.attributes=s,this.nodes=n,this.info=a,this.pipelines.bindings=this}getForRender(e){const n=e.getBindings();for(const i of n){const s=this.get(i);s.bindGroup===void 0&&(this._init(i),this.backend.createBindings(i,n,0),s.bindGroup=i)}return n}getForCompute(e){const n=this.nodes.getForCompute(e).bindings;for(const i of n){const s=this.get(i);s.bindGroup===void 0&&(this._init(i),this.backend.createBindings(i,n,0),s.bindGroup=i)}return n}updateForCompute(e){this._updateBindings(this.getForCompute(e))}updateForRender(e){this._updateBindings(this.getForRender(e))}_updateBindings(e){for(const n of e)this._update(n,e)}_init(e){for(const n of e.bindings)if(n.isSampledTexture)this.textures.updateTexture(n.texture);else if(n.isStorageBuffer){const i=n.attribute,s=i.isIndirectStorageBufferAttribute?oa.INDIRECT:oa.STORAGE;this.attributes.update(i,s)}}_update(e,n){const{backend:i}=this;let s=!1,o=!0,a=0,l=0;for(const c of e.bindings)if(!(c.isNodeUniformsGroup&&this.nodes.updateGroup(c)===!1)){if(c.isStorageBuffer){const u=c.attribute,h=u.isIndirectStorageBufferAttribute?oa.INDIRECT:oa.STORAGE;this.attributes.update(u,h)}if(c.isUniformBuffer)c.update()&&i.updateBinding(c);else if(c.isSampler)c.update();else if(c.isSampledTexture){const u=this.textures.get(c.texture);c.needsBindingsUpdate(u.generation)&&(s=!0);const h=c.update(),f=c.texture;h&&this.textures.updateTexture(f);const d=i.get(f);if(d.externalTexture!==void 0||u.isDefaultTexture?o=!1:(a=a*10+f.id,l+=f.version),i.isWebGPUBackend===!0&&d.texture===void 0&&d.externalTexture===void 0&&(console.error("Bindings._update: binding should be available:",c,h,f,c.textureNode.value,s),this.textures.updateTexture(f),s=!0),f.isStorageTexture===!0){const p=this.get(f);c.store===!0?p.needsMipmap=!0:this.textures.needsMipmaps(f)&&p.needsMipmap===!0&&(this.backend.generateMipmaps(f),p.needsMipmap=!1)}}}s===!0&&this.backend.updateBindings(e,n,o?a:0,l)}}function Kke(r,e){return r.groupOrder!==e.groupOrder?r.groupOrder-e.groupOrder:r.renderOrder!==e.renderOrder?r.renderOrder-e.renderOrder:r.z!==e.z?r.z-e.z:r.id-e.id}function M5(r,e){return r.groupOrder!==e.groupOrder?r.groupOrder-e.groupOrder:r.renderOrder!==e.renderOrder?r.renderOrder-e.renderOrder:r.z!==e.z?e.z-r.z:r.id-e.id}function A5(r){return(r.transmission>0||r.transmissionNode)&&r.side===Es&&r.forceSinglePass===!1}class Yke{constructor(e,n,i){this.renderItems=[],this.renderItemsIndex=0,this.opaque=[],this.transparentDoublePass=[],this.transparent=[],this.bundles=[],this.lightsNode=e.getNode(n,i),this.lightsArray=[],this.scene=n,this.camera=i,this.occlusionQueryCount=0}begin(){return this.renderItemsIndex=0,this.opaque.length=0,this.transparentDoublePass.length=0,this.transparent.length=0,this.bundles.length=0,this.lightsArray.length=0,this.occlusionQueryCount=0,this}getNextRenderItem(e,n,i,s,o,a,l){let c=this.renderItems[this.renderItemsIndex];return c===void 0?(c={id:e.id,object:e,geometry:n,material:i,groupOrder:s,renderOrder:e.renderOrder,z:o,group:a,clippingContext:l},this.renderItems[this.renderItemsIndex]=c):(c.id=e.id,c.object=e,c.geometry=n,c.material=i,c.groupOrder=s,c.renderOrder=e.renderOrder,c.z=o,c.group=a,c.clippingContext=l),this.renderItemsIndex++,c}push(e,n,i,s,o,a,l){const c=this.getNextRenderItem(e,n,i,s,o,a,l);e.occlusionTest===!0&&this.occlusionQueryCount++,i.transparent===!0||i.transmission>0?(A5(i)&&this.transparentDoublePass.push(c),this.transparent.push(c)):this.opaque.push(c)}unshift(e,n,i,s,o,a,l){const c=this.getNextRenderItem(e,n,i,s,o,a,l);i.transparent===!0||i.transmission>0?(A5(i)&&this.transparentDoublePass.unshift(c),this.transparent.unshift(c)):this.opaque.unshift(c)}pushBundle(e){this.bundles.push(e)}pushLight(e){this.lightsArray.push(e)}sort(e,n){this.opaque.length>1&&this.opaque.sort(e||Kke),this.transparentDoublePass.length>1&&this.transparentDoublePass.sort(n||M5),this.transparent.length>1&&this.transparent.sort(n||M5)}finish(){this.lightsNode.setLights(this.lightsArray);for(let e=this.renderItemsIndex,n=this.renderItems.length;e<n;e++){const i=this.renderItems[e];if(i.id===null)break;i.id=null,i.object=null,i.geometry=null,i.material=null,i.groupOrder=null,i.renderOrder=null,i.z=null,i.group=null,i.clippingContext=null}}}const Rv=[];class Zke{constructor(e){this.lighting=e,this.lists=new sl}get(e,n){const i=this.lists;Rv[0]=e,Rv[1]=n;let s=i.get(Rv);return s===void 0&&(s=new Yke(this.lighting,e,n),i.set(Rv,s)),Rv.length=0,s}dispose(){this.lists=new sl}}let Qke=0;class Jke{constructor(){this.id=Qke++,this.color=!0,this.clearColor=!0,this.clearColorValue={r:0,g:0,b:0,a:1},this.depth=!0,this.clearDepth=!0,this.clearDepthValue=1,this.stencil=!1,this.clearStencil=!0,this.clearStencilValue=1,this.viewport=!1,this.viewportValue=new Nt,this.scissor=!1,this.scissorValue=new Nt,this.renderTarget=null,this.textures=null,this.depthTexture=null,this.activeCubeFace=0,this.activeMipmapLevel=0,this.sampleCount=1,this.width=0,this.height=0,this.occlusionQueryCount=0,this.clippingContext=null,this.isRenderContext=!0}getCacheKey(){return eee(this)}}function eee(r){const{textures:e,activeCubeFace:n}=r,i=[n];for(const s of e)i.push(s.id);return T3(i)}const Nv=[],eIe=new QM,tIe=new kF;class nIe{constructor(){this.chainMaps={}}get(e,n,i=null){Nv[0]=e,Nv[1]=n;let s;if(i===null)s="default";else{const l=i.texture.format;s=`${i.textures.length}:${l}:${i.samples}:${i.depthBuffer}:${i.stencilBuffer}`}const o=this._getChainMap(s);let a=o.get(Nv);return a===void 0&&(a=new Jke,o.set(Nv,a)),Nv.length=0,i!==null&&(a.sampleCount=i.samples===0?1:i.samples),a}getForClear(e=null){return this.get(eIe,tIe,e)}_getChainMap(e){return this.chainMaps[e]||(this.chainMaps[e]=new sl)}dispose(){this.chainMaps={}}}const rIe=new K;class iIe extends Kh{constructor(e,n,i){super(),this.renderer=e,this.backend=n,this.info=i}updateRenderTarget(e,n=0){const i=this.get(e),s=e.samples===0?1:e.samples,o=i.depthTextureMips||(i.depthTextureMips={}),a=e.textures,l=this.getSize(a[0]),c=l.width>>n,u=l.height>>n;let h=e.depthTexture||o[n];const f=e.depthBuffer===!0||e.stencilBuffer===!0;let d=!1;h===void 0&&f&&(e.multiview===!0&&l.depth>1?h=new NY:h=new ko,h.format=e.stencilBuffer?Do:Oo,h.type=e.stencilBuffer?No:In,h.image.width=c,h.image.height=u,h.image.depth=l.depth,o[n]=h),(i.width!==l.width||l.height!==i.height)&&(d=!0,h&&(h.needsUpdate=!0,h.image.width=c,h.image.height=u,h.image.depth=h.isDepthArrayTexture?h.image.depth:1)),i.width=l.width,i.height=l.height,i.textures=a,i.depthTexture=h||null,i.depth=e.depthBuffer,i.stencil=e.stencilBuffer,i.renderTarget=e,i.sampleCount!==s&&(d=!0,h&&(h.needsUpdate=!0),i.sampleCount=s);const p={sampleCount:s};if(e.isXRRenderTarget!==!0){for(let m=0;m<a.length;m++){const g=a[m];g.isTextureArray=e.multiview===!0&&l.depth>1,d&&(g.needsUpdate=!0),this.updateTexture(g,p)}h&&this.updateTexture(h,p)}if(i.initialized!==!0){i.initialized=!0;const m=()=>{e.removeEventListener("dispose",m);for(let g=0;g<a.length;g++)this._destroyTexture(a[g]);h&&this._destroyTexture(h),this.delete(e)};e.addEventListener("dispose",m)}}updateTexture(e,n={}){const i=this.get(e);if(i.initialized===!0&&i.version===e.version)return;const s=e.isRenderTargetTexture||e.isDepthTexture||e.isFramebufferTexture,o=this.backend;if(s&&i.initialized===!0&&(o.destroySampler(e),o.destroyTexture(e)),e.isFramebufferTexture){const u=this.renderer.getRenderTarget();u?e.type=u.texture.type:e.type=gr}const{width:a,height:l,depth:c}=this.getSize(e);if(n.width=a,n.height=l,n.depth=c,n.needsMipmaps=this.needsMipmaps(e),n.levels=n.needsMipmaps?this.getMipLevels(e,a,l):1,s||e.isStorageTexture===!0)o.createSampler(e),o.createTexture(e,n),i.generation=e.version;else if(i.initialized!==!0&&o.createSampler(e),e.version>0){const h=e.image;if(h===void 0)console.warn("THREE.Renderer: Texture marked for update but image is undefined.");else if(h.complete===!1)console.warn("THREE.Renderer: Texture marked for update but image is incomplete.");else{if(e.images){const f=[];for(const d of e.images)f.push(d);n.images=f}else n.image=h;(i.isDefaultTexture===void 0||i.isDefaultTexture===!0)&&(o.createTexture(e,n),i.isDefaultTexture=!1,i.generation=e.version),e.source.dataReady===!0&&o.updateTexture(e,n),n.needsMipmaps&&e.mipmaps.length===0&&o.generateMipmaps(e)}}else o.createDefaultTexture(e),i.isDefaultTexture=!0,i.generation=e.version;if(i.initialized!==!0){i.initialized=!0,i.generation=e.version,this.info.memory.textures++;const u=()=>{e.removeEventListener("dispose",u),this._destroyTexture(e)};e.addEventListener("dispose",u)}i.version=e.version}getSize(e,n=rIe){let i=e.images?e.images[0]:e.image;return i?(i.image!==void 0&&(i=i.image),n.width=i.width||1,n.height=i.height||1,n.depth=e.isCubeTexture?6:i.depth||1):n.width=n.height=n.depth=1,n}getMipLevels(e,n,i){let s;return e.isCompressedTexture?e.mipmaps?s=e.mipmaps.length:s=1:s=Math.floor(Math.log2(Math.max(n,i)))+1,s}needsMipmaps(e){return e.isCompressedTexture===!0||e.generateMipmaps}_destroyTexture(e){this.has(e)===!0&&(this.backend.destroySampler(e),this.backend.destroyTexture(e),this.delete(e),this.info.memory.textures--)}}class K3 extends pt{constructor(e,n,i,s=1){super(e,n,i),this.a=s}set(e,n,i,s=1){return this.a=s,super.set(e,n,i)}copy(e){return e.a!==void 0&&(this.a=e.a),super.copy(e)}clone(){return new this.constructor(this.r,this.g,this.b,this.a)}}class sIe extends Tn{static get type(){return"ParameterNode"}constructor(e,n=null){super(e,n),this.isParameterNode=!0}getHash(){return this.uuid}generate(){return this.name}}class oIe extends Vt{static get type(){return"StackNode"}constructor(e=null){super(),this.nodes=[],this.outputNode=null,this.parent=e,this._currentCond=null,this._expressionNode=null,this.isStackNode=!0}getNodeType(e){return this.outputNode?this.outputNode.getNodeType(e):"void"}getMemberType(e,n){return this.outputNode?this.outputNode.getMemberType(e,n):"void"}add(e){return this.nodes.push(e),this}If(e,n){const i=new l0(n);return this._currentCond=Ns(e,i),this.add(this._currentCond)}ElseIf(e,n){const i=new l0(n),s=Ns(e,i);return this._currentCond.elseNode=s,this._currentCond=s,this}Else(e){return this._currentCond.elseNode=new l0(e),this}Switch(e){return this._expressionNode=Le(e),this}Case(...e){const n=[];if(e.length>=2)for(let l=0;l<e.length-1;l++)n.push(this._expressionNode.equal(Le(e[l])));else throw new Error("TSL: Invalid parameter length. Case() requires at least two parameters.");const i=e[e.length-1],s=new l0(i);let o=n[0];for(let l=1;l<n.length;l++)o=o.or(n[l]);const a=Ns(o,s);return this._currentCond===null?(this._currentCond=a,this.add(this._currentCond)):(this._currentCond.elseNode=a,this._currentCond=a,this)}Default(e){return this.Else(e),this}build(e,...n){const i=GQ();uE(this);for(const s of this.nodes)s.build(e,"void");return uE(i),this.outputNode?this.outputNode.build(e,...n):super.build(e,...n)}else(...e){return console.warn("THREE.TSL: .else() has been renamed to .Else()."),this.Else(...e)}elseif(...e){return console.warn("THREE.TSL: .elseif() has been renamed to .ElseIf()."),this.ElseIf(...e)}}const gN=Ne(oIe).setParameterLength(0,1);new To;new K;new K;new K;new sn;new K(0,0,-1);new Nt;new K;new K;new Nt;new Fe;const aIe=new $h;Bm.flipX();aIe.depthTexture=new ko(1,1);const yN=new y_(-1,1,1,-1,0,1);class lIe extends ji{constructor(e=!1){super();const n=e===!1?[0,-1,0,1,2,1]:[0,2,0,0,2,0];this.setAttribute("position",new Dr([-1,3,0,-1,-1,0,3,-1,0],3)),this.setAttribute("uv",new Dr(n,2))}}const cIe=new lIe;class tee extends Jn{constructor(e=null){super(cIe,e),this.camera=yN,this.isQuadMesh=!0}async renderAsync(e){return e.renderAsync(this,yN)}render(e){e.render(this,yN)}}const Ov=new so,vN=new sn;class Qs extends Vt{static get type(){return"SceneNode"}constructor(e=Qs.BACKGROUND_BLURRINESS,n=null){super(),this.scope=e,this.scene=n}setup(e){const n=this.scope,i=this.scene!==null?this.scene:e.scene;let s;return n===Qs.BACKGROUND_BLURRINESS?s=kn("backgroundBlurriness","float",i):n===Qs.BACKGROUND_INTENSITY?s=kn("backgroundIntensity","float",i):n===Qs.BACKGROUND_ROTATION?s=Ft("mat4").label("backgroundRotation").setGroup(Lt).onRenderUpdate(()=>{const o=i.background;return o!==null&&o.isTexture&&o.mapping!==vF?(Ov.copy(i.backgroundRotation),Ov.x*=-1,Ov.y*=-1,Ov.z*=-1,vN.makeRotationFromEuler(Ov)):vN.identity(),vN}):console.error("THREE.SceneNode: Unknown scope:",n),s}}Qs.BACKGROUND_BLURRINESS="backgroundBlurriness";Qs.BACKGROUND_INTENSITY="backgroundIntensity";Qs.BACKGROUND_ROTATION="backgroundRotation";const uIe=je(Qs,Qs.BACKGROUND_BLURRINESS),C5=je(Qs,Qs.BACKGROUND_INTENSITY),hIe=je(Qs,Qs.BACKGROUND_ROTATION),fIe=Oe(({texture:r,uv:e})=>{const i=Ae().toVar();return kr(e.x.lessThan(1e-4),()=>{i.assign(Ae(1,0,0))}).ElseIf(e.y.lessThan(1e-4),()=>{i.assign(Ae(0,1,0))}).ElseIf(e.z.lessThan(1e-4),()=>{i.assign(Ae(0,0,1))}).ElseIf(e.x.greaterThan(1-1e-4),()=>{i.assign(Ae(-1,0,0))}).ElseIf(e.y.greaterThan(1-1e-4),()=>{i.assign(Ae(0,-1,0))}).ElseIf(e.z.greaterThan(1-1e-4),()=>{i.assign(Ae(0,0,-1))}).Else(()=>{const o=r.sample(e.add(Ae(-.01,0,0))).r.sub(r.sample(e.add(Ae(.01,0,0))).r),a=r.sample(e.add(Ae(0,-.01,0))).r.sub(r.sample(e.add(Ae(0,.01,0))).r),l=r.sample(e.add(Ae(0,0,-.01))).r.sub(r.sample(e.add(Ae(0,0,.01))).r);i.assign(Ae(o,a,l))}),i.normalize()});class dIe extends Ty{static get type(){return"Texture3DNode"}constructor(e,n=null,i=null){super(e,n,i),this.isTexture3DNode=!0}getInputType(){return"texture3D"}getDefaultUV(){return Ae(.5,.5,.5)}setUpdateMatrix(){}setupUV(e,n){const i=this.value;return e.isFlipY()&&(i.isRenderTargetTexture===!0||i.isFramebufferTexture===!0)&&(this.sampler?n=n.flipY():n=n.setY(zn(Fm(this,this.levelNode).y).sub(n.y).sub(1))),n}generateUV(e,n){return n.build(e,"vec3")}normal(e){return fIe({texture:this,uv:e})}}const pIe=Ne(dIe).setParameterLength(1,3),OS=new Fe;class mIe extends Ty{static get type(){return"PassTextureNode"}constructor(e,n){super(n),this.passNode=e,this.setUpdateMatrix(!1)}setup(e){return e.object.isQuadMesh&&this.passNode.build(e),super.setup(e)}clone(){return new this.constructor(this.passNode,this.value)}}class P5 extends mIe{static get type(){return"PassMultipleTextureNode"}constructor(e,n,i=!1){super(e,null),this.textureName=n,this.previousTexture=i}updateTexture(){this.value=this.previousTexture?this.passNode.getPreviousTexture(this.textureName):this.passNode.getTexture(this.textureName)}setup(e){return this.updateTexture(),super.setup(e)}clone(){return new this.constructor(this.passNode,this.textureName,this.previousTexture)}}class EA extends Qr{static get type(){return"PassNode"}constructor(e,n,i,s={}){super("vec4"),this.scope=e,this.scene=n,this.camera=i,this.options=s,this._pixelRatio=1,this._width=1,this._height=1;const o=new ko;o.isRenderTargetTexture=!0,o.name="depth";const a=new $h(this._width*this._pixelRatio,this._height*this._pixelRatio,{type:Ei,...s});a.texture.name="output",a.depthTexture=o,this.renderTarget=a,this._textures={output:a.texture,depth:o},this._textureNodes={},this._linearDepthNodes={},this._viewZNodes={},this._previousTextures={},this._previousTextureNodes={},this._cameraNear=Ft(0),this._cameraFar=Ft(0),this._mrt=null,this._layers=null,this._resolution=1,this.isPassNode=!0,this.updateBeforeType=Jt.FRAME}setResolution(e){return this._resolution=e,this}getResolution(){return this._resolution}setLayers(e){return this._layers=e,this}getLayers(){return this._layers}setMRT(e){return this._mrt=e,this}getMRT(){return this._mrt}isGlobal(){return!0}getTexture(e){let n=this._textures[e];return n===void 0&&(n=this.renderTarget.texture.clone(),n.name=e,this._textures[e]=n,this.renderTarget.textures.push(n)),n}getPreviousTexture(e){let n=this._previousTextures[e];return n===void 0&&(n=this.getTexture(e).clone(),this._previousTextures[e]=n),n}toggleTexture(e){const n=this._previousTextures[e];if(n!==void 0){const i=this._textures[e],s=this.renderTarget.textures.indexOf(i);this.renderTarget.textures[s]=n,this._textures[e]=n,this._previousTextures[e]=i,this._textureNodes[e].updateTexture(),this._previousTextureNodes[e].updateTexture()}}getTextureNode(e="output"){let n=this._textureNodes[e];return n===void 0&&(n=Le(new P5(this,e)),n.updateTexture(),this._textureNodes[e]=n),n}getPreviousTextureNode(e="output"){let n=this._previousTextureNodes[e];return n===void 0&&(this._textureNodes[e]===void 0&&this.getTextureNode(e),n=Le(new P5(this,e,!0)),n.updateTexture(),this._previousTextureNodes[e]=n),n}getViewZNode(e="depth"){let n=this._viewZNodes[e];if(n===void 0){const i=this._cameraNear,s=this._cameraFar;this._viewZNodes[e]=n=NJ(this.getTextureNode(e),i,s)}return n}getLinearDepthNode(e="depth"){let n=this._linearDepthNodes[e];if(n===void 0){const i=this._cameraNear,s=this._cameraFar,o=this.getViewZNode(e);this._linearDepthNodes[e]=n=V0(o,i,s)}return n}setup({renderer:e}){return this.renderTarget.samples=this.options.samples===void 0?e.samples:this.options.samples,e.backend.isWebGLBackend===!0&&(this.renderTarget.samples=0),this.renderTarget.texture.type=e.getColorBufferType(),this.scope===EA.COLOR?this.getTextureNode():this.getLinearDepthNode()}updateBefore(e){const{renderer:n}=e,{scene:i}=this;let s,o;const a=n.getOutputRenderTarget();a&&a.isXRRenderTarget===!0?(o=1,s=n.xr.getCamera(),n.xr.updateCamera(s),OS.set(a.width,a.height)):(s=this.camera,o=n.getPixelRatio(),n.getSize(OS)),this._pixelRatio=o,this.setSize(OS.width,OS.height);const l=n.getRenderTarget(),c=n.getMRT(),u=s.layers.mask;this._cameraNear.value=s.near,this._cameraFar.value=s.far,this._layers!==null&&(s.layers.mask=this._layers.mask);for(const h in this._previousTextures)this.toggleTexture(h);n.setRenderTarget(this.renderTarget),n.setMRT(this._mrt),n.render(i,s),n.setRenderTarget(l),n.setMRT(c),s.layers.mask=u}setSize(e,n){this._width=e,this._height=n;const i=this._width*this._pixelRatio*this._resolution,s=this._height*this._pixelRatio*this._resolution;this.renderTarget.setSize(i,s)}setPixelRatio(e){this._pixelRatio=e,this.setSize(this._width,this._height)}dispose(){this.renderTarget.dispose()}}EA.COLOR="color";EA.DEPTH="depth";const gIe=Oe(([r,e])=>r.mul(e).clamp()).setLayout({name:"linearToneMapping",type:"vec3",inputs:[{name:"color",type:"vec3"},{name:"exposure",type:"float"}]}),yIe=Oe(([r,e])=>(r=r.mul(e),r.div(r.add(1)).clamp())).setLayout({name:"reinhardToneMapping",type:"vec3",inputs:[{name:"color",type:"vec3"},{name:"exposure",type:"float"}]}),vIe=Oe(([r,e])=>{r=r.mul(e),r=r.sub(.004).max(0);const n=r.mul(r.mul(6.2).add(.5)),i=r.mul(r.mul(6.2).add(1.7)).add(.06);return n.div(i).pow(2.2)}).setLayout({name:"cineonToneMapping",type:"vec3",inputs:[{name:"color",type:"vec3"},{name:"exposure",type:"float"}]}),xIe=Oe(([r])=>{const e=r.mul(r.add(.0245786)).sub(90537e-9),n=r.mul(r.add(.432951).mul(.983729)).add(.238081);return e.div(n)}),bIe=Oe(([r,e])=>{const n=Ds(.59719,.35458,.04823,.076,.90834,.01566,.0284,.13383,.83777),i=Ds(1.60475,-.53108,-.07367,-.10208,1.10813,-.00605,-.00327,-.07276,1.07602);return r=r.mul(e).div(.6),r=n.mul(r),r=xIe(r),r=i.mul(r),r.clamp()}).setLayout({name:"acesFilmicToneMapping",type:"vec3",inputs:[{name:"color",type:"vec3"},{name:"exposure",type:"float"}]}),_Ie=Ds(Ae(1.6605,-.1246,-.0182),Ae(-.5876,1.1329,-.1006),Ae(-.0728,-.0083,1.1187)),wIe=Ds(Ae(.6274,.0691,.0164),Ae(.3293,.9195,.088),Ae(.0433,.0113,.8956)),SIe=Oe(([r])=>{const e=Ae(r).toVar(),n=Ae(e.mul(e)).toVar(),i=Ae(n.mul(n)).toVar();return Te(15.5).mul(i.mul(n)).sub(rn(40.14,i.mul(e))).add(rn(31.96,i).sub(rn(6.868,n.mul(e))).add(rn(.4298,n).add(rn(.1191,e).sub(.00232))))}),TIe=Oe(([r,e])=>{const n=Ae(r).toVar(),i=Ds(Ae(.856627153315983,.137318972929847,.11189821299995),Ae(.0951212405381588,.761241990602591,.0767994186031903),Ae(.0482516061458583,.101439036467562,.811302368396859)),s=Ds(Ae(1.1271005818144368,-.1413297634984383,-.14132976349843826),Ae(-.11060664309660323,1.157823702216272,-.11060664309660294),Ae(-.016493938717834573,-.016493938717834257,1.2519364065950405)),o=Te(-12.47393),a=Te(4.026069);return n.mulAssign(e),n.assign(wIe.mul(n)),n.assign(i.mul(n)),n.assign(ao(n,1e-10)),n.assign(Xc(n)),n.assign(n.sub(o).div(a.sub(o))),n.assign(hu(n,0,1)),n.assign(SIe(n)),n.assign(s.mul(n)),n.assign(gA(ao(Ae(0),n),Ae(2.2))),n.assign(_Ie.mul(n)),n.assign(hu(n,0,1)),n}).setLayout({name:"agxToneMapping",type:"vec3",inputs:[{name:"color",type:"vec3"},{name:"exposure",type:"float"}]}),EIe=Oe(([r,e])=>{const n=Te(.76),i=Te(.15);r=r.mul(e);const s=lb(r.r,lb(r.g,r.b)),o=Ns(s.lessThan(.08),s.sub(rn(6.25,s.mul(s))),.04);r.subAssign(o);const a=ao(r.r,ao(r.g,r.b));kr(a.lessThan(n),()=>r);const l=qs(1,n),c=qs(1,l.mul(l).div(a.add(l.sub(n))));r.mulAssign(c.div(a));const u=qs(1,uu(1,i.mul(a.sub(c)).add(1)));return Yn(r,Ae(c),u)}).setLayout({name:"neutralToneMapping",type:"vec3",inputs:[{name:"color",type:"vec3"},{name:"exposure",type:"float"}]});class si extends Vt{static get type(){return"CodeNode"}constructor(e="",n=[],i=""){super("code"),this.isCodeNode=!0,this.code=e,this.includes=n,this.language=i}isGlobal(){return!0}setIncludes(e){return this.includes=e,this}getIncludes(){return this.includes}generate(e){const n=this.getIncludes(e);for(const s of n)s.build(e);const i=e.getCodeFromNode(this,this.getNodeType(e));return i.code=this.code,i.code}serialize(e){super.serialize(e),e.code=this.code,e.language=this.language}deserialize(e){super.deserialize(e),this.code=e.code,this.language=e.language}}class MIe extends si{static get type(){return"FunctionNode"}constructor(e="",n=[],i=""){super(e,n,i)}getNodeType(e){return this.getNodeFunction(e).type}getInputs(e){return this.getNodeFunction(e).inputs}getNodeFunction(e){const n=e.getDataFromNode(this);let i=n.nodeFunction;return i===void 0&&(i=e.parser.parseFunction(this.code),n.nodeFunction=i),i}generate(e,n){super.generate(e);const i=this.getNodeFunction(e),s=i.name,o=i.type,a=e.getCodeFromNode(this,o);s!==""&&(a.name=s);const l=e.getPropertyName(a),c=this.getNodeFunction(e).getCode(l);return a.code=c+`
`,n==="property"?l:e.format(`${l}()`,o,n)}}function nee(r){let e;const n=r.context.getViewZ;return n!==void 0&&(e=n(this)),(e||Kr.z).negate()}const AIe=Oe(([r,e],n)=>{const i=nee(n);return Oh(r,e,i)}),CIe=Oe(([r],e)=>{const n=nee(e);return r.mul(r,n,n).negate().exp().oneMinus()}),R5=Oe(([r,e])=>jt(e.toFloat().mix($0.rgb,r.toVec3()),$0.a));class PIe extends Vt{constructor(e){super(),this.scope=e}generate(e){const{scope:n}=this,{renderer:i}=e;i.backend.isWebGLBackend===!0?e.addFlowCode(`	// ${n}Barrier 
`):e.addLineFlowCode(`${n}Barrier()`,this)}}Ne(PIe);class Hl extends Vt{static get type(){return"AtomicFunctionNode"}constructor(e,n,i){super("uint"),this.method=e,this.pointerNode=n,this.valueNode=i,this.parents=!0}getInputType(e){return this.pointerNode.getNodeType(e)}getNodeType(e){return this.getInputType(e)}generate(e){const n=e.getNodeProperties(this),i=n.parents,s=this.method,o=this.getNodeType(e),a=this.getInputType(e),l=this.pointerNode,c=this.valueNode,u=[];u.push(`&${l.build(e,a)}`),c!==null&&u.push(c.build(e,a));const h=`${e.getMethod(s,o)}( ${u.join(", ")} )`;if(i.length===1&&i[0].isStackNode===!0)e.addLineFlowCode(h,this);else return n.constNode===void 0&&(n.constNode=Eg(h,o).toConst()),n.constNode.build(e)}}Hl.ATOMIC_LOAD="atomicLoad";Hl.ATOMIC_STORE="atomicStore";Hl.ATOMIC_ADD="atomicAdd";Hl.ATOMIC_SUB="atomicSub";Hl.ATOMIC_MAX="atomicMax";Hl.ATOMIC_MIN="atomicMin";Hl.ATOMIC_AND="atomicAnd";Hl.ATOMIC_OR="atomicOr";Hl.ATOMIC_XOR="atomicXor";Ne(Hl);let DS;function MA(r){DS=DS||new WeakMap;let e=DS.get(r);return e===void 0&&DS.set(r,e={}),e}function ree(r){const e=MA(r);return e.shadowMatrix||(e.shadowMatrix=Ft("mat4").setGroup(Lt).onRenderUpdate(()=>(r.castShadow!==!0&&r.shadow.updateMatrices(r),r.shadow.matrix)))}function RIe(r,e=cb){const n=ree(r).mul(e);return n.xyz.div(n.w)}function iee(r){const e=MA(r);return e.position||(e.position=Ft(new K).setGroup(Lt).onRenderUpdate((n,i)=>i.value.setFromMatrixPosition(r.matrixWorld)))}function NIe(r){const e=MA(r);return e.targetPosition||(e.targetPosition=Ft(new K).setGroup(Lt).onRenderUpdate((n,i)=>i.value.setFromMatrixPosition(r.target.matrixWorld)))}function see(r){const e=MA(r);return e.viewPosition||(e.viewPosition=Ft(new K).setGroup(Lt).onRenderUpdate(({camera:n},i)=>{i.value=i.value||new K,i.value.setFromMatrixPosition(r.matrixWorld),i.value.applyMatrix4(n.matrixWorldInverse)}))}const oee=r=>bu.transformDirection(iee(r).sub(NIe(r))),OIe=r=>r.sort((e,n)=>e.id-n.id),DIe=(r,e)=>{for(const n of e)if(n.isAnalyticLightNode&&n.light.id===r)return n;return null},xN=new WeakMap;class aee extends Vt{static get type(){return"LightsNode"}constructor(){super("vec3"),this.totalDiffuseNode=Ae().toVar(),this.totalSpecularNode=Ae().toVar(),this.outgoingLightNode=Ae().toVar(),this._lights=[],this._lightNodes=null,this._lightNodesHash=null,this.global=!0}customCacheKey(){const e=[],n=this._lights;for(let i=0;i<n.length;i++){const s=n[i];if(e.push(s.id),s.isSpotLight===!0){const o=s.map!==null?s.map.id:-1;e.push(o)}}return T3(e)}getHash(e){if(this._lightNodesHash===null){this._lightNodes===null&&this.setupLightsNode(e);const n=[];for(const i of this._lightNodes)n.push(i.getSelf().getHash());this._lightNodesHash="lights-"+n.join(",")}return this._lightNodesHash}analyze(e){const n=e.getDataFromNode(this);for(const i of n.nodes)i.build(e)}setupLightsNode(e){const n=[],i=this._lightNodes,s=OIe(this._lights),o=e.renderer.library;for(const a of s)if(a.isNode)n.push(Le(a));else{let l=null;if(i!==null&&(l=DIe(a.id,i)),l===null){const c=o.getLightNodeClass(a.constructor);if(c===null){console.warn(`LightsNode.setupNodeLights: Light node not found for ${a.constructor.name}`);continue}let u=null;xN.has(a)?u=xN.get(a):(u=Le(new c(a)),xN.set(a,u)),n.push(u)}}this._lightNodes=n}setupDirectLight(e,n,i){const{lightingModel:s,reflectedLight:o}=e.context;s.direct({...i,lightNode:n,reflectedLight:o},e)}setupDirectRectAreaLight(e,n,i){const{lightingModel:s,reflectedLight:o}=e.context;s.directRectArea({...i,lightNode:n,reflectedLight:o},e)}setupLights(e,n){for(const i of n)i.build(e)}getLightNodes(e){return this._lightNodes===null&&this.setupLightsNode(e),this._lightNodes}setup(e){const n=e.lightsNode;e.lightsNode=this;let i=this.outgoingLightNode;const s=e.context,o=s.lightingModel,a=e.getDataFromNode(this);if(o){const{totalDiffuseNode:l,totalSpecularNode:c}=this;s.outgoingLight=i;const u=e.addStack();a.nodes=u.nodes,o.start(e);const{backdrop:h,backdropAlpha:f}=s,{directDiffuse:d,directSpecular:p,indirectDiffuse:m,indirectSpecular:g}=s.reflectedLight;let v=d.add(m);h!==null&&(f!==null?v=Ae(f.mix(v,h)):v=Ae(h),s.material.transparent=!0),l.assign(v),c.assign(p.add(g)),i.assign(l.add(c)),o.finish(e),i=i.bypass(e.removeStack())}else a.nodes=[];return e.lightsNode=n,i}setLights(e){return this._lights=e,this._lightNodes=null,this._lightNodesHash=null,this}getLights(){return this._lights}get hasLights(){return this._lights.length>0}}class kIe extends Vt{static get type(){return"ShadowBaseNode"}constructor(e){super(),this.light=e,this.updateBeforeType=Jt.RENDER,this.isShadowBaseNode=!0}setupShadowPosition({context:e,material:n}){lee.assign(n.receivedShadowPositionNode||e.shadowPositionWorld||cb)}dispose(){this.updateBeforeType=Jt.NONE}}const lee=M_("vec3","shadowPositionWorld");function IIe(r,e={}){return e.toneMapping=r.toneMapping,e.toneMappingExposure=r.toneMappingExposure,e.outputColorSpace=r.outputColorSpace,e.renderTarget=r.getRenderTarget(),e.activeCubeFace=r.getActiveCubeFace(),e.activeMipmapLevel=r.getActiveMipmapLevel(),e.renderObjectFunction=r.getRenderObjectFunction(),e.pixelRatio=r.getPixelRatio(),e.mrt=r.getMRT(),e.clearColor=r.getClearColor(e.clearColor||new pt),e.clearAlpha=r.getClearAlpha(),e.autoClear=r.autoClear,e.scissorTest=r.getScissorTest(),e}function LIe(r,e){return e=IIe(r,e),r.setMRT(null),r.setRenderObjectFunction(null),r.setClearColor(0,1),r.autoClear=!0,e}function FIe(r,e){r.toneMapping=e.toneMapping,r.toneMappingExposure=e.toneMappingExposure,r.outputColorSpace=e.outputColorSpace,r.setRenderTarget(e.renderTarget,e.activeCubeFace,e.activeMipmapLevel),r.setRenderObjectFunction(e.renderObjectFunction),r.setPixelRatio(e.pixelRatio),r.setMRT(e.mrt),r.setClearColor(e.clearColor,e.clearAlpha),r.autoClear=e.autoClear,r.setScissorTest(e.scissorTest)}function BIe(r,e={}){return e.background=r.background,e.backgroundNode=r.backgroundNode,e.overrideMaterial=r.overrideMaterial,e}function UIe(r,e){return e=BIe(r,e),r.background=null,r.backgroundNode=null,r.overrideMaterial=null,e}function zIe(r,e){r.background=e.background,r.backgroundNode=e.backgroundNode,r.overrideMaterial=e.overrideMaterial}function $Ie(r,e,n){return n=LIe(r,n),n=UIe(e,n),n}function jIe(r,e,n){FIe(r,n),zIe(e,n)}const N5=new WeakMap,VIe=Oe(({depthTexture:r,shadowCoord:e,depthLayer:n})=>{let i=cn(r,e.xy).label("t_basic");return r.isDepthArrayTexture&&(i=i.depth(n)),i.compare(e.z)}),GIe=Oe(({depthTexture:r,shadowCoord:e,shadow:n,depthLayer:i})=>{const s=(v,y)=>{let x=cn(r,v);return r.isDepthArrayTexture&&(x=x.depth(i)),x.compare(y)},o=kn("mapSize","vec2",n).setGroup(Lt),a=kn("radius","float",n).setGroup(Lt),l=Ve(1).div(o),c=l.x.negate().mul(a),u=l.y.negate().mul(a),h=l.x.mul(a),f=l.y.mul(a),d=c.div(2),p=u.div(2),m=h.div(2),g=f.div(2);return ks(s(e.xy.add(Ve(c,u)),e.z),s(e.xy.add(Ve(0,u)),e.z),s(e.xy.add(Ve(h,u)),e.z),s(e.xy.add(Ve(d,p)),e.z),s(e.xy.add(Ve(0,p)),e.z),s(e.xy.add(Ve(m,p)),e.z),s(e.xy.add(Ve(c,0)),e.z),s(e.xy.add(Ve(d,0)),e.z),s(e.xy,e.z),s(e.xy.add(Ve(m,0)),e.z),s(e.xy.add(Ve(h,0)),e.z),s(e.xy.add(Ve(d,g)),e.z),s(e.xy.add(Ve(0,g)),e.z),s(e.xy.add(Ve(m,g)),e.z),s(e.xy.add(Ve(c,f)),e.z),s(e.xy.add(Ve(0,f)),e.z),s(e.xy.add(Ve(h,f)),e.z)).mul(1/17)}),HIe=Oe(({depthTexture:r,shadowCoord:e,shadow:n,depthLayer:i})=>{const s=(f,d)=>{let p=cn(r,f);return r.isDepthArrayTexture&&(p=p.depth(i)),p.compare(d)},o=kn("mapSize","vec2",n).setGroup(Lt),a=Ve(1).div(o),l=a.x,c=a.y,u=e.xy,h=Xh(u.mul(o).add(.5));return u.subAssign(h.mul(a)),ks(s(u,e.z),s(u.add(Ve(l,0)),e.z),s(u.add(Ve(0,c)),e.z),s(u.add(a),e.z),Yn(s(u.add(Ve(l.negate(),0)),e.z),s(u.add(Ve(l.mul(2),0)),e.z),h.x),Yn(s(u.add(Ve(l.negate(),c)),e.z),s(u.add(Ve(l.mul(2),c)),e.z),h.x),Yn(s(u.add(Ve(0,c.negate())),e.z),s(u.add(Ve(0,c.mul(2))),e.z),h.y),Yn(s(u.add(Ve(l,c.negate())),e.z),s(u.add(Ve(l,c.mul(2))),e.z),h.y),Yn(Yn(s(u.add(Ve(l.negate(),c.negate())),e.z),s(u.add(Ve(l.mul(2),c.negate())),e.z),h.x),Yn(s(u.add(Ve(l.negate(),c.mul(2))),e.z),s(u.add(Ve(l.mul(2),c.mul(2))),e.z),h.x),h.y)).mul(1/9)}),WIe=Oe(({depthTexture:r,shadowCoord:e,depthLayer:n})=>{const i=Te(1).toVar();let s=cn(r).sample(e.xy);(r.isDepthArrayTexture||r.isDataArrayTexture)&&(s=s.depth(n)),s=s.rg;const o=aJ(e.z,s.x);return kr(o.notEqual(Te(1)),()=>{const a=e.z.sub(s.x),l=ao(0,s.y.mul(s.y));let c=l.div(l.add(a.mul(a)));c=hu(qs(c,.3).div(.95-.3)),i.assign(hu(ao(o,c)))}),i}),qIe=Oe(([r,e,n])=>{let i=cb.sub(r).length();return i=i.sub(e).div(n.sub(e)),i=i.saturate(),i}),XIe=r=>{const e=r.shadow.camera,n=kn("near","float",e).setGroup(Lt),i=kn("far","float",e).setGroup(Lt),s=R2e(r);return qIe(s,n,i)},KIe=r=>{let e=N5.get(r);if(e===void 0){const n=r.isPointLight?XIe(r):null;e=new mi,e.colorNode=jt(0,0,0,1),e.depthNode=n,e.isShadowPassMaterial=!0,e.name="ShadowMaterial",e.fog=!1,N5.set(r,e)}return e},O5=new sl,Mp=[],YIe=(r,e,n,i)=>{Mp[0]=r,Mp[1]=e;let s=O5.get(Mp);return(s===void 0||s.shadowType!==n||s.useVelocity!==i)&&(s=(o,a,l,c,u,h,...f)=>{(o.castShadow===!0||o.receiveShadow&&n===wo)&&(i&&(UQ(o).useVelocity=!0),o.onBeforeShadow(r,o,l,e.camera,c,a.overrideMaterial,h),r.renderObject(o,a,l,c,u,h,...f),o.onAfterShadow(r,o,l,e.camera,c,a.overrideMaterial,h))},s.shadowType=n,s.useVelocity=i,O5.set(Mp,s)),Mp[0]=null,Mp[1]=null,s},ZIe=Oe(({samples:r,radius:e,size:n,shadowPass:i,depthLayer:s})=>{const o=Te(0).toVar("meanVertical"),a=Te(0).toVar("squareMeanVertical"),l=r.lessThanEqual(Te(1)).select(Te(0),Te(2).div(r.sub(1))),c=r.lessThanEqual(Te(1)).select(Te(0),Te(-1));Wa({start:zn(0),end:zn(r),type:"int",condition:"<"},({i:h})=>{const f=c.add(Te(h).mul(l));let d=i.sample(ks(wA.xy,Ve(0,f).mul(e)).div(n));(i.value.isDepthArrayTexture||i.value.isDataArrayTexture)&&(d=d.depth(s)),d=d.x,o.addAssign(d),a.addAssign(d.mul(d))}),o.divAssign(r),a.divAssign(r);const u=D3(a.sub(o.mul(o)));return Ve(o,u)}),QIe=Oe(({samples:r,radius:e,size:n,shadowPass:i,depthLayer:s})=>{const o=Te(0).toVar("meanHorizontal"),a=Te(0).toVar("squareMeanHorizontal"),l=r.lessThanEqual(Te(1)).select(Te(0),Te(2).div(r.sub(1))),c=r.lessThanEqual(Te(1)).select(Te(0),Te(-1));Wa({start:zn(0),end:zn(r),type:"int",condition:"<"},({i:h})=>{const f=c.add(Te(h).mul(l));let d=i.sample(ks(wA.xy,Ve(f,0).mul(e)).div(n));(i.value.isDepthArrayTexture||i.value.isDataArrayTexture)&&(d=d.depth(s)),o.addAssign(d.x),a.addAssign(ks(d.y.mul(d.y),d.x.mul(d.x)))}),o.divAssign(r),a.divAssign(r);const u=D3(a.sub(o.mul(o)));return Ve(o,u)}),JIe=[VIe,GIe,HIe,WIe];let bN;const kS=new tee;class cee extends kIe{static get type(){return"ShadowNode"}constructor(e,n=null){super(e),this.shadow=n||e.shadow,this.shadowMap=null,this.vsmShadowMapVertical=null,this.vsmShadowMapHorizontal=null,this.vsmMaterialVertical=null,this.vsmMaterialHorizontal=null,this._node=null,this._cameraFrameId=new WeakMap,this.isShadowNode=!0,this.depthLayer=0}setupShadowFilter(e,{filterFn:n,depthTexture:i,shadowCoord:s,shadow:o,depthLayer:a}){const l=s.x.greaterThanEqual(0).and(s.x.lessThanEqual(1)).and(s.y.greaterThanEqual(0)).and(s.y.lessThanEqual(1)).and(s.z.lessThanEqual(1)),c=n({depthTexture:i,shadowCoord:s,shadow:o,depthLayer:a});return l.select(c,Te(1))}setupShadowCoord(e,n){const{shadow:i}=this,{renderer:s}=e,o=kn("bias","float",i).setGroup(Lt);let a=n,l;if(i.camera.isOrthographicCamera||s.logarithmicDepthBuffer!==!0)a=a.xyz.div(a.w),l=a.z,s.coordinateSystem===Ph&&(l=l.mul(2).sub(1));else{const c=a.w;a=a.xy.div(c);const u=kn("near","float",i.camera).setGroup(Lt),h=kn("far","float",i.camera).setGroup(Lt);l=OJ(c.negate(),u,h)}return a=Ae(a.x,a.y.oneMinus(),l.add(o)),a}getShadowFilterFn(e){return JIe[e]}setupRenderTarget(e,n){const i=new ko(e.mapSize.width,e.mapSize.height);i.name="ShadowDepthTexture",i.compareFunction=qM;const s=n.createRenderTarget(e.mapSize.width,e.mapSize.height);return s.texture.name="ShadowMap",s.texture.type=e.mapType,s.depthTexture=i,{shadowMap:s,depthTexture:i}}setupShadow(e){const{renderer:n}=e,{light:i,shadow:s}=this,o=n.shadowMap.type,{depthTexture:a,shadowMap:l}=this.setupRenderTarget(s,e);if(s.camera.updateProjectionMatrix(),o===wo){a.compareFunction=null,l.isRenderTargetArray?(l._vsmShadowMapVertical||(l._vsmShadowMapVertical=e.createRenderTargetArray(s.mapSize.width,s.mapSize.height,l.depth,{format:kc,type:Ei,depthBuffer:!1}),l._vsmShadowMapVertical.texture.name="VSMVertical"),this.vsmShadowMapVertical=l._vsmShadowMapVertical,l._vsmShadowMapHorizontal||(l._vsmShadowMapHorizontal=e.createRenderTargetArray(s.mapSize.width,s.mapSize.height,l.depth,{format:kc,type:Ei,depthBuffer:!1}),l._vsmShadowMapHorizontal.texture.name="VSMHorizontal"),this.vsmShadowMapHorizontal=l._vsmShadowMapHorizontal):(this.vsmShadowMapVertical=e.createRenderTarget(s.mapSize.width,s.mapSize.height,{format:kc,type:Ei,depthBuffer:!1}),this.vsmShadowMapHorizontal=e.createRenderTarget(s.mapSize.width,s.mapSize.height,{format:kc,type:Ei,depthBuffer:!1}));let y=cn(a);a.isDepthArrayTexture&&(y=y.depth(this.depthLayer));let x=cn(this.vsmShadowMapVertical.texture);a.isDepthArrayTexture&&(x=x.depth(this.depthLayer));const b=kn("blurSamples","float",s).setGroup(Lt),w=kn("radius","float",s).setGroup(Lt),_=kn("mapSize","vec2",s).setGroup(Lt);let S=this.vsmMaterialVertical||(this.vsmMaterialVertical=new mi);S.fragmentNode=ZIe({samples:b,radius:w,size:_,shadowPass:y,depthLayer:this.depthLayer}).context(e.getSharedContext()),S.name="VSMVertical",S=this.vsmMaterialHorizontal||(this.vsmMaterialHorizontal=new mi),S.fragmentNode=QIe({samples:b,radius:w,size:_,shadowPass:x,depthLayer:this.depthLayer}).context(e.getSharedContext()),S.name="VSMHorizontal"}const c=kn("intensity","float",s).setGroup(Lt),u=kn("normalBias","float",s).setGroup(Lt),h=ree(i).mul(lee.add(j3.mul(u))),f=this.setupShadowCoord(e,h),d=s.filterNode||this.getShadowFilterFn(n.shadowMap.type)||null;if(d===null)throw new Error("THREE.WebGPURenderer: Shadow map type not supported yet.");const p=o===wo?this.vsmShadowMapHorizontal.texture:a,m=this.setupShadowFilter(e,{filterFn:d,shadowTexture:l.texture,depthTexture:p,shadowCoord:f,shadow:s,depthLayer:this.depthLayer});let g=cn(l.texture,f);a.isDepthArrayTexture&&(g=g.depth(this.depthLayer));const v=Yn(1,m.rgb.mix(g,1),c.mul(g.a)).toVar();return this.shadowMap=l,this.shadow.map=l,v}setup(e){if(e.renderer.shadowMap.enabled!==!1)return Oe(()=>{let n=this._node;return this.setupShadowPosition(e),n===null&&(this._node=n=this.setupShadow(e)),e.material.shadowNode&&console.warn('THREE.NodeMaterial: ".shadowNode" is deprecated. Use ".castShadowNode" instead.'),e.material.receivedShadowNode&&(n=e.material.receivedShadowNode(n)),n})()}renderShadow(e){const{shadow:n,shadowMap:i,light:s}=this,{renderer:o,scene:a}=e;n.updateMatrices(s),i.setSize(n.mapSize.width,n.mapSize.height,i.depth),o.render(a,n.camera)}updateShadow(e){const{shadowMap:n,light:i,shadow:s}=this,{renderer:o,scene:a,camera:l}=e,c=o.shadowMap.type,u=n.depthTexture.version;this._depthVersionCached=u;const h=s.camera.layers.mask;s.camera.layers.mask&4294967294||(s.camera.layers.mask=l.layers.mask);const f=o.getRenderObjectFunction(),d=o.getMRT(),p=d?d.has("velocity"):!1;bN=$Ie(o,a,bN),a.overrideMaterial=KIe(i),o.setRenderObjectFunction(YIe(o,s,c,p)),o.setClearColor(0,0),o.setRenderTarget(n),this.renderShadow(e),o.setRenderObjectFunction(f),i.isPointLight!==!0&&c===wo&&this.vsmPass(o),s.camera.layers.mask=h,jIe(o,a,bN)}vsmPass(e){const{shadow:n}=this,i=this.shadowMap.depth;this.vsmShadowMapVertical.setSize(n.mapSize.width,n.mapSize.height,i),this.vsmShadowMapHorizontal.setSize(n.mapSize.width,n.mapSize.height,i),e.setRenderTarget(this.vsmShadowMapVertical),kS.material=this.vsmMaterialVertical,kS.render(e),e.setRenderTarget(this.vsmShadowMapHorizontal),kS.material=this.vsmMaterialHorizontal,kS.render(e)}dispose(){this.shadowMap.dispose(),this.shadowMap=null,this.vsmShadowMapVertical!==null&&(this.vsmShadowMapVertical.dispose(),this.vsmShadowMapVertical=null,this.vsmMaterialVertical.dispose(),this.vsmMaterialVertical=null),this.vsmShadowMapHorizontal!==null&&(this.vsmShadowMapHorizontal.dispose(),this.vsmShadowMapHorizontal=null,this.vsmMaterialHorizontal.dispose(),this.vsmMaterialHorizontal=null),super.dispose()}updateBefore(e){const{shadow:n}=this;let i=n.needsUpdate||n.autoUpdate;i&&(this._cameraFrameId[e.camera]===e.frameId&&(i=!1),this._cameraFrameId[e.camera]=e.frameId),i&&(this.updateShadow(e),this.shadowMap.depthTexture.version===this._depthVersionCached&&(n.needsUpdate=!1))}}const eLe=(r,e)=>Le(new cee(r,e)),tLe=new pt,pl=Oe(([r,e])=>{const n=r.toVar(),i=Jo(n),s=uu(1,ao(i.x,ao(i.y,i.z)));i.mulAssign(s),n.mulAssign(s.mul(e.mul(2).oneMinus()));const o=Ve(n.xy).toVar(),l=e.mul(1.5).oneMinus();return kr(i.z.greaterThanEqual(l),()=>{kr(n.z.greaterThan(0),()=>{o.x.assign(qs(4,n.x))})}).ElseIf(i.x.greaterThanEqual(l),()=>{const c=mE(n.x);o.x.assign(n.z.mul(c).add(c.mul(2)))}).ElseIf(i.y.greaterThanEqual(l),()=>{const c=mE(n.y);o.x.assign(n.x.add(c.mul(2)).add(2)),o.y.assign(n.z.mul(c).sub(2))}),Ve(.125,.25).mul(o).add(Ve(.375,.75)).flipY()}).setLayout({name:"cubeToUV",type:"vec2",inputs:[{name:"pos",type:"vec3"},{name:"texelSizeY",type:"float"}]}),nLe=Oe(({depthTexture:r,bd3D:e,dp:n,texelSize:i})=>cn(r,pl(e,i.y)).compare(n)),rLe=Oe(({depthTexture:r,bd3D:e,dp:n,texelSize:i,shadow:s})=>{const o=kn("radius","float",s).setGroup(Lt),a=Ve(-1,1).mul(o).mul(i.y);return cn(r,pl(e.add(a.xyy),i.y)).compare(n).add(cn(r,pl(e.add(a.yyy),i.y)).compare(n)).add(cn(r,pl(e.add(a.xyx),i.y)).compare(n)).add(cn(r,pl(e.add(a.yyx),i.y)).compare(n)).add(cn(r,pl(e,i.y)).compare(n)).add(cn(r,pl(e.add(a.xxy),i.y)).compare(n)).add(cn(r,pl(e.add(a.yxy),i.y)).compare(n)).add(cn(r,pl(e.add(a.xxx),i.y)).compare(n)).add(cn(r,pl(e.add(a.yxx),i.y)).compare(n)).mul(1/9)}),iLe=Oe(({filterFn:r,depthTexture:e,shadowCoord:n,shadow:i})=>{const s=n.xyz.toVar(),o=s.length(),a=Ft("float").setGroup(Lt).onRenderUpdate(()=>i.camera.near),l=Ft("float").setGroup(Lt).onRenderUpdate(()=>i.camera.far),c=kn("bias","float",i).setGroup(Lt),u=Ft(i.mapSize).setGroup(Lt),h=Te(1).toVar();return kr(o.sub(l).lessThanEqual(0).and(o.sub(a).greaterThanEqual(0)),()=>{const f=o.sub(a).div(l.sub(a)).toVar();f.addAssign(c);const d=s.normalize(),p=Ve(1).div(u.mul(Ve(4,2)));h.assign(r({depthTexture:e,bd3D:d,dp:f,texelSize:p,shadow:i}))}),h}),D5=new Nt,Ap=new Fe,Dv=new Fe;class sLe extends cee{static get type(){return"PointShadowNode"}constructor(e,n=null){super(e,n)}getShadowFilterFn(e){return e===Dye?nLe:rLe}setupShadowCoord(e,n){return n}setupShadowFilter(e,{filterFn:n,shadowTexture:i,depthTexture:s,shadowCoord:o,shadow:a}){return iLe({filterFn:n,shadowTexture:i,depthTexture:s,shadowCoord:o,shadow:a})}renderShadow(e){const{shadow:n,shadowMap:i,light:s}=this,{renderer:o,scene:a}=e,l=n.getFrameExtents();Dv.copy(n.mapSize),Dv.multiply(l),i.setSize(Dv.width,Dv.height),Ap.copy(n.mapSize);const c=o.autoClear,u=o.getClearColor(tLe),h=o.getClearAlpha();o.autoClear=!1,o.setClearColor(n.clearColor,n.clearAlpha),o.clear();const f=n.getViewportCount();for(let d=0;d<f;d++){const p=n.getViewport(d),m=Ap.x*p.x,g=Dv.y-Ap.y-Ap.y*p.y;D5.set(m,g,Ap.x*p.z,Ap.y*p.w),i.viewport.copy(D5),n.updateMatrices(s,d),o.render(a,n.camera)}o.autoClear=c,o.setClearColor(u,h)}}const oLe=(r,e)=>Le(new sLe(r,e));class Ld extends Ey{static get type(){return"AnalyticLightNode"}constructor(e=null){super(),this.light=e,this.color=new pt,this.colorNode=e&&e.colorNode||Ft(this.color).setGroup(Lt),this.baseColorNode=null,this.shadowNode=null,this.shadowColorNode=null,this.isAnalyticLightNode=!0,this.updateType=Jt.FRAME}customCacheKey(){return sb(this.light.id,this.light.castShadow?1:0)}getHash(){return this.light.uuid}getLightVector(e){return see(this.light).sub(e.context.positionView||Kr)}setupDirect(){}setupDirectRectArea(){}setupShadowNode(){return eLe(this.light)}setupShadow(e){const{renderer:n}=e;if(n.shadowMap.enabled===!1)return;let i=this.shadowColorNode;if(i===null){const s=this.light.shadow.shadowNode;let o;s!==void 0?o=Le(s):o=this.setupShadowNode(),this.shadowNode=o,this.shadowColorNode=i=this.colorNode.mul(o),this.baseColorNode=this.colorNode}this.colorNode=i}setup(e){this.colorNode=this.baseColorNode||this.colorNode,this.light.castShadow?e.object.receiveShadow&&this.setupShadow(e):this.shadowNode!==null&&(this.shadowNode.dispose(),this.shadowNode=null,this.shadowColorNode=null);const n=this.setupDirect(e),i=this.setupDirectRectArea(e);n&&e.lightsNode.setupDirectLight(e,this,n),i&&e.lightsNode.setupDirectRectAreaLight(e,this,i)}update(){const{light:e}=this;this.color.copy(e.color).multiplyScalar(e.intensity)}}const uee=Oe(({lightDistance:r,cutoffDistance:e,decayExponent:n})=>{const i=r.pow(n).max(.01).reciprocal();return e.greaterThan(0).select(i.mul(r.div(e).pow4().oneMinus().clamp().pow2()),i)}),aLe=({color:r,lightVector:e,cutoffDistance:n,decayExponent:i})=>{const s=e.normalize(),o=e.length(),a=uee({lightDistance:o,cutoffDistance:n,decayExponent:i}),l=r.mul(a);return{lightDirection:s,lightColor:l}};class lLe extends Ld{static get type(){return"PointLightNode"}constructor(e=null){super(e),this.cutoffDistanceNode=Ft(0).setGroup(Lt),this.decayExponentNode=Ft(2).setGroup(Lt)}update(e){const{light:n}=this;super.update(e),this.cutoffDistanceNode.value=n.distance,this.decayExponentNode.value=n.decay}setupShadowNode(){return oLe(this.light)}setupDirect(e){return aLe({color:this.colorNode,lightVector:this.getLightVector(e),cutoffDistance:this.cutoffDistanceNode,decayExponent:this.decayExponentNode})}}Oe(([r=P_()],{renderer:e,material:n})=>{const i=Te(1).toVar(),s=uJ(r.mul(2).sub(1));if(n.alphaToCoverage&&e.samples>1){const o=Te(s.fwidth()).toVar();i.assign(Oh(o.oneMinus(),o.add(1),s).oneMinus())}else s.greaterThan(1).discard();return i});const cLe=Oe(([r,e])=>{const n=r.x,i=r.y,s=r.z;let o=e.element(0).mul(.886227);return o=o.add(e.element(1).mul(2*.511664).mul(i)),o=o.add(e.element(2).mul(2*.511664).mul(s)),o=o.add(e.element(3).mul(2*.511664).mul(n)),o=o.add(e.element(4).mul(2*.429043).mul(n).mul(i)),o=o.add(e.element(5).mul(2*.429043).mul(i).mul(s)),o=o.add(e.element(6).mul(s.mul(s).mul(.743125).sub(.247708))),o=o.add(e.element(7).mul(2*.429043).mul(n).mul(s)),o=o.add(e.element(8).mul(.429043).mul(rn(n,n).sub(rn(i,i)))),o}),Aa=new K3;let uLe=class extends Kh{constructor(e,n){super(),this.renderer=e,this.nodes=n}update(e,n,i){const s=this.renderer,o=this.nodes.getBackgroundNode(e)||e.background;let a=!1;if(o===null)s._clearColor.getRGB(Aa),Aa.a=s._clearColor.a;else if(o.isColor===!0)o.getRGB(Aa),Aa.a=1,a=!0;else if(o.isNode===!0){const u=this.get(e),h=o;Aa.copy(s._clearColor);let f=u.backgroundMesh;if(f===void 0){let v=function(){o.removeEventListener("dispose",v),f.material.dispose(),f.geometry.dispose()};var c=v;const p=L3(jt(h).mul(C5),{getUV:()=>hIe.mul(_J),getTextureLevel:()=>uIe});let m=CJ;m=m.setZ(m.w);const g=new mi;g.name="Background.material",g.side=Fn,g.depthTest=!1,g.depthWrite=!1,g.allowOverride=!1,g.fog=!1,g.lights=!1,g.vertexNode=m,g.colorNode=p,u.backgroundMeshNode=p,u.backgroundMesh=f=new Jn(new xd(1,32,32),g),f.frustumCulled=!1,f.name="Background.mesh",f.onBeforeRender=function(y,x,b){this.matrixWorld.copyPosition(b.matrixWorld)},o.addEventListener("dispose",v)}const d=h.getCacheKey();u.backgroundCacheKey!==d&&(u.backgroundMeshNode.node=jt(h).mul(C5),u.backgroundMeshNode.needsUpdate=!0,f.material.needsUpdate=!0,u.backgroundCacheKey=d),n.unshift(f,f.geometry,f.material,0,0,null,null)}else console.error("THREE.Renderer: Unsupported background configuration.",o);const l=s.xr.getEnvironmentBlendMode();if(l==="additive"?Aa.set(0,0,0,1):l==="alpha-blend"&&Aa.set(0,0,0,0),s.autoClear===!0||a===!0){const u=i.clearColorValue;u.r=Aa.r,u.g=Aa.g,u.b=Aa.b,u.a=Aa.a,(s.backend.isWebGLBackend===!0||s.alpha===!0)&&(u.r*=u.a,u.g*=u.a,u.b*=u.a),i.depthClearValue=s._clearDepth,i.stencilClearValue=s._clearStencil,i.clearColor=s.autoClearColor===!0,i.clearDepth=s.autoClearDepth===!0,i.clearStencil=s.autoClearStencil===!0}else i.clearColor=!1,i.clearDepth=!1,i.clearStencil=!1}},hLe=0;class CD{constructor(e="",n=[],i=0,s=[]){this.name=e,this.bindings=n,this.index=i,this.bindingsReference=s,this.id=hLe++}}class fLe{constructor(e,n,i,s,o,a,l,c,u,h=[]){this.vertexShader=e,this.fragmentShader=n,this.computeShader=i,this.transforms=h,this.nodeAttributes=s,this.bindings=o,this.updateNodes=a,this.updateBeforeNodes=l,this.updateAfterNodes=c,this.observer=u,this.usedTimes=0}createBindings(){const e=[];for(const n of this.bindings)if(n.bindings[0].groupNode.shared!==!0){const s=new CD(n.name,[],n.index,n);e.push(s);for(const o of n.bindings)s.bindings.push(o.clone())}else e.push(n);return e}}class k5{constructor(e,n,i=null){this.isNodeAttribute=!0,this.name=e,this.type=n,this.node=i}}class dLe{constructor(e,n,i){this.isNodeUniform=!0,this.name=e,this.type=n,this.node=i.getSelf()}get value(){return this.node.value}set value(e){this.node.value=e}get id(){return this.node.id}get groupNode(){return this.node.groupNode}}class hee{constructor(e,n,i=!1,s=null){this.isNodeVar=!0,this.name=e,this.type=n,this.readOnly=i,this.count=s}}class pLe extends hee{constructor(e,n,i=null,s=null){super(e,n),this.needsInterpolation=!1,this.isNodeVarying=!0,this.interpolationType=i,this.interpolationSampling=s}}class mLe{constructor(e,n,i=""){this.name=e,this.type=n,this.code=i,Object.defineProperty(this,"isNodeCode",{value:!0})}}let gLe=0;class _N{constructor(e=null){this.id=gLe++,this.nodesData=new WeakMap,this.parent=e}getData(e){let n=this.nodesData.get(e);return n===void 0&&this.parent!==null&&(n=this.parent.getData(e)),n}setData(e,n){this.nodesData.set(e,n)}}class yLe{constructor(e,n){this.name=e,this.members=n,this.output=!1}}class Yh{constructor(e,n){this.name=e,this.value=n,this.boundary=0,this.itemSize=0,this.offset=0}setValue(e){this.value=e}getValue(){return this.value}}class vLe extends Yh{constructor(e,n=0){super(e,n),this.isNumberUniform=!0,this.boundary=4,this.itemSize=1}}class xLe extends Yh{constructor(e,n=new Fe){super(e,n),this.isVector2Uniform=!0,this.boundary=8,this.itemSize=2}}class bLe extends Yh{constructor(e,n=new K){super(e,n),this.isVector3Uniform=!0,this.boundary=16,this.itemSize=3}}class _Le extends Yh{constructor(e,n=new Nt){super(e,n),this.isVector4Uniform=!0,this.boundary=16,this.itemSize=4}}class wLe extends Yh{constructor(e,n=new pt){super(e,n),this.isColorUniform=!0,this.boundary=16,this.itemSize=3}}class SLe extends Yh{constructor(e,n=new JM){super(e,n),this.isMatrix2Uniform=!0,this.boundary=16,this.itemSize=4}}class TLe extends Yh{constructor(e,n=new Bt){super(e,n),this.isMatrix3Uniform=!0,this.boundary=48,this.itemSize=12}}class ELe extends Yh{constructor(e,n=new sn){super(e,n),this.isMatrix4Uniform=!0,this.boundary=64,this.itemSize=16}}class MLe extends vLe{constructor(e){super(e.name,e.value),this.nodeUniform=e}getValue(){return this.nodeUniform.value}getType(){return this.nodeUniform.type}}class ALe extends xLe{constructor(e){super(e.name,e.value),this.nodeUniform=e}getValue(){return this.nodeUniform.value}getType(){return this.nodeUniform.type}}class CLe extends bLe{constructor(e){super(e.name,e.value),this.nodeUniform=e}getValue(){return this.nodeUniform.value}getType(){return this.nodeUniform.type}}class PLe extends _Le{constructor(e){super(e.name,e.value),this.nodeUniform=e}getValue(){return this.nodeUniform.value}getType(){return this.nodeUniform.type}}class RLe extends wLe{constructor(e){super(e.name,e.value),this.nodeUniform=e}getValue(){return this.nodeUniform.value}getType(){return this.nodeUniform.type}}class NLe extends SLe{constructor(e){super(e.name,e.value),this.nodeUniform=e}getValue(){return this.nodeUniform.value}getType(){return this.nodeUniform.type}}class OLe extends TLe{constructor(e){super(e.name,e.value),this.nodeUniform=e}getValue(){return this.nodeUniform.value}getType(){return this.nodeUniform.type}}class DLe extends ELe{constructor(e){super(e.name,e.value),this.nodeUniform=e}getValue(){return this.nodeUniform.value}getType(){return this.nodeUniform.type}}const I5=new WeakMap,kLe=new Map([[Int8Array,"int"],[Int16Array,"int"],[Int32Array,"int"],[Uint8Array,"uint"],[Uint16Array,"uint"],[Uint32Array,"uint"],[Float32Array,"float"]]),IS=r=>/e/g.test(r)?String(r).replace(/\+/g,""):(r=Number(r),r+(r%1?"":".0"));class fee{constructor(e,n,i){this.object=e,this.material=e&&e.material||null,this.geometry=e&&e.geometry||null,this.renderer=n,this.parser=i,this.scene=null,this.camera=null,this.nodes=[],this.sequentialNodes=[],this.updateNodes=[],this.updateBeforeNodes=[],this.updateAfterNodes=[],this.hashNodes={},this.observer=null,this.lightsNode=null,this.environmentNode=null,this.fogNode=null,this.clippingContext=null,this.vertexShader=null,this.fragmentShader=null,this.computeShader=null,this.flowNodes={vertex:[],fragment:[],compute:[]},this.flowCode={vertex:"",fragment:"",compute:""},this.uniforms={vertex:[],fragment:[],compute:[],index:0},this.structs={vertex:[],fragment:[],compute:[],index:0},this.bindings={vertex:{},fragment:{},compute:{}},this.bindingsIndexes={},this.bindGroups=null,this.attributes=[],this.bufferAttributes=[],this.varyings=[],this.codes={},this.vars={},this.declarations={},this.flow={code:""},this.chaining=[],this.stack=gN(),this.stacks=[],this.tab="	",this.currentFunctionNode=null,this.context={material:this.material},this.cache=new _N,this.globalCache=this.cache,this.flowsData=new WeakMap,this.shaderStage=null,this.buildStage=null}getBindGroupsCache(){let e=I5.get(this.renderer);return e===void 0&&(e=new sl,I5.set(this.renderer,e)),e}createRenderTarget(e,n,i){return new $h(e,n,i)}createRenderTargetArray(e,n,i,s){return new O0e(e,n,i,s)}createCubeRenderTarget(e,n){return new LJ(e,n)}includes(e){return this.nodes.includes(e)}getOutputStructName(){}_getBindGroup(e,n){const i=this.getBindGroupsCache(),s=[];let o=!0;for(const l of n)s.push(l),o=o&&l.groupNode.shared!==!0;let a;return o?(a=i.get(s),a===void 0&&(a=new CD(e,s,this.bindingsIndexes[e].group,s),i.set(s,a))):a=new CD(e,s,this.bindingsIndexes[e].group,s),a}getBindGroupArray(e,n){const i=this.bindings[n];let s=i[e];return s===void 0&&(this.bindingsIndexes[e]===void 0&&(this.bindingsIndexes[e]={binding:0,group:Object.keys(this.bindingsIndexes).length}),i[e]=s=[]),s}getBindings(){let e=this.bindGroups;if(e===null){const n={},i=this.bindings;for(const s of RG)for(const o in i[s]){const a=i[s][o];(n[o]||(n[o]=[])).push(...a)}e=[];for(const s in n){const o=n[s],a=this._getBindGroup(s,o);e.push(a)}this.bindGroups=e}return e}sortBindingGroups(){const e=this.getBindings();e.sort((n,i)=>n.bindings[0].groupNode.order-i.bindings[0].groupNode.order);for(let n=0;n<e.length;n++){const i=e[n];this.bindingsIndexes[i.name].group=n,i.index=n}}setHashNode(e,n){this.hashNodes[n]=e}addNode(e){this.nodes.includes(e)===!1&&(this.nodes.push(e),this.setHashNode(e,e.getHash(this)))}addSequentialNode(e){this.sequentialNodes.includes(e)===!1&&this.sequentialNodes.push(e)}buildUpdateNodes(){for(const e of this.nodes)e.getUpdateType()!==Jt.NONE&&this.updateNodes.push(e.getSelf());for(const e of this.sequentialNodes){const n=e.getUpdateBeforeType(),i=e.getUpdateAfterType();n!==Jt.NONE&&this.updateBeforeNodes.push(e.getSelf()),i!==Jt.NONE&&this.updateAfterNodes.push(e.getSelf())}}get currentNode(){return this.chaining[this.chaining.length-1]}isFilteredTexture(e){return e.magFilter===li||e.magFilter===Rm||e.magFilter===Dc||e.magFilter===Ks||e.minFilter===li||e.minFilter===Rm||e.minFilter===Dc||e.minFilter===Ks}addChain(e){this.chaining.push(e)}removeChain(e){if(this.chaining.pop()!==e)throw new Error("NodeBuilder: Invalid node chaining!")}getMethod(e){return e}getNodeFromHash(e){return this.hashNodes[e]}addFlow(e,n){return this.flowNodes[e].push(n),n}setContext(e){this.context=e}getContext(){return this.context}getSharedContext(){return{...this.context},this.context}setCache(e){this.cache=e}getCache(){return this.cache}getCacheFromNode(e,n=!0){const i=this.getDataFromNode(e);return i.cache===void 0&&(i.cache=new _N(n?this.getCache():null)),i.cache}isAvailable(){return!1}getVertexIndex(){console.warn("Abstract function.")}getInstanceIndex(){console.warn("Abstract function.")}getDrawIndex(){console.warn("Abstract function.")}getFrontFacing(){console.warn("Abstract function.")}getFragCoord(){console.warn("Abstract function.")}isFlipY(){return!1}increaseUsage(e){const n=this.getDataFromNode(e);return n.usageCount=n.usageCount===void 0?1:n.usageCount+1,n.usageCount}generateTexture(){console.warn("Abstract function.")}generateTextureLod(){console.warn("Abstract function.")}generateArrayDeclaration(e,n){return this.getType(e)+"[ "+n+" ]"}generateArray(e,n,i=null){let s=this.generateArrayDeclaration(e,n)+"( ";for(let o=0;o<n;o++){const a=i?i[o]:null;a!==null?s+=a.build(this,e):s+=this.generateConst(e),o<n-1&&(s+=", ")}return s+=" )",s}generateStruct(e,n,i=null){const s=[];for(const o of n){const{name:a,type:l}=o;i&&i[a]&&i[a].isNode?s.push(i[a].build(this,l)):s.push(this.generateConst(l))}return e+"( "+s.join(", ")+" )"}generateConst(e,n=null){if(n===null&&(e==="float"||e==="int"||e==="uint"?n=0:e==="bool"?n=!1:e==="color"?n=new pt:e==="vec2"?n=new Fe:e==="vec3"?n=new K:e==="vec4"&&(n=new Nt)),e==="float")return IS(n);if(e==="int")return`${Math.round(n)}`;if(e==="uint")return n>=0?`${Math.round(n)}u`:"0u";if(e==="bool")return n?"true":"false";if(e==="color")return`${this.getType("vec3")}( ${IS(n.r)}, ${IS(n.g)}, ${IS(n.b)} )`;const i=this.getTypeLength(e),s=this.getComponentType(e),o=a=>this.generateConst(s,a);if(i===2)return`${this.getType(e)}( ${o(n.x)}, ${o(n.y)} )`;if(i===3)return`${this.getType(e)}( ${o(n.x)}, ${o(n.y)}, ${o(n.z)} )`;if(i===4&&e!=="mat2")return`${this.getType(e)}( ${o(n.x)}, ${o(n.y)}, ${o(n.z)}, ${o(n.w)} )`;if(i>=4&&n&&(n.isMatrix2||n.isMatrix3||n.isMatrix4))return`${this.getType(e)}( ${n.elements.map(o).join(", ")} )`;if(i>4)return`${this.getType(e)}()`;throw new Error(`NodeBuilder: Type '${e}' not found in generate constant attempt.`)}getType(e){return e==="color"?"vec3":e}hasGeometryAttribute(e){return this.geometry&&this.geometry.getAttribute(e)!==void 0}getAttribute(e,n){const i=this.attributes;for(const o of i)if(o.name===e)return o;const s=new k5(e,n);return this.registerDeclaration(s),i.push(s),s}getPropertyName(e){return e.name}isVector(e){return/vec\d/.test(e)}isMatrix(e){return/mat\d/.test(e)}isReference(e){return e==="void"||e==="property"||e==="sampler"||e==="samplerComparison"||e==="texture"||e==="cubeTexture"||e==="storageTexture"||e==="depthTexture"||e==="texture3D"}needsToWorkingColorSpace(){return!1}getComponentTypeFromTexture(e){const n=e.type;if(e.isDataTexture){if(n===Si)return"int";if(n===In)return"uint"}return"float"}getElementType(e){return e==="mat2"?"vec2":e==="mat3"?"vec3":e==="mat4"?"vec4":this.getComponentType(e)}getComponentType(e){if(e=this.getVectorType(e),e==="float"||e==="bool"||e==="int"||e==="uint")return e;const n=/(b|i|u|)(vec|mat)([2-4])/.exec(e);return n===null?null:n[1]==="b"?"bool":n[1]==="i"?"int":n[1]==="u"?"uint":"float"}getVectorType(e){return e==="color"?"vec3":e==="texture"||e==="cubeTexture"||e==="storageTexture"||e==="texture3D"?"vec4":e}getTypeFromLength(e,n="float"){if(e===1)return n;let i=nRe(e);const s=n==="float"?"":n[0];return/mat2/.test(n)===!0&&(i=i.replace("vec","mat")),s+i}getTypeFromArray(e){return kLe.get(e.constructor)}isInteger(e){return/int|uint|(i|u)vec/.test(e)}getTypeFromAttribute(e){let n=e;e.isInterleavedBufferAttribute&&(n=e.data);const i=n.array,s=e.itemSize,o=e.normalized;let a;return!(e instanceof TY)&&o!==!0&&(a=this.getTypeFromArray(i)),this.getTypeFromLength(s,a)}getTypeLength(e){const n=this.getVectorType(e),i=/vec([2-4])/.exec(n);return i!==null?Number(i[1]):n==="float"||n==="bool"||n==="int"||n==="uint"?1:/mat2/.test(e)===!0?4:/mat3/.test(e)===!0?9:/mat4/.test(e)===!0?16:0}getVectorFromMatrix(e){return e.replace("mat","vec")}changeComponentType(e,n){return this.getTypeFromLength(this.getTypeLength(e),n)}getIntegerType(e){const n=this.getComponentType(e);return n==="int"||n==="uint"?e:this.changeComponentType(e,"int")}addStack(){return this.stack=gN(this.stack),this.stacks.push(GQ()||this.stack),uE(this.stack),this.stack}removeStack(){const e=this.stack;return this.stack=e.parent,uE(this.stacks.pop()),e}getDataFromNode(e,n=this.shaderStage,i=null){i=i===null?e.isGlobal(this)?this.globalCache:this.cache:i;let s=i.getData(e);return s===void 0&&(s={},i.setData(e,s)),s[n]===void 0&&(s[n]={}),s[n]}getNodeProperties(e,n="any"){const i=this.getDataFromNode(e,n);return i.properties||(i.properties={outputNode:null})}getBufferAttributeFromNode(e,n){const i=this.getDataFromNode(e);let s=i.bufferAttribute;if(s===void 0){const o=this.uniforms.index++;s=new k5("nodeAttribute"+o,n,e),this.bufferAttributes.push(s),i.bufferAttribute=s}return s}getStructTypeFromNode(e,n,i=null,s=this.shaderStage){const o=this.getDataFromNode(e,s,this.globalCache);let a=o.structType;if(a===void 0){const l=this.structs.index++;i===null&&(i="StructType"+l),a=new yLe(i,n),this.structs[s].push(a),o.structType=a}return a}getOutputStructTypeFromNode(e,n){const i=this.getStructTypeFromNode(e,n,"OutputType","fragment");return i.output=!0,i}getUniformFromNode(e,n,i=this.shaderStage,s=null){const o=this.getDataFromNode(e,i,this.globalCache);let a=o.uniform;if(a===void 0){const l=this.uniforms.index++;a=new dLe(s||"nodeUniform"+l,n,e),this.uniforms[i].push(a),this.registerDeclaration(a),o.uniform=a}return a}getArrayCount(e){let n=null;return e.isArrayNode?n=e.count:e.isVarNode&&e.node.isArrayNode&&(n=e.node.count),n}getVarFromNode(e,n=null,i=e.getNodeType(this),s=this.shaderStage,o=!1){const a=this.getDataFromNode(e,s);let l=a.variable;if(l===void 0){const c=o?"_const":"_var",u=this.vars[s]||(this.vars[s]=[]),h=this.vars[c]||(this.vars[c]=0);n===null&&(n=(o?"nodeConst":"nodeVar")+h,this.vars[c]++);const f=this.getArrayCount(e);l=new hee(n,i,o,f),o||u.push(l),this.registerDeclaration(l),a.variable=l}return l}isDeterministic(e){if(e.isMathNode)return this.isDeterministic(e.aNode)&&(e.bNode?this.isDeterministic(e.bNode):!0)&&(e.cNode?this.isDeterministic(e.cNode):!0);if(e.isOperatorNode)return this.isDeterministic(e.aNode)&&(e.bNode?this.isDeterministic(e.bNode):!0);if(e.isArrayNode){if(e.values!==null){for(const n of e.values)if(!this.isDeterministic(n))return!1}return!0}else if(e.isConstNode)return!0;return!1}getVaryingFromNode(e,n=null,i=e.getNodeType(this),s=null,o=null){const a=this.getDataFromNode(e,"any");let l=a.varying;if(l===void 0){const c=this.varyings,u=c.length;n===null&&(n="nodeVarying"+u),l=new pLe(n,i,s,o),c.push(l),this.registerDeclaration(l),a.varying=l}return l}registerDeclaration(e){const n=this.shaderStage,i=this.declarations[n]||(this.declarations[n]={}),s=this.getPropertyName(e);let o=1,a=s;for(;i[a]!==void 0;)a=s+"_"+o++;o>1&&(e.name=a,console.warn(`THREE.TSL: Declaration name '${s}' of '${e.type}' already in use. Renamed to '${a}'.`)),i[a]=e}getCodeFromNode(e,n,i=this.shaderStage){const s=this.getDataFromNode(e);let o=s.code;if(o===void 0){const a=this.codes[i]||(this.codes[i]=[]),l=a.length;o=new mLe("nodeCode"+l,n),a.push(o),s.code=o}return o}addFlowCodeHierarchy(e,n){const{flowCodes:i,flowCodeBlock:s}=this.getDataFromNode(e);let o=!0,a=n;for(;a;){if(s.get(a)===!0){o=!1;break}a=this.getDataFromNode(a).parentNodeBlock}if(o)for(const l of i)this.addLineFlowCode(l)}addLineFlowCodeBlock(e,n,i){const s=this.getDataFromNode(e),o=s.flowCodes||(s.flowCodes=[]),a=s.flowCodeBlock||(s.flowCodeBlock=new WeakMap);o.push(n),a.set(i,!0)}addLineFlowCode(e,n=null){return e===""?this:(n!==null&&this.context.nodeBlock&&this.addLineFlowCodeBlock(n,e,this.context.nodeBlock),e=this.tab+e,/;\s*$/.test(e)||(e=e+`;
`),this.flow.code+=e,this)}addFlowCode(e){return this.flow.code+=e,this}addFlowTab(){return this.tab+="	",this}removeFlowTab(){return this.tab=this.tab.slice(0,-1),this}getFlowData(e){return this.flowsData.get(e)}flowNode(e){const n=e.getNodeType(this),i=this.flowChildNode(e,n);return this.flowsData.set(e,i),i}addInclude(e){this.currentFunctionNode!==null&&this.currentFunctionNode.includes.push(e)}buildFunctionNode(e){const n=new MIe,i=this.currentFunctionNode;return this.currentFunctionNode=n,n.code=this.buildFunctionCode(e),this.currentFunctionNode=i,n}flowShaderNode(e){const n=e.layout,i={[Symbol.iterator](){let a=0;const l=Object.values(this);return{next:()=>({value:l[a],done:a++>=l.length})}}};for(const a of n.inputs)i[a.name]=new sIe(a.type,a.name);e.layout=null;const s=e.call(i),o=this.flowStagesNode(s,n.type);return e.layout=n,o}flowStagesNode(e,n=null){const i=this.flow,s=this.vars,o=this.declarations,a=this.cache,l=this.buildStage,c=this.stack,u={code:""};this.flow=u,this.vars={},this.declarations={},this.cache=new _N,this.stack=gN();for(const h of PG)this.setBuildStage(h),u.result=e.build(this,n);return u.vars=this.getVars(this.shaderStage),this.flow=i,this.vars=s,this.declarations=o,this.cache=a,this.stack=c,this.setBuildStage(l),u}getFunctionOperator(){return null}buildFunctionCode(){console.warn("Abstract function.")}flowChildNode(e,n=null){const i=this.flow,s={code:""};return this.flow=s,s.result=e.build(this,n),this.flow=i,s}flowNodeFromShaderStage(e,n,i=null,s=null){const o=this.shaderStage;this.setShaderStage(e);const a=this.flowChildNode(n,i);return s!==null&&(a.code+=`${this.tab+s} = ${a.result};
`),this.flowCode[e]=this.flowCode[e]+a.code,this.setShaderStage(o),a}getAttributesArray(){return this.attributes.concat(this.bufferAttributes)}getAttributes(){console.warn("Abstract function.")}getVaryings(){console.warn("Abstract function.")}getVar(e,n,i=null){return`${i!==null?this.generateArrayDeclaration(e,i):this.getType(e)} ${n}`}getVars(e){let n="";const i=this.vars[e];if(i!==void 0)for(const s of i)n+=`${this.getVar(s.type,s.name)}; `;return n}getUniforms(){console.warn("Abstract function.")}getCodes(e){const n=this.codes[e];let i="";if(n!==void 0)for(const s of n)i+=s.code+`
`;return i}getHash(){return this.vertexShader+this.fragmentShader+this.computeShader}setShaderStage(e){this.shaderStage=e}getShaderStage(){return this.shaderStage}setBuildStage(e){this.buildStage=e}getBuildStage(){return this.buildStage}buildCode(){console.warn("Abstract function.")}build(){const{object:e,material:n,renderer:i}=this;if(n!==null){let s=i.library.fromMaterial(n);s===null&&(console.error(`NodeMaterial: Material "${n.type}" is not compatible.`),s=new mi),s.build(this)}else this.addFlow("compute",e);for(const s of PG){this.setBuildStage(s),this.context.vertex&&this.context.vertex.isNode&&this.flowNodeFromShaderStage("vertex",this.context.vertex);for(const o of RG){this.setShaderStage(o);const a=this.flowNodes[o];for(const l of a)s==="generate"?this.flowNode(l):l.build(this)}}return this.setBuildStage(null),this.setShaderStage(null),this.buildCode(),this.buildUpdateNodes(),this}getNodeUniform(e,n){if(n==="float"||n==="int"||n==="uint")return new MLe(e);if(n==="vec2"||n==="ivec2"||n==="uvec2")return new ALe(e);if(n==="vec3"||n==="ivec3"||n==="uvec3")return new CLe(e);if(n==="vec4"||n==="ivec4"||n==="uvec4")return new PLe(e);if(n==="color")return new RLe(e);if(n==="mat2")return new NLe(e);if(n==="mat3")return new OLe(e);if(n==="mat4")return new DLe(e);throw new Error(`Uniform "${n}" not declared.`)}format(e,n,i){if(n=this.getVectorType(n),i=this.getVectorType(i),n===i||i===null||this.isReference(i))return e;const s=this.getTypeLength(n),o=this.getTypeLength(i);return s===16&&o===9?`${this.getType(i)}( ${e}[ 0 ].xyz, ${e}[ 1 ].xyz, ${e}[ 2 ].xyz )`:s===9&&o===4?`${this.getType(i)}( ${e}[ 0 ].xy, ${e}[ 1 ].xy )`:s>4||o>4||o===0?e:s===o?`${this.getType(i)}( ${e} )`:s>o?(e=i==="bool"?`all( ${e} )`:`${e}.${"xyz".slice(0,o)}`,this.format(e,this.getTypeFromLength(o,this.getComponentType(n)),i)):o===4&&s>1?`${this.getType(i)}( ${this.format(e,n,"vec3")}, 1.0 )`:s===2?`${this.getType(i)}( ${this.format(e,n,"vec2")}, 0.0 )`:(s===1&&o>1&&n!==this.getComponentType(i)&&(e=`${this.getType(this.getComponentType(i))}( ${e} )`),`${this.getType(i)}( ${e} )`)}getSignature(){return`// Three.js r${my} - Node System
`}*[Symbol.iterator](){}createNodeMaterial(e="NodeMaterial"){throw new Error(`THREE.NodeBuilder: createNodeMaterial() was deprecated. Use new ${e}() instead.`)}}class L5{constructor(){this.time=0,this.deltaTime=0,this.frameId=0,this.renderId=0,this.updateMap=new WeakMap,this.updateBeforeMap=new WeakMap,this.updateAfterMap=new WeakMap,this.renderer=null,this.material=null,this.camera=null,this.object=null,this.scene=null}_getMaps(e,n){let i=e.get(n);return i===void 0&&(i={renderMap:new WeakMap,frameMap:new WeakMap},e.set(n,i)),i}updateBeforeNode(e){const n=e.getUpdateBeforeType(),i=e.updateReference(this);if(n===Jt.FRAME){const{frameMap:s}=this._getMaps(this.updateBeforeMap,i);s.get(i)!==this.frameId&&e.updateBefore(this)!==!1&&s.set(i,this.frameId)}else if(n===Jt.RENDER){const{renderMap:s}=this._getMaps(this.updateBeforeMap,i);s.get(i)!==this.renderId&&e.updateBefore(this)!==!1&&s.set(i,this.renderId)}else n===Jt.OBJECT&&e.updateBefore(this)}updateAfterNode(e){const n=e.getUpdateAfterType(),i=e.updateReference(this);if(n===Jt.FRAME){const{frameMap:s}=this._getMaps(this.updateAfterMap,i);s.get(i)!==this.frameId&&e.updateAfter(this)!==!1&&s.set(i,this.frameId)}else if(n===Jt.RENDER){const{renderMap:s}=this._getMaps(this.updateAfterMap,i);s.get(i)!==this.renderId&&e.updateAfter(this)!==!1&&s.set(i,this.renderId)}else n===Jt.OBJECT&&e.updateAfter(this)}updateNode(e){const n=e.getUpdateType(),i=e.updateReference(this);if(n===Jt.FRAME){const{frameMap:s}=this._getMaps(this.updateMap,i);s.get(i)!==this.frameId&&e.update(this)!==!1&&s.set(i,this.frameId)}else if(n===Jt.RENDER){const{renderMap:s}=this._getMaps(this.updateMap,i);s.get(i)!==this.renderId&&e.update(this)!==!1&&s.set(i,this.renderId)}else n===Jt.OBJECT&&e.update(this)}update(){this.frameId++,this.lastTime===void 0&&(this.lastTime=performance.now()),this.deltaTime=(performance.now()-this.lastTime)/1e3,this.lastTime=performance.now(),this.time+=this.deltaTime}}class Y3{constructor(e,n,i=null,s="",o=!1){this.type=e,this.name=n,this.count=i,this.qualifier=s,this.isConst=o}}Y3.isNodeFunctionInput=!0;class ILe extends Ld{static get type(){return"DirectionalLightNode"}constructor(e=null){super(e)}setupDirect(){const e=this.colorNode;return{lightDirection:oee(this.light),lightColor:e}}}const wN=new sn,LS=new sn;let kv=null;class LLe extends Ld{static get type(){return"RectAreaLightNode"}constructor(e=null){super(e),this.halfHeight=Ft(new K).setGroup(Lt),this.halfWidth=Ft(new K).setGroup(Lt),this.updateType=Jt.RENDER}update(e){super.update(e);const{light:n}=this,i=e.camera.matrixWorldInverse;LS.identity(),wN.copy(n.matrixWorld),wN.premultiply(i),LS.extractRotation(wN),this.halfWidth.value.set(n.width*.5,0,0),this.halfHeight.value.set(0,n.height*.5,0),this.halfWidth.value.applyMatrix4(LS),this.halfHeight.value.applyMatrix4(LS)}setupDirectRectArea(e){let n,i;e.isAvailable("float32Filterable")?(n=cn(kv.LTC_FLOAT_1),i=cn(kv.LTC_FLOAT_2)):(n=cn(kv.LTC_HALF_1),i=cn(kv.LTC_HALF_2));const{colorNode:s,light:o}=this,a=see(o);return{lightColor:s,lightPosition:a,halfWidth:this.halfWidth,halfHeight:this.halfHeight,ltc_1:n,ltc_2:i}}static setLTC(e){kv=e}}class dee extends Ld{static get type(){return"SpotLightNode"}constructor(e=null){super(e),this.coneCosNode=Ft(0).setGroup(Lt),this.penumbraCosNode=Ft(0).setGroup(Lt),this.cutoffDistanceNode=Ft(0).setGroup(Lt),this.decayExponentNode=Ft(0).setGroup(Lt)}update(e){super.update(e);const{light:n}=this;this.coneCosNode.value=Math.cos(n.angle),this.penumbraCosNode.value=Math.cos(n.angle*(1-n.penumbra)),this.cutoffDistanceNode.value=n.distance,this.decayExponentNode.value=n.decay}getSpotAttenuation(e){const{coneCosNode:n,penumbraCosNode:i}=this;return Oh(n,i,e)}setupDirect(e){const{colorNode:n,cutoffDistanceNode:i,decayExponentNode:s,light:o}=this,a=this.getLightVector(e),l=a.normalize(),c=l.dot(oee(o)),u=this.getSpotAttenuation(c),h=a.length(),f=uee({lightDistance:h,cutoffDistance:i,decayExponent:s});let d=n.mul(u).mul(f);if(o.map){const p=RIe(o,e.context.positionWorld),m=cn(o.map,p.xy).onRenderUpdate(()=>o.map);d=p.mul(2).sub(1).abs().lessThan(1).all().select(d.mul(m),d)}return{lightColor:d,lightDirection:l}}}class FLe extends dee{static get type(){return"IESSpotLightNode"}getSpotAttenuation(e){const n=this.light.iesMap;let i=null;if(n&&n.isTexture===!0){const s=e.acos().mul(1/Math.PI);i=cn(n,Ve(s,0),0).r}else i=super.getSpotAttenuation(e);return i}}class BLe extends Ld{static get type(){return"AmbientLightNode"}constructor(e=null){super(e)}setup({context:e}){e.irradiance.addAssign(this.colorNode)}}class ULe extends Ld{static get type(){return"HemisphereLightNode"}constructor(e=null){super(e),this.lightPositionNode=iee(e),this.lightDirectionNode=this.lightPositionNode.normalize(),this.groundColorNode=Ft(new pt).setGroup(Lt)}update(e){const{light:n}=this;super.update(e),this.lightPositionNode.object3d=n,this.groundColorNode.value.copy(n.groundColor).multiplyScalar(n.intensity)}setup(e){const{colorNode:n,groundColorNode:i,lightDirectionNode:s}=this,a=il.dot(s).mul(.5).add(.5),l=Yn(i,n,a);e.context.irradiance.addAssign(l)}}class zLe extends Ld{static get type(){return"LightProbeNode"}constructor(e=null){super(e);const n=[];for(let i=0;i<9;i++)n.push(new K);this.lightProbe=_l(n)}update(e){const{light:n}=this;super.update(e);for(let i=0;i<9;i++)this.lightProbe.array[i].copy(n.sh.coefficients[i]).multiplyScalar(n.intensity)}setup(e){const n=cLe(_J,this.lightProbe);e.context.irradiance.addAssign(n)}}class pee{parseFunction(){console.warn("Abstract function.")}}class Z3{constructor(e,n,i="",s=""){this.type=e,this.inputs=n,this.name=i,this.precision=s}getCode(){console.warn("Abstract function.")}}Z3.isNodeFunction=!0;const $Le=/^\s*(highp|mediump|lowp)?\s*([a-z_0-9]+)\s*([a-z_0-9]+)?\s*\(([\s\S]*?)\)/i,jLe=/[a-z_0-9]+/ig,F5="#pragma main",VLe=r=>{r=r.trim();const e=r.indexOf(F5),n=e!==-1?r.slice(e+F5.length):r,i=n.match($Le);if(i!==null&&i.length===5){const s=i[4],o=[];let a=null;for(;(a=jLe.exec(s))!==null;)o.push(a);const l=[];let c=0;for(;c<o.length;){const m=o[c][0]==="const";m===!0&&c++;let g=o[c][0];g==="in"||g==="out"||g==="inout"?c++:g="";const v=o[c++][0];let y=Number.parseInt(o[c][0]);Number.isNaN(y)===!1?c++:y=null;const x=o[c++][0];l.push(new Y3(v,x,y,g,m))}const u=n.substring(i[0].length),h=i[3]!==void 0?i[3]:"",f=i[2],d=i[1]!==void 0?i[1]:"",p=e!==-1?r.slice(0,e):"";return{type:f,inputs:l,name:h,precision:d,inputsCode:s,blockCode:u,headerCode:p}}else throw new Error("FunctionNode: Function is not a GLSL code.")};class GLe extends Z3{constructor(e){const{type:n,inputs:i,name:s,precision:o,inputsCode:a,blockCode:l,headerCode:c}=VLe(e);super(n,i,s,o),this.inputsCode=a,this.blockCode=l,this.headerCode=c}getCode(e=this.name){let n;const i=this.blockCode;if(i!==""){const{type:s,inputsCode:o,headerCode:a,precision:l}=this;let c=`${s} ${e} ( ${o.trim()} )`;l!==""&&(c=`${l} ${c}`),n=a+c+i}else n="";return n}}class HLe extends pee{parseFunction(e){return new GLe(e)}}const B5=new WeakMap,fl=[],Cp=[];class WLe extends Kh{constructor(e,n){super(),this.renderer=e,this.backend=n,this.nodeFrame=new L5,this.nodeBuilderCache=new Map,this.callHashCache=new sl,this.groupsData=new sl,this.cacheLib={}}updateGroup(e){const n=e.groupNode,i=n.name;if(i===eJ.name)return!0;if(i===Lt.name){const o=this.get(e),a=this.nodeFrame.renderId;return o.renderId!==a?(o.renderId=a,!0):!1}if(i===BRe.name){const o=this.get(e),a=this.nodeFrame.frameId;return o.frameId!==a?(o.frameId=a,!0):!1}fl[0]=n,fl[1]=e;let s=this.groupsData.get(fl);return s===void 0&&this.groupsData.set(fl,s={}),fl.length=0,s.version!==n.version?(s.version=n.version,!0):!1}getForRenderCacheKey(e){return e.initialCacheKey}getForRender(e){const n=this.get(e);let i=n.nodeBuilderState;if(i===void 0){const{nodeBuilderCache:s}=this,o=this.getForRenderCacheKey(e);if(i=s.get(o),i===void 0){const a=this.backend.createNodeBuilder(e.object,this.renderer);a.scene=e.scene,a.material=e.material,a.camera=e.camera,a.context.material=e.material,a.lightsNode=e.lightsNode,a.environmentNode=this.getEnvironmentNode(e.scene),a.fogNode=this.getFogNode(e.scene),a.clippingContext=e.clippingContext,this.renderer.getRenderTarget()&&this.renderer.getRenderTarget().multiview&&a.enableMultiview(),a.build(),i=this._createNodeBuilderState(a),s.set(o,i)}i.usedTimes++,n.nodeBuilderState=i}return i}delete(e){if(e.isRenderObject){const n=this.get(e).nodeBuilderState;n.usedTimes--,n.usedTimes===0&&this.nodeBuilderCache.delete(this.getForRenderCacheKey(e))}return super.delete(e)}getForCompute(e){const n=this.get(e);let i=n.nodeBuilderState;if(i===void 0){const s=this.backend.createNodeBuilder(e,this.renderer);s.build(),i=this._createNodeBuilderState(s),n.nodeBuilderState=i}return i}_createNodeBuilderState(e){return new fLe(e.vertexShader,e.fragmentShader,e.computeShader,e.getAttributesArray(),e.getBindings(),e.updateNodes,e.updateBeforeNodes,e.updateAfterNodes,e.observer,e.transforms)}getEnvironmentNode(e){this.updateEnvironment(e);let n=null;if(e.environmentNode&&e.environmentNode.isNode)n=e.environmentNode;else{const i=this.get(e);i.environmentNode&&(n=i.environmentNode)}return n}getBackgroundNode(e){this.updateBackground(e);let n=null;if(e.backgroundNode&&e.backgroundNode.isNode)n=e.backgroundNode;else{const i=this.get(e);i.backgroundNode&&(n=i.backgroundNode)}return n}getFogNode(e){return this.updateFog(e),e.fogNode||this.get(e).fogNode||null}getCacheKey(e,n){fl[0]=e,fl[1]=n;const i=this.renderer.info.calls,s=this.callHashCache.get(fl)||{};if(s.callId!==i){const o=this.getEnvironmentNode(e),a=this.getFogNode(e);n&&Cp.push(n.getCacheKey(!0)),o&&Cp.push(o.getCacheKey()),a&&Cp.push(a.getCacheKey()),Cp.push(this.renderer.shadowMap.enabled?1:0),s.callId=i,s.cacheKey=T3(Cp),this.callHashCache.set(fl,s),Cp.length=0}return fl.length=0,s.cacheKey}get isToneMappingState(){return!this.renderer.getRenderTarget()}updateBackground(e){const n=this.get(e),i=e.background;if(i){const s=e.backgroundBlurriness===0&&n.backgroundBlurriness>0||e.backgroundBlurriness>0&&n.backgroundBlurriness===0;if(n.background!==i||s){const o=this.getCacheNode("background",i,()=>{if(i.isCubeTexture===!0||i.mapping===dd||i.mapping===pd||i.mapping===md){if(e.backgroundBlurriness>0||i.mapping===md)return XJ(i);{let a;return i.isCubeTexture===!0?a=ub(i):a=cn(i),BJ(a)}}else{if(i.isTexture===!0)return cn(i,Bm.flipY()).setUpdateMatrix(!0);i.isColor!==!0&&console.error("WebGPUNodes: Unsupported background configuration.",i)}},s);n.backgroundNode=o,n.background=i,n.backgroundBlurriness=e.backgroundBlurriness}}else n.backgroundNode&&(delete n.backgroundNode,delete n.background)}getCacheNode(e,n,i,s=!1){const o=this.cacheLib[e]||(this.cacheLib[e]=new WeakMap);let a=o.get(n);return(a===void 0||s)&&(a=i(),o.set(n,a)),a}updateFog(e){const n=this.get(e),i=e.fog;if(i){if(n.fog!==i){const s=this.getCacheNode("fog",i,()=>{if(i.isFogExp2){const o=kn("color","color",i).setGroup(Lt),a=kn("density","float",i).setGroup(Lt);return R5(o,CIe(a))}else if(i.isFog){const o=kn("color","color",i).setGroup(Lt),a=kn("near","float",i).setGroup(Lt),l=kn("far","float",i).setGroup(Lt);return R5(o,AIe(a,l))}else console.error("THREE.Renderer: Unsupported fog configuration.",i)});n.fogNode=s,n.fog=i}}else delete n.fogNode,delete n.fog}updateEnvironment(e){const n=this.get(e),i=e.environment;if(i){if(n.environment!==i){const s=this.getCacheNode("environment",i,()=>{if(i.isCubeTexture===!0)return ub(i);if(i.isTexture===!0)return cn(i);console.error("Nodes: Unsupported environment configuration.",i)});n.environmentNode=s,n.environment=i}}else n.environmentNode&&(delete n.environmentNode,delete n.environment)}getNodeFrame(e=this.renderer,n=null,i=null,s=null,o=null){const a=this.nodeFrame;return a.renderer=e,a.scene=n,a.object=i,a.camera=s,a.material=o,a}getNodeFrameForRender(e){return this.getNodeFrame(e.renderer,e.scene,e.object,e.camera,e.material)}getOutputCacheKey(){const e=this.renderer;return e.toneMapping+","+e.currentColorSpace+","+e.xr.isPresenting}hasOutputChange(e){return B5.get(e)!==this.getOutputCacheKey()}getOutputNode(e){const n=this.renderer,i=this.getOutputCacheKey(),s=e.isTextureArray?pIe(e,Ae(Bm,vA("gl_ViewID_OVR"))).renderOutput(n.toneMapping,n.currentColorSpace):cn(e,Bm).renderOutput(n.toneMapping,n.currentColorSpace);return B5.set(e,i),s}updateBefore(e){const n=e.getNodeBuilderState();for(const i of n.updateBeforeNodes)this.getNodeFrameForRender(e).updateBeforeNode(i)}updateAfter(e){const n=e.getNodeBuilderState();for(const i of n.updateAfterNodes)this.getNodeFrameForRender(e).updateAfterNode(i)}updateForCompute(e){const n=this.getNodeFrame(),i=this.getForCompute(e);for(const s of i.updateNodes)n.updateNode(s)}updateForRender(e){const n=this.getNodeFrameForRender(e),i=e.getNodeBuilderState();for(const s of i.updateNodes)n.updateNode(s)}needsRefresh(e){const n=this.getNodeFrameForRender(e);return e.getMonitor().needsRefresh(e,n)}dispose(){super.dispose(),this.nodeFrame=new L5,this.nodeBuilderCache=new Map,this.cacheLib={}}}const SN=new To;class gE{constructor(e=null){this.version=0,this.clipIntersection=null,this.cacheKey="",this.shadowPass=!1,this.viewNormalMatrix=new Bt,this.clippingGroupContexts=new WeakMap,this.intersectionPlanes=[],this.unionPlanes=[],this.parentVersion=null,e!==null&&(this.viewNormalMatrix=e.viewNormalMatrix,this.clippingGroupContexts=e.clippingGroupContexts,this.shadowPass=e.shadowPass,this.viewMatrix=e.viewMatrix)}projectPlanes(e,n,i){const s=e.length;for(let o=0;o<s;o++){SN.copy(e[o]).applyMatrix4(this.viewMatrix,this.viewNormalMatrix);const a=n[i+o],l=SN.normal;a.x=-l.x,a.y=-l.y,a.z=-l.z,a.w=SN.constant}}updateGlobal(e,n){this.shadowPass=e.overrideMaterial!==null&&e.overrideMaterial.isShadowPassMaterial,this.viewMatrix=n.matrixWorldInverse,this.viewNormalMatrix.getNormalMatrix(this.viewMatrix)}update(e,n){let i=!1;e.version!==this.parentVersion&&(this.intersectionPlanes=Array.from(e.intersectionPlanes),this.unionPlanes=Array.from(e.unionPlanes),this.parentVersion=e.version),this.clipIntersection!==n.clipIntersection&&(this.clipIntersection=n.clipIntersection,this.clipIntersection?this.unionPlanes.length=e.unionPlanes.length:this.intersectionPlanes.length=e.intersectionPlanes.length);const s=n.clippingPlanes,o=s.length;let a,l;if(this.clipIntersection?(a=this.intersectionPlanes,l=e.intersectionPlanes.length):(a=this.unionPlanes,l=e.unionPlanes.length),a.length!==l+o){a.length=l+o;for(let c=0;c<o;c++)a[l+c]=new Nt;i=!0}this.projectPlanes(s,a,l),i&&(this.version++,this.cacheKey=`${this.intersectionPlanes.length}:${this.unionPlanes.length}`)}getGroupContext(e){if(this.shadowPass&&!e.clipShadows)return this;let n=this.clippingGroupContexts.get(e);return n===void 0&&(n=new gE(this),this.clippingGroupContexts.set(e,n)),n.update(this,e),n}get unionClippingCount(){return this.unionPlanes.length}}class qLe{constructor(e,n){this.bundleGroup=e,this.camera=n}}const Iv=[];class XLe{constructor(){this.bundles=new sl}get(e,n){const i=this.bundles;Iv[0]=e,Iv[1]=n;let s=i.get(Iv);return s===void 0&&(s=new qLe(e,n),i.set(Iv,s)),Iv.length=0,s}dispose(){this.bundles=new sl}}class mee{constructor(){this.lightNodes=new WeakMap,this.materialNodes=new Map,this.toneMappingNodes=new Map}fromMaterial(e){if(e.isNodeMaterial)return e;let n=null;const i=this.getMaterialNodeClass(e.type);if(i!==null){n=new i;for(const s in e)n[s]=e[s]}return n}addToneMapping(e,n){this.addType(e,n,this.toneMappingNodes)}getToneMappingFunction(e){return this.toneMappingNodes.get(e)||null}getMaterialNodeClass(e){return this.materialNodes.get(e)||null}addMaterial(e,n){this.addType(e,n,this.materialNodes)}getLightNodeClass(e){return this.lightNodes.get(e)||null}addLight(e,n){this.addClass(e,n,this.lightNodes)}addType(e,n,i){if(i.has(n)){console.warn(`Redefinition of node ${n}`);return}if(typeof e!="function")throw new Error(`Node class ${e.name} is not a class.`);if(typeof n=="function"||typeof n=="object")throw new Error(`Base class ${n} is not a class.`);i.set(n,e)}addClass(e,n,i){if(i.has(n)){console.warn(`Redefinition of node ${n.name}`);return}if(typeof e!="function")throw new Error(`Node class ${e.name} is not a class.`);if(typeof n!="function")throw new Error(`Base class ${n.name} is not a class.`);i.set(n,e)}}const KLe=new aee,Lv=[];class YLe extends sl{constructor(){super()}createNode(e=[]){return new aee().setLights(e)}getNode(e,n){if(e.isQuadMesh)return KLe;Lv[0]=e,Lv[1]=n;let i=this.get(Lv);return i===void 0&&(i=this.createNode(),this.set(Lv,i)),Lv.length=0,i}}class h0 extends $h{constructor(e=1,n=1,i={}){super(e,n,i),this.isXRRenderTarget=!0,this.hasExternalTextures=!1,this.autoAllocateDepthBuffer=!0}copy(e){return super.copy(e),this.hasExternalTextures=e.hasExternalTextures,this.autoAllocateDepthBuffer=e.autoAllocateDepthBuffer,this}}const U5=new K,z5=new K;class ZLe extends gu{constructor(e,n=!1){super(),this.enabled=!1,this.isPresenting=!1,this.cameraAutoUpdate=!0,this._renderer=e,this._cameraL=new Ti,this._cameraL.viewport=new Nt,this._cameraR=new Ti,this._cameraR.viewport=new Nt,this._cameras=[this._cameraL,this._cameraR],this._cameraXR=new UY,this._currentDepthNear=null,this._currentDepthFar=null,this._controllers=[],this._controllerInputSources=[],this._xrRenderTarget=null,this._layers=[],this._supportsLayers=!1,this._createXRLayer=rFe.bind(this),this._gl=null,this._currentAnimationContext=null,this._currentAnimationLoop=null,this._currentPixelRatio=null,this._currentSize=new Fe,this._onSessionEvent=eFe.bind(this),this._onSessionEnd=tFe.bind(this),this._onInputSourcesChange=nFe.bind(this),this._onAnimationFrame=iFe.bind(this),this._referenceSpace=null,this._referenceSpaceType="local-floor",this._customReferenceSpace=null,this._framebufferScaleFactor=1,this._foveation=1,this._session=null,this._glBaseLayer=null,this._glBinding=null,this._glProjLayer=null,this._xrFrame=null,this._useLayers=typeof XRWebGLBinding<"u"&&"createProjectionLayer"in XRWebGLBinding.prototype,this._useMultiviewIfPossible=n,this._useMultiview=!1}getController(e){return this._getController(e).getTargetRaySpace()}getControllerGrip(e){return this._getController(e).getGripSpace()}getHand(e){return this._getController(e).getHandSpace()}getFoveation(){if(!(this._glProjLayer===null&&this._glBaseLayer===null))return this._foveation}setFoveation(e){this._foveation=e,this._glProjLayer!==null&&(this._glProjLayer.fixedFoveation=e),this._glBaseLayer!==null&&this._glBaseLayer.fixedFoveation!==void 0&&(this._glBaseLayer.fixedFoveation=e)}getFramebufferScaleFactor(){return this._framebufferScaleFactor}setFramebufferScaleFactor(e){this._framebufferScaleFactor=e,this.isPresenting===!0&&console.warn("THREE.XRManager: Cannot change framebuffer scale while presenting.")}getReferenceSpaceType(){return this._referenceSpaceType}setReferenceSpaceType(e){this._referenceSpaceType=e,this.isPresenting===!0&&console.warn("THREE.XRManager: Cannot change reference space type while presenting.")}getReferenceSpace(){return this._customReferenceSpace||this._referenceSpace}setReferenceSpace(e){this._customReferenceSpace=e}getCamera(){return this._cameraXR}getEnvironmentBlendMode(){if(this._session!==null)return this._session.environmentBlendMode}getFrame(){return this._xrFrame}useMultiview(){return this._useMultiview}createQuadLayer(e,n,i,s,o,a,l,c=[]){const u=new g_(e,n),h=new h0(o,a,{format:Tr,type:gr,depthTexture:new ko(o,a,c.stencil?No:In,void 0,void 0,void 0,void 0,void 0,void 0,c.stencil?Do:Oo),stencilBuffer:c.stencil,resolveDepthBuffer:!1,resolveStencilBuffer:!1}),f=new As({color:16777215,side:no});f.map=h.texture,f.map.offset.y=1,f.map.repeat.y=-1;const d=new Jn(u,f);d.position.copy(i),d.quaternion.copy(s);const p={type:"quad",width:e,height:n,translation:i,quaternion:s,pixelwidth:o,pixelheight:a,plane:d,material:f,rendercall:l,renderTarget:h};if(this._layers.push(p),this._session!==null){p.plane.material=new As({color:16777215,side:no}),p.plane.material.blending=Pm,p.plane.material.blendEquation=ss,p.plane.material.blendSrc=wc,p.plane.material.blendDst=wc,p.xrlayer=this._createXRLayer(p);const m=this._session.renderState.layers;m.unshift(p.xrlayer),this._session.updateRenderState({layers:m})}else h.isXRRenderTarget=!1;return d}createCylinderLayer(e,n,i,s,o,a,l,c,u=[]){const h=new m_(e,e,e*n/i,64,64,!0,Math.PI-n/2,n),f=new h0(a,l,{format:Tr,type:gr,depthTexture:new ko(a,l,u.stencil?No:In,void 0,void 0,void 0,void 0,void 0,void 0,u.stencil?Do:Oo),stencilBuffer:u.stencil,resolveDepthBuffer:!1,resolveStencilBuffer:!1}),d=new As({color:16777215,side:Fn});d.map=f.texture,d.map.offset.y=1,d.map.repeat.y=-1;const p=new Jn(h,d);p.position.copy(s),p.quaternion.copy(o);const m={type:"cylinder",radius:e,centralAngle:n,aspectratio:i,translation:s,quaternion:o,pixelwidth:a,pixelheight:l,plane:p,material:d,rendercall:c,renderTarget:f};if(this._layers.push(m),this._session!==null){m.plane.material=new As({color:16777215,side:Fn}),m.plane.material.blending=Pm,m.plane.material.blendEquation=ss,m.plane.material.blendSrc=wc,m.plane.material.blendDst=wc,m.xrlayer=this._createXRLayer(m);const g=this._session.renderState.layers;g.unshift(m.xrlayer),this._session.updateRenderState({layers:g})}else f.isXRRenderTarget=!1;return p}renderLayers(){const e=new K,n=new rl,i=this.isPresenting;this.isPresenting=!1;for(const s of this._layers){if(s.renderTarget.isXRRenderTarget=this._session!==null,s.renderTarget.hasExternalTextures=s.renderTarget.isXRRenderTarget,s.renderTarget.autoAllocateDepthBuffer=!s.renderTarget.isXRRenderTarget,s.renderTarget.isXRRenderTarget&&this._supportsLayers){s.xrlayer.transform=new XRRigidTransform(s.plane.getWorldPosition(e),s.plane.getWorldQuaternion(n));const o=this._glBinding.getSubImage(s.xrlayer,this._xrFrame);this._renderer.backend.setXRRenderTargetTextures(s.renderTarget,o.colorTexture,o.depthStencilTexture)}this._renderer.setRenderTarget(s.renderTarget),s.rendercall()}this.isPresenting=i,this._renderer.setRenderTarget(null)}getSession(){return this._session}async setSession(e){const n=this._renderer,i=n.backend;this._gl=n.getContext();const s=this._gl,o=s.getContextAttributes();if(this._session=e,e!==null){if(i.isWebGPUBackend===!0)throw new Error('THREE.XRManager: XR is currently not supported with a WebGPU backend. Use WebGL by passing "{ forceWebGL: true }" to the constructor of the renderer.');if(e.addEventListener("select",this._onSessionEvent),e.addEventListener("selectstart",this._onSessionEvent),e.addEventListener("selectend",this._onSessionEvent),e.addEventListener("squeeze",this._onSessionEvent),e.addEventListener("squeezestart",this._onSessionEvent),e.addEventListener("squeezeend",this._onSessionEvent),e.addEventListener("end",this._onSessionEnd),e.addEventListener("inputsourceschange",this._onInputSourcesChange),await i.makeXRCompatible(),this._currentPixelRatio=n.getPixelRatio(),n.getSize(this._currentSize),this._currentAnimationContext=n._animation.getContext(),this._currentAnimationLoop=n._animation.getAnimationLoop(),n._animation.stop(),this._useLayers===!0){let a=null,l=null,c=null;n.depth&&(c=n.stencil?s.DEPTH24_STENCIL8:s.DEPTH_COMPONENT24,a=n.stencil?Do:Oo,l=n.stencil?No:In);const u={colorFormat:s.RGBA8,depthFormat:c,scaleFactor:this._framebufferScaleFactor};this._useMultiviewIfPossible&&n.hasFeature("OVR_multiview2")&&(u.textureType="texture-array",this._useMultiview=!0);const h=new XRWebGLBinding(e,s),f=h.createProjectionLayer(u),d=[f];this._glBinding=h,this._glProjLayer=f,n.setPixelRatio(1),n.setSize(f.textureWidth,f.textureHeight,!1);let p;if(this._useMultiview?(p=new NY(f.textureWidth,f.textureHeight,2),p.type=l,p.format=a):p=new ko(f.textureWidth,f.textureHeight,l,void 0,void 0,void 0,void 0,void 0,void 0,a),this._xrRenderTarget=new h0(f.textureWidth,f.textureHeight,{format:Tr,type:gr,colorSpace:n.outputColorSpace,depthTexture:p,stencilBuffer:n.stencil,samples:o.antialias?4:0,resolveDepthBuffer:f.ignoreDepthValues===!1,resolveStencilBuffer:f.ignoreDepthValues===!1,depth:this._useMultiview?2:1,multiview:this._useMultiview}),this._xrRenderTarget.hasExternalTextures=!0,this._xrRenderTarget.depth=this._useMultiview?2:1,this._supportsLayers=e.enabledFeatures.includes("layers"),this._referenceSpace=await e.requestReferenceSpace(this.getReferenceSpaceType()),this._supportsLayers)for(const m of this._layers)m.plane.material=new As({color:16777215,side:m.type==="cylinder"?Fn:no}),m.plane.material.blending=Pm,m.plane.material.blendEquation=ss,m.plane.material.blendSrc=wc,m.plane.material.blendDst=wc,m.xrlayer=this._createXRLayer(m),d.unshift(m.xrlayer);e.updateRenderState({layers:d})}else{const a={antialias:n.samples>0,alpha:!0,depth:n.depth,stencil:n.stencil,framebufferScaleFactor:this.getFramebufferScaleFactor()},l=new XRWebGLLayer(e,s,a);this._glBaseLayer=l,e.updateRenderState({baseLayer:l}),n.setPixelRatio(1),n.setSize(l.framebufferWidth,l.framebufferHeight,!1),this._xrRenderTarget=new h0(l.framebufferWidth,l.framebufferHeight,{format:Tr,type:gr,colorSpace:n.outputColorSpace,stencilBuffer:n.stencil,resolveDepthBuffer:l.ignoreDepthValues===!1,resolveStencilBuffer:l.ignoreDepthValues===!1}),this._referenceSpace=await e.requestReferenceSpace(this.getReferenceSpaceType())}this.setFoveation(this.getFoveation()),n._animation.setAnimationLoop(this._onAnimationFrame),n._animation.setContext(e),n._animation.start(),this.isPresenting=!0,this.dispatchEvent({type:"sessionstart"})}}updateCamera(e){const n=this._session;if(n===null)return;const i=e.near,s=e.far,o=this._cameraXR,a=this._cameraL,l=this._cameraR;o.near=l.near=a.near=i,o.far=l.far=a.far=s,o.isMultiViewCamera=this._useMultiview,(this._currentDepthNear!==o.near||this._currentDepthFar!==o.far)&&(n.updateRenderState({depthNear:o.near,depthFar:o.far}),this._currentDepthNear=o.near,this._currentDepthFar=o.far),a.layers.mask=e.layers.mask|2,l.layers.mask=e.layers.mask|4,o.layers.mask=a.layers.mask|l.layers.mask;const c=e.parent,u=o.cameras;$5(o,c);for(let h=0;h<u.length;h++)$5(u[h],c);u.length===2?QLe(o,a,l):o.projectionMatrix.copy(a.projectionMatrix),JLe(e,o,c)}_getController(e){let n=this._controllers[e];return n===void 0&&(n=new R1,this._controllers[e]=n),n}}function QLe(r,e,n){U5.setFromMatrixPosition(e.matrixWorld),z5.setFromMatrixPosition(n.matrixWorld);const i=U5.distanceTo(z5),s=e.projectionMatrix.elements,o=n.projectionMatrix.elements,a=s[14]/(s[10]-1),l=s[14]/(s[10]+1),c=(s[9]+1)/s[5],u=(s[9]-1)/s[5],h=(s[8]-1)/s[0],f=(o[8]+1)/o[0],d=a*h,p=a*f,m=i/(-h+f),g=m*-h;if(e.matrixWorld.decompose(r.position,r.quaternion,r.scale),r.translateX(g),r.translateZ(m),r.matrixWorld.compose(r.position,r.quaternion,r.scale),r.matrixWorldInverse.copy(r.matrixWorld).invert(),s[10]===-1)r.projectionMatrix.copy(e.projectionMatrix),r.projectionMatrixInverse.copy(e.projectionMatrixInverse);else{const v=a+m,y=l+m,x=d-g,b=p+(i-g),w=c*l/y*v,_=u*l/y*v;r.projectionMatrix.makePerspective(x,b,w,_,v,y),r.projectionMatrixInverse.copy(r.projectionMatrix).invert()}}function $5(r,e){e===null?r.matrixWorld.copy(r.matrix):r.matrixWorld.multiplyMatrices(e.matrixWorld,r.matrix),r.matrixWorldInverse.copy(r.matrixWorld).invert()}function JLe(r,e,n){n===null?r.matrix.copy(e.matrixWorld):(r.matrix.copy(n.matrixWorld),r.matrix.invert(),r.matrix.multiply(e.matrixWorld)),r.matrix.decompose(r.position,r.quaternion,r.scale),r.updateMatrixWorld(!0),r.projectionMatrix.copy(e.projectionMatrix),r.projectionMatrixInverse.copy(e.projectionMatrixInverse),r.isPerspectiveCamera&&(r.fov=vd*2*Math.atan(1/r.projectionMatrix.elements[5]),r.zoom=1)}function eFe(r){const e=this._controllerInputSources.indexOf(r.inputSource);if(e===-1)return;const n=this._controllers[e];if(n!==void 0){const i=this.getReferenceSpace();n.update(r.inputSource,r.frame,i),n.dispatchEvent({type:r.type,data:r.inputSource})}}function tFe(){const r=this._session,e=this._renderer;r.removeEventListener("select",this._onSessionEvent),r.removeEventListener("selectstart",this._onSessionEvent),r.removeEventListener("selectend",this._onSessionEvent),r.removeEventListener("squeeze",this._onSessionEvent),r.removeEventListener("squeezestart",this._onSessionEvent),r.removeEventListener("squeezeend",this._onSessionEvent),r.removeEventListener("end",this._onSessionEnd),r.removeEventListener("inputsourceschange",this._onInputSourcesChange);for(let n=0;n<this._controllers.length;n++){const i=this._controllerInputSources[n];i!==null&&(this._controllerInputSources[n]=null,this._controllers[n].disconnect(i))}if(this._currentDepthNear=null,this._currentDepthFar=null,e.backend.setXRTarget(null),e.setOutputRenderTarget(null),e.setRenderTarget(null),this._session=null,this._xrRenderTarget=null,this._supportsLayers===!0)for(const n of this._layers)n.renderTarget=new h0(n.pixelwidth,n.pixelheight,{format:Tr,type:gr,depthTexture:new ko(n.pixelwidth,n.pixelheight,n.stencilBuffer?No:In,void 0,void 0,void 0,void 0,void 0,void 0,n.stencilBuffer?Do:Oo),stencilBuffer:n.stencilBuffer,resolveDepthBuffer:!1,resolveStencilBuffer:!1}),n.renderTarget.isXRRenderTarget=!1,n.plane.material=n.material,n.material.map=n.renderTarget.texture,delete n.xrlayer;this.isPresenting=!1,this._useMultiview=!1,e._animation.stop(),e._animation.setAnimationLoop(this._currentAnimationLoop),e._animation.setContext(this._currentAnimationContext),e._animation.start(),e.setPixelRatio(this._currentPixelRatio),e.setSize(this._currentSize.width,this._currentSize.height,!1),this.dispatchEvent({type:"sessionend"})}function nFe(r){const e=this._controllers,n=this._controllerInputSources;for(let i=0;i<r.removed.length;i++){const s=r.removed[i],o=n.indexOf(s);o>=0&&(n[o]=null,e[o].disconnect(s))}for(let i=0;i<r.added.length;i++){const s=r.added[i];let o=n.indexOf(s);if(o===-1){for(let l=0;l<e.length;l++)if(l>=n.length){n.push(s),o=l;break}else if(n[l]===null){n[l]=s,o=l;break}if(o===-1)break}const a=e[o];a&&a.connect(s)}}function rFe(r){return r.type==="quad"?this._glBinding.createQuadLayer({transform:new XRRigidTransform(r.translation,r.quaternion),depthFormat:this._gl.DEPTH_COMPONENT,width:r.width/2,height:r.height/2,space:this._referenceSpace,viewPixelWidth:r.pixelwidth,viewPixelHeight:r.pixelheight}):this._glBinding.createCylinderLayer({transform:new XRRigidTransform(r.translation,r.quaternion),depthFormat:this._gl.DEPTH_COMPONENT,radius:r.radius,centralAngle:r.centralAngle,aspectRatio:r.aspectRatio,space:this._referenceSpace,viewPixelWidth:r.pixelwidth,viewPixelHeight:r.pixelheight})}function iFe(r,e){if(e===void 0)return;const n=this._cameraXR,i=this._renderer,s=i.backend,o=this._glBaseLayer,a=this.getReferenceSpace(),l=e.getViewerPose(a);if(this._xrFrame=e,l!==null){const c=l.views;this._glBaseLayer!==null&&s.setXRTarget(o.framebuffer);let u=!1;c.length!==n.cameras.length&&(n.cameras.length=0,u=!0);for(let h=0;h<c.length;h++){const f=c[h];let d;if(this._useLayers===!0){const m=this._glBinding.getViewSubImage(this._glProjLayer,f);d=m.viewport,h===0&&s.setXRRenderTargetTextures(this._xrRenderTarget,m.colorTexture,this._glProjLayer.ignoreDepthValues&&!this._useMultiview?void 0:m.depthStencilTexture)}else d=o.getViewport(f);let p=this._cameras[h];p===void 0&&(p=new Ti,p.layers.enable(h),p.viewport=new Nt,this._cameras[h]=p),p.matrix.fromArray(f.transform.matrix),p.matrix.decompose(p.position,p.quaternion,p.scale),p.projectionMatrix.fromArray(f.projectionMatrix),p.projectionMatrixInverse.copy(p.projectionMatrix).invert(),p.viewport.set(d.x,d.y,d.width,d.height),h===0&&(n.matrix.copy(p.matrix),n.matrix.decompose(n.position,n.quaternion,n.scale)),u===!0&&n.cameras.push(p)}i.setOutputRenderTarget(this._xrRenderTarget)}for(let c=0;c<this._controllers.length;c++){const u=this._controllerInputSources[c],h=this._controllers[c];u!==null&&h!==void 0&&h.update(u,e,a)}this._currentAnimationLoop&&this._currentAnimationLoop(r,e),e.detectedPlanes&&this.dispatchEvent({type:"planesdetected",data:e}),this._xrFrame=null}const j5=new QM,FS=new Fe,TN=new Nt,EN=new d_,MN=new LF,BS=new sn,$u=new Nt;class sFe{constructor(e,n={}){this.isRenderer=!0;const{logarithmicDepthBuffer:i=!1,alpha:s=!0,depth:o=!0,stencil:a=!1,antialias:l=!1,samples:c=0,getFallback:u=null,colorBufferType:h=Ei,multiview:f=!1}=n;this.domElement=e.getDomElement(),this.backend=e,this.samples=c||l===!0?4:0,this.autoClear=!0,this.autoClearColor=!0,this.autoClearDepth=!0,this.autoClearStencil=!0,this.alpha=s,this.logarithmicDepthBuffer=i,this.outputColorSpace=vt,this.toneMapping=io,this.toneMappingExposure=1,this.sortObjects=!0,this.depth=o,this.stencil=a,this.info=new Vke,this.overrideNodes={modelViewMatrix:null,modelNormalViewMatrix:null},this.library=new mee,this.lighting=new YLe,this._getFallback=u,this._pixelRatio=1,this._width=this.domElement.width,this._height=this.domElement.height,this._viewport=new Nt(0,0,this._width,this._height),this._scissor=new Nt(0,0,this._width,this._height),this._scissorTest=!1,this._attributes=null,this._geometries=null,this._nodes=null,this._animation=null,this._bindings=null,this._objects=null,this._pipelines=null,this._bundles=null,this._renderLists=null,this._renderContexts=null,this._textures=null,this._background=null,this._quad=new tee(new mi),this._quad.material.name="Renderer_output",this._currentRenderContext=null,this._opaqueSort=null,this._transparentSort=null,this._frameBufferTarget=null;const d=this.alpha===!0?0:1;this._clearColor=new K3(0,0,0,d),this._clearDepth=1,this._clearStencil=0,this._renderTarget=null,this._activeCubeFace=0,this._activeMipmapLevel=0,this._outputRenderTarget=null,this._mrt=null,this._renderObjectFunction=null,this._currentRenderObjectFunction=null,this._currentRenderBundle=null,this._handleObjectFunction=this._renderObjectDirect,this._isDeviceLost=!1,this.onDeviceLost=this._onDeviceLost,this._colorBufferType=h,this._initialized=!1,this._initPromise=null,this._compilationPromises=null,this.transparent=!0,this.opaque=!0,this.shadowMap={enabled:!1,type:aF},this.xr=new ZLe(this,f),this.debug={checkShaderErrors:!0,onShaderError:null,getShaderAsync:async(p,m,g)=>{await this.compileAsync(p,m);const v=this._renderLists.get(p,m),y=this._renderContexts.get(p,m,this._renderTarget),x=p.overrideMaterial||g.material,b=this._objects.get(g,x,p,m,v.lightsNode,y,y.clippingContext),{fragmentShader:w,vertexShader:_}=b.getNodeBuilderState();return{fragmentShader:w,vertexShader:_}}}}async init(){if(this._initialized)throw new Error("Renderer: Backend has already been initialized.");return this._initPromise!==null?this._initPromise:(this._initPromise=new Promise(async(e,n)=>{let i=this.backend;try{await i.init(this)}catch(s){if(this._getFallback!==null)try{this.backend=i=this._getFallback(s),await i.init(this)}catch(o){n(o);return}else{n(s);return}}this._nodes=new WLe(this,i),this._animation=new kke(this._nodes,this.info),this._attributes=new $ke(i),this._background=new uLe(this,this._nodes),this._geometries=new jke(this._attributes,this.info),this._textures=new iIe(this,i,this.info),this._pipelines=new qke(i,this._nodes),this._bindings=new Xke(i,this._nodes,this._textures,this._attributes,this._pipelines,this.info),this._objects=new Bke(this,this._nodes,this._geometries,this._pipelines,this._bindings,this.info),this._renderLists=new Zke(this.lighting),this._bundles=new XLe,this._renderContexts=new nIe,this._animation.start(),this._initialized=!0,e(this)}),this._initPromise)}get coordinateSystem(){return this.backend.coordinateSystem}async compileAsync(e,n,i=null){if(this._isDeviceLost===!0)return;this._initialized===!1&&await this.init();const s=this._nodes.nodeFrame,o=s.renderId,a=this._currentRenderContext,l=this._currentRenderObjectFunction,c=this._compilationPromises,u=e.isScene===!0?e:j5;i===null&&(i=e);const h=this._renderTarget,f=this._renderContexts.get(i,n,h),d=this._activeMipmapLevel,p=[];this._currentRenderContext=f,this._currentRenderObjectFunction=this.renderObject,this._handleObjectFunction=this._createObjectPipeline,this._compilationPromises=p,s.renderId++,s.update(),f.depth=this.depth,f.stencil=this.stencil,f.clippingContext||(f.clippingContext=new gE),f.clippingContext.updateGlobal(u,n),u.onBeforeRender(this,e,n,h);const m=this._renderLists.get(e,n);if(m.begin(),this._projectObject(e,n,0,m,f.clippingContext),i!==e&&i.traverseVisible(function(b){b.isLight&&b.layers.test(n.layers)&&m.pushLight(b)}),m.finish(),h!==null){this._textures.updateRenderTarget(h,d);const b=this._textures.get(h);f.textures=b.textures,f.depthTexture=b.depthTexture}else f.textures=null,f.depthTexture=null;this._background.update(u,m,f);const g=m.opaque,v=m.transparent,y=m.transparentDoublePass,x=m.lightsNode;this.opaque===!0&&g.length>0&&this._renderObjects(g,n,u,x),this.transparent===!0&&v.length>0&&this._renderTransparents(v,y,n,u,x),s.renderId=o,this._currentRenderContext=a,this._currentRenderObjectFunction=l,this._compilationPromises=c,this._handleObjectFunction=this._renderObjectDirect,await Promise.all(p)}async renderAsync(e,n){this._initialized===!1&&await this.init(),this._renderScene(e,n)}async waitForGPU(){await this.backend.waitForGPU()}set highPrecision(e){e===!0?(this.overrideNodes.modelViewMatrix=VG,this.overrideNodes.modelNormalViewMatrix=GG):this.highPrecision&&(this.overrideNodes.modelViewMatrix=null,this.overrideNodes.modelNormalViewMatrix=null)}get highPrecision(){return this.overrideNodes.modelViewMatrix===VG&&this.overrideNodes.modelNormalViewMatrix===GG}setMRT(e){return this._mrt=e,this}getMRT(){return this._mrt}getColorBufferType(){return this._colorBufferType}_onDeviceLost(e){let n=`THREE.WebGPURenderer: ${e.api} Device Lost:

Message: ${e.message}`;e.reason&&(n+=`
Reason: ${e.reason}`),console.error(n),this._isDeviceLost=!0}_renderBundle(e,n,i){const{bundleGroup:s,camera:o,renderList:a}=e,l=this._currentRenderContext,c=this._bundles.get(s,o),u=this.backend.get(c);u.renderContexts===void 0&&(u.renderContexts=new Set);const h=s.version!==u.version,f=u.renderContexts.has(l)===!1||h;if(u.renderContexts.add(l),f){this.backend.beginBundle(l),(u.renderObjects===void 0||h)&&(u.renderObjects=[]),this._currentRenderBundle=c;const{transparentDoublePass:d,transparent:p,opaque:m}=a;this.opaque===!0&&m.length>0&&this._renderObjects(m,o,n,i),this.transparent===!0&&p.length>0&&this._renderTransparents(p,d,o,n,i),this._currentRenderBundle=null,this.backend.finishBundle(l,c),u.version=s.version}else{const{renderObjects:d}=u;for(let p=0,m=d.length;p<m;p++){const g=d[p];this._nodes.needsRefresh(g)&&(this._nodes.updateBefore(g),this._nodes.updateForRender(g),this._bindings.updateForRender(g),this._nodes.updateAfter(g))}}this.backend.addBundle(l,c)}render(e,n){if(this._initialized===!1)return console.warn("THREE.Renderer: .render() called before the backend is initialized. Try using .renderAsync() instead."),this.renderAsync(e,n);this._renderScene(e,n)}_getFrameBufferTarget(){const{currentToneMapping:e,currentColorSpace:n}=this;if(e!==io===!1&&n!==Ol===!1)return null;const{width:o,height:a}=this.getDrawingBufferSize(FS),{depth:l,stencil:c}=this;let u=this._frameBufferTarget;u===null&&(u=new $h(o,a,{depthBuffer:l,stencilBuffer:c,type:this._colorBufferType,format:Tr,colorSpace:Ol,generateMipmaps:!1,minFilter:li,magFilter:li,samples:this.samples}),u.isPostProcessingRenderTarget=!0,this._frameBufferTarget=u);const h=this.getOutputRenderTarget();return u.depthBuffer=l,u.stencilBuffer=c,u.setSize(o,a,h!==null?h.depth:1),u.viewport.copy(this._viewport),u.scissor.copy(this._scissor),u.viewport.multiplyScalar(this._pixelRatio),u.scissor.multiplyScalar(this._pixelRatio),u.scissorTest=this._scissorTest,u.multiview=h!==null?h.multiview:!1,u}_renderScene(e,n,i=!0){if(this._isDeviceLost===!0)return;const s=i?this._getFrameBufferTarget():null,o=this._nodes.nodeFrame,a=o.renderId,l=this._currentRenderContext,c=this._currentRenderObjectFunction,u=e.isScene===!0?e:j5,h=this._renderTarget||this._outputRenderTarget,f=this._activeCubeFace,d=this._activeMipmapLevel;let p;s!==null?(p=s,this.setRenderTarget(p)):p=h;const m=this._renderContexts.get(e,n,p);this._currentRenderContext=m,this._currentRenderObjectFunction=this._renderObjectFunction||this.renderObject,this.info.calls++,this.info.render.calls++,this.info.render.frameCalls++,o.renderId=this.info.calls;const g=this.coordinateSystem,v=this.xr;if(n.coordinateSystem!==g&&v.isPresenting===!1&&(n.coordinateSystem=g,n.updateProjectionMatrix(),n.isArrayCamera))for(const B of n.cameras)B.coordinateSystem=g,B.updateProjectionMatrix();e.matrixWorldAutoUpdate===!0&&e.updateMatrixWorld(),n.parent===null&&n.matrixWorldAutoUpdate===!0&&n.updateMatrixWorld(),v.enabled===!0&&v.isPresenting===!0&&(v.cameraAutoUpdate===!0&&v.updateCamera(n),n=v.getCamera());let y=this._viewport,x=this._scissor,b=this._pixelRatio;p!==null&&(y=p.viewport,x=p.scissor,b=1),this.getDrawingBufferSize(FS),TN.set(0,0,FS.width,FS.height);const w=y.minDepth===void 0?0:y.minDepth,_=y.maxDepth===void 0?1:y.maxDepth;m.viewportValue.copy(y).multiplyScalar(b).floor(),m.viewportValue.width>>=d,m.viewportValue.height>>=d,m.viewportValue.minDepth=w,m.viewportValue.maxDepth=_,m.viewport=m.viewportValue.equals(TN)===!1,m.scissorValue.copy(x).multiplyScalar(b).floor(),m.scissor=this._scissorTest&&m.scissorValue.equals(TN)===!1,m.scissorValue.width>>=d,m.scissorValue.height>>=d,m.clippingContext||(m.clippingContext=new gE),m.clippingContext.updateGlobal(u,n),u.onBeforeRender(this,e,n,p);const S=n.isArrayCamera?MN:EN;n.isArrayCamera||(BS.multiplyMatrices(n.projectionMatrix,n.matrixWorldInverse),S.setFromProjectionMatrix(BS,g));const T=this._renderLists.get(e,n);if(T.begin(),this._projectObject(e,n,0,T,m.clippingContext),T.finish(),this.sortObjects===!0&&T.sort(this._opaqueSort,this._transparentSort),p!==null){this._textures.updateRenderTarget(p,d);const B=this._textures.get(p);m.textures=B.textures,m.depthTexture=B.depthTexture,m.width=B.width,m.height=B.height,m.renderTarget=p,m.depth=p.depthBuffer,m.stencil=p.stencilBuffer}else m.textures=null,m.depthTexture=null,m.width=this.domElement.width,m.height=this.domElement.height,m.depth=this.depth,m.stencil=this.stencil;m.width>>=d,m.height>>=d,m.activeCubeFace=f,m.activeMipmapLevel=d,m.occlusionQueryCount=T.occlusionQueryCount,this._background.update(u,T,m),m.camera=n,this.backend.beginRender(m);const{bundles:E,lightsNode:M,transparentDoublePass:A,transparent:P,opaque:D}=T;return E.length>0&&this._renderBundles(E,u,M),this.opaque===!0&&D.length>0&&this._renderObjects(D,n,u,M),this.transparent===!0&&P.length>0&&this._renderTransparents(P,A,n,u,M),this.backend.finishRender(m),o.renderId=a,this._currentRenderContext=l,this._currentRenderObjectFunction=c,s!==null&&(this.setRenderTarget(h,f,d),this._renderOutput(p)),u.onAfterRender(this,e,n,p),m}_renderOutput(e){const n=this._quad;this._nodes.hasOutputChange(e.texture)&&(n.material.fragmentNode=this._nodes.getOutputNode(e.texture),n.material.needsUpdate=!0);const i=this.autoClear,s=this.xr.enabled;this.autoClear=!1,this.xr.enabled=!1,this._renderScene(n,n.camera,!1),this.autoClear=i,this.xr.enabled=s}getMaxAnisotropy(){return this.backend.getMaxAnisotropy()}getActiveCubeFace(){return this._activeCubeFace}getActiveMipmapLevel(){return this._activeMipmapLevel}async setAnimationLoop(e){this._initialized===!1&&await this.init(),this._animation.setAnimationLoop(e)}async getArrayBufferAsync(e){return await this.backend.getArrayBufferAsync(e)}getContext(){return this.backend.getContext()}getPixelRatio(){return this._pixelRatio}getDrawingBufferSize(e){return e.set(this._width*this._pixelRatio,this._height*this._pixelRatio).floor()}getSize(e){return e.set(this._width,this._height)}setPixelRatio(e=1){this._pixelRatio!==e&&(this._pixelRatio=e,this.setSize(this._width,this._height,!1))}setDrawingBufferSize(e,n,i){this.xr&&this.xr.isPresenting||(this._width=e,this._height=n,this._pixelRatio=i,this.domElement.width=Math.floor(e*i),this.domElement.height=Math.floor(n*i),this.setViewport(0,0,e,n),this._initialized&&this.backend.updateSize())}setSize(e,n,i=!0){this.xr&&this.xr.isPresenting||(this._width=e,this._height=n,this.domElement.width=Math.floor(e*this._pixelRatio),this.domElement.height=Math.floor(n*this._pixelRatio),i===!0&&(this.domElement.style.width=e+"px",this.domElement.style.height=n+"px"),this.setViewport(0,0,e,n),this._initialized&&this.backend.updateSize())}setOpaqueSort(e){this._opaqueSort=e}setTransparentSort(e){this._transparentSort=e}getScissor(e){const n=this._scissor;return e.x=n.x,e.y=n.y,e.width=n.width,e.height=n.height,e}setScissor(e,n,i,s){const o=this._scissor;e.isVector4?o.copy(e):o.set(e,n,i,s)}getScissorTest(){return this._scissorTest}setScissorTest(e){this._scissorTest=e,this.backend.setScissorTest(e)}getViewport(e){return e.copy(this._viewport)}setViewport(e,n,i,s,o=0,a=1){const l=this._viewport;e.isVector4?l.copy(e):l.set(e,n,i,s),l.minDepth=o,l.maxDepth=a}getClearColor(e){return e.copy(this._clearColor)}setClearColor(e,n=1){this._clearColor.set(e),this._clearColor.a=n}getClearAlpha(){return this._clearColor.a}setClearAlpha(e){this._clearColor.a=e}getClearDepth(){return this._clearDepth}setClearDepth(e){this._clearDepth=e}getClearStencil(){return this._clearStencil}setClearStencil(e){this._clearStencil=e}isOccluded(e){const n=this._currentRenderContext;return n&&this.backend.isOccluded(n,e)}clear(e=!0,n=!0,i=!0){if(this._initialized===!1)return console.warn("THREE.Renderer: .clear() called before the backend is initialized. Try using .clearAsync() instead."),this.clearAsync(e,n,i);const s=this._renderTarget||this._getFrameBufferTarget();let o=null;if(s!==null){this._textures.updateRenderTarget(s);const a=this._textures.get(s);o=this._renderContexts.getForClear(s),o.textures=a.textures,o.depthTexture=a.depthTexture,o.width=a.width,o.height=a.height,o.renderTarget=s,o.depth=s.depthBuffer,o.stencil=s.stencilBuffer,o.clearColorValue=this.backend.getClearColor(),o.activeCubeFace=this.getActiveCubeFace(),o.activeMipmapLevel=this.getActiveMipmapLevel()}this.backend.clear(e,n,i,o),s!==null&&this._renderTarget===null&&this._renderOutput(s)}clearColor(){return this.clear(!0,!1,!1)}clearDepth(){return this.clear(!1,!0,!1)}clearStencil(){return this.clear(!1,!1,!0)}async clearAsync(e=!0,n=!0,i=!0){this._initialized===!1&&await this.init(),this.clear(e,n,i)}async clearColorAsync(){this.clearAsync(!0,!1,!1)}async clearDepthAsync(){this.clearAsync(!1,!0,!1)}async clearStencilAsync(){this.clearAsync(!1,!1,!0)}get currentToneMapping(){return this.isOutputTarget?this.toneMapping:io}get currentColorSpace(){return this.isOutputTarget?this.outputColorSpace:Ol}get isOutputTarget(){return this._renderTarget===this._outputRenderTarget||this._renderTarget===null}dispose(){this.info.dispose(),this.backend.dispose(),this._animation.dispose(),this._objects.dispose(),this._pipelines.dispose(),this._nodes.dispose(),this._bindings.dispose(),this._renderLists.dispose(),this._renderContexts.dispose(),this._textures.dispose(),this._frameBufferTarget!==null&&this._frameBufferTarget.dispose(),Object.values(this.backend.timestampQueryPool).forEach(e=>{e!==null&&e.dispose()}),this.setRenderTarget(null),this.setAnimationLoop(null)}setRenderTarget(e,n=0,i=0){this._renderTarget=e,this._activeCubeFace=n,this._activeMipmapLevel=i}getRenderTarget(){return this._renderTarget}setOutputRenderTarget(e){this._outputRenderTarget=e}getOutputRenderTarget(){return this._outputRenderTarget}setRenderObjectFunction(e){this._renderObjectFunction=e}getRenderObjectFunction(){return this._renderObjectFunction}compute(e){if(this._isDeviceLost===!0)return;if(this._initialized===!1)return console.warn("THREE.Renderer: .compute() called before the backend is initialized. Try using .computeAsync() instead."),this.computeAsync(e);const n=this._nodes.nodeFrame,i=n.renderId;this.info.calls++,this.info.compute.calls++,this.info.compute.frameCalls++,n.renderId=this.info.calls;const s=this.backend,o=this._pipelines,a=this._bindings,l=this._nodes,c=Array.isArray(e)?e:[e];if(c[0]===void 0||c[0].isComputeNode!==!0)throw new Error("THREE.Renderer: .compute() expects a ComputeNode.");s.beginCompute(e);for(const u of c){if(o.has(u)===!1){const d=()=>{u.removeEventListener("dispose",d),o.delete(u),a.delete(u),l.delete(u)};u.addEventListener("dispose",d);const p=u.onInitFunction;p!==null&&p.call(u,{renderer:this})}l.updateForCompute(u),a.updateForCompute(u);const h=a.getForCompute(u),f=o.getForCompute(u,h);s.compute(e,u,h,f)}s.finishCompute(e),n.renderId=i}async computeAsync(e){this._initialized===!1&&await this.init(),this.compute(e)}async hasFeatureAsync(e){return this._initialized===!1&&await this.init(),this.backend.hasFeature(e)}async resolveTimestampsAsync(e="render"){return this._initialized===!1&&await this.init(),this.backend.resolveTimestampsAsync(e)}hasFeature(e){return this._initialized===!1?(console.warn("THREE.Renderer: .hasFeature() called before the backend is initialized. Try using .hasFeatureAsync() instead."),!1):this.backend.hasFeature(e)}hasInitialized(){return this._initialized}async initTextureAsync(e){this._initialized===!1&&await this.init(),this._textures.updateTexture(e)}initTexture(e){this._initialized===!1&&console.warn("THREE.Renderer: .initTexture() called before the backend is initialized. Try using .initTextureAsync() instead."),this._textures.updateTexture(e)}copyFramebufferToTexture(e,n=null){if(n!==null)if(n.isVector2)n=$u.set(n.x,n.y,e.image.width,e.image.height).floor();else if(n.isVector4)n=$u.copy(n).floor();else{console.error("THREE.Renderer.copyFramebufferToTexture: Invalid rectangle.");return}else n=$u.set(0,0,e.image.width,e.image.height);let i=this._currentRenderContext,s;i!==null?s=i.renderTarget:(s=this._renderTarget||this._getFrameBufferTarget(),s!==null&&(this._textures.updateRenderTarget(s),i=this._textures.get(s))),this._textures.updateTexture(e,{renderTarget:s}),this.backend.copyFramebufferToTexture(e,i,n)}copyTextureToTexture(e,n,i=null,s=null,o=0,a=0){this._textures.updateTexture(e),this._textures.updateTexture(n),this.backend.copyTextureToTexture(e,n,i,s,o,a)}async readRenderTargetPixelsAsync(e,n,i,s,o,a=0,l=0){return this.backend.copyTextureToBuffer(e.textures[a],n,i,s,o,l)}_projectObject(e,n,i,s,o){if(e.visible===!1)return;if(e.layers.test(n.layers)){if(e.isGroup)i=e.renderOrder,e.isClippingGroup&&e.enabled&&(o=o.getGroupContext(e));else if(e.isLOD)e.autoUpdate===!0&&e.update(n);else if(e.isLight)s.pushLight(e);else if(e.isSprite){const c=n.isArrayCamera?MN:EN;if(!e.frustumCulled||c.intersectsSprite(e,n)){this.sortObjects===!0&&$u.setFromMatrixPosition(e.matrixWorld).applyMatrix4(BS);const{geometry:u,material:h}=e;h.visible&&s.push(e,u,h,i,$u.z,null,o)}}else if(e.isLineLoop)console.error("THREE.Renderer: Objects of type THREE.LineLoop are not supported. Please use THREE.Line or THREE.LineSegments.");else if(e.isMesh||e.isLine||e.isPoints){const c=n.isArrayCamera?MN:EN;if(!e.frustumCulled||c.intersectsObject(e,n)){const{geometry:u,material:h}=e;if(this.sortObjects===!0&&(u.boundingSphere===null&&u.computeBoundingSphere(),$u.copy(u.boundingSphere.center).applyMatrix4(e.matrixWorld).applyMatrix4(BS)),Array.isArray(h)){const f=u.groups;for(let d=0,p=f.length;d<p;d++){const m=f[d],g=h[m.materialIndex];g&&g.visible&&s.push(e,u,g,i,$u.z,m,o)}}else h.visible&&s.push(e,u,h,i,$u.z,null,o)}}}if(e.isBundleGroup===!0&&this.backend.beginBundle!==void 0){const c=s;s=this._renderLists.get(e,n),s.begin(),c.pushBundle({bundleGroup:e,camera:n,renderList:s}),s.finish()}const l=e.children;for(let c=0,u=l.length;c<u;c++)this._projectObject(l[c],n,i,s,o)}_renderBundles(e,n,i){for(const s of e)this._renderBundle(s,n,i)}_renderTransparents(e,n,i,s,o){if(n.length>0){for(const{material:a}of n)a.side=Fn;this._renderObjects(n,i,s,o,"backSide");for(const{material:a}of n)a.side=no;this._renderObjects(e,i,s,o);for(const{material:a}of n)a.side=Es}else this._renderObjects(e,i,s,o)}_renderObjects(e,n,i,s,o=null){for(let a=0,l=e.length;a<l;a++){const{object:c,geometry:u,material:h,group:f,clippingContext:d}=e[a];this._currentRenderObjectFunction(c,i,n,u,h,f,s,d,o)}}renderObject(e,n,i,s,o,a,l,c=null,u=null){let h,f,d;if(e.onBeforeRender(this,n,i,s,o,a),o.allowOverride===!0&&n.overrideMaterial!==null){const p=n.overrideMaterial;o.positionNode&&o.positionNode.isNode&&(h=p.positionNode,p.positionNode=o.positionNode),p.alphaTest=o.alphaTest,p.alphaMap=o.alphaMap,p.transparent=o.transparent||o.transmission>0,p.isShadowPassMaterial&&(p.side=o.shadowSide===null?o.side:o.shadowSide,o.depthNode&&o.depthNode.isNode&&(d=p.depthNode,p.depthNode=o.depthNode),o.castShadowNode&&o.castShadowNode.isNode&&(f=p.colorNode,p.colorNode=o.castShadowNode),o.castShadowPositionNode&&o.castShadowPositionNode.isNode&&(h=p.positionNode,p.positionNode=o.castShadowPositionNode)),o=p}o.transparent===!0&&o.side===Es&&o.forceSinglePass===!1?(o.side=Fn,this._handleObjectFunction(e,o,n,i,l,a,c,"backSide"),o.side=no,this._handleObjectFunction(e,o,n,i,l,a,c,u),o.side=Es):this._handleObjectFunction(e,o,n,i,l,a,c,u),h!==void 0&&(n.overrideMaterial.positionNode=h),d!==void 0&&(n.overrideMaterial.depthNode=d),f!==void 0&&(n.overrideMaterial.colorNode=f),e.onAfterRender(this,n,i,s,o,a)}_renderObjectDirect(e,n,i,s,o,a,l,c){const u=this._objects.get(e,n,i,s,o,this._currentRenderContext,l,c);u.drawRange=e.geometry.drawRange,u.group=a;const h=this._nodes.needsRefresh(u);h&&(this._nodes.updateBefore(u),this._geometries.updateForRender(u),this._nodes.updateForRender(u),this._bindings.updateForRender(u)),this._pipelines.updateForRender(u),this._currentRenderBundle!==null&&(this.backend.get(this._currentRenderBundle).renderObjects.push(u),u.bundle=this._currentRenderBundle.bundleGroup),this.backend.draw(u,this.info),h&&this._nodes.updateAfter(u)}_createObjectPipeline(e,n,i,s,o,a,l,c){const u=this._objects.get(e,n,i,s,o,this._currentRenderContext,l,c);u.drawRange=e.geometry.drawRange,u.group=a,this._nodes.updateBefore(u),this._geometries.updateForRender(u),this._nodes.updateForRender(u),this._bindings.updateForRender(u),this._pipelines.getForRender(u,this._compilationPromises),this._nodes.updateAfter(u)}get compile(){return this.compileAsync}}class Q3{constructor(e=""){this.name=e,this.visibility=0}setVisibility(e){this.visibility|=e}clone(){return Object.assign(new this.constructor,this)}}function oFe(r){return r+(th-r%th)%th}class gee extends Q3{constructor(e,n=null){super(e),this.isBuffer=!0,this.bytesPerElement=Float32Array.BYTES_PER_ELEMENT,this._buffer=n}get byteLength(){return oFe(this._buffer.byteLength)}get buffer(){return this._buffer}update(){return!0}}class yee extends gee{constructor(e,n=null){super(e,n),this.isUniformBuffer=!0}}let aFe=0;class vee extends yee{constructor(e,n){super("UniformBuffer_"+aFe++,e?e.value:null),this.nodeUniform=e,this.groupNode=n}get buffer(){return this.nodeUniform.value}}class lFe extends yee{constructor(e){super(e),this.isUniformsGroup=!0,this._values=null,this.uniforms=[]}addUniform(e){return this.uniforms.push(e),this}removeUniform(e){const n=this.uniforms.indexOf(e);return n!==-1&&this.uniforms.splice(n,1),this}get values(){return this._values===null&&(this._values=Array.from(this.buffer)),this._values}get buffer(){let e=this._buffer;if(e===null){const n=this.byteLength;e=new Float32Array(new ArrayBuffer(n)),this._buffer=e}return e}get byteLength(){let e=0;for(let n=0,i=this.uniforms.length;n<i;n++){const s=this.uniforms[n],{boundary:o,itemSize:a}=s,l=e%th,c=th-l;l!==0&&c-o<0?e+=th-l:l%o!==0&&(e+=l%o),s.offset=e/this.bytesPerElement,e+=a*this.bytesPerElement}return Math.ceil(e/th)*th}update(){let e=!1;for(const n of this.uniforms)this.updateByType(n)===!0&&(e=!0);return e}updateByType(e){if(e.isNumberUniform)return this.updateNumber(e);if(e.isVector2Uniform)return this.updateVector2(e);if(e.isVector3Uniform)return this.updateVector3(e);if(e.isVector4Uniform)return this.updateVector4(e);if(e.isColorUniform)return this.updateColor(e);if(e.isMatrix3Uniform)return this.updateMatrix3(e);if(e.isMatrix4Uniform)return this.updateMatrix4(e);console.error("THREE.WebGPUUniformsGroup: Unsupported uniform type.",e)}updateNumber(e){let n=!1;const i=this.values,s=e.getValue(),o=e.offset,a=e.getType();if(i[o]!==s){const l=this._getBufferForType(a);l[o]=i[o]=s,n=!0}return n}updateVector2(e){let n=!1;const i=this.values,s=e.getValue(),o=e.offset,a=e.getType();if(i[o+0]!==s.x||i[o+1]!==s.y){const l=this._getBufferForType(a);l[o+0]=i[o+0]=s.x,l[o+1]=i[o+1]=s.y,n=!0}return n}updateVector3(e){let n=!1;const i=this.values,s=e.getValue(),o=e.offset,a=e.getType();if(i[o+0]!==s.x||i[o+1]!==s.y||i[o+2]!==s.z){const l=this._getBufferForType(a);l[o+0]=i[o+0]=s.x,l[o+1]=i[o+1]=s.y,l[o+2]=i[o+2]=s.z,n=!0}return n}updateVector4(e){let n=!1;const i=this.values,s=e.getValue(),o=e.offset,a=e.getType();if(i[o+0]!==s.x||i[o+1]!==s.y||i[o+2]!==s.z||i[o+4]!==s.w){const l=this._getBufferForType(a);l[o+0]=i[o+0]=s.x,l[o+1]=i[o+1]=s.y,l[o+2]=i[o+2]=s.z,l[o+3]=i[o+3]=s.w,n=!0}return n}updateColor(e){let n=!1;const i=this.values,s=e.getValue(),o=e.offset;if(i[o+0]!==s.r||i[o+1]!==s.g||i[o+2]!==s.b){const a=this.buffer;a[o+0]=i[o+0]=s.r,a[o+1]=i[o+1]=s.g,a[o+2]=i[o+2]=s.b,n=!0}return n}updateMatrix3(e){let n=!1;const i=this.values,s=e.getValue().elements,o=e.offset;if(i[o+0]!==s[0]||i[o+1]!==s[1]||i[o+2]!==s[2]||i[o+4]!==s[3]||i[o+5]!==s[4]||i[o+6]!==s[5]||i[o+8]!==s[6]||i[o+9]!==s[7]||i[o+10]!==s[8]){const a=this.buffer;a[o+0]=i[o+0]=s[0],a[o+1]=i[o+1]=s[1],a[o+2]=i[o+2]=s[2],a[o+4]=i[o+4]=s[3],a[o+5]=i[o+5]=s[4],a[o+6]=i[o+6]=s[5],a[o+8]=i[o+8]=s[6],a[o+9]=i[o+9]=s[7],a[o+10]=i[o+10]=s[8],n=!0}return n}updateMatrix4(e){let n=!1;const i=this.values,s=e.getValue().elements,o=e.offset;return uFe(i,s,o)===!1&&(this.buffer.set(s,o),cFe(i,s,o),n=!0),n}_getBufferForType(e){return e==="int"||e==="ivec2"||e==="ivec3"||e==="ivec4"?new Int32Array(this.buffer.buffer):e==="uint"||e==="uvec2"||e==="uvec3"||e==="uvec4"?new Uint32Array(this.buffer.buffer):this.buffer}}function cFe(r,e,n){for(let i=0,s=e.length;i<s;i++)r[n+i]=e[i]}function uFe(r,e,n){for(let i=0,s=e.length;i<s;i++)if(r[n+i]!==e[i])return!1;return!0}let hFe=0;class xee extends lFe{constructor(e,n){super(e),this.id=hFe++,this.groupNode=n,this.isNodeUniformsGroup=!0}}let fFe=0;class dFe extends Q3{constructor(e,n){super(e),this.id=fFe++,this.texture=n,this.version=n?n.version:0,this.store=!1,this.generation=null,this.isSampledTexture=!0}needsBindingsUpdate(e){const{texture:n}=this;return e!==this.generation?(this.generation=e,!0):n.isVideoTexture}update(){const{texture:e,version:n}=this;return n!==e.version?(this.version=e.version,!0):!1}}class AA extends dFe{constructor(e,n,i,s=null){super(e,n?n.value:null),this.textureNode=n,this.groupNode=i,this.access=s}needsBindingsUpdate(e){return this.textureNode.value!==this.texture||super.needsBindingsUpdate(e)}update(){const{textureNode:e}=this;return this.texture!==e.value?(this.texture=e.value,!0):super.update()}}class bee extends AA{constructor(e,n,i,s=null){super(e,n,i,s),this.isSampledCubeTexture=!0}}class _ee extends AA{constructor(e,n,i,s=null){super(e,n,i,s),this.isSampledTexture3D=!0}}const pFe={textureDimensions:"textureSize",equals:"equal"},mFe={low:"lowp",medium:"mediump",high:"highp"},V5={swizzleAssign:!0,storageBuffer:!1},G5={perspective:"smooth",linear:"noperspective"},H5={centroid:"centroid","flat first":"flat","flat either":"flat"},W5=`
precision highp float;
precision highp int;
precision highp sampler2D;
precision highp sampler3D;
precision highp samplerCube;
precision highp sampler2DArray;

precision highp usampler2D;
precision highp usampler3D;
precision highp usamplerCube;
precision highp usampler2DArray;

precision highp isampler2D;
precision highp isampler3D;
precision highp isamplerCube;
precision highp isampler2DArray;

precision lowp sampler2DShadow;
precision lowp sampler2DArrayShadow;
precision lowp samplerCubeShadow;
`;class gFe extends fee{constructor(e,n){super(e,n,new HLe),this.uniformGroups={},this.transforms=[],this.extensions={},this.builtins={vertex:[],fragment:[],compute:[]}}needsToWorkingColorSpace(e){return e.isVideoTexture===!0&&e.colorSpace!==Eo}getMethod(e){return pFe[e]||e}getOutputStructName(){return""}buildFunctionCode(e){const n=e.layout,i=this.flowShaderNode(e),s=[];for(const a of n.inputs)s.push(this.getType(a.type)+" "+a.name);return`${this.getType(n.type)} ${n.name}( ${s.join(", ")} ) {

	${i.vars}

${i.code}
	return ${i.result};

}`}setupPBO(e){const n=e.value;if(n.pbo===void 0){const i=n.array,s=n.count*n.itemSize,{itemSize:o}=n,a=n.array.constructor.name.toLowerCase().includes("int");let l=a?gy:h_;o===2?l=a?yy:kc:o===3?l=a?zye:u_:o===4&&(l=a?vy:Tr);const c={Float32Array:Nr,Uint8Array:gr,Uint16Array:qa,Uint32Array:In,Int8Array:Jf,Int16Array:ed,Int32Array:Si,Uint8ClampedArray:gr},u=Math.pow(2,Math.ceil(Math.log2(Math.sqrt(s/o))));let h=Math.ceil(s/o/u);u*h*o<s&&h++;const f=u*h*o,d=new i.constructor(f);d.set(i,0),n.array=d;const p=new Gve(n.array,u,h,l,c[n.array.constructor.name]||Nr);p.needsUpdate=!0,p.isPBOTexture=!0;const m=new Ty(p,null,null);m.setPrecision("high"),n.pboNode=m,n.pbo=m.value,this.getUniformFromNode(n.pboNode,"texture",this.shaderStage,this.context.label)}}getPropertyName(e,n=this.shaderStage){return e.isNodeUniform&&e.node.isTextureNode!==!0&&e.node.isBufferNode!==!0?n.charAt(0)+"_"+e.name:super.getPropertyName(e,n)}generatePBO(e){const{node:n,indexNode:i}=e,s=n.value;if(this.renderer.backend.has(s)){const h=this.renderer.backend.get(s);h.pbo=s.pbo}const o=this.getUniformFromNode(s.pboNode,"texture",this.shaderStage,this.context.label),a=this.getPropertyName(o);this.increaseUsage(i);const l=i.build(this,"uint"),c=this.getDataFromNode(e);let u=c.propertyName;if(u===void 0){const h=this.getVarFromNode(e);u=this.getPropertyName(h);const f=this.getDataFromNode(n);let d=f.propertySizeName;d===void 0&&(d=u+"Size",this.getVarFromNode(n,d,"uint"),this.addLineFlowCode(`${d} = uint( textureSize( ${a}, 0 ).x )`,e),f.propertySizeName=d);const{itemSize:p}=s,m="."+Sy.join("").slice(0,p),g=`ivec2(${l} % ${d}, ${l} / ${d})`,v=this.generateTextureLoad(null,a,g,null,"0");let y="vec4";s.pbo.type===In?y="uvec4":s.pbo.type===Si&&(y="ivec4"),this.addLineFlowCode(`${u} = ${y}(${v})${m}`,e),c.propertyName=u}return u}generateTextureLoad(e,n,i,s,o="0"){return s?`texelFetch( ${n}, ivec3( ${i}, ${s} ), ${o} )`:`texelFetch( ${n}, ${i}, ${o} )`}generateTexture(e,n,i,s){return e.isDepthTexture?(s&&(i=`vec4( ${i}, ${s} )`),`texture( ${n}, ${i} ).x`):(s&&(i=`vec3( ${i}, ${s} )`),`texture( ${n}, ${i} )`)}generateTextureLevel(e,n,i,s){return`textureLod( ${n}, ${i}, ${s} )`}generateTextureBias(e,n,i,s){return`texture( ${n}, ${i}, ${s} )`}generateTextureGrad(e,n,i,s){return`textureGrad( ${n}, ${i}, ${s[0]}, ${s[1]} )`}generateTextureCompare(e,n,i,s,o,a=this.shaderStage){if(a==="fragment")return o?`texture( ${n}, vec4( ${i}, ${o}, ${s} ) )`:`texture( ${n}, vec3( ${i}, ${s} ) )`;console.error(`WebGPURenderer: THREE.DepthTexture.compareFunction() does not support ${a} shader.`)}getVars(e){const n=[],i=this.vars[e];if(i!==void 0)for(const s of i)n.push(`${this.getVar(s.type,s.name,s.count)};`);return n.join(`
	`)}getUniforms(e){const n=this.uniforms[e],i=[],s={};for(const a of n){let l=null,c=!1;if(a.type==="texture"||a.type==="texture3D"){const h=a.node.value;let f="";(h.isDataTexture===!0||h.isData3DTexture===!0)&&(h.type===In?f="u":h.type===Si&&(f="i")),a.type==="texture3D"&&h.isTextureArray===!1?l=`${f}sampler3D ${a.name};`:h.compareFunction?h.isDepthArrayTexture===!0?l=`sampler2DArrayShadow ${a.name};`:l=`sampler2DShadow ${a.name};`:h.isDataArrayTexture===!0||h.isCompressedArrayTexture===!0||h.isTextureArray===!0?l=`${f}sampler2DArray ${a.name};`:l=`${f}sampler2D ${a.name};`}else if(a.type==="cubeTexture")l=`samplerCube ${a.name};`;else if(a.type==="buffer"){const h=a.node,f=this.getType(h.bufferType),d=h.bufferCount,p=d>0?d:"";l=`${h.name} {
	${f} ${a.name}[${p}];
};
`}else l=`${this.getVectorType(a.type)} ${this.getPropertyName(a,e)};`,c=!0;const u=a.node.precision;if(u!==null&&(l=mFe[u]+" "+l),c){l="	"+l;const h=a.groupNode.name;(s[h]||(s[h]=[])).push(l)}else l="uniform "+l,i.push(l)}let o="";for(const a in s){const l=s[a];o+=this._getGLSLUniformStruct(e+"_"+a,l.join(`
`))+`
`}return o+=i.join(`
`),o}getTypeFromAttribute(e){let n=super.getTypeFromAttribute(e);if(/^[iu]/.test(n)&&e.gpuType!==Si){let i=e;e.isInterleavedBufferAttribute&&(i=e.data);const s=i.array;s instanceof Uint32Array||s instanceof Int32Array||(n=n.slice(1))}return n}getAttributes(e){let n="";if(e==="vertex"||e==="compute"){const i=this.getAttributesArray();let s=0;for(const o of i)n+=`layout( location = ${s++} ) in ${o.type} ${o.name};
`}return n}getStructMembers(e){const n=[];for(const i of e.members)n.push(`	${i.type} ${i.name};`);return n.join(`
`)}getStructs(e){const n=[],i=this.structs[e],s=[];for(const o of i)if(o.output)for(const a of o.members)s.push(`layout( location = ${a.index} ) out ${a.type} ${a.name};`);else{let a="struct "+o.name+` {
`;a+=this.getStructMembers(o),a+=`
};
`,n.push(a)}return s.length===0&&s.push("layout( location = 0 ) out vec4 fragColor;"),`
`+s.join(`
`)+`

`+n.join(`
`)}getVaryings(e){let n="";const i=this.varyings;if(e==="vertex"||e==="compute")for(const s of i){e==="compute"&&(s.needsInterpolation=!0);const o=this.getType(s.type);if(s.needsInterpolation)if(s.interpolationType){const a=G5[s.interpolationType]||s.interpolationType,l=H5[s.interpolationSampling]||"";n+=`${a} ${l} out ${o} ${s.name};
`}else{const a=o.includes("int")||o.includes("uv")||o.includes("iv")?"flat ":"";n+=`${a}out ${o} ${s.name};
`}else n+=`${o} ${s.name};
`}else if(e==="fragment"){for(const s of i)if(s.needsInterpolation){const o=this.getType(s.type);if(s.interpolationType){const a=G5[s.interpolationType]||s.interpolationType,l=H5[s.interpolationSampling]||"";n+=`${a} ${l} in ${o} ${s.name};
`}else{const a=o.includes("int")||o.includes("uv")||o.includes("iv")?"flat ":"";n+=`${a}in ${o} ${s.name};
`}}}for(const s of this.builtins[e])n+=`${s};
`;return n}getVertexIndex(){return"uint( gl_VertexID )"}getInstanceIndex(){return"uint( gl_InstanceID )"}getInvocationLocalIndex(){return`uint( gl_InstanceID ) % ${this.object.workgroupSize.reduce((i,s)=>i*s,1)}u`}getDrawIndex(){return this.renderer.backend.extensions.has("WEBGL_multi_draw")?"uint( gl_DrawID )":null}getFrontFacing(){return"gl_FrontFacing"}getFragCoord(){return"gl_FragCoord.xy"}getFragDepth(){return"gl_FragDepth"}enableExtension(e,n,i=this.shaderStage){const s=this.extensions[i]||(this.extensions[i]=new Map);s.has(e)===!1&&s.set(e,{name:e,behavior:n})}getExtensions(e){const n=[];if(e==="vertex"){const s=this.renderer.backend.extensions;this.object.isBatchedMesh&&s.has("WEBGL_multi_draw")&&this.enableExtension("GL_ANGLE_multi_draw","require",e)}const i=this.extensions[e];if(i!==void 0)for(const{name:s,behavior:o}of i.values())n.push(`#extension ${s} : ${o}`);return n.join(`
`)}getClipDistance(){return"gl_ClipDistance"}isAvailable(e){let n=V5[e];if(n===void 0){let i;switch(n=!1,e){case"float32Filterable":i="OES_texture_float_linear";break;case"clipDistance":i="WEBGL_clip_cull_distance";break}if(i!==void 0){const s=this.renderer.backend.extensions;s.has(i)&&(s.get(i),n=!0)}V5[e]=n}return n}isFlipY(){return!0}enableHardwareClipping(e){this.enableExtension("GL_ANGLE_clip_cull_distance","require"),this.builtins.vertex.push(`out float gl_ClipDistance[ ${e} ]`)}enableMultiview(){this.enableExtension("GL_OVR_multiview2","require","fragment"),this.enableExtension("GL_OVR_multiview2","require","vertex"),this.builtins.vertex.push("layout(num_views = 2) in")}registerTransform(e,n){this.transforms.push({varyingName:e,attributeNode:n})}getTransforms(){const e=this.transforms;let n="";for(let i=0;i<e.length;i++){const s=e[i],o=this.getPropertyName(s.attributeNode);o&&(n+=`${s.varyingName} = ${o};
	`)}return n}_getGLSLUniformStruct(e,n){return`
layout( std140 ) uniform ${e} {
${n}
};`}_getGLSLVertexCode(e){return`#version 300 es

${this.getSignature()}

// extensions
${e.extensions}

// precision
${W5}

// uniforms
${e.uniforms}

// varyings
${e.varyings}

// attributes
${e.attributes}

// codes
${e.codes}

void main() {

	// vars
	${e.vars}

	// transforms
	${e.transforms}

	// flow
	${e.flow}

	gl_PointSize = 1.0;

}
`}_getGLSLFragmentCode(e){return`#version 300 es

${this.getSignature()}

// extensions
${e.extensions}

// precision
${W5}

// uniforms
${e.uniforms}

// varyings
${e.varyings}

// codes
${e.codes}

// structs
${e.structs}

void main() {

	// vars
	${e.vars}

	// flow
	${e.flow}

}
`}buildCode(){const e=this.material!==null?{fragment:{},vertex:{}}:{compute:{}};this.sortBindingGroups();for(const n in e){let i=`// code

`;i+=this.flowCode[n];const s=this.flowNodes[n],o=s[s.length-1];for(const l of s){const c=this.getFlowData(l),u=l.name;u&&(i.length>0&&(i+=`
`),i+=`	// flow -> ${u}
	`),i+=`${c.code}
	`,l===o&&n!=="compute"&&(i+=`// result
	`,n==="vertex"?(i+="gl_Position = ",i+=`${c.result};`):n==="fragment"&&(l.outputNode.isOutputStructNode||(i+="fragColor = ",i+=`${c.result};`)))}const a=e[n];a.extensions=this.getExtensions(n),a.uniforms=this.getUniforms(n),a.attributes=this.getAttributes(n),a.varyings=this.getVaryings(n),a.vars=this.getVars(n),a.structs=this.getStructs(n),a.codes=this.getCodes(n),a.transforms=this.getTransforms(n),a.flow=i}this.material!==null?(this.vertexShader=this._getGLSLVertexCode(e.vertex),this.fragmentShader=this._getGLSLFragmentCode(e.fragment)):this.computeShader=this._getGLSLVertexCode(e.compute)}getUniformFromNode(e,n,i,s=null){const o=super.getUniformFromNode(e,n,i,s),a=this.getDataFromNode(e,i,this.globalCache);let l=a.uniformGPU;if(l===void 0){const c=e.groupNode,u=c.name,h=this.getBindGroupArray(u,i);if(n==="texture")l=new AA(o.name,o.node,c),h.push(l);else if(n==="cubeTexture")l=new bee(o.name,o.node,c),h.push(l);else if(n==="texture3D")l=new _ee(o.name,o.node,c),h.push(l);else if(n==="buffer"){e.name=`NodeBuffer_${e.id}`,o.name=`buffer${e.id}`;const f=new vee(e,c);f.name=e.name,h.push(f),l=f}else{const f=this.uniformGroups[i]||(this.uniformGroups[i]={});let d=f[u];d===void 0&&(d=new xee(i+"_"+u,c),f[u]=d,h.push(d)),l=this.getNodeUniform(o,n),d.addUniform(l)}a.uniformGPU=l}return o}}let AN=null,Pp=null;class wee{constructor(e={}){this.parameters=Object.assign({},e),this.data=new WeakMap,this.renderer=null,this.domElement=null,this.timestampQueryPool={render:null,compute:null},this.trackTimestamp=e.trackTimestamp===!0}async init(e){this.renderer=e}get coordinateSystem(){}beginRender(){}finishRender(){}beginCompute(){}finishCompute(){}draw(){}compute(){}createProgram(){}destroyProgram(){}createBindings(){}updateBindings(){}updateBinding(){}createRenderPipeline(){}createComputePipeline(){}needsRenderUpdate(){}getRenderCacheKey(){}createNodeBuilder(){}createSampler(){}destroySampler(){}createDefaultTexture(){}createTexture(){}updateTexture(){}generateMipmaps(){}destroyTexture(){}async copyTextureToBuffer(){}copyTextureToTexture(){}copyFramebufferToTexture(){}createAttribute(){}createIndexAttribute(){}createStorageAttribute(){}updateAttribute(){}destroyAttribute(){}getContext(){}updateSize(){}updateViewport(){}isOccluded(){}async resolveTimestampsAsync(e="render"){if(!this.trackTimestamp){Ja("WebGPURenderer: Timestamp tracking is disabled.");return}const n=this.timestampQueryPool[e];if(!n){Ja(`WebGPURenderer: No timestamp query pool for type '${e}' found.`);return}const i=await n.resolveQueriesAsync();return this.renderer.info[e].timestamp=i,i}async waitForGPU(){}async getArrayBufferAsync(){}async hasFeatureAsync(){}hasFeature(){}getMaxAnisotropy(){}getDrawingBufferSize(){return AN=AN||new Fe,this.renderer.getDrawingBufferSize(AN)}setScissorTest(){}getClearColor(){const e=this.renderer;return Pp=Pp||new K3,e.getClearColor(Pp),Pp.getRGB(Pp),Pp}getDomElement(){let e=this.domElement;return e===null&&(e=this.parameters.canvas!==void 0?this.parameters.canvas:wY(),"setAttribute"in e&&e.setAttribute("data-engine",`three.js r${my} webgpu`),this.domElement=e),e}set(e,n){this.data.set(e,n)}get(e){let n=this.data.get(e);return n===void 0&&(n={},this.data.set(e,n)),n}has(e){return this.data.has(e)}delete(e){this.data.delete(e)}dispose(){}}let yFe=0;class vFe{constructor(e,n){this.buffers=[e.bufferGPU,n],this.type=e.type,this.bufferType=e.bufferType,this.pbo=e.pbo,this.byteLength=e.byteLength,this.bytesPerElement=e.BYTES_PER_ELEMENT,this.version=e.version,this.isInteger=e.isInteger,this.activeBufferIndex=0,this.baseId=e.id}get id(){return`${this.baseId}|${this.activeBufferIndex}`}get bufferGPU(){return this.buffers[this.activeBufferIndex]}get transformBuffer(){return this.buffers[this.activeBufferIndex^1]}switchBuffers(){this.activeBufferIndex^=1}}class xFe{constructor(e){this.backend=e}createAttribute(e,n){const i=this.backend,{gl:s}=i,o=e.array,a=e.usage||s.STATIC_DRAW,l=e.isInterleavedBufferAttribute?e.data:e,c=i.get(l);let u=c.bufferGPU;u===void 0&&(u=this._createBuffer(s,n,o,a),c.bufferGPU=u,c.bufferType=n,c.version=l.version);let h;if(o instanceof Float32Array)h=s.FLOAT;else if(o instanceof Uint16Array)e.isFloat16BufferAttribute?h=s.HALF_FLOAT:h=s.UNSIGNED_SHORT;else if(o instanceof Int16Array)h=s.SHORT;else if(o instanceof Uint32Array)h=s.UNSIGNED_INT;else if(o instanceof Int32Array)h=s.INT;else if(o instanceof Int8Array)h=s.BYTE;else if(o instanceof Uint8Array)h=s.UNSIGNED_BYTE;else if(o instanceof Uint8ClampedArray)h=s.UNSIGNED_BYTE;else throw new Error("THREE.WebGLBackend: Unsupported buffer data format: "+o);let f={bufferGPU:u,bufferType:n,type:h,byteLength:o.byteLength,bytesPerElement:o.BYTES_PER_ELEMENT,version:e.version,pbo:e.pbo,isInteger:h===s.INT||h===s.UNSIGNED_INT||e.gpuType===Si,id:yFe++};if(e.isStorageBufferAttribute||e.isStorageInstancedBufferAttribute){const d=this._createBuffer(s,n,o,a);f=new vFe(f,d)}i.set(e,f)}updateAttribute(e){const n=this.backend,{gl:i}=n,s=e.array,o=e.isInterleavedBufferAttribute?e.data:e,a=n.get(o),l=a.bufferType,c=e.isInterleavedBufferAttribute?e.data.updateRanges:e.updateRanges;if(i.bindBuffer(l,a.bufferGPU),c.length===0)i.bufferSubData(l,0,s);else{for(let u=0,h=c.length;u<h;u++){const f=c[u];i.bufferSubData(l,f.start*s.BYTES_PER_ELEMENT,s,f.start,f.count)}o.clearUpdateRanges()}i.bindBuffer(l,null),a.version=o.version}destroyAttribute(e){const n=this.backend,{gl:i}=n;e.isInterleavedBufferAttribute&&n.delete(e.data);const s=n.get(e);i.deleteBuffer(s.bufferGPU),n.delete(e)}async getArrayBufferAsync(e){const n=this.backend,{gl:i}=n,s=e.isInterleavedBufferAttribute?e.data:e,{bufferGPU:o}=n.get(s),a=e.array,l=a.byteLength;i.bindBuffer(i.COPY_READ_BUFFER,o);const c=i.createBuffer();i.bindBuffer(i.COPY_WRITE_BUFFER,c),i.bufferData(i.COPY_WRITE_BUFFER,l,i.STREAM_READ),i.copyBufferSubData(i.COPY_READ_BUFFER,i.COPY_WRITE_BUFFER,0,0,l),await n.utils._clientWaitAsync();const u=new e.array.constructor(a.length);return i.bindBuffer(i.COPY_WRITE_BUFFER,c),i.getBufferSubData(i.COPY_WRITE_BUFFER,0,u),i.deleteBuffer(c),i.bindBuffer(i.COPY_READ_BUFFER,null),i.bindBuffer(i.COPY_WRITE_BUFFER,null),u.buffer}_createBuffer(e,n,i,s){const o=e.createBuffer();return e.bindBuffer(n,o),e.bufferData(n,i,s),e.bindBuffer(n,null),o}}let CN,Fv;class bFe{constructor(e){this.backend=e,this.gl=this.backend.gl,this.enabled={},this.currentFlipSided=null,this.currentCullFace=null,this.currentProgram=null,this.currentBlendingEnabled=!1,this.currentBlending=null,this.currentBlendSrc=null,this.currentBlendDst=null,this.currentBlendSrcAlpha=null,this.currentBlendDstAlpha=null,this.currentPremultipledAlpha=null,this.currentPolygonOffsetFactor=null,this.currentPolygonOffsetUnits=null,this.currentColorMask=null,this.currentDepthFunc=null,this.currentDepthMask=null,this.currentStencilFunc=null,this.currentStencilRef=null,this.currentStencilFuncMask=null,this.currentStencilFail=null,this.currentStencilZFail=null,this.currentStencilZPass=null,this.currentStencilMask=null,this.currentLineWidth=null,this.currentClippingPlanes=0,this.currentVAO=null,this.currentIndex=null,this.currentBoundFramebuffers={},this.currentDrawbuffers=new WeakMap,this.maxTextures=this.gl.getParameter(this.gl.MAX_TEXTURE_IMAGE_UNITS),this.currentTextureSlot=null,this.currentBoundTextures={},this.currentBoundBufferBases={},this._init()}_init(){const e=this.gl;CN={[ss]:e.FUNC_ADD,[lF]:e.FUNC_SUBTRACT,[cF]:e.FUNC_REVERSE_SUBTRACT},Fv={[wc]:e.ZERO,[uF]:e.ONE,[hF]:e.SRC_COLOR,[Nx]:e.SRC_ALPHA,[yF]:e.SRC_ALPHA_SATURATE,[mF]:e.DST_COLOR,[dF]:e.DST_ALPHA,[fF]:e.ONE_MINUS_SRC_COLOR,[Ox]:e.ONE_MINUS_SRC_ALPHA,[gF]:e.ONE_MINUS_DST_COLOR,[pF]:e.ONE_MINUS_DST_ALPHA};const n=e.getParameter(e.SCISSOR_BOX),i=e.getParameter(e.VIEWPORT);this.currentScissor=new Nt().fromArray(n),this.currentViewport=new Nt().fromArray(i),this._tempVec4=new Nt}enable(e){const{enabled:n}=this;n[e]!==!0&&(this.gl.enable(e),n[e]=!0)}disable(e){const{enabled:n}=this;n[e]!==!1&&(this.gl.disable(e),n[e]=!1)}setFlipSided(e){if(this.currentFlipSided!==e){const{gl:n}=this;e?n.frontFace(n.CW):n.frontFace(n.CCW),this.currentFlipSided=e}}setCullFace(e){const{gl:n}=this;e!==cY?(this.enable(n.CULL_FACE),e!==this.currentCullFace&&(e===jO?n.cullFace(n.BACK):e===uY?n.cullFace(n.FRONT):n.cullFace(n.FRONT_AND_BACK))):this.disable(n.CULL_FACE),this.currentCullFace=e}setLineWidth(e){const{currentLineWidth:n,gl:i}=this;e!==n&&(i.lineWidth(e),this.currentLineWidth=e)}setBlending(e,n,i,s,o,a,l,c){const{gl:u}=this;if(e===ro){this.currentBlendingEnabled===!0&&(this.disable(u.BLEND),this.currentBlendingEnabled=!1);return}if(this.currentBlendingEnabled===!1&&(this.enable(u.BLEND),this.currentBlendingEnabled=!0),e!==Pm){if(e!==this.currentBlending||c!==this.currentPremultipledAlpha){if((this.currentBlendEquation!==ss||this.currentBlendEquationAlpha!==ss)&&(u.blendEquation(u.FUNC_ADD),this.currentBlendEquation=ss,this.currentBlendEquationAlpha=ss),c)switch(e){case Ro:u.blendFuncSeparate(u.ONE,u.ONE_MINUS_SRC_ALPHA,u.ONE,u.ONE_MINUS_SRC_ALPHA);break;case Jm:u.blendFunc(u.ONE,u.ONE);break;case eg:u.blendFuncSeparate(u.ZERO,u.ONE_MINUS_SRC_COLOR,u.ZERO,u.ONE);break;case tg:u.blendFuncSeparate(u.ZERO,u.SRC_COLOR,u.ZERO,u.SRC_ALPHA);break;default:console.error("THREE.WebGLState: Invalid blending: ",e);break}else switch(e){case Ro:u.blendFuncSeparate(u.SRC_ALPHA,u.ONE_MINUS_SRC_ALPHA,u.ONE,u.ONE_MINUS_SRC_ALPHA);break;case Jm:u.blendFunc(u.SRC_ALPHA,u.ONE);break;case eg:u.blendFuncSeparate(u.ZERO,u.ONE_MINUS_SRC_COLOR,u.ZERO,u.ONE);break;case tg:u.blendFunc(u.ZERO,u.SRC_COLOR);break;default:console.error("THREE.WebGLState: Invalid blending: ",e);break}this.currentBlendSrc=null,this.currentBlendDst=null,this.currentBlendSrcAlpha=null,this.currentBlendDstAlpha=null,this.currentBlending=e,this.currentPremultipledAlpha=c}return}o=o||n,a=a||i,l=l||s,(n!==this.currentBlendEquation||o!==this.currentBlendEquationAlpha)&&(u.blendEquationSeparate(CN[n],CN[o]),this.currentBlendEquation=n,this.currentBlendEquationAlpha=o),(i!==this.currentBlendSrc||s!==this.currentBlendDst||a!==this.currentBlendSrcAlpha||l!==this.currentBlendDstAlpha)&&(u.blendFuncSeparate(Fv[i],Fv[s],Fv[a],Fv[l]),this.currentBlendSrc=i,this.currentBlendDst=s,this.currentBlendSrcAlpha=a,this.currentBlendDstAlpha=l),this.currentBlending=e,this.currentPremultipledAlpha=!1}setColorMask(e){this.currentColorMask!==e&&(this.gl.colorMask(e,e,e,e),this.currentColorMask=e)}setDepthTest(e){const{gl:n}=this;e?this.enable(n.DEPTH_TEST):this.disable(n.DEPTH_TEST)}setDepthMask(e){this.currentDepthMask!==e&&(this.gl.depthMask(e),this.currentDepthMask=e)}setDepthFunc(e){if(this.currentDepthFunc!==e){const{gl:n}=this;switch(e){case Dx:n.depthFunc(n.NEVER);break;case kx:n.depthFunc(n.ALWAYS);break;case Ix:n.depthFunc(n.LESS);break;case Ch:n.depthFunc(n.LEQUAL);break;case Lx:n.depthFunc(n.EQUAL);break;case Fx:n.depthFunc(n.GEQUAL);break;case Bx:n.depthFunc(n.GREATER);break;case Ux:n.depthFunc(n.NOTEQUAL);break;default:n.depthFunc(n.LEQUAL)}this.currentDepthFunc=e}}scissor(e,n,i,s){const o=this._tempVec4.set(e,n,i,s);if(this.currentScissor.equals(o)===!1){const{gl:a}=this;a.scissor(o.x,o.y,o.z,o.w),this.currentScissor.copy(o)}}viewport(e,n,i,s){const o=this._tempVec4.set(e,n,i,s);if(this.currentViewport.equals(o)===!1){const{gl:a}=this;a.viewport(o.x,o.y,o.z,o.w),this.currentViewport.copy(o)}}setScissorTest(e){const n=this.gl;e?n.enable(n.SCISSOR_TEST):n.disable(n.SCISSOR_TEST)}setStencilTest(e){const{gl:n}=this;e?this.enable(n.STENCIL_TEST):this.disable(n.STENCIL_TEST)}setStencilMask(e){this.currentStencilMask!==e&&(this.gl.stencilMask(e),this.currentStencilMask=e)}setStencilFunc(e,n,i){(this.currentStencilFunc!==e||this.currentStencilRef!==n||this.currentStencilFuncMask!==i)&&(this.gl.stencilFunc(e,n,i),this.currentStencilFunc=e,this.currentStencilRef=n,this.currentStencilFuncMask=i)}setStencilOp(e,n,i){(this.currentStencilFail!==e||this.currentStencilZFail!==n||this.currentStencilZPass!==i)&&(this.gl.stencilOp(e,n,i),this.currentStencilFail=e,this.currentStencilZFail=n,this.currentStencilZPass=i)}setMaterial(e,n,i){const{gl:s}=this;e.side===Es?this.disable(s.CULL_FACE):this.enable(s.CULL_FACE);let o=e.side===Fn;n&&(o=!o),this.setFlipSided(o),e.blending===Ro&&e.transparent===!1?this.setBlending(ro):this.setBlending(e.blending,e.blendEquation,e.blendSrc,e.blendDst,e.blendEquationAlpha,e.blendSrcAlpha,e.blendDstAlpha,e.premultipliedAlpha),this.setDepthFunc(e.depthFunc),this.setDepthTest(e.depthTest),this.setDepthMask(e.depthWrite),this.setColorMask(e.colorWrite);const a=e.stencilWrite;if(this.setStencilTest(a),a&&(this.setStencilMask(e.stencilWriteMask),this.setStencilFunc(e.stencilFunc,e.stencilRef,e.stencilFuncMask),this.setStencilOp(e.stencilFail,e.stencilZFail,e.stencilZPass)),this.setPolygonOffset(e.polygonOffset,e.polygonOffsetFactor,e.polygonOffsetUnits),e.alphaToCoverage===!0&&this.backend.renderer.samples>1?this.enable(s.SAMPLE_ALPHA_TO_COVERAGE):this.disable(s.SAMPLE_ALPHA_TO_COVERAGE),i>0&&this.currentClippingPlanes!==i)for(let c=0;c<8;c++)c<i?this.enable(12288+c):this.disable(12288+c)}setPolygonOffset(e,n,i){const{gl:s}=this;e?(this.enable(s.POLYGON_OFFSET_FILL),(this.currentPolygonOffsetFactor!==n||this.currentPolygonOffsetUnits!==i)&&(s.polygonOffset(n,i),this.currentPolygonOffsetFactor=n,this.currentPolygonOffsetUnits=i)):this.disable(s.POLYGON_OFFSET_FILL)}useProgram(e){return this.currentProgram!==e?(this.gl.useProgram(e),this.currentProgram=e,!0):!1}setVertexState(e,n=null){const i=this.gl;return this.currentVAO!==e||this.currentIndex!==n?(i.bindVertexArray(e),n!==null&&i.bindBuffer(i.ELEMENT_ARRAY_BUFFER,n),this.currentVAO=e,this.currentIndex=n,!0):!1}resetVertexState(){const e=this.gl;e.bindVertexArray(null),e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,null),this.currentVAO=null,this.currentIndex=null}bindFramebuffer(e,n){const{gl:i,currentBoundFramebuffers:s}=this;return s[e]!==n?(i.bindFramebuffer(e,n),s[e]=n,e===i.DRAW_FRAMEBUFFER&&(s[i.FRAMEBUFFER]=n),e===i.FRAMEBUFFER&&(s[i.DRAW_FRAMEBUFFER]=n),!0):!1}drawBuffers(e,n){const{gl:i}=this;let s=[],o=!1;if(e.textures!==null){s=this.currentDrawbuffers.get(n),s===void 0&&(s=[],this.currentDrawbuffers.set(n,s));const a=e.textures;if(s.length!==a.length||s[0]!==i.COLOR_ATTACHMENT0){for(let l=0,c=a.length;l<c;l++)s[l]=i.COLOR_ATTACHMENT0+l;s.length=a.length,o=!0}}else s[0]!==i.BACK&&(s[0]=i.BACK,o=!0);o&&i.drawBuffers(s)}activeTexture(e){const{gl:n,currentTextureSlot:i,maxTextures:s}=this;e===void 0&&(e=n.TEXTURE0+s-1),i!==e&&(n.activeTexture(e),this.currentTextureSlot=e)}bindTexture(e,n,i){const{gl:s,currentTextureSlot:o,currentBoundTextures:a,maxTextures:l}=this;i===void 0&&(o===null?i=s.TEXTURE0+l-1:i=o);let c=a[i];c===void 0&&(c={type:void 0,texture:void 0},a[i]=c),(c.type!==e||c.texture!==n)&&(o!==i&&(s.activeTexture(i),this.currentTextureSlot=i),s.bindTexture(e,n),c.type=e,c.texture=n)}bindBufferBase(e,n,i){const{gl:s}=this,o=`${e}-${n}`;return this.currentBoundBufferBases[o]!==i?(s.bindBufferBase(e,n,i),this.currentBoundBufferBases[o]=i,!0):!1}unbindTexture(){const{gl:e,currentTextureSlot:n,currentBoundTextures:i}=this,s=i[n];s!==void 0&&s.type!==void 0&&(e.bindTexture(s.type,null),s.type=void 0,s.texture=void 0)}}class _Fe{constructor(e){this.backend=e,this.gl=this.backend.gl,this.extensions=e.extensions}convert(e,n=Eo){const{gl:i,extensions:s}=this;let o;if(e===gr)return i.UNSIGNED_BYTE;if(e===GM)return i.UNSIGNED_SHORT_4_4_4_4;if(e===HM)return i.UNSIGNED_SHORT_5_5_5_1;if(e===WM)return i.UNSIGNED_INT_5_9_9_9_REV;if(e===Jf)return i.BYTE;if(e===ed)return i.SHORT;if(e===qa)return i.UNSIGNED_SHORT;if(e===Si)return i.INT;if(e===In)return i.UNSIGNED_INT;if(e===Nr)return i.FLOAT;if(e===Ei)return i.HALF_FLOAT;if(e===bF)return i.ALPHA;if(e===u_)return i.RGB;if(e===Tr)return i.RGBA;if(e===Oo)return i.DEPTH_COMPONENT;if(e===Do)return i.DEPTH_STENCIL;if(e===h_)return i.RED;if(e===gy)return i.RED_INTEGER;if(e===kc)return i.RG;if(e===yy)return i.RG_INTEGER;if(e===vy)return i.RGBA_INTEGER;if(e===td||e===yh||e===vh||e===xh)if(n===vt)if(o=s.get("WEBGL_compressed_texture_s3tc_srgb"),o!==null){if(e===td)return o.COMPRESSED_SRGB_S3TC_DXT1_EXT;if(e===yh)return o.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT;if(e===vh)return o.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT;if(e===xh)return o.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT}else return null;else if(o=s.get("WEBGL_compressed_texture_s3tc"),o!==null){if(e===td)return o.COMPRESSED_RGB_S3TC_DXT1_EXT;if(e===yh)return o.COMPRESSED_RGBA_S3TC_DXT1_EXT;if(e===vh)return o.COMPRESSED_RGBA_S3TC_DXT3_EXT;if(e===xh)return o.COMPRESSED_RGBA_S3TC_DXT5_EXT}else return null;if(e===zx||e===$x||e===jx||e===Vx)if(o=s.get("WEBGL_compressed_texture_pvrtc"),o!==null){if(e===zx)return o.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;if(e===$x)return o.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;if(e===jx)return o.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;if(e===Vx)return o.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG}else return null;if(e===Gx||e===ng||e===rg)if(o=s.get("WEBGL_compressed_texture_etc"),o!==null){if(e===Gx||e===ng)return n===vt?o.COMPRESSED_SRGB8_ETC2:o.COMPRESSED_RGB8_ETC2;if(e===rg)return n===vt?o.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC:o.COMPRESSED_RGBA8_ETC2_EAC}else return null;if(e===ig||e===sg||e===og||e===ag||e===lg||e===cg||e===ug||e===hg||e===fg||e===dg||e===pg||e===mg||e===gg||e===yg)if(o=s.get("WEBGL_compressed_texture_astc"),o!==null){if(e===ig)return n===vt?o.COMPRESSED_SRGB8_ALPHA8_ASTC_4x4_KHR:o.COMPRESSED_RGBA_ASTC_4x4_KHR;if(e===sg)return n===vt?o.COMPRESSED_SRGB8_ALPHA8_ASTC_5x4_KHR:o.COMPRESSED_RGBA_ASTC_5x4_KHR;if(e===og)return n===vt?o.COMPRESSED_SRGB8_ALPHA8_ASTC_5x5_KHR:o.COMPRESSED_RGBA_ASTC_5x5_KHR;if(e===ag)return n===vt?o.COMPRESSED_SRGB8_ALPHA8_ASTC_6x5_KHR:o.COMPRESSED_RGBA_ASTC_6x5_KHR;if(e===lg)return n===vt?o.COMPRESSED_SRGB8_ALPHA8_ASTC_6x6_KHR:o.COMPRESSED_RGBA_ASTC_6x6_KHR;if(e===cg)return n===vt?o.COMPRESSED_SRGB8_ALPHA8_ASTC_8x5_KHR:o.COMPRESSED_RGBA_ASTC_8x5_KHR;if(e===ug)return n===vt?o.COMPRESSED_SRGB8_ALPHA8_ASTC_8x6_KHR:o.COMPRESSED_RGBA_ASTC_8x6_KHR;if(e===hg)return n===vt?o.COMPRESSED_SRGB8_ALPHA8_ASTC_8x8_KHR:o.COMPRESSED_RGBA_ASTC_8x8_KHR;if(e===fg)return n===vt?o.COMPRESSED_SRGB8_ALPHA8_ASTC_10x5_KHR:o.COMPRESSED_RGBA_ASTC_10x5_KHR;if(e===dg)return n===vt?o.COMPRESSED_SRGB8_ALPHA8_ASTC_10x6_KHR:o.COMPRESSED_RGBA_ASTC_10x6_KHR;if(e===pg)return n===vt?o.COMPRESSED_SRGB8_ALPHA8_ASTC_10x8_KHR:o.COMPRESSED_RGBA_ASTC_10x8_KHR;if(e===mg)return n===vt?o.COMPRESSED_SRGB8_ALPHA8_ASTC_10x10_KHR:o.COMPRESSED_RGBA_ASTC_10x10_KHR;if(e===gg)return n===vt?o.COMPRESSED_SRGB8_ALPHA8_ASTC_12x10_KHR:o.COMPRESSED_RGBA_ASTC_12x10_KHR;if(e===yg)return n===vt?o.COMPRESSED_SRGB8_ALPHA8_ASTC_12x12_KHR:o.COMPRESSED_RGBA_ASTC_12x12_KHR}else return null;if(e===nd)if(o=s.get("EXT_texture_compression_bptc"),o!==null){if(e===nd)return n===vt?o.COMPRESSED_SRGB_ALPHA_BPTC_UNORM_EXT:o.COMPRESSED_RGBA_BPTC_UNORM_EXT}else return null;if(e===_F||e===Hx||e===Wx||e===qx)if(o=s.get("EXT_texture_compression_rgtc"),o!==null){if(e===nd)return o.COMPRESSED_RED_RGTC1_EXT;if(e===Hx)return o.COMPRESSED_SIGNED_RED_RGTC1_EXT;if(e===Wx)return o.COMPRESSED_RED_GREEN_RGTC2_EXT;if(e===qx)return o.COMPRESSED_SIGNED_RED_GREEN_RGTC2_EXT}else return null;return e===No?i.UNSIGNED_INT_24_8:i[e]!==void 0?i[e]:null}_clientWaitAsync(){const{gl:e}=this,n=e.fenceSync(e.SYNC_GPU_COMMANDS_COMPLETE,0);return e.flush(),new Promise((i,s)=>{function o(){const a=e.clientWaitSync(n,e.SYNC_FLUSH_COMMANDS_BIT,0);if(a===e.WAIT_FAILED){e.deleteSync(n),s();return}if(a===e.TIMEOUT_EXPIRED){requestAnimationFrame(o);return}e.deleteSync(n),i()}o()})}}let q5=!1,US,PN,X5;class wFe{constructor(e){this.backend=e,this.gl=e.gl,this.extensions=e.extensions,this.defaultTextures={},q5===!1&&(this._init(),q5=!0)}_init(){const e=this.gl;US={[gd]:e.REPEAT,[Tl]:e.CLAMP_TO_EDGE,[yd]:e.MIRRORED_REPEAT},PN={[jn]:e.NEAREST,[xF]:e.NEAREST_MIPMAP_NEAREST,[Dc]:e.NEAREST_MIPMAP_LINEAR,[li]:e.LINEAR,[Rm]:e.LINEAR_MIPMAP_NEAREST,[Ks]:e.LINEAR_MIPMAP_LINEAR},X5={[wF]:e.NEVER,[AF]:e.ALWAYS,[qM]:e.LESS,[XM]:e.LEQUAL,[SF]:e.EQUAL,[MF]:e.GEQUAL,[TF]:e.GREATER,[EF]:e.NOTEQUAL}}getGLTextureType(e){const{gl:n}=this;let i;return e.isCubeTexture===!0?i=n.TEXTURE_CUBE_MAP:e.isDepthArrayTexture===!0||e.isDataArrayTexture===!0||e.isCompressedArrayTexture===!0||e.isTextureArray===!0?i=n.TEXTURE_2D_ARRAY:e.isData3DTexture===!0?i=n.TEXTURE_3D:i=n.TEXTURE_2D,i}getInternalFormat(e,n,i,s,o=!1){const{gl:a,extensions:l}=this;if(e!==null){if(a[e]!==void 0)return a[e];console.warn("THREE.WebGLRenderer: Attempt to use non-existing WebGL internal format '"+e+"'")}let c=n;return n===a.RED&&(i===a.FLOAT&&(c=a.R32F),i===a.HALF_FLOAT&&(c=a.R16F),i===a.UNSIGNED_BYTE&&(c=a.R8),i===a.UNSIGNED_SHORT&&(c=a.R16),i===a.UNSIGNED_INT&&(c=a.R32UI),i===a.BYTE&&(c=a.R8I),i===a.SHORT&&(c=a.R16I),i===a.INT&&(c=a.R32I)),n===a.RED_INTEGER&&(i===a.UNSIGNED_BYTE&&(c=a.R8UI),i===a.UNSIGNED_SHORT&&(c=a.R16UI),i===a.UNSIGNED_INT&&(c=a.R32UI),i===a.BYTE&&(c=a.R8I),i===a.SHORT&&(c=a.R16I),i===a.INT&&(c=a.R32I)),n===a.RG&&(i===a.FLOAT&&(c=a.RG32F),i===a.HALF_FLOAT&&(c=a.RG16F),i===a.UNSIGNED_BYTE&&(c=a.RG8),i===a.UNSIGNED_SHORT&&(c=a.RG16),i===a.UNSIGNED_INT&&(c=a.RG32UI),i===a.BYTE&&(c=a.RG8I),i===a.SHORT&&(c=a.RG16I),i===a.INT&&(c=a.RG32I)),n===a.RG_INTEGER&&(i===a.UNSIGNED_BYTE&&(c=a.RG8UI),i===a.UNSIGNED_SHORT&&(c=a.RG16UI),i===a.UNSIGNED_INT&&(c=a.RG32UI),i===a.BYTE&&(c=a.RG8I),i===a.SHORT&&(c=a.RG16I),i===a.INT&&(c=a.RG32I)),n===a.RGB&&(i===a.FLOAT&&(c=a.RGB32F),i===a.HALF_FLOAT&&(c=a.RGB16F),i===a.UNSIGNED_BYTE&&(c=a.RGB8),i===a.UNSIGNED_SHORT&&(c=a.RGB16),i===a.UNSIGNED_INT&&(c=a.RGB32UI),i===a.BYTE&&(c=a.RGB8I),i===a.SHORT&&(c=a.RGB16I),i===a.INT&&(c=a.RGB32I),i===a.UNSIGNED_BYTE&&(c=s===vt&&o===!1?a.SRGB8:a.RGB8),i===a.UNSIGNED_SHORT_5_6_5&&(c=a.RGB565),i===a.UNSIGNED_SHORT_5_5_5_1&&(c=a.RGB5_A1),i===a.UNSIGNED_SHORT_4_4_4_4&&(c=a.RGB4),i===a.UNSIGNED_INT_5_9_9_9_REV&&(c=a.RGB9_E5)),n===a.RGB_INTEGER&&(i===a.UNSIGNED_BYTE&&(c=a.RGB8UI),i===a.UNSIGNED_SHORT&&(c=a.RGB16UI),i===a.UNSIGNED_INT&&(c=a.RGB32UI),i===a.BYTE&&(c=a.RGB8I),i===a.SHORT&&(c=a.RGB16I),i===a.INT&&(c=a.RGB32I)),n===a.RGBA&&(i===a.FLOAT&&(c=a.RGBA32F),i===a.HALF_FLOAT&&(c=a.RGBA16F),i===a.UNSIGNED_BYTE&&(c=a.RGBA8),i===a.UNSIGNED_SHORT&&(c=a.RGBA16),i===a.UNSIGNED_INT&&(c=a.RGBA32UI),i===a.BYTE&&(c=a.RGBA8I),i===a.SHORT&&(c=a.RGBA16I),i===a.INT&&(c=a.RGBA32I),i===a.UNSIGNED_BYTE&&(c=s===vt&&o===!1?a.SRGB8_ALPHA8:a.RGBA8),i===a.UNSIGNED_SHORT_4_4_4_4&&(c=a.RGBA4),i===a.UNSIGNED_SHORT_5_5_5_1&&(c=a.RGB5_A1)),n===a.RGBA_INTEGER&&(i===a.UNSIGNED_BYTE&&(c=a.RGBA8UI),i===a.UNSIGNED_SHORT&&(c=a.RGBA16UI),i===a.UNSIGNED_INT&&(c=a.RGBA32UI),i===a.BYTE&&(c=a.RGBA8I),i===a.SHORT&&(c=a.RGBA16I),i===a.INT&&(c=a.RGBA32I)),n===a.DEPTH_COMPONENT&&(i===a.UNSIGNED_SHORT&&(c=a.DEPTH_COMPONENT16),i===a.UNSIGNED_INT&&(c=a.DEPTH_COMPONENT24),i===a.FLOAT&&(c=a.DEPTH_COMPONENT32F)),n===a.DEPTH_STENCIL&&i===a.UNSIGNED_INT_24_8&&(c=a.DEPTH24_STENCIL8),(c===a.R16F||c===a.R32F||c===a.RG16F||c===a.RG32F||c===a.RGBA16F||c===a.RGBA32F)&&l.get("EXT_color_buffer_float"),c}setTextureParameters(e,n){const{gl:i,extensions:s,backend:o}=this;i.pixelStorei(i.UNPACK_FLIP_Y_WEBGL,n.flipY),i.pixelStorei(i.UNPACK_PREMULTIPLY_ALPHA_WEBGL,n.premultiplyAlpha),i.pixelStorei(i.UNPACK_ALIGNMENT,n.unpackAlignment),i.pixelStorei(i.UNPACK_COLORSPACE_CONVERSION_WEBGL,i.NONE),i.texParameteri(e,i.TEXTURE_WRAP_S,US[n.wrapS]),i.texParameteri(e,i.TEXTURE_WRAP_T,US[n.wrapT]),(e===i.TEXTURE_3D||e===i.TEXTURE_2D_ARRAY)&&n.isDepthArrayTexture!==!0&&n.isTextureArray===!1&&i.texParameteri(e,i.TEXTURE_WRAP_R,US[n.wrapR]),i.texParameteri(e,i.TEXTURE_MAG_FILTER,PN[n.magFilter]);const a=n.mipmaps!==void 0&&n.mipmaps.length>0,l=n.minFilter===li&&a?Ks:n.minFilter;if(i.texParameteri(e,i.TEXTURE_MIN_FILTER,PN[l]),n.compareFunction&&(i.texParameteri(e,i.TEXTURE_COMPARE_MODE,i.COMPARE_REF_TO_TEXTURE),i.texParameteri(e,i.TEXTURE_COMPARE_FUNC,X5[n.compareFunction])),s.has("EXT_texture_filter_anisotropic")===!0){if(n.magFilter===jn||n.minFilter!==Dc&&n.minFilter!==Ks||n.type===Nr&&s.has("OES_texture_float_linear")===!1)return;if(n.anisotropy>1){const c=s.get("EXT_texture_filter_anisotropic");i.texParameterf(e,c.TEXTURE_MAX_ANISOTROPY_EXT,Math.min(n.anisotropy,o.getMaxAnisotropy()))}}}createDefaultTexture(e){const{gl:n,backend:i,defaultTextures:s}=this,o=this.getGLTextureType(e);let a=s[o];a===void 0&&(a=n.createTexture(),i.state.bindTexture(o,a),n.texParameteri(o,n.TEXTURE_MIN_FILTER,n.NEAREST),n.texParameteri(o,n.TEXTURE_MAG_FILTER,n.NEAREST),s[o]=a),i.set(e,{textureGPU:a,glTextureType:o,isDefault:!0})}createTexture(e,n){const{gl:i,backend:s}=this,{levels:o,width:a,height:l,depth:c}=n,u=s.utils.convert(e.format,e.colorSpace),h=s.utils.convert(e.type),f=this.getInternalFormat(e.internalFormat,u,h,e.colorSpace,e.isVideoTexture),d=i.createTexture(),p=this.getGLTextureType(e);s.state.bindTexture(p,d),this.setTextureParameters(p,e),e.isDepthArrayTexture||e.isDataArrayTexture||e.isCompressedArrayTexture||e.isTextureArray?i.texStorage3D(i.TEXTURE_2D_ARRAY,o,f,a,l,c):e.isData3DTexture?i.texStorage3D(i.TEXTURE_3D,o,f,a,l,c):e.isVideoTexture||i.texStorage2D(p,o,f,a,l),s.set(e,{textureGPU:d,glTextureType:p,glFormat:u,glType:h,glInternalFormat:f})}copyBufferToTexture(e,n){const{gl:i,backend:s}=this,{textureGPU:o,glTextureType:a,glFormat:l,glType:c}=s.get(n),{width:u,height:h}=n.source.data;i.bindBuffer(i.PIXEL_UNPACK_BUFFER,e),s.state.bindTexture(a,o),i.pixelStorei(i.UNPACK_FLIP_Y_WEBGL,!1),i.pixelStorei(i.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!1),i.texSubImage2D(a,0,0,0,u,h,l,c,0),i.bindBuffer(i.PIXEL_UNPACK_BUFFER,null),s.state.unbindTexture()}updateTexture(e,n){const{gl:i}=this,{width:s,height:o}=n,{textureGPU:a,glTextureType:l,glFormat:c,glType:u,glInternalFormat:h}=this.backend.get(e);if(e.isRenderTargetTexture||a===void 0)return;const f=d=>d.isDataTexture?d.image.data:typeof HTMLImageElement<"u"&&d instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&d instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&d instanceof ImageBitmap||d instanceof OffscreenCanvas?d:d.data;if(this.backend.state.bindTexture(l,a),this.setTextureParameters(l,e),e.isCompressedTexture){const d=e.mipmaps,p=n.image;for(let m=0;m<d.length;m++){const g=d[m];e.isCompressedArrayTexture?e.format!==i.RGBA?c!==null?i.compressedTexSubImage3D(i.TEXTURE_2D_ARRAY,m,0,0,0,g.width,g.height,p.depth,c,g.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):i.texSubImage3D(i.TEXTURE_2D_ARRAY,m,0,0,0,g.width,g.height,p.depth,c,u,g.data):c!==null?i.compressedTexSubImage2D(i.TEXTURE_2D,m,0,0,g.width,g.height,c,g.data):console.warn("Unsupported compressed texture format")}}else if(e.isCubeTexture){const d=n.images;for(let p=0;p<6;p++){const m=f(d[p]);i.texSubImage2D(i.TEXTURE_CUBE_MAP_POSITIVE_X+p,0,0,0,s,o,c,u,m)}}else if(e.isDataArrayTexture||e.isDepthArrayTexture){const d=n.image;i.texSubImage3D(i.TEXTURE_2D_ARRAY,0,0,0,0,d.width,d.height,d.depth,c,u,d.data)}else if(e.isData3DTexture){const d=n.image;i.texSubImage3D(i.TEXTURE_3D,0,0,0,0,d.width,d.height,d.depth,c,u,d.data)}else if(e.isVideoTexture)e.update(),i.texImage2D(l,0,h,c,u,n.image);else{const d=f(n.image);i.texSubImage2D(l,0,0,0,s,o,c,u,d)}}generateMipmaps(e){const{gl:n,backend:i}=this,{textureGPU:s,glTextureType:o}=i.get(e);i.state.bindTexture(o,s),n.generateMipmap(o)}deallocateRenderBuffers(e){const{gl:n,backend:i}=this;if(e){const s=i.get(e);if(s.renderBufferStorageSetup=void 0,s.framebuffers){for(const o in s.framebuffers)n.deleteFramebuffer(s.framebuffers[o]);delete s.framebuffers}if(s.depthRenderbuffer&&(n.deleteRenderbuffer(s.depthRenderbuffer),delete s.depthRenderbuffer),s.stencilRenderbuffer&&(n.deleteRenderbuffer(s.stencilRenderbuffer),delete s.stencilRenderbuffer),s.msaaFrameBuffer&&(n.deleteFramebuffer(s.msaaFrameBuffer),delete s.msaaFrameBuffer),s.msaaRenderbuffers){for(let o=0;o<s.msaaRenderbuffers.length;o++)n.deleteRenderbuffer(s.msaaRenderbuffers[o]);delete s.msaaRenderbuffers}}}destroyTexture(e){const{gl:n,backend:i}=this,{textureGPU:s,renderTarget:o}=i.get(e);this.deallocateRenderBuffers(o),n.deleteTexture(s),i.delete(e)}copyTextureToTexture(e,n,i=null,s=null,o=0,a=0){const{gl:l,backend:c}=this,{state:u}=this.backend,{textureGPU:h,glTextureType:f,glType:d,glFormat:p}=c.get(n);u.bindTexture(f,h);let m,g,v,y,x,b,w,_,S;const T=e.isCompressedTexture?e.mipmaps[a]:e.image;if(i!==null)m=i.max.x-i.min.x,g=i.max.y-i.min.y,v=i.isBox3?i.max.z-i.min.z:1,y=i.min.x,x=i.min.y,b=i.isBox3?i.min.z:0;else{const C=Math.pow(2,-o);m=Math.floor(T.width*C),g=Math.floor(T.height*C),e.isDataArrayTexture||e.isDepthArrayTexture?v=T.depth:e.isData3DTexture?v=Math.floor(T.depth*C):v=1,y=0,x=0,b=0}s!==null?(w=s.x,_=s.y,S=s.z):(w=0,_=0,S=0),l.pixelStorei(l.UNPACK_FLIP_Y_WEBGL,n.flipY),l.pixelStorei(l.UNPACK_PREMULTIPLY_ALPHA_WEBGL,n.premultiplyAlpha),l.pixelStorei(l.UNPACK_ALIGNMENT,n.unpackAlignment);const E=l.getParameter(l.UNPACK_ROW_LENGTH),M=l.getParameter(l.UNPACK_IMAGE_HEIGHT),A=l.getParameter(l.UNPACK_SKIP_PIXELS),P=l.getParameter(l.UNPACK_SKIP_ROWS),D=l.getParameter(l.UNPACK_SKIP_IMAGES);l.pixelStorei(l.UNPACK_ROW_LENGTH,T.width),l.pixelStorei(l.UNPACK_IMAGE_HEIGHT,T.height),l.pixelStorei(l.UNPACK_SKIP_PIXELS,y),l.pixelStorei(l.UNPACK_SKIP_ROWS,x),l.pixelStorei(l.UNPACK_SKIP_IMAGES,b);const B=n.isDataArrayTexture||n.isData3DTexture||n.isDepthArrayTexture;if(e.isRenderTargetTexture||e.isDepthTexture){const C=c.get(e),O=c.get(n),R=c.get(C.renderTarget),z=c.get(O.renderTarget),U=R.framebuffers[C.cacheKey],G=z.framebuffers[O.cacheKey];u.bindFramebuffer(l.READ_FRAMEBUFFER,U),u.bindFramebuffer(l.DRAW_FRAMEBUFFER,G);let H=l.COLOR_BUFFER_BIT;e.isDepthTexture&&(H=l.DEPTH_BUFFER_BIT),l.blitFramebuffer(y,x,m,g,w,_,m,g,H,l.NEAREST),u.bindFramebuffer(l.READ_FRAMEBUFFER,null),u.bindFramebuffer(l.DRAW_FRAMEBUFFER,null)}else B?e.isDataTexture||e.isData3DTexture?l.texSubImage3D(f,a,w,_,S,m,g,v,p,d,T.data):n.isCompressedArrayTexture?l.compressedTexSubImage3D(f,a,w,_,S,m,g,v,p,T.data):l.texSubImage3D(f,a,w,_,S,m,g,v,p,d,T):e.isDataTexture?l.texSubImage2D(f,a,w,_,m,g,p,d,T.data):e.isCompressedTexture?l.compressedTexSubImage2D(f,a,w,_,T.width,T.height,p,T.data):l.texSubImage2D(f,a,w,_,m,g,p,d,T);l.pixelStorei(l.UNPACK_ROW_LENGTH,E),l.pixelStorei(l.UNPACK_IMAGE_HEIGHT,M),l.pixelStorei(l.UNPACK_SKIP_PIXELS,A),l.pixelStorei(l.UNPACK_SKIP_ROWS,P),l.pixelStorei(l.UNPACK_SKIP_IMAGES,D),a===0&&n.generateMipmaps&&l.generateMipmap(f),u.unbindTexture()}copyFramebufferToTexture(e,n,i){const{gl:s}=this,{state:o}=this.backend,{textureGPU:a}=this.backend.get(e),{x:l,y:c,z:u,w:h}=i,f=e.isDepthTexture===!0||n.renderTarget&&n.renderTarget.samples>0,d=n.renderTarget?n.renderTarget.height:this.backend.getDrawingBufferSize().y;if(f){const p=l!==0||c!==0;let m,g;if(e.isDepthTexture===!0?(m=s.DEPTH_BUFFER_BIT,g=s.DEPTH_ATTACHMENT,n.stencil&&(m|=s.STENCIL_BUFFER_BIT)):(m=s.COLOR_BUFFER_BIT,g=s.COLOR_ATTACHMENT0),p){const v=this.backend.get(n.renderTarget),y=v.framebuffers[n.getCacheKey()],x=v.msaaFrameBuffer;o.bindFramebuffer(s.DRAW_FRAMEBUFFER,y),o.bindFramebuffer(s.READ_FRAMEBUFFER,x);const b=d-c-h;s.blitFramebuffer(l,b,l+u,b+h,l,b,l+u,b+h,m,s.NEAREST),o.bindFramebuffer(s.READ_FRAMEBUFFER,y),o.bindTexture(s.TEXTURE_2D,a),s.copyTexSubImage2D(s.TEXTURE_2D,0,0,0,l,b,u,h),o.unbindTexture()}else{const v=s.createFramebuffer();o.bindFramebuffer(s.DRAW_FRAMEBUFFER,v),s.framebufferTexture2D(s.DRAW_FRAMEBUFFER,g,s.TEXTURE_2D,a,0),s.blitFramebuffer(0,0,u,h,0,0,u,h,m,s.NEAREST),s.deleteFramebuffer(v)}}else o.bindTexture(s.TEXTURE_2D,a),s.copyTexSubImage2D(s.TEXTURE_2D,0,0,0,l,d-h-c,u,h),o.unbindTexture();e.generateMipmaps&&this.generateMipmaps(e),this.backend._setFramebuffer(n)}setupRenderBufferStorage(e,n,i,s=!1){const{gl:o}=this,a=n.renderTarget,{depthTexture:l,depthBuffer:c,stencilBuffer:u,width:h,height:f}=a;if(o.bindRenderbuffer(o.RENDERBUFFER,e),c&&!u){let d=o.DEPTH_COMPONENT24;s===!0?this.extensions.get("WEBGL_multisampled_render_to_texture").renderbufferStorageMultisampleEXT(o.RENDERBUFFER,a.samples,d,h,f):i>0?(l&&l.isDepthTexture&&l.type===o.FLOAT&&(d=o.DEPTH_COMPONENT32F),o.renderbufferStorageMultisample(o.RENDERBUFFER,i,d,h,f)):o.renderbufferStorage(o.RENDERBUFFER,d,h,f),o.framebufferRenderbuffer(o.FRAMEBUFFER,o.DEPTH_ATTACHMENT,o.RENDERBUFFER,e)}else c&&u&&(i>0?o.renderbufferStorageMultisample(o.RENDERBUFFER,i,o.DEPTH24_STENCIL8,h,f):o.renderbufferStorage(o.RENDERBUFFER,o.DEPTH_STENCIL,h,f),o.framebufferRenderbuffer(o.FRAMEBUFFER,o.DEPTH_STENCIL_ATTACHMENT,o.RENDERBUFFER,e))}async copyTextureToBuffer(e,n,i,s,o,a){const{backend:l,gl:c}=this,{textureGPU:u,glFormat:h,glType:f}=this.backend.get(e),d=c.createFramebuffer();c.bindFramebuffer(c.READ_FRAMEBUFFER,d);const p=e.isCubeTexture?c.TEXTURE_CUBE_MAP_POSITIVE_X+a:c.TEXTURE_2D;c.framebufferTexture2D(c.READ_FRAMEBUFFER,c.COLOR_ATTACHMENT0,p,u,0);const m=this._getTypedArrayType(f),g=this._getBytesPerTexel(f,h),y=s*o*g,x=c.createBuffer();c.bindBuffer(c.PIXEL_PACK_BUFFER,x),c.bufferData(c.PIXEL_PACK_BUFFER,y,c.STREAM_READ),c.readPixels(n,i,s,o,h,f,0),c.bindBuffer(c.PIXEL_PACK_BUFFER,null),await l.utils._clientWaitAsync();const b=new m(y/m.BYTES_PER_ELEMENT);return c.bindBuffer(c.PIXEL_PACK_BUFFER,x),c.getBufferSubData(c.PIXEL_PACK_BUFFER,0,b),c.bindBuffer(c.PIXEL_PACK_BUFFER,null),c.deleteFramebuffer(d),b}_getTypedArrayType(e){const{gl:n}=this;if(e===n.UNSIGNED_BYTE)return Uint8Array;if(e===n.UNSIGNED_SHORT_4_4_4_4||e===n.UNSIGNED_SHORT_5_5_5_1||e===n.UNSIGNED_SHORT_5_6_5||e===n.UNSIGNED_SHORT)return Uint16Array;if(e===n.UNSIGNED_INT)return Uint32Array;if(e===n.HALF_FLOAT)return Uint16Array;if(e===n.FLOAT)return Float32Array;throw new Error(`Unsupported WebGL type: ${e}`)}_getBytesPerTexel(e,n){const{gl:i}=this;let s=0;if(e===i.UNSIGNED_BYTE&&(s=1),(e===i.UNSIGNED_SHORT_4_4_4_4||e===i.UNSIGNED_SHORT_5_5_5_1||e===i.UNSIGNED_SHORT_5_6_5||e===i.UNSIGNED_SHORT||e===i.HALF_FLOAT)&&(s=2),(e===i.UNSIGNED_INT||e===i.FLOAT)&&(s=4),n===i.RGBA)return s*4;if(n===i.RGB)return s*3;if(n===i.ALPHA)return s}}class SFe{constructor(e){this.backend=e,this.gl=this.backend.gl,this.availableExtensions=this.gl.getSupportedExtensions(),this.extensions={}}get(e){let n=this.extensions[e];return n===void 0&&(n=this.gl.getExtension(e),this.extensions[e]=n),n}has(e){return this.availableExtensions.includes(e)}}class TFe{constructor(e){this.backend=e,this.maxAnisotropy=null}getMaxAnisotropy(){if(this.maxAnisotropy!==null)return this.maxAnisotropy;const e=this.backend.gl,n=this.backend.extensions;if(n.has("EXT_texture_filter_anisotropic")===!0){const i=n.get("EXT_texture_filter_anisotropic");this.maxAnisotropy=e.getParameter(i.MAX_TEXTURE_MAX_ANISOTROPY_EXT)}else this.maxAnisotropy=0;return this.maxAnisotropy}}const K5={WEBGL_multi_draw:"WEBGL_multi_draw",WEBGL_compressed_texture_astc:"texture-compression-astc",WEBGL_compressed_texture_etc:"texture-compression-etc2",WEBGL_compressed_texture_etc1:"texture-compression-etc1",WEBGL_compressed_texture_pvrtc:"texture-compression-pvrtc",WEBKIT_WEBGL_compressed_texture_pvrtc:"texture-compression-pvrtc",WEBGL_compressed_texture_s3tc:"texture-compression-bc",EXT_texture_compression_bptc:"texture-compression-bptc",EXT_disjoint_timer_query_webgl2:"timestamp-query",OVR_multiview2:"OVR_multiview2"};class EFe{constructor(e){this.gl=e.gl,this.extensions=e.extensions,this.info=e.renderer.info,this.mode=null,this.index=0,this.type=null,this.object=null}render(e,n){const{gl:i,mode:s,object:o,type:a,info:l,index:c}=this;c!==0?i.drawElements(s,n,a,e):i.drawArrays(s,e,n),l.update(o,n,1)}renderInstances(e,n,i){const{gl:s,mode:o,type:a,index:l,object:c,info:u}=this;i!==0&&(l!==0?s.drawElementsInstanced(o,n,a,e,i):s.drawArraysInstanced(o,e,n,i),u.update(c,n,i))}renderMultiDraw(e,n,i){const{extensions:s,mode:o,object:a,info:l}=this;if(i===0)return;const c=s.get("WEBGL_multi_draw");if(c===null)for(let u=0;u<i;u++)this.render(e[u],n[u]);else{this.index!==0?c.multiDrawElementsWEBGL(o,n,0,this.type,e,0,i):c.multiDrawArraysWEBGL(o,e,0,n,0,i);let u=0;for(let h=0;h<i;h++)u+=n[h];l.update(a,u,1)}}renderMultiDrawInstances(e,n,i,s){const{extensions:o,mode:a,object:l,info:c}=this;if(i===0)return;const u=o.get("WEBGL_multi_draw");if(u===null)for(let h=0;h<i;h++)this.renderInstances(e[h],n[h],s[h]);else{this.index!==0?u.multiDrawElementsInstancedWEBGL(a,n,0,this.type,e,0,s,0,i):u.multiDrawArraysInstancedWEBGL(a,e,0,n,0,s,0,i);let h=0;for(let f=0;f<i;f++)h+=n[f]*s[f];c.update(l,h,1)}}}class See{constructor(e=256){this.trackTimestamp=!0,this.maxQueries=e,this.currentQueryIndex=0,this.queryOffsets=new Map,this.isDisposed=!1,this.lastValue=0,this.pendingResolve=!1}allocateQueriesForContext(){}async resolveQueriesAsync(){}dispose(){}}class MFe extends See{constructor(e,n,i=2048){if(super(i),this.gl=e,this.type=n,this.ext=e.getExtension("EXT_disjoint_timer_query_webgl2")||e.getExtension("EXT_disjoint_timer_query"),!this.ext){console.warn("EXT_disjoint_timer_query not supported; timestamps will be disabled."),this.trackTimestamp=!1;return}this.queries=[];for(let s=0;s<this.maxQueries;s++)this.queries.push(e.createQuery());this.activeQuery=null,this.queryStates=new Map}allocateQueriesForContext(e){if(!this.trackTimestamp)return null;if(this.currentQueryIndex+2>this.maxQueries)return Ja(`WebGPUTimestampQueryPool [${this.type}]: Maximum number of queries exceeded, when using trackTimestamp it is necessary to resolves the queries via renderer.resolveTimestampsAsync( THREE.TimestampQuery.${this.type.toUpperCase()} ).`),null;const n=this.currentQueryIndex;return this.currentQueryIndex+=2,this.queryStates.set(n,"inactive"),this.queryOffsets.set(e.id,n),n}beginQuery(e){if(!this.trackTimestamp||this.isDisposed)return;const n=this.queryOffsets.get(e.id);if(n==null||this.activeQuery!==null)return;const i=this.queries[n];if(i)try{this.queryStates.get(n)==="inactive"&&(this.gl.beginQuery(this.ext.TIME_ELAPSED_EXT,i),this.activeQuery=n,this.queryStates.set(n,"started"))}catch(s){console.error("Error in beginQuery:",s),this.activeQuery=null,this.queryStates.set(n,"inactive")}}endQuery(e){if(!this.trackTimestamp||this.isDisposed)return;const n=this.queryOffsets.get(e.id);if(n!=null&&this.activeQuery===n)try{this.gl.endQuery(this.ext.TIME_ELAPSED_EXT),this.queryStates.set(n,"ended"),this.activeQuery=null}catch(i){console.error("Error in endQuery:",i),this.queryStates.set(n,"inactive"),this.activeQuery=null}}async resolveQueriesAsync(){if(!this.trackTimestamp||this.pendingResolve)return this.lastValue;this.pendingResolve=!0;try{const e=[];for(const[s,o]of this.queryStates)if(o==="ended"){const a=this.queries[s];e.push(this.resolveQuery(a))}if(e.length===0)return this.lastValue;const i=(await Promise.all(e)).reduce((s,o)=>s+o,0);return this.lastValue=i,this.currentQueryIndex=0,this.queryOffsets.clear(),this.queryStates.clear(),this.activeQuery=null,i}catch(e){return console.error("Error resolving queries:",e),this.lastValue}finally{this.pendingResolve=!1}}async resolveQuery(e){return new Promise(n=>{if(this.isDisposed){n(this.lastValue);return}let i,s=!1;const o=()=>{i&&(clearTimeout(i),i=null)},a=c=>{s||(s=!0,o(),n(c))},l=()=>{if(this.isDisposed){a(this.lastValue);return}try{if(this.gl.getParameter(this.ext.GPU_DISJOINT_EXT)){a(this.lastValue);return}if(!this.gl.getQueryParameter(e,this.gl.QUERY_RESULT_AVAILABLE)){i=setTimeout(l,1);return}const h=this.gl.getQueryParameter(e,this.gl.QUERY_RESULT);n(Number(h)/1e6)}catch(c){console.error("Error checking query:",c),n(this.lastValue)}};l()})}dispose(){if(!this.isDisposed&&(this.isDisposed=!0,!!this.trackTimestamp)){for(const e of this.queries)this.gl.deleteQuery(e);this.queries=[],this.queryStates.clear(),this.queryOffsets.clear(),this.lastValue=0,this.activeQuery=null}}}class Y5 extends wee{constructor(e={}){super(e),this.isWebGLBackend=!0,this.attributeUtils=null,this.extensions=null,this.capabilities=null,this.textureUtils=null,this.bufferRenderer=null,this.gl=null,this.state=null,this.utils=null,this.vaoCache={},this.transformFeedbackCache={},this.discard=!1,this.disjoint=null,this.parallel=null,this._currentContext=null,this._knownBindings=new WeakSet,this._supportsInvalidateFramebuffer=typeof navigator>"u"?!1:/OculusBrowser/g.test(navigator.userAgent),this._xrFramebuffer=null}init(e){super.init(e);const n=this.parameters,i={antialias:e.samples>0,alpha:!0,depth:e.depth,stencil:e.stencil},s=n.context!==void 0?n.context:e.domElement.getContext("webgl2",i);function o(a){a.preventDefault();const l={api:"WebGL",message:a.statusMessage||"Unknown reason",reason:null,originalEvent:a};e.onDeviceLost(l)}this._onContextLost=o,e.domElement.addEventListener("webglcontextlost",o,!1),this.gl=s,this.extensions=new SFe(this),this.capabilities=new TFe(this),this.attributeUtils=new xFe(this),this.textureUtils=new wFe(this),this.bufferRenderer=new EFe(this),this.state=new bFe(this),this.utils=new _Fe(this),this.extensions.get("EXT_color_buffer_float"),this.extensions.get("WEBGL_clip_cull_distance"),this.extensions.get("OES_texture_float_linear"),this.extensions.get("EXT_color_buffer_half_float"),this.extensions.get("WEBGL_multisampled_render_to_texture"),this.extensions.get("WEBGL_render_shared_exponent"),this.extensions.get("WEBGL_multi_draw"),this.extensions.get("OVR_multiview2"),this.disjoint=this.extensions.get("EXT_disjoint_timer_query_webgl2"),this.parallel=this.extensions.get("KHR_parallel_shader_compile")}get coordinateSystem(){return Ps}async getArrayBufferAsync(e){return await this.attributeUtils.getArrayBufferAsync(e)}async waitForGPU(){await this.utils._clientWaitAsync()}async makeXRCompatible(){this.gl.getContextAttributes().xrCompatible!==!0&&await this.gl.makeXRCompatible()}setXRTarget(e){this._xrFramebuffer=e}setXRRenderTargetTextures(e,n,i=null){const s=this.gl;if(this.set(e.texture,{textureGPU:n,glInternalFormat:s.RGBA8}),i!==null){const o=e.stencilBuffer?s.DEPTH24_STENCIL8:s.DEPTH_COMPONENT24;this.set(e.depthTexture,{textureGPU:i,glInternalFormat:o}),this.extensions.has("WEBGL_multisampled_render_to_texture")===!0&&e.autoAllocateDepthBuffer===!0&&e.multiview===!1&&console.warn("THREE.WebGLBackend: Render-to-texture extension was disabled because an external texture was provided"),e.autoAllocateDepthBuffer=!1}}initTimestampQuery(e){if(!this.disjoint||!this.trackTimestamp)return;const n=e.isComputeNode?"compute":"render";this.timestampQueryPool[n]||(this.timestampQueryPool[n]=new MFe(this.gl,n,2048));const i=this.timestampQueryPool[n];i.allocateQueriesForContext(e)!==null&&i.beginQuery(e)}prepareTimestampBuffer(e){if(!this.disjoint||!this.trackTimestamp)return;const n=e.isComputeNode?"compute":"render";this.timestampQueryPool[n].endQuery(e)}getContext(){return this.gl}beginRender(e){const{state:n,gl:i}=this,s=this.get(e);if(e.viewport?this.updateViewport(e):n.viewport(0,0,i.drawingBufferWidth,i.drawingBufferHeight),e.scissor){const{x:a,y:l,width:c,height:u}=e.scissorValue;n.scissor(a,e.height-u-l,c,u)}this.initTimestampQuery(e),s.previousContext=this._currentContext,this._currentContext=e,this._setFramebuffer(e),this.clear(e.clearColor,e.clearDepth,e.clearStencil,e,!1);const o=e.occlusionQueryCount;o>0&&(s.currentOcclusionQueries=s.occlusionQueries,s.currentOcclusionQueryObjects=s.occlusionQueryObjects,s.lastOcclusionObject=null,s.occlusionQueries=new Array(o),s.occlusionQueryObjects=new Array(o),s.occlusionQueryIndex=0)}finishRender(e){const{gl:n,state:i}=this,s=this.get(e),o=s.previousContext;i.resetVertexState();const a=e.occlusionQueryCount;a>0&&(a>s.occlusionQueryIndex&&n.endQuery(n.ANY_SAMPLES_PASSED),this.resolveOccludedAsync(e));const l=e.textures;if(l!==null)for(let c=0;c<l.length;c++){const u=l[c];u.generateMipmaps&&this.generateMipmaps(u)}if(this._currentContext=o,e.textures!==null&&e.renderTarget){const c=this.get(e.renderTarget),{samples:u}=e.renderTarget;if(u>0&&this._useMultisampledExtension(e.renderTarget)===!1){const h=c.framebuffers[e.getCacheKey()],f=n.COLOR_BUFFER_BIT,d=c.msaaFrameBuffer,p=e.textures;i.bindFramebuffer(n.READ_FRAMEBUFFER,d),i.bindFramebuffer(n.DRAW_FRAMEBUFFER,h);for(let m=0;m<p.length;m++)if(e.scissor){const{x:g,y:v,width:y,height:x}=e.scissorValue,b=e.height-x-v;n.blitFramebuffer(g,b,g+y,b+x,g,b,g+y,b+x,f,n.NEAREST),this._supportsInvalidateFramebuffer===!0&&n.invalidateSubFramebuffer(n.READ_FRAMEBUFFER,c.invalidationArray,g,b,y,x)}else n.blitFramebuffer(0,0,e.width,e.height,0,0,e.width,e.height,f,n.NEAREST),this._supportsInvalidateFramebuffer===!0&&n.invalidateFramebuffer(n.READ_FRAMEBUFFER,c.invalidationArray)}}o!==null&&(this._setFramebuffer(o),o.viewport?this.updateViewport(o):i.viewport(0,0,n.drawingBufferWidth,n.drawingBufferHeight)),this.prepareTimestampBuffer(e)}resolveOccludedAsync(e){const n=this.get(e),{currentOcclusionQueries:i,currentOcclusionQueryObjects:s}=n;if(i&&s){const o=new WeakSet,{gl:a}=this;n.currentOcclusionQueryObjects=null,n.currentOcclusionQueries=null;const l=()=>{let c=0;for(let u=0;u<i.length;u++){const h=i[u];h!==null&&a.getQueryParameter(h,a.QUERY_RESULT_AVAILABLE)&&(a.getQueryParameter(h,a.QUERY_RESULT)===0&&o.add(s[u]),i[u]=null,a.deleteQuery(h),c++)}c<i.length?requestAnimationFrame(l):n.occluded=o};l()}}isOccluded(e,n){const i=this.get(e);return i.occluded&&i.occluded.has(n)}updateViewport(e){const{state:n}=this,{x:i,y:s,width:o,height:a}=e.viewportValue;n.viewport(i,e.height-a-s,o,a)}setScissorTest(e){this.state.setScissorTest(e)}getClearColor(){const e=super.getClearColor();return e.r*=e.a,e.g*=e.a,e.b*=e.a,e}clear(e,n,i,s=null,o=!0){const{gl:a,renderer:l}=this;s===null&&(s={textures:null,clearColorValue:this.getClearColor()});let c=0;if(e&&(c|=a.COLOR_BUFFER_BIT),n&&(c|=a.DEPTH_BUFFER_BIT),i&&(c|=a.STENCIL_BUFFER_BIT),c!==0){let u;s.clearColorValue?u=s.clearColorValue:u=this.getClearColor();const h=l.getClearDepth(),f=l.getClearStencil();if(n&&this.state.setDepthMask(!0),s.textures===null)a.clearColor(u.r,u.g,u.b,u.a),a.clear(c);else{if(o&&this._setFramebuffer(s),e)for(let d=0;d<s.textures.length;d++)d===0?a.clearBufferfv(a.COLOR,d,[u.r,u.g,u.b,u.a]):a.clearBufferfv(a.COLOR,d,[0,0,0,1]);n&&i?a.clearBufferfi(a.DEPTH_STENCIL,0,h,f):n?a.clearBufferfv(a.DEPTH,0,[h]):i&&a.clearBufferiv(a.STENCIL,0,[f])}}}beginCompute(e){const{state:n,gl:i}=this;n.bindFramebuffer(i.FRAMEBUFFER,null),this.initTimestampQuery(e)}compute(e,n,i,s){const{state:o,gl:a}=this;this.discard===!1&&(a.enable(a.RASTERIZER_DISCARD),this.discard=!0);const{programGPU:l,transformBuffers:c,attributes:u}=this.get(s),h=this._getVaoKey(u),f=this.vaoCache[h];f===void 0?this._createVao(u):o.setVertexState(f),o.useProgram(l),this._bindUniforms(i);const d=this._getTransformFeedback(c);a.bindTransformFeedback(a.TRANSFORM_FEEDBACK,d),a.beginTransformFeedback(a.POINTS),u[0].isStorageInstancedBufferAttribute?a.drawArraysInstanced(a.POINTS,0,1,n.count):a.drawArrays(a.POINTS,0,n.count),a.endTransformFeedback(),a.bindTransformFeedback(a.TRANSFORM_FEEDBACK,null);for(let p=0;p<c.length;p++){const m=c[p];m.pbo&&this.textureUtils.copyBufferToTexture(m.transformBuffer,m.pbo),m.switchBuffers()}}finishCompute(e){const n=this.gl;this.discard=!1,n.disable(n.RASTERIZER_DISCARD),this.prepareTimestampBuffer(e),this._currentContext&&this._setFramebuffer(this._currentContext)}_isRenderCameraDepthArray(e){return e.depthTexture&&e.depthTexture.isDepthArrayTexture&&e.camera.isArrayCamera}draw(e){const{object:n,pipeline:i,material:s,context:o,hardwareClippingPlanes:a}=e,{programGPU:l}=this.get(i),{gl:c,state:u}=this,h=this.get(o),f=e.getDrawParameters();if(f===null)return;this._bindUniforms(e.getBindings());const d=n.isMesh&&n.matrixWorld.determinant()<0;u.setMaterial(s,d,a),u.useProgram(l);const p=this.get(e);let m=p.staticVao;if(m===void 0||p.geometryId!==e.geometry.id){const T=this._getVaoKey(e.getAttributes());if(m=this.vaoCache[T],m===void 0){let E;({vaoGPU:m,staticVao:E}=this._createVao(e.getAttributes())),E&&(p.staticVao=m,p.geometryId=e.geometry.id)}}const g=e.getIndex(),v=g!==null?this.get(g).bufferGPU:null;u.setVertexState(m,v);const y=h.lastOcclusionObject;if(y!==n&&y!==void 0){if(y!==null&&y.occlusionTest===!0&&(c.endQuery(c.ANY_SAMPLES_PASSED),h.occlusionQueryIndex++),n.occlusionTest===!0){const T=c.createQuery();c.beginQuery(c.ANY_SAMPLES_PASSED,T),h.occlusionQueries[h.occlusionQueryIndex]=T,h.occlusionQueryObjects[h.occlusionQueryIndex]=n}h.lastOcclusionObject=n}const x=this.bufferRenderer;n.isPoints?x.mode=c.POINTS:n.isLineSegments?x.mode=c.LINES:n.isLine?x.mode=c.LINE_STRIP:n.isLineLoop?x.mode=c.LINE_LOOP:s.wireframe===!0?(u.setLineWidth(s.wireframeLinewidth*this.renderer.getPixelRatio()),x.mode=c.LINES):x.mode=c.TRIANGLES;const{vertexCount:b,instanceCount:w}=f;let{firstVertex:_}=f;if(x.object=n,g!==null){_*=g.array.BYTES_PER_ELEMENT;const T=this.get(g);x.index=g.count,x.type=T.type}else x.index=0;const S=()=>{n.isBatchedMesh?n._multiDrawInstances!==null?(Ja("THREE.WebGLBackend: renderMultiDrawInstances has been deprecated and will be removed in r184. Append to renderMultiDraw arguments and use indirection."),x.renderMultiDrawInstances(n._multiDrawStarts,n._multiDrawCounts,n._multiDrawCount,n._multiDrawInstances)):this.hasFeature("WEBGL_multi_draw")?x.renderMultiDraw(n._multiDrawStarts,n._multiDrawCounts,n._multiDrawCount):Ja("THREE.WebGLRenderer: WEBGL_multi_draw not supported."):w>1?x.renderInstances(_,b,w):x.render(_,b)};if(e.camera.isArrayCamera===!0&&e.camera.cameras.length>0&&e.camera.isMultiViewCamera===!1){const T=this.get(e.camera),E=e.camera.cameras,M=e.getBindingGroup("cameraIndex").bindings[0];if(T.indexesGPU===void 0||T.indexesGPU.length!==E.length){const O=new Uint32Array([0,0,0,0]),R=[];for(let z=0,U=E.length;z<U;z++){const G=c.createBuffer();O[0]=z,c.bindBuffer(c.UNIFORM_BUFFER,G),c.bufferData(c.UNIFORM_BUFFER,O,c.STATIC_DRAW),R.push(G)}T.indexesGPU=R}const A=this.get(M),P=this.renderer.getPixelRatio(),D=this._currentContext.renderTarget,B=this._isRenderCameraDepthArray(this._currentContext),C=this._currentContext.activeCubeFace;if(B){const O=this.get(D.depthTexture);if(O.clearedRenderId!==this.renderer._nodes.nodeFrame.renderId){O.clearedRenderId=this.renderer._nodes.nodeFrame.renderId;const{stencilBuffer:R}=D;for(let z=0,U=E.length;z<U;z++)this.renderer._activeCubeFace=z,this._currentContext.activeCubeFace=z,this._setFramebuffer(this._currentContext),this.clear(!1,!0,R,this._currentContext,!1);this.renderer._activeCubeFace=C,this._currentContext.activeCubeFace=C}}for(let O=0,R=E.length;O<R;O++){const z=E[O];if(n.layers.test(z.layers)){B&&(this.renderer._activeCubeFace=O,this._currentContext.activeCubeFace=O,this._setFramebuffer(this._currentContext));const U=z.viewport;if(U!==void 0){const G=U.x*P,H=U.y*P,Y=U.width*P,ee=U.height*P;u.viewport(Math.floor(G),Math.floor(e.context.height-ee-H),Math.floor(Y),Math.floor(ee))}u.bindBufferBase(c.UNIFORM_BUFFER,A.index,T.indexesGPU[O]),S()}this._currentContext.activeCubeFace=C,this.renderer._activeCubeFace=C}}else S()}needsRenderUpdate(){return!1}getRenderCacheKey(){return""}createDefaultTexture(e){this.textureUtils.createDefaultTexture(e)}createTexture(e,n){this.textureUtils.createTexture(e,n)}updateTexture(e,n){this.textureUtils.updateTexture(e,n)}generateMipmaps(e){this.textureUtils.generateMipmaps(e)}destroyTexture(e){this.textureUtils.destroyTexture(e)}async copyTextureToBuffer(e,n,i,s,o,a){return this.textureUtils.copyTextureToBuffer(e,n,i,s,o,a)}createSampler(){}destroySampler(){}createNodeBuilder(e,n){return new gFe(e,n)}createProgram(e){const n=this.gl,{stage:i,code:s}=e,o=i==="fragment"?n.createShader(n.FRAGMENT_SHADER):n.createShader(n.VERTEX_SHADER);n.shaderSource(o,s),n.compileShader(o),this.set(e,{shaderGPU:o})}destroyProgram(e){this.delete(e)}createRenderPipeline(e,n){const i=this.gl,s=e.pipeline,{fragmentProgram:o,vertexProgram:a}=s,l=i.createProgram(),c=this.get(o).shaderGPU,u=this.get(a).shaderGPU;if(i.attachShader(l,c),i.attachShader(l,u),i.linkProgram(l),this.set(s,{programGPU:l,fragmentShader:c,vertexShader:u}),n!==null&&this.parallel){const h=new Promise(f=>{const d=this.parallel,p=()=>{i.getProgramParameter(l,d.COMPLETION_STATUS_KHR)?(this._completeCompile(e,s),f()):requestAnimationFrame(p)};p()});n.push(h);return}this._completeCompile(e,s)}_handleSource(e,n){const i=e.split(`
`),s=[],o=Math.max(n-6,0),a=Math.min(n+6,i.length);for(let l=o;l<a;l++){const c=l+1;s.push(`${c===n?">":" "} ${c}: ${i[l]}`)}return s.join(`
`)}_getShaderErrors(e,n,i){const s=e.getShaderParameter(n,e.COMPILE_STATUS),o=e.getShaderInfoLog(n).trim();if(s&&o==="")return"";const a=/ERROR: 0:(\d+)/.exec(o);if(a){const l=parseInt(a[1]);return i.toUpperCase()+`

`+o+`

`+this._handleSource(e.getShaderSource(n),l)}else return o}_logProgramError(e,n,i){if(this.renderer.debug.checkShaderErrors){const s=this.gl,o=s.getProgramInfoLog(e).trim();if(s.getProgramParameter(e,s.LINK_STATUS)===!1)if(typeof this.renderer.debug.onShaderError=="function")this.renderer.debug.onShaderError(s,e,i,n);else{const a=this._getShaderErrors(s,i,"vertex"),l=this._getShaderErrors(s,n,"fragment");console.error("THREE.WebGLProgram: Shader Error "+s.getError()+" - VALIDATE_STATUS "+s.getProgramParameter(e,s.VALIDATE_STATUS)+`

Program Info Log: `+o+`
`+a+`
`+l)}else o!==""&&console.warn("THREE.WebGLProgram: Program Info Log:",o)}}_completeCompile(e,n){const{state:i,gl:s}=this,o=this.get(n),{programGPU:a,fragmentShader:l,vertexShader:c}=o;s.getProgramParameter(a,s.LINK_STATUS)===!1&&this._logProgramError(a,l,c),i.useProgram(a);const u=e.getBindings();this._setupBindings(u,a),this.set(n,{programGPU:a})}createComputePipeline(e,n){const{state:i,gl:s}=this,o={stage:"fragment",code:`#version 300 es
precision highp float;
void main() {}`};this.createProgram(o);const{computeProgram:a}=e,l=s.createProgram(),c=this.get(o).shaderGPU,u=this.get(a).shaderGPU,h=a.transforms,f=[],d=[];for(let v=0;v<h.length;v++){const y=h[v];f.push(y.varyingName),d.push(y.attributeNode)}s.attachShader(l,c),s.attachShader(l,u),s.transformFeedbackVaryings(l,f,s.SEPARATE_ATTRIBS),s.linkProgram(l),s.getProgramParameter(l,s.LINK_STATUS)===!1&&this._logProgramError(l,c,u),i.useProgram(l),this._setupBindings(n,l);const p=a.attributes,m=[],g=[];for(let v=0;v<p.length;v++){const y=p[v].node.attribute;m.push(y),this.has(y)||this.attributeUtils.createAttribute(y,s.ARRAY_BUFFER)}for(let v=0;v<d.length;v++){const y=d[v].attribute;this.has(y)||this.attributeUtils.createAttribute(y,s.ARRAY_BUFFER);const x=this.get(y);g.push(x)}this.set(e,{programGPU:l,transformBuffers:g,attributes:m})}createBindings(e,n){if(this._knownBindings.has(n)===!1){this._knownBindings.add(n);let i=0,s=0;for(const o of n){this.set(o,{textures:s,uniformBuffers:i});for(const a of o.bindings)a.isUniformBuffer&&i++,a.isSampledTexture&&s++}}this.updateBindings(e,n)}updateBindings(e){const{gl:n}=this,i=this.get(e);let s=i.uniformBuffers,o=i.textures;for(const a of e.bindings)if(a.isUniformsGroup||a.isUniformBuffer){const l=a.buffer,c=n.createBuffer();n.bindBuffer(n.UNIFORM_BUFFER,c),n.bufferData(n.UNIFORM_BUFFER,l,n.DYNAMIC_DRAW),this.set(a,{index:s++,bufferGPU:c})}else if(a.isSampledTexture){const{textureGPU:l,glTextureType:c}=this.get(a.texture);this.set(a,{index:o++,textureGPU:l,glTextureType:c})}}updateBinding(e){const n=this.gl;if(e.isUniformsGroup||e.isUniformBuffer){const s=this.get(e).bufferGPU,o=e.buffer;n.bindBuffer(n.UNIFORM_BUFFER,s),n.bufferData(n.UNIFORM_BUFFER,o,n.DYNAMIC_DRAW)}}createIndexAttribute(e){const n=this.gl;this.attributeUtils.createAttribute(e,n.ELEMENT_ARRAY_BUFFER)}createAttribute(e){if(this.has(e))return;const n=this.gl;this.attributeUtils.createAttribute(e,n.ARRAY_BUFFER)}createStorageAttribute(e){if(this.has(e))return;const n=this.gl;this.attributeUtils.createAttribute(e,n.ARRAY_BUFFER)}updateAttribute(e){this.attributeUtils.updateAttribute(e)}destroyAttribute(e){this.attributeUtils.destroyAttribute(e)}hasFeature(e){const n=Object.keys(K5).filter(s=>K5[s]===e),i=this.extensions;for(let s=0;s<n.length;s++)if(i.has(n[s]))return!0;return!1}getMaxAnisotropy(){return this.capabilities.getMaxAnisotropy()}copyTextureToTexture(e,n,i=null,s=null,o=0,a=0){this.textureUtils.copyTextureToTexture(e,n,i,s,o,a)}copyFramebufferToTexture(e,n,i){this.textureUtils.copyFramebufferToTexture(e,n,i)}_setFramebuffer(e){const{gl:n,state:i}=this;let s=null;if(e.textures!==null){const o=e.renderTarget,a=this.get(o),{samples:l,depthBuffer:c,stencilBuffer:u}=o,h=o.isWebGLCubeRenderTarget===!0,f=o.isRenderTarget3D===!0,d=o.isRenderTargetArray===!0,p=o.isXRRenderTarget===!0,m=p===!0&&o.hasExternalTextures===!0;let g=a.msaaFrameBuffer,v=a.depthRenderbuffer;const y=this.extensions.get("WEBGL_multisampled_render_to_texture"),x=this.extensions.get("OVR_multiview2"),b=this._useMultisampledExtension(o),w=eee(e);let _;if(h?(a.cubeFramebuffers||(a.cubeFramebuffers={}),_=a.cubeFramebuffers[w]):p&&m===!1?_=this._xrFramebuffer:(a.framebuffers||(a.framebuffers={}),_=a.framebuffers[w]),_===void 0){_=n.createFramebuffer(),i.bindFramebuffer(n.FRAMEBUFFER,_);const S=e.textures;if(h){a.cubeFramebuffers[w]=_;const{textureGPU:T}=this.get(S[0]),E=this.renderer._activeCubeFace;n.framebufferTexture2D(n.FRAMEBUFFER,n.COLOR_ATTACHMENT0,n.TEXTURE_CUBE_MAP_POSITIVE_X+E,T,0)}else{a.framebuffers[w]=_;for(let T=0;T<S.length;T++){const E=S[T],M=this.get(E);M.renderTarget=e.renderTarget,M.cacheKey=w;const A=n.COLOR_ATTACHMENT0+T;if(f||d){const P=this.renderer._activeCubeFace;n.framebufferTextureLayer(n.FRAMEBUFFER,A,M.textureGPU,0,P)}else o.multiview?x.framebufferTextureMultisampleMultiviewOVR(n.FRAMEBUFFER,A,M.textureGPU,0,l,0,2):m&&b?y.framebufferTexture2DMultisampleEXT(n.FRAMEBUFFER,A,n.TEXTURE_2D,M.textureGPU,0,l):n.framebufferTexture2D(n.FRAMEBUFFER,A,n.TEXTURE_2D,M.textureGPU,0)}i.drawBuffers(e,_)}if(o.isXRRenderTarget&&o.autoAllocateDepthBuffer===!0){const T=n.createRenderbuffer();this.textureUtils.setupRenderBufferStorage(T,e,0,b),a.xrDepthRenderbuffer=T}else if(e.depthTexture!==null){const T=this.get(e.depthTexture),E=u?n.DEPTH_STENCIL_ATTACHMENT:n.DEPTH_ATTACHMENT;if(T.renderTarget=e.renderTarget,T.cacheKey=w,o.multiview)x.framebufferTextureMultisampleMultiviewOVR(n.FRAMEBUFFER,E,T.textureGPU,0,l,0,2);else if(m&&b)y.framebufferTexture2DMultisampleEXT(n.FRAMEBUFFER,E,n.TEXTURE_2D,T.textureGPU,0,l);else if(e.depthTexture.isDepthArrayTexture){const M=this.renderer._activeCubeFace;n.framebufferTextureLayer(n.FRAMEBUFFER,E,T.textureGPU,0,M)}else n.framebufferTexture2D(n.FRAMEBUFFER,E,n.TEXTURE_2D,T.textureGPU,0)}}else{if(this._isRenderCameraDepthArray(e)){i.bindFramebuffer(n.FRAMEBUFFER,_);const T=this.renderer._activeCubeFace,E=this.get(e.depthTexture),M=u?n.DEPTH_STENCIL_ATTACHMENT:n.DEPTH_ATTACHMENT;n.framebufferTextureLayer(n.FRAMEBUFFER,M,E.textureGPU,0,T)}if(p&&m||o.multiview){i.bindFramebuffer(n.FRAMEBUFFER,_);const T=this.get(e.textures[0]);o.multiview?x.framebufferTextureMultisampleMultiviewOVR(n.FRAMEBUFFER,n.COLOR_ATTACHMENT0,T.textureGPU,0,l,0,2):b?y.framebufferTexture2DMultisampleEXT(n.FRAMEBUFFER,n.COLOR_ATTACHMENT0,n.TEXTURE_2D,T.textureGPU,0,l):n.framebufferTexture2D(n.FRAMEBUFFER,n.COLOR_ATTACHMENT0,n.TEXTURE_2D,T.textureGPU,0);const E=u?n.DEPTH_STENCIL_ATTACHMENT:n.DEPTH_ATTACHMENT;if(o.autoAllocateDepthBuffer===!0){const M=a.xrDepthRenderbuffer;n.bindRenderbuffer(n.RENDERBUFFER,M),n.framebufferRenderbuffer(n.FRAMEBUFFER,E,n.RENDERBUFFER,M)}else{const M=this.get(e.depthTexture);o.multiview?x.framebufferTextureMultisampleMultiviewOVR(n.FRAMEBUFFER,E,M.textureGPU,0,l,0,2):b?y.framebufferTexture2DMultisampleEXT(n.FRAMEBUFFER,E,n.TEXTURE_2D,M.textureGPU,0,l):n.framebufferTexture2D(n.FRAMEBUFFER,E,n.TEXTURE_2D,M.textureGPU,0)}}}if(l>0&&b===!1&&!o.multiview){if(g===void 0){const S=[];g=n.createFramebuffer(),i.bindFramebuffer(n.FRAMEBUFFER,g);const T=[],E=e.textures;for(let M=0;M<E.length;M++){if(T[M]=n.createRenderbuffer(),n.bindRenderbuffer(n.RENDERBUFFER,T[M]),S.push(n.COLOR_ATTACHMENT0+M),c){const D=u?n.DEPTH_STENCIL_ATTACHMENT:n.DEPTH_ATTACHMENT;S.push(D)}const A=e.textures[M],P=this.get(A);n.renderbufferStorageMultisample(n.RENDERBUFFER,l,P.glInternalFormat,e.width,e.height),n.framebufferRenderbuffer(n.FRAMEBUFFER,n.COLOR_ATTACHMENT0+M,n.RENDERBUFFER,T[M])}if(a.msaaFrameBuffer=g,a.msaaRenderbuffers=T,v===void 0){v=n.createRenderbuffer(),this.textureUtils.setupRenderBufferStorage(v,e,l),a.depthRenderbuffer=v;const M=u?n.DEPTH_STENCIL_ATTACHMENT:n.DEPTH_ATTACHMENT;S.push(M)}a.invalidationArray=S}s=a.msaaFrameBuffer}else s=_}i.bindFramebuffer(n.FRAMEBUFFER,s)}_getVaoKey(e){let n="";for(let i=0;i<e.length;i++){const s=this.get(e[i]);n+=":"+s.id}return n}_createVao(e){const{gl:n}=this,i=n.createVertexArray();let s="",o=!0;n.bindVertexArray(i);for(let a=0;a<e.length;a++){const l=e[a],c=this.get(l);s+=":"+c.id,n.bindBuffer(n.ARRAY_BUFFER,c.bufferGPU),n.enableVertexAttribArray(a),(l.isStorageBufferAttribute||l.isStorageInstancedBufferAttribute)&&(o=!1);let u,h;l.isInterleavedBufferAttribute===!0?(u=l.data.stride*c.bytesPerElement,h=l.offset*c.bytesPerElement):(u=0,h=0),c.isInteger?n.vertexAttribIPointer(a,l.itemSize,c.type,u,h):n.vertexAttribPointer(a,l.itemSize,c.type,l.normalized,u,h),l.isInstancedBufferAttribute&&!l.isInterleavedBufferAttribute?n.vertexAttribDivisor(a,l.meshPerAttribute):l.isInterleavedBufferAttribute&&l.data.isInstancedInterleavedBuffer&&n.vertexAttribDivisor(a,l.data.meshPerAttribute)}return n.bindBuffer(n.ARRAY_BUFFER,null),this.vaoCache[s]=i,{vaoGPU:i,staticVao:o}}_getTransformFeedback(e){let n="";for(let o=0;o<e.length;o++)n+=":"+e[o].id;let i=this.transformFeedbackCache[n];if(i!==void 0)return i;const{gl:s}=this;i=s.createTransformFeedback(),s.bindTransformFeedback(s.TRANSFORM_FEEDBACK,i);for(let o=0;o<e.length;o++){const a=e[o];s.bindBufferBase(s.TRANSFORM_FEEDBACK_BUFFER,o,a.transformBuffer)}return s.bindTransformFeedback(s.TRANSFORM_FEEDBACK,null),this.transformFeedbackCache[n]=i,i}_setupBindings(e,n){const i=this.gl;for(const s of e)for(const o of s.bindings){const l=this.get(o).index;if(o.isUniformsGroup||o.isUniformBuffer){const c=i.getUniformBlockIndex(n,o.name);i.uniformBlockBinding(n,c,l)}else if(o.isSampledTexture){const c=i.getUniformLocation(n,o.name);i.uniform1i(c,l)}}}_bindUniforms(e){const{gl:n,state:i}=this;for(const s of e)for(const o of s.bindings){const a=this.get(o),l=a.index;o.isUniformsGroup||o.isUniformBuffer?i.bindBufferBase(n.UNIFORM_BUFFER,l,a.bufferGPU):o.isSampledTexture&&i.bindTexture(a.glTextureType,a.textureGPU,n.TEXTURE0+l)}}_useMultisampledExtension(e){return e.multiview===!0?!0:e.samples>0&&this.extensions.has("WEBGL_multisampled_render_to_texture")===!0&&e.autoAllocateDepthBuffer!==!1}dispose(){const e=this.extensions.get("WEBGL_lose_context");e&&e.loseContext(),this.renderer.domElement.removeEventListener("webglcontextlost",this._onContextLost)}}const dm={PointList:"point-list",LineList:"line-list",LineStrip:"line-strip",TriangleList:"triangle-list",TriangleStrip:"triangle-strip"},Ni={Never:"never",Less:"less",Equal:"equal",LessEqual:"less-equal",Greater:"greater",NotEqual:"not-equal",GreaterEqual:"greater-equal",Always:"always"},gs={Store:"store"},xn={Load:"load",Clear:"clear"},RN={CCW:"ccw"},NN={None:"none",Front:"front",Back:"back"},Ag={Uint16:"uint16",Uint32:"uint32"},re={R8Unorm:"r8unorm",R8Snorm:"r8snorm",R8Uint:"r8uint",R8Sint:"r8sint",R16Uint:"r16uint",R16Sint:"r16sint",R16Float:"r16float",RG8Unorm:"rg8unorm",RG8Snorm:"rg8snorm",RG8Uint:"rg8uint",RG8Sint:"rg8sint",R32Uint:"r32uint",R32Sint:"r32sint",R32Float:"r32float",RG16Uint:"rg16uint",RG16Sint:"rg16sint",RG16Float:"rg16float",RGBA8Unorm:"rgba8unorm",RGBA8UnormSRGB:"rgba8unorm-srgb",RGBA8Snorm:"rgba8snorm",RGBA8Uint:"rgba8uint",RGBA8Sint:"rgba8sint",BGRA8Unorm:"bgra8unorm",BGRA8UnormSRGB:"bgra8unorm-srgb",RGB9E5UFloat:"rgb9e5ufloat",RGB10A2Unorm:"rgb10a2unorm",RG11B10UFloat:"rgb10a2unorm",RG32Uint:"rg32uint",RG32Sint:"rg32sint",RG32Float:"rg32float",RGBA16Uint:"rgba16uint",RGBA16Sint:"rgba16sint",RGBA16Float:"rgba16float",RGBA32Uint:"rgba32uint",RGBA32Sint:"rgba32sint",RGBA32Float:"rgba32float",Depth16Unorm:"depth16unorm",Depth24Plus:"depth24plus",Depth24PlusStencil8:"depth24plus-stencil8",Depth32Float:"depth32float",Depth32FloatStencil8:"depth32float-stencil8",BC1RGBAUnorm:"bc1-rgba-unorm",BC1RGBAUnormSRGB:"bc1-rgba-unorm-srgb",BC2RGBAUnorm:"bc2-rgba-unorm",BC2RGBAUnormSRGB:"bc2-rgba-unorm-srgb",BC3RGBAUnorm:"bc3-rgba-unorm",BC3RGBAUnormSRGB:"bc3-rgba-unorm-srgb",BC4RUnorm:"bc4-r-unorm",BC4RSnorm:"bc4-r-snorm",BC5RGUnorm:"bc5-rg-unorm",BC5RGSnorm:"bc5-rg-snorm",BC6HRGBUFloat:"bc6h-rgb-ufloat",BC6HRGBFloat:"bc6h-rgb-float",BC7RGBAUnorm:"bc7-rgba-unorm",BC7RGBAUnormSRGB:"bc7-rgba-srgb",ETC2RGB8Unorm:"etc2-rgb8unorm",ETC2RGB8UnormSRGB:"etc2-rgb8unorm-srgb",ETC2RGB8A1Unorm:"etc2-rgb8a1unorm",ETC2RGB8A1UnormSRGB:"etc2-rgb8a1unorm-srgb",ETC2RGBA8Unorm:"etc2-rgba8unorm",ETC2RGBA8UnormSRGB:"etc2-rgba8unorm-srgb",EACR11Unorm:"eac-r11unorm",EACR11Snorm:"eac-r11snorm",EACRG11Unorm:"eac-rg11unorm",EACRG11Snorm:"eac-rg11snorm",ASTC4x4Unorm:"astc-4x4-unorm",ASTC4x4UnormSRGB:"astc-4x4-unorm-srgb",ASTC5x4Unorm:"astc-5x4-unorm",ASTC5x4UnormSRGB:"astc-5x4-unorm-srgb",ASTC5x5Unorm:"astc-5x5-unorm",ASTC5x5UnormSRGB:"astc-5x5-unorm-srgb",ASTC6x5Unorm:"astc-6x5-unorm",ASTC6x5UnormSRGB:"astc-6x5-unorm-srgb",ASTC6x6Unorm:"astc-6x6-unorm",ASTC6x6UnormSRGB:"astc-6x6-unorm-srgb",ASTC8x5Unorm:"astc-8x5-unorm",ASTC8x5UnormSRGB:"astc-8x5-unorm-srgb",ASTC8x6Unorm:"astc-8x6-unorm",ASTC8x6UnormSRGB:"astc-8x6-unorm-srgb",ASTC8x8Unorm:"astc-8x8-unorm",ASTC8x8UnormSRGB:"astc-8x8-unorm-srgb",ASTC10x5Unorm:"astc-10x5-unorm",ASTC10x5UnormSRGB:"astc-10x5-unorm-srgb",ASTC10x6Unorm:"astc-10x6-unorm",ASTC10x6UnormSRGB:"astc-10x6-unorm-srgb",ASTC10x8Unorm:"astc-10x8-unorm",ASTC10x8UnormSRGB:"astc-10x8-unorm-srgb",ASTC10x10Unorm:"astc-10x10-unorm",ASTC10x10UnormSRGB:"astc-10x10-unorm-srgb",ASTC12x10Unorm:"astc-12x10-unorm",ASTC12x10UnormSRGB:"astc-12x10-unorm-srgb",ASTC12x12Unorm:"astc-12x12-unorm",ASTC12x12UnormSRGB:"astc-12x12-unorm-srgb"},ON={ClampToEdge:"clamp-to-edge",Repeat:"repeat",MirrorRepeat:"mirror-repeat"},Lf={Linear:"linear",Nearest:"nearest"},zt={Zero:"zero",One:"one",Src:"src",OneMinusSrc:"one-minus-src",SrcAlpha:"src-alpha",OneMinusSrcAlpha:"one-minus-src-alpha",Dst:"dst",OneMinusDstColor:"one-minus-dst",DstAlpha:"dst-alpha",OneMinusDstAlpha:"one-minus-dst-alpha",SrcAlphaSaturated:"src-alpha-saturated",Constant:"constant",OneMinusConstant:"one-minus-constant"},df={Add:"add",Subtract:"subtract",ReverseSubtract:"reverse-subtract",Min:"min",Max:"max"},Z5={None:0,All:15},ju={Keep:"keep",Zero:"zero",Replace:"replace",Invert:"invert",IncrementClamp:"increment-clamp",DecrementClamp:"decrement-clamp",IncrementWrap:"increment-wrap",DecrementWrap:"decrement-wrap"},DN={Storage:"storage",ReadOnlyStorage:"read-only-storage"},kN={WriteOnly:"write-only",ReadOnly:"read-only",ReadWrite:"read-write"},Q5={NonFiltering:"non-filtering",Comparison:"comparison"},pf={Float:"float",UnfilterableFloat:"unfilterable-float",Depth:"depth",SInt:"sint",UInt:"uint"},J5={TwoD:"2d",ThreeD:"3d"},wi={TwoD:"2d",TwoDArray:"2d-array",Cube:"cube",ThreeD:"3d"},AFe={All:"all"},zS={Vertex:"vertex",Instance:"instance"},PD={DepthClipControl:"depth-clip-control",Depth32FloatStencil8:"depth32float-stencil8",TextureCompressionBC:"texture-compression-bc",TextureCompressionETC2:"texture-compression-etc2",TextureCompressionASTC:"texture-compression-astc",TimestampQuery:"timestamp-query",IndirectFirstInstance:"indirect-first-instance",ShaderF16:"shader-f16",RG11B10UFloat:"rg11b10ufloat-renderable",BGRA8UNormStorage:"bgra8unorm-storage",Float32Filterable:"float32-filterable",ClipDistances:"clip-distances",DualSourceBlending:"dual-source-blending",Subgroups:"subgroups"};class CFe extends Q3{constructor(e,n){super(e),this.texture=n,this.version=n?n.version:0,this.isSampler=!0}}class PFe extends CFe{constructor(e,n,i){super(e,n?n.value:null),this.textureNode=n,this.groupNode=i}update(){this.texture=this.textureNode.value}}class RFe extends gee{constructor(e,n){super(e,n?n.array:null),this.attribute=n,this.isStorageBuffer=!0}}let NFe=0;class OFe extends RFe{constructor(e,n){super("StorageBuffer_"+NFe++,e?e.value:null),this.nodeUniform=e,this.access=e?e.access:Bc.READ_WRITE,this.groupNode=n}get buffer(){return this.nodeUniform.value}}class DFe extends Kh{constructor(e){super(),this.device=e;const n=`
struct VarysStruct {
	@builtin( position ) Position: vec4<f32>,
	@location( 0 ) vTex : vec2<f32>
};

@vertex
fn main( @builtin( vertex_index ) vertexIndex : u32 ) -> VarysStruct {

	var Varys : VarysStruct;

	var pos = array< vec2<f32>, 4 >(
		vec2<f32>( -1.0,  1.0 ),
		vec2<f32>(  1.0,  1.0 ),
		vec2<f32>( -1.0, -1.0 ),
		vec2<f32>(  1.0, -1.0 )
	);

	var tex = array< vec2<f32>, 4 >(
		vec2<f32>( 0.0, 0.0 ),
		vec2<f32>( 1.0, 0.0 ),
		vec2<f32>( 0.0, 1.0 ),
		vec2<f32>( 1.0, 1.0 )
	);

	Varys.vTex = tex[ vertexIndex ];
	Varys.Position = vec4<f32>( pos[ vertexIndex ], 0.0, 1.0 );

	return Varys;

}
`,i=`
@group( 0 ) @binding( 0 )
var imgSampler : sampler;

@group( 0 ) @binding( 1 )
var img : texture_2d<f32>;

@fragment
fn main( @location( 0 ) vTex : vec2<f32> ) -> @location( 0 ) vec4<f32> {

	return textureSample( img, imgSampler, vTex );

}
`,s=`
@group( 0 ) @binding( 0 )
var imgSampler : sampler;

@group( 0 ) @binding( 1 )
var img : texture_2d<f32>;

@fragment
fn main( @location( 0 ) vTex : vec2<f32> ) -> @location( 0 ) vec4<f32> {

	return textureSample( img, imgSampler, vec2( vTex.x, 1.0 - vTex.y ) );

}
`;this.mipmapSampler=e.createSampler({minFilter:Lf.Linear}),this.flipYSampler=e.createSampler({minFilter:Lf.Nearest}),this.transferPipelines={},this.flipYPipelines={},this.mipmapVertexShaderModule=e.createShaderModule({label:"mipmapVertex",code:n}),this.mipmapFragmentShaderModule=e.createShaderModule({label:"mipmapFragment",code:i}),this.flipYFragmentShaderModule=e.createShaderModule({label:"flipYFragment",code:s})}getTransferPipeline(e){let n=this.transferPipelines[e];return n===void 0&&(n=this.device.createRenderPipeline({label:`mipmap-${e}`,vertex:{module:this.mipmapVertexShaderModule,entryPoint:"main"},fragment:{module:this.mipmapFragmentShaderModule,entryPoint:"main",targets:[{format:e}]},primitive:{topology:dm.TriangleStrip,stripIndexFormat:Ag.Uint32},layout:"auto"}),this.transferPipelines[e]=n),n}getFlipYPipeline(e){let n=this.flipYPipelines[e];return n===void 0&&(n=this.device.createRenderPipeline({label:`flipY-${e}`,vertex:{module:this.mipmapVertexShaderModule,entryPoint:"main"},fragment:{module:this.flipYFragmentShaderModule,entryPoint:"main",targets:[{format:e}]},primitive:{topology:dm.TriangleStrip,stripIndexFormat:Ag.Uint32},layout:"auto"}),this.flipYPipelines[e]=n),n}flipY(e,n,i=0){const s=n.format,{width:o,height:a}=n.size,l=this.getTransferPipeline(s),c=this.getFlipYPipeline(s),u=this.device.createTexture({size:{width:o,height:a,depthOrArrayLayers:1},format:s,usage:GPUTextureUsage.RENDER_ATTACHMENT|GPUTextureUsage.TEXTURE_BINDING}),h=e.createView({baseMipLevel:0,mipLevelCount:1,dimension:wi.TwoD,baseArrayLayer:i}),f=u.createView({baseMipLevel:0,mipLevelCount:1,dimension:wi.TwoD,baseArrayLayer:0}),d=this.device.createCommandEncoder({}),p=(m,g,v)=>{const y=m.getBindGroupLayout(0),x=this.device.createBindGroup({layout:y,entries:[{binding:0,resource:this.flipYSampler},{binding:1,resource:g}]}),b=d.beginRenderPass({colorAttachments:[{view:v,loadOp:xn.Clear,storeOp:gs.Store,clearValue:[0,0,0,0]}]});b.setPipeline(m),b.setBindGroup(0,x),b.draw(4,1,0,0),b.end()};p(l,h,f),p(c,f,h),this.device.queue.submit([d.finish()]),u.destroy()}generateMipmaps(e,n,i=0){const s=this.get(e);s.useCount===void 0&&(s.useCount=0,s.layers=[]);const o=s.layers[i]||this._mipmapCreateBundles(e,n,i),a=this.device.createCommandEncoder({});this._mipmapRunBundles(a,o),this.device.queue.submit([a.finish()]),s.useCount!==0&&(s.layers[i]=o),s.useCount++}_mipmapCreateBundles(e,n,i){const s=this.getTransferPipeline(n.format),o=s.getBindGroupLayout(0);let a=e.createView({baseMipLevel:0,mipLevelCount:1,dimension:wi.TwoD,baseArrayLayer:i});const l=[];for(let c=1;c<n.mipLevelCount;c++){const u=this.device.createBindGroup({layout:o,entries:[{binding:0,resource:this.mipmapSampler},{binding:1,resource:a}]}),h=e.createView({baseMipLevel:c,mipLevelCount:1,dimension:wi.TwoD,baseArrayLayer:i}),f={colorAttachments:[{view:h,loadOp:xn.Clear,storeOp:gs.Store,clearValue:[0,0,0,0]}]},d=this.device.createRenderBundleEncoder({colorFormats:[n.format]});d.setPipeline(s),d.setBindGroup(0,u),d.draw(4,1,0,0),l.push({renderBundles:[d.finish()],passDescriptor:f}),a=h}return l}_mipmapRunBundles(e,n){const i=n.length;for(let s=0;s<i;s++){const o=n[s],a=e.beginRenderPass(o.passDescriptor);a.executeBundles(o.renderBundles),a.end()}}}const kFe={[wF]:"never",[qM]:"less",[SF]:"equal",[XM]:"less-equal",[TF]:"greater",[MF]:"greater-equal",[AF]:"always",[EF]:"not-equal"},IFe=[0,1,3,2,4,5];class LFe{constructor(e){this.backend=e,this._passUtils=null,this.defaultTexture={},this.defaultCubeTexture={},this.defaultVideoFrame=null,this.colorBuffer=null,this.depthTexture=new ko,this.depthTexture.name="depthBuffer"}createSampler(e){const n=this.backend,i=n.device,s=n.get(e),o={addressModeU:this._convertAddressMode(e.wrapS),addressModeV:this._convertAddressMode(e.wrapT),addressModeW:this._convertAddressMode(e.wrapR),magFilter:this._convertFilterMode(e.magFilter),minFilter:this._convertFilterMode(e.minFilter),mipmapFilter:this._convertFilterMode(e.minFilter),maxAnisotropy:1};o.magFilter===Lf.Linear&&o.minFilter===Lf.Linear&&o.mipmapFilter===Lf.Linear&&(o.maxAnisotropy=e.anisotropy),e.isDepthTexture&&e.compareFunction!==null&&(o.compare=kFe[e.compareFunction]),s.sampler=i.createSampler(o)}createDefaultTexture(e){let n;const i=RD(e);e.isCubeTexture?n=this._getDefaultCubeTextureGPU(i):e.isVideoTexture?this.backend.get(e).externalTexture=this._getDefaultVideoFrame():n=this._getDefaultTextureGPU(i),this.backend.get(e).texture=n}createTexture(e,n={}){const i=this.backend,s=i.get(e);if(s.initialized)throw new Error("WebGPUTextureUtils: Texture already initialized.");n.needsMipmaps===void 0&&(n.needsMipmaps=!1),n.levels===void 0&&(n.levels=1),n.depth===void 0&&(n.depth=1);const{width:o,height:a,depth:l,levels:c}=n;e.isFramebufferTexture&&(n.renderTarget?n.format=this.backend.utils.getCurrentColorFormat(n.renderTarget):n.format=this.backend.utils.getPreferredCanvasFormat());const u=this._getDimension(e),h=e.internalFormat||n.format||RD(e,i.device);s.format=h;const{samples:f,primarySamples:d,isMSAA:p}=i.utils.getTextureSampleData(e);let m=GPUTextureUsage.TEXTURE_BINDING|GPUTextureUsage.COPY_DST|GPUTextureUsage.COPY_SRC;e.isStorageTexture===!0&&(m|=GPUTextureUsage.STORAGE_BINDING),e.isCompressedTexture!==!0&&e.isCompressedArrayTexture!==!0&&(m|=GPUTextureUsage.RENDER_ATTACHMENT);const g={label:e.name,size:{width:o,height:a,depthOrArrayLayers:l},mipLevelCount:c,sampleCount:d,dimension:u,format:h,usage:m};if(e.isVideoTexture){const v=e.source.data,y=new VideoFrame(v);g.size.width=y.displayWidth,g.size.height=y.displayHeight,y.close(),s.externalTexture=v}else{if(h===void 0){console.warn("WebGPURenderer: Texture format not supported."),this.createDefaultTexture(e);return}e.isCubeTexture&&(g.textureBindingViewDimension=wi.Cube),s.texture=i.device.createTexture(g)}if(p){const v=Object.assign({},g);v.label=v.label+"-msaa",v.sampleCount=f,s.msaaTexture=i.device.createTexture(v)}s.initialized=!0,s.textureDescriptorGPU=g}destroyTexture(e){const n=this.backend,i=n.get(e);i.texture!==void 0&&i.texture.destroy(),i.msaaTexture!==void 0&&i.msaaTexture.destroy(),n.delete(e)}destroySampler(e){const i=this.backend.get(e);delete i.sampler}generateMipmaps(e){const n=this.backend.get(e);if(e.isCubeTexture)for(let i=0;i<6;i++)this._generateMipmaps(n.texture,n.textureDescriptorGPU,i);else{const i=e.image.depth||1;for(let s=0;s<i;s++)this._generateMipmaps(n.texture,n.textureDescriptorGPU,s)}}getColorBuffer(){this.colorBuffer&&this.colorBuffer.destroy();const e=this.backend,{width:n,height:i}=e.getDrawingBufferSize();return this.colorBuffer=e.device.createTexture({label:"colorBuffer",size:{width:n,height:i,depthOrArrayLayers:1},sampleCount:e.utils.getSampleCount(e.renderer.samples),format:e.utils.getPreferredCanvasFormat(),usage:GPUTextureUsage.RENDER_ATTACHMENT|GPUTextureUsage.COPY_SRC}),this.colorBuffer}getDepthBuffer(e=!0,n=!1){const i=this.backend,{width:s,height:o}=i.getDrawingBufferSize(),a=this.depthTexture,l=i.get(a).texture;let c,u;if(n?(c=Do,u=No):e&&(c=Oo,u=In),l!==void 0){if(a.image.width===s&&a.image.height===o&&a.format===c&&a.type===u)return l;this.destroyTexture(a)}return a.name="depthBuffer",a.format=c,a.type=u,a.image.width=s,a.image.height=o,this.createTexture(a,{width:s,height:o}),i.get(a).texture}updateTexture(e,n){const i=this.backend.get(e),{textureDescriptorGPU:s}=i;if(!(e.isRenderTargetTexture||s===void 0)){if(e.isDataTexture)this._copyBufferToTexture(n.image,i.texture,s,0,e.flipY);else if(e.isDataArrayTexture||e.isDepthArrayTexture||e.isData3DTexture)for(let o=0;o<n.image.depth;o++)this._copyBufferToTexture(n.image,i.texture,s,o,e.flipY,o);else if(e.isCompressedTexture||e.isCompressedArrayTexture)this._copyCompressedBufferToTexture(e.mipmaps,i.texture,s);else if(e.isCubeTexture)this._copyCubeMapToTexture(n.images,i.texture,s,e.flipY);else if(e.isVideoTexture){const o=e.source.data;i.externalTexture=o}else this._copyImageToTexture(n.image,i.texture,s,0,e.flipY);i.version=e.version,e.onUpdate&&e.onUpdate(e)}}async copyTextureToBuffer(e,n,i,s,o,a){const l=this.backend.device,c=this.backend.get(e),u=c.texture,h=c.textureDescriptorGPU.format,f=this._getBytesPerTexel(h);let d=s*f;d=Math.ceil(d/256)*256;const p=l.createBuffer({size:s*o*f,usage:GPUBufferUsage.COPY_DST|GPUBufferUsage.MAP_READ}),m=l.createCommandEncoder();m.copyTextureToBuffer({texture:u,origin:{x:n,y:i,z:a}},{buffer:p,bytesPerRow:d},{width:s,height:o});const g=this._getTypedArrayType(h);l.queue.submit([m.finish()]),await p.mapAsync(GPUMapMode.READ);const v=p.getMappedRange();return new g(v)}_isEnvironmentTexture(e){const n=e.mapping;return n===dd||n===pd||n===tl||n===nl}_getDefaultTextureGPU(e){let n=this.defaultTexture[e];if(n===void 0){const i=new ui;i.minFilter=jn,i.magFilter=jn,this.createTexture(i,{width:1,height:1,format:e}),this.defaultTexture[e]=n=i}return this.backend.get(n).texture}_getDefaultCubeTextureGPU(e){let n=this.defaultTexture[e];if(n===void 0){const i=new ZM;i.minFilter=jn,i.magFilter=jn,this.createTexture(i,{width:1,height:1,depth:6}),this.defaultCubeTexture[e]=n=i}return this.backend.get(n).texture}_getDefaultVideoFrame(){let e=this.defaultVideoFrame;if(e===null){const n={timestamp:0,codedWidth:1,codedHeight:1,format:"RGBA"};this.defaultVideoFrame=e=new VideoFrame(new Uint8Array([0,0,0,255]),n)}return e}_copyCubeMapToTexture(e,n,i,s){for(let o=0;o<6;o++){const a=e[o],l=s===!0?IFe[o]:o;a.isDataTexture?this._copyBufferToTexture(a.image,n,i,l,s):this._copyImageToTexture(a,n,i,l,s)}}_copyImageToTexture(e,n,i,s,o){this.backend.device.queue.copyExternalImageToTexture({source:e,flipY:o},{texture:n,mipLevel:0,origin:{x:0,y:0,z:s}},{width:e.width,height:e.height,depthOrArrayLayers:1})}_getPassUtils(){let e=this._passUtils;return e===null&&(this._passUtils=e=new DFe(this.backend.device)),e}_generateMipmaps(e,n,i=0){this._getPassUtils().generateMipmaps(e,n,i)}_flipY(e,n,i=0){this._getPassUtils().flipY(e,n,i)}_copyBufferToTexture(e,n,i,s,o,a=0){const l=this.backend.device,c=e.data,u=this._getBytesPerTexel(i.format),h=e.width*u;l.queue.writeTexture({texture:n,mipLevel:0,origin:{x:0,y:0,z:s}},c,{offset:e.width*e.height*u*a,bytesPerRow:h},{width:e.width,height:e.height,depthOrArrayLayers:1}),o===!0&&this._flipY(n,i,s)}_copyCompressedBufferToTexture(e,n,i){const s=this.backend.device,o=this._getBlockData(i.format),a=i.size.depthOrArrayLayers>1;for(let l=0;l<e.length;l++){const c=e[l],u=c.width,h=c.height,f=a?i.size.depthOrArrayLayers:1,d=Math.ceil(u/o.width)*o.byteLength,p=d*Math.ceil(h/o.height);for(let m=0;m<f;m++)s.queue.writeTexture({texture:n,mipLevel:l,origin:{x:0,y:0,z:m}},c.data,{offset:m*p,bytesPerRow:d,rowsPerImage:Math.ceil(h/o.height)},{width:Math.ceil(u/o.width)*o.width,height:Math.ceil(h/o.height)*o.height,depthOrArrayLayers:1})}}_getBlockData(e){if(e===re.BC1RGBAUnorm||e===re.BC1RGBAUnormSRGB)return{byteLength:8,width:4,height:4};if(e===re.BC2RGBAUnorm||e===re.BC2RGBAUnormSRGB)return{byteLength:16,width:4,height:4};if(e===re.BC3RGBAUnorm||e===re.BC3RGBAUnormSRGB)return{byteLength:16,width:4,height:4};if(e===re.BC4RUnorm||e===re.BC4RSnorm)return{byteLength:8,width:4,height:4};if(e===re.BC5RGUnorm||e===re.BC5RGSnorm)return{byteLength:16,width:4,height:4};if(e===re.BC6HRGBUFloat||e===re.BC6HRGBFloat)return{byteLength:16,width:4,height:4};if(e===re.BC7RGBAUnorm||e===re.BC7RGBAUnormSRGB)return{byteLength:16,width:4,height:4};if(e===re.ETC2RGB8Unorm||e===re.ETC2RGB8UnormSRGB)return{byteLength:8,width:4,height:4};if(e===re.ETC2RGB8A1Unorm||e===re.ETC2RGB8A1UnormSRGB)return{byteLength:8,width:4,height:4};if(e===re.ETC2RGBA8Unorm||e===re.ETC2RGBA8UnormSRGB)return{byteLength:16,width:4,height:4};if(e===re.EACR11Unorm)return{byteLength:8,width:4,height:4};if(e===re.EACR11Snorm)return{byteLength:8,width:4,height:4};if(e===re.EACRG11Unorm)return{byteLength:16,width:4,height:4};if(e===re.EACRG11Snorm)return{byteLength:16,width:4,height:4};if(e===re.ASTC4x4Unorm||e===re.ASTC4x4UnormSRGB)return{byteLength:16,width:4,height:4};if(e===re.ASTC5x4Unorm||e===re.ASTC5x4UnormSRGB)return{byteLength:16,width:5,height:4};if(e===re.ASTC5x5Unorm||e===re.ASTC5x5UnormSRGB)return{byteLength:16,width:5,height:5};if(e===re.ASTC6x5Unorm||e===re.ASTC6x5UnormSRGB)return{byteLength:16,width:6,height:5};if(e===re.ASTC6x6Unorm||e===re.ASTC6x6UnormSRGB)return{byteLength:16,width:6,height:6};if(e===re.ASTC8x5Unorm||e===re.ASTC8x5UnormSRGB)return{byteLength:16,width:8,height:5};if(e===re.ASTC8x6Unorm||e===re.ASTC8x6UnormSRGB)return{byteLength:16,width:8,height:6};if(e===re.ASTC8x8Unorm||e===re.ASTC8x8UnormSRGB)return{byteLength:16,width:8,height:8};if(e===re.ASTC10x5Unorm||e===re.ASTC10x5UnormSRGB)return{byteLength:16,width:10,height:5};if(e===re.ASTC10x6Unorm||e===re.ASTC10x6UnormSRGB)return{byteLength:16,width:10,height:6};if(e===re.ASTC10x8Unorm||e===re.ASTC10x8UnormSRGB)return{byteLength:16,width:10,height:8};if(e===re.ASTC10x10Unorm||e===re.ASTC10x10UnormSRGB)return{byteLength:16,width:10,height:10};if(e===re.ASTC12x10Unorm||e===re.ASTC12x10UnormSRGB)return{byteLength:16,width:12,height:10};if(e===re.ASTC12x12Unorm||e===re.ASTC12x12UnormSRGB)return{byteLength:16,width:12,height:12}}_convertAddressMode(e){let n=ON.ClampToEdge;return e===gd?n=ON.Repeat:e===yd&&(n=ON.MirrorRepeat),n}_convertFilterMode(e){let n=Lf.Linear;return(e===jn||e===xF||e===Dc)&&(n=Lf.Nearest),n}_getBytesPerTexel(e){if(e===re.R8Unorm||e===re.R8Snorm||e===re.R8Uint||e===re.R8Sint)return 1;if(e===re.R16Uint||e===re.R16Sint||e===re.R16Float||e===re.RG8Unorm||e===re.RG8Snorm||e===re.RG8Uint||e===re.RG8Sint)return 2;if(e===re.R32Uint||e===re.R32Sint||e===re.R32Float||e===re.RG16Uint||e===re.RG16Sint||e===re.RG16Float||e===re.RGBA8Unorm||e===re.RGBA8UnormSRGB||e===re.RGBA8Snorm||e===re.RGBA8Uint||e===re.RGBA8Sint||e===re.BGRA8Unorm||e===re.BGRA8UnormSRGB||e===re.RGB9E5UFloat||e===re.RGB10A2Unorm||e===re.RG11B10UFloat||e===re.Depth32Float||e===re.Depth24Plus||e===re.Depth24PlusStencil8||e===re.Depth32FloatStencil8)return 4;if(e===re.RG32Uint||e===re.RG32Sint||e===re.RG32Float||e===re.RGBA16Uint||e===re.RGBA16Sint||e===re.RGBA16Float)return 8;if(e===re.RGBA32Uint||e===re.RGBA32Sint||e===re.RGBA32Float)return 16}_getTypedArrayType(e){if(e===re.R8Uint)return Uint8Array;if(e===re.R8Sint)return Int8Array;if(e===re.R8Unorm)return Uint8Array;if(e===re.R8Snorm)return Int8Array;if(e===re.RG8Uint)return Uint8Array;if(e===re.RG8Sint)return Int8Array;if(e===re.RG8Unorm)return Uint8Array;if(e===re.RG8Snorm)return Int8Array;if(e===re.RGBA8Uint)return Uint8Array;if(e===re.RGBA8Sint)return Int8Array;if(e===re.RGBA8Unorm)return Uint8Array;if(e===re.RGBA8Snorm)return Int8Array;if(e===re.R16Uint)return Uint16Array;if(e===re.R16Sint)return Int16Array;if(e===re.RG16Uint)return Uint16Array;if(e===re.RG16Sint)return Int16Array;if(e===re.RGBA16Uint)return Uint16Array;if(e===re.RGBA16Sint)return Int16Array;if(e===re.R16Float||e===re.RG16Float||e===re.RGBA16Float)return Uint16Array;if(e===re.R32Uint)return Uint32Array;if(e===re.R32Sint)return Int32Array;if(e===re.R32Float)return Float32Array;if(e===re.RG32Uint)return Uint32Array;if(e===re.RG32Sint)return Int32Array;if(e===re.RG32Float)return Float32Array;if(e===re.RGBA32Uint)return Uint32Array;if(e===re.RGBA32Sint)return Int32Array;if(e===re.RGBA32Float)return Float32Array;if(e===re.BGRA8Unorm||e===re.BGRA8UnormSRGB)return Uint8Array;if(e===re.RGB10A2Unorm||e===re.RGB9E5UFloat||e===re.RG11B10UFloat)return Uint32Array;if(e===re.Depth32Float)return Float32Array;if(e===re.Depth24Plus||e===re.Depth24PlusStencil8)return Uint32Array;if(e===re.Depth32FloatStencil8)return Float32Array}_getDimension(e){let n;return e.isData3DTexture?n=J5.ThreeD:n=J5.TwoD,n}}function RD(r,e=null){const n=r.format,i=r.type,s=r.colorSpace;let o;if(r.isCompressedTexture===!0||r.isCompressedArrayTexture===!0)switch(n){case yh:o=s===vt?re.BC1RGBAUnormSRGB:re.BC1RGBAUnorm;break;case vh:o=s===vt?re.BC2RGBAUnormSRGB:re.BC2RGBAUnorm;break;case xh:o=s===vt?re.BC3RGBAUnormSRGB:re.BC3RGBAUnorm;break;case ng:o=s===vt?re.ETC2RGB8UnormSRGB:re.ETC2RGB8Unorm;break;case rg:o=s===vt?re.ETC2RGBA8UnormSRGB:re.ETC2RGBA8Unorm;break;case ig:o=s===vt?re.ASTC4x4UnormSRGB:re.ASTC4x4Unorm;break;case sg:o=s===vt?re.ASTC5x4UnormSRGB:re.ASTC5x4Unorm;break;case og:o=s===vt?re.ASTC5x5UnormSRGB:re.ASTC5x5Unorm;break;case ag:o=s===vt?re.ASTC6x5UnormSRGB:re.ASTC6x5Unorm;break;case lg:o=s===vt?re.ASTC6x6UnormSRGB:re.ASTC6x6Unorm;break;case cg:o=s===vt?re.ASTC8x5UnormSRGB:re.ASTC8x5Unorm;break;case ug:o=s===vt?re.ASTC8x6UnormSRGB:re.ASTC8x6Unorm;break;case hg:o=s===vt?re.ASTC8x8UnormSRGB:re.ASTC8x8Unorm;break;case fg:o=s===vt?re.ASTC10x5UnormSRGB:re.ASTC10x5Unorm;break;case dg:o=s===vt?re.ASTC10x6UnormSRGB:re.ASTC10x6Unorm;break;case pg:o=s===vt?re.ASTC10x8UnormSRGB:re.ASTC10x8Unorm;break;case mg:o=s===vt?re.ASTC10x10UnormSRGB:re.ASTC10x10Unorm;break;case gg:o=s===vt?re.ASTC12x10UnormSRGB:re.ASTC12x10Unorm;break;case yg:o=s===vt?re.ASTC12x12UnormSRGB:re.ASTC12x12Unorm;break;case Tr:o=s===vt?re.RGBA8UnormSRGB:re.RGBA8Unorm;break;default:console.error("WebGPURenderer: Unsupported texture format.",n)}else switch(n){case Tr:switch(i){case Jf:o=re.RGBA8Snorm;break;case ed:o=re.RGBA16Sint;break;case qa:o=re.RGBA16Uint;break;case In:o=re.RGBA32Uint;break;case Si:o=re.RGBA32Sint;break;case gr:o=s===vt?re.RGBA8UnormSRGB:re.RGBA8Unorm;break;case Ei:o=re.RGBA16Float;break;case Nr:o=re.RGBA32Float;break;default:console.error("WebGPURenderer: Unsupported texture type with RGBAFormat.",i)}break;case u_:switch(i){case WM:o=re.RGB9E5UFloat;break;default:console.error("WebGPURenderer: Unsupported texture type with RGBFormat.",i)}break;case h_:switch(i){case Jf:o=re.R8Snorm;break;case ed:o=re.R16Sint;break;case qa:o=re.R16Uint;break;case In:o=re.R32Uint;break;case Si:o=re.R32Sint;break;case gr:o=re.R8Unorm;break;case Ei:o=re.R16Float;break;case Nr:o=re.R32Float;break;default:console.error("WebGPURenderer: Unsupported texture type with RedFormat.",i)}break;case kc:switch(i){case Jf:o=re.RG8Snorm;break;case ed:o=re.RG16Sint;break;case qa:o=re.RG16Uint;break;case In:o=re.RG32Uint;break;case Si:o=re.RG32Sint;break;case gr:o=re.RG8Unorm;break;case Ei:o=re.RG16Float;break;case Nr:o=re.RG32Float;break;default:console.error("WebGPURenderer: Unsupported texture type with RGFormat.",i)}break;case Oo:switch(i){case qa:o=re.Depth16Unorm;break;case In:o=re.Depth24Plus;break;case Nr:o=re.Depth32Float;break;default:console.error("WebGPURenderer: Unsupported texture type with DepthFormat.",i)}break;case Do:switch(i){case No:o=re.Depth24PlusStencil8;break;case Nr:e&&e.features.has(PD.Depth32FloatStencil8)===!1&&console.error('WebGPURenderer: Depth textures with DepthStencilFormat + FloatType can only be used with the "depth32float-stencil8" GPU feature.'),o=re.Depth32FloatStencil8;break;default:console.error("WebGPURenderer: Unsupported texture type with DepthStencilFormat.",i)}break;case gy:switch(i){case Si:o=re.R32Sint;break;case In:o=re.R32Uint;break;default:console.error("WebGPURenderer: Unsupported texture type with RedIntegerFormat.",i)}break;case yy:switch(i){case Si:o=re.RG32Sint;break;case In:o=re.RG32Uint;break;default:console.error("WebGPURenderer: Unsupported texture type with RGIntegerFormat.",i)}break;case vy:switch(i){case Si:o=re.RGBA32Sint;break;case In:o=re.RGBA32Uint;break;default:console.error("WebGPURenderer: Unsupported texture type with RGBAIntegerFormat.",i)}break;default:console.error("WebGPURenderer: Unsupported texture format.",n)}return o}const FFe=/^[fn]*\s*([a-z_0-9]+)?\s*\(([\s\S]*?)\)\s*[\-\>]*\s*([a-z_0-9]+(?:<[\s\S]+?>)?)/i,BFe=/([a-z_0-9]+)\s*:\s*([a-z_0-9]+(?:<[\s\S]+?>)?)/ig,eH={f32:"float",i32:"int",u32:"uint",bool:"bool","vec2<f32>":"vec2","vec2<i32>":"ivec2","vec2<u32>":"uvec2","vec2<bool>":"bvec2",vec2f:"vec2",vec2i:"ivec2",vec2u:"uvec2",vec2b:"bvec2","vec3<f32>":"vec3","vec3<i32>":"ivec3","vec3<u32>":"uvec3","vec3<bool>":"bvec3",vec3f:"vec3",vec3i:"ivec3",vec3u:"uvec3",vec3b:"bvec3","vec4<f32>":"vec4","vec4<i32>":"ivec4","vec4<u32>":"uvec4","vec4<bool>":"bvec4",vec4f:"vec4",vec4i:"ivec4",vec4u:"uvec4",vec4b:"bvec4","mat2x2<f32>":"mat2",mat2x2f:"mat2","mat3x3<f32>":"mat3",mat3x3f:"mat3","mat4x4<f32>":"mat4",mat4x4f:"mat4",sampler:"sampler",texture_1d:"texture",texture_2d:"texture",texture_2d_array:"texture",texture_multisampled_2d:"cubeTexture",texture_depth_2d:"depthTexture",texture_depth_2d_array:"depthTexture",texture_depth_multisampled_2d:"depthTexture",texture_depth_cube:"depthTexture",texture_depth_cube_array:"depthTexture",texture_3d:"texture3D",texture_cube:"cubeTexture",texture_cube_array:"cubeTexture",texture_storage_1d:"storageTexture",texture_storage_2d:"storageTexture",texture_storage_2d_array:"storageTexture",texture_storage_3d:"storageTexture"},UFe=r=>{r=r.trim();const e=r.match(FFe);if(e!==null&&e.length===4){const n=e[2],i=[];let s=null;for(;(s=BFe.exec(n))!==null;)i.push({name:s[1],type:s[2]});const o=[];for(let h=0;h<i.length;h++){const{name:f,type:d}=i[h];let p=d;p.startsWith("ptr")?p="pointer":(p.startsWith("texture")&&(p=d.split("<")[0]),p=eH[p]),o.push(new Y3(p,f))}const a=r.substring(e[0].length),l=e[3]||"void",c=e[1]!==void 0?e[1]:"";return{type:eH[l]||l,inputs:o,name:c,inputsCode:n,blockCode:a,outputType:l}}else throw new Error("FunctionNode: Function is not a WGSL code.")};class zFe extends Z3{constructor(e){const{type:n,inputs:i,name:s,inputsCode:o,blockCode:a,outputType:l}=UFe(e);super(n,i,s),this.inputsCode=o,this.blockCode=a,this.outputType=l}getCode(e=this.name){const n=this.outputType!=="void"?"-> "+this.outputType:"";return`fn ${e} ( ${this.inputsCode.trim()} ) ${n}`+this.blockCode}}class $Fe extends pee{parseFunction(e){return new zFe(e)}}const Rp=typeof self<"u"?self.GPUShaderStage:{VERTEX:1,FRAGMENT:2,COMPUTE:4},jFe={[Bc.READ_ONLY]:"read",[Bc.WRITE_ONLY]:"write",[Bc.READ_WRITE]:"read_write"},tH={[gd]:"repeat",[Tl]:"clamp",[yd]:"mirror"},$S={vertex:Rp?Rp.VERTEX:1,fragment:Rp?Rp.FRAGMENT:2,compute:Rp?Rp.COMPUTE:4},nH={instance:!0,swizzleAssign:!1,storageBuffer:!0},VFe={"^^":"tsl_xor"},GFe={float:"f32",int:"i32",uint:"u32",bool:"bool",color:"vec3<f32>",vec2:"vec2<f32>",ivec2:"vec2<i32>",uvec2:"vec2<u32>",bvec2:"vec2<bool>",vec3:"vec3<f32>",ivec3:"vec3<i32>",uvec3:"vec3<u32>",bvec3:"vec3<bool>",vec4:"vec4<f32>",ivec4:"vec4<i32>",uvec4:"vec4<u32>",bvec4:"vec4<bool>",mat2:"mat2x2<f32>",mat3:"mat3x3<f32>",mat4:"mat4x4<f32>"},rH={},Yo={tsl_xor:new si("fn tsl_xor( a : bool, b : bool ) -> bool { return ( a || b ) && !( a && b ); }"),mod_float:new si("fn tsl_mod_float( x : f32, y : f32 ) -> f32 { return x - y * floor( x / y ); }"),mod_vec2:new si("fn tsl_mod_vec2( x : vec2f, y : vec2f ) -> vec2f { return x - y * floor( x / y ); }"),mod_vec3:new si("fn tsl_mod_vec3( x : vec3f, y : vec3f ) -> vec3f { return x - y * floor( x / y ); }"),mod_vec4:new si("fn tsl_mod_vec4( x : vec4f, y : vec4f ) -> vec4f { return x - y * floor( x / y ); }"),equals_bool:new si("fn tsl_equals_bool( a : bool, b : bool ) -> bool { return a == b; }"),equals_bvec2:new si("fn tsl_equals_bvec2( a : vec2f, b : vec2f ) -> vec2<bool> { return vec2<bool>( a.x == b.x, a.y == b.y ); }"),equals_bvec3:new si("fn tsl_equals_bvec3( a : vec3f, b : vec3f ) -> vec3<bool> { return vec3<bool>( a.x == b.x, a.y == b.y, a.z == b.z ); }"),equals_bvec4:new si("fn tsl_equals_bvec4( a : vec4f, b : vec4f ) -> vec4<bool> { return vec4<bool>( a.x == b.x, a.y == b.y, a.z == b.z, a.w == b.w ); }"),repeatWrapping_float:new si("fn tsl_repeatWrapping_float( coord: f32 ) -> f32 { return fract( coord ); }"),mirrorWrapping_float:new si("fn tsl_mirrorWrapping_float( coord: f32 ) -> f32 { let mirrored = fract( coord * 0.5 ) * 2.0; return 1.0 - abs( 1.0 - mirrored ); }"),clampWrapping_float:new si("fn tsl_clampWrapping_float( coord: f32 ) -> f32 { return clamp( coord, 0.0, 1.0 ); }"),biquadraticTexture:new si(`
fn tsl_biquadraticTexture( map : texture_2d<f32>, coord : vec2f, iRes : vec2u, level : u32 ) -> vec4f {

	let res = vec2f( iRes );

	let uvScaled = coord * res;
	let uvWrapping = ( ( uvScaled % res ) + res ) % res;

	// https://www.shadertoy.com/view/WtyXRy

	let uv = uvWrapping - 0.5;
	let iuv = floor( uv );
	let f = fract( uv );

	let rg1 = textureLoad( map, vec2u( iuv + vec2( 0.5, 0.5 ) ) % iRes, level );
	let rg2 = textureLoad( map, vec2u( iuv + vec2( 1.5, 0.5 ) ) % iRes, level );
	let rg3 = textureLoad( map, vec2u( iuv + vec2( 0.5, 1.5 ) ) % iRes, level );
	let rg4 = textureLoad( map, vec2u( iuv + vec2( 1.5, 1.5 ) ) % iRes, level );

	return mix( mix( rg1, rg2, f.x ), mix( rg3, rg4, f.x ), f.y );

}
`)},f0={dFdx:"dpdx",dFdy:"- dpdy",mod_float:"tsl_mod_float",mod_vec2:"tsl_mod_vec2",mod_vec3:"tsl_mod_vec3",mod_vec4:"tsl_mod_vec4",equals_bool:"tsl_equals_bool",equals_bvec2:"tsl_equals_bvec2",equals_bvec3:"tsl_equals_bvec3",equals_bvec4:"tsl_equals_bvec4",inversesqrt:"inverseSqrt",bitcast:"bitcast<f32>"};typeof navigator<"u"&&/Windows/g.test(navigator.userAgent)&&(Yo.pow_float=new si("fn tsl_pow_float( a : f32, b : f32 ) -> f32 { return select( -pow( -a, b ), pow( a, b ), a > 0.0 ); }"),Yo.pow_vec2=new si("fn tsl_pow_vec2( a : vec2f, b : vec2f ) -> vec2f { return vec2f( tsl_pow_float( a.x, b.x ), tsl_pow_float( a.y, b.y ) ); }",[Yo.pow_float]),Yo.pow_vec3=new si("fn tsl_pow_vec3( a : vec3f, b : vec3f ) -> vec3f { return vec3f( tsl_pow_float( a.x, b.x ), tsl_pow_float( a.y, b.y ), tsl_pow_float( a.z, b.z ) ); }",[Yo.pow_float]),Yo.pow_vec4=new si("fn tsl_pow_vec4( a : vec4f, b : vec4f ) -> vec4f { return vec4f( tsl_pow_float( a.x, b.x ), tsl_pow_float( a.y, b.y ), tsl_pow_float( a.z, b.z ), tsl_pow_float( a.w, b.w ) ); }",[Yo.pow_float]),f0.pow_float="tsl_pow_float",f0.pow_vec2="tsl_pow_vec2",f0.pow_vec3="tsl_pow_vec3",f0.pow_vec4="tsl_pow_vec4");let Tee="";(typeof navigator<"u"&&/Firefox|Deno/g.test(navigator.userAgent))!==!0&&(Tee+=`diagnostic( off, derivative_uniformity );
`);class HFe extends fee{constructor(e,n){super(e,n,new $Fe),this.uniformGroups={},this.builtins={},this.directives={},this.scopedArrays=new Map}needsToWorkingColorSpace(e){return e.isVideoTexture===!0&&e.colorSpace!==Eo}_generateTextureSample(e,n,i,s,o=this.shaderStage){return o==="fragment"?s?`textureSample( ${n}, ${n}_sampler, ${i}, ${s} )`:`textureSample( ${n}, ${n}_sampler, ${i} )`:this.isFilteredTexture(e)?this.generateFilteredTexture(e,n,i):this.generateTextureLod(e,n,i,s,"0")}_generateVideoSample(e,n,i=this.shaderStage){if(i==="fragment")return`textureSampleBaseClampToEdge( ${e}, ${e}_sampler, vec2<f32>( ${n}.x, 1.0 - ${n}.y ) )`;console.error(`WebGPURenderer: THREE.VideoTexture does not support ${i} shader.`)}_generateTextureSampleLevel(e,n,i,s,o,a=this.shaderStage){return(a==="fragment"||a==="compute")&&this.isUnfilterable(e)===!1?`textureSampleLevel( ${n}, ${n}_sampler, ${i}, ${s} )`:this.isFilteredTexture(e)?this.generateFilteredTexture(e,n,i,s):this.generateTextureLod(e,n,i,o,s)}generateWrapFunction(e){const n=`tsl_coord_${tH[e.wrapS]}S_${tH[e.wrapT]}_${e.isData3DTexture?"3d":"2d"}T`;let i=rH[n];if(i===void 0){const s=[],o=e.isData3DTexture?"vec3f":"vec2f";let a=`fn ${n}( coord : ${o} ) -> ${o} {

	return ${o}(
`;const l=(c,u)=>{c===gd?(s.push(Yo.repeatWrapping_float),a+=`		tsl_repeatWrapping_float( coord.${u} )`):c===Tl?(s.push(Yo.clampWrapping_float),a+=`		tsl_clampWrapping_float( coord.${u} )`):c===yd?(s.push(Yo.mirrorWrapping_float),a+=`		tsl_mirrorWrapping_float( coord.${u} )`):(a+=`		coord.${u}`,console.warn(`WebGPURenderer: Unsupported texture wrap type "${c}" for vertex shader.`))};l(e.wrapS,"x"),a+=`,
`,l(e.wrapT,"y"),e.isData3DTexture&&(a+=`,
`,l(e.wrapR,"z")),a+=`
	);

}
`,rH[n]=i=new si(a,s)}return i.build(this),n}generateArrayDeclaration(e,n){return`array< ${this.getType(e)}, ${n} >`}generateTextureDimension(e,n,i){const s=this.getDataFromNode(e,this.shaderStage,this.globalCache);s.dimensionsSnippet===void 0&&(s.dimensionsSnippet={});let o=s.dimensionsSnippet[i];if(s.dimensionsSnippet[i]===void 0){let a,l;const{primarySamples:c}=this.renderer.backend.utils.getTextureSampleData(e),u=c>1;e.isData3DTexture?l="vec3<u32>":l="vec2<u32>",u||e.isVideoTexture||e.isStorageTexture?a=n:a=`${n}${i?`, u32( ${i} )`:""}`,o=new F1(new U1(`textureDimensions( ${a} )`,l)),s.dimensionsSnippet[i]=o,(e.isDataArrayTexture||e.isDepthArrayTexture||e.isData3DTexture)&&(s.arrayLayerCount=new F1(new U1(`textureNumLayers(${n})`,"u32"))),e.isTextureCube&&(s.cubeFaceCount=new F1(new U1("6u","u32")))}return o.build(this)}generateFilteredTexture(e,n,i,s="0u"){this._include("biquadraticTexture");const o=this.generateWrapFunction(e),a=this.generateTextureDimension(e,n,s);return`tsl_biquadraticTexture( ${n}, ${o}( ${i} ), ${a}, u32( ${s} ) )`}generateTextureLod(e,n,i,s,o="0u"){const a=this.generateWrapFunction(e),l=this.generateTextureDimension(e,n,o),c=e.isData3DTexture?"vec3":"vec2",u=`${c}<u32>( ${a}( ${i} ) * ${c}<f32>( ${l} ) )`;return this.generateTextureLoad(e,n,u,s,o)}generateTextureLoad(e,n,i,s,o="0u"){let a;return e.isVideoTexture===!0||e.isStorageTexture===!0?a=`textureLoad( ${n}, ${i} )`:s?a=`textureLoad( ${n}, ${i}, ${s}, u32( ${o} ) )`:(a=`textureLoad( ${n}, ${i}, u32( ${o} ) )`,this.renderer.backend.compatibilityMode&&e.isDepthTexture&&(a+=".x")),a}generateTextureStore(e,n,i,s){return`textureStore( ${n}, ${i}, ${s} )`}isSampleCompare(e){return e.isDepthTexture===!0&&e.compareFunction!==null}isUnfilterable(e){return this.getComponentTypeFromTexture(e)!=="float"||!this.isAvailable("float32Filterable")&&e.isDataTexture===!0&&e.type===Nr||this.isSampleCompare(e)===!1&&e.minFilter===jn&&e.magFilter===jn||this.renderer.backend.utils.getTextureSampleData(e).primarySamples>1}generateTexture(e,n,i,s,o=this.shaderStage){let a=null;return e.isVideoTexture===!0?a=this._generateVideoSample(n,i,o):this.isUnfilterable(e)?a=this.generateTextureLod(e,n,i,s,"0",o):a=this._generateTextureSample(e,n,i,s,o),a}generateTextureGrad(e,n,i,s,o,a=this.shaderStage){if(a==="fragment")return`textureSampleGrad( ${n}, ${n}_sampler, ${i},  ${s[0]}, ${s[1]} )`;console.error(`WebGPURenderer: THREE.TextureNode.gradient() does not support ${a} shader.`)}generateTextureCompare(e,n,i,s,o,a=this.shaderStage){if(a==="fragment")return e.isDepthArrayTexture?`textureSampleCompare( ${n}, ${n}_sampler, ${i}, ${o}, ${s} )`:`textureSampleCompare( ${n}, ${n}_sampler, ${i}, ${s} )`;console.error(`WebGPURenderer: THREE.DepthTexture.compareFunction() does not support ${a} shader.`)}generateTextureLevel(e,n,i,s,o,a=this.shaderStage){let l=null;return e.isVideoTexture===!0?l=this._generateVideoSample(n,i,a):l=this._generateTextureSampleLevel(e,n,i,s,o,a),l}generateTextureBias(e,n,i,s,o,a=this.shaderStage){if(a==="fragment")return`textureSampleBias( ${n}, ${n}_sampler, ${i}, ${s} )`;console.error(`WebGPURenderer: THREE.TextureNode.biasNode does not support ${a} shader.`)}getPropertyName(e,n=this.shaderStage){if(e.isNodeVarying===!0&&e.needsInterpolation===!0){if(n==="vertex")return`varyings.${e.name}`}else if(e.isNodeUniform===!0){const i=e.name,s=e.type;return s==="texture"||s==="cubeTexture"||s==="storageTexture"||s==="texture3D"?i:s==="buffer"||s==="storageBuffer"||s==="indirectStorageBuffer"?this.isCustomStruct(e)?i:i+".value":e.groupNode.name+"."+i}return super.getPropertyName(e)}getOutputStructName(){return"output"}getFunctionOperator(e){const n=VFe[e];return n!==void 0?(this._include(n),n):null}getNodeAccess(e,n){return n!=="compute"?Bc.READ_ONLY:e.access}getStorageAccess(e,n){return jFe[this.getNodeAccess(e,n)]}getUniformFromNode(e,n,i,s=null){const o=super.getUniformFromNode(e,n,i,s),a=this.getDataFromNode(e,i,this.globalCache);if(a.uniformGPU===void 0){let l;const c=e.groupNode,u=c.name,h=this.getBindGroupArray(u,i);if(n==="texture"||n==="cubeTexture"||n==="storageTexture"||n==="texture3D"){let f=null;const d=this.getNodeAccess(e,i);if(n==="texture"||n==="storageTexture"?f=new AA(o.name,o.node,c,d):n==="cubeTexture"?f=new bee(o.name,o.node,c,d):n==="texture3D"&&(f=new _ee(o.name,o.node,c,d)),f.store=e.isStorageTextureNode===!0,f.setVisibility($S[i]),(i==="fragment"||i==="compute")&&this.isUnfilterable(e.value)===!1&&f.store===!1){const p=new PFe(`${o.name}_sampler`,o.node,c);p.setVisibility($S[i]),h.push(p,f),l=[p,f]}else h.push(f),l=[f]}else if(n==="buffer"||n==="storageBuffer"||n==="indirectStorageBuffer"){const f=n==="buffer"?vee:OFe,d=new f(e,c);d.setVisibility($S[i]),h.push(d),l=d,o.name=s||"NodeBuffer_"+o.id}else{const f=this.uniformGroups[i]||(this.uniformGroups[i]={});let d=f[u];d===void 0&&(d=new xee(u,c),d.setVisibility($S[i]),f[u]=d,h.push(d)),l=this.getNodeUniform(o,n),d.addUniform(l)}a.uniformGPU=l}return o}getBuiltin(e,n,i,s=this.shaderStage){const o=this.builtins[s]||(this.builtins[s]=new Map);return o.has(e)===!1&&o.set(e,{name:e,property:n,type:i}),n}hasBuiltin(e,n=this.shaderStage){return this.builtins[n]!==void 0&&this.builtins[n].has(e)}getVertexIndex(){return this.shaderStage==="vertex"?this.getBuiltin("vertex_index","vertexIndex","u32","attribute"):"vertexIndex"}buildFunctionCode(e){const n=e.layout,i=this.flowShaderNode(e),s=[];for(const a of n.inputs)s.push(a.name+" : "+this.getType(a.type));let o=`fn ${n.name}( ${s.join(", ")} ) -> ${this.getType(n.type)} {
${i.vars}
${i.code}
`;return i.result&&(o+=`	return ${i.result};
`),o+=`
}
`,o}getInstanceIndex(){return this.shaderStage==="vertex"?this.getBuiltin("instance_index","instanceIndex","u32","attribute"):"instanceIndex"}getInvocationLocalIndex(){return this.getBuiltin("local_invocation_index","invocationLocalIndex","u32","attribute")}getSubgroupSize(){return this.enableSubGroups(),this.getBuiltin("subgroup_size","subgroupSize","u32","attribute")}getInvocationSubgroupIndex(){return this.enableSubGroups(),this.getBuiltin("subgroup_invocation_id","invocationSubgroupIndex","u32","attribute")}getSubgroupIndex(){return this.enableSubGroups(),this.getBuiltin("subgroup_id","subgroupIndex","u32","attribute")}getDrawIndex(){return null}getFrontFacing(){return this.getBuiltin("front_facing","isFront","bool")}getFragCoord(){return this.getBuiltin("position","fragCoord","vec4<f32>")+".xy"}getFragDepth(){return"output."+this.getBuiltin("frag_depth","depth","f32","output")}getClipDistance(){return"varyings.hw_clip_distances"}isFlipY(){return!1}enableDirective(e,n=this.shaderStage){(this.directives[n]||(this.directives[n]=new Set)).add(e)}getDirectives(e){const n=[],i=this.directives[e];if(i!==void 0)for(const s of i)n.push(`enable ${s};`);return n.join(`
`)}enableSubGroups(){this.enableDirective("subgroups")}enableSubgroupsF16(){this.enableDirective("subgroups-f16")}enableClipDistances(){this.enableDirective("clip_distances")}enableShaderF16(){this.enableDirective("f16")}enableDualSourceBlending(){this.enableDirective("dual_source_blending")}enableHardwareClipping(e){this.enableClipDistances(),this.getBuiltin("clip_distances","hw_clip_distances",`array<f32, ${e} >`,"vertex")}getBuiltins(e){const n=[],i=this.builtins[e];if(i!==void 0)for(const{name:s,property:o,type:a}of i.values())n.push(`@builtin( ${s} ) ${o} : ${a}`);return n.join(`,
	`)}getScopedArray(e,n,i,s){return this.scopedArrays.has(e)===!1&&this.scopedArrays.set(e,{name:e,scope:n,bufferType:i,bufferCount:s}),e}getScopedArrays(e){if(e!=="compute")return;const n=[];for(const{name:i,scope:s,bufferType:o,bufferCount:a}of this.scopedArrays.values()){const l=this.getType(o);n.push(`var<${s}> ${i}: array< ${l}, ${a} >;`)}return n.join(`
`)}getAttributes(e){const n=[];if(e==="compute"&&(this.getBuiltin("global_invocation_id","globalId","vec3<u32>","attribute"),this.getBuiltin("workgroup_id","workgroupId","vec3<u32>","attribute"),this.getBuiltin("local_invocation_id","localId","vec3<u32>","attribute"),this.getBuiltin("num_workgroups","numWorkgroups","vec3<u32>","attribute"),this.renderer.hasFeature("subgroups")&&(this.enableDirective("subgroups",e),this.getBuiltin("subgroup_size","subgroupSize","u32","attribute"))),e==="vertex"||e==="compute"){const i=this.getBuiltins("attribute");i&&n.push(i);const s=this.getAttributesArray();for(let o=0,a=s.length;o<a;o++){const l=s[o],c=l.name,u=this.getType(l.type);n.push(`@location( ${o} ) ${c} : ${u}`)}}return n.join(`,
	`)}getStructMembers(e){const n=[];for(const i of e.members){const s=e.output?"@location( "+i.index+" ) ":"";let o=this.getType(i.type);i.atomic&&(o="atomic< "+o+" >"),n.push(`	${s+i.name} : ${o}`)}return e.output&&n.push(`	${this.getBuiltins("output")}`),n.join(`,
`)}getStructs(e){let n="";const i=this.structs[e];if(i.length>0){const s=[];for(const o of i){let a=`struct ${o.name} {
`;a+=this.getStructMembers(o),a+=`
};`,s.push(a)}n=`
`+s.join(`

`)+`
`}return n}getVar(e,n,i=null){let s=`var ${n} : `;return i!==null?s+=this.generateArrayDeclaration(e,i):s+=this.getType(e),s}getVars(e){const n=[],i=this.vars[e];if(i!==void 0)for(const s of i)n.push(`	${this.getVar(s.type,s.name,s.count)};`);return`
${n.join(`
`)}
`}getVaryings(e){const n=[];if(e==="vertex"&&this.getBuiltin("position","Vertex","vec4<f32>","vertex"),e==="vertex"||e==="fragment"){const o=this.varyings,a=this.vars[e];for(let l=0;l<o.length;l++){const c=o[l];if(c.needsInterpolation){let u=`@location( ${l} )`;if(c.interpolationType){const h=c.interpolationSampling!==null?`, ${c.interpolationSampling} )`:" )";u+=` @interpolate( ${c.interpolationType}${h}`}else/^(int|uint|ivec|uvec)/.test(c.type)&&(u+=` @interpolate( ${this.renderer.backend.compatibilityMode?"flat, either":"flat"} )`);n.push(`${u} ${c.name} : ${this.getType(c.type)}`)}else e==="vertex"&&a.includes(c)===!1&&a.push(c)}}const i=this.getBuiltins(e);i&&n.push(i);const s=n.join(`,
	`);return e==="vertex"?this._getWGSLStruct("VaryingsStruct","	"+s):s}isCustomStruct(e){const n=e.value,i=e.node,s=(n.isBufferAttribute||n.isInstancedBufferAttribute)&&i.structTypeNode!==null,o=i.value&&i.value.array&&typeof i.value.itemSize=="number"&&i.value.array.length>i.value.itemSize;return s&&!o}getUniforms(e){const n=this.uniforms[e],i=[],s=[],o=[],a={};for(const c of n){const u=c.groupNode.name,h=this.bindingsIndexes[u];if(c.type==="texture"||c.type==="cubeTexture"||c.type==="storageTexture"||c.type==="texture3D"){const f=c.node.value;(e==="fragment"||e==="compute")&&this.isUnfilterable(f)===!1&&c.node.isStorageTextureNode!==!0&&(this.isSampleCompare(f)?i.push(`@binding( ${h.binding++} ) @group( ${h.group} ) var ${c.name}_sampler : sampler_comparison;`):i.push(`@binding( ${h.binding++} ) @group( ${h.group} ) var ${c.name}_sampler : sampler;`));let d,p="";const{primarySamples:m}=this.renderer.backend.utils.getTextureSampleData(f);if(m>1&&(p="_multisampled"),f.isCubeTexture===!0)d="texture_cube<f32>";else if(f.isDataArrayTexture===!0||f.isCompressedArrayTexture===!0||f.isTextureArray===!0)d="texture_2d_array<f32>";else if(f.isDepthTexture===!0)this.renderer.backend.compatibilityMode&&f.compareFunction===null?d=`texture${p}_2d<f32>`:d=`texture_depth${p}_2d${f.isDepthArrayTexture===!0?"_array":""}`;else if(f.isVideoTexture===!0)d="texture_external";else if(f.isData3DTexture===!0)d="texture_3d<f32>";else if(c.node.isStorageTextureNode===!0){const g=RD(f),v=this.getStorageAccess(c.node,e);d=`texture_storage_2d<${g}, ${v}>`}else{const g=this.getComponentTypeFromTexture(f).charAt(0);d=`texture${p}_2d<${g}32>`}i.push(`@binding( ${h.binding++} ) @group( ${h.group} ) var ${c.name} : ${d};`)}else if(c.type==="buffer"||c.type==="storageBuffer"||c.type==="indirectStorageBuffer"){const f=c.node,d=this.getType(f.getNodeType(this)),p=f.bufferCount,m=p>0&&c.type==="buffer"?", "+p:"",g=f.isStorageBufferNode?`storage, ${this.getStorageAccess(f,e)}`:"uniform";if(this.isCustomStruct(c))s.push(`@binding( ${h.binding++} ) @group( ${h.group} ) var<${g}> ${c.name} : ${d};`);else{const y=`	value : array< ${f.isAtomic?`atomic<${d}>`:`${d}`}${m} >`;s.push(this._getWGSLStructBinding(c.name,y,g,h.binding++,h.group))}}else{const f=this.getType(this.getVectorType(c.type)),d=c.groupNode.name;(a[d]||(a[d]={index:h.binding++,id:h.group,snippets:[]})).snippets.push(`	${c.name} : ${f}`)}}for(const c in a){const u=a[c];o.push(this._getWGSLStructBinding(c,u.snippets.join(`,
`),"uniform",u.index,u.id))}let l=i.join(`
`);return l+=s.join(`
`),l+=o.join(`
`),l}buildCode(){const e=this.material!==null?{fragment:{},vertex:{}}:{compute:{}};this.sortBindingGroups();for(const n in e){this.shaderStage=n;const i=e[n];i.uniforms=this.getUniforms(n),i.attributes=this.getAttributes(n),i.varyings=this.getVaryings(n),i.structs=this.getStructs(n),i.vars=this.getVars(n),i.codes=this.getCodes(n),i.directives=this.getDirectives(n),i.scopedArrays=this.getScopedArrays(n);let s=`// code

`;s+=this.flowCode[n];const o=this.flowNodes[n],a=o[o.length-1],l=a.outputNode,c=l!==void 0&&l.isOutputStructNode===!0;for(const u of o){const h=this.getFlowData(u),f=u.name;if(f&&(s.length>0&&(s+=`
`),s+=`	// flow -> ${f}
`),s+=`${h.code}
	`,u===a&&n!=="compute"){if(s+=`// result

	`,n==="vertex")s+=`varyings.Vertex = ${h.result};`;else if(n==="fragment")if(c)i.returnType=l.getNodeType(this),i.structs+="var<private> output : "+i.returnType+";",s+=`return ${h.result};`;else{let d="	@location(0) color: vec4<f32>";const p=this.getBuiltins("output");p&&(d+=`,
	`+p),i.returnType="OutputStruct",i.structs+=this._getWGSLStruct("OutputStruct",d),i.structs+=`
var<private> output : OutputStruct;`,s+=`output.color = ${h.result};

	return output;`}}}i.flow=s}this.shaderStage=null,this.material!==null?(this.vertexShader=this._getWGSLVertexCode(e.vertex),this.fragmentShader=this._getWGSLFragmentCode(e.fragment)):this.computeShader=this._getWGSLComputeCode(e.compute,(this.object.workgroupSize||[64]).join(", "))}getMethod(e,n=null){let i;return n!==null&&(i=this._getWGSLMethod(e+"_"+n)),i===void 0&&(i=this._getWGSLMethod(e)),i||e}getType(e){return GFe[e]||e}isAvailable(e){let n=nH[e];return n===void 0&&(e==="float32Filterable"?n=this.renderer.hasFeature("float32-filterable"):e==="clipDistance"&&(n=this.renderer.hasFeature("clip-distances")),nH[e]=n),n}_getWGSLMethod(e){return Yo[e]!==void 0&&this._include(e),f0[e]}_include(e){const n=Yo[e];return n.build(this),this.currentFunctionNode!==null&&this.currentFunctionNode.includes.push(n),n}_getWGSLVertexCode(e){return`${this.getSignature()}
// directives
${e.directives}

// structs
${e.structs}

// uniforms
${e.uniforms}

// varyings
${e.varyings}
var<private> varyings : VaryingsStruct;

// codes
${e.codes}

@vertex
fn main( ${e.attributes} ) -> VaryingsStruct {

	// vars
	${e.vars}

	// flow
	${e.flow}

	return varyings;

}
`}_getWGSLFragmentCode(e){return`${this.getSignature()}
// global
${Tee}

// structs
${e.structs}

// uniforms
${e.uniforms}

// codes
${e.codes}

@fragment
fn main( ${e.varyings} ) -> ${e.returnType} {

	// vars
	${e.vars}

	// flow
	${e.flow}

}
`}_getWGSLComputeCode(e,n){return`${this.getSignature()}
// directives
${e.directives}

// system
var<private> instanceIndex : u32;

// locals
${e.scopedArrays}

// structs
${e.structs}

// uniforms
${e.uniforms}

// codes
${e.codes}

@compute @workgroup_size( ${n} )
fn main( ${e.attributes} ) {

	// system
	instanceIndex = globalId.x + globalId.y * numWorkgroups.x * u32(${n}) + globalId.z * numWorkgroups.x * numWorkgroups.y * u32(${n});

	// vars
	${e.vars}

	// flow
	${e.flow}

}
`}_getWGSLStruct(e,n){return`
struct ${e} {
${n}
};`}_getWGSLStructBinding(e,n,i,s=0,o=0){const a=e+"Struct";return`${this._getWGSLStruct(a,n)}
@binding( ${s} ) @group( ${o} )
var<${i}> ${e} : ${a};`}}class WFe{constructor(e){this.backend=e}getCurrentDepthStencilFormat(e){let n;return e.depthTexture!==null?n=this.getTextureFormatGPU(e.depthTexture):e.depth&&e.stencil?n=re.Depth24PlusStencil8:e.depth&&(n=re.Depth24Plus),n}getTextureFormatGPU(e){return this.backend.get(e).format}getTextureSampleData(e){let n;if(e.isFramebufferTexture)n=1;else if(e.isDepthTexture&&!e.renderTarget){const o=this.backend.renderer,a=o.getRenderTarget();n=a?a.samples:o.samples}else e.renderTarget&&(n=e.renderTarget.samples);n=n||1;const i=n>1&&e.renderTarget!==null&&e.isDepthTexture!==!0&&e.isFramebufferTexture!==!0;return{samples:n,primarySamples:i?1:n,isMSAA:i}}getCurrentColorFormat(e){let n;return e.textures!==null?n=this.getTextureFormatGPU(e.textures[0]):n=this.getPreferredCanvasFormat(),n}getCurrentColorSpace(e){return e.textures!==null?e.textures[0].colorSpace:this.backend.renderer.outputColorSpace}getPrimitiveTopology(e,n){if(e.isPoints)return dm.PointList;if(e.isLineSegments||e.isMesh&&n.wireframe===!0)return dm.LineList;if(e.isLine)return dm.LineStrip;if(e.isMesh)return dm.TriangleList}getSampleCount(e){let n=1;return e>1&&(n=Math.pow(2,Math.floor(Math.log2(e))),n===2&&(n=4)),n}getSampleCountRenderContext(e){return e.textures!==null?this.getSampleCount(e.sampleCount):this.getSampleCount(this.backend.renderer.samples)}getPreferredCanvasFormat(){const e=this.backend.parameters.outputType;if(e===void 0)return navigator.gpu.getPreferredCanvasFormat();if(e===gr)return re.BGRA8Unorm;if(e===Ei)return re.RGBA16Float;throw new Error("Unsupported outputType")}}const qFe=new Map([[Int8Array,["sint8","snorm8"]],[Uint8Array,["uint8","unorm8"]],[Int16Array,["sint16","snorm16"]],[Uint16Array,["uint16","unorm16"]],[Int32Array,["sint32","snorm32"]],[Uint32Array,["uint32","unorm32"]],[Float32Array,["float32"]]]),XFe=new Map([[TY,["float16"]]]),KFe=new Map([[Int32Array,"sint32"],[Int16Array,"sint32"],[Uint32Array,"uint32"],[Uint16Array,"uint32"],[Float32Array,"float32"]]);class YFe{constructor(e){this.backend=e}createAttribute(e,n){const i=this._getBufferAttribute(e),s=this.backend,o=s.get(i);let a=o.buffer;if(a===void 0){const l=s.device;let c=i.array;if(e.normalized===!1){if(c.constructor===Int16Array||c.constructor===Int8Array)c=new Int32Array(c);else if((c.constructor===Uint16Array||c.constructor===Uint8Array)&&(c=new Uint32Array(c),n&GPUBufferUsage.INDEX))for(let h=0;h<c.length;h++)c[h]===65535&&(c[h]=4294967295)}if(i.array=c,(i.isStorageBufferAttribute||i.isStorageInstancedBufferAttribute)&&i.itemSize===3){c=new c.constructor(i.count*4);for(let h=0;h<i.count;h++)c.set(i.array.subarray(h*3,h*3+3),h*4);i.itemSize=4,i.array=c,o._force3to4BytesAlignment=!0}const u=c.byteLength+(4-c.byteLength%4)%4;a=l.createBuffer({label:i.name,size:u,usage:n,mappedAtCreation:!0}),new c.constructor(a.getMappedRange()).set(c),a.unmap(),o.buffer=a}}updateAttribute(e){const n=this._getBufferAttribute(e),i=this.backend,s=i.device,o=i.get(n),a=i.get(n).buffer;let l=n.array;if(o._force3to4BytesAlignment===!0){l=new l.constructor(n.count*4);for(let h=0;h<n.count;h++)l.set(n.array.subarray(h*3,h*3+3),h*4);n.array=l}const c=this._isTypedArray(l),u=n.updateRanges;if(u.length===0)s.queue.writeBuffer(a,0,l,0);else{const h=c?1:l.BYTES_PER_ELEMENT;for(let f=0,d=u.length;f<d;f++){const p=u[f];let m,g;if(o._force3to4BytesAlignment===!0){const y=Math.floor(p.start/3),x=Math.ceil(p.count/3);m=y*4*h,g=x*4*h}else m=p.start*h,g=p.count*h;const v=m*(c?l.BYTES_PER_ELEMENT:1);s.queue.writeBuffer(a,v,l,m,g)}n.clearUpdateRanges()}}createShaderVertexBuffers(e){const n=e.getAttributes(),i=new Map;for(let s=0;s<n.length;s++){const o=n[s],a=o.array.BYTES_PER_ELEMENT,l=this._getBufferAttribute(o);let c=i.get(l);if(c===void 0){let f,d;o.isInterleavedBufferAttribute===!0?(f=o.data.stride*a,d=o.data.isInstancedInterleavedBuffer?zS.Instance:zS.Vertex):(f=o.itemSize*a,d=o.isInstancedBufferAttribute?zS.Instance:zS.Vertex),o.normalized===!1&&(o.array.constructor===Int16Array||o.array.constructor===Uint16Array)&&(f=4),c={arrayStride:f,attributes:[],stepMode:d},i.set(l,c)}const u=this._getVertexFormat(o),h=o.isInterleavedBufferAttribute===!0?o.offset*a:0;c.attributes.push({shaderLocation:s,offset:h,format:u})}return Array.from(i.values())}destroyAttribute(e){const n=this.backend;n.get(this._getBufferAttribute(e)).buffer.destroy(),n.delete(e)}async getArrayBufferAsync(e){const n=this.backend,i=n.device,o=n.get(this._getBufferAttribute(e)).buffer,a=o.size,l=i.createBuffer({label:`${e.name}_readback`,size:a,usage:GPUBufferUsage.COPY_DST|GPUBufferUsage.MAP_READ}),c=i.createCommandEncoder({label:`readback_encoder_${e.name}`});c.copyBufferToBuffer(o,0,l,0,a);const u=c.finish();i.queue.submit([u]),await l.mapAsync(GPUMapMode.READ);const h=l.getMappedRange(),f=new e.array.constructor(h.slice(0));return l.unmap(),f.buffer}_getVertexFormat(e){const{itemSize:n,normalized:i}=e,s=e.array.constructor,o=e.constructor;let a;if(n===1)a=KFe.get(s);else{const c=(XFe.get(o)||qFe.get(s))[i?1:0];if(c){const u=s.BYTES_PER_ELEMENT*n,f=Math.floor((u+3)/4)*4/s.BYTES_PER_ELEMENT;if(f%1)throw new Error("THREE.WebGPUAttributeUtils: Bad vertex format item size.");a=`${c}x${f}`}}return a||console.error("THREE.WebGPUAttributeUtils: Vertex format not supported yet."),a}_isTypedArray(e){return ArrayBuffer.isView(e)&&!(e instanceof DataView)}_getBufferAttribute(e){return e.isInterleavedBufferAttribute&&(e=e.data),e}}class ZFe{constructor(e){this.backend=e,this.bindGroupLayoutCache=new WeakMap}createBindingsLayout(e){const n=this.backend,i=n.device,s=[];let o=0;for(const a of e.bindings){const l={binding:o++,visibility:a.visibility};if(a.isUniformBuffer||a.isStorageBuffer){const c={};a.isStorageBuffer&&(a.visibility&4&&(a.access===Bc.READ_WRITE||a.access===Bc.WRITE_ONLY)?c.type=DN.Storage:c.type=DN.ReadOnlyStorage),l.buffer=c}else if(a.isSampler){const c={};a.texture.isDepthTexture&&(a.texture.compareFunction!==null?c.type=Q5.Comparison:n.compatibilityMode&&(c.type=Q5.NonFiltering)),l.sampler=c}else if(a.isSampledTexture&&a.texture.isVideoTexture)l.externalTexture={};else if(a.isSampledTexture&&a.store){const c={};c.format=this.backend.get(a.texture).texture.format;const u=a.access;u===Bc.READ_WRITE?c.access=kN.ReadWrite:u===Bc.WRITE_ONLY?c.access=kN.WriteOnly:c.access=kN.ReadOnly,l.storageTexture=c}else if(a.isSampledTexture){const c={},{primarySamples:u}=n.utils.getTextureSampleData(a.texture);if(u>1&&(c.multisampled=!0,a.texture.isDepthTexture||(c.sampleType=pf.UnfilterableFloat)),a.texture.isDepthTexture)n.compatibilityMode&&a.texture.compareFunction===null?c.sampleType=pf.UnfilterableFloat:c.sampleType=pf.Depth;else if(a.texture.isDataTexture||a.texture.isDataArrayTexture||a.texture.isData3DTexture){const h=a.texture.type;h===Si?c.sampleType=pf.SInt:h===In?c.sampleType=pf.UInt:h===Nr&&(this.backend.hasFeature("float32-filterable")?c.sampleType=pf.Float:c.sampleType=pf.UnfilterableFloat)}a.isSampledCubeTexture?c.viewDimension=wi.Cube:a.texture.isDataArrayTexture||a.texture.isDepthArrayTexture||a.texture.isCompressedArrayTexture?c.viewDimension=wi.TwoDArray:a.isSampledTexture3D&&(c.viewDimension=wi.ThreeD),l.texture=c}else console.error(`WebGPUBindingUtils: Unsupported binding "${a}".`);s.push(l)}return i.createBindGroupLayout({entries:s})}createBindings(e,n,i,s=0){const{backend:o,bindGroupLayoutCache:a}=this,l=o.get(e);let c=a.get(e.bindingsReference);c===void 0&&(c=this.createBindingsLayout(e),a.set(e.bindingsReference,c));let u;i>0&&(l.groups===void 0&&(l.groups=[],l.versions=[]),l.versions[i]===s&&(u=l.groups[i])),u===void 0&&(u=this.createBindGroup(e,c),i>0&&(l.groups[i]=u,l.versions[i]=s)),l.group=u,l.layout=c}updateBinding(e){const n=this.backend,i=n.device,s=e.buffer,o=n.get(e).buffer;i.queue.writeBuffer(o,0,s,0)}createBindGroupIndex(e,n){const s=this.backend.device,o=GPUBufferUsage.UNIFORM|GPUBufferUsage.COPY_DST,a=e[0],l=s.createBuffer({label:"bindingCameraIndex_"+a,size:16,usage:o});s.queue.writeBuffer(l,0,e,0);const c=[{binding:0,resource:{buffer:l}}];return s.createBindGroup({label:"bindGroupCameraIndex_"+a,layout:n,entries:c})}createBindGroup(e,n){const i=this.backend,s=i.device;let o=0;const a=[];for(const l of e.bindings){if(l.isUniformBuffer){const c=i.get(l);if(c.buffer===void 0){const u=l.byteLength,h=GPUBufferUsage.UNIFORM|GPUBufferUsage.COPY_DST,f=s.createBuffer({label:"bindingBuffer_"+l.name,size:u,usage:h});c.buffer=f}a.push({binding:o,resource:{buffer:c.buffer}})}else if(l.isStorageBuffer){const c=i.get(l);if(c.buffer===void 0){const u=l.attribute;c.buffer=i.get(u).buffer}a.push({binding:o,resource:{buffer:c.buffer}})}else if(l.isSampler){const c=i.get(l.texture);a.push({binding:o,resource:c.sampler})}else if(l.isSampledTexture){const c=i.get(l.texture);let u;if(c.externalTexture!==void 0)u=s.importExternalTexture({source:c.externalTexture});else{const h=l.store?1:c.texture.mipLevelCount,f=`view-${c.texture.width}-${c.texture.height}-${h}`;if(u=c[f],u===void 0){const d=AFe.All;let p;l.isSampledCubeTexture?p=wi.Cube:l.isSampledTexture3D?p=wi.ThreeD:l.texture.isDataArrayTexture||l.texture.isDepthArrayTexture||l.texture.isCompressedArrayTexture?p=wi.TwoDArray:p=wi.TwoD,u=c[f]=c.texture.createView({aspect:d,dimension:p,mipLevelCount:h})}}a.push({binding:o,resource:u})}o++}return s.createBindGroup({label:"bindGroup_"+e.name,layout:n,entries:a})}}class QFe{constructor(e){this.backend=e}_getSampleCount(e){return this.backend.utils.getSampleCountRenderContext(e)}createRenderPipeline(e,n){const{object:i,material:s,geometry:o,pipeline:a}=e,{vertexProgram:l,fragmentProgram:c}=a,u=this.backend,h=u.device,f=u.utils,d=u.get(a),p=[];for(const B of e.getBindings()){const C=u.get(B);p.push(C.layout)}const m=u.attributeUtils.createShaderVertexBuffers(e);let g;s.blending!==ro&&(s.blending!==Ro||s.transparent!==!1)&&(g=this._getBlending(s));let v={};s.stencilWrite===!0&&(v={compare:this._getStencilCompare(s),failOp:this._getStencilOperation(s.stencilFail),depthFailOp:this._getStencilOperation(s.stencilZFail),passOp:this._getStencilOperation(s.stencilZPass)});const y=this._getColorWriteMask(s),x=[];if(e.context.textures!==null){const B=e.context.textures;for(let C=0;C<B.length;C++){const O=f.getTextureFormatGPU(B[C]);x.push({format:O,blend:g,writeMask:y})}}else{const B=f.getCurrentColorFormat(e.context);x.push({format:B,blend:g,writeMask:y})}const b=u.get(l).module,w=u.get(c).module,_=this._getPrimitiveState(i,o,s),S=this._getDepthCompare(s),T=f.getCurrentDepthStencilFormat(e.context),E=this._getSampleCount(e.context),M={label:`renderPipeline_${s.name||s.type}_${s.id}`,vertex:Object.assign({},b,{buffers:m}),fragment:Object.assign({},w,{targets:x}),primitive:_,multisample:{count:E,alphaToCoverageEnabled:s.alphaToCoverage&&E>1},layout:h.createPipelineLayout({bindGroupLayouts:p})},A={},P=e.context.depth,D=e.context.stencil;if((P===!0||D===!0)&&(P===!0&&(A.format=T,A.depthWriteEnabled=s.depthWrite,A.depthCompare=S),D===!0&&(A.stencilFront=v,A.stencilBack={},A.stencilReadMask=s.stencilFuncMask,A.stencilWriteMask=s.stencilWriteMask),s.polygonOffset===!0&&(A.depthBias=s.polygonOffsetUnits,A.depthBiasSlopeScale=s.polygonOffsetFactor,A.depthBiasClamp=0),M.depthStencil=A),n===null)d.pipeline=h.createRenderPipeline(M);else{const B=new Promise(C=>{h.createRenderPipelineAsync(M).then(O=>{d.pipeline=O,C()})});n.push(B)}}createBundleEncoder(e,n="renderBundleEncoder"){const i=this.backend,{utils:s,device:o}=i,a=s.getCurrentDepthStencilFormat(e),l=s.getCurrentColorFormat(e),c=this._getSampleCount(e),u={label:n,colorFormats:[l],depthStencilFormat:a,sampleCount:c};return o.createRenderBundleEncoder(u)}createComputePipeline(e,n){const i=this.backend,s=i.device,o=i.get(e.computeProgram).module,a=i.get(e),l=[];for(const c of n){const u=i.get(c);l.push(u.layout)}a.pipeline=s.createComputePipeline({compute:o,layout:s.createPipelineLayout({bindGroupLayouts:l})})}_getBlending(e){let n,i;const s=e.blending,o=e.blendSrc,a=e.blendDst,l=e.blendEquation;if(s===Pm){const c=e.blendSrcAlpha!==null?e.blendSrcAlpha:o,u=e.blendDstAlpha!==null?e.blendDstAlpha:a,h=e.blendEquationAlpha!==null?e.blendEquationAlpha:l;n={srcFactor:this._getBlendFactor(o),dstFactor:this._getBlendFactor(a),operation:this._getBlendOperation(l)},i={srcFactor:this._getBlendFactor(c),dstFactor:this._getBlendFactor(u),operation:this._getBlendOperation(h)}}else{const c=e.premultipliedAlpha,u=(h,f,d,p)=>{n={srcFactor:h,dstFactor:f,operation:df.Add},i={srcFactor:d,dstFactor:p,operation:df.Add}};if(c)switch(s){case Ro:u(zt.One,zt.OneMinusSrcAlpha,zt.One,zt.OneMinusSrcAlpha);break;case Jm:u(zt.One,zt.One,zt.One,zt.One);break;case eg:u(zt.Zero,zt.OneMinusSrc,zt.Zero,zt.One);break;case tg:u(zt.Zero,zt.Src,zt.Zero,zt.SrcAlpha);break}else switch(s){case Ro:u(zt.SrcAlpha,zt.OneMinusSrcAlpha,zt.One,zt.OneMinusSrcAlpha);break;case Jm:u(zt.SrcAlpha,zt.One,zt.SrcAlpha,zt.One);break;case eg:u(zt.Zero,zt.OneMinusSrc,zt.Zero,zt.One);break;case tg:u(zt.Zero,zt.Src,zt.Zero,zt.Src);break}}if(n!==void 0&&i!==void 0)return{color:n,alpha:i};console.error("THREE.WebGPURenderer: Invalid blending: ",s)}_getBlendFactor(e){let n;switch(e){case wc:n=zt.Zero;break;case uF:n=zt.One;break;case hF:n=zt.Src;break;case fF:n=zt.OneMinusSrc;break;case Nx:n=zt.SrcAlpha;break;case Ox:n=zt.OneMinusSrcAlpha;break;case mF:n=zt.Dst;break;case gF:n=zt.OneMinusDstColor;break;case dF:n=zt.DstAlpha;break;case pF:n=zt.OneMinusDstAlpha;break;case yF:n=zt.SrcAlphaSaturated;break;case Uke:n=zt.Constant;break;case zke:n=zt.OneMinusConstant;break;default:console.error("THREE.WebGPURenderer: Blend factor not supported.",e)}return n}_getStencilCompare(e){let n;const i=e.stencilFunc;switch(i){case Yye:n=Ni.Never;break;case HO:n=Ni.Always;break;case Zye:n=Ni.Less;break;case Jye:n=Ni.LessEqual;break;case Qye:n=Ni.Equal;break;case nve:n=Ni.GreaterEqual;break;case eve:n=Ni.Greater;break;case tve:n=Ni.NotEqual;break;default:console.error("THREE.WebGPURenderer: Invalid stencil function.",i)}return n}_getStencilOperation(e){let n;switch(e){case Tf:n=ju.Keep;break;case Vye:n=ju.Zero;break;case Gye:n=ju.Replace;break;case Kye:n=ju.Invert;break;case Hye:n=ju.IncrementClamp;break;case Wye:n=ju.DecrementClamp;break;case qye:n=ju.IncrementWrap;break;case Xye:n=ju.DecrementWrap;break;default:console.error("THREE.WebGPURenderer: Invalid stencil operation.",n)}return n}_getBlendOperation(e){let n;switch(e){case ss:n=df.Add;break;case lF:n=df.Subtract;break;case cF:n=df.ReverseSubtract;break;case hY:n=df.Min;break;case fY:n=df.Max;break;default:console.error("THREE.WebGPUPipelineUtils: Blend equation not supported.",e)}return n}_getPrimitiveState(e,n,i){const s={},o=this.backend.utils;switch(s.topology=o.getPrimitiveTopology(e,i),n.index!==null&&e.isLine===!0&&e.isLineSegments!==!0&&(s.stripIndexFormat=n.index.array instanceof Uint16Array?Ag.Uint16:Ag.Uint32),i.side){case no:s.frontFace=RN.CCW,s.cullMode=NN.Back;break;case Fn:s.frontFace=RN.CCW,s.cullMode=NN.Front;break;case Es:s.frontFace=RN.CCW,s.cullMode=NN.None;break;default:console.error("THREE.WebGPUPipelineUtils: Unknown material.side value.",i.side);break}return s}_getColorWriteMask(e){return e.colorWrite===!0?Z5.All:Z5.None}_getDepthCompare(e){let n;if(e.depthTest===!1)n=Ni.Always;else{const i=e.depthFunc;switch(i){case Dx:n=Ni.Never;break;case kx:n=Ni.Always;break;case Ix:n=Ni.Less;break;case Ch:n=Ni.LessEqual;break;case Lx:n=Ni.Equal;break;case Fx:n=Ni.GreaterEqual;break;case Bx:n=Ni.Greater;break;case Ux:n=Ni.NotEqual;break;default:console.error("THREE.WebGPUPipelineUtils: Invalid depth function.",i)}}return n}}class JFe extends See{constructor(e,n,i=2048){super(i),this.device=e,this.type=n,this.querySet=this.device.createQuerySet({type:"timestamp",count:this.maxQueries,label:`queryset_global_timestamp_${n}`});const s=this.maxQueries*8;this.resolveBuffer=this.device.createBuffer({label:`buffer_timestamp_resolve_${n}`,size:s,usage:GPUBufferUsage.QUERY_RESOLVE|GPUBufferUsage.COPY_SRC}),this.resultBuffer=this.device.createBuffer({label:`buffer_timestamp_result_${n}`,size:s,usage:GPUBufferUsage.COPY_DST|GPUBufferUsage.MAP_READ})}allocateQueriesForContext(e){if(!this.trackTimestamp||this.isDisposed)return null;if(this.currentQueryIndex+2>this.maxQueries)return Ja(`WebGPUTimestampQueryPool [${this.type}]: Maximum number of queries exceeded, when using trackTimestamp it is necessary to resolves the queries via renderer.resolveTimestampsAsync( THREE.TimestampQuery.${this.type.toUpperCase()} ).`),null;const n=this.currentQueryIndex;return this.currentQueryIndex+=2,this.queryOffsets.set(e.id,n),n}async resolveQueriesAsync(){if(!this.trackTimestamp||this.currentQueryIndex===0||this.isDisposed)return this.lastValue;if(this.pendingResolve)return this.pendingResolve;this.pendingResolve=this._resolveQueries();try{return await this.pendingResolve}finally{this.pendingResolve=null}}async _resolveQueries(){if(this.isDisposed)return this.lastValue;try{if(this.resultBuffer.mapState!=="unmapped")return this.lastValue;const e=new Map(this.queryOffsets),n=this.currentQueryIndex,i=n*8;this.currentQueryIndex=0,this.queryOffsets.clear();const s=this.device.createCommandEncoder();s.resolveQuerySet(this.querySet,0,n,this.resolveBuffer,0),s.copyBufferToBuffer(this.resolveBuffer,0,this.resultBuffer,0,i);const o=s.finish();if(this.device.queue.submit([o]),this.resultBuffer.mapState!=="unmapped")return this.lastValue;if(await this.resultBuffer.mapAsync(GPUMapMode.READ,0,i),this.isDisposed)return this.resultBuffer.mapState==="mapped"&&this.resultBuffer.unmap(),this.lastValue;const a=new BigUint64Array(this.resultBuffer.getMappedRange(0,i));let l=0;for(const[,c]of e){const u=a[c],h=a[c+1],f=Number(h-u)/1e6;l+=f}return this.resultBuffer.unmap(),this.lastValue=l,l}catch(e){return console.error("Error resolving queries:",e),this.resultBuffer.mapState==="mapped"&&this.resultBuffer.unmap(),this.lastValue}}async dispose(){if(!this.isDisposed){if(this.isDisposed=!0,this.pendingResolve)try{await this.pendingResolve}catch(e){console.error("Error waiting for pending resolve:",e)}if(this.resultBuffer&&this.resultBuffer.mapState==="mapped")try{this.resultBuffer.unmap()}catch(e){console.error("Error unmapping buffer:",e)}this.querySet&&(this.querySet.destroy(),this.querySet=null),this.resolveBuffer&&(this.resolveBuffer.destroy(),this.resolveBuffer=null),this.resultBuffer&&(this.resultBuffer.destroy(),this.resultBuffer=null),this.queryOffsets.clear(),this.pendingResolve=null}}}class e3e extends wee{constructor(e={}){super(e),this.isWebGPUBackend=!0,this.parameters.alpha=e.alpha===void 0?!0:e.alpha,this.parameters.compatibilityMode=e.compatibilityMode===void 0?!1:e.compatibilityMode,this.parameters.requiredLimits=e.requiredLimits===void 0?{}:e.requiredLimits,this.compatibilityMode=this.parameters.compatibilityMode,this.device=null,this.context=null,this.colorBuffer=null,this.defaultRenderPassdescriptor=null,this.utils=new WFe(this),this.attributeUtils=new YFe(this),this.bindingUtils=new ZFe(this),this.pipelineUtils=new QFe(this),this.textureUtils=new LFe(this),this.occludedResolveCache=new Map}async init(e){await super.init(e);const n=this.parameters;let i;if(n.device===void 0){const a={powerPreference:n.powerPreference,featureLevel:n.compatibilityMode?"compatibility":void 0},l=typeof navigator<"u"?await navigator.gpu.requestAdapter(a):null;if(l===null)throw new Error("WebGPUBackend: Unable to create WebGPU adapter.");const c=Object.values(PD),u=[];for(const f of c)l.features.has(f)&&u.push(f);const h={requiredFeatures:u,requiredLimits:n.requiredLimits};i=await l.requestDevice(h)}else i=n.device;i.lost.then(a=>{const l={api:"WebGPU",message:a.message||"Unknown reason",reason:a.reason||null,originalEvent:a};e.onDeviceLost(l)});const s=n.context!==void 0?n.context:e.domElement.getContext("webgpu");this.device=i,this.context=s;const o=n.alpha?"premultiplied":"opaque";this.trackTimestamp=this.trackTimestamp&&this.hasFeature(PD.TimestampQuery),this.context.configure({device:this.device,format:this.utils.getPreferredCanvasFormat(),usage:GPUTextureUsage.RENDER_ATTACHMENT|GPUTextureUsage.COPY_SRC,alphaMode:o}),this.updateSize()}get coordinateSystem(){return Ph}async getArrayBufferAsync(e){return await this.attributeUtils.getArrayBufferAsync(e)}getContext(){return this.context}_getDefaultRenderPassDescriptor(){let e=this.defaultRenderPassdescriptor;if(e===null){const i=this.renderer;e={colorAttachments:[{view:null}]},(this.renderer.depth===!0||this.renderer.stencil===!0)&&(e.depthStencilAttachment={view:this.textureUtils.getDepthBuffer(i.depth,i.stencil).createView()});const s=e.colorAttachments[0];this.renderer.samples>0?s.view=this.colorBuffer.createView():s.resolveTarget=void 0,this.defaultRenderPassdescriptor=e}const n=e.colorAttachments[0];return this.renderer.samples>0?n.resolveTarget=this.context.getCurrentTexture().createView():n.view=this.context.getCurrentTexture().createView(),e}_isRenderCameraDepthArray(e){return e.depthTexture&&e.depthTexture.isDepthArrayTexture&&e.camera.isArrayCamera}_getRenderPassDescriptor(e,n={}){const i=e.renderTarget,s=this.get(i);let o=s.descriptors;if(o===void 0||s.width!==i.width||s.height!==i.height||s.dimensions!==i.dimensions||s.activeMipmapLevel!==e.activeMipmapLevel||s.activeCubeFace!==e.activeCubeFace||s.samples!==i.samples){o={},s.descriptors=o;const u=()=>{i.removeEventListener("dispose",u),this.delete(i)};i.hasEventListener("dispose",u)===!1&&i.addEventListener("dispose",u)}const a=e.getCacheKey();let l=o[a];if(l===void 0){const u=e.textures,h=[];let f;const d=this._isRenderCameraDepthArray(e);for(let p=0;p<u.length;p++){const m=this.get(u[p]),g={label:`colorAttachment_${p}`,baseMipLevel:e.activeMipmapLevel,mipLevelCount:1,baseArrayLayer:e.activeCubeFace,arrayLayerCount:1,dimension:wi.TwoD};if(i.isRenderTarget3D)f=e.activeCubeFace,g.baseArrayLayer=0,g.dimension=wi.ThreeD,g.depthOrArrayLayers=u[p].image.depth;else if(i.isRenderTargetArray)if(d===!0){const v=e.camera.cameras;for(let y=0;y<v.length;y++){const x={...g,baseArrayLayer:y,arrayLayerCount:1,dimension:wi.TwoD},b=m.texture.createView(x);h.push({view:b,resolveTarget:void 0,depthSlice:void 0})}}else g.dimension=wi.TwoDArray,g.depthOrArrayLayers=u[p].image.depth;if(d!==!0){const v=m.texture.createView(g);let y,x;m.msaaTexture!==void 0?(y=m.msaaTexture.createView(),x=v):(y=v,x=void 0),h.push({view:y,resolveTarget:x,depthSlice:f})}}if(l={textureViews:h},e.depth){const p=this.get(e.depthTexture),m={};e.depthTexture.isDepthArrayTexture&&(m.dimension=wi.TwoD,m.arrayLayerCount=1,m.baseArrayLayer=e.activeCubeFace),l.depthStencilView=p.texture.createView(m)}o[a]=l,s.width=i.width,s.height=i.height,s.samples=i.samples,s.activeMipmapLevel=e.activeMipmapLevel,s.activeCubeFace=e.activeCubeFace,s.dimensions=i.dimensions}const c={colorAttachments:[]};for(let u=0;u<l.textureViews.length;u++){const h=l.textureViews[u];let f={r:0,g:0,b:0,a:1};u===0&&n.clearValue&&(f=n.clearValue),c.colorAttachments.push({view:h.view,depthSlice:h.depthSlice,resolveTarget:h.resolveTarget,loadOp:n.loadOp||xn.Load,storeOp:n.storeOp||gs.Store,clearValue:f})}return l.depthStencilView&&(c.depthStencilAttachment={view:l.depthStencilView}),c}beginRender(e){const n=this.get(e),i=this.device,s=e.occlusionQueryCount;let o;s>0&&(n.currentOcclusionQuerySet&&n.currentOcclusionQuerySet.destroy(),n.currentOcclusionQueryBuffer&&n.currentOcclusionQueryBuffer.destroy(),n.currentOcclusionQuerySet=n.occlusionQuerySet,n.currentOcclusionQueryBuffer=n.occlusionQueryBuffer,n.currentOcclusionQueryObjects=n.occlusionQueryObjects,o=i.createQuerySet({type:"occlusion",count:s,label:`occlusionQuerySet_${e.id}`}),n.occlusionQuerySet=o,n.occlusionQueryIndex=0,n.occlusionQueryObjects=new Array(s),n.lastOcclusionObject=null);let a;e.textures===null?a=this._getDefaultRenderPassDescriptor():a=this._getRenderPassDescriptor(e,{loadOp:xn.Load}),this.initTimestampQuery(e,a),a.occlusionQuerySet=o;const l=a.depthStencilAttachment;if(e.textures!==null){const u=a.colorAttachments;for(let h=0;h<u.length;h++){const f=u[h];e.clearColor?(f.clearValue=h===0?e.clearColorValue:{r:0,g:0,b:0,a:1},f.loadOp=xn.Clear):f.loadOp=xn.Load,f.storeOp=gs.Store}}else{const u=a.colorAttachments[0];e.clearColor?(u.clearValue=e.clearColorValue,u.loadOp=xn.Clear):u.loadOp=xn.Load,u.storeOp=gs.Store}e.depth&&(e.clearDepth?(l.depthClearValue=e.clearDepthValue,l.depthLoadOp=xn.Clear):l.depthLoadOp=xn.Load,l.depthStoreOp=gs.Store),e.stencil&&(e.clearStencil?(l.stencilClearValue=e.clearStencilValue,l.stencilLoadOp=xn.Clear):l.stencilLoadOp=xn.Load,l.stencilStoreOp=gs.Store);const c=i.createCommandEncoder({label:"renderContext_"+e.id});if(this._isRenderCameraDepthArray(e)===!0){const u=e.camera.cameras;!n.layerDescriptors||n.layerDescriptors.length!==u.length?this._createDepthLayerDescriptors(e,n,a,u):this._updateDepthLayerDescriptors(e,n,u),n.bundleEncoders=[],n.bundleSets=[];for(let h=0;h<u.length;h++){const f=this.pipelineUtils.createBundleEncoder(e,"renderBundleArrayCamera_"+h),d={attributes:{},bindingGroups:[],pipeline:null,index:null};n.bundleEncoders.push(f),n.bundleSets.push(d)}n.currentPass=null}else{const u=c.beginRenderPass(a);if(n.currentPass=u,e.viewport&&this.updateViewport(e),e.scissor){const{x:h,y:f,width:d,height:p}=e.scissorValue;u.setScissorRect(h,f,d,p)}}n.descriptor=a,n.encoder=c,n.currentSets={attributes:{},bindingGroups:[],pipeline:null,index:null},n.renderBundles=[]}_createDepthLayerDescriptors(e,n,i,s){const o=i.depthStencilAttachment;n.layerDescriptors=[];const a=this.get(e.depthTexture);a.viewCache||(a.viewCache=[]);for(let l=0;l<s.length;l++){const c={...i,colorAttachments:[{...i.colorAttachments[0],view:i.colorAttachments[l].view}]};if(i.depthStencilAttachment){const u=l;a.viewCache[u]||(a.viewCache[u]=a.texture.createView({dimension:wi.TwoD,baseArrayLayer:l,arrayLayerCount:1})),c.depthStencilAttachment={view:a.viewCache[u],depthLoadOp:o.depthLoadOp||xn.Clear,depthStoreOp:o.depthStoreOp||gs.Store,depthClearValue:o.depthClearValue||1},e.stencil&&(c.depthStencilAttachment.stencilLoadOp=o.stencilLoadOp,c.depthStencilAttachment.stencilStoreOp=o.stencilStoreOp,c.depthStencilAttachment.stencilClearValue=o.stencilClearValue)}else c.depthStencilAttachment={...o};n.layerDescriptors.push(c)}}_updateDepthLayerDescriptors(e,n,i){for(let s=0;s<i.length;s++){const o=n.layerDescriptors[s];if(o.depthStencilAttachment){const a=o.depthStencilAttachment;e.depth&&(e.clearDepth?(a.depthClearValue=e.clearDepthValue,a.depthLoadOp=xn.Clear):a.depthLoadOp=xn.Load),e.stencil&&(e.clearStencil?(a.stencilClearValue=e.clearStencilValue,a.stencilLoadOp=xn.Clear):a.stencilLoadOp=xn.Load)}}}finishRender(e){const n=this.get(e),i=e.occlusionQueryCount;n.renderBundles.length>0&&n.currentPass.executeBundles(n.renderBundles),i>n.occlusionQueryIndex&&n.currentPass.endOcclusionQuery();const s=n.encoder;if(this._isRenderCameraDepthArray(e)===!0){const o=[];for(let a=0;a<n.bundleEncoders.length;a++){const l=n.bundleEncoders[a];o.push(l.finish())}for(let a=0;a<n.layerDescriptors.length;a++)if(a<o.length){const l=n.layerDescriptors[a],c=s.beginRenderPass(l);if(e.viewport){const{x:u,y:h,width:f,height:d,minDepth:p,maxDepth:m}=e.viewportValue;c.setViewport(u,h,f,d,p,m)}if(e.scissor){const{x:u,y:h,width:f,height:d}=e.scissorValue;c.setScissorRect(u,h,f,d)}c.executeBundles([o[a]]),c.end()}}else n.currentPass&&n.currentPass.end();if(i>0){const o=i*8;let a=this.occludedResolveCache.get(o);a===void 0&&(a=this.device.createBuffer({size:o,usage:GPUBufferUsage.QUERY_RESOLVE|GPUBufferUsage.COPY_SRC}),this.occludedResolveCache.set(o,a));const l=this.device.createBuffer({size:o,usage:GPUBufferUsage.COPY_DST|GPUBufferUsage.MAP_READ});n.encoder.resolveQuerySet(n.occlusionQuerySet,0,i,a,0),n.encoder.copyBufferToBuffer(a,0,l,0,o),n.occlusionQueryBuffer=l,this.resolveOccludedAsync(e)}if(this.device.queue.submit([n.encoder.finish()]),e.textures!==null){const o=e.textures;for(let a=0;a<o.length;a++){const l=o[a];l.generateMipmaps===!0&&this.textureUtils.generateMipmaps(l)}}}isOccluded(e,n){const i=this.get(e);return i.occluded&&i.occluded.has(n)}async resolveOccludedAsync(e){const n=this.get(e),{currentOcclusionQueryBuffer:i,currentOcclusionQueryObjects:s}=n;if(i&&s){const o=new WeakSet;n.currentOcclusionQueryObjects=null,n.currentOcclusionQueryBuffer=null,await i.mapAsync(GPUMapMode.READ);const a=i.getMappedRange(),l=new BigUint64Array(a);for(let c=0;c<s.length;c++)l[c]===BigInt(0)&&o.add(s[c]);i.destroy(),n.occluded=o}}updateViewport(e){const{currentPass:n}=this.get(e),{x:i,y:s,width:o,height:a,minDepth:l,maxDepth:c}=e.viewportValue;n.setViewport(i,s,o,a,l,c)}getClearColor(){const e=super.getClearColor();return this.renderer.alpha===!0&&(e.r*=e.a,e.g*=e.a,e.b*=e.a),e}clear(e,n,i,s=null){const o=this.device,a=this.renderer;let l=[],c,u,h,f;if(e){const m=this.getClearColor();u={r:m.r,g:m.g,b:m.b,a:m.a}}if(s===null){h=a.depth,f=a.stencil;const m=this._getDefaultRenderPassDescriptor();if(e){l=m.colorAttachments;const g=l[0];g.clearValue=u,g.loadOp=xn.Clear,g.storeOp=gs.Store}(h||f)&&(c=m.depthStencilAttachment)}else{h=s.depth,f=s.stencil;const m={loadOp:e?xn.Clear:xn.Load,clearValue:e?u:void 0};h&&(m.depthLoadOp=n?xn.Clear:xn.Load,m.depthClearValue=n?a.getClearDepth():void 0,m.depthStoreOp=gs.Store),f&&(m.stencilLoadOp=i?xn.Clear:xn.Load,m.stencilClearValue=i?a.getClearStencil():void 0,m.stencilStoreOp=gs.Store);const g=this._getRenderPassDescriptor(s,m);l=g.colorAttachments,c=g.depthStencilAttachment}h&&c&&c.depthLoadOp===void 0&&(n?(c.depthLoadOp=xn.Clear,c.depthClearValue=a.getClearDepth(),c.depthStoreOp=gs.Store):(c.depthLoadOp=xn.Load,c.depthStoreOp=gs.Store)),f&&c&&c.stencilLoadOp===void 0&&(i?(c.stencilLoadOp=xn.Clear,c.stencilClearValue=a.getClearStencil(),c.stencilStoreOp=gs.Store):(c.stencilLoadOp=xn.Load,c.stencilStoreOp=gs.Store));const d=o.createCommandEncoder({label:"clear"});d.beginRenderPass({colorAttachments:l,depthStencilAttachment:c}).end(),o.queue.submit([d.finish()])}beginCompute(e){const n=this.get(e),i={label:"computeGroup_"+e.id};this.initTimestampQuery(e,i),n.cmdEncoderGPU=this.device.createCommandEncoder({label:"computeGroup_"+e.id}),n.passEncoderGPU=n.cmdEncoderGPU.beginComputePass(i)}compute(e,n,i,s){const{passEncoderGPU:o}=this.get(e),a=this.get(s).pipeline;o.setPipeline(a);for(let h=0,f=i.length;h<f;h++){const d=i[h],p=this.get(d);o.setBindGroup(h,p.group)}const l=this.device.limits.maxComputeWorkgroupsPerDimension,c=this.get(n);c.dispatchSize===void 0&&(c.dispatchSize={x:0,y:1,z:1});const{dispatchSize:u}=c;n.dispatchCount>l?(u.x=Math.min(n.dispatchCount,l),u.y=Math.ceil(n.dispatchCount/l)):u.x=n.dispatchCount,o.dispatchWorkgroups(u.x,u.y,u.z)}finishCompute(e){const n=this.get(e);n.passEncoderGPU.end(),this.device.queue.submit([n.cmdEncoderGPU.finish()])}async waitForGPU(){await this.device.queue.onSubmittedWorkDone()}draw(e,n){const{object:i,material:s,context:o,pipeline:a}=e,l=e.getBindings(),c=this.get(o),u=this.get(a).pipeline,h=e.getIndex(),f=h!==null,d=e.getDrawParameters();if(d===null)return;const p=(g,v)=>{g.setPipeline(u),v.pipeline=u;const y=v.bindingGroups;for(let b=0,w=l.length;b<w;b++){const _=l[b],S=this.get(_);y[_.index]!==_.id&&(g.setBindGroup(_.index,S.group),y[_.index]=_.id)}if(f===!0&&v.index!==h){const b=this.get(h).buffer,w=h.array instanceof Uint16Array?Ag.Uint16:Ag.Uint32;g.setIndexBuffer(b,w),v.index=h}const x=e.getVertexBuffers();for(let b=0,w=x.length;b<w;b++){const _=x[b];if(v.attributes[b]!==_){const S=this.get(_).buffer;g.setVertexBuffer(b,S),v.attributes[b]=_}}o.stencil===!0&&s.stencilWrite===!0&&c.currentStencilRef!==s.stencilRef&&(g.setStencilReference(s.stencilRef),c.currentStencilRef=s.stencilRef)},m=(g,v)=>{if(p(g,v),i.isBatchedMesh===!0){const y=i._multiDrawStarts,x=i._multiDrawCounts,b=i._multiDrawCount,w=i._multiDrawInstances;w!==null&&Ja("THREE.WebGPUBackend: renderMultiDrawInstances has been deprecated and will be removed in r184. Append to renderMultiDraw arguments and use indirection.");for(let _=0;_<b;_++){const S=w?w[_]:1,T=S>1?0:_;f===!0?g.drawIndexed(x[_],S,y[_]/h.array.BYTES_PER_ELEMENT,0,T):g.draw(x[_],S,y[_],T),n.update(i,x[_],S)}}else if(f===!0){const{vertexCount:y,instanceCount:x,firstVertex:b}=d,w=e.getIndirect();if(w!==null){const _=this.get(w).buffer;g.drawIndexedIndirect(_,0)}else g.drawIndexed(y,x,b,0,0);n.update(i,y,x)}else{const{vertexCount:y,instanceCount:x,firstVertex:b}=d,w=e.getIndirect();if(w!==null){const _=this.get(w).buffer;g.drawIndirect(_,0)}else g.draw(y,x,b,0);n.update(i,y,x)}};if(e.camera.isArrayCamera&&e.camera.cameras.length>0){const g=this.get(e.camera),v=e.camera.cameras,y=e.getBindingGroup("cameraIndex");if(g.indexesGPU===void 0||g.indexesGPU.length!==v.length){const b=this.get(y),w=[],_=new Uint32Array([0,0,0,0]);for(let S=0,T=v.length;S<T;S++){_[0]=S;const E=this.bindingUtils.createBindGroupIndex(_,b.layout);w.push(E)}g.indexesGPU=w}const x=this.renderer.getPixelRatio();for(let b=0,w=v.length;b<w;b++){const _=v[b];if(i.layers.test(_.layers)){const S=_.viewport;let T=c.currentPass,E=c.currentSets;if(c.bundleEncoders){const M=c.bundleEncoders[b],A=c.bundleSets[b];T=M,E=A}S&&T.setViewport(Math.floor(S.x*x),Math.floor(S.y*x),Math.floor(S.width*x),Math.floor(S.height*x),o.viewportValue.minDepth,o.viewportValue.maxDepth),y&&g.indexesGPU&&(T.setBindGroup(y.index,g.indexesGPU[b]),E.bindingGroups[y.index]=y.id),m(T,E)}}}else if(c.currentPass){if(c.occlusionQuerySet!==void 0){const g=c.lastOcclusionObject;g!==i&&(g!==null&&g.occlusionTest===!0&&(c.currentPass.endOcclusionQuery(),c.occlusionQueryIndex++),i.occlusionTest===!0&&(c.currentPass.beginOcclusionQuery(c.occlusionQueryIndex),c.occlusionQueryObjects[c.occlusionQueryIndex]=i),c.lastOcclusionObject=i)}m(c.currentPass,c.currentSets)}}needsRenderUpdate(e){const n=this.get(e),{object:i,material:s}=e,o=this.utils,a=o.getSampleCountRenderContext(e.context),l=o.getCurrentColorSpace(e.context),c=o.getCurrentColorFormat(e.context),u=o.getCurrentDepthStencilFormat(e.context),h=o.getPrimitiveTopology(i,s);let f=!1;return(n.material!==s||n.materialVersion!==s.version||n.transparent!==s.transparent||n.blending!==s.blending||n.premultipliedAlpha!==s.premultipliedAlpha||n.blendSrc!==s.blendSrc||n.blendDst!==s.blendDst||n.blendEquation!==s.blendEquation||n.blendSrcAlpha!==s.blendSrcAlpha||n.blendDstAlpha!==s.blendDstAlpha||n.blendEquationAlpha!==s.blendEquationAlpha||n.colorWrite!==s.colorWrite||n.depthWrite!==s.depthWrite||n.depthTest!==s.depthTest||n.depthFunc!==s.depthFunc||n.stencilWrite!==s.stencilWrite||n.stencilFunc!==s.stencilFunc||n.stencilFail!==s.stencilFail||n.stencilZFail!==s.stencilZFail||n.stencilZPass!==s.stencilZPass||n.stencilFuncMask!==s.stencilFuncMask||n.stencilWriteMask!==s.stencilWriteMask||n.side!==s.side||n.alphaToCoverage!==s.alphaToCoverage||n.sampleCount!==a||n.colorSpace!==l||n.colorFormat!==c||n.depthStencilFormat!==u||n.primitiveTopology!==h||n.clippingContextCacheKey!==e.clippingContextCacheKey)&&(n.material=s,n.materialVersion=s.version,n.transparent=s.transparent,n.blending=s.blending,n.premultipliedAlpha=s.premultipliedAlpha,n.blendSrc=s.blendSrc,n.blendDst=s.blendDst,n.blendEquation=s.blendEquation,n.blendSrcAlpha=s.blendSrcAlpha,n.blendDstAlpha=s.blendDstAlpha,n.blendEquationAlpha=s.blendEquationAlpha,n.colorWrite=s.colorWrite,n.depthWrite=s.depthWrite,n.depthTest=s.depthTest,n.depthFunc=s.depthFunc,n.stencilWrite=s.stencilWrite,n.stencilFunc=s.stencilFunc,n.stencilFail=s.stencilFail,n.stencilZFail=s.stencilZFail,n.stencilZPass=s.stencilZPass,n.stencilFuncMask=s.stencilFuncMask,n.stencilWriteMask=s.stencilWriteMask,n.side=s.side,n.alphaToCoverage=s.alphaToCoverage,n.sampleCount=a,n.colorSpace=l,n.colorFormat=c,n.depthStencilFormat=u,n.primitiveTopology=h,n.clippingContextCacheKey=e.clippingContextCacheKey,f=!0),f}getRenderCacheKey(e){const{object:n,material:i}=e,s=this.utils,o=e.context;return[i.transparent,i.blending,i.premultipliedAlpha,i.blendSrc,i.blendDst,i.blendEquation,i.blendSrcAlpha,i.blendDstAlpha,i.blendEquationAlpha,i.colorWrite,i.depthWrite,i.depthTest,i.depthFunc,i.stencilWrite,i.stencilFunc,i.stencilFail,i.stencilZFail,i.stencilZPass,i.stencilFuncMask,i.stencilWriteMask,i.side,s.getSampleCountRenderContext(o),s.getCurrentColorSpace(o),s.getCurrentColorFormat(o),s.getCurrentDepthStencilFormat(o),s.getPrimitiveTopology(n,i),e.getGeometryCacheKey(),e.clippingContextCacheKey].join()}createSampler(e){this.textureUtils.createSampler(e)}destroySampler(e){this.textureUtils.destroySampler(e)}createDefaultTexture(e){this.textureUtils.createDefaultTexture(e)}createTexture(e,n){this.textureUtils.createTexture(e,n)}updateTexture(e,n){this.textureUtils.updateTexture(e,n)}generateMipmaps(e){this.textureUtils.generateMipmaps(e)}destroyTexture(e){this.textureUtils.destroyTexture(e)}async copyTextureToBuffer(e,n,i,s,o,a){return this.textureUtils.copyTextureToBuffer(e,n,i,s,o,a)}initTimestampQuery(e,n){if(!this.trackTimestamp)return;const i=e.isComputeNode?"compute":"render";this.timestampQueryPool[i]||(this.timestampQueryPool[i]=new JFe(this.device,i,2048));const s=this.timestampQueryPool[i],o=s.allocateQueriesForContext(e);n.timestampWrites={querySet:s.querySet,beginningOfPassWriteIndex:o,endOfPassWriteIndex:o+1}}createNodeBuilder(e,n){return new HFe(e,n)}createProgram(e){const n=this.get(e);n.module={module:this.device.createShaderModule({code:e.code,label:e.stage+(e.name!==""?`_${e.name}`:"")}),entryPoint:"main"}}destroyProgram(e){this.delete(e)}createRenderPipeline(e,n){this.pipelineUtils.createRenderPipeline(e,n)}createComputePipeline(e,n){this.pipelineUtils.createComputePipeline(e,n)}beginBundle(e){const n=this.get(e);n._currentPass=n.currentPass,n._currentSets=n.currentSets,n.currentSets={attributes:{},bindingGroups:[],pipeline:null,index:null},n.currentPass=this.pipelineUtils.createBundleEncoder(e)}finishBundle(e,n){const i=this.get(e),o=i.currentPass.finish();this.get(n).bundleGPU=o,i.currentSets=i._currentSets,i.currentPass=i._currentPass}addBundle(e,n){this.get(e).renderBundles.push(this.get(n).bundleGPU)}createBindings(e,n,i,s){this.bindingUtils.createBindings(e,n,i,s)}updateBindings(e,n,i,s){this.bindingUtils.createBindings(e,n,i,s)}updateBinding(e){this.bindingUtils.updateBinding(e)}createIndexAttribute(e){this.attributeUtils.createAttribute(e,GPUBufferUsage.INDEX|GPUBufferUsage.COPY_SRC|GPUBufferUsage.COPY_DST)}createAttribute(e){this.attributeUtils.createAttribute(e,GPUBufferUsage.VERTEX|GPUBufferUsage.COPY_SRC|GPUBufferUsage.COPY_DST)}createStorageAttribute(e){this.attributeUtils.createAttribute(e,GPUBufferUsage.STORAGE|GPUBufferUsage.VERTEX|GPUBufferUsage.COPY_SRC|GPUBufferUsage.COPY_DST)}createIndirectStorageAttribute(e){this.attributeUtils.createAttribute(e,GPUBufferUsage.STORAGE|GPUBufferUsage.INDIRECT|GPUBufferUsage.COPY_SRC|GPUBufferUsage.COPY_DST)}updateAttribute(e){this.attributeUtils.updateAttribute(e)}destroyAttribute(e){this.attributeUtils.destroyAttribute(e)}updateSize(){this.colorBuffer=this.textureUtils.getColorBuffer(),this.defaultRenderPassdescriptor=null}getMaxAnisotropy(){return 16}hasFeature(e){return this.device.features.has(e)}copyTextureToTexture(e,n,i=null,s=null,o=0,a=0){let l=0,c=0,u=0,h=0,f=0,d=0,p=e.image.width,m=e.image.height,g=1;i!==null&&(i.isBox3===!0?(h=i.min.x,f=i.min.y,d=i.min.z,p=i.max.x-i.min.x,m=i.max.y-i.min.y,g=i.max.z-i.min.z):(h=i.min.x,f=i.min.y,p=i.max.x-i.min.x,m=i.max.y-i.min.y,g=1)),s!==null&&(l=s.x,c=s.y,u=s.z||0);const v=this.device.createCommandEncoder({label:"copyTextureToTexture_"+e.id+"_"+n.id}),y=this.get(e).texture,x=this.get(n).texture;v.copyTextureToTexture({texture:y,mipLevel:o,origin:{x:h,y:f,z:d}},{texture:x,mipLevel:a,origin:{x:l,y:c,z:u}},[p,m,g]),this.device.queue.submit([v.finish()]),a===0&&n.generateMipmaps&&this.textureUtils.generateMipmaps(n)}copyFramebufferToTexture(e,n,i){const s=this.get(n);let o=null;n.renderTarget?e.isDepthTexture?o=this.get(n.depthTexture).texture:o=this.get(n.textures[0]).texture:e.isDepthTexture?o=this.textureUtils.getDepthBuffer(n.depth,n.stencil):o=this.context.getCurrentTexture();const a=this.get(e).texture;if(o.format!==a.format){console.error("WebGPUBackend: copyFramebufferToTexture: Source and destination formats do not match.",o.format,a.format);return}let l;if(s.currentPass?(s.currentPass.end(),l=s.encoder):l=this.device.createCommandEncoder({label:"copyFramebufferToTexture_"+e.id}),l.copyTextureToTexture({texture:o,origin:[i.x,i.y,0]},{texture:a},[i.z,i.w]),e.generateMipmaps&&this.textureUtils.generateMipmaps(e),s.currentPass){const{descriptor:c}=s;for(let u=0;u<c.colorAttachments.length;u++)c.colorAttachments[u].loadOp=xn.Load;if(n.depth&&(c.depthStencilAttachment.depthLoadOp=xn.Load),n.stencil&&(c.depthStencilAttachment.stencilLoadOp=xn.Load),s.currentPass=l.beginRenderPass(c),s.currentSets={attributes:{},bindingGroups:[],pipeline:null,index:null},n.viewport&&this.updateViewport(n),n.scissor){const{x:u,y:h,width:f,height:d}=n.scissorValue;s.currentPass.setScissorRect(u,h,f,d)}}else this.device.queue.submit([l.finish()])}}class t3e extends LY{constructor(e,n,i,s,o,a){super(e,n,i,s,o,a),this.iesMap=null}copy(e,n){return super.copy(e,n),this.iesMap=e.iesMap,this}}class n3e extends mee{constructor(){super(),this.addMaterial(EDe,"MeshPhongMaterial"),this.addMaterial(KJ,"MeshStandardMaterial"),this.addMaterial(vke,"MeshPhysicalMaterial"),this.addMaterial(wke,"MeshToonMaterial"),this.addMaterial(vDe,"MeshBasicMaterial"),this.addMaterial(SDe,"MeshLambertMaterial"),this.addMaterial(fDe,"MeshNormalMaterial"),this.addMaterial(Mke,"MeshMatcapMaterial"),this.addMaterial(aDe,"LineBasicMaterial"),this.addMaterial(cDe,"LineDashedMaterial"),this.addMaterial(Rke,"PointsMaterial"),this.addMaterial(ZJ,"SpriteMaterial"),this.addMaterial(Dke,"ShadowMaterial"),this.addLight(lLe,A0e),this.addLight(ILe,FY),this.addLight(LLe,P0e),this.addLight(dee,LY),this.addLight(BLe,BY),this.addLight(ULe,T0e),this.addLight(zLe,N0e),this.addLight(FLe,t3e),this.addToneMapping(gIe,mY),this.addToneMapping(yIe,gY),this.addToneMapping(vIe,yY),this.addToneMapping(bIe,vY),this.addToneMapping(TIe,xY),this.addToneMapping(EIe,bY)}}class r3e extends sFe{constructor(e={}){let n;e.forceWebGL?n=Y5:(n=e3e,e.getFallback=()=>(console.warn("THREE.WebGPURenderer: WebGPU is not available, running under WebGL2 backend."),new Y5(e)));const i=new n(e);super(i,e),this.library=new n3e,this.isWebGPURenderer=!0,typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}}const IN={type:"change"},J3={type:"start"},eB={type:"end"},iH=1e-6,_n={NONE:-1,ROTATE:0,ZOOM:1,PAN:2,TOUCH_ROTATE:3,TOUCH_ZOOM_PAN:4},jS=new Fe,Vu=new Fe,i3e=new K,VS=new K,LN=new K,Np=new rl,sH=new K,GS=new K,FN=new K,HS=new K;class s3e extends eA{constructor(e,n=null){super(e,n),this.screen={left:0,top:0,width:0,height:0},this.rotateSpeed=1,this.zoomSpeed=1.2,this.panSpeed=.3,this.noRotate=!1,this.noZoom=!1,this.noPan=!1,this.staticMoving=!1,this.dynamicDampingFactor=.2,this.minDistance=0,this.maxDistance=1/0,this.minZoom=0,this.maxZoom=1/0,this.keys=["KeyA","KeyS","KeyD"],this.mouseButtons={LEFT:Ui.ROTATE,MIDDLE:Ui.DOLLY,RIGHT:Ui.PAN},this.target=new K,this.state=_n.NONE,this.keyState=_n.NONE,this._lastPosition=new K,this._lastZoom=1,this._touchZoomDistanceStart=0,this._touchZoomDistanceEnd=0,this._lastAngle=0,this._eye=new K,this._movePrev=new Fe,this._moveCurr=new Fe,this._lastAxis=new K,this._zoomStart=new Fe,this._zoomEnd=new Fe,this._panStart=new Fe,this._panEnd=new Fe,this._pointers=[],this._pointerPositions={},this._onPointerMove=a3e.bind(this),this._onPointerDown=o3e.bind(this),this._onPointerUp=l3e.bind(this),this._onPointerCancel=c3e.bind(this),this._onContextMenu=g3e.bind(this),this._onMouseWheel=m3e.bind(this),this._onKeyDown=h3e.bind(this),this._onKeyUp=u3e.bind(this),this._onTouchStart=y3e.bind(this),this._onTouchMove=v3e.bind(this),this._onTouchEnd=x3e.bind(this),this._onMouseDown=f3e.bind(this),this._onMouseMove=d3e.bind(this),this._onMouseUp=p3e.bind(this),this._target0=this.target.clone(),this._position0=this.object.position.clone(),this._up0=this.object.up.clone(),this._zoom0=this.object.zoom,n!==null&&(this.connect(n),this.handleResize()),this.update()}connect(e){super.connect(e),window.addEventListener("keydown",this._onKeyDown),window.addEventListener("keyup",this._onKeyUp),this.domElement.addEventListener("pointerdown",this._onPointerDown),this.domElement.addEventListener("pointercancel",this._onPointerCancel),this.domElement.addEventListener("wheel",this._onMouseWheel,{passive:!1}),this.domElement.addEventListener("contextmenu",this._onContextMenu),this.domElement.style.touchAction="none"}disconnect(){window.removeEventListener("keydown",this._onKeyDown),window.removeEventListener("keyup",this._onKeyUp),this.domElement.removeEventListener("pointerdown",this._onPointerDown),this.domElement.removeEventListener("pointermove",this._onPointerMove),this.domElement.removeEventListener("pointerup",this._onPointerUp),this.domElement.removeEventListener("pointercancel",this._onPointerCancel),this.domElement.removeEventListener("wheel",this._onMouseWheel),this.domElement.removeEventListener("contextmenu",this._onContextMenu),this.domElement.style.touchAction="auto"}dispose(){this.disconnect()}handleResize(){const e=this.domElement.getBoundingClientRect(),n=this.domElement.ownerDocument.documentElement;this.screen.left=e.left+window.pageXOffset-n.clientLeft,this.screen.top=e.top+window.pageYOffset-n.clientTop,this.screen.width=e.width,this.screen.height=e.height}update(){this._eye.subVectors(this.object.position,this.target),this.noRotate||this._rotateCamera(),this.noZoom||this._zoomCamera(),this.noPan||this._panCamera(),this.object.position.addVectors(this.target,this._eye),this.object.isPerspectiveCamera?(this._checkDistances(),this.object.lookAt(this.target),this._lastPosition.distanceToSquared(this.object.position)>iH&&(this.dispatchEvent(IN),this._lastPosition.copy(this.object.position))):this.object.isOrthographicCamera?(this.object.lookAt(this.target),(this._lastPosition.distanceToSquared(this.object.position)>iH||this._lastZoom!==this.object.zoom)&&(this.dispatchEvent(IN),this._lastPosition.copy(this.object.position),this._lastZoom=this.object.zoom)):console.warn("THREE.TrackballControls: Unsupported camera type.")}reset(){this.state=_n.NONE,this.keyState=_n.NONE,this.target.copy(this._target0),this.object.position.copy(this._position0),this.object.up.copy(this._up0),this.object.zoom=this._zoom0,this.object.updateProjectionMatrix(),this._eye.subVectors(this.object.position,this.target),this.object.lookAt(this.target),this.dispatchEvent(IN),this._lastPosition.copy(this.object.position),this._lastZoom=this.object.zoom}_panCamera(){if(Vu.copy(this._panEnd).sub(this._panStart),Vu.lengthSq()){if(this.object.isOrthographicCamera){const e=(this.object.right-this.object.left)/this.object.zoom/this.domElement.clientWidth,n=(this.object.top-this.object.bottom)/this.object.zoom/this.domElement.clientWidth;Vu.x*=e,Vu.y*=n}Vu.multiplyScalar(this._eye.length()*this.panSpeed),VS.copy(this._eye).cross(this.object.up).setLength(Vu.x),VS.add(i3e.copy(this.object.up).setLength(Vu.y)),this.object.position.add(VS),this.target.add(VS),this.staticMoving?this._panStart.copy(this._panEnd):this._panStart.add(Vu.subVectors(this._panEnd,this._panStart).multiplyScalar(this.dynamicDampingFactor))}}_rotateCamera(){HS.set(this._moveCurr.x-this._movePrev.x,this._moveCurr.y-this._movePrev.y,0);let e=HS.length();e?(this._eye.copy(this.object.position).sub(this.target),sH.copy(this._eye).normalize(),GS.copy(this.object.up).normalize(),FN.crossVectors(GS,sH).normalize(),GS.setLength(this._moveCurr.y-this._movePrev.y),FN.setLength(this._moveCurr.x-this._movePrev.x),HS.copy(GS.add(FN)),LN.crossVectors(HS,this._eye).normalize(),e*=this.rotateSpeed,Np.setFromAxisAngle(LN,e),this._eye.applyQuaternion(Np),this.object.up.applyQuaternion(Np),this._lastAxis.copy(LN),this._lastAngle=e):!this.staticMoving&&this._lastAngle&&(this._lastAngle*=Math.sqrt(1-this.dynamicDampingFactor),this._eye.copy(this.object.position).sub(this.target),Np.setFromAxisAngle(this._lastAxis,this._lastAngle),this._eye.applyQuaternion(Np),this.object.up.applyQuaternion(Np)),this._movePrev.copy(this._moveCurr)}_zoomCamera(){let e;this.state===_n.TOUCH_ZOOM_PAN?(e=this._touchZoomDistanceStart/this._touchZoomDistanceEnd,this._touchZoomDistanceStart=this._touchZoomDistanceEnd,this.object.isPerspectiveCamera?this._eye.multiplyScalar(e):this.object.isOrthographicCamera?(this.object.zoom=$T.clamp(this.object.zoom/e,this.minZoom,this.maxZoom),this._lastZoom!==this.object.zoom&&this.object.updateProjectionMatrix()):console.warn("THREE.TrackballControls: Unsupported camera type")):(e=1+(this._zoomEnd.y-this._zoomStart.y)*this.zoomSpeed,e!==1&&e>0&&(this.object.isPerspectiveCamera?this._eye.multiplyScalar(e):this.object.isOrthographicCamera?(this.object.zoom=$T.clamp(this.object.zoom/e,this.minZoom,this.maxZoom),this._lastZoom!==this.object.zoom&&this.object.updateProjectionMatrix()):console.warn("THREE.TrackballControls: Unsupported camera type")),this.staticMoving?this._zoomStart.copy(this._zoomEnd):this._zoomStart.y+=(this._zoomEnd.y-this._zoomStart.y)*this.dynamicDampingFactor)}_getMouseOnScreen(e,n){return jS.set((e-this.screen.left)/this.screen.width,(n-this.screen.top)/this.screen.height),jS}_getMouseOnCircle(e,n){return jS.set((e-this.screen.width*.5-this.screen.left)/(this.screen.width*.5),(this.screen.height+2*(this.screen.top-n))/this.screen.width),jS}_addPointer(e){this._pointers.push(e)}_removePointer(e){delete this._pointerPositions[e.pointerId];for(let n=0;n<this._pointers.length;n++)if(this._pointers[n].pointerId==e.pointerId){this._pointers.splice(n,1);return}}_trackPointer(e){let n=this._pointerPositions[e.pointerId];n===void 0&&(n=new Fe,this._pointerPositions[e.pointerId]=n),n.set(e.pageX,e.pageY)}_getSecondPointerPosition(e){const n=e.pointerId===this._pointers[0].pointerId?this._pointers[1]:this._pointers[0];return this._pointerPositions[n.pointerId]}_checkDistances(){(!this.noZoom||!this.noPan)&&(this._eye.lengthSq()>this.maxDistance*this.maxDistance&&(this.object.position.addVectors(this.target,this._eye.setLength(this.maxDistance)),this._zoomStart.copy(this._zoomEnd)),this._eye.lengthSq()<this.minDistance*this.minDistance&&(this.object.position.addVectors(this.target,this._eye.setLength(this.minDistance)),this._zoomStart.copy(this._zoomEnd)))}}function o3e(r){this.enabled!==!1&&(this._pointers.length===0&&(this.domElement.setPointerCapture(r.pointerId),this.domElement.addEventListener("pointermove",this._onPointerMove),this.domElement.addEventListener("pointerup",this._onPointerUp)),this._addPointer(r),r.pointerType==="touch"?this._onTouchStart(r):this._onMouseDown(r))}function a3e(r){this.enabled!==!1&&(r.pointerType==="touch"?this._onTouchMove(r):this._onMouseMove(r))}function l3e(r){this.enabled!==!1&&(r.pointerType==="touch"?this._onTouchEnd(r):this._onMouseUp(),this._removePointer(r),this._pointers.length===0&&(this.domElement.releasePointerCapture(r.pointerId),this.domElement.removeEventListener("pointermove",this._onPointerMove),this.domElement.removeEventListener("pointerup",this._onPointerUp)))}function c3e(r){this._removePointer(r)}function u3e(){this.enabled!==!1&&(this.keyState=_n.NONE,window.addEventListener("keydown",this._onKeyDown))}function h3e(r){this.enabled!==!1&&(window.removeEventListener("keydown",this._onKeyDown),this.keyState===_n.NONE&&(r.code===this.keys[_n.ROTATE]&&!this.noRotate?this.keyState=_n.ROTATE:r.code===this.keys[_n.ZOOM]&&!this.noZoom?this.keyState=_n.ZOOM:r.code===this.keys[_n.PAN]&&!this.noPan&&(this.keyState=_n.PAN)))}function f3e(r){let e;switch(r.button){case 0:e=this.mouseButtons.LEFT;break;case 1:e=this.mouseButtons.MIDDLE;break;case 2:e=this.mouseButtons.RIGHT;break;default:e=-1}switch(e){case Ui.DOLLY:this.state=_n.ZOOM;break;case Ui.ROTATE:this.state=_n.ROTATE;break;case Ui.PAN:this.state=_n.PAN;break;default:this.state=_n.NONE}const n=this.keyState!==_n.NONE?this.keyState:this.state;n===_n.ROTATE&&!this.noRotate?(this._moveCurr.copy(this._getMouseOnCircle(r.pageX,r.pageY)),this._movePrev.copy(this._moveCurr)):n===_n.ZOOM&&!this.noZoom?(this._zoomStart.copy(this._getMouseOnScreen(r.pageX,r.pageY)),this._zoomEnd.copy(this._zoomStart)):n===_n.PAN&&!this.noPan&&(this._panStart.copy(this._getMouseOnScreen(r.pageX,r.pageY)),this._panEnd.copy(this._panStart)),this.dispatchEvent(J3)}function d3e(r){const e=this.keyState!==_n.NONE?this.keyState:this.state;e===_n.ROTATE&&!this.noRotate?(this._movePrev.copy(this._moveCurr),this._moveCurr.copy(this._getMouseOnCircle(r.pageX,r.pageY))):e===_n.ZOOM&&!this.noZoom?this._zoomEnd.copy(this._getMouseOnScreen(r.pageX,r.pageY)):e===_n.PAN&&!this.noPan&&this._panEnd.copy(this._getMouseOnScreen(r.pageX,r.pageY))}function p3e(){this.state=_n.NONE,this.dispatchEvent(eB)}function m3e(r){if(this.enabled!==!1&&this.noZoom!==!0){switch(r.preventDefault(),r.deltaMode){case 2:this._zoomStart.y-=r.deltaY*.025;break;case 1:this._zoomStart.y-=r.deltaY*.01;break;default:this._zoomStart.y-=r.deltaY*25e-5;break}this.dispatchEvent(J3),this.dispatchEvent(eB)}}function g3e(r){this.enabled!==!1&&r.preventDefault()}function y3e(r){switch(this._trackPointer(r),this._pointers.length){case 1:this.state=_n.TOUCH_ROTATE,this._moveCurr.copy(this._getMouseOnCircle(this._pointers[0].pageX,this._pointers[0].pageY)),this._movePrev.copy(this._moveCurr);break;default:this.state=_n.TOUCH_ZOOM_PAN;const e=this._pointers[0].pageX-this._pointers[1].pageX,n=this._pointers[0].pageY-this._pointers[1].pageY;this._touchZoomDistanceEnd=this._touchZoomDistanceStart=Math.sqrt(e*e+n*n);const i=(this._pointers[0].pageX+this._pointers[1].pageX)/2,s=(this._pointers[0].pageY+this._pointers[1].pageY)/2;this._panStart.copy(this._getMouseOnScreen(i,s)),this._panEnd.copy(this._panStart);break}this.dispatchEvent(J3)}function v3e(r){switch(this._trackPointer(r),this._pointers.length){case 1:this._movePrev.copy(this._moveCurr),this._moveCurr.copy(this._getMouseOnCircle(r.pageX,r.pageY));break;default:const e=this._getSecondPointerPosition(r),n=r.pageX-e.x,i=r.pageY-e.y;this._touchZoomDistanceEnd=Math.sqrt(n*n+i*i);const s=(r.pageX+e.x)/2,o=(r.pageY+e.y)/2;this._panEnd.copy(this._getMouseOnScreen(s,o));break}}function x3e(r){switch(this._pointers.length){case 0:this.state=_n.NONE;break;case 1:this.state=_n.TOUCH_ROTATE,this._moveCurr.copy(this._getMouseOnCircle(r.pageX,r.pageY)),this._movePrev.copy(this._moveCurr);break;case 2:this.state=_n.TOUCH_ZOOM_PAN;for(let e=0;e<this._pointers.length;e++)if(this._pointers[e].pointerId!==r.pointerId){const n=this._pointerPositions[this._pointers[e].pointerId];this._moveCurr.copy(this._getMouseOnCircle(n.x,n.y)),this._movePrev.copy(this._moveCurr);break}break}this.dispatchEvent(eB)}const oH={type:"change"},tB={type:"start"},Eee={type:"end"},WS=new YM,aH=new To,b3e=Math.cos(70*$T.DEG2RAD),ni=new K,js=2*Math.PI,Rn={NONE:-1,ROTATE:0,DOLLY:1,PAN:2,TOUCH_ROTATE:3,TOUCH_PAN:4,TOUCH_DOLLY_PAN:5,TOUCH_DOLLY_ROTATE:6},BN=1e-6;class _3e extends eA{constructor(e,n=null){super(e,n),this.state=Rn.NONE,this.target=new K,this.cursor=new K,this.minDistance=0,this.maxDistance=1/0,this.minZoom=0,this.maxZoom=1/0,this.minTargetRadius=0,this.maxTargetRadius=1/0,this.minPolarAngle=0,this.maxPolarAngle=Math.PI,this.minAzimuthAngle=-1/0,this.maxAzimuthAngle=1/0,this.enableDamping=!1,this.dampingFactor=.05,this.enableZoom=!0,this.zoomSpeed=1,this.enableRotate=!0,this.rotateSpeed=1,this.keyRotateSpeed=1,this.enablePan=!0,this.panSpeed=1,this.screenSpacePanning=!0,this.keyPanSpeed=7,this.zoomToCursor=!1,this.autoRotate=!1,this.autoRotateSpeed=2,this.keys={LEFT:"ArrowLeft",UP:"ArrowUp",RIGHT:"ArrowRight",BOTTOM:"ArrowDown"},this.mouseButtons={LEFT:Ui.ROTATE,MIDDLE:Ui.DOLLY,RIGHT:Ui.PAN},this.touches={ONE:Oc.ROTATE,TWO:Oc.DOLLY_PAN},this.target0=this.target.clone(),this.position0=this.object.position.clone(),this.zoom0=this.object.zoom,this._domElementKeyEvents=null,this._lastPosition=new K,this._lastQuaternion=new rl,this._lastTargetPosition=new K,this._quat=new rl().setFromUnitVectors(e.up,new K(0,1,0)),this._quatInverse=this._quat.clone().invert(),this._spherical=new FV,this._sphericalDelta=new FV,this._scale=1,this._panOffset=new K,this._rotateStart=new Fe,this._rotateEnd=new Fe,this._rotateDelta=new Fe,this._panStart=new Fe,this._panEnd=new Fe,this._panDelta=new Fe,this._dollyStart=new Fe,this._dollyEnd=new Fe,this._dollyDelta=new Fe,this._dollyDirection=new K,this._mouse=new Fe,this._performCursorZoom=!1,this._pointers=[],this._pointerPositions={},this._controlActive=!1,this._onPointerMove=S3e.bind(this),this._onPointerDown=w3e.bind(this),this._onPointerUp=T3e.bind(this),this._onContextMenu=N3e.bind(this),this._onMouseWheel=A3e.bind(this),this._onKeyDown=C3e.bind(this),this._onTouchStart=P3e.bind(this),this._onTouchMove=R3e.bind(this),this._onMouseDown=E3e.bind(this),this._onMouseMove=M3e.bind(this),this._interceptControlDown=O3e.bind(this),this._interceptControlUp=D3e.bind(this),this.domElement!==null&&this.connect(this.domElement),this.update()}connect(e){super.connect(e),this.domElement.addEventListener("pointerdown",this._onPointerDown),this.domElement.addEventListener("pointercancel",this._onPointerUp),this.domElement.addEventListener("contextmenu",this._onContextMenu),this.domElement.addEventListener("wheel",this._onMouseWheel,{passive:!1}),this.domElement.getRootNode().addEventListener("keydown",this._interceptControlDown,{passive:!0,capture:!0}),this.domElement.style.touchAction="none"}disconnect(){this.domElement.removeEventListener("pointerdown",this._onPointerDown),this.domElement.removeEventListener("pointermove",this._onPointerMove),this.domElement.removeEventListener("pointerup",this._onPointerUp),this.domElement.removeEventListener("pointercancel",this._onPointerUp),this.domElement.removeEventListener("wheel",this._onMouseWheel),this.domElement.removeEventListener("contextmenu",this._onContextMenu),this.stopListenToKeyEvents(),this.domElement.getRootNode().removeEventListener("keydown",this._interceptControlDown,{capture:!0}),this.domElement.style.touchAction="auto"}dispose(){this.disconnect()}getPolarAngle(){return this._spherical.phi}getAzimuthalAngle(){return this._spherical.theta}getDistance(){return this.object.position.distanceTo(this.target)}listenToKeyEvents(e){e.addEventListener("keydown",this._onKeyDown),this._domElementKeyEvents=e}stopListenToKeyEvents(){this._domElementKeyEvents!==null&&(this._domElementKeyEvents.removeEventListener("keydown",this._onKeyDown),this._domElementKeyEvents=null)}saveState(){this.target0.copy(this.target),this.position0.copy(this.object.position),this.zoom0=this.object.zoom}reset(){this.target.copy(this.target0),this.object.position.copy(this.position0),this.object.zoom=this.zoom0,this.object.updateProjectionMatrix(),this.dispatchEvent(oH),this.update(),this.state=Rn.NONE}update(e=null){const n=this.object.position;ni.copy(n).sub(this.target),ni.applyQuaternion(this._quat),this._spherical.setFromVector3(ni),this.autoRotate&&this.state===Rn.NONE&&this._rotateLeft(this._getAutoRotationAngle(e)),this.enableDamping?(this._spherical.theta+=this._sphericalDelta.theta*this.dampingFactor,this._spherical.phi+=this._sphericalDelta.phi*this.dampingFactor):(this._spherical.theta+=this._sphericalDelta.theta,this._spherical.phi+=this._sphericalDelta.phi);let i=this.minAzimuthAngle,s=this.maxAzimuthAngle;isFinite(i)&&isFinite(s)&&(i<-Math.PI?i+=js:i>Math.PI&&(i-=js),s<-Math.PI?s+=js:s>Math.PI&&(s-=js),i<=s?this._spherical.theta=Math.max(i,Math.min(s,this._spherical.theta)):this._spherical.theta=this._spherical.theta>(i+s)/2?Math.max(i,this._spherical.theta):Math.min(s,this._spherical.theta)),this._spherical.phi=Math.max(this.minPolarAngle,Math.min(this.maxPolarAngle,this._spherical.phi)),this._spherical.makeSafe(),this.enableDamping===!0?this.target.addScaledVector(this._panOffset,this.dampingFactor):this.target.add(this._panOffset),this.target.sub(this.cursor),this.target.clampLength(this.minTargetRadius,this.maxTargetRadius),this.target.add(this.cursor);let o=!1;if(this.zoomToCursor&&this._performCursorZoom||this.object.isOrthographicCamera)this._spherical.radius=this._clampDistance(this._spherical.radius);else{const a=this._spherical.radius;this._spherical.radius=this._clampDistance(this._spherical.radius*this._scale),o=a!=this._spherical.radius}if(ni.setFromSpherical(this._spherical),ni.applyQuaternion(this._quatInverse),n.copy(this.target).add(ni),this.object.lookAt(this.target),this.enableDamping===!0?(this._sphericalDelta.theta*=1-this.dampingFactor,this._sphericalDelta.phi*=1-this.dampingFactor,this._panOffset.multiplyScalar(1-this.dampingFactor)):(this._sphericalDelta.set(0,0,0),this._panOffset.set(0,0,0)),this.zoomToCursor&&this._performCursorZoom){let a=null;if(this.object.isPerspectiveCamera){const l=ni.length();a=this._clampDistance(l*this._scale);const c=l-a;this.object.position.addScaledVector(this._dollyDirection,c),this.object.updateMatrixWorld(),o=!!c}else if(this.object.isOrthographicCamera){const l=new K(this._mouse.x,this._mouse.y,0);l.unproject(this.object);const c=this.object.zoom;this.object.zoom=Math.max(this.minZoom,Math.min(this.maxZoom,this.object.zoom/this._scale)),this.object.updateProjectionMatrix(),o=c!==this.object.zoom;const u=new K(this._mouse.x,this._mouse.y,0);u.unproject(this.object),this.object.position.sub(u).add(l),this.object.updateMatrixWorld(),a=ni.length()}else console.warn("WARNING: OrbitControls.js encountered an unknown camera type - zoom to cursor disabled."),this.zoomToCursor=!1;a!==null&&(this.screenSpacePanning?this.target.set(0,0,-1).transformDirection(this.object.matrix).multiplyScalar(a).add(this.object.position):(WS.origin.copy(this.object.position),WS.direction.set(0,0,-1).transformDirection(this.object.matrix),Math.abs(this.object.up.dot(WS.direction))<b3e?this.object.lookAt(this.target):(aH.setFromNormalAndCoplanarPoint(this.object.up,this.target),WS.intersectPlane(aH,this.target))))}else if(this.object.isOrthographicCamera){const a=this.object.zoom;this.object.zoom=Math.max(this.minZoom,Math.min(this.maxZoom,this.object.zoom/this._scale)),a!==this.object.zoom&&(this.object.updateProjectionMatrix(),o=!0)}return this._scale=1,this._performCursorZoom=!1,o||this._lastPosition.distanceToSquared(this.object.position)>BN||8*(1-this._lastQuaternion.dot(this.object.quaternion))>BN||this._lastTargetPosition.distanceToSquared(this.target)>BN?(this.dispatchEvent(oH),this._lastPosition.copy(this.object.position),this._lastQuaternion.copy(this.object.quaternion),this._lastTargetPosition.copy(this.target),!0):!1}_getAutoRotationAngle(e){return e!==null?js/60*this.autoRotateSpeed*e:js/60/60*this.autoRotateSpeed}_getZoomScale(e){const n=Math.abs(e*.01);return Math.pow(.95,this.zoomSpeed*n)}_rotateLeft(e){this._sphericalDelta.theta-=e}_rotateUp(e){this._sphericalDelta.phi-=e}_panLeft(e,n){ni.setFromMatrixColumn(n,0),ni.multiplyScalar(-e),this._panOffset.add(ni)}_panUp(e,n){this.screenSpacePanning===!0?ni.setFromMatrixColumn(n,1):(ni.setFromMatrixColumn(n,0),ni.crossVectors(this.object.up,ni)),ni.multiplyScalar(e),this._panOffset.add(ni)}_pan(e,n){const i=this.domElement;if(this.object.isPerspectiveCamera){const s=this.object.position;ni.copy(s).sub(this.target);let o=ni.length();o*=Math.tan(this.object.fov/2*Math.PI/180),this._panLeft(2*e*o/i.clientHeight,this.object.matrix),this._panUp(2*n*o/i.clientHeight,this.object.matrix)}else this.object.isOrthographicCamera?(this._panLeft(e*(this.object.right-this.object.left)/this.object.zoom/i.clientWidth,this.object.matrix),this._panUp(n*(this.object.top-this.object.bottom)/this.object.zoom/i.clientHeight,this.object.matrix)):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - pan disabled."),this.enablePan=!1)}_dollyOut(e){this.object.isPerspectiveCamera||this.object.isOrthographicCamera?this._scale/=e:(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),this.enableZoom=!1)}_dollyIn(e){this.object.isPerspectiveCamera||this.object.isOrthographicCamera?this._scale*=e:(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),this.enableZoom=!1)}_updateZoomParameters(e,n){if(!this.zoomToCursor)return;this._performCursorZoom=!0;const i=this.domElement.getBoundingClientRect(),s=e-i.left,o=n-i.top,a=i.width,l=i.height;this._mouse.x=s/a*2-1,this._mouse.y=-(o/l)*2+1,this._dollyDirection.set(this._mouse.x,this._mouse.y,1).unproject(this.object).sub(this.object.position).normalize()}_clampDistance(e){return Math.max(this.minDistance,Math.min(this.maxDistance,e))}_handleMouseDownRotate(e){this._rotateStart.set(e.clientX,e.clientY)}_handleMouseDownDolly(e){this._updateZoomParameters(e.clientX,e.clientX),this._dollyStart.set(e.clientX,e.clientY)}_handleMouseDownPan(e){this._panStart.set(e.clientX,e.clientY)}_handleMouseMoveRotate(e){this._rotateEnd.set(e.clientX,e.clientY),this._rotateDelta.subVectors(this._rotateEnd,this._rotateStart).multiplyScalar(this.rotateSpeed);const n=this.domElement;this._rotateLeft(js*this._rotateDelta.x/n.clientHeight),this._rotateUp(js*this._rotateDelta.y/n.clientHeight),this._rotateStart.copy(this._rotateEnd),this.update()}_handleMouseMoveDolly(e){this._dollyEnd.set(e.clientX,e.clientY),this._dollyDelta.subVectors(this._dollyEnd,this._dollyStart),this._dollyDelta.y>0?this._dollyOut(this._getZoomScale(this._dollyDelta.y)):this._dollyDelta.y<0&&this._dollyIn(this._getZoomScale(this._dollyDelta.y)),this._dollyStart.copy(this._dollyEnd),this.update()}_handleMouseMovePan(e){this._panEnd.set(e.clientX,e.clientY),this._panDelta.subVectors(this._panEnd,this._panStart).multiplyScalar(this.panSpeed),this._pan(this._panDelta.x,this._panDelta.y),this._panStart.copy(this._panEnd),this.update()}_handleMouseWheel(e){this._updateZoomParameters(e.clientX,e.clientY),e.deltaY<0?this._dollyIn(this._getZoomScale(e.deltaY)):e.deltaY>0&&this._dollyOut(this._getZoomScale(e.deltaY)),this.update()}_handleKeyDown(e){let n=!1;switch(e.code){case this.keys.UP:e.ctrlKey||e.metaKey||e.shiftKey?this.enableRotate&&this._rotateUp(js*this.keyRotateSpeed/this.domElement.clientHeight):this.enablePan&&this._pan(0,this.keyPanSpeed),n=!0;break;case this.keys.BOTTOM:e.ctrlKey||e.metaKey||e.shiftKey?this.enableRotate&&this._rotateUp(-js*this.keyRotateSpeed/this.domElement.clientHeight):this.enablePan&&this._pan(0,-this.keyPanSpeed),n=!0;break;case this.keys.LEFT:e.ctrlKey||e.metaKey||e.shiftKey?this.enableRotate&&this._rotateLeft(js*this.keyRotateSpeed/this.domElement.clientHeight):this.enablePan&&this._pan(this.keyPanSpeed,0),n=!0;break;case this.keys.RIGHT:e.ctrlKey||e.metaKey||e.shiftKey?this.enableRotate&&this._rotateLeft(-js*this.keyRotateSpeed/this.domElement.clientHeight):this.enablePan&&this._pan(-this.keyPanSpeed,0),n=!0;break}n&&(e.preventDefault(),this.update())}_handleTouchStartRotate(e){if(this._pointers.length===1)this._rotateStart.set(e.pageX,e.pageY);else{const n=this._getSecondPointerPosition(e),i=.5*(e.pageX+n.x),s=.5*(e.pageY+n.y);this._rotateStart.set(i,s)}}_handleTouchStartPan(e){if(this._pointers.length===1)this._panStart.set(e.pageX,e.pageY);else{const n=this._getSecondPointerPosition(e),i=.5*(e.pageX+n.x),s=.5*(e.pageY+n.y);this._panStart.set(i,s)}}_handleTouchStartDolly(e){const n=this._getSecondPointerPosition(e),i=e.pageX-n.x,s=e.pageY-n.y,o=Math.sqrt(i*i+s*s);this._dollyStart.set(0,o)}_handleTouchStartDollyPan(e){this.enableZoom&&this._handleTouchStartDolly(e),this.enablePan&&this._handleTouchStartPan(e)}_handleTouchStartDollyRotate(e){this.enableZoom&&this._handleTouchStartDolly(e),this.enableRotate&&this._handleTouchStartRotate(e)}_handleTouchMoveRotate(e){if(this._pointers.length==1)this._rotateEnd.set(e.pageX,e.pageY);else{const i=this._getSecondPointerPosition(e),s=.5*(e.pageX+i.x),o=.5*(e.pageY+i.y);this._rotateEnd.set(s,o)}this._rotateDelta.subVectors(this._rotateEnd,this._rotateStart).multiplyScalar(this.rotateSpeed);const n=this.domElement;this._rotateLeft(js*this._rotateDelta.x/n.clientHeight),this._rotateUp(js*this._rotateDelta.y/n.clientHeight),this._rotateStart.copy(this._rotateEnd)}_handleTouchMovePan(e){if(this._pointers.length===1)this._panEnd.set(e.pageX,e.pageY);else{const n=this._getSecondPointerPosition(e),i=.5*(e.pageX+n.x),s=.5*(e.pageY+n.y);this._panEnd.set(i,s)}this._panDelta.subVectors(this._panEnd,this._panStart).multiplyScalar(this.panSpeed),this._pan(this._panDelta.x,this._panDelta.y),this._panStart.copy(this._panEnd)}_handleTouchMoveDolly(e){const n=this._getSecondPointerPosition(e),i=e.pageX-n.x,s=e.pageY-n.y,o=Math.sqrt(i*i+s*s);this._dollyEnd.set(0,o),this._dollyDelta.set(0,Math.pow(this._dollyEnd.y/this._dollyStart.y,this.zoomSpeed)),this._dollyOut(this._dollyDelta.y),this._dollyStart.copy(this._dollyEnd);const a=(e.pageX+n.x)*.5,l=(e.pageY+n.y)*.5;this._updateZoomParameters(a,l)}_handleTouchMoveDollyPan(e){this.enableZoom&&this._handleTouchMoveDolly(e),this.enablePan&&this._handleTouchMovePan(e)}_handleTouchMoveDollyRotate(e){this.enableZoom&&this._handleTouchMoveDolly(e),this.enableRotate&&this._handleTouchMoveRotate(e)}_addPointer(e){this._pointers.push(e.pointerId)}_removePointer(e){delete this._pointerPositions[e.pointerId];for(let n=0;n<this._pointers.length;n++)if(this._pointers[n]==e.pointerId){this._pointers.splice(n,1);return}}_isTrackingPointer(e){for(let n=0;n<this._pointers.length;n++)if(this._pointers[n]==e.pointerId)return!0;return!1}_trackPointer(e){let n=this._pointerPositions[e.pointerId];n===void 0&&(n=new Fe,this._pointerPositions[e.pointerId]=n),n.set(e.pageX,e.pageY)}_getSecondPointerPosition(e){const n=e.pointerId===this._pointers[0]?this._pointers[1]:this._pointers[0];return this._pointerPositions[n]}_customWheelEvent(e){const n=e.deltaMode,i={clientX:e.clientX,clientY:e.clientY,deltaY:e.deltaY};switch(n){case 1:i.deltaY*=16;break;case 2:i.deltaY*=100;break}return e.ctrlKey&&!this._controlActive&&(i.deltaY*=10),i}}function w3e(r){this.enabled!==!1&&(this._pointers.length===0&&(this.domElement.setPointerCapture(r.pointerId),this.domElement.addEventListener("pointermove",this._onPointerMove),this.domElement.addEventListener("pointerup",this._onPointerUp)),!this._isTrackingPointer(r)&&(this._addPointer(r),r.pointerType==="touch"?this._onTouchStart(r):this._onMouseDown(r)))}function S3e(r){this.enabled!==!1&&(r.pointerType==="touch"?this._onTouchMove(r):this._onMouseMove(r))}function T3e(r){switch(this._removePointer(r),this._pointers.length){case 0:this.domElement.releasePointerCapture(r.pointerId),this.domElement.removeEventListener("pointermove",this._onPointerMove),this.domElement.removeEventListener("pointerup",this._onPointerUp),this.dispatchEvent(Eee),this.state=Rn.NONE;break;case 1:const e=this._pointers[0],n=this._pointerPositions[e];this._onTouchStart({pointerId:e,pageX:n.x,pageY:n.y});break}}function E3e(r){let e;switch(r.button){case 0:e=this.mouseButtons.LEFT;break;case 1:e=this.mouseButtons.MIDDLE;break;case 2:e=this.mouseButtons.RIGHT;break;default:e=-1}switch(e){case Ui.DOLLY:if(this.enableZoom===!1)return;this._handleMouseDownDolly(r),this.state=Rn.DOLLY;break;case Ui.ROTATE:if(r.ctrlKey||r.metaKey||r.shiftKey){if(this.enablePan===!1)return;this._handleMouseDownPan(r),this.state=Rn.PAN}else{if(this.enableRotate===!1)return;this._handleMouseDownRotate(r),this.state=Rn.ROTATE}break;case Ui.PAN:if(r.ctrlKey||r.metaKey||r.shiftKey){if(this.enableRotate===!1)return;this._handleMouseDownRotate(r),this.state=Rn.ROTATE}else{if(this.enablePan===!1)return;this._handleMouseDownPan(r),this.state=Rn.PAN}break;default:this.state=Rn.NONE}this.state!==Rn.NONE&&this.dispatchEvent(tB)}function M3e(r){switch(this.state){case Rn.ROTATE:if(this.enableRotate===!1)return;this._handleMouseMoveRotate(r);break;case Rn.DOLLY:if(this.enableZoom===!1)return;this._handleMouseMoveDolly(r);break;case Rn.PAN:if(this.enablePan===!1)return;this._handleMouseMovePan(r);break}}function A3e(r){this.enabled===!1||this.enableZoom===!1||this.state!==Rn.NONE||(r.preventDefault(),this.dispatchEvent(tB),this._handleMouseWheel(this._customWheelEvent(r)),this.dispatchEvent(Eee))}function C3e(r){this.enabled!==!1&&this._handleKeyDown(r)}function P3e(r){switch(this._trackPointer(r),this._pointers.length){case 1:switch(this.touches.ONE){case Oc.ROTATE:if(this.enableRotate===!1)return;this._handleTouchStartRotate(r),this.state=Rn.TOUCH_ROTATE;break;case Oc.PAN:if(this.enablePan===!1)return;this._handleTouchStartPan(r),this.state=Rn.TOUCH_PAN;break;default:this.state=Rn.NONE}break;case 2:switch(this.touches.TWO){case Oc.DOLLY_PAN:if(this.enableZoom===!1&&this.enablePan===!1)return;this._handleTouchStartDollyPan(r),this.state=Rn.TOUCH_DOLLY_PAN;break;case Oc.DOLLY_ROTATE:if(this.enableZoom===!1&&this.enableRotate===!1)return;this._handleTouchStartDollyRotate(r),this.state=Rn.TOUCH_DOLLY_ROTATE;break;default:this.state=Rn.NONE}break;default:this.state=Rn.NONE}this.state!==Rn.NONE&&this.dispatchEvent(tB)}function R3e(r){switch(this._trackPointer(r),this.state){case Rn.TOUCH_ROTATE:if(this.enableRotate===!1)return;this._handleTouchMoveRotate(r),this.update();break;case Rn.TOUCH_PAN:if(this.enablePan===!1)return;this._handleTouchMovePan(r),this.update();break;case Rn.TOUCH_DOLLY_PAN:if(this.enableZoom===!1&&this.enablePan===!1)return;this._handleTouchMoveDollyPan(r),this.update();break;case Rn.TOUCH_DOLLY_ROTATE:if(this.enableZoom===!1&&this.enableRotate===!1)return;this._handleTouchMoveDollyRotate(r),this.update();break;default:this.state=Rn.NONE}}function N3e(r){this.enabled!==!1&&r.preventDefault()}function O3e(r){r.key==="Control"&&(this._controlActive=!0,this.domElement.getRootNode().addEventListener("keyup",this._interceptControlUp,{passive:!0,capture:!0}))}function D3e(r){r.key==="Control"&&(this._controlActive=!1,this.domElement.getRootNode().removeEventListener("keyup",this._interceptControlUp,{passive:!0,capture:!0}))}const k3e={type:"change"},lH=1e-6,cH=new rl;class I3e extends eA{constructor(e,n=null){super(e,n),this.movementSpeed=1,this.rollSpeed=.005,this.dragToLook=!1,this.autoForward=!1,this._moveState={up:0,down:0,left:0,right:0,forward:0,back:0,pitchUp:0,pitchDown:0,yawLeft:0,yawRight:0,rollLeft:0,rollRight:0},this._moveVector=new K(0,0,0),this._rotationVector=new K(0,0,0),this._lastQuaternion=new rl,this._lastPosition=new K,this._status=0,this._onKeyDown=L3e.bind(this),this._onKeyUp=F3e.bind(this),this._onPointerMove=U3e.bind(this),this._onPointerDown=B3e.bind(this),this._onPointerUp=z3e.bind(this),this._onPointerCancel=$3e.bind(this),this._onContextMenu=j3e.bind(this),n!==null&&this.connect(n)}connect(e){super.connect(e),window.addEventListener("keydown",this._onKeyDown),window.addEventListener("keyup",this._onKeyUp),this.domElement.addEventListener("pointermove",this._onPointerMove),this.domElement.addEventListener("pointerdown",this._onPointerDown),this.domElement.addEventListener("pointerup",this._onPointerUp),this.domElement.addEventListener("pointercancel",this._onPointerCancel),this.domElement.addEventListener("contextmenu",this._onContextMenu)}disconnect(){window.removeEventListener("keydown",this._onKeyDown),window.removeEventListener("keyup",this._onKeyUp),this.domElement.removeEventListener("pointermove",this._onPointerMove),this.domElement.removeEventListener("pointerdown",this._onPointerDown),this.domElement.removeEventListener("pointerup",this._onPointerUp),this.domElement.removeEventListener("pointercancel",this._onPointerCancel),this.domElement.removeEventListener("contextmenu",this._onContextMenu)}dispose(){this.disconnect()}update(e){if(this.enabled===!1)return;const n=this.object,i=e*this.movementSpeed,s=e*this.rollSpeed;n.translateX(this._moveVector.x*i),n.translateY(this._moveVector.y*i),n.translateZ(this._moveVector.z*i),cH.set(this._rotationVector.x*s,this._rotationVector.y*s,this._rotationVector.z*s,1).normalize(),n.quaternion.multiply(cH),(this._lastPosition.distanceToSquared(n.position)>lH||8*(1-this._lastQuaternion.dot(n.quaternion))>lH)&&(this.dispatchEvent(k3e),this._lastQuaternion.copy(n.quaternion),this._lastPosition.copy(n.position))}_updateMovementVector(){const e=this._moveState.forward||this.autoForward&&!this._moveState.back?1:0;this._moveVector.x=-this._moveState.left+this._moveState.right,this._moveVector.y=-this._moveState.down+this._moveState.up,this._moveVector.z=-e+this._moveState.back}_updateRotationVector(){this._rotationVector.x=-this._moveState.pitchDown+this._moveState.pitchUp,this._rotationVector.y=-this._moveState.yawRight+this._moveState.yawLeft,this._rotationVector.z=-this._moveState.rollRight+this._moveState.rollLeft}_getContainerDimensions(){return this.domElement!=document?{size:[this.domElement.offsetWidth,this.domElement.offsetHeight],offset:[this.domElement.offsetLeft,this.domElement.offsetTop]}:{size:[window.innerWidth,window.innerHeight],offset:[0,0]}}}function L3e(r){if(!(r.altKey||this.enabled===!1)){switch(r.code){case"ShiftLeft":case"ShiftRight":this.movementSpeedMultiplier=.1;break;case"KeyW":this._moveState.forward=1;break;case"KeyS":this._moveState.back=1;break;case"KeyA":this._moveState.left=1;break;case"KeyD":this._moveState.right=1;break;case"KeyR":this._moveState.up=1;break;case"KeyF":this._moveState.down=1;break;case"ArrowUp":this._moveState.pitchUp=1;break;case"ArrowDown":this._moveState.pitchDown=1;break;case"ArrowLeft":this._moveState.yawLeft=1;break;case"ArrowRight":this._moveState.yawRight=1;break;case"KeyQ":this._moveState.rollLeft=1;break;case"KeyE":this._moveState.rollRight=1;break}this._updateMovementVector(),this._updateRotationVector()}}function F3e(r){if(this.enabled!==!1){switch(r.code){case"ShiftLeft":case"ShiftRight":this.movementSpeedMultiplier=1;break;case"KeyW":this._moveState.forward=0;break;case"KeyS":this._moveState.back=0;break;case"KeyA":this._moveState.left=0;break;case"KeyD":this._moveState.right=0;break;case"KeyR":this._moveState.up=0;break;case"KeyF":this._moveState.down=0;break;case"ArrowUp":this._moveState.pitchUp=0;break;case"ArrowDown":this._moveState.pitchDown=0;break;case"ArrowLeft":this._moveState.yawLeft=0;break;case"ArrowRight":this._moveState.yawRight=0;break;case"KeyQ":this._moveState.rollLeft=0;break;case"KeyE":this._moveState.rollRight=0;break}this._updateMovementVector(),this._updateRotationVector()}}function B3e(r){if(this.enabled!==!1)if(this.dragToLook)this._status++;else{switch(r.button){case 0:this._moveState.forward=1;break;case 2:this._moveState.back=1;break}this._updateMovementVector()}}function U3e(r){if(this.enabled!==!1&&(!this.dragToLook||this._status>0)){const e=this._getContainerDimensions(),n=e.size[0]/2,i=e.size[1]/2;this._moveState.yawLeft=-(r.pageX-e.offset[0]-n)/n,this._moveState.pitchDown=(r.pageY-e.offset[1]-i)/i,this._updateRotationVector()}}function z3e(r){if(this.enabled!==!1){if(this.dragToLook)this._status--,this._moveState.yawLeft=this._moveState.pitchDown=0;else{switch(r.button){case 0:this._moveState.forward=0;break;case 2:this._moveState.back=0;break}this._updateMovementVector()}this._updateRotationVector()}}function $3e(){this.enabled!==!1&&(this.dragToLook?(this._status=0,this._moveState.yawLeft=this._moveState.pitchDown=0):(this._moveState.forward=0,this._moveState.back=0,this._updateMovementVector()),this._updateRotationVector())}function j3e(r){this.enabled!==!1&&r.preventDefault()}const V3e={name:"CopyShader",uniforms:{tDiffuse:{value:null},opacity:{value:1}},vertexShader:`

		varying vec2 vUv;

		void main() {

			vUv = uv;
			gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );

		}`,fragmentShader:`

		uniform float opacity;

		uniform sampler2D tDiffuse;

		varying vec2 vUv;

		void main() {

			vec4 texel = texture2D( tDiffuse, vUv );
			gl_FragColor = opacity * texel;


		}`};class CA{constructor(){this.isPass=!0,this.enabled=!0,this.needsSwap=!0,this.clear=!1,this.renderToScreen=!1}setSize(){}render(){console.error("THREE.Pass: .render() must be implemented in derived pass.")}dispose(){}}const G3e=new y_(-1,1,1,-1,0,1);class H3e extends ji{constructor(){super(),this.setAttribute("position",new Dr([-1,3,0,-1,-1,0,3,-1,0],3)),this.setAttribute("uv",new Dr([0,2,0,0,2,0],2))}}const W3e=new H3e;class q3e{constructor(e){this._mesh=new Jn(W3e,e)}dispose(){this._mesh.geometry.dispose()}render(e){e.render(this._mesh,G3e)}get material(){return this._mesh.material}set material(e){this._mesh.material=e}}class X3e extends CA{constructor(e,n="tDiffuse"){super(),this.textureID=n,this.uniforms=null,this.material=null,e instanceof Bl?(this.uniforms=e.uniforms,this.material=e):e&&(this.uniforms=MY.clone(e.uniforms),this.material=new Bl({name:e.name!==void 0?e.name:"unspecified",defines:Object.assign({},e.defines),uniforms:this.uniforms,vertexShader:e.vertexShader,fragmentShader:e.fragmentShader})),this._fsQuad=new q3e(this.material)}render(e,n,i){this.uniforms[this.textureID]&&(this.uniforms[this.textureID].value=i.texture),this._fsQuad.material=this.material,this.renderToScreen?(e.setRenderTarget(null),this._fsQuad.render(e)):(e.setRenderTarget(n),this.clear&&e.clear(e.autoClearColor,e.autoClearDepth,e.autoClearStencil),this._fsQuad.render(e))}dispose(){this.material.dispose(),this._fsQuad.dispose()}}class uH extends CA{constructor(e,n){super(),this.scene=e,this.camera=n,this.clear=!0,this.needsSwap=!1,this.inverse=!1}render(e,n,i){const s=e.getContext(),o=e.state;o.buffers.color.setMask(!1),o.buffers.depth.setMask(!1),o.buffers.color.setLocked(!0),o.buffers.depth.setLocked(!0);let a,l;this.inverse?(a=0,l=1):(a=1,l=0),o.buffers.stencil.setTest(!0),o.buffers.stencil.setOp(s.REPLACE,s.REPLACE,s.REPLACE),o.buffers.stencil.setFunc(s.ALWAYS,a,4294967295),o.buffers.stencil.setClear(l),o.buffers.stencil.setLocked(!0),e.setRenderTarget(i),this.clear&&e.clear(),e.render(this.scene,this.camera),e.setRenderTarget(n),this.clear&&e.clear(),e.render(this.scene,this.camera),o.buffers.color.setLocked(!1),o.buffers.depth.setLocked(!1),o.buffers.color.setMask(!0),o.buffers.depth.setMask(!0),o.buffers.stencil.setLocked(!1),o.buffers.stencil.setFunc(s.EQUAL,1,4294967295),o.buffers.stencil.setOp(s.KEEP,s.KEEP,s.KEEP),o.buffers.stencil.setLocked(!0)}}class K3e extends CA{constructor(){super(),this.needsSwap=!1}render(e){e.state.buffers.stencil.setLocked(!1),e.state.buffers.stencil.setTest(!1)}}class Y3e{constructor(e,n){if(this.renderer=e,this._pixelRatio=e.getPixelRatio(),n===void 0){const i=e.getSize(new Fe);this._width=i.width,this._height=i.height,n=new Rh(this._width*this._pixelRatio,this._height*this._pixelRatio,{type:Ei}),n.texture.name="EffectComposer.rt1"}else this._width=n.width,this._height=n.height;this.renderTarget1=n,this.renderTarget2=n.clone(),this.renderTarget2.texture.name="EffectComposer.rt2",this.writeBuffer=this.renderTarget1,this.readBuffer=this.renderTarget2,this.renderToScreen=!0,this.passes=[],this.copyPass=new X3e(V3e),this.copyPass.material.blending=ro,this.clock=new zY}swapBuffers(){const e=this.readBuffer;this.readBuffer=this.writeBuffer,this.writeBuffer=e}addPass(e){this.passes.push(e),e.setSize(this._width*this._pixelRatio,this._height*this._pixelRatio)}insertPass(e,n){this.passes.splice(n,0,e),e.setSize(this._width*this._pixelRatio,this._height*this._pixelRatio)}removePass(e){const n=this.passes.indexOf(e);n!==-1&&this.passes.splice(n,1)}isLastEnabledPass(e){for(let n=e+1;n<this.passes.length;n++)if(this.passes[n].enabled)return!1;return!0}render(e){e===void 0&&(e=this.clock.getDelta());const n=this.renderer.getRenderTarget();let i=!1;for(let s=0,o=this.passes.length;s<o;s++){const a=this.passes[s];if(a.enabled!==!1){if(a.renderToScreen=this.renderToScreen&&this.isLastEnabledPass(s),a.render(this.renderer,this.writeBuffer,this.readBuffer,e,i),a.needsSwap){if(i){const l=this.renderer.getContext(),c=this.renderer.state.buffers.stencil;c.setFunc(l.NOTEQUAL,1,4294967295),this.copyPass.render(this.renderer,this.writeBuffer,this.readBuffer,e),c.setFunc(l.EQUAL,1,4294967295)}this.swapBuffers()}uH!==void 0&&(a instanceof uH?i=!0:a instanceof K3e&&(i=!1))}}this.renderer.setRenderTarget(n)}reset(e){if(e===void 0){const n=this.renderer.getSize(new Fe);this._pixelRatio=this.renderer.getPixelRatio(),this._width=n.width,this._height=n.height,e=this.renderTarget1.clone(),e.setSize(this._width*this._pixelRatio,this._height*this._pixelRatio)}this.renderTarget1.dispose(),this.renderTarget2.dispose(),this.renderTarget1=e,this.renderTarget2=e.clone(),this.writeBuffer=this.renderTarget1,this.readBuffer=this.renderTarget2}setSize(e,n){this._width=e,this._height=n;const i=this._width*this._pixelRatio,s=this._height*this._pixelRatio;this.renderTarget1.setSize(i,s),this.renderTarget2.setSize(i,s);for(let o=0;o<this.passes.length;o++)this.passes[o].setSize(i,s)}setPixelRatio(e){this._pixelRatio=e,this.setSize(this._width,this._height)}dispose(){this.renderTarget1.dispose(),this.renderTarget2.dispose(),this.copyPass.dispose()}}class Z3e extends CA{constructor(e,n,i=null,s=null,o=null){super(),this.scene=e,this.camera=n,this.overrideMaterial=i,this.clearColor=s,this.clearAlpha=o,this.clear=!0,this.clearDepth=!1,this.needsSwap=!1,this._oldClearColor=new pt}render(e,n,i){const s=e.autoClear;e.autoClear=!1;let o,a;this.overrideMaterial!==null&&(a=this.scene.overrideMaterial,this.scene.overrideMaterial=this.overrideMaterial),this.clearColor!==null&&(e.getClearColor(this._oldClearColor),e.setClearColor(this.clearColor,e.getClearAlpha())),this.clearAlpha!==null&&(o=e.getClearAlpha(),e.setClearAlpha(this.clearAlpha)),this.clearDepth==!0&&e.clearDepth(),e.setRenderTarget(this.renderToScreen?null:i),this.clear===!0&&e.clear(e.autoClearColor,e.autoClearDepth,e.autoClearStencil),e.render(this.scene,this.camera),this.clearColor!==null&&e.setClearColor(this._oldClearColor),this.clearAlpha!==null&&e.setClearAlpha(o),this.overrideMaterial!==null&&(this.scene.overrideMaterial=a),e.autoClear=s}}var Kc=Object.freeze({Linear:Object.freeze({None:function(r){return r},In:function(r){return r},Out:function(r){return r},InOut:function(r){return r}}),Quadratic:Object.freeze({In:function(r){return r*r},Out:function(r){return r*(2-r)},InOut:function(r){return(r*=2)<1?.5*r*r:-.5*(--r*(r-2)-1)}}),Cubic:Object.freeze({In:function(r){return r*r*r},Out:function(r){return--r*r*r+1},InOut:function(r){return(r*=2)<1?.5*r*r*r:.5*((r-=2)*r*r+2)}}),Quartic:Object.freeze({In:function(r){return r*r*r*r},Out:function(r){return 1- --r*r*r*r},InOut:function(r){return(r*=2)<1?.5*r*r*r*r:-.5*((r-=2)*r*r*r-2)}}),Quintic:Object.freeze({In:function(r){return r*r*r*r*r},Out:function(r){return--r*r*r*r*r+1},InOut:function(r){return(r*=2)<1?.5*r*r*r*r*r:.5*((r-=2)*r*r*r*r+2)}}),Sinusoidal:Object.freeze({In:function(r){return 1-Math.sin((1-r)*Math.PI/2)},Out:function(r){return Math.sin(r*Math.PI/2)},InOut:function(r){return .5*(1-Math.sin(Math.PI*(.5-r)))}}),Exponential:Object.freeze({In:function(r){return r===0?0:Math.pow(1024,r-1)},Out:function(r){return r===1?1:1-Math.pow(2,-10*r)},InOut:function(r){return r===0?0:r===1?1:(r*=2)<1?.5*Math.pow(1024,r-1):.5*(-Math.pow(2,-10*(r-1))+2)}}),Circular:Object.freeze({In:function(r){return 1-Math.sqrt(1-r*r)},Out:function(r){return Math.sqrt(1- --r*r)},InOut:function(r){return(r*=2)<1?-.5*(Math.sqrt(1-r*r)-1):.5*(Math.sqrt(1-(r-=2)*r)+1)}}),Elastic:Object.freeze({In:function(r){return r===0?0:r===1?1:-Math.pow(2,10*(r-1))*Math.sin((r-1.1)*5*Math.PI)},Out:function(r){return r===0?0:r===1?1:Math.pow(2,-10*r)*Math.sin((r-.1)*5*Math.PI)+1},InOut:function(r){return r===0?0:r===1?1:(r*=2,r<1?-.5*Math.pow(2,10*(r-1))*Math.sin((r-1.1)*5*Math.PI):.5*Math.pow(2,-10*(r-1))*Math.sin((r-1.1)*5*Math.PI)+1)}}),Back:Object.freeze({In:function(r){var e=1.70158;return r===1?1:r*r*((e+1)*r-e)},Out:function(r){var e=1.70158;return r===0?0:--r*r*((e+1)*r+e)+1},InOut:function(r){var e=2.5949095;return(r*=2)<1?.5*(r*r*((e+1)*r-e)):.5*((r-=2)*r*((e+1)*r+e)+2)}}),Bounce:Object.freeze({In:function(r){return 1-Kc.Bounce.Out(1-r)},Out:function(r){return r<1/2.75?7.5625*r*r:r<2/2.75?7.5625*(r-=1.5/2.75)*r+.75:r<2.5/2.75?7.5625*(r-=2.25/2.75)*r+.9375:7.5625*(r-=2.625/2.75)*r+.984375},InOut:function(r){return r<.5?Kc.Bounce.In(r*2)*.5:Kc.Bounce.Out(r*2-1)*.5+.5}}),generatePow:function(r){return r===void 0&&(r=4),r=r<Number.EPSILON?Number.EPSILON:r,r=r>1e4?1e4:r,{In:function(e){return Math.pow(e,r)},Out:function(e){return 1-Math.pow(1-e,r)},InOut:function(e){return e<.5?Math.pow(e*2,r)/2:(1-Math.pow(2-e*2,r))/2+.5}}}}),d0=function(){return performance.now()},nB=function(){function r(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];this._tweens={},this._tweensAddedDuringUpdate={},this.add.apply(this,e)}return r.prototype.getAll=function(){var e=this;return Object.keys(this._tweens).map(function(n){return e._tweens[n]})},r.prototype.removeAll=function(){this._tweens={}},r.prototype.add=function(){for(var e,n=[],i=0;i<arguments.length;i++)n[i]=arguments[i];for(var s=0,o=n;s<o.length;s++){var a=o[s];(e=a._group)===null||e===void 0||e.remove(a),a._group=this,this._tweens[a.getId()]=a,this._tweensAddedDuringUpdate[a.getId()]=a}},r.prototype.remove=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];for(var i=0,s=e;i<s.length;i++){var o=s[i];o._group=void 0,delete this._tweens[o.getId()],delete this._tweensAddedDuringUpdate[o.getId()]}},r.prototype.allStopped=function(){return this.getAll().every(function(e){return!e.isPlaying()})},r.prototype.update=function(e,n){e===void 0&&(e=d0()),n===void 0&&(n=!0);var i=Object.keys(this._tweens);if(i.length!==0)for(;i.length>0;){this._tweensAddedDuringUpdate={};for(var s=0;s<i.length;s++){var o=this._tweens[i[s]],a=!n;o&&o.update(e,a)===!1&&!n&&this.remove(o)}i=Object.keys(this._tweensAddedDuringUpdate)}},r}(),pm={Linear:function(r,e){var n=r.length-1,i=n*e,s=Math.floor(i),o=pm.Utils.Linear;return e<0?o(r[0],r[1],i):e>1?o(r[n],r[n-1],n-i):o(r[s],r[s+1>n?n:s+1],i-s)},Bezier:function(r,e){for(var n=0,i=r.length-1,s=Math.pow,o=pm.Utils.Bernstein,a=0;a<=i;a++)n+=s(1-e,i-a)*s(e,a)*r[a]*o(i,a);return n},CatmullRom:function(r,e){var n=r.length-1,i=n*e,s=Math.floor(i),o=pm.Utils.CatmullRom;return r[0]===r[n]?(e<0&&(s=Math.floor(i=n*(1+e))),o(r[(s-1+n)%n],r[s],r[(s+1)%n],r[(s+2)%n],i-s)):e<0?r[0]-(o(r[0],r[0],r[1],r[1],-i)-r[0]):e>1?r[n]-(o(r[n],r[n],r[n-1],r[n-1],i-n)-r[n]):o(r[s?s-1:0],r[s],r[n<s+1?n:s+1],r[n<s+2?n:s+2],i-s)},Utils:{Linear:function(r,e,n){return(e-r)*n+r},Bernstein:function(r,e){var n=pm.Utils.Factorial;return n(r)/n(e)/n(r-e)},Factorial:function(){var r=[1];return function(e){var n=1;if(r[e])return r[e];for(var i=e;i>1;i--)n*=i;return r[e]=n,n}}(),CatmullRom:function(r,e,n,i,s){var o=(n-r)*.5,a=(i-e)*.5,l=s*s,c=s*l;return(2*e-2*n+o+a)*c+(-3*e+3*n-2*o-a)*l+o*s+e}}},Q3e=function(){function r(){}return r.nextId=function(){return r._nextId++},r._nextId=0,r}(),ND=new nB,yE=function(){function r(e,n){this._isPaused=!1,this._pauseStart=0,this._valuesStart={},this._valuesEnd={},this._valuesStartRepeat={},this._duration=1e3,this._isDynamic=!1,this._initialRepeat=0,this._repeat=0,this._yoyo=!1,this._isPlaying=!1,this._reversed=!1,this._delayTime=0,this._startTime=0,this._easingFunction=Kc.Linear.None,this._interpolationFunction=pm.Linear,this._chainedTweens=[],this._onStartCallbackFired=!1,this._onEveryStartCallbackFired=!1,this._id=Q3e.nextId(),this._isChainStopped=!1,this._propertiesAreSetUp=!1,this._goToEnd=!1,this._object=e,typeof n=="object"?(this._group=n,n.add(this)):n===!0&&(this._group=ND,ND.add(this))}return r.prototype.getId=function(){return this._id},r.prototype.isPlaying=function(){return this._isPlaying},r.prototype.isPaused=function(){return this._isPaused},r.prototype.getDuration=function(){return this._duration},r.prototype.to=function(e,n){if(n===void 0&&(n=1e3),this._isPlaying)throw new Error("Can not call Tween.to() while Tween is already started or paused. Stop the Tween first.");return this._valuesEnd=e,this._propertiesAreSetUp=!1,this._duration=n<0?0:n,this},r.prototype.duration=function(e){return e===void 0&&(e=1e3),this._duration=e<0?0:e,this},r.prototype.dynamic=function(e){return e===void 0&&(e=!1),this._isDynamic=e,this},r.prototype.start=function(e,n){if(e===void 0&&(e=d0()),n===void 0&&(n=!1),this._isPlaying)return this;if(this._repeat=this._initialRepeat,this._reversed){this._reversed=!1;for(var i in this._valuesStartRepeat)this._swapEndStartRepeatValues(i),this._valuesStart[i]=this._valuesStartRepeat[i]}if(this._isPlaying=!0,this._isPaused=!1,this._onStartCallbackFired=!1,this._onEveryStartCallbackFired=!1,this._isChainStopped=!1,this._startTime=e,this._startTime+=this._delayTime,!this._propertiesAreSetUp||n){if(this._propertiesAreSetUp=!0,!this._isDynamic){var s={};for(var o in this._valuesEnd)s[o]=this._valuesEnd[o];this._valuesEnd=s}this._setupProperties(this._object,this._valuesStart,this._valuesEnd,this._valuesStartRepeat,n)}return this},r.prototype.startFromCurrentValues=function(e){return this.start(e,!0)},r.prototype._setupProperties=function(e,n,i,s,o){for(var a in i){var l=e[a],c=Array.isArray(l),u=c?"array":typeof l,h=!c&&Array.isArray(i[a]);if(!(u==="undefined"||u==="function")){if(h){var f=i[a];if(f.length===0)continue;for(var d=[l],p=0,m=f.length;p<m;p+=1){var g=this._handleRelativeValue(l,f[p]);if(isNaN(g)){h=!1,console.warn("Found invalid interpolation list. Skipping.");break}d.push(g)}h&&(i[a]=d)}if((u==="object"||c)&&l&&!h){n[a]=c?[]:{};var v=l;for(var y in v)n[a][y]=v[y];s[a]=c?[]:{};var f=i[a];if(!this._isDynamic){var x={};for(var y in f)x[y]=f[y];i[a]=f=x}this._setupProperties(v,n[a],f,s[a],o)}else(typeof n[a]>"u"||o)&&(n[a]=l),c||(n[a]*=1),h?s[a]=i[a].slice().reverse():s[a]=n[a]||0}}},r.prototype.stop=function(){return this._isChainStopped||(this._isChainStopped=!0,this.stopChainedTweens()),this._isPlaying?(this._isPlaying=!1,this._isPaused=!1,this._onStopCallback&&this._onStopCallback(this._object),this):this},r.prototype.end=function(){return this._goToEnd=!0,this.update(this._startTime+this._duration),this},r.prototype.pause=function(e){return e===void 0&&(e=d0()),this._isPaused||!this._isPlaying?this:(this._isPaused=!0,this._pauseStart=e,this)},r.prototype.resume=function(e){return e===void 0&&(e=d0()),!this._isPaused||!this._isPlaying?this:(this._isPaused=!1,this._startTime+=e-this._pauseStart,this._pauseStart=0,this)},r.prototype.stopChainedTweens=function(){for(var e=0,n=this._chainedTweens.length;e<n;e++)this._chainedTweens[e].stop();return this},r.prototype.group=function(e){return e?(e.add(this),this):(console.warn("tween.group() without args has been removed, use group.add(tween) instead."),this)},r.prototype.remove=function(){var e;return(e=this._group)===null||e===void 0||e.remove(this),this},r.prototype.delay=function(e){return e===void 0&&(e=0),this._delayTime=e,this},r.prototype.repeat=function(e){return e===void 0&&(e=0),this._initialRepeat=e,this._repeat=e,this},r.prototype.repeatDelay=function(e){return this._repeatDelayTime=e,this},r.prototype.yoyo=function(e){return e===void 0&&(e=!1),this._yoyo=e,this},r.prototype.easing=function(e){return e===void 0&&(e=Kc.Linear.None),this._easingFunction=e,this},r.prototype.interpolation=function(e){return e===void 0&&(e=pm.Linear),this._interpolationFunction=e,this},r.prototype.chain=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];return this._chainedTweens=e,this},r.prototype.onStart=function(e){return this._onStartCallback=e,this},r.prototype.onEveryStart=function(e){return this._onEveryStartCallback=e,this},r.prototype.onUpdate=function(e){return this._onUpdateCallback=e,this},r.prototype.onRepeat=function(e){return this._onRepeatCallback=e,this},r.prototype.onComplete=function(e){return this._onCompleteCallback=e,this},r.prototype.onStop=function(e){return this._onStopCallback=e,this},r.prototype.update=function(e,n){var i=this,s;if(e===void 0&&(e=d0()),n===void 0&&(n=r.autoStartOnUpdate),this._isPaused)return!0;var o;if(!this._goToEnd&&!this._isPlaying)if(n)this.start(e,!0);else return!1;if(this._goToEnd=!1,e<this._startTime)return!0;this._onStartCallbackFired===!1&&(this._onStartCallback&&this._onStartCallback(this._object),this._onStartCallbackFired=!0),this._onEveryStartCallbackFired===!1&&(this._onEveryStartCallback&&this._onEveryStartCallback(this._object),this._onEveryStartCallbackFired=!0);var a=e-this._startTime,l=this._duration+((s=this._repeatDelayTime)!==null&&s!==void 0?s:this._delayTime),c=this._duration+this._repeat*l,u=function(){if(i._duration===0||a>c)return 1;var g=Math.trunc(a/l),v=a-g*l,y=Math.min(v/i._duration,1);return y===0&&a===i._duration?1:y},h=u(),f=this._easingFunction(h);if(this._updateProperties(this._object,this._valuesStart,this._valuesEnd,f),this._onUpdateCallback&&this._onUpdateCallback(this._object,h),this._duration===0||a>=this._duration)if(this._repeat>0){var d=Math.min(Math.trunc((a-this._duration)/l)+1,this._repeat);isFinite(this._repeat)&&(this._repeat-=d);for(o in this._valuesStartRepeat)!this._yoyo&&typeof this._valuesEnd[o]=="string"&&(this._valuesStartRepeat[o]=this._valuesStartRepeat[o]+parseFloat(this._valuesEnd[o])),this._yoyo&&this._swapEndStartRepeatValues(o),this._valuesStart[o]=this._valuesStartRepeat[o];return this._yoyo&&(this._reversed=!this._reversed),this._startTime+=l*d,this._onRepeatCallback&&this._onRepeatCallback(this._object),this._onEveryStartCallbackFired=!1,!0}else{this._onCompleteCallback&&this._onCompleteCallback(this._object);for(var p=0,m=this._chainedTweens.length;p<m;p++)this._chainedTweens[p].start(this._startTime+this._duration,!1);return this._isPlaying=!1,!1}return!0},r.prototype._updateProperties=function(e,n,i,s){for(var o in i)if(n[o]!==void 0){var a=n[o]||0,l=i[o],c=Array.isArray(e[o]),u=Array.isArray(l),h=!c&&u;h?e[o]=this._interpolationFunction(l,s):typeof l=="object"&&l?this._updateProperties(e[o],a,l,s):(l=this._handleRelativeValue(a,l),typeof l=="number"&&(e[o]=a+(l-a)*s))}},r.prototype._handleRelativeValue=function(e,n){return typeof n!="string"?n:n.charAt(0)==="+"||n.charAt(0)==="-"?e+parseFloat(n):parseFloat(n)},r.prototype._swapEndStartRepeatValues=function(e){var n=this._valuesStartRepeat[e],i=this._valuesEnd[e];typeof i=="string"?this._valuesStartRepeat[e]=this._valuesStartRepeat[e]+parseFloat(i):this._valuesStartRepeat[e]=this._valuesEnd[e],this._valuesEnd[e]=n},r.autoStartOnUpdate=!1,r}(),zl=ND;zl.getAll.bind(zl);zl.removeAll.bind(zl);zl.add.bind(zl);zl.remove.bind(zl);zl.update.bind(zl);var OD="http://www.w3.org/1999/xhtml";const hH={svg:"http://www.w3.org/2000/svg",xhtml:OD,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};function PA(r){var e=r+="",n=e.indexOf(":");return n>=0&&(e=r.slice(0,n))!=="xmlns"&&(r=r.slice(n+1)),hH.hasOwnProperty(e)?{space:hH[e],local:r}:r}function J3e(r){return function(){var e=this.ownerDocument,n=this.namespaceURI;return n===OD&&e.documentElement.namespaceURI===OD?e.createElement(r):e.createElementNS(n,r)}}function eBe(r){return function(){return this.ownerDocument.createElementNS(r.space,r.local)}}function Mee(r){var e=PA(r);return(e.local?eBe:J3e)(e)}function tBe(){}function rB(r){return r==null?tBe:function(){return this.querySelector(r)}}function nBe(r){typeof r!="function"&&(r=rB(r));for(var e=this._groups,n=e.length,i=new Array(n),s=0;s<n;++s)for(var o=e[s],a=o.length,l=i[s]=new Array(a),c,u,h=0;h<a;++h)(c=o[h])&&(u=r.call(c,c.__data__,h,o))&&("__data__"in c&&(u.__data__=c.__data__),l[h]=u);return new Fo(i,this._parents)}function rBe(r){return r==null?[]:Array.isArray(r)?r:Array.from(r)}function iBe(){return[]}function Aee(r){return r==null?iBe:function(){return this.querySelectorAll(r)}}function sBe(r){return function(){return rBe(r.apply(this,arguments))}}function oBe(r){typeof r=="function"?r=sBe(r):r=Aee(r);for(var e=this._groups,n=e.length,i=[],s=[],o=0;o<n;++o)for(var a=e[o],l=a.length,c,u=0;u<l;++u)(c=a[u])&&(i.push(r.call(c,c.__data__,u,a)),s.push(c));return new Fo(i,s)}function Cee(r){return function(){return this.matches(r)}}function Pee(r){return function(e){return e.matches(r)}}var aBe=Array.prototype.find;function lBe(r){return function(){return aBe.call(this.children,r)}}function cBe(){return this.firstElementChild}function uBe(r){return this.select(r==null?cBe:lBe(typeof r=="function"?r:Pee(r)))}var hBe=Array.prototype.filter;function fBe(){return Array.from(this.children)}function dBe(r){return function(){return hBe.call(this.children,r)}}function pBe(r){return this.selectAll(r==null?fBe:dBe(typeof r=="function"?r:Pee(r)))}function mBe(r){typeof r!="function"&&(r=Cee(r));for(var e=this._groups,n=e.length,i=new Array(n),s=0;s<n;++s)for(var o=e[s],a=o.length,l=i[s]=[],c,u=0;u<a;++u)(c=o[u])&&r.call(c,c.__data__,u,o)&&l.push(c);return new Fo(i,this._parents)}function Ree(r){return new Array(r.length)}function gBe(){return new Fo(this._enter||this._groups.map(Ree),this._parents)}function vE(r,e){this.ownerDocument=r.ownerDocument,this.namespaceURI=r.namespaceURI,this._next=null,this._parent=r,this.__data__=e}vE.prototype={constructor:vE,appendChild:function(r){return this._parent.insertBefore(r,this._next)},insertBefore:function(r,e){return this._parent.insertBefore(r,e)},querySelector:function(r){return this._parent.querySelector(r)},querySelectorAll:function(r){return this._parent.querySelectorAll(r)}};function yBe(r){return function(){return r}}function vBe(r,e,n,i,s,o){for(var a=0,l,c=e.length,u=o.length;a<u;++a)(l=e[a])?(l.__data__=o[a],i[a]=l):n[a]=new vE(r,o[a]);for(;a<c;++a)(l=e[a])&&(s[a]=l)}function xBe(r,e,n,i,s,o,a){var l,c,u=new Map,h=e.length,f=o.length,d=new Array(h),p;for(l=0;l<h;++l)(c=e[l])&&(d[l]=p=a.call(c,c.__data__,l,e)+"",u.has(p)?s[l]=c:u.set(p,c));for(l=0;l<f;++l)p=a.call(r,o[l],l,o)+"",(c=u.get(p))?(i[l]=c,c.__data__=o[l],u.delete(p)):n[l]=new vE(r,o[l]);for(l=0;l<h;++l)(c=e[l])&&u.get(d[l])===c&&(s[l]=c)}function bBe(r){return r.__data__}function _Be(r,e){if(!arguments.length)return Array.from(this,bBe);var n=e?xBe:vBe,i=this._parents,s=this._groups;typeof r!="function"&&(r=yBe(r));for(var o=s.length,a=new Array(o),l=new Array(o),c=new Array(o),u=0;u<o;++u){var h=i[u],f=s[u],d=f.length,p=wBe(r.call(h,h&&h.__data__,u,i)),m=p.length,g=l[u]=new Array(m),v=a[u]=new Array(m),y=c[u]=new Array(d);n(h,f,g,v,y,p,e);for(var x=0,b=0,w,_;x<m;++x)if(w=g[x]){for(x>=b&&(b=x+1);!(_=v[b])&&++b<m;);w._next=_||null}}return a=new Fo(a,i),a._enter=l,a._exit=c,a}function wBe(r){return typeof r=="object"&&"length"in r?r:Array.from(r)}function SBe(){return new Fo(this._exit||this._groups.map(Ree),this._parents)}function TBe(r,e,n){var i=this.enter(),s=this,o=this.exit();return typeof r=="function"?(i=r(i),i&&(i=i.selection())):i=i.append(r+""),e!=null&&(s=e(s),s&&(s=s.selection())),n==null?o.remove():n(o),i&&s?i.merge(s).order():s}function EBe(r){for(var e=r.selection?r.selection():r,n=this._groups,i=e._groups,s=n.length,o=i.length,a=Math.min(s,o),l=new Array(s),c=0;c<a;++c)for(var u=n[c],h=i[c],f=u.length,d=l[c]=new Array(f),p,m=0;m<f;++m)(p=u[m]||h[m])&&(d[m]=p);for(;c<s;++c)l[c]=n[c];return new Fo(l,this._parents)}function MBe(){for(var r=this._groups,e=-1,n=r.length;++e<n;)for(var i=r[e],s=i.length-1,o=i[s],a;--s>=0;)(a=i[s])&&(o&&a.compareDocumentPosition(o)^4&&o.parentNode.insertBefore(a,o),o=a);return this}function ABe(r){r||(r=CBe);function e(f,d){return f&&d?r(f.__data__,d.__data__):!f-!d}for(var n=this._groups,i=n.length,s=new Array(i),o=0;o<i;++o){for(var a=n[o],l=a.length,c=s[o]=new Array(l),u,h=0;h<l;++h)(u=a[h])&&(c[h]=u);c.sort(e)}return new Fo(s,this._parents).order()}function CBe(r,e){return r<e?-1:r>e?1:r>=e?0:NaN}function PBe(){var r=arguments[0];return arguments[0]=this,r.apply(null,arguments),this}function RBe(){return Array.from(this)}function NBe(){for(var r=this._groups,e=0,n=r.length;e<n;++e)for(var i=r[e],s=0,o=i.length;s<o;++s){var a=i[s];if(a)return a}return null}function OBe(){let r=0;for(const e of this)++r;return r}function DBe(){return!this.node()}function kBe(r){for(var e=this._groups,n=0,i=e.length;n<i;++n)for(var s=e[n],o=0,a=s.length,l;o<a;++o)(l=s[o])&&r.call(l,l.__data__,o,s);return this}function IBe(r){return function(){this.removeAttribute(r)}}function LBe(r){return function(){this.removeAttributeNS(r.space,r.local)}}function FBe(r,e){return function(){this.setAttribute(r,e)}}function BBe(r,e){return function(){this.setAttributeNS(r.space,r.local,e)}}function UBe(r,e){return function(){var n=e.apply(this,arguments);n==null?this.removeAttribute(r):this.setAttribute(r,n)}}function zBe(r,e){return function(){var n=e.apply(this,arguments);n==null?this.removeAttributeNS(r.space,r.local):this.setAttributeNS(r.space,r.local,n)}}function $Be(r,e){var n=PA(r);if(arguments.length<2){var i=this.node();return n.local?i.getAttributeNS(n.space,n.local):i.getAttribute(n)}return this.each((e==null?n.local?LBe:IBe:typeof e=="function"?n.local?zBe:UBe:n.local?BBe:FBe)(n,e))}function Nee(r){return r.ownerDocument&&r.ownerDocument.defaultView||r.document&&r||r.defaultView}function jBe(r){return function(){this.style.removeProperty(r)}}function VBe(r,e,n){return function(){this.style.setProperty(r,e,n)}}function GBe(r,e,n){return function(){var i=e.apply(this,arguments);i==null?this.style.removeProperty(r):this.style.setProperty(r,i,n)}}function HBe(r,e,n){return arguments.length>1?this.each((e==null?jBe:typeof e=="function"?GBe:VBe)(r,e,n??"")):Cg(this.node(),r)}function Cg(r,e){return r.style.getPropertyValue(e)||Nee(r).getComputedStyle(r,null).getPropertyValue(e)}function WBe(r){return function(){delete this[r]}}function qBe(r,e){return function(){this[r]=e}}function XBe(r,e){return function(){var n=e.apply(this,arguments);n==null?delete this[r]:this[r]=n}}function KBe(r,e){return arguments.length>1?this.each((e==null?WBe:typeof e=="function"?XBe:qBe)(r,e)):this.node()[r]}function Oee(r){return r.trim().split(/^|\s+/)}function iB(r){return r.classList||new Dee(r)}function Dee(r){this._node=r,this._names=Oee(r.getAttribute("class")||"")}Dee.prototype={add:function(r){var e=this._names.indexOf(r);e<0&&(this._names.push(r),this._node.setAttribute("class",this._names.join(" ")))},remove:function(r){var e=this._names.indexOf(r);e>=0&&(this._names.splice(e,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(r){return this._names.indexOf(r)>=0}};function kee(r,e){for(var n=iB(r),i=-1,s=e.length;++i<s;)n.add(e[i])}function Iee(r,e){for(var n=iB(r),i=-1,s=e.length;++i<s;)n.remove(e[i])}function YBe(r){return function(){kee(this,r)}}function ZBe(r){return function(){Iee(this,r)}}function QBe(r,e){return function(){(e.apply(this,arguments)?kee:Iee)(this,r)}}function JBe(r,e){var n=Oee(r+"");if(arguments.length<2){for(var i=iB(this.node()),s=-1,o=n.length;++s<o;)if(!i.contains(n[s]))return!1;return!0}return this.each((typeof e=="function"?QBe:e?YBe:ZBe)(n,e))}function eUe(){this.textContent=""}function tUe(r){return function(){this.textContent=r}}function nUe(r){return function(){var e=r.apply(this,arguments);this.textContent=e??""}}function rUe(r){return arguments.length?this.each(r==null?eUe:(typeof r=="function"?nUe:tUe)(r)):this.node().textContent}function iUe(){this.innerHTML=""}function sUe(r){return function(){this.innerHTML=r}}function oUe(r){return function(){var e=r.apply(this,arguments);this.innerHTML=e??""}}function aUe(r){return arguments.length?this.each(r==null?iUe:(typeof r=="function"?oUe:sUe)(r)):this.node().innerHTML}function lUe(){this.nextSibling&&this.parentNode.appendChild(this)}function cUe(){return this.each(lUe)}function uUe(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function hUe(){return this.each(uUe)}function fUe(r){var e=typeof r=="function"?r:Mee(r);return this.select(function(){return this.appendChild(e.apply(this,arguments))})}function dUe(){return null}function pUe(r,e){var n=typeof r=="function"?r:Mee(r),i=e==null?dUe:typeof e=="function"?e:rB(e);return this.select(function(){return this.insertBefore(n.apply(this,arguments),i.apply(this,arguments)||null)})}function mUe(){var r=this.parentNode;r&&r.removeChild(this)}function gUe(){return this.each(mUe)}function yUe(){var r=this.cloneNode(!1),e=this.parentNode;return e?e.insertBefore(r,this.nextSibling):r}function vUe(){var r=this.cloneNode(!0),e=this.parentNode;return e?e.insertBefore(r,this.nextSibling):r}function xUe(r){return this.select(r?vUe:yUe)}function bUe(r){return arguments.length?this.property("__data__",r):this.node().__data__}function _Ue(r){return function(e){r.call(this,e,this.__data__)}}function wUe(r){return r.trim().split(/^|\s+/).map(function(e){var n="",i=e.indexOf(".");return i>=0&&(n=e.slice(i+1),e=e.slice(0,i)),{type:e,name:n}})}function SUe(r){return function(){var e=this.__on;if(e){for(var n=0,i=-1,s=e.length,o;n<s;++n)o=e[n],(!r.type||o.type===r.type)&&o.name===r.name?this.removeEventListener(o.type,o.listener,o.options):e[++i]=o;++i?e.length=i:delete this.__on}}}function TUe(r,e,n){return function(){var i=this.__on,s,o=_Ue(e);if(i){for(var a=0,l=i.length;a<l;++a)if((s=i[a]).type===r.type&&s.name===r.name){this.removeEventListener(s.type,s.listener,s.options),this.addEventListener(s.type,s.listener=o,s.options=n),s.value=e;return}}this.addEventListener(r.type,o,n),s={type:r.type,name:r.name,value:e,listener:o,options:n},i?i.push(s):this.__on=[s]}}function EUe(r,e,n){var i=wUe(r+""),s,o=i.length,a;if(arguments.length<2){var l=this.node().__on;if(l){for(var c=0,u=l.length,h;c<u;++c)for(s=0,h=l[c];s<o;++s)if((a=i[s]).type===h.type&&a.name===h.name)return h.value}return}for(l=e?TUe:SUe,s=0;s<o;++s)this.each(l(i[s],e,n));return this}function Lee(r,e,n){var i=Nee(r),s=i.CustomEvent;typeof s=="function"?s=new s(e,n):(s=i.document.createEvent("Event"),n?(s.initEvent(e,n.bubbles,n.cancelable),s.detail=n.detail):s.initEvent(e,!1,!1)),r.dispatchEvent(s)}function MUe(r,e){return function(){return Lee(this,r,e)}}function AUe(r,e){return function(){return Lee(this,r,e.apply(this,arguments))}}function CUe(r,e){return this.each((typeof e=="function"?AUe:MUe)(r,e))}function*PUe(){for(var r=this._groups,e=0,n=r.length;e<n;++e)for(var i=r[e],s=0,o=i.length,a;s<o;++s)(a=i[s])&&(yield a)}var Fee=[null];function Fo(r,e){this._groups=r,this._parents=e}function R_(){return new Fo([[document.documentElement]],Fee)}function RUe(){return this}Fo.prototype=R_.prototype={constructor:Fo,select:nBe,selectAll:oBe,selectChild:uBe,selectChildren:pBe,filter:mBe,data:_Be,enter:gBe,exit:SBe,join:TBe,merge:EBe,selection:RUe,order:MBe,sort:ABe,call:PBe,nodes:RBe,node:NBe,size:OBe,empty:DBe,each:kBe,attr:$Be,style:HBe,property:KBe,classed:JBe,text:rUe,html:aUe,raise:cUe,lower:hUe,append:fUe,insert:pUe,remove:gUe,clone:xUe,datum:bUe,on:EUe,dispatch:CUe,[Symbol.iterator]:PUe};function na(r){return typeof r=="string"?new Fo([[document.querySelector(r)]],[document.documentElement]):new Fo([[r]],Fee)}function NUe(r){let e;for(;e=r.sourceEvent;)r=e;return r}function vl(r,e){if(r=NUe(r),e===void 0&&(e=r.currentTarget),e){var n=e.ownerSVGElement||e;if(n.createSVGPoint){var i=n.createSVGPoint();return i.x=r.clientX,i.y=r.clientY,i=i.matrixTransform(e.getScreenCTM().inverse()),[i.x,i.y]}if(e.getBoundingClientRect){var s=e.getBoundingClientRect();return[r.clientX-s.left-e.clientLeft,r.clientY-s.top-e.clientTop]}}return[r.pageX,r.pageY]}var N_,or,Bee,Uee,Ff,fH,zee,$ee,jee,sB,DD,kD,fb={},Vee=[],OUe=/acit|ex(?:s|g|n|p|$)|rph|grid|ows|mnc|ntw|ine[ch]|zoo|^ord|itera/i,RA=Array.isArray;function Ml(r,e){for(var n in e)r[n]=e[n];return r}function oB(r){r&&r.parentNode&&r.parentNode.removeChild(r)}function DUe(r,e,n){var i,s,o,a={};for(o in e)o=="key"?i=e[o]:o=="ref"?s=e[o]:a[o]=e[o];if(arguments.length>2&&(a.children=arguments.length>3?N_.call(arguments,2):n),typeof r=="function"&&r.defaultProps!=null)for(o in r.defaultProps)a[o]==null&&(a[o]=r.defaultProps[o]);return H0(r,a,i,s,null)}function H0(r,e,n,i,s){var o={type:r,props:e,key:n,ref:i,__k:null,__:null,__b:0,__e:null,__c:null,constructor:void 0,__v:s??++Bee,__i:-1,__u:0};return s==null&&or.vnode!=null&&or.vnode(o),o}function NA(r){return r.children}function $1(r,e){this.props=r,this.context=e}function Pg(r,e){if(e==null)return r.__?Pg(r.__,r.__i+1):null;for(var n;e<r.__k.length;e++)if((n=r.__k[e])!=null&&n.__e!=null)return n.__e;return typeof r.type=="function"?Pg(r):null}function Gee(r){var e,n;if((r=r.__)!=null&&r.__c!=null){for(r.__e=r.__c.base=null,e=0;e<r.__k.length;e++)if((n=r.__k[e])!=null&&n.__e!=null){r.__e=r.__c.base=n.__e;break}return Gee(r)}}function dH(r){(!r.__d&&(r.__d=!0)&&Ff.push(r)&&!xE.__r++||fH!=or.debounceRendering)&&((fH=or.debounceRendering)||zee)(xE)}function xE(){for(var r,e,n,i,s,o,a,l=1;Ff.length;)Ff.length>l&&Ff.sort($ee),r=Ff.shift(),l=Ff.length,r.__d&&(n=void 0,s=(i=(e=r).__v).__e,o=[],a=[],e.__P&&((n=Ml({},i)).__v=i.__v+1,or.vnode&&or.vnode(n),aB(e.__P,n,i,e.__n,e.__P.namespaceURI,32&i.__u?[s]:null,o,s??Pg(i),!!(32&i.__u),a),n.__v=i.__v,n.__.__k[n.__i]=n,qee(o,n,a),n.__e!=s&&Gee(n)));xE.__r=0}function Hee(r,e,n,i,s,o,a,l,c,u,h){var f,d,p,m,g,v,y=i&&i.__k||Vee,x=e.length;for(c=kUe(n,e,y,c,x),f=0;f<x;f++)(p=n.__k[f])!=null&&(d=p.__i==-1?fb:y[p.__i]||fb,p.__i=f,v=aB(r,p,d,s,o,a,l,c,u,h),m=p.__e,p.ref&&d.ref!=p.ref&&(d.ref&&lB(d.ref,null,p),h.push(p.ref,p.__c||m,p)),g==null&&m!=null&&(g=m),4&p.__u||d.__k===p.__k?c=Wee(p,c,r):typeof p.type=="function"&&v!==void 0?c=v:m&&(c=m.nextSibling),p.__u&=-7);return n.__e=g,c}function kUe(r,e,n,i,s){var o,a,l,c,u,h=n.length,f=h,d=0;for(r.__k=new Array(s),o=0;o<s;o++)(a=e[o])!=null&&typeof a!="boolean"&&typeof a!="function"?(c=o+d,(a=r.__k[o]=typeof a=="string"||typeof a=="number"||typeof a=="bigint"||a.constructor==String?H0(null,a,null,null,null):RA(a)?H0(NA,{children:a},null,null,null):a.constructor==null&&a.__b>0?H0(a.type,a.props,a.key,a.ref?a.ref:null,a.__v):a).__=r,a.__b=r.__b+1,l=null,(u=a.__i=IUe(a,n,c,f))!=-1&&(f--,(l=n[u])&&(l.__u|=2)),l==null||l.__v==null?(u==-1&&(s>h?d--:s<h&&d++),typeof a.type!="function"&&(a.__u|=4)):u!=c&&(u==c-1?d--:u==c+1?d++:(u>c?d--:d++,a.__u|=4))):r.__k[o]=null;if(f)for(o=0;o<h;o++)(l=n[o])!=null&&!(2&l.__u)&&(l.__e==i&&(i=Pg(l)),Kee(l,l));return i}function Wee(r,e,n){var i,s;if(typeof r.type=="function"){for(i=r.__k,s=0;i&&s<i.length;s++)i[s]&&(i[s].__=r,e=Wee(i[s],e,n));return e}r.__e!=e&&(e&&r.type&&!n.contains(e)&&(e=Pg(r)),n.insertBefore(r.__e,e||null),e=r.__e);do e=e&&e.nextSibling;while(e!=null&&e.nodeType==8);return e}function IUe(r,e,n,i){var s,o,a=r.key,l=r.type,c=e[n];if(c===null&&r.key==null||c&&a==c.key&&l==c.type&&!(2&c.__u))return n;if(i>(c!=null&&!(2&c.__u)?1:0))for(s=n-1,o=n+1;s>=0||o<e.length;){if(s>=0){if((c=e[s])&&!(2&c.__u)&&a==c.key&&l==c.type)return s;s--}if(o<e.length){if((c=e[o])&&!(2&c.__u)&&a==c.key&&l==c.type)return o;o++}}return-1}function pH(r,e,n){e[0]=="-"?r.setProperty(e,n??""):r[e]=n==null?"":typeof n!="number"||OUe.test(e)?n:n+"px"}function qS(r,e,n,i,s){var o,a;e:if(e=="style")if(typeof n=="string")r.style.cssText=n;else{if(typeof i=="string"&&(r.style.cssText=i=""),i)for(e in i)n&&e in n||pH(r.style,e,"");if(n)for(e in n)i&&n[e]==i[e]||pH(r.style,e,n[e])}else if(e[0]=="o"&&e[1]=="n")o=e!=(e=e.replace(jee,"$1")),a=e.toLowerCase(),e=a in r||e=="onFocusOut"||e=="onFocusIn"?a.slice(2):e.slice(2),r.l||(r.l={}),r.l[e+o]=n,n?i?n.u=i.u:(n.u=sB,r.addEventListener(e,o?kD:DD,o)):r.removeEventListener(e,o?kD:DD,o);else{if(s=="http://www.w3.org/2000/svg")e=e.replace(/xlink(H|:h)/,"h").replace(/sName$/,"s");else if(e!="width"&&e!="height"&&e!="href"&&e!="list"&&e!="form"&&e!="tabIndex"&&e!="download"&&e!="rowSpan"&&e!="colSpan"&&e!="role"&&e!="popover"&&e in r)try{r[e]=n??"";break e}catch{}typeof n=="function"||(n==null||n===!1&&e[4]!="-"?r.removeAttribute(e):r.setAttribute(e,e=="popover"&&n==1?"":n))}}function mH(r){return function(e){if(this.l){var n=this.l[e.type+r];if(e.t==null)e.t=sB++;else if(e.t<n.u)return;return n(or.event?or.event(e):e)}}}function aB(r,e,n,i,s,o,a,l,c,u){var h,f,d,p,m,g,v,y,x,b,w,_,S,T,E,M,A,P=e.type;if(e.constructor!=null)return null;128&n.__u&&(c=!!(32&n.__u),o=[l=e.__e=n.__e]),(h=or.__b)&&h(e);e:if(typeof P=="function")try{if(y=e.props,x="prototype"in P&&P.prototype.render,b=(h=P.contextType)&&i[h.__c],w=h?b?b.props.value:h.__:i,n.__c?v=(f=e.__c=n.__c).__=f.__E:(x?e.__c=f=new P(y,w):(e.__c=f=new $1(y,w),f.constructor=P,f.render=FUe),b&&b.sub(f),f.props=y,f.state||(f.state={}),f.context=w,f.__n=i,d=f.__d=!0,f.__h=[],f._sb=[]),x&&f.__s==null&&(f.__s=f.state),x&&P.getDerivedStateFromProps!=null&&(f.__s==f.state&&(f.__s=Ml({},f.__s)),Ml(f.__s,P.getDerivedStateFromProps(y,f.__s))),p=f.props,m=f.state,f.__v=e,d)x&&P.getDerivedStateFromProps==null&&f.componentWillMount!=null&&f.componentWillMount(),x&&f.componentDidMount!=null&&f.__h.push(f.componentDidMount);else{if(x&&P.getDerivedStateFromProps==null&&y!==p&&f.componentWillReceiveProps!=null&&f.componentWillReceiveProps(y,w),!f.__e&&f.shouldComponentUpdate!=null&&f.shouldComponentUpdate(y,f.__s,w)===!1||e.__v==n.__v){for(e.__v!=n.__v&&(f.props=y,f.state=f.__s,f.__d=!1),e.__e=n.__e,e.__k=n.__k,e.__k.some(function(D){D&&(D.__=e)}),_=0;_<f._sb.length;_++)f.__h.push(f._sb[_]);f._sb=[],f.__h.length&&a.push(f);break e}f.componentWillUpdate!=null&&f.componentWillUpdate(y,f.__s,w),x&&f.componentDidUpdate!=null&&f.__h.push(function(){f.componentDidUpdate(p,m,g)})}if(f.context=w,f.props=y,f.__P=r,f.__e=!1,S=or.__r,T=0,x){for(f.state=f.__s,f.__d=!1,S&&S(e),h=f.render(f.props,f.state,f.context),E=0;E<f._sb.length;E++)f.__h.push(f._sb[E]);f._sb=[]}else do f.__d=!1,S&&S(e),h=f.render(f.props,f.state,f.context),f.state=f.__s;while(f.__d&&++T<25);f.state=f.__s,f.getChildContext!=null&&(i=Ml(Ml({},i),f.getChildContext())),x&&!d&&f.getSnapshotBeforeUpdate!=null&&(g=f.getSnapshotBeforeUpdate(p,m)),M=h,h!=null&&h.type===NA&&h.key==null&&(M=Xee(h.props.children)),l=Hee(r,RA(M)?M:[M],e,n,i,s,o,a,l,c,u),f.base=e.__e,e.__u&=-161,f.__h.length&&a.push(f),v&&(f.__E=f.__=null)}catch(D){if(e.__v=null,c||o!=null)if(D.then){for(e.__u|=c?160:128;l&&l.nodeType==8&&l.nextSibling;)l=l.nextSibling;o[o.indexOf(l)]=null,e.__e=l}else for(A=o.length;A--;)oB(o[A]);else e.__e=n.__e,e.__k=n.__k;or.__e(D,e,n)}else o==null&&e.__v==n.__v?(e.__k=n.__k,e.__e=n.__e):l=e.__e=LUe(n.__e,e,n,i,s,o,a,c,u);return(h=or.diffed)&&h(e),128&e.__u?void 0:l}function qee(r,e,n){for(var i=0;i<n.length;i++)lB(n[i],n[++i],n[++i]);or.__c&&or.__c(e,r),r.some(function(s){try{r=s.__h,s.__h=[],r.some(function(o){o.call(s)})}catch(o){or.__e(o,s.__v)}})}function Xee(r){return typeof r!="object"||r==null||r.__b&&r.__b>0?r:RA(r)?r.map(Xee):Ml({},r)}function LUe(r,e,n,i,s,o,a,l,c){var u,h,f,d,p,m,g,v=n.props,y=e.props,x=e.type;if(x=="svg"?s="http://www.w3.org/2000/svg":x=="math"?s="http://www.w3.org/1998/Math/MathML":s||(s="http://www.w3.org/1999/xhtml"),o!=null){for(u=0;u<o.length;u++)if((p=o[u])&&"setAttribute"in p==!!x&&(x?p.localName==x:p.nodeType==3)){r=p,o[u]=null;break}}if(r==null){if(x==null)return document.createTextNode(y);r=document.createElementNS(s,x,y.is&&y),l&&(or.__m&&or.__m(e,o),l=!1),o=null}if(x==null)v===y||l&&r.data==y||(r.data=y);else{if(o=o&&N_.call(r.childNodes),v=n.props||fb,!l&&o!=null)for(v={},u=0;u<r.attributes.length;u++)v[(p=r.attributes[u]).name]=p.value;for(u in v)if(p=v[u],u!="children"){if(u=="dangerouslySetInnerHTML")f=p;else if(!(u in y)){if(u=="value"&&"defaultValue"in y||u=="checked"&&"defaultChecked"in y)continue;qS(r,u,null,p,s)}}for(u in y)p=y[u],u=="children"?d=p:u=="dangerouslySetInnerHTML"?h=p:u=="value"?m=p:u=="checked"?g=p:l&&typeof p!="function"||v[u]===p||qS(r,u,p,v[u],s);if(h)l||f&&(h.__html==f.__html||h.__html==r.innerHTML)||(r.innerHTML=h.__html),e.__k=[];else if(f&&(r.innerHTML=""),Hee(e.type=="template"?r.content:r,RA(d)?d:[d],e,n,i,x=="foreignObject"?"http://www.w3.org/1999/xhtml":s,o,a,o?o[0]:n.__k&&Pg(n,0),l,c),o!=null)for(u=o.length;u--;)oB(o[u]);l||(u="value",x=="progress"&&m==null?r.removeAttribute("value"):m!=null&&(m!==r[u]||x=="progress"&&!m||x=="option"&&m!=v[u])&&qS(r,u,m,v[u],s),u="checked",g!=null&&g!=r[u]&&qS(r,u,g,v[u],s))}return r}function lB(r,e,n){try{if(typeof r=="function"){var i=typeof r.__u=="function";i&&r.__u(),i&&e==null||(r.__u=r(e))}else r.current=e}catch(s){or.__e(s,n)}}function Kee(r,e,n){var i,s;if(or.unmount&&or.unmount(r),(i=r.ref)&&(i.current&&i.current!=r.__e||lB(i,null,e)),(i=r.__c)!=null){if(i.componentWillUnmount)try{i.componentWillUnmount()}catch(o){or.__e(o,e)}i.base=i.__P=null}if(i=r.__k)for(s=0;s<i.length;s++)i[s]&&Kee(i[s],e,n||typeof r.type!="function");n||oB(r.__e),r.__c=r.__=r.__e=void 0}function FUe(r,e,n){return this.constructor(r,n)}function BUe(r,e,n){var i,s,o,a;e==document&&(e=document.documentElement),or.__&&or.__(r,e),s=(i=typeof n=="function")?null:e.__k,o=[],a=[],aB(e,r=(!i&&n||e).__k=DUe(NA,null,[r]),s||fb,fb,e.namespaceURI,!i&&n?[n]:s?null:e.firstChild?N_.call(e.childNodes):null,o,!i&&n?n:s?s.__e:e.firstChild,i,a),qee(o,r,a)}function Yee(r,e,n){var i,s,o,a,l=Ml({},r.props);for(o in r.type&&r.type.defaultProps&&(a=r.type.defaultProps),e)o=="key"?i=e[o]:o=="ref"?s=e[o]:l[o]=e[o]==null&&a!=null?a[o]:e[o];return arguments.length>2&&(l.children=arguments.length>3?N_.call(arguments,2):n),H0(r.type,l,i||r.key,s||r.ref,null)}N_=Vee.slice,or={__e:function(r,e,n,i){for(var s,o,a;e=e.__;)if((s=e.__c)&&!s.__)try{if((o=s.constructor)&&o.getDerivedStateFromError!=null&&(s.setState(o.getDerivedStateFromError(r)),a=s.__d),s.componentDidCatch!=null&&(s.componentDidCatch(r,i||{}),a=s.__d),a)return s.__E=s}catch(l){r=l}throw r}},Bee=0,Uee=function(r){return r!=null&&r.constructor==null},$1.prototype.setState=function(r,e){var n;n=this.__s!=null&&this.__s!=this.state?this.__s:this.__s=Ml({},this.state),typeof r=="function"&&(r=r(Ml({},n),this.props)),r&&Ml(n,r),r!=null&&this.__v&&(e&&this._sb.push(e),dH(this))},$1.prototype.forceUpdate=function(r){this.__v&&(this.__e=!0,r&&this.__h.push(r),dH(this))},$1.prototype.render=NA,Ff=[],zee=typeof Promise=="function"?Promise.prototype.then.bind(Promise.resolve()):setTimeout,$ee=function(r,e){return r.__v.__b-e.__v.__b},xE.__r=0,jee=/(PointerCapture)$|Capture$/i,sB=0,DD=mH(!1),kD=mH(!0);function gH(r,e){(e==null||e>r.length)&&(e=r.length);for(var n=0,i=Array(e);n<e;n++)i[n]=r[n];return i}function UUe(r){if(Array.isArray(r))return r}function zUe(r,e,n){return(e=WUe(e))in r?Object.defineProperty(r,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):r[e]=n,r}function $Ue(r,e){var n=r==null?null:typeof Symbol<"u"&&r[Symbol.iterator]||r["@@iterator"];if(n!=null){var i,s,o,a,l=[],c=!0,u=!1;try{if(o=(n=n.call(r)).next,e!==0)for(;!(c=(i=o.call(n)).done)&&(l.push(i.value),l.length!==e);c=!0);}catch(h){u=!0,s=h}finally{try{if(!c&&n.return!=null&&(a=n.return(),Object(a)!==a))return}finally{if(u)throw s}}return l}}function jUe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function yH(r,e){var n=Object.keys(r);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(r);e&&(i=i.filter(function(s){return Object.getOwnPropertyDescriptor(r,s).enumerable})),n.push.apply(n,i)}return n}function VUe(r){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?yH(Object(n),!0).forEach(function(i){zUe(r,i,n[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(n)):yH(Object(n)).forEach(function(i){Object.defineProperty(r,i,Object.getOwnPropertyDescriptor(n,i))})}return r}function GUe(r,e){return UUe(r)||$Ue(r,e)||qUe(r,e)||jUe()}function HUe(r,e){if(typeof r!="object"||!r)return r;var n=r[Symbol.toPrimitive];if(n!==void 0){var i=n.call(r,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(r)}function WUe(r){var e=HUe(r,"string");return typeof e=="symbol"?e:e+""}function bE(r){"@babel/helpers - typeof";return bE=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},bE(r)}function qUe(r,e){if(r){if(typeof r=="string")return gH(r,e);var n={}.toString.call(r).slice(8,-1);return n==="Object"&&r.constructor&&(n=r.constructor.name),n==="Map"||n==="Set"?Array.from(r):n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?gH(r,e):void 0}}var ID=function(e){if(bE(e)!=="object")return e;var n=Yee(e);if(n.props){var i;n.props=VUe({},n.props),n!=null&&(i=n.props)!==null&&i!==void 0&&i.children&&(n.props.children=Array.isArray(n.props.children)?n.props.children.map(ID):ID(n.props.children))}return n},XUe=function(e){return Uee(Yee(e))},KUe=function(e,n){delete n.__k,BUe(ID(e),n)};function YUe(r,e){e===void 0&&(e={});var n=e.insertAt;if(!(typeof document>"u")){var i=document.head||document.getElementsByTagName("head")[0],s=document.createElement("style");s.type="text/css",n==="top"&&i.firstChild?i.insertBefore(s,i.firstChild):i.appendChild(s),s.styleSheet?s.styleSheet.cssText=r:s.appendChild(document.createTextNode(r))}}var ZUe=`.float-tooltip-kap {
  position: absolute;
  width: max-content; /* prevent shrinking near right edge */
  max-width: max(50%, 150px);
  padding: 3px 5px;
  border-radius: 3px;
  font: 12px sans-serif;
  color: #eee;
  background: rgba(0,0,0,0.6);
  pointer-events: none;
}
`;YUe(ZUe);var Zee=Vh({props:{content:{default:!1},offsetX:{triggerUpdate:!1},offsetY:{triggerUpdate:!1}},init:function(e,n){var i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},s=i.style,o=s===void 0?{}:s,a=!!e&&bE(e)==="object"&&!!e.node&&typeof e.node=="function",l=na(a?e.node():e);l.style("position")==="static"&&l.style("position","relative"),n.tooltipEl=l.append("div").attr("class","float-tooltip-kap"),Object.entries(o).forEach(function(u){var h=GUe(u,2),f=h[0],d=h[1];return n.tooltipEl.style(f,d)}),n.tooltipEl.style("left","-10000px").style("display","none");var c="tooltip-".concat(Math.round(Math.random()*1e12));n.mouseInside=!1,l.on("mousemove.".concat(c),function(u){n.mouseInside=!0;var h=vl(u),f=l.node(),d=f.offsetWidth,p=f.offsetHeight,m=[n.offsetX===null||n.offsetX===void 0?"-".concat(h[0]/d*100,"%"):typeof n.offsetX=="number"?"calc(-50% + ".concat(n.offsetX,"px)"):n.offsetX,n.offsetY===null||n.offsetY===void 0?p>130&&p-h[1]<100?"calc(-100% - 6px)":"21px":typeof n.offsetY=="number"?n.offsetY<0?"calc(-100% - ".concat(Math.abs(n.offsetY),"px)"):"".concat(n.offsetY,"px"):n.offsetY];n.tooltipEl.style("left",h[0]+"px").style("top",h[1]+"px").style("transform","translate(".concat(m.join(","),")")),n.content&&n.tooltipEl.style("display","inline")}),l.on("mouseover.".concat(c),function(){n.mouseInside=!0,n.content&&n.tooltipEl.style("display","inline")}),l.on("mouseout.".concat(c),function(){n.mouseInside=!1,n.tooltipEl.style("display","none")})},update:function(e){e.tooltipEl.style("display",e.content&&e.mouseInside?"inline":"none"),e.content?e.content instanceof HTMLElement?(e.tooltipEl.text(""),e.tooltipEl.append(function(){return e.content})):typeof e.content=="string"?e.tooltipEl.html(e.content):XUe(e.content)?(e.tooltipEl.text(""),KUe(e.content,e.tooltipEl.node())):(e.tooltipEl.style("display","none"),console.warn("Tooltip content is invalid, skipping.",e.content,e.content.toString())):e.tooltipEl.text("")}});function QUe(r,e){e===void 0&&(e={});var n=e.insertAt;if(!(typeof document>"u")){var i=document.head||document.getElementsByTagName("head")[0],s=document.createElement("style");s.type="text/css",n==="top"&&i.firstChild?i.insertBefore(s,i.firstChild):i.appendChild(s),s.styleSheet?s.styleSheet.cssText=r:s.appendChild(document.createTextNode(r))}}var JUe=`.scene-nav-info {
  position: absolute;
  bottom: 5px;
  width: 100%;
  text-align: center;
  color: slategrey;
  opacity: 0.7;
  font-size: 10px;
  font-family: sans-serif;
  pointer-events: none;
  user-select: none;
}

.scene-container canvas:focus {
  outline: none;
}`;QUe(JUe);function LD(r,e){(e==null||e>r.length)&&(e=r.length);for(var n=0,i=Array(e);n<e;n++)i[n]=r[n];return i}function eze(r){if(Array.isArray(r))return r}function tze(r){if(Array.isArray(r))return LD(r)}function nze(r,e,n){return(e=cze(e))in r?Object.defineProperty(r,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):r[e]=n,r}function rze(r){if(typeof Symbol<"u"&&r[Symbol.iterator]!=null||r["@@iterator"]!=null)return Array.from(r)}function ize(r,e){var n=r==null?null:typeof Symbol<"u"&&r[Symbol.iterator]||r["@@iterator"];if(n!=null){var i,s,o,a,l=[],c=!0,u=!1;try{if(o=(n=n.call(r)).next,e!==0)for(;!(c=(i=o.call(n)).done)&&(l.push(i.value),l.length!==e);c=!0);}catch(h){u=!0,s=h}finally{try{if(!c&&n.return!=null&&(a=n.return(),Object(a)!==a))return}finally{if(u)throw s}}return l}}function sze(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function oze(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function aze(r,e){return eze(r)||ize(r,e)||Qee(r,e)||sze()}function mf(r){return tze(r)||rze(r)||Qee(r)||oze()}function lze(r,e){if(typeof r!="object"||!r)return r;var n=r[Symbol.toPrimitive];if(n!==void 0){var i=n.call(r,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(r)}function cze(r){var e=lze(r,"string");return typeof e=="symbol"?e:e+""}function Qee(r,e){if(r){if(typeof r=="string")return LD(r,e);var n={}.toString.call(r).slice(8,-1);return n==="Object"&&r.constructor&&(n=r.constructor.name),n==="Map"||n==="Set"?Array.from(r):n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?LD(r,e):void 0}}var rr=window.THREE?window.THREE:{WebGLRenderer:gSe,Scene:QM,PerspectiveCamera:Ti,Raycaster:$Y,SRGBColorSpace:vt,TextureLoader:S0e,Vector2:Fe,Vector3:K,Box3:Od,Color:pt,Mesh:Jn,SphereGeometry:xd,MeshBasicMaterial:As,BackSide:Fn,Clock:zY},Jee=Vh({props:{width:{default:window.innerWidth,onChange:function(e,n,i){isNaN(e)&&(n.width=i)}},height:{default:window.innerHeight,onChange:function(e,n,i){isNaN(e)&&(n.height=i)}},viewOffset:{default:[0,0]},backgroundColor:{default:"#000011"},backgroundImageUrl:{},onBackgroundImageLoaded:{},showNavInfo:{default:!0},skyRadius:{default:5e4},objects:{default:[]},lights:{default:[]},enablePointerInteraction:{default:!0,onChange:function(e,n){n.hoverObj=null,n.tooltip&&n.tooltip.content(null)},triggerUpdate:!1},pointerRaycasterThrottleMs:{default:50,triggerUpdate:!1},lineHoverPrecision:{default:1,triggerUpdate:!1},pointsHoverPrecision:{default:1,triggerUpdate:!1},hoverOrderComparator:{triggerUpdate:!1},hoverFilter:{default:function(){return!0},triggerUpdate:!1},tooltipContent:{triggerUpdate:!1},hoverDuringDrag:{default:!1,triggerUpdate:!1},clickAfterDrag:{default:!1,triggerUpdate:!1},onHover:{default:function(){},triggerUpdate:!1},onClick:{default:function(){},triggerUpdate:!1},onRightClick:{triggerUpdate:!1}},methods:{tick:function(e){if(e.initialised){e.controls.enabled&&e.controls.update&&e.controls.update(Math.min(1,e.clock.getDelta())),e.postProcessingComposer?e.postProcessingComposer.render():e.renderer.render(e.scene,e.camera),e.extraRenderers.forEach(function(a){return a.render(e.scene,e.camera)});var n=+new Date;if(e.enablePointerInteraction&&n-e.lastRaycasterCheck>=e.pointerRaycasterThrottleMs){e.lastRaycasterCheck=n;var i=null;if(e.hoverDuringDrag||!e.isPointerDragging){var s=this.intersectingObjects(e.pointerPos.x,e.pointerPos.y);e.hoverOrderComparator&&s.sort(function(a,l){return e.hoverOrderComparator(a.object,l.object)});var o=s.find(function(a){return e.hoverFilter(a.object)})||null;i=o?o.object:null,e.intersection=o||null}i!==e.hoverObj&&(e.onHover(i,e.hoverObj,e.intersection),e.tooltip.content(i&&ht(e.tooltipContent)(i,e.intersection)||null),e.hoverObj=i)}e.tweenGroup.update()}return this},getPointerPos:function(e){var n=e.pointerPos,i=n.x,s=n.y;return{x:i,y:s}},cameraPosition:function(e,n,i,s){var o=e.camera;if(n&&e.initialised){var a=n,l=i||{x:0,y:0,z:0};if(!s)h(a),f(l);else{var c=Object.assign({},o.position),u=d();e.tweenGroup.add(new yE(c).to(a,s).easing(Kc.Quadratic.Out).onUpdate(h).start()),e.tweenGroup.add(new yE(u).to(l,s/3).easing(Kc.Quadratic.Out).onUpdate(f).start())}return this}return Object.assign({},o.position,{lookAt:d()});function h(p){var m=p.x,g=p.y,v=p.z;m!==void 0&&(o.position.x=m),g!==void 0&&(o.position.y=g),v!==void 0&&(o.position.z=v)}function f(p){var m=new rr.Vector3(p.x,p.y,p.z);e.controls.target?e.controls.target=m:o.lookAt(m)}function d(){return Object.assign(new rr.Vector3(0,0,-1e3).applyQuaternion(o.quaternion).add(o.position))}},zoomToFit:function(e){for(var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:10,s=arguments.length,o=new Array(s>3?s-3:0),a=3;a<s;a++)o[a-3]=arguments[a];return this.fitToBbox(this.getBbox.apply(this,o),n,i)},fitToBbox:function(e,n){var i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,s=arguments.length>3&&arguments[3]!==void 0?arguments[3]:10,o=e.camera;if(n){var a=new rr.Vector3(0,0,0),l=Math.max.apply(Math,mf(Object.entries(n).map(function(p){var m=aze(p,2),g=m[0],v=m[1];return Math.max.apply(Math,mf(v.map(function(y){return Math.abs(a[g]-y)})))})))*2,c=(1-s*2/e.height)*o.fov,u=l/Math.atan(c*Math.PI/180),h=u/o.aspect,f=Math.max(u,h);if(f>0){var d=a.clone().sub(o.position).normalize().multiplyScalar(-f);this.cameraPosition(d,a,i)}}return this},getBbox:function(e){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:function(){return!0},i=new rr.Box3(new rr.Vector3(0,0,0),new rr.Vector3(0,0,0)),s=e.objects.filter(n);return s.length?(s.forEach(function(o){return i.expandByObject(o)}),Object.assign.apply(Object,mf(["x","y","z"].map(function(o){return nze({},o,[i.min[o],i.max[o]])})))):null},getScreenCoords:function(e,n,i,s){var o=new rr.Vector3(n,i,s);return o.project(this.camera()),{x:(o.x+1)*e.width/2,y:-(o.y-1)*e.height/2}},getSceneCoords:function(e,n,i){var s=arguments.length>3&&arguments[3]!==void 0?arguments[3]:0,o=new rr.Vector2(n/e.width*2-1,-(i/e.height)*2+1),a=new rr.Raycaster;return a.setFromCamera(o,e.camera),Object.assign({},a.ray.at(s,new rr.Vector3))},intersectingObjects:function(e,n,i){var s=new rr.Vector2(n/e.width*2-1,-(i/e.height)*2+1),o=new rr.Raycaster;return o.params.Line.threshold=e.lineHoverPrecision,o.params.Points.threshold=e.pointsHoverPrecision,o.setFromCamera(s,e.camera),o.intersectObjects(e.objects,!0)},renderer:function(e){return e.renderer},scene:function(e){return e.scene},camera:function(e){return e.camera},postProcessingComposer:function(e){return e.postProcessingComposer},controls:function(e){return e.controls},tbControls:function(e){return e.controls}},stateInit:function(){return{scene:new rr.Scene,camera:new rr.PerspectiveCamera,clock:new rr.Clock,tweenGroup:new nB,lastRaycasterCheck:0}},init:function(e,n){var i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},s=i.controlType,o=s===void 0?"trackball":s,a=i.useWebGPU,l=a===void 0?!1:a,c=i.rendererConfig,u=c===void 0?{}:c,h=i.extraRenderers,f=h===void 0?[]:h,d=i.waitForLoadComplete,p=d===void 0?!0:d;e.innerHTML="",e.appendChild(n.container=document.createElement("div")),n.container.className="scene-container",n.container.style.position="relative",n.container.appendChild(n.navInfo=document.createElement("div")),n.navInfo.className="scene-nav-info",n.navInfo.textContent={orbit:"Left-click: rotate, Mouse-wheel/middle-click: zoom, Right-click: pan",trackball:"Left-click: rotate, Mouse-wheel/middle-click: zoom, Right-click: pan",fly:"WASD: move, R|F: up | down, Q|E: roll, up|down: pitch, left|right: yaw"}[o]||"",n.navInfo.style.display=n.showNavInfo?null:"none",n.tooltip=new Zee(n.container),n.pointerPos=new rr.Vector2,n.pointerPos.x=-2,n.pointerPos.y=-2,["pointermove","pointerdown"].forEach(function(m){return n.container.addEventListener(m,function(g){if(m==="pointerdown"&&(n.isPointerPressed=!0),!n.isPointerDragging&&g.type==="pointermove"&&(g.pressure>0||n.isPointerPressed)&&(g.pointerType!=="touch"||g.movementX===void 0||[g.movementX,g.movementY].some(function(x){return Math.abs(x)>1}))&&(n.isPointerDragging=!0),n.enablePointerInteraction){var v=y(n.container);n.pointerPos.x=g.pageX-v.left,n.pointerPos.y=g.pageY-v.top}function y(x){var b=x.getBoundingClientRect(),w=window.pageXOffset||document.documentElement.scrollLeft,_=window.pageYOffset||document.documentElement.scrollTop;return{top:b.top+_,left:b.left+w}}},{passive:!0})}),n.container.addEventListener("pointerup",function(m){n.isPointerPressed&&(n.isPointerPressed=!1,!(n.isPointerDragging&&(n.isPointerDragging=!1,!n.clickAfterDrag))&&requestAnimationFrame(function(){m.button===0&&n.onClick(n.hoverObj||null,m,n.intersection),m.button===2&&n.onRightClick&&n.onRightClick(n.hoverObj||null,m,n.intersection)}))},{passive:!0,capture:!0}),n.container.addEventListener("contextmenu",function(m){n.onRightClick&&m.preventDefault()}),n.renderer=new(l?r3e:rr.WebGLRenderer)(Object.assign({antialias:!0,alpha:!0},u)),n.renderer.setPixelRatio(Math.min(2,window.devicePixelRatio)),n.container.appendChild(n.renderer.domElement),n.extraRenderers=f,n.extraRenderers.forEach(function(m){m.domElement.style.position="absolute",m.domElement.style.top="0px",m.domElement.style.pointerEvents="none",n.container.appendChild(m.domElement)}),n.postProcessingComposer=new Y3e(n.renderer),n.postProcessingComposer.addPass(new Z3e(n.scene,n.camera)),n.controls=new{trackball:s3e,orbit:_3e,fly:I3e}[o](n.camera,n.renderer.domElement),o==="fly"&&(n.controls.movementSpeed=300,n.controls.rollSpeed=Math.PI/6,n.controls.dragToLook=!0),(o==="trackball"||o==="orbit")&&(n.controls.minDistance=.1,n.controls.maxDistance=n.skyRadius,n.controls.addEventListener("start",function(){n.controlsEngaged=!0}),n.controls.addEventListener("change",function(){n.controlsEngaged&&(n.controlsDragging=!0)}),n.controls.addEventListener("end",function(){n.controlsEngaged=!1,n.controlsDragging=!1})),[n.renderer,n.postProcessingComposer].concat(mf(n.extraRenderers)).forEach(function(m){return m.setSize(n.width,n.height)}),n.camera.aspect=n.width/n.height,n.camera.updateProjectionMatrix(),n.camera.position.z=1e3,n.scene.add(n.skysphere=new rr.Mesh),n.skysphere.visible=!1,n.loadComplete=n.scene.visible=!p,window.scene=n.scene},update:function(e,n){if(e.width&&e.height&&(n.hasOwnProperty("width")||n.hasOwnProperty("height"))){var i,s=e.width,o=e.height;e.container.style.width="".concat(s,"px"),e.container.style.height="".concat(o,"px"),[e.renderer,e.postProcessingComposer].concat(mf(e.extraRenderers)).forEach(function(p){return p.setSize(s,o)}),e.camera.aspect=s/o;var a=e.viewOffset.slice(0,2);a.some(function(p){return p})&&(i=e.camera).setViewOffset.apply(i,[s,o].concat(mf(a),[s,o])),e.camera.updateProjectionMatrix()}if(n.hasOwnProperty("viewOffset")){var l,c=e.width,u=e.height,h=e.viewOffset.slice(0,2);h.some(function(p){return p})?(l=e.camera).setViewOffset.apply(l,[c,u].concat(mf(h),[c,u])):e.camera.clearViewOffset()}if(n.hasOwnProperty("skyRadius")&&e.skyRadius&&(e.controls.hasOwnProperty("maxDistance")&&n.skyRadius&&(e.controls.maxDistance=Math.min(e.controls.maxDistance,e.skyRadius)),e.camera.far=e.skyRadius*2.5,e.camera.updateProjectionMatrix(),e.skysphere.geometry=new rr.SphereGeometry(e.skyRadius)),n.hasOwnProperty("backgroundColor")){var f=Nh(e.backgroundColor).alpha;f===void 0&&(f=1),e.renderer.setClearColor(new rr.Color(MQ(1,e.backgroundColor)),f)}n.hasOwnProperty("backgroundImageUrl")&&(e.backgroundImageUrl?new rr.TextureLoader().load(e.backgroundImageUrl,function(p){p.colorSpace=rr.SRGBColorSpace,e.skysphere.material=new rr.MeshBasicMaterial({map:p,side:rr.BackSide}),e.skysphere.visible=!0,e.onBackgroundImageLoaded&&setTimeout(e.onBackgroundImageLoaded),!e.loadComplete&&d()}):(e.skysphere.visible=!1,e.skysphere.material.map=null,!e.loadComplete&&d())),n.hasOwnProperty("showNavInfo")&&(e.navInfo.style.display=e.showNavInfo?null:"none"),n.hasOwnProperty("lights")&&((n.lights||[]).forEach(function(p){return e.scene.remove(p)}),e.lights.forEach(function(p){return e.scene.add(p)})),n.hasOwnProperty("objects")&&((n.objects||[]).forEach(function(p){return e.scene.remove(p)}),e.objects.forEach(function(p){return e.scene.add(p)}));function d(){e.loadComplete=e.scene.visible=!0}}});function uze(r,e){e===void 0&&(e={});var n=e.insertAt;if(!(typeof document>"u")){var i=document.head||document.getElementsByTagName("head")[0],s=document.createElement("style");s.type="text/css",n==="top"&&i.firstChild?i.insertBefore(s,i.firstChild):i.appendChild(s),s.styleSheet?s.styleSheet.cssText=r:s.appendChild(document.createTextNode(r))}}var hze=`.graph-info-msg {
  top: 50%;
  width: 100%;
  text-align: center;
  color: lavender;
  opacity: 0.7;
  font-size: 22px;
  position: absolute;
  font-family: Sans-serif;
}

.scene-container .clickable {
  cursor: pointer;
}

.scene-container .grabbable {
  cursor: move;
  cursor: grab;
  cursor: -moz-grab;
  cursor: -webkit-grab;
}

.scene-container .grabbable:active {
  cursor: grabbing;
  cursor: -moz-grabbing;
  cursor: -webkit-grabbing;
}`;uze(hze);function FD(r,e){(e==null||e>r.length)&&(e=r.length);for(var n=0,i=Array(e);n<e;n++)i[n]=r[n];return i}function fze(r){if(Array.isArray(r))return FD(r)}function O_(r,e,n){return(e=gze(e))in r?Object.defineProperty(r,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):r[e]=n,r}function dze(r){if(typeof Symbol<"u"&&r[Symbol.iterator]!=null||r["@@iterator"]!=null)return Array.from(r)}function pze(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function vH(r,e){var n=Object.keys(r);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(r);e&&(i=i.filter(function(s){return Object.getOwnPropertyDescriptor(r,s).enumerable})),n.push.apply(n,i)}return n}function XS(r){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?vH(Object(n),!0).forEach(function(i){O_(r,i,n[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(n)):vH(Object(n)).forEach(function(i){Object.defineProperty(r,i,Object.getOwnPropertyDescriptor(n,i))})}return r}function OA(r){return fze(r)||dze(r)||yze(r)||pze()}function mze(r,e){if(typeof r!="object"||!r)return r;var n=r[Symbol.toPrimitive];if(n!==void 0){var i=n.call(r,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(r)}function gze(r){var e=mze(r,"string");return typeof e=="symbol"?e:e+""}function yze(r,e){if(r){if(typeof r=="string")return FD(r,e);var n={}.toString.call(r).slice(8,-1);return n==="Object"&&r.constructor&&(n=r.constructor.name),n==="Map"||n==="Set"?Array.from(r):n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?FD(r,e):void 0}}function ete(r,e){var n=new e;return n._destructor&&n._destructor(),{linkProp:function(s){return{default:n[s](),onChange:function(a,l){l[r][s](a)},triggerUpdate:!1}},linkMethod:function(s){return function(o){for(var a=o[r],l=arguments.length,c=new Array(l>1?l-1:0),u=1;u<l;u++)c[u-1]=arguments[u];var h=a[s].apply(a,c);return h===a?this:h}}}}var UN=window.THREE?window.THREE:{AmbientLight:BY,DirectionalLight:FY,REVISION:my},vze=170,tte=ete("forceGraph",cm),xze=Object.assign.apply(Object,OA(["jsonUrl","graphData","numDimensions","dagMode","dagLevelDistance","dagNodeFilter","onDagError","nodeRelSize","nodeId","nodeVal","nodeResolution","nodeColor","nodeAutoColorBy","nodeOpacity","nodeVisibility","nodeThreeObject","nodeThreeObjectExtend","nodePositionUpdate","linkSource","linkTarget","linkVisibility","linkColor","linkAutoColorBy","linkOpacity","linkWidth","linkResolution","linkCurvature","linkCurveRotation","linkMaterial","linkThreeObject","linkThreeObjectExtend","linkPositionUpdate","linkDirectionalArrowLength","linkDirectionalArrowColor","linkDirectionalArrowRelPos","linkDirectionalArrowResolution","linkDirectionalParticles","linkDirectionalParticleSpeed","linkDirectionalParticleWidth","linkDirectionalParticleColor","linkDirectionalParticleResolution","forceEngine","d3AlphaDecay","d3VelocityDecay","d3AlphaMin","ngraphPhysics","warmupTicks","cooldownTicks","cooldownTime","onEngineTick","onEngineStop"].map(function(r){return O_({},r,tte.linkProp(r))}))),bze=Object.assign.apply(Object,OA(["refresh","getGraphBbox","d3Force","d3ReheatSimulation","emitParticle"].map(function(r){return O_({},r,tte.linkMethod(r))}))),j1=ete("renderObjs",Jee),_ze=Object.assign.apply(Object,OA(["width","height","backgroundColor","showNavInfo","enablePointerInteraction"].map(function(r){return O_({},r,j1.linkProp(r))}))),wze=Object.assign.apply(Object,OA(["lights","cameraPosition","postProcessingComposer"].map(function(r){return O_({},r,j1.linkMethod(r))})).concat([{graph2ScreenCoords:j1.linkMethod("getScreenCoords"),screen2GraphCoords:j1.linkMethod("getSceneCoords")}])),Sze=Vh({props:XS(XS({nodeLabel:{default:"name",triggerUpdate:!1},linkLabel:{default:"name",triggerUpdate:!1},linkHoverPrecision:{default:1,onChange:function(e,n){return n.renderObjs.lineHoverPrecision(e)},triggerUpdate:!1},enableNavigationControls:{default:!0,onChange:function(e,n){var i=n.renderObjs.controls();i&&(i.enabled=e,e&&i.domElement&&i.domElement.dispatchEvent(new PointerEvent("pointerup")))},triggerUpdate:!1},enableNodeDrag:{default:!0,triggerUpdate:!1},onNodeDrag:{default:function(){},triggerUpdate:!1},onNodeDragEnd:{default:function(){},triggerUpdate:!1},onNodeClick:{triggerUpdate:!1},onNodeRightClick:{triggerUpdate:!1},onNodeHover:{triggerUpdate:!1},onLinkClick:{triggerUpdate:!1},onLinkRightClick:{triggerUpdate:!1},onLinkHover:{triggerUpdate:!1},onBackgroundClick:{triggerUpdate:!1},onBackgroundRightClick:{triggerUpdate:!1}},xze),_ze),methods:XS(XS({zoomToFit:function(e,n,i){for(var s,o=arguments.length,a=new Array(o>3?o-3:0),l=3;l<o;l++)a[l-3]=arguments[l];return e.renderObjs.fitToBbox((s=e.forceGraph).getGraphBbox.apply(s,a),n,i),this},pauseAnimation:function(e){return e.animationFrameRequestId!==null&&(cancelAnimationFrame(e.animationFrameRequestId),e.animationFrameRequestId=null),this},resumeAnimation:function(e){return e.animationFrameRequestId===null&&this._animationCycle(),this},_animationCycle:function(e){e.enablePointerInteraction&&(this.renderer().domElement.style.cursor=null),e.forceGraph.tickFrame(),e.renderObjs.tick(),e.animationFrameRequestId=requestAnimationFrame(this._animationCycle)},scene:function(e){return e.renderObjs.scene()},camera:function(e){return e.renderObjs.camera()},renderer:function(e){return e.renderObjs.renderer()},controls:function(e){return e.renderObjs.controls()},tbControls:function(e){return e.renderObjs.tbControls()},_destructor:function(){this.pauseAnimation(),this.graphData({nodes:[],links:[]})}},bze),wze),stateInit:function(e){var n=e.controlType,i=e.rendererConfig,s=e.extraRenderers,o=new cm;return{forceGraph:o,renderObjs:Jee({controlType:n,rendererConfig:i,extraRenderers:s}).objects([o]).lights([new UN.AmbientLight(13421772,Math.PI),new UN.DirectionalLight(16777215,.6*Math.PI)])}},init:function(e,n){e.innerHTML="",e.appendChild(n.container=document.createElement("div")),n.container.style.position="relative";var i=document.createElement("div");n.container.appendChild(i),n.renderObjs(i);var s=n.renderObjs.camera(),o=n.renderObjs.renderer(),a=n.renderObjs.controls();a.enabled=!!n.enableNavigationControls,n.lastSetCameraZ=s.position.z;var l;n.container.appendChild(l=document.createElement("div")),l.className="graph-info-msg",l.textContent="",n.forceGraph.onLoading(function(){l.textContent="Loading..."}).onFinishLoading(function(){l.textContent=""}).onUpdate(function(){n.graphData=n.forceGraph.graphData(),s.position.x===0&&s.position.y===0&&s.position.z===n.lastSetCameraZ&&n.graphData.nodes.length&&(s.lookAt(n.forceGraph.position),n.lastSetCameraZ=s.position.z=Math.cbrt(n.graphData.nodes.length)*vze)}).onFinishUpdate(function(){if(n._dragControls){var c=n.graphData.nodes.find(function(h){return h.__initialFixedPos&&!h.__disposeControlsAfterDrag});c?c.__disposeControlsAfterDrag=!0:n._dragControls.dispose(),n._dragControls=void 0}if(n.enableNodeDrag&&n.enablePointerInteraction&&n.forceEngine==="d3"){var u=n._dragControls=new qPe(n.graphData.nodes.map(function(h){return h.__threeObj}).filter(function(h){return h}),s,o.domElement);u.addEventListener("dragstart",function(h){var f=pc(h.object);if(f){a.enabled=!1,h.object.__initialPos=h.object.position.clone(),h.object.__prevPos=h.object.position.clone();var d=f.__data;!d.__initialFixedPos&&(d.__initialFixedPos={fx:d.fx,fy:d.fy,fz:d.fz}),!d.__initialPos&&(d.__initialPos={x:d.x,y:d.y,z:d.z}),["x","y","z"].forEach(function(p){return d["f".concat(p)]=d[p]}),o.domElement.classList.add("grabbable")}}),u.addEventListener("drag",function(h){var f=pc(h.object);if(f){if(!h.object.hasOwnProperty("__graphObjType")){var d=h.object.__initialPos,p=h.object.__prevPos,m=h.object.position;f.position.add(m.clone().sub(p)),p.copy(m),m.copy(d)}var g=f.__data,v=f.position,y={x:v.x-g.x,y:v.y-g.y,z:v.z-g.z};["x","y","z"].forEach(function(x){return g["f".concat(x)]=g[x]=v[x]}),n.forceGraph.d3AlphaTarget(.3).resetCountdown(),g.__dragged=!0,n.onNodeDrag(g,y)}}),u.addEventListener("dragend",function(h){var f=pc(h.object);if(f){delete h.object.__initialPos,delete h.object.__prevPos;var d=f.__data;d.__disposeControlsAfterDrag&&(u.dispose(),delete d.__disposeControlsAfterDrag);var p=d.__initialFixedPos,m=d.__initialPos,g={x:m.x-d.x,y:m.y-d.y,z:m.z-d.z};p&&(["x","y","z"].forEach(function(v){var y="f".concat(v);p[y]===void 0&&delete d[y]}),delete d.__initialFixedPos,delete d.__initialPos,d.__dragged&&(delete d.__dragged,n.onNodeDragEnd(d,g))),n.forceGraph.d3AlphaTarget(0).resetCountdown(),n.enableNavigationControls&&(a.enabled=!0,a.domElement&&a.domElement.ownerDocument&&a.domElement.ownerDocument.dispatchEvent(new PointerEvent("pointerup",{pointerType:"touch"}))),o.domElement.classList.remove("grabbable")}})}}),UN.REVISION<155&&(n.renderObjs.renderer().useLegacyLights=!1),n.renderObjs.hoverOrderComparator(function(c,u){var h=pc(c);if(!h)return 1;var f=pc(u);if(!f)return-1;var d=function(m){return m.__graphObjType==="node"};return d(f)-d(h)}).tooltipContent(function(c){var u=pc(c);return u&&ht(n["".concat(u.__graphObjType,"Label")])(u.__data)||""}).hoverDuringDrag(!1).onHover(function(c){var u=pc(c);if(u!==n.hoverObj){var h=n.hoverObj?n.hoverObj.__graphObjType:null,f=n.hoverObj?n.hoverObj.__data:null,d=u?u.__graphObjType:null,p=u?u.__data:null;if(h&&h!==d){var m=n["on".concat(h==="node"?"Node":"Link","Hover")];m&&m(null,f)}if(d){var g=n["on".concat(d==="node"?"Node":"Link","Hover")];g&&g(p,h===d?f:null)}o.domElement.classList[u&&n["on".concat(d==="node"?"Node":"Link","Click")]||!u&&n.onBackgroundClick?"add":"remove"]("clickable"),n.hoverObj=u}}).clickAfterDrag(!1).onClick(function(c,u){var h=pc(c);if(h){var f=n["on".concat(h.__graphObjType==="node"?"Node":"Link","Click")];f&&f(h.__data,u)}else n.onBackgroundClick&&n.onBackgroundClick(u)}).onRightClick(function(c,u){var h=pc(c);if(h){var f=n["on".concat(h.__graphObjType==="node"?"Node":"Link","RightClick")];f&&f(h.__data,u)}else n.onBackgroundRightClick&&n.onBackgroundRightClick(u)}),this._animationCycle()}});function pc(r){for(var e=r;e&&!e.hasOwnProperty("__graphObjType");)e=e.parent;return e}const Tze={passive:!1},db={capture:!0,passive:!1};function zN(r){r.stopImmediatePropagation()}function Um(r){r.preventDefault(),r.stopImmediatePropagation()}function nte(r){var e=r.document.documentElement,n=na(r).on("dragstart.drag",Um,db);"onselectstart"in e?n.on("selectstart.drag",Um,db):(e.__noselect=e.style.MozUserSelect,e.style.MozUserSelect="none")}function rte(r,e){var n=r.document.documentElement,i=na(r).on("dragstart.drag",null);e&&(i.on("click.drag",Um,db),setTimeout(function(){i.on("click.drag",null)},0)),"onselectstart"in n?i.on("selectstart.drag",null):(n.style.MozUserSelect=n.__noselect,delete n.__noselect)}const KS=r=>()=>r;function BD(r,{sourceEvent:e,subject:n,target:i,identifier:s,active:o,x:a,y:l,dx:c,dy:u,dispatch:h}){Object.defineProperties(this,{type:{value:r,enumerable:!0,configurable:!0},sourceEvent:{value:e,enumerable:!0,configurable:!0},subject:{value:n,enumerable:!0,configurable:!0},target:{value:i,enumerable:!0,configurable:!0},identifier:{value:s,enumerable:!0,configurable:!0},active:{value:o,enumerable:!0,configurable:!0},x:{value:a,enumerable:!0,configurable:!0},y:{value:l,enumerable:!0,configurable:!0},dx:{value:c,enumerable:!0,configurable:!0},dy:{value:u,enumerable:!0,configurable:!0},_:{value:h}})}BD.prototype.on=function(){var r=this._.on.apply(this._,arguments);return r===this._?this:r};function Eze(r){return!r.ctrlKey&&!r.button}function Mze(){return this.parentNode}function Aze(r,e){return e??{x:r.x,y:r.y}}function Cze(){return navigator.maxTouchPoints||"ontouchstart"in this}function Pze(){var r=Eze,e=Mze,n=Aze,i=Cze,s={},o=v_("start","drag","end"),a=0,l,c,u,h,f=0;function d(w){w.on("mousedown.drag",p).filter(i).on("touchstart.drag",v).on("touchmove.drag",y,Tze).on("touchend.drag touchcancel.drag",x).style("touch-action","none").style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}function p(w,_){if(!(h||!r.call(this,w,_))){var S=b(this,e.call(this,w,_),w,_,"mouse");S&&(na(w.view).on("mousemove.drag",m,db).on("mouseup.drag",g,db),nte(w.view),zN(w),u=!1,l=w.clientX,c=w.clientY,S("start",w))}}function m(w){if(Um(w),!u){var _=w.clientX-l,S=w.clientY-c;u=_*_+S*S>f}s.mouse("drag",w)}function g(w){na(w.view).on("mousemove.drag mouseup.drag",null),rte(w.view,u),Um(w),s.mouse("end",w)}function v(w,_){if(r.call(this,w,_)){var S=w.changedTouches,T=e.call(this,w,_),E=S.length,M,A;for(M=0;M<E;++M)(A=b(this,T,w,_,S[M].identifier,S[M]))&&(zN(w),A("start",w,S[M]))}}function y(w){var _=w.changedTouches,S=_.length,T,E;for(T=0;T<S;++T)(E=s[_[T].identifier])&&(Um(w),E("drag",w,_[T]))}function x(w){var _=w.changedTouches,S=_.length,T,E;for(h&&clearTimeout(h),h=setTimeout(function(){h=null},500),T=0;T<S;++T)(E=s[_[T].identifier])&&(zN(w),E("end",w,_[T]))}function b(w,_,S,T,E,M){var A=o.copy(),P=vl(M||S,_),D,B,C;if((C=n.call(w,new BD("beforestart",{sourceEvent:S,target:d,identifier:E,active:a,x:P[0],y:P[1],dx:0,dy:0,dispatch:A}),T))!=null)return D=C.x-P[0]||0,B=C.y-P[1]||0,function O(R,z,U){var G=P,H;switch(R){case"start":s[E]=O,H=a++;break;case"end":delete s[E],--a;case"drag":P=vl(U||z,_),H=a;break}A.call(R,w,new BD(R,{sourceEvent:z,subject:C,target:d,identifier:E,active:H,x:P[0]+D,y:P[1]+B,dx:P[0]-G[0],dy:P[1]-G[1],dispatch:A}),T)}}return d.filter=function(w){return arguments.length?(r=typeof w=="function"?w:KS(!!w),d):r},d.container=function(w){return arguments.length?(e=typeof w=="function"?w:KS(w),d):e},d.subject=function(w){return arguments.length?(n=typeof w=="function"?w:KS(w),d):n},d.touchable=function(w){return arguments.length?(i=typeof w=="function"?w:KS(!!w),d):i},d.on=function(){var w=o.on.apply(o,arguments);return w===o?d:w},d.clickDistance=function(w){return arguments.length?(f=(w=+w)*w,d):Math.sqrt(f)},d}var Rze=v_("start","end","cancel","interrupt"),Nze=[],ite=0,xH=1,UD=2,V1=3,bH=4,zD=5,G1=6;function DA(r,e,n,i,s,o){var a=r.__transition;if(!a)r.__transition={};else if(n in a)return;Oze(r,n,{name:e,index:i,group:s,on:Rze,tween:Nze,time:o.time,delay:o.delay,duration:o.duration,ease:o.ease,timer:null,state:ite})}function cB(r,e){var n=al(r,e);if(n.state>ite)throw new Error("too late; already scheduled");return n}function Wl(r,e){var n=al(r,e);if(n.state>V1)throw new Error("too late; already running");return n}function al(r,e){var n=r.__transition;if(!n||!(n=n[e]))throw new Error("transition not found");return n}function Oze(r,e,n){var i=r.__transition,s;i[e]=n,n.timer=XF(o,0,n.time);function o(u){n.state=xH,n.timer.restart(a,n.delay,n.time),n.delay<=u&&a(u-n.delay)}function a(u){var h,f,d,p;if(n.state!==xH)return c();for(h in i)if(p=i[h],p.name===n.name){if(p.state===V1)return m4(a);p.state===bH?(p.state=G1,p.timer.stop(),p.on.call("interrupt",r,r.__data__,p.index,p.group),delete i[h]):+h<e&&(p.state=G1,p.timer.stop(),p.on.call("cancel",r,r.__data__,p.index,p.group),delete i[h])}if(m4(function(){n.state===V1&&(n.state=bH,n.timer.restart(l,n.delay,n.time),l(u))}),n.state=UD,n.on.call("start",r,r.__data__,n.index,n.group),n.state===UD){for(n.state=V1,s=new Array(d=n.tween.length),h=0,f=-1;h<d;++h)(p=n.tween[h].value.call(r,r.__data__,n.index,n.group))&&(s[++f]=p);s.length=f+1}}function l(u){for(var h=u<n.duration?n.ease.call(null,u/n.duration):(n.timer.restart(c),n.state=zD,1),f=-1,d=s.length;++f<d;)s[f].call(r,h);n.state===zD&&(n.on.call("end",r,r.__data__,n.index,n.group),c())}function c(){n.state=G1,n.timer.stop(),delete i[e];for(var u in i)return;delete r.__transition}}function H1(r,e){var n=r.__transition,i,s,o=!0,a;if(n){e=e==null?null:e+"";for(a in n){if((i=n[a]).name!==e){o=!1;continue}s=i.state>UD&&i.state<zD,i.state=G1,i.timer.stop(),i.on.call(s?"interrupt":"cancel",r,r.__data__,i.index,i.group),delete n[a]}o&&delete r.__transition}}function Dze(r){return this.each(function(){H1(this,r)})}function kze(r,e){var n,i;return function(){var s=Wl(this,r),o=s.tween;if(o!==n){i=n=o;for(var a=0,l=i.length;a<l;++a)if(i[a].name===e){i=i.slice(),i.splice(a,1);break}}s.tween=i}}function Ize(r,e,n){var i,s;if(typeof n!="function")throw new Error;return function(){var o=Wl(this,r),a=o.tween;if(a!==i){s=(i=a).slice();for(var l={name:e,value:n},c=0,u=s.length;c<u;++c)if(s[c].name===e){s[c]=l;break}c===u&&s.push(l)}o.tween=s}}function Lze(r,e){var n=this._id;if(r+="",arguments.length<2){for(var i=al(this.node(),n).tween,s=0,o=i.length,a;s<o;++s)if((a=i[s]).name===r)return a.value;return null}return this.each((e==null?kze:Ize)(n,r,e))}function uB(r,e,n){var i=r._id;return r.each(function(){var s=Wl(this,i);(s.value||(s.value={}))[e]=n.apply(this,arguments)}),function(s){return al(s,i).value[e]}}function ste(r,e){var n;return(typeof e=="number"?$a:e instanceof _d?QT:(n=_d(e))?(e=n,QT):IZ)(r,e)}function Fze(r){return function(){this.removeAttribute(r)}}function Bze(r){return function(){this.removeAttributeNS(r.space,r.local)}}function Uze(r,e,n){var i,s=n+"",o;return function(){var a=this.getAttribute(r);return a===s?null:a===i?o:o=e(i=a,n)}}function zze(r,e,n){var i,s=n+"",o;return function(){var a=this.getAttributeNS(r.space,r.local);return a===s?null:a===i?o:o=e(i=a,n)}}function $ze(r,e,n){var i,s,o;return function(){var a,l=n(this),c;return l==null?void this.removeAttribute(r):(a=this.getAttribute(r),c=l+"",a===c?null:a===i&&c===s?o:(s=c,o=e(i=a,l)))}}function jze(r,e,n){var i,s,o;return function(){var a,l=n(this),c;return l==null?void this.removeAttributeNS(r.space,r.local):(a=this.getAttributeNS(r.space,r.local),c=l+"",a===c?null:a===i&&c===s?o:(s=c,o=e(i=a,l)))}}function Vze(r,e){var n=PA(r),i=n==="transform"?eMe:ste;return this.attrTween(r,typeof e=="function"?(n.local?jze:$ze)(n,i,uB(this,"attr."+r,e)):e==null?(n.local?Bze:Fze)(n):(n.local?zze:Uze)(n,i,e))}function Gze(r,e){return function(n){this.setAttribute(r,e.call(this,n))}}function Hze(r,e){return function(n){this.setAttributeNS(r.space,r.local,e.call(this,n))}}function Wze(r,e){var n,i;function s(){var o=e.apply(this,arguments);return o!==i&&(n=(i=o)&&Hze(r,o)),n}return s._value=e,s}function qze(r,e){var n,i;function s(){var o=e.apply(this,arguments);return o!==i&&(n=(i=o)&&Gze(r,o)),n}return s._value=e,s}function Xze(r,e){var n="attr."+r;if(arguments.length<2)return(n=this.tween(n))&&n._value;if(e==null)return this.tween(n,null);if(typeof e!="function")throw new Error;var i=PA(r);return this.tween(n,(i.local?Wze:qze)(i,e))}function Kze(r,e){return function(){cB(this,r).delay=+e.apply(this,arguments)}}function Yze(r,e){return e=+e,function(){cB(this,r).delay=e}}function Zze(r){var e=this._id;return arguments.length?this.each((typeof r=="function"?Kze:Yze)(e,r)):al(this.node(),e).delay}function Qze(r,e){return function(){Wl(this,r).duration=+e.apply(this,arguments)}}function Jze(r,e){return e=+e,function(){Wl(this,r).duration=e}}function e$e(r){var e=this._id;return arguments.length?this.each((typeof r=="function"?Qze:Jze)(e,r)):al(this.node(),e).duration}function t$e(r,e){if(typeof e!="function")throw new Error;return function(){Wl(this,r).ease=e}}function n$e(r){var e=this._id;return arguments.length?this.each(t$e(e,r)):al(this.node(),e).ease}function r$e(r,e){return function(){var n=e.apply(this,arguments);if(typeof n!="function")throw new Error;Wl(this,r).ease=n}}function i$e(r){if(typeof r!="function")throw new Error;return this.each(r$e(this._id,r))}function s$e(r){typeof r!="function"&&(r=Cee(r));for(var e=this._groups,n=e.length,i=new Array(n),s=0;s<n;++s)for(var o=e[s],a=o.length,l=i[s]=[],c,u=0;u<a;++u)(c=o[u])&&r.call(c,c.__data__,u,o)&&l.push(c);return new fu(i,this._parents,this._name,this._id)}function o$e(r){if(r._id!==this._id)throw new Error;for(var e=this._groups,n=r._groups,i=e.length,s=n.length,o=Math.min(i,s),a=new Array(i),l=0;l<o;++l)for(var c=e[l],u=n[l],h=c.length,f=a[l]=new Array(h),d,p=0;p<h;++p)(d=c[p]||u[p])&&(f[p]=d);for(;l<i;++l)a[l]=e[l];return new fu(a,this._parents,this._name,this._id)}function a$e(r){return(r+"").trim().split(/^|\s+/).every(function(e){var n=e.indexOf(".");return n>=0&&(e=e.slice(0,n)),!e||e==="start"})}function l$e(r,e,n){var i,s,o=a$e(e)?cB:Wl;return function(){var a=o(this,r),l=a.on;l!==i&&(s=(i=l).copy()).on(e,n),a.on=s}}function c$e(r,e){var n=this._id;return arguments.length<2?al(this.node(),n).on.on(r):this.each(l$e(n,r,e))}function u$e(r){return function(){var e=this.parentNode;for(var n in this.__transition)if(+n!==r)return;e&&e.removeChild(this)}}function h$e(){return this.on("end.remove",u$e(this._id))}function f$e(r){var e=this._name,n=this._id;typeof r!="function"&&(r=rB(r));for(var i=this._groups,s=i.length,o=new Array(s),a=0;a<s;++a)for(var l=i[a],c=l.length,u=o[a]=new Array(c),h,f,d=0;d<c;++d)(h=l[d])&&(f=r.call(h,h.__data__,d,l))&&("__data__"in h&&(f.__data__=h.__data__),u[d]=f,DA(u[d],e,n,d,u,al(h,n)));return new fu(o,this._parents,e,n)}function d$e(r){var e=this._name,n=this._id;typeof r!="function"&&(r=Aee(r));for(var i=this._groups,s=i.length,o=[],a=[],l=0;l<s;++l)for(var c=i[l],u=c.length,h,f=0;f<u;++f)if(h=c[f]){for(var d=r.call(h,h.__data__,f,c),p,m=al(h,n),g=0,v=d.length;g<v;++g)(p=d[g])&&DA(p,e,n,g,d,m);o.push(d),a.push(h)}return new fu(o,a,e,n)}var p$e=R_.prototype.constructor;function m$e(){return new p$e(this._groups,this._parents)}function g$e(r,e){var n,i,s;return function(){var o=Cg(this,r),a=(this.style.removeProperty(r),Cg(this,r));return o===a?null:o===n&&a===i?s:s=e(n=o,i=a)}}function ote(r){return function(){this.style.removeProperty(r)}}function y$e(r,e,n){var i,s=n+"",o;return function(){var a=Cg(this,r);return a===s?null:a===i?o:o=e(i=a,n)}}function v$e(r,e,n){var i,s,o;return function(){var a=Cg(this,r),l=n(this),c=l+"";return l==null&&(c=l=(this.style.removeProperty(r),Cg(this,r))),a===c?null:a===i&&c===s?o:(s=c,o=e(i=a,l))}}function x$e(r,e){var n,i,s,o="style."+e,a="end."+o,l;return function(){var c=Wl(this,r),u=c.on,h=c.value[o]==null?l||(l=ote(e)):void 0;(u!==n||s!==h)&&(i=(n=u).copy()).on(a,s=h),c.on=i}}function b$e(r,e,n){var i=(r+="")=="transform"?JEe:ste;return e==null?this.styleTween(r,g$e(r,i)).on("end.style."+r,ote(r)):typeof e=="function"?this.styleTween(r,v$e(r,i,uB(this,"style."+r,e))).each(x$e(this._id,r)):this.styleTween(r,y$e(r,i,e),n).on("end.style."+r,null)}function _$e(r,e,n){return function(i){this.style.setProperty(r,e.call(this,i),n)}}function w$e(r,e,n){var i,s;function o(){var a=e.apply(this,arguments);return a!==s&&(i=(s=a)&&_$e(r,a,n)),i}return o._value=e,o}function S$e(r,e,n){var i="style."+(r+="");if(arguments.length<2)return(i=this.tween(i))&&i._value;if(e==null)return this.tween(i,null);if(typeof e!="function")throw new Error;return this.tween(i,w$e(r,e,n??""))}function T$e(r){return function(){this.textContent=r}}function E$e(r){return function(){var e=r(this);this.textContent=e??""}}function M$e(r){return this.tween("text",typeof r=="function"?E$e(uB(this,"text",r)):T$e(r==null?"":r+""))}function A$e(r){return function(e){this.textContent=r.call(this,e)}}function C$e(r){var e,n;function i(){var s=r.apply(this,arguments);return s!==n&&(e=(n=s)&&A$e(s)),e}return i._value=r,i}function P$e(r){var e="text";if(arguments.length<1)return(e=this.tween(e))&&e._value;if(r==null)return this.tween(e,null);if(typeof r!="function")throw new Error;return this.tween(e,C$e(r))}function R$e(){for(var r=this._name,e=this._id,n=ate(),i=this._groups,s=i.length,o=0;o<s;++o)for(var a=i[o],l=a.length,c,u=0;u<l;++u)if(c=a[u]){var h=al(c,e);DA(c,r,n,u,a,{time:h.time+h.delay+h.duration,delay:0,duration:h.duration,ease:h.ease})}return new fu(i,this._parents,r,n)}function N$e(){var r,e,n=this,i=n._id,s=n.size();return new Promise(function(o,a){var l={value:a},c={value:function(){--s===0&&o()}};n.each(function(){var u=Wl(this,i),h=u.on;h!==r&&(e=(r=h).copy(),e._.cancel.push(l),e._.interrupt.push(l),e._.end.push(c)),u.on=e}),s===0&&o()})}var O$e=0;function fu(r,e,n,i){this._groups=r,this._parents=e,this._name=n,this._id=i}function ate(){return++O$e}var mc=R_.prototype;fu.prototype={constructor:fu,select:f$e,selectAll:d$e,selectChild:mc.selectChild,selectChildren:mc.selectChildren,filter:s$e,merge:o$e,selection:m$e,transition:R$e,call:mc.call,nodes:mc.nodes,node:mc.node,size:mc.size,empty:mc.empty,each:mc.each,on:c$e,attr:Vze,attrTween:Xze,style:b$e,styleTween:S$e,text:M$e,textTween:P$e,remove:h$e,tween:Lze,delay:Zze,duration:e$e,ease:n$e,easeVarying:i$e,end:N$e,[Symbol.iterator]:mc[Symbol.iterator]};function D$e(r){return((r*=2)<=1?r*r*r:(r-=2)*r*r+2)/2}var k$e={time:null,delay:0,duration:250,ease:D$e};function I$e(r,e){for(var n;!(n=r.__transition)||!(n=n[e]);)if(!(r=r.parentNode))throw new Error(`transition ${e} not found`);return n}function L$e(r){var e,n;r instanceof fu?(e=r._id,r=r._name):(e=ate(),(n=k$e).time=qF(),r=r==null?null:r+"");for(var i=this._groups,s=i.length,o=0;o<s;++o)for(var a=i[o],l=a.length,c,u=0;u<l;++u)(c=a[u])&&DA(c,r,e,u,a,n||I$e(c,e));return new fu(i,this._parents,r,e)}R_.prototype.interrupt=Dze;R_.prototype.transition=L$e;const YS=r=>()=>r;function F$e(r,{sourceEvent:e,target:n,transform:i,dispatch:s}){Object.defineProperties(this,{type:{value:r,enumerable:!0,configurable:!0},sourceEvent:{value:e,enumerable:!0,configurable:!0},target:{value:n,enumerable:!0,configurable:!0},transform:{value:i,enumerable:!0,configurable:!0},_:{value:s}})}function Uc(r,e,n){this.k=r,this.x=e,this.y=n}Uc.prototype={constructor:Uc,scale:function(r){return r===1?this:new Uc(this.k*r,this.x,this.y)},translate:function(r,e){return r===0&e===0?this:new Uc(this.k,this.x+this.k*r,this.y+this.k*e)},apply:function(r){return[r[0]*this.k+this.x,r[1]*this.k+this.y]},applyX:function(r){return r*this.k+this.x},applyY:function(r){return r*this.k+this.y},invert:function(r){return[(r[0]-this.x)/this.k,(r[1]-this.y)/this.k]},invertX:function(r){return(r-this.x)/this.k},invertY:function(r){return(r-this.y)/this.k},rescaleX:function(r){return r.copy().domain(r.range().map(this.invertX,this).map(r.invert,r))},rescaleY:function(r){return r.copy().domain(r.range().map(this.invertY,this).map(r.invert,r))},toString:function(){return"translate("+this.x+","+this.y+") scale("+this.k+")"}};var hB=new Uc(1,0,0);gl.prototype=Uc.prototype;function gl(r){for(;!r.__zoom;)if(!(r=r.parentNode))return hB;return r.__zoom}function $N(r){r.stopImmediatePropagation()}function Bv(r){r.preventDefault(),r.stopImmediatePropagation()}function B$e(r){return(!r.ctrlKey||r.type==="wheel")&&!r.button}function U$e(){var r=this;return r instanceof SVGElement?(r=r.ownerSVGElement||r,r.hasAttribute("viewBox")?(r=r.viewBox.baseVal,[[r.x,r.y],[r.x+r.width,r.y+r.height]]):[[0,0],[r.width.baseVal.value,r.height.baseVal.value]]):[[0,0],[r.clientWidth,r.clientHeight]]}function _H(){return this.__zoom||hB}function z$e(r){return-r.deltaY*(r.deltaMode===1?.05:r.deltaMode?1:.002)*(r.ctrlKey?10:1)}function $$e(){return navigator.maxTouchPoints||"ontouchstart"in this}function j$e(r,e,n){var i=r.invertX(e[0][0])-n[0][0],s=r.invertX(e[1][0])-n[1][0],o=r.invertY(e[0][1])-n[0][1],a=r.invertY(e[1][1])-n[1][1];return r.translate(s>i?(i+s)/2:Math.min(0,i)||Math.max(0,s),a>o?(o+a)/2:Math.min(0,o)||Math.max(0,a))}function V$e(){var r=B$e,e=U$e,n=j$e,i=z$e,s=$$e,o=[0,1/0],a=[[-1/0,-1/0],[1/0,1/0]],l=250,c=iMe,u=v_("start","zoom","end"),h,f,d,p=500,m=150,g=0,v=10;function y(C){C.property("__zoom",_H).on("wheel.zoom",E,{passive:!1}).on("mousedown.zoom",M).on("dblclick.zoom",A).filter(s).on("touchstart.zoom",P).on("touchmove.zoom",D).on("touchend.zoom touchcancel.zoom",B).style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}y.transform=function(C,O,R,z){var U=C.selection?C.selection():C;U.property("__zoom",_H),C!==U?_(C,O,R,z):U.interrupt().each(function(){S(this,arguments).event(z).start().zoom(null,typeof O=="function"?O.apply(this,arguments):O).end()})},y.scaleBy=function(C,O,R,z){y.scaleTo(C,function(){var U=this.__zoom.k,G=typeof O=="function"?O.apply(this,arguments):O;return U*G},R,z)},y.scaleTo=function(C,O,R,z){y.transform(C,function(){var U=e.apply(this,arguments),G=this.__zoom,H=R==null?w(U):typeof R=="function"?R.apply(this,arguments):R,Y=G.invert(H),ee=typeof O=="function"?O.apply(this,arguments):O;return n(b(x(G,ee),H,Y),U,a)},R,z)},y.translateBy=function(C,O,R,z){y.transform(C,function(){return n(this.__zoom.translate(typeof O=="function"?O.apply(this,arguments):O,typeof R=="function"?R.apply(this,arguments):R),e.apply(this,arguments),a)},null,z)},y.translateTo=function(C,O,R,z,U){y.transform(C,function(){var G=e.apply(this,arguments),H=this.__zoom,Y=z==null?w(G):typeof z=="function"?z.apply(this,arguments):z;return n(hB.translate(Y[0],Y[1]).scale(H.k).translate(typeof O=="function"?-O.apply(this,arguments):-O,typeof R=="function"?-R.apply(this,arguments):-R),G,a)},z,U)};function x(C,O){return O=Math.max(o[0],Math.min(o[1],O)),O===C.k?C:new Uc(O,C.x,C.y)}function b(C,O,R){var z=O[0]-R[0]*C.k,U=O[1]-R[1]*C.k;return z===C.x&&U===C.y?C:new Uc(C.k,z,U)}function w(C){return[(+C[0][0]+ +C[1][0])/2,(+C[0][1]+ +C[1][1])/2]}function _(C,O,R,z){C.on("start.zoom",function(){S(this,arguments).event(z).start()}).on("interrupt.zoom end.zoom",function(){S(this,arguments).event(z).end()}).tween("zoom",function(){var U=this,G=arguments,H=S(U,G).event(z),Y=e.apply(U,G),ee=R==null?w(Y):typeof R=="function"?R.apply(U,G):R,he=Math.max(Y[1][0]-Y[0][0],Y[1][1]-Y[0][1]),q=U.__zoom,J=typeof O=="function"?O.apply(U,G):O,se=c(q.invert(ee).concat(he/q.k),J.invert(ee).concat(he/J.k));return function(oe){if(oe===1)oe=J;else{var Ee=se(oe),ye=he/Ee[2];oe=new Uc(ye,ee[0]-Ee[0]*ye,ee[1]-Ee[1]*ye)}H.zoom(null,oe)}})}function S(C,O,R){return!R&&C.__zooming||new T(C,O)}function T(C,O){this.that=C,this.args=O,this.active=0,this.sourceEvent=null,this.extent=e.apply(C,O),this.taps=0}T.prototype={event:function(C){return C&&(this.sourceEvent=C),this},start:function(){return++this.active===1&&(this.that.__zooming=this,this.emit("start")),this},zoom:function(C,O){return this.mouse&&C!=="mouse"&&(this.mouse[1]=O.invert(this.mouse[0])),this.touch0&&C!=="touch"&&(this.touch0[1]=O.invert(this.touch0[0])),this.touch1&&C!=="touch"&&(this.touch1[1]=O.invert(this.touch1[0])),this.that.__zoom=O,this.emit("zoom"),this},end:function(){return--this.active===0&&(delete this.that.__zooming,this.emit("end")),this},emit:function(C){var O=na(this.that).datum();u.call(C,this.that,new F$e(C,{sourceEvent:this.sourceEvent,target:y,type:C,transform:this.that.__zoom,dispatch:u}),O)}};function E(C,...O){if(!r.apply(this,arguments))return;var R=S(this,O).event(C),z=this.__zoom,U=Math.max(o[0],Math.min(o[1],z.k*Math.pow(2,i.apply(this,arguments)))),G=vl(C);if(R.wheel)(R.mouse[0][0]!==G[0]||R.mouse[0][1]!==G[1])&&(R.mouse[1]=z.invert(R.mouse[0]=G)),clearTimeout(R.wheel);else{if(z.k===U)return;R.mouse=[G,z.invert(G)],H1(this),R.start()}Bv(C),R.wheel=setTimeout(H,m),R.zoom("mouse",n(b(x(z,U),R.mouse[0],R.mouse[1]),R.extent,a));function H(){R.wheel=null,R.end()}}function M(C,...O){if(d||!r.apply(this,arguments))return;var R=C.currentTarget,z=S(this,O,!0).event(C),U=na(C.view).on("mousemove.zoom",ee,!0).on("mouseup.zoom",he,!0),G=vl(C,R),H=C.clientX,Y=C.clientY;nte(C.view),$N(C),z.mouse=[G,this.__zoom.invert(G)],H1(this),z.start();function ee(q){if(Bv(q),!z.moved){var J=q.clientX-H,se=q.clientY-Y;z.moved=J*J+se*se>g}z.event(q).zoom("mouse",n(b(z.that.__zoom,z.mouse[0]=vl(q,R),z.mouse[1]),z.extent,a))}function he(q){U.on("mousemove.zoom mouseup.zoom",null),rte(q.view,z.moved),Bv(q),z.event(q).end()}}function A(C,...O){if(r.apply(this,arguments)){var R=this.__zoom,z=vl(C.changedTouches?C.changedTouches[0]:C,this),U=R.invert(z),G=R.k*(C.shiftKey?.5:2),H=n(b(x(R,G),z,U),e.apply(this,O),a);Bv(C),l>0?na(this).transition().duration(l).call(_,H,z,C):na(this).call(y.transform,H,z,C)}}function P(C,...O){if(r.apply(this,arguments)){var R=C.touches,z=R.length,U=S(this,O,C.changedTouches.length===z).event(C),G,H,Y,ee;for($N(C),H=0;H<z;++H)Y=R[H],ee=vl(Y,this),ee=[ee,this.__zoom.invert(ee),Y.identifier],U.touch0?!U.touch1&&U.touch0[2]!==ee[2]&&(U.touch1=ee,U.taps=0):(U.touch0=ee,G=!0,U.taps=1+!!h);h&&(h=clearTimeout(h)),G&&(U.taps<2&&(f=ee[0],h=setTimeout(function(){h=null},p)),H1(this),U.start())}}function D(C,...O){if(this.__zooming){var R=S(this,O).event(C),z=C.changedTouches,U=z.length,G,H,Y,ee;for(Bv(C),G=0;G<U;++G)H=z[G],Y=vl(H,this),R.touch0&&R.touch0[2]===H.identifier?R.touch0[0]=Y:R.touch1&&R.touch1[2]===H.identifier&&(R.touch1[0]=Y);if(H=R.that.__zoom,R.touch1){var he=R.touch0[0],q=R.touch0[1],J=R.touch1[0],se=R.touch1[1],oe=(oe=J[0]-he[0])*oe+(oe=J[1]-he[1])*oe,Ee=(Ee=se[0]-q[0])*Ee+(Ee=se[1]-q[1])*Ee;H=x(H,Math.sqrt(oe/Ee)),Y=[(he[0]+J[0])/2,(he[1]+J[1])/2],ee=[(q[0]+se[0])/2,(q[1]+se[1])/2]}else if(R.touch0)Y=R.touch0[0],ee=R.touch0[1];else return;R.zoom("touch",n(b(H,Y,ee),R.extent,a))}}function B(C,...O){if(this.__zooming){var R=S(this,O).event(C),z=C.changedTouches,U=z.length,G,H;for($N(C),d&&clearTimeout(d),d=setTimeout(function(){d=null},p),G=0;G<U;++G)H=z[G],R.touch0&&R.touch0[2]===H.identifier?delete R.touch0:R.touch1&&R.touch1[2]===H.identifier&&delete R.touch1;if(R.touch1&&!R.touch0&&(R.touch0=R.touch1,delete R.touch1),R.touch0)R.touch0[1]=this.__zoom.invert(R.touch0[0]);else if(R.end(),R.taps===2&&(H=vl(H,this),Math.hypot(f[0]-H[0],f[1]-H[1])<v)){var Y=na(this).on("dblclick.zoom");Y&&Y.apply(this,arguments)}}}return y.wheelDelta=function(C){return arguments.length?(i=typeof C=="function"?C:YS(+C),y):i},y.filter=function(C){return arguments.length?(r=typeof C=="function"?C:YS(!!C),y):r},y.touchable=function(C){return arguments.length?(s=typeof C=="function"?C:YS(!!C),y):s},y.extent=function(C){return arguments.length?(e=typeof C=="function"?C:YS([[+C[0][0],+C[0][1]],[+C[1][0],+C[1][1]]]),y):e},y.scaleExtent=function(C){return arguments.length?(o[0]=+C[0],o[1]=+C[1],y):[o[0],o[1]]},y.translateExtent=function(C){return arguments.length?(a[0][0]=+C[0][0],a[1][0]=+C[1][0],a[0][1]=+C[0][1],a[1][1]=+C[1][1],y):[[a[0][0],a[0][1]],[a[1][0],a[1][1]]]},y.constrain=function(C){return arguments.length?(n=C,y):n},y.duration=function(C){return arguments.length?(l=+C,y):l},y.interpolate=function(C){return arguments.length?(c=C,y):c},y.on=function(){var C=u.on.apply(u,arguments);return C===u?y:C},y.clickDistance=function(C){return arguments.length?(g=(C=+C)*C,y):Math.sqrt(g)},y.tapDistance=function(C){return arguments.length?(v=+C,y):v},y}var G$e="Expected a function";function H$e(r,e,n){var i=!0,s=!0;if(typeof r!="function")throw new TypeError(G$e);return qT(n)&&(i="leading"in n?!!n.leading:i,s="trailing"in n?!!n.trailing:s),EZ(r,e,{leading:i,maxWait:e,trailing:s})}function $D(r,e){(e==null||e>r.length)&&(e=r.length);for(var n=0,i=Array(e);n<e;n++)i[n]=r[n];return i}function W$e(r){if(Array.isArray(r))return $D(r)}function lte(r,e,n){if(typeof r=="function"?r===e:r.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}function q$e(r,e){if(e.has(r))throw new TypeError("Cannot initialize the same private elements twice on an object")}function X$e(r,e){if(!(r instanceof e))throw new TypeError("Cannot call a class as a function")}function Go(r,e){return r.get(lte(r,e))}function wH(r,e,n){q$e(r,e),e.set(r,n)}function SH(r,e,n){return r.set(lte(r,e),n),n}function K$e(r,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(r,tje(i.key),i)}}function Y$e(r,e,n){return e&&K$e(r.prototype,e),Object.defineProperty(r,"prototype",{writable:!1}),r}function Z$e(r){if(typeof Symbol<"u"&&r[Symbol.iterator]!=null||r["@@iterator"]!=null)return Array.from(r)}function Q$e(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function J$e(r){return W$e(r)||Z$e(r)||nje(r)||Q$e()}function eje(r,e){if(typeof r!="object"||!r)return r;var n=r[Symbol.toPrimitive];if(n!==void 0){var i=n.call(r,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(r)}function tje(r){var e=eje(r,"string");return typeof e=="symbol"?e:e+""}function nje(r,e){if(r){if(typeof r=="string")return $D(r,e);var n={}.toString.call(r).slice(8,-1);return n==="Object"&&r.constructor&&(n=r.constructor.name),n==="Map"||n==="Set"?Array.from(r):n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?$D(r,e):void 0}}var rje=123,ije=function(e){return"#".concat(Math.min(e,Math.pow(2,24)).toString(16).padStart(6,"0"))},cte=function(e,n,i){return(e<<16)+(n<<8)+i},sje=function(e){var n=mt(e).toRgb(),i=n.r,s=n.g,o=n.b;return cte(i,s,o)},TH=function(e,n){return e*rje%Math.pow(2,n)},gf=new WeakMap,gc=new WeakMap,oje=function(){function r(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:6;X$e(this,r),wH(this,gf,void 0),wH(this,gc,void 0),SH(gc,this,e),this.reset()}return Y$e(r,[{key:"reset",value:function(){SH(gf,this,["__reserved for background__"])}},{key:"register",value:function(n){if(Go(gf,this).length>=Math.pow(2,24-Go(gc,this)))return null;var i=Go(gf,this).length,s=TH(i,Go(gc,this)),o=ije(i+(s<<24-Go(gc,this)));return Go(gf,this).push(n),o}},{key:"lookup",value:function(n){if(!n)return null;var i=typeof n=="string"?sje(n):cte.apply(void 0,J$e(n));if(!i)return null;var s=i&Math.pow(2,24-Go(gc,this))-1,o=i>>24-Go(gc,this)&Math.pow(2,Go(gc,this))-1;return TH(s,Go(gc,this))!==o||s>=Go(gf,this).length?null:Go(gf,this)[s]}}])}();const{abs:Uv,cos:yc,sin:Op,acos:aje,atan2:zv,sqrt:Gu,pow:Ko}=Math;function $v(r){return r<0?-Ko(-r,1/3):Ko(r,1/3)}const ute=Math.PI,ZS=2*ute,Hu=ute/2,lje=1e-6,jN=Number.MAX_SAFE_INTEGER||9007199254740991,VN=Number.MIN_SAFE_INTEGER||-9007199254740991,cje={x:0,y:0,z:0},$e={Tvalues:[-.06405689286260563,.06405689286260563,-.1911188674736163,.1911188674736163,-.3150426796961634,.3150426796961634,-.4337935076260451,.4337935076260451,-.5454214713888396,.5454214713888396,-.6480936519369755,.6480936519369755,-.7401241915785544,.7401241915785544,-.820001985973903,.820001985973903,-.8864155270044011,.8864155270044011,-.9382745520027328,.9382745520027328,-.9747285559713095,.9747285559713095,-.9951872199970213,.9951872199970213],Cvalues:[.12793819534675216,.12793819534675216,.1258374563468283,.1258374563468283,.12167047292780339,.12167047292780339,.1155056680537256,.1155056680537256,.10744427011596563,.10744427011596563,.09761865210411388,.09761865210411388,.08619016153195327,.08619016153195327,.0733464814110803,.0733464814110803,.05929858491543678,.05929858491543678,.04427743881741981,.04427743881741981,.028531388628933663,.028531388628933663,.0123412297999872,.0123412297999872],arcfn:function(r,e){const n=e(r);let i=n.x*n.x+n.y*n.y;return typeof n.z<"u"&&(i+=n.z*n.z),Gu(i)},compute:function(r,e,n){if(r===0)return e[0].t=0,e[0];const i=e.length-1;if(r===1)return e[i].t=1,e[i];const s=1-r;let o=e;if(i===0)return e[0].t=r,e[0];if(i===1){const l={x:s*o[0].x+r*o[1].x,y:s*o[0].y+r*o[1].y,t:r};return n&&(l.z=s*o[0].z+r*o[1].z),l}if(i<4){let l=s*s,c=r*r,u,h,f,d=0;i===2?(o=[o[0],o[1],o[2],cje],u=l,h=s*r*2,f=c):i===3&&(u=l*s,h=l*r*3,f=s*c*3,d=r*c);const p={x:u*o[0].x+h*o[1].x+f*o[2].x+d*o[3].x,y:u*o[0].y+h*o[1].y+f*o[2].y+d*o[3].y,t:r};return n&&(p.z=u*o[0].z+h*o[1].z+f*o[2].z+d*o[3].z),p}const a=JSON.parse(JSON.stringify(e));for(;a.length>1;){for(let l=0;l<a.length-1;l++)a[l]={x:a[l].x+(a[l+1].x-a[l].x)*r,y:a[l].y+(a[l+1].y-a[l].y)*r},typeof a[l].z<"u"&&(a[l].z=a[l].z+(a[l+1].z-a[l].z)*r);a.splice(a.length-1,1)}return a[0].t=r,a[0]},computeWithRatios:function(r,e,n,i){const s=1-r,o=n,a=e;let l=o[0],c=o[1],u=o[2],h=o[3],f;if(l*=s,c*=r,a.length===2)return f=l+c,{x:(l*a[0].x+c*a[1].x)/f,y:(l*a[0].y+c*a[1].y)/f,z:i?(l*a[0].z+c*a[1].z)/f:!1,t:r};if(l*=s,c*=2*s,u*=r*r,a.length===3)return f=l+c+u,{x:(l*a[0].x+c*a[1].x+u*a[2].x)/f,y:(l*a[0].y+c*a[1].y+u*a[2].y)/f,z:i?(l*a[0].z+c*a[1].z+u*a[2].z)/f:!1,t:r};if(l*=s,c*=1.5*s,u*=3*s,h*=r*r*r,a.length===4)return f=l+c+u+h,{x:(l*a[0].x+c*a[1].x+u*a[2].x+h*a[3].x)/f,y:(l*a[0].y+c*a[1].y+u*a[2].y+h*a[3].y)/f,z:i?(l*a[0].z+c*a[1].z+u*a[2].z+h*a[3].z)/f:!1,t:r}},derive:function(r,e){const n=[];for(let i=r,s=i.length,o=s-1;s>1;s--,o--){const a=[];for(let l=0,c;l<o;l++)c={x:o*(i[l+1].x-i[l].x),y:o*(i[l+1].y-i[l].y)},e&&(c.z=o*(i[l+1].z-i[l].z)),a.push(c);n.push(a),i=a}return n},between:function(r,e,n){return e<=r&&r<=n||$e.approximately(r,e)||$e.approximately(r,n)},approximately:function(r,e,n){return Uv(r-e)<=(n||lje)},length:function(r){const n=$e.Tvalues.length;let i=0;for(let s=0,o;s<n;s++)o=.5*$e.Tvalues[s]+.5,i+=$e.Cvalues[s]*$e.arcfn(o,r);return .5*i},map:function(r,e,n,i,s){const o=n-e,a=s-i,l=r-e,c=l/o;return i+a*c},lerp:function(r,e,n){const i={x:e.x+r*(n.x-e.x),y:e.y+r*(n.y-e.y)};return e.z!==void 0&&n.z!==void 0&&(i.z=e.z+r*(n.z-e.z)),i},pointToString:function(r){let e=r.x+"/"+r.y;return typeof r.z<"u"&&(e+="/"+r.z),e},pointsToString:function(r){return"["+r.map($e.pointToString).join(", ")+"]"},copy:function(r){return JSON.parse(JSON.stringify(r))},angle:function(r,e,n){const i=e.x-r.x,s=e.y-r.y,o=n.x-r.x,a=n.y-r.y,l=i*a-s*o,c=i*o+s*a;return zv(l,c)},round:function(r,e){const n=""+r,i=n.indexOf(".");return parseFloat(n.substring(0,i+1+e))},dist:function(r,e){const n=r.x-e.x,i=r.y-e.y;return Gu(n*n+i*i)},closest:function(r,e){let n=Ko(2,63),i,s;return r.forEach(function(o,a){s=$e.dist(e,o),s<n&&(n=s,i=a)}),{mdist:n,mpos:i}},abcratio:function(r,e){if(e!==2&&e!==3)return!1;if(typeof r>"u")r=.5;else if(r===0||r===1)return r;const n=Ko(r,e)+Ko(1-r,e),i=n-1;return Uv(i/n)},projectionratio:function(r,e){if(e!==2&&e!==3)return!1;if(typeof r>"u")r=.5;else if(r===0||r===1)return r;const n=Ko(1-r,e),i=Ko(r,e)+n;return n/i},lli8:function(r,e,n,i,s,o,a,l){const c=(r*i-e*n)*(s-a)-(r-n)*(s*l-o*a),u=(r*i-e*n)*(o-l)-(e-i)*(s*l-o*a),h=(r-n)*(o-l)-(e-i)*(s-a);return h==0?!1:{x:c/h,y:u/h}},lli4:function(r,e,n,i){const s=r.x,o=r.y,a=e.x,l=e.y,c=n.x,u=n.y,h=i.x,f=i.y;return $e.lli8(s,o,a,l,c,u,h,f)},lli:function(r,e){return $e.lli4(r,r.c,e,e.c)},makeline:function(r,e){return new qn(r.x,r.y,(r.x+e.x)/2,(r.y+e.y)/2,e.x,e.y)},findbbox:function(r){let e=jN,n=jN,i=VN,s=VN;return r.forEach(function(o){const a=o.bbox();e>a.x.min&&(e=a.x.min),n>a.y.min&&(n=a.y.min),i<a.x.max&&(i=a.x.max),s<a.y.max&&(s=a.y.max)}),{x:{min:e,mid:(e+i)/2,max:i,size:i-e},y:{min:n,mid:(n+s)/2,max:s,size:s-n}}},shapeintersections:function(r,e,n,i,s){if(!$e.bboxoverlap(e,i))return[];const o=[],a=[r.startcap,r.forward,r.back,r.endcap],l=[n.startcap,n.forward,n.back,n.endcap];return a.forEach(function(c){c.virtual||l.forEach(function(u){if(u.virtual)return;const h=c.intersects(u,s);h.length>0&&(h.c1=c,h.c2=u,h.s1=r,h.s2=n,o.push(h))})}),o},makeshape:function(r,e,n){const i=e.points.length,s=r.points.length,o=$e.makeline(e.points[i-1],r.points[0]),a=$e.makeline(r.points[s-1],e.points[0]),l={startcap:o,forward:r,back:e,endcap:a,bbox:$e.findbbox([o,r,e,a])};return l.intersections=function(c){return $e.shapeintersections(l,l.bbox,c,c.bbox,n)},l},getminmax:function(r,e,n){if(!n)return{min:0,max:0};let i=jN,s=VN,o,a;n.indexOf(0)===-1&&(n=[0].concat(n)),n.indexOf(1)===-1&&n.push(1);for(let l=0,c=n.length;l<c;l++)o=n[l],a=r.get(o),a[e]<i&&(i=a[e]),a[e]>s&&(s=a[e]);return{min:i,mid:(i+s)/2,max:s,size:s-i}},align:function(r,e){const n=e.p1.x,i=e.p1.y,s=-zv(e.p2.y-i,e.p2.x-n),o=function(a){return{x:(a.x-n)*yc(s)-(a.y-i)*Op(s),y:(a.x-n)*Op(s)+(a.y-i)*yc(s)}};return r.map(o)},roots:function(r,e){e=e||{p1:{x:0,y:0},p2:{x:1,y:0}};const n=r.length-1,i=$e.align(r,e),s=function(T){return 0<=T&&T<=1};if(n===2){const T=i[0].y,E=i[1].y,M=i[2].y,A=T-2*E+M;if(A!==0){const P=-Gu(E*E-T*M),D=-T+E,B=-(P+D)/A,C=-(-P+D)/A;return[B,C].filter(s)}else if(E!==M&&A===0)return[(2*E-M)/(2*E-2*M)].filter(s);return[]}const o=i[0].y,a=i[1].y,l=i[2].y,c=i[3].y;let u=-o+3*a-3*l+c,h=3*o-6*a+3*l,f=-3*o+3*a,d=o;if($e.approximately(u,0)){if($e.approximately(h,0))return $e.approximately(f,0)?[]:[-d/f].filter(s);const T=Gu(f*f-4*h*d),E=2*h;return[(T-f)/E,(-f-T)/E].filter(s)}h/=u,f/=u,d/=u;const p=(3*f-h*h)/3,m=p/3,g=(2*h*h*h-9*h*f+27*d)/27,v=g/2,y=v*v+m*m*m;let x,b,w,_,S;if(y<0){const T=-p/3,E=T*T*T,M=Gu(E),A=-g/(2*M),P=A<-1?-1:A>1?1:A,D=aje(P),B=$v(M),C=2*B;return w=C*yc(D/3)-h/3,_=C*yc((D+ZS)/3)-h/3,S=C*yc((D+2*ZS)/3)-h/3,[w,_,S].filter(s)}else{if(y===0)return x=v<0?$v(-v):-$v(v),w=2*x-h/3,_=-x-h/3,[w,_].filter(s);{const T=Gu(y);return x=$v(-v+T),b=$v(v+T),[x-b-h/3].filter(s)}}},droots:function(r){if(r.length===3){const e=r[0],n=r[1],i=r[2],s=e-2*n+i;if(s!==0){const o=-Gu(n*n-e*i),a=-e+n,l=-(o+a)/s,c=-(-o+a)/s;return[l,c]}else if(n!==i&&s===0)return[(2*n-i)/(2*(n-i))];return[]}if(r.length===2){const e=r[0],n=r[1];return e!==n?[e/(e-n)]:[]}return[]},curvature:function(r,e,n,i,s){let o,a,l,c,u=0,h=0;const f=$e.compute(r,e),d=$e.compute(r,n),p=f.x*f.x+f.y*f.y;if(i?(o=Gu(Ko(f.y*d.z-d.y*f.z,2)+Ko(f.z*d.x-d.z*f.x,2)+Ko(f.x*d.y-d.x*f.y,2)),a=Ko(p+f.z*f.z,3/2)):(o=f.x*d.y-f.y*d.x,a=Ko(p,3/2)),o===0||a===0)return{k:0,r:0};if(u=o/a,h=a/o,!s){const m=$e.curvature(r-.001,e,n,i,!0).k,g=$e.curvature(r+.001,e,n,i,!0).k;c=(g-u+(u-m))/2,l=(Uv(g-u)+Uv(u-m))/2}return{k:u,r:h,dk:c,adk:l}},inflections:function(r){if(r.length<4)return[];const e=$e.align(r,{p1:r[0],p2:r.slice(-1)[0]}),n=e[2].x*e[1].y,i=e[3].x*e[1].y,s=e[1].x*e[2].y,o=e[3].x*e[2].y,a=18*(-3*n+2*i+3*s-o),l=18*(3*n-i-3*s),c=18*(s-n);if($e.approximately(a,0)){if(!$e.approximately(l,0)){let d=-c/l;if(0<=d&&d<=1)return[d]}return[]}const u=2*a;if($e.approximately(u,0))return[];const h=l*l-4*a*c;if(h<0)return[];const f=Math.sqrt(h);return[(f-l)/u,-(l+f)/u].filter(function(d){return 0<=d&&d<=1})},bboxoverlap:function(r,e){const n=["x","y"],i=n.length;for(let s=0,o,a,l,c;s<i;s++)if(o=n[s],a=r[o].mid,l=e[o].mid,c=(r[o].size+e[o].size)/2,Uv(a-l)>=c)return!1;return!0},expandbox:function(r,e){e.x.min<r.x.min&&(r.x.min=e.x.min),e.y.min<r.y.min&&(r.y.min=e.y.min),e.z&&e.z.min<r.z.min&&(r.z.min=e.z.min),e.x.max>r.x.max&&(r.x.max=e.x.max),e.y.max>r.y.max&&(r.y.max=e.y.max),e.z&&e.z.max>r.z.max&&(r.z.max=e.z.max),r.x.mid=(r.x.min+r.x.max)/2,r.y.mid=(r.y.min+r.y.max)/2,r.z&&(r.z.mid=(r.z.min+r.z.max)/2),r.x.size=r.x.max-r.x.min,r.y.size=r.y.max-r.y.min,r.z&&(r.z.size=r.z.max-r.z.min)},pairiteration:function(r,e,n){const i=r.bbox(),s=e.bbox(),o=1e5,a=n||.5;if(i.x.size+i.y.size<a&&s.x.size+s.y.size<a)return[(o*(r._t1+r._t2)/2|0)/o+"/"+(o*(e._t1+e._t2)/2|0)/o];let l=r.split(.5),c=e.split(.5),u=[{left:l.left,right:c.left},{left:l.left,right:c.right},{left:l.right,right:c.right},{left:l.right,right:c.left}];u=u.filter(function(f){return $e.bboxoverlap(f.left.bbox(),f.right.bbox())});let h=[];return u.length===0||(u.forEach(function(f){h=h.concat($e.pairiteration(f.left,f.right,a))}),h=h.filter(function(f,d){return h.indexOf(f)===d})),h},getccenter:function(r,e,n){const i=e.x-r.x,s=e.y-r.y,o=n.x-e.x,a=n.y-e.y,l=i*yc(Hu)-s*Op(Hu),c=i*Op(Hu)+s*yc(Hu),u=o*yc(Hu)-a*Op(Hu),h=o*Op(Hu)+a*yc(Hu),f=(r.x+e.x)/2,d=(r.y+e.y)/2,p=(e.x+n.x)/2,m=(e.y+n.y)/2,g=f+l,v=d+c,y=p+u,x=m+h,b=$e.lli8(f,d,g,v,p,m,y,x),w=$e.dist(b,r);let _=zv(r.y-b.y,r.x-b.x),S=zv(e.y-b.y,e.x-b.x),T=zv(n.y-b.y,n.x-b.x),E;return _<T?((_>S||S>T)&&(_+=ZS),_>T&&(E=T,T=_,_=E)):T<S&&S<_?(E=T,T=_,_=E):T+=ZS,b.s=_,b.e=T,b.r=w,b},numberSort:function(r,e){return r-e}};class W0{constructor(e){this.curves=[],this._3d=!1,e&&(this.curves=e,this._3d=this.curves[0]._3d)}valueOf(){return this.toString()}toString(){return"["+this.curves.map(function(e){return $e.pointsToString(e.points)}).join(", ")+"]"}addCurve(e){this.curves.push(e),this._3d=this._3d||e._3d}length(){return this.curves.map(function(e){return e.length()}).reduce(function(e,n){return e+n})}curve(e){return this.curves[e]}bbox(){const e=this.curves;for(var n=e[0].bbox(),i=1;i<e.length;i++)$e.expandbox(n,e[i].bbox());return n}offset(e){const n=[];return this.curves.forEach(function(i){n.push(...i.offset(e))}),new W0(n)}}const{abs:jv,min:EH,max:MH,cos:uje,sin:hje,acos:fje,sqrt:Vv}=Math,dje=Math.PI;class qn{constructor(e){let n=e&&e.forEach?e:Array.from(arguments).slice(),i=!1;if(typeof n[0]=="object"){i=n.length;const p=[];n.forEach(function(m){["x","y","z"].forEach(function(g){typeof m[g]<"u"&&p.push(m[g])})}),n=p}let s=!1;const o=n.length;if(i){if(i>4){if(arguments.length!==1)throw new Error("Only new Bezier(point[]) is accepted for 4th and higher order curves");s=!0}}else if(o!==6&&o!==8&&o!==9&&o!==12&&arguments.length!==1)throw new Error("Only new Bezier(point[]) is accepted for 4th and higher order curves");const a=this._3d=!s&&(o===9||o===12)||e&&e[0]&&typeof e[0].z<"u",l=this.points=[];for(let p=0,m=a?3:2;p<o;p+=m){var c={x:n[p],y:n[p+1]};a&&(c.z=n[p+2]),l.push(c)}const u=this.order=l.length-1,h=this.dims=["x","y"];a&&h.push("z"),this.dimlen=h.length;const f=$e.align(l,{p1:l[0],p2:l[u]}),d=$e.dist(l[0],l[u]);this._linear=f.reduce((p,m)=>p+jv(m.y),0)<d/50,this._lut=[],this._t1=0,this._t2=1,this.update()}static quadraticFromPoints(e,n,i,s){if(typeof s>"u"&&(s=.5),s===0)return new qn(n,n,i);if(s===1)return new qn(e,n,n);const o=qn.getABC(2,e,n,i,s);return new qn(e,o.A,i)}static cubicFromPoints(e,n,i,s,o){typeof s>"u"&&(s=.5);const a=qn.getABC(3,e,n,i,s);typeof o>"u"&&(o=$e.dist(n,a.C));const l=o*(1-s)/s,c=$e.dist(e,i),u=(i.x-e.x)/c,h=(i.y-e.y)/c,f=o*u,d=o*h,p=l*u,m=l*h,g={x:n.x-f,y:n.y-d},v={x:n.x+p,y:n.y+m},y=a.A,x={x:y.x+(g.x-y.x)/(1-s),y:y.y+(g.y-y.y)/(1-s)},b={x:y.x+(v.x-y.x)/s,y:y.y+(v.y-y.y)/s},w={x:e.x+(x.x-e.x)/s,y:e.y+(x.y-e.y)/s},_={x:i.x+(b.x-i.x)/(1-s),y:i.y+(b.y-i.y)/(1-s)};return new qn(e,w,_,i)}static getUtils(){return $e}getUtils(){return qn.getUtils()}static get PolyBezier(){return W0}valueOf(){return this.toString()}toString(){return $e.pointsToString(this.points)}toSVG(){if(this._3d)return!1;const e=this.points,n=e[0].x,i=e[0].y,s=["M",n,i,this.order===2?"Q":"C"];for(let o=1,a=e.length;o<a;o++)s.push(e[o].x),s.push(e[o].y);return s.join(" ")}setRatios(e){if(e.length!==this.points.length)throw new Error("incorrect number of ratio values");this.ratios=e,this._lut=[]}verify(){const e=this.coordDigest();e!==this._print&&(this._print=e,this.update())}coordDigest(){return this.points.map(function(e,n){return""+n+e.x+e.y+(e.z?e.z:0)}).join("")}update(){this._lut=[],this.dpoints=$e.derive(this.points,this._3d),this.computedirection()}computedirection(){const e=this.points,n=$e.angle(e[0],e[this.order],e[1]);this.clockwise=n>0}length(){return $e.length(this.derivative.bind(this))}static getABC(e=2,n,i,s,o=.5){const a=$e.projectionratio(o,e),l=1-a,c={x:a*n.x+l*s.x,y:a*n.y+l*s.y},u=$e.abcratio(o,e);return{A:{x:i.x+(i.x-c.x)/u,y:i.y+(i.y-c.y)/u},B:i,C:c,S:n,E:s}}getABC(e,n){n=n||this.get(e);let i=this.points[0],s=this.points[this.order];return qn.getABC(this.order,i,n,s,e)}getLUT(e){if(this.verify(),e=e||100,this._lut.length===e+1)return this._lut;this._lut=[],e++,this._lut=[];for(let n=0,i,s;n<e;n++)s=n/(e-1),i=this.compute(s),i.t=s,this._lut.push(i);return this._lut}on(e,n){n=n||5;const i=this.getLUT(),s=[];for(let o=0,a,l=0;o<i.length;o++)a=i[o],$e.dist(a,e)<n&&(s.push(a),l+=o/i.length);return s.length?t/=s.length:!1}project(e){const n=this.getLUT(),i=n.length-1,s=$e.closest(n,e),o=s.mpos,a=(o-1)/i,l=(o+1)/i,c=.1/i;let u=s.mdist,h=a,f=h,d;u+=1;for(let p;h<l+c;h+=c)d=this.compute(h),p=$e.dist(e,d),p<u&&(u=p,f=h);return f=f<0?0:f>1?1:f,d=this.compute(f),d.t=f,d.d=u,d}get(e){return this.compute(e)}point(e){return this.points[e]}compute(e){return this.ratios?$e.computeWithRatios(e,this.points,this.ratios,this._3d):$e.compute(e,this.points,this._3d,this.ratios)}raise(){const e=this.points,n=[e[0]],i=e.length;for(let s=1,o,a;s<i;s++)o=e[s],a=e[s-1],n[s]={x:(i-s)/i*o.x+s/i*a.x,y:(i-s)/i*o.y+s/i*a.y};return n[i]=e[i-1],new qn(n)}derivative(e){return $e.compute(e,this.dpoints[0],this._3d)}dderivative(e){return $e.compute(e,this.dpoints[1],this._3d)}align(){let e=this.points;return new qn($e.align(e,{p1:e[0],p2:e[e.length-1]}))}curvature(e){return $e.curvature(e,this.dpoints[0],this.dpoints[1],this._3d)}inflections(){return $e.inflections(this.points)}normal(e){return this._3d?this.__normal3(e):this.__normal2(e)}__normal2(e){const n=this.derivative(e),i=Vv(n.x*n.x+n.y*n.y);return{t:e,x:-n.y/i,y:n.x/i}}__normal3(e){const n=this.derivative(e),i=this.derivative(e+.01),s=Vv(n.x*n.x+n.y*n.y+n.z*n.z),o=Vv(i.x*i.x+i.y*i.y+i.z*i.z);n.x/=s,n.y/=s,n.z/=s,i.x/=o,i.y/=o,i.z/=o;const a={x:i.y*n.z-i.z*n.y,y:i.z*n.x-i.x*n.z,z:i.x*n.y-i.y*n.x},l=Vv(a.x*a.x+a.y*a.y+a.z*a.z);a.x/=l,a.y/=l,a.z/=l;const c=[a.x*a.x,a.x*a.y-a.z,a.x*a.z+a.y,a.x*a.y+a.z,a.y*a.y,a.y*a.z-a.x,a.x*a.z-a.y,a.y*a.z+a.x,a.z*a.z];return{t:e,x:c[0]*n.x+c[1]*n.y+c[2]*n.z,y:c[3]*n.x+c[4]*n.y+c[5]*n.z,z:c[6]*n.x+c[7]*n.y+c[8]*n.z}}hull(e){let n=this.points,i=[],s=[],o=0;for(s[o++]=n[0],s[o++]=n[1],s[o++]=n[2],this.order===3&&(s[o++]=n[3]);n.length>1;){i=[];for(let a=0,l,c=n.length-1;a<c;a++)l=$e.lerp(e,n[a],n[a+1]),s[o++]=l,i.push(l);n=i}return s}split(e,n){if(e===0&&n)return this.split(n).left;if(n===1)return this.split(e).right;const i=this.hull(e),s={left:this.order===2?new qn([i[0],i[3],i[5]]):new qn([i[0],i[4],i[7],i[9]]),right:this.order===2?new qn([i[5],i[4],i[2]]):new qn([i[9],i[8],i[6],i[3]]),span:i};return s.left._t1=$e.map(0,0,1,this._t1,this._t2),s.left._t2=$e.map(e,0,1,this._t1,this._t2),s.right._t1=$e.map(e,0,1,this._t1,this._t2),s.right._t2=$e.map(1,0,1,this._t1,this._t2),n?(n=$e.map(n,e,1,0,1),s.right.split(n).left):s}extrema(){const e={};let n=[];return this.dims.forEach((function(i){let s=function(a){return a[i]},o=this.dpoints[0].map(s);e[i]=$e.droots(o),this.order===3&&(o=this.dpoints[1].map(s),e[i]=e[i].concat($e.droots(o))),e[i]=e[i].filter(function(a){return a>=0&&a<=1}),n=n.concat(e[i].sort($e.numberSort))}).bind(this)),e.values=n.sort($e.numberSort).filter(function(i,s){return n.indexOf(i)===s}),e}bbox(){const e=this.extrema(),n={};return this.dims.forEach((function(i){n[i]=$e.getminmax(this,i,e[i])}).bind(this)),n}overlaps(e){const n=this.bbox(),i=e.bbox();return $e.bboxoverlap(n,i)}offset(e,n){if(typeof n<"u"){const i=this.get(e),s=this.normal(e),o={c:i,n:s,x:i.x+s.x*n,y:i.y+s.y*n};return this._3d&&(o.z=i.z+s.z*n),o}if(this._linear){const i=this.normal(0),s=this.points.map(function(o){const a={x:o.x+e*i.x,y:o.y+e*i.y};return o.z&&i.z&&(a.z=o.z+e*i.z),a});return[new qn(s)]}return this.reduce().map(function(i){return i._linear?i.offset(e)[0]:i.scale(e)})}simple(){if(this.order===3){const s=$e.angle(this.points[0],this.points[3],this.points[1]),o=$e.angle(this.points[0],this.points[3],this.points[2]);if(s>0&&o<0||s<0&&o>0)return!1}const e=this.normal(0),n=this.normal(1);let i=e.x*n.x+e.y*n.y;return this._3d&&(i+=e.z*n.z),jv(fje(i))<dje/3}reduce(){let e,n=0,i=0,s=.01,o,a=[],l=[],c=this.extrema().values;for(c.indexOf(0)===-1&&(c=[0].concat(c)),c.indexOf(1)===-1&&c.push(1),n=c[0],e=1;e<c.length;e++)i=c[e],o=this.split(n,i),o._t1=n,o._t2=i,a.push(o),n=i;return a.forEach(function(u){for(n=0,i=0;i<=1;)for(i=n+s;i<=1+s;i+=s)if(o=u.split(n,i),!o.simple()){if(i-=s,jv(n-i)<s)return[];o=u.split(n,i),o._t1=$e.map(n,0,1,u._t1,u._t2),o._t2=$e.map(i,0,1,u._t1,u._t2),l.push(o),n=i;break}n<1&&(o=u.split(n,1),o._t1=$e.map(n,0,1,u._t1,u._t2),o._t2=u._t2,l.push(o))}),l}translate(e,n,i){i=typeof i=="number"?i:n;const s=this.order;let o=this.points.map((a,l)=>(1-l/s)*n+l/s*i);return new qn(this.points.map((a,l)=>({x:a.x+e.x*o[l],y:a.y+e.y*o[l]})))}scale(e){const n=this.order;let i=!1;if(typeof e=="function"&&(i=e),i&&n===2)return this.raise().scale(i);const s=this.clockwise,o=this.points;if(this._linear)return this.translate(this.normal(0),i?i(0):e,i?i(1):e);const a=i?i(0):e,l=i?i(1):e,c=[this.offset(0,10),this.offset(1,10)],u=[],h=$e.lli4(c[0],c[0].c,c[1],c[1].c);if(!h)throw new Error("cannot scale this curve. Try reducing it first.");return[0,1].forEach(function(f){const d=u[f*n]=$e.copy(o[f*n]);d.x+=(f?l:a)*c[f].n.x,d.y+=(f?l:a)*c[f].n.y}),i?([0,1].forEach(function(f){if(!(n===2&&f)){var d=o[f+1],p={x:d.x-h.x,y:d.y-h.y},m=i?i((f+1)/n):e;i&&!s&&(m=-m);var g=Vv(p.x*p.x+p.y*p.y);p.x/=g,p.y/=g,u[f+1]={x:d.x+m*p.x,y:d.y+m*p.y}}}),new qn(u)):([0,1].forEach(f=>{if(n===2&&f)return;const d=u[f*n],p=this.derivative(f),m={x:d.x+p.x,y:d.y+p.y};u[f+1]=$e.lli4(d,m,h,o[f+1])}),new qn(u))}outline(e,n,i,s){if(n=n===void 0?e:n,this._linear){const _=this.normal(0),S=this.points[0],T=this.points[this.points.length-1];let E,M,A;i===void 0&&(i=e,s=n),E={x:S.x+_.x*e,y:S.y+_.y*e},A={x:T.x+_.x*i,y:T.y+_.y*i},M={x:(E.x+A.x)/2,y:(E.y+A.y)/2};const P=[E,M,A];E={x:S.x-_.x*n,y:S.y-_.y*n},A={x:T.x-_.x*s,y:T.y-_.y*s},M={x:(E.x+A.x)/2,y:(E.y+A.y)/2};const D=[A,M,E],B=$e.makeline(D[2],P[0]),C=$e.makeline(P[2],D[0]),O=[B,new qn(P),C,new qn(D)];return new W0(O)}const o=this.reduce(),a=o.length,l=[];let c=[],u,h=0,f=this.length();const d=typeof i<"u"&&typeof s<"u";function p(_,S,T,E,M){return function(A){const P=E/T,D=(E+M)/T,B=S-_;return $e.map(A,0,1,_+P*B,_+D*B)}}o.forEach(function(_){const S=_.length();d?(l.push(_.scale(p(e,i,f,h,S))),c.push(_.scale(p(-n,-s,f,h,S)))):(l.push(_.scale(e)),c.push(_.scale(-n))),h+=S}),c=c.map(function(_){return u=_.points,u[3]?_.points=[u[3],u[2],u[1],u[0]]:_.points=[u[2],u[1],u[0]],_}).reverse();const m=l[0].points[0],g=l[a-1].points[l[a-1].points.length-1],v=c[a-1].points[c[a-1].points.length-1],y=c[0].points[0],x=$e.makeline(v,m),b=$e.makeline(g,y),w=[x].concat(l).concat([b]).concat(c);return new W0(w)}outlineshapes(e,n,i){n=n||e;const s=this.outline(e,n).curves,o=[];for(let a=1,l=s.length;a<l/2;a++){const c=$e.makeshape(s[a],s[l-a],i);c.startcap.virtual=a>1,c.endcap.virtual=a<l/2-1,o.push(c)}return o}intersects(e,n){return e?e.p1&&e.p2?this.lineIntersects(e):(e instanceof qn&&(e=e.reduce()),this.curveintersects(this.reduce(),e,n)):this.selfintersects(n)}lineIntersects(e){const n=EH(e.p1.x,e.p2.x),i=EH(e.p1.y,e.p2.y),s=MH(e.p1.x,e.p2.x),o=MH(e.p1.y,e.p2.y);return $e.roots(this.points,e).filter(a=>{var l=this.get(a);return $e.between(l.x,n,s)&&$e.between(l.y,i,o)})}selfintersects(e){const n=this.reduce(),i=n.length-2,s=[];for(let o=0,a,l,c;o<i;o++)l=n.slice(o,o+1),c=n.slice(o+2),a=this.curveintersects(l,c,e),s.push(...a);return s}curveintersects(e,n,i){const s=[];e.forEach(function(a){n.forEach(function(l){a.overlaps(l)&&s.push({left:a,right:l})})});let o=[];return s.forEach(function(a){const l=$e.pairiteration(a.left,a.right,i);l.length>0&&(o=o.concat(l))}),o}arcs(e){return e=e||.5,this._iterate(e,[])}_error(e,n,i,s){const o=(s-i)/4,a=this.get(i+o),l=this.get(s-o),c=$e.dist(e,n),u=$e.dist(e,a),h=$e.dist(e,l);return jv(u-c)+jv(h-c)}_iterate(e,n){let i=0,s=1,o;do{o=0,s=1;let a=this.get(i),l,c,u,h,f=!1,d=!1,p,m=s,g=1;do if(d=f,h=u,m=(i+s)/2,l=this.get(m),c=this.get(s),u=$e.getccenter(a,l,c),u.interval={start:i,end:s},f=this._error(u,a,i,s)<=e,p=d&&!f,p||(g=s),f){if(s>=1){if(u.interval.end=g=1,h=u,s>1){let y={x:u.x+u.r*uje(u.e),y:u.y+u.r*hje(u.e)};u.e+=$e.angle({x:u.x,y:u.y},y,this.get(1))}break}s=s+(s-i)/2}else s=m;while(!p&&o++<100);if(o>=100)break;h=h||u,n.push(h),i=g}while(s<1);return n}}function jD(r,e){(e==null||e>r.length)&&(e=r.length);for(var n=0,i=Array(e);n<e;n++)i[n]=r[n];return i}function pje(r){if(Array.isArray(r))return r}function mje(r){if(Array.isArray(r))return jD(r)}function gje(r){if(typeof Symbol<"u"&&r[Symbol.iterator]!=null||r["@@iterator"]!=null)return Array.from(r)}function yje(r,e){var n=r==null?null:typeof Symbol<"u"&&r[Symbol.iterator]||r["@@iterator"];if(n!=null){var i,s,o,a,l=[],c=!0,u=!1;try{if(o=(n=n.call(r)).next,e!==0)for(;!(c=(i=o.call(n)).done)&&(l.push(i.value),l.length!==e);c=!0);}catch(h){u=!0,s=h}finally{try{if(!c&&n.return!=null&&(a=n.return(),Object(a)!==a))return}finally{if(u)throw s}}return l}}function vje(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function xje(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function bje(r,e){if(r==null)return{};var n,i,s=_je(r,e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(r);for(i=0;i<o.length;i++)n=o[i],e.includes(n)||{}.propertyIsEnumerable.call(r,n)&&(s[n]=r[n])}return s}function _je(r,e){if(r==null)return{};var n={};for(var i in r)if({}.hasOwnProperty.call(r,i)){if(e.includes(i))continue;n[i]=r[i]}return n}function wje(r,e){return pje(r)||yje(r,e)||hte(r,e)||vje()}function Sje(r){return mje(r)||gje(r)||hte(r)||xje()}function Tje(r,e){if(typeof r!="object"||!r)return r;var n=r[Symbol.toPrimitive];if(n!==void 0){var i=n.call(r,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(r)}function Eje(r){var e=Tje(r,"string");return typeof e=="symbol"?e:e+""}function hte(r,e){if(r){if(typeof r=="string")return jD(r,e);var n={}.toString.call(r).slice(8,-1);return n==="Object"&&r.constructor&&(n=r.constructor.name),n==="Map"||n==="Set"?Array.from(r):n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?jD(r,e):void 0}}var Mje=function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1,s=(e instanceof Array?e.length?e:[void 0]:[e]).map(function(l){return{keyAccessor:l,isProp:!(l instanceof Function)}}),o=r.reduce(function(l,c){var u=l,h=c;return s.forEach(function(f,d){var p=f.keyAccessor,m=f.isProp,g;if(m){var v=h,y=v[p],x=bje(v,[p].map(Eje));g=y,h=x}else g=p(h,d);d+1<s.length?(u.hasOwnProperty(g)||(u[g]={}),u=u[g]):n?(u.hasOwnProperty(g)||(u[g]=[]),u[g].push(h)):u[g]=h}),l},{});n instanceof Function&&function l(c){var u=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;u===s.length?Object.keys(c).forEach(function(h){return c[h]=n(c[h])}):Object.values(c).forEach(function(h){return l(h,u+1)})}(o);var a=o;return i&&(a=[],function l(c){var u=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];u.length===s.length?a.push({keys:u,vals:c}):Object.entries(c).forEach(function(h){var f=wje(h,2),d=f[0],p=f[1];return l(p,[].concat(Sje(u),[d]))})}(o),e instanceof Array&&e.length===0&&a.length===1&&(a[0].keys=[])),a};function Aje(r,e){e===void 0&&(e={});var n=e.insertAt;if(!(typeof document>"u")){var i=document.head||document.getElementsByTagName("head")[0],s=document.createElement("style");s.type="text/css",n==="top"&&i.firstChild?i.insertBefore(s,i.firstChild):i.appendChild(s),s.styleSheet?s.styleSheet.cssText=r:s.appendChild(document.createTextNode(r))}}var Cje=`.force-graph-container canvas {
  display: block;
  user-select: none;
  outline: none;
  -webkit-tap-highlight-color: transparent;
}

.force-graph-container .clickable {
  cursor: pointer;
}

.force-graph-container .grabbable {
  cursor: move;
  cursor: grab;
  cursor: -moz-grab;
  cursor: -webkit-grab;
}

.force-graph-container .grabbable:active {
  cursor: grabbing;
  cursor: -moz-grabbing;
  cursor: -webkit-grabbing;
}
`;Aje(Cje);function VD(r,e){(e==null||e>r.length)&&(e=r.length);for(var n=0,i=Array(e);n<e;n++)i[n]=r[n];return i}function Pje(r){if(Array.isArray(r))return r}function Rje(r){if(Array.isArray(r))return VD(r)}function AH(r,e,n){if(fte())return Reflect.construct.apply(null,arguments);var i=[null];i.push.apply(i,e);var s=new(r.bind.apply(r,i));return s}function pb(r,e,n){return(e=Lje(e))in r?Object.defineProperty(r,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):r[e]=n,r}function fte(){try{var r=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(fte=function(){return!!r})()}function Nje(r){if(typeof Symbol<"u"&&r[Symbol.iterator]!=null||r["@@iterator"]!=null)return Array.from(r)}function Oje(r,e){var n=r==null?null:typeof Symbol<"u"&&r[Symbol.iterator]||r["@@iterator"];if(n!=null){var i,s,o,a,l=[],c=!0,u=!1;try{if(o=(n=n.call(r)).next,e!==0)for(;!(c=(i=o.call(n)).done)&&(l.push(i.value),l.length!==e);c=!0);}catch(h){u=!0,s=h}finally{try{if(!c&&n.return!=null&&(a=n.return(),Object(a)!==a))return}finally{if(u)throw s}}return l}}function Dje(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function kje(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function CH(r,e){var n=Object.keys(r);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(r);e&&(i=i.filter(function(s){return Object.getOwnPropertyDescriptor(r,s).enumerable})),n.push.apply(n,i)}return n}function Dp(r){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?CH(Object(n),!0).forEach(function(i){pb(r,i,n[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(n)):CH(Object(n)).forEach(function(i){Object.defineProperty(r,i,Object.getOwnPropertyDescriptor(n,i))})}return r}function q0(r,e){return Pje(r)||Oje(r,e)||dte(r,e)||Dje()}function ra(r){return Rje(r)||Nje(r)||dte(r)||kje()}function Ije(r,e){if(typeof r!="object"||!r)return r;var n=r[Symbol.toPrimitive];if(n!==void 0){var i=n.call(r,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(r)}function Lje(r){var e=Ije(r,"string");return typeof e=="symbol"?e:e+""}function GD(r){"@babel/helpers - typeof";return GD=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},GD(r)}function dte(r,e){if(r){if(typeof r=="string")return VD(r,e);var n={}.toString.call(r).slice(8,-1);return n==="Object"&&r.constructor&&(n=r.constructor.name),n==="Map"||n==="Set"?Array.from(r):n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?VD(r,e):void 0}}var Fje=__(uQ);function PH(r,e,n){!e||typeof n!="string"||r.filter(function(i){return!i[n]}).forEach(function(i){i[n]=Fje(e(i))})}function Bje(r,e){var n=r.nodes,i=r.links,s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},o=s.nodeFilter,a=o===void 0?function(){return!0}:o,l=s.onLoopError,c=l===void 0?function(p){throw"Invalid DAG structure! Found cycle in node path: ".concat(p.join(" -> "),".")}:l,u={};n.forEach(function(p){return u[e(p)]={data:p,out:[],depth:-1,skip:!a(p)}}),i.forEach(function(p){var m=p.source,g=p.target,v=w(m),y=w(g);if(!u.hasOwnProperty(v))throw"Missing source node with id: ".concat(v);if(!u.hasOwnProperty(y))throw"Missing target node with id: ".concat(y);var x=u[v],b=u[y];x.out.push(b);function w(_){return GD(_)==="object"?e(_):_}});var h=[];d(Object.values(u));var f=Object.assign.apply(Object,[{}].concat(ra(Object.entries(u).filter(function(p){var m=q0(p,2),g=m[1];return!g.skip}).map(function(p){var m=q0(p,2),g=m[0],v=m[1];return pb({},g,v.depth)}))));return f;function d(p){for(var m=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],g=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,v=function(){var w=p[y];if(m.indexOf(w)!==-1){var _=[].concat(ra(m.slice(m.indexOf(w))),[w]).map(function(S){return e(S.data)});return h.some(function(S){return S.length===_.length&&S.every(function(T,E){return T===_[E]})})||(h.push(_),c(_)),1}g>w.depth&&(w.depth=g,d(w.out,[].concat(ra(m),[w]),g+(w.skip?0:1)))},y=0,x=p.length;y<x;y++)v()}}var Uje=2,Qi=function(e,n){return n.onNeedsRedraw&&n.onNeedsRedraw()},RH=function(e,n){if(!n.isShadow){var i=ht(n.linkDirectionalParticles);n.graphData.links.forEach(function(s){var o=Math.round(Math.abs(i(s)));o?s.__photons=ra(Array(o)).map(function(){return{}}):delete s.__photons})}},_E=Vh({props:{graphData:{default:{nodes:[],links:[]},onChange:function(e,n){n.engineRunning=!1,RH(e,n)}},dagMode:{onChange:function(e,n){!e&&(n.graphData.nodes||[]).forEach(function(i){return i.fx=i.fy=void 0})}},dagLevelDistance:{},dagNodeFilter:{default:function(e){return!0}},onDagError:{triggerUpdate:!1},nodeRelSize:{default:4,triggerUpdate:!1,onChange:Qi},nodeId:{default:"id"},nodeVal:{default:"val",triggerUpdate:!1,onChange:Qi},nodeColor:{default:"color",triggerUpdate:!1,onChange:Qi},nodeAutoColorBy:{},nodeCanvasObject:{triggerUpdate:!1,onChange:Qi},nodeCanvasObjectMode:{default:function(){return"replace"},triggerUpdate:!1,onChange:Qi},nodeVisibility:{default:!0,triggerUpdate:!1,onChange:Qi},linkSource:{default:"source"},linkTarget:{default:"target"},linkVisibility:{default:!0,triggerUpdate:!1,onChange:Qi},linkColor:{default:"color",triggerUpdate:!1,onChange:Qi},linkAutoColorBy:{},linkLineDash:{triggerUpdate:!1,onChange:Qi},linkWidth:{default:1,triggerUpdate:!1,onChange:Qi},linkCurvature:{default:0,triggerUpdate:!1,onChange:Qi},linkCanvasObject:{triggerUpdate:!1,onChange:Qi},linkCanvasObjectMode:{default:function(){return"replace"},triggerUpdate:!1,onChange:Qi},linkDirectionalArrowLength:{default:0,triggerUpdate:!1,onChange:Qi},linkDirectionalArrowColor:{triggerUpdate:!1,onChange:Qi},linkDirectionalArrowRelPos:{default:.5,triggerUpdate:!1,onChange:Qi},linkDirectionalParticles:{default:0,triggerUpdate:!1,onChange:RH},linkDirectionalParticleSpeed:{default:.01,triggerUpdate:!1},linkDirectionalParticleWidth:{default:4,triggerUpdate:!1},linkDirectionalParticleColor:{triggerUpdate:!1},globalScale:{default:1,triggerUpdate:!1},d3AlphaMin:{default:0,triggerUpdate:!1},d3AlphaDecay:{default:.0228,triggerUpdate:!1,onChange:function(e,n){n.forceLayout.alphaDecay(e)}},d3AlphaTarget:{default:0,triggerUpdate:!1,onChange:function(e,n){n.forceLayout.alphaTarget(e)}},d3VelocityDecay:{default:.4,triggerUpdate:!1,onChange:function(e,n){n.forceLayout.velocityDecay(e)}},warmupTicks:{default:0,triggerUpdate:!1},cooldownTicks:{default:1/0,triggerUpdate:!1},cooldownTime:{default:15e3,triggerUpdate:!1},onUpdate:{default:function(){},triggerUpdate:!1},onFinishUpdate:{default:function(){},triggerUpdate:!1},onEngineTick:{default:function(){},triggerUpdate:!1},onEngineStop:{default:function(){},triggerUpdate:!1},onNeedsRedraw:{triggerUpdate:!1},isShadow:{default:!1,triggerUpdate:!1}},methods:{d3Force:function(e,n,i){return i===void 0?e.forceLayout.force(n):(e.forceLayout.force(n,i),this)},d3ReheatSimulation:function(e){return e.forceLayout.alpha(1),this.resetCountdown(),this},resetCountdown:function(e){return e.cntTicks=0,e.startTickTime=new Date,e.engineRunning=!0,this},isEngineRunning:function(e){return!!e.engineRunning},tickFrame:function(e){return!e.isShadow&&n(),s(),!e.isShadow&&o(),!e.isShadow&&a(),i(),this;function n(){e.engineRunning&&(++e.cntTicks>e.cooldownTicks||new Date-e.startTickTime>e.cooldownTime||e.d3AlphaMin>0&&e.forceLayout.alpha()<e.d3AlphaMin?(e.engineRunning=!1,e.onEngineStop()):(e.forceLayout.tick(),e.onEngineTick()))}function i(){var l=ht(e.nodeVisibility),c=ht(e.nodeVal),u=ht(e.nodeColor),h=ht(e.nodeCanvasObjectMode),f=e.ctx,d=e.isShadow/e.globalScale,p=e.graphData.nodes.filter(l);f.save(),p.forEach(function(m){var g=h(m);if(e.nodeCanvasObject&&(g==="before"||g==="replace")&&(e.nodeCanvasObject(m,f,e.globalScale),g==="replace")){f.restore();return}var v=Math.sqrt(Math.max(0,c(m)||1))*e.nodeRelSize+d;f.beginPath(),f.arc(m.x,m.y,v,0,2*Math.PI,!1),f.fillStyle=u(m)||"rgba(31, 120, 180, 0.92)",f.fill(),e.nodeCanvasObject&&g==="after"&&e.nodeCanvasObject(m,e.ctx,e.globalScale)}),f.restore()}function s(){var l=ht(e.linkVisibility),c=ht(e.linkColor),u=ht(e.linkWidth),h=ht(e.linkLineDash),f=ht(e.linkCurvature),d=ht(e.linkCanvasObjectMode),p=e.ctx,m=e.isShadow*2,g=e.graphData.links.filter(l);g.forEach(S);var v=[],y=[],x=g;if(e.linkCanvasObject){var b=[],w=[];g.forEach(function(T){return({before:v,after:y,replace:b}[d(T)]||w).push(T)}),x=[].concat(ra(v),y,w),v=v.concat(b)}p.save(),v.forEach(function(T){return e.linkCanvasObject(T,p,e.globalScale)}),p.restore();var _=Mje(x,[c,u,h]);p.save(),Object.entries(_).forEach(function(T){var E=q0(T,2),M=E[0],A=E[1],P=!M||M==="undefined"?"rgba(0,0,0,0.15)":M;Object.entries(A).forEach(function(D){var B=q0(D,2),C=B[0],O=B[1],R=(C||1)/e.globalScale+m;Object.entries(O).forEach(function(z){var U=q0(z,2);U[0];var G=U[1],H=h(G[0]);p.beginPath(),G.forEach(function(Y){var ee=Y.source,he=Y.target;if(!(!ee||!he||!ee.hasOwnProperty("x")||!he.hasOwnProperty("x"))){p.moveTo(ee.x,ee.y);var q=Y.__controlPoints;q?p[q.length===2?"quadraticCurveTo":"bezierCurveTo"].apply(p,ra(q).concat([he.x,he.y])):p.lineTo(he.x,he.y)}}),p.strokeStyle=P,p.lineWidth=R,p.setLineDash(H||[]),p.stroke()})})}),p.restore(),p.save(),y.forEach(function(T){return e.linkCanvasObject(T,p,e.globalScale)}),p.restore();function S(T){var E=f(T);if(!E){T.__controlPoints=null;return}var M=T.source,A=T.target;if(!(!M||!A||!M.hasOwnProperty("x")||!A.hasOwnProperty("x"))){var P=Math.sqrt(Math.pow(A.x-M.x,2)+Math.pow(A.y-M.y,2));if(P>0){var D=Math.atan2(A.y-M.y,A.x-M.x),B=P*E,C={x:(M.x+A.x)/2+B*Math.cos(D-Math.PI/2),y:(M.y+A.y)/2+B*Math.sin(D-Math.PI/2)};T.__controlPoints=[C.x,C.y]}else{var O=E*70;T.__controlPoints=[A.x,A.y-O,A.x+O,A.y]}}}}function o(){var l=1.6,c=.2,u=ht(e.linkDirectionalArrowLength),h=ht(e.linkDirectionalArrowRelPos),f=ht(e.linkVisibility),d=ht(e.linkDirectionalArrowColor||e.linkColor),p=ht(e.nodeVal),m=e.ctx;m.save(),e.graphData.links.filter(f).forEach(function(g){var v=u(g);if(!(!v||v<0)){var y=g.source,x=g.target;if(!(!y||!x||!y.hasOwnProperty("x")||!x.hasOwnProperty("x"))){var b=Math.sqrt(Math.max(0,p(y)||1))*e.nodeRelSize,w=Math.sqrt(Math.max(0,p(x)||1))*e.nodeRelSize,_=Math.min(1,Math.max(0,h(g))),S=d(g)||"rgba(0,0,0,0.28)",T=v/l/2,E=g.__controlPoints&&AH(qn,[y.x,y.y].concat(ra(g.__controlPoints),[x.x,x.y])),M=E?function(R){return E.get(R)}:function(R){return{x:y.x+(x.x-y.x)*R||0,y:y.y+(x.y-y.y)*R||0}},A=E?E.length():Math.sqrt(Math.pow(x.x-y.x,2)+Math.pow(x.y-y.y,2)),P=b+v+(A-b-w-v)*_,D=M(P/A),B=M((P-v)/A),C=M((P-v*(1-c))/A),O=Math.atan2(D.y-B.y,D.x-B.x)-Math.PI/2;m.beginPath(),m.moveTo(D.x,D.y),m.lineTo(B.x+T*Math.cos(O),B.y+T*Math.sin(O)),m.lineTo(C.x,C.y),m.lineTo(B.x-T*Math.cos(O),B.y-T*Math.sin(O)),m.fillStyle=S,m.fill()}}}),m.restore()}function a(){var l=ht(e.linkDirectionalParticles),c=ht(e.linkDirectionalParticleSpeed),u=ht(e.linkDirectionalParticleWidth),h=ht(e.linkVisibility),f=ht(e.linkDirectionalParticleColor||e.linkColor),d=e.ctx;d.save(),e.graphData.links.filter(h).forEach(function(p){var m=l(p);if(!(!p.hasOwnProperty("__photons")||!p.__photons.length)){var g=p.source,v=p.target;if(!(!g||!v||!g.hasOwnProperty("x")||!v.hasOwnProperty("x"))){var y=c(p),x=p.__photons||[],b=Math.max(0,u(p)/2)/Math.sqrt(e.globalScale),w=f(p)||"rgba(0,0,0,0.28)";d.fillStyle=w;var _=p.__controlPoints?AH(qn,[g.x,g.y].concat(ra(p.__controlPoints),[v.x,v.y])):null,S=0,T=!1;x.forEach(function(E){var M=!!E.__singleHop;if(E.hasOwnProperty("__progressRatio")||(E.__progressRatio=M?0:S/m),!M&&S++,E.__progressRatio+=y,E.__progressRatio>=1)if(!M)E.__progressRatio=E.__progressRatio%1;else{T=!0;return}var A=E.__progressRatio,P=_?_.get(A):{x:g.x+(v.x-g.x)*A||0,y:g.y+(v.y-g.y)*A||0};d.beginPath(),d.arc(P.x,P.y,b,0,2*Math.PI,!1),d.fill()}),T&&(p.__photons=p.__photons.filter(function(E){return!E.__singleHop||E.__progressRatio<=1}))}}}),d.restore()}},emitParticle:function(e,n){return n&&(!n.__photons&&(n.__photons=[]),n.__photons.push({__singleHop:!0})),this}},stateInit:function(){return{forceLayout:iZ().force("link",tZ()).force("charge",sZ()).force("center",XY()).force("dagRadial",null).stop(),engineRunning:!1}},init:function(e,n){n.ctx=e},update:function(e,n){e.engineRunning=!1,e.onUpdate(),e.nodeAutoColorBy!==null&&PH(e.graphData.nodes,ht(e.nodeAutoColorBy),e.nodeColor),e.linkAutoColorBy!==null&&PH(e.graphData.links,ht(e.linkAutoColorBy),e.linkColor),e.graphData.links.forEach(function(d){d.source=d[e.linkSource],d.target=d[e.linkTarget]}),e.forceLayout.stop().alpha(1).nodes(e.graphData.nodes);var i=e.forceLayout.force("link");i&&i.id(function(d){return d[e.nodeId]}).links(e.graphData.links);var s=e.dagMode&&Bje(e.graphData,function(d){return d[e.nodeId]},{nodeFilter:e.dagNodeFilter,onLoopError:e.onDagError||void 0}),o=Math.max.apply(Math,ra(Object.values(s||[]))),a=e.dagLevelDistance||e.graphData.nodes.length/(o||1)*Uje*(["radialin","radialout"].indexOf(e.dagMode)!==-1?.7:1);if(["lr","rl","td","bu"].includes(n.dagMode)){var l=["lr","rl"].includes(n.dagMode)?"fx":"fy";e.graphData.nodes.filter(e.dagNodeFilter).forEach(function(d){return delete d[l]})}if(["lr","rl","td","bu"].includes(e.dagMode)){var c=["rl","bu"].includes(e.dagMode),u=function(p){return(s[p[e.nodeId]]-o/2)*a*(c?-1:1)},h=["lr","rl"].includes(e.dagMode)?"fx":"fy";e.graphData.nodes.filter(e.dagNodeFilter).forEach(function(d){return d[h]=u(d)})}e.forceLayout.force("dagRadial",["radialin","radialout"].indexOf(e.dagMode)!==-1?oZ(function(d){var p=s[d[e.nodeId]]||-1;return(e.dagMode==="radialin"?o-p:p)*a}).strength(function(d){return e.dagNodeFilter(d)?1:0}):null);for(var f=0;f<e.warmupTicks&&!(e.d3AlphaMin>0&&e.forceLayout.alpha()<e.d3AlphaMin);f++)e.forceLayout.tick();this.resetCountdown(),e.onFinishUpdate()}});function pte(r,e){var n=r instanceof Array?r:[r],i=new e;return i._destructor&&i._destructor(),{linkProp:function(o){return{default:i[o](),onChange:function(l,c){n.forEach(function(u){return c[u][o](l)})},triggerUpdate:!1}},linkMethod:function(o){return function(a){for(var l=arguments.length,c=new Array(l>1?l-1:0),u=1;u<l;u++)c[u-1]=arguments[u];var h=[];return n.forEach(function(f){var d=a[f],p=d[o].apply(d,c);p!==d&&h.push(p)}),h.length?h[0]:this}}}}var zje=800,$je=4,jje=5,mte=pte("forceGraph",_E),Vje=pte(["forceGraph","shadowGraph"],_E),Gje=Object.assign.apply(Object,ra(["nodeColor","nodeAutoColorBy","nodeCanvasObject","nodeCanvasObjectMode","linkColor","linkAutoColorBy","linkLineDash","linkWidth","linkCanvasObject","linkCanvasObjectMode","linkDirectionalArrowLength","linkDirectionalArrowColor","linkDirectionalArrowRelPos","linkDirectionalParticles","linkDirectionalParticleSpeed","linkDirectionalParticleWidth","linkDirectionalParticleColor","dagMode","dagLevelDistance","dagNodeFilter","onDagError","d3AlphaMin","d3AlphaDecay","d3VelocityDecay","warmupTicks","cooldownTicks","cooldownTime","onEngineTick","onEngineStop"].map(function(r){return pb({},r,mte.linkProp(r))})).concat(ra(["nodeRelSize","nodeId","nodeVal","nodeVisibility","linkSource","linkTarget","linkVisibility","linkCurvature"].map(function(r){return pb({},r,Vje.linkProp(r))})))),Hje=Object.assign.apply(Object,ra(["d3Force","d3ReheatSimulation","emitParticle"].map(function(r){return pb({},r,mte.linkMethod(r))})));function GN(r){if(r.canvas){var e=r.canvas.width,n=r.canvas.height;e===300&&n===150&&(e=n=0);var i=window.devicePixelRatio;e/=i,n/=i,[r.canvas,r.shadowCanvas].forEach(function(o){o.style.width="".concat(r.width,"px"),o.style.height="".concat(r.height,"px"),o.width=r.width*i,o.height=r.height*i,!e&&!n&&o.getContext("2d").scale(i,i)});var s=gl(r.canvas).k;r.zoom.translateBy(r.zoom.__baseElem,(r.width-e)/2/s,(r.height-n)/2/s),r.needsRedraw=!0}}function gte(r){var e=window.devicePixelRatio;r.setTransform(e,0,0,e,0,0)}function NH(r,e,n){r.save(),gte(r),r.clearRect(0,0,e,n),r.restore()}var Wje=Vh({props:Dp({width:{default:window.innerWidth,onChange:function(e,n){return GN(n)},triggerUpdate:!1},height:{default:window.innerHeight,onChange:function(e,n){return GN(n)},triggerUpdate:!1},graphData:{default:{nodes:[],links:[]},onChange:function(e,n){[e.nodes,e.links].every(function(s){return(s||[]).every(function(o){return!o.hasOwnProperty("__indexColor")})})&&n.colorTracker.reset(),[{type:"Node",objs:e.nodes},{type:"Link",objs:e.links}].forEach(i),n.forceGraph.graphData(e),n.shadowGraph.graphData(e);function i(s){var o=s.type,a=s.objs;a.filter(function(l){if(!l.hasOwnProperty("__indexColor"))return!0;var c=n.colorTracker.lookup(l.__indexColor);return!c||!c.hasOwnProperty("d")||c.d!==l}).forEach(function(l){l.__indexColor=n.colorTracker.register({type:o,d:l})})}},triggerUpdate:!1},backgroundColor:{onChange:function(e,n){n.canvas&&e&&(n.canvas.style.background=e)},triggerUpdate:!1},nodeLabel:{default:"name",triggerUpdate:!1},nodePointerAreaPaint:{onChange:function(e,n){n.shadowGraph.nodeCanvasObject(e?function(i,s,o){return e(i,i.__indexColor,s,o)}:null),n.flushShadowCanvas&&n.flushShadowCanvas()},triggerUpdate:!1},linkPointerAreaPaint:{onChange:function(e,n){n.shadowGraph.linkCanvasObject(e?function(i,s,o){return e(i,i.__indexColor,s,o)}:null),n.flushShadowCanvas&&n.flushShadowCanvas()},triggerUpdate:!1},linkLabel:{default:"name",triggerUpdate:!1},linkHoverPrecision:{default:4,triggerUpdate:!1},minZoom:{default:.01,onChange:function(e,n){n.zoom.scaleExtent([e,n.zoom.scaleExtent()[1]])},triggerUpdate:!1},maxZoom:{default:1e3,onChange:function(e,n){n.zoom.scaleExtent([n.zoom.scaleExtent()[0],e])},triggerUpdate:!1},enableNodeDrag:{default:!0,triggerUpdate:!1},enableZoomInteraction:{default:!0,triggerUpdate:!1},enablePanInteraction:{default:!0,triggerUpdate:!1},enableZoomPanInteraction:{default:!0,triggerUpdate:!1},enablePointerInteraction:{default:!0,onChange:function(e,n){n.hoverObj=null},triggerUpdate:!1},autoPauseRedraw:{default:!0,triggerUpdate:!1},onNodeDrag:{default:function(){},triggerUpdate:!1},onNodeDragEnd:{default:function(){},triggerUpdate:!1},onNodeClick:{triggerUpdate:!1},onNodeRightClick:{triggerUpdate:!1},onNodeHover:{triggerUpdate:!1},onLinkClick:{triggerUpdate:!1},onLinkRightClick:{triggerUpdate:!1},onLinkHover:{triggerUpdate:!1},onBackgroundClick:{triggerUpdate:!1},onBackgroundRightClick:{triggerUpdate:!1},onZoom:{triggerUpdate:!1},onZoomEnd:{triggerUpdate:!1},onRenderFramePre:{triggerUpdate:!1},onRenderFramePost:{triggerUpdate:!1}},Gje),aliases:{stopAnimation:"pauseAnimation"},methods:Dp({graph2ScreenCoords:function(e,n,i){var s=gl(e.canvas);return{x:n*s.k+s.x,y:i*s.k+s.y}},screen2GraphCoords:function(e,n,i){var s=gl(e.canvas);return{x:(n-s.x)/s.k,y:(i-s.y)/s.k}},centerAt:function(e,n,i,s){if(!e.canvas)return null;if(n!==void 0||i!==void 0){var o=Object.assign({},n!==void 0?{x:n}:{},i!==void 0?{y:i}:{});return s?e.tweenGroup.add(new yE(a()).to(o,s).easing(Kc.Quadratic.Out).onUpdate(l).start()):l(o),this}return a();function a(){var c=gl(e.canvas);return{x:(e.width/2-c.x)/c.k,y:(e.height/2-c.y)/c.k}}function l(c){var u=c.x,h=c.y;e.zoom.translateTo(e.zoom.__baseElem,u===void 0?a().x:u,h===void 0?a().y:h),e.needsRedraw=!0}},zoom:function(e,n,i){if(!e.canvas)return null;if(n!==void 0)return i?e.tweenGroup.add(new yE({k:s()}).to({k:n},i).easing(Kc.Quadratic.Out).onUpdate(function(a){var l=a.k;return o(l)}).start()):o(n),this;return s();function s(){return gl(e.canvas).k}function o(a){e.zoom.scaleTo(e.zoom.__baseElem,a),e.needsRedraw=!0}},zoomToFit:function(e){for(var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:10,s=arguments.length,o=new Array(s>3?s-3:0),a=3;a<s;a++)o[a-3]=arguments[a];var l=this.getGraphBbox.apply(this,o);if(l){var c={x:(l.x[0]+l.x[1])/2,y:(l.y[0]+l.y[1])/2},u=Math.max(1e-12,Math.min(1e12,(e.width-i*2)/(l.x[1]-l.x[0]),(e.height-i*2)/(l.y[1]-l.y[0])));this.centerAt(c.x,c.y,n),this.zoom(u,n)}return this},getGraphBbox:function(e){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:function(){return!0},i=ht(e.nodeVal),s=function(l){return Math.sqrt(Math.max(0,i(l)||1))*e.nodeRelSize},o=e.graphData.nodes.filter(n).map(function(a){return{x:a.x,y:a.y,r:s(a)}});return o.length?{x:[Zx(o,function(a){return a.x-a.r}),Yx(o,function(a){return a.x+a.r})],y:[Zx(o,function(a){return a.y-a.r}),Yx(o,function(a){return a.y+a.r})]}:null},pauseAnimation:function(e){return e.animationFrameRequestId&&(cancelAnimationFrame(e.animationFrameRequestId),e.animationFrameRequestId=null),this},resumeAnimation:function(e){return e.animationFrameRequestId||this._animationCycle(),this},_destructor:function(){this.pauseAnimation(),this.graphData({nodes:[],links:[]})}},Hje),stateInit:function(){return{lastSetZoom:1,zoom:V$e(),forceGraph:new _E,shadowGraph:new _E().cooldownTicks(0).nodeColor("__indexColor").linkColor("__indexColor").isShadow(!0),colorTracker:new oje,tweenGroup:new nB}},init:function(e,n){var i=this;e.innerHTML="";var s=document.createElement("div");s.classList.add("force-graph-container"),s.style.position="relative",e.appendChild(s),n.canvas=document.createElement("canvas"),n.backgroundColor&&(n.canvas.style.background=n.backgroundColor),s.appendChild(n.canvas),n.shadowCanvas=document.createElement("canvas");var o=n.canvas.getContext("2d"),a=n.shadowCanvas.getContext("2d",{willReadFrequently:!0}),l={x:-1e12,y:-1e12},c=function(){var f=null,d=window.devicePixelRatio,p=l.x>0&&l.y>0?a.getImageData(l.x*d,l.y*d,1,1):null;return p&&(f=n.colorTracker.lookup(p.data)),f};na(n.canvas).call(Pze().subject(function(){if(!n.enableNodeDrag)return null;var h=c();return h&&h.type==="Node"?h.d:null}).on("start",function(h){var f=h.subject;f.__initialDragPos={x:f.x,y:f.y,fx:f.fx,fy:f.fy},h.active||(f.fx=f.x,f.fy=f.y),n.canvas.classList.add("grabbable")}).on("drag",function(h){var f=h.subject,d=f.__initialDragPos,p=h,m=gl(n.canvas).k,g={x:d.x+(p.x-d.x)/m-f.x,y:d.y+(p.y-d.y)/m-f.y};["x","y"].forEach(function(v){return f["f".concat(v)]=f[v]=d[v]+(p[v]-d[v])/m}),!(!f.__dragged&&jje>=Math.sqrt(dEe(["x","y"].map(function(v){return Math.pow(h[v]-d[v],2)}))))&&(n.forceGraph.d3AlphaTarget(.3).resetCountdown(),n.isPointerDragging=!0,f.__dragged=!0,n.onNodeDrag(f,g))}).on("end",function(h){var f=h.subject,d=f.__initialDragPos,p={x:f.x-d.x,y:f.y-d.y};d.fx===void 0&&(f.fx=void 0),d.fy===void 0&&(f.fy=void 0),delete f.__initialDragPos,n.forceGraph.d3AlphaTarget()&&n.forceGraph.d3AlphaTarget(0).resetCountdown(),n.canvas.classList.remove("grabbable"),n.isPointerDragging=!1,f.__dragged&&(delete f.__dragged,n.onNodeDragEnd(f,p))})),n.zoom(n.zoom.__baseElem=na(n.canvas)),n.zoom.__baseElem.on("dblclick.zoom",null),n.zoom.filter(function(h){return!h.button&&n.enableZoomPanInteraction&&(h.type!=="wheel"||ht(n.enableZoomInteraction)(h))&&(h.type==="wheel"||ht(n.enablePanInteraction)(h))}).on("zoom",function(h){var f=h.transform;[o,a].forEach(function(d){gte(d),d.translate(f.x,f.y),d.scale(f.k,f.k)}),n.isPointerDragging=!0,n.onZoom&&n.onZoom(Dp(Dp({},f),i.centerAt())),n.needsRedraw=!0}).on("end",function(h){n.isPointerDragging=!1,n.onZoomEnd&&n.onZoomEnd(Dp(Dp({},h.transform),i.centerAt()))}),GN(n),n.forceGraph.onNeedsRedraw(function(){return n.needsRedraw=!0}).onFinishUpdate(function(){gl(n.canvas).k===n.lastSetZoom&&n.graphData.nodes.length&&(n.zoom.scaleTo(n.zoom.__baseElem,n.lastSetZoom=$je/Math.cbrt(n.graphData.nodes.length)),n.needsRedraw=!0)}),n.tooltip=new Zee(s),["pointermove","pointerdown"].forEach(function(h){return s.addEventListener(h,function(f){h==="pointerdown"&&(n.isPointerPressed=!0,n.pointerDownEvent=f),!n.isPointerDragging&&f.type==="pointermove"&&n.onBackgroundClick&&(f.pressure>0||n.isPointerPressed)&&(f.pointerType!=="touch"||f.movementX===void 0||[f.movementX,f.movementY].some(function(m){return Math.abs(m)>1}))&&(n.isPointerDragging=!0);var d=p(s);l.x=f.pageX-d.left,l.y=f.pageY-d.top;function p(m){var g=m.getBoundingClientRect(),v=window.pageXOffset||document.documentElement.scrollLeft,y=window.pageYOffset||document.documentElement.scrollTop;return{top:g.top+y,left:g.left+v}}},{passive:!0})}),s.addEventListener("pointerup",function(h){if(n.isPointerPressed){if(n.isPointerPressed=!1,n.isPointerDragging){n.isPointerDragging=!1;return}var f=[h,n.pointerDownEvent];requestAnimationFrame(function(){if(h.button===0)if(n.hoverObj){var d=n["on".concat(n.hoverObj.type,"Click")];d&&d.apply(void 0,[n.hoverObj.d].concat(f))}else n.onBackgroundClick&&n.onBackgroundClick.apply(n,f);if(h.button===2)if(n.hoverObj){var p=n["on".concat(n.hoverObj.type,"RightClick")];p&&p.apply(void 0,[n.hoverObj.d].concat(f))}else n.onBackgroundRightClick&&n.onBackgroundRightClick.apply(n,f)})}},{passive:!0}),s.addEventListener("contextmenu",function(h){return!n.onBackgroundRightClick&&!n.onNodeRightClick&&!n.onLinkRightClick?!0:(h.preventDefault(),!1)}),n.forceGraph(o),n.shadowGraph(a);var u=H$e(function(){NH(a,n.width,n.height),n.shadowGraph.linkWidth(function(f){return ht(n.linkWidth)(f)+n.linkHoverPrecision});var h=gl(n.canvas);n.shadowGraph.globalScale(h.k).tickFrame()},zje);n.flushShadowCanvas=u.flush,(this._animationCycle=function h(){var f=!n.autoPauseRedraw||!!n.needsRedraw||n.forceGraph.isEngineRunning()||n.graphData.links.some(function(b){return b.__photons&&b.__photons.length});if(n.needsRedraw=!1,n.enablePointerInteraction){var d=n.isPointerDragging?null:c();if(d!==n.hoverObj){var p=n.hoverObj,m=p?p.type:null,g=d?d.type:null;if(m&&m!==g){var v=n["on".concat(m,"Hover")];v&&v(null,p.d)}if(g){var y=n["on".concat(g,"Hover")];y&&y(d.d,m===g?p.d:null)}n.tooltip.content(d&&ht(n["".concat(d.type.toLowerCase(),"Label")])(d.d)||null),n.canvas.classList[d&&n["on".concat(g,"Click")]||!d&&n.onBackgroundClick?"add":"remove"]("clickable"),n.hoverObj=d}f&&u()}if(f){NH(o,n.width,n.height);var x=gl(n.canvas).k;n.onRenderFramePre&&n.onRenderFramePre(o,x),n.forceGraph.globalScale(x).tickFrame(),n.onRenderFramePost&&n.onRenderFramePost(o,x)}n.tweenGroup.update(),n.animationFrameRequestId=requestAnimationFrame(h)})()},update:function(e){}}),kA={width:ie.number,height:ie.number,graphData:ie.shape({nodes:ie.arrayOf(ie.object).isRequired,links:ie.arrayOf(ie.object).isRequired}),backgroundColor:ie.string,nodeRelSize:ie.number,nodeId:ie.string,nodeLabel:ie.oneOfType([ie.string,ie.func]),nodeVal:ie.oneOfType([ie.number,ie.string,ie.func]),nodeVisibility:ie.oneOfType([ie.bool,ie.string,ie.func]),nodeColor:ie.oneOfType([ie.string,ie.func]),nodeAutoColorBy:ie.oneOfType([ie.string,ie.func]),onNodeHover:ie.func,onNodeClick:ie.func,linkSource:ie.string,linkTarget:ie.string,linkLabel:ie.oneOfType([ie.string,ie.func]),linkVisibility:ie.oneOfType([ie.bool,ie.string,ie.func]),linkColor:ie.oneOfType([ie.string,ie.func]),linkAutoColorBy:ie.oneOfType([ie.string,ie.func]),linkWidth:ie.oneOfType([ie.number,ie.string,ie.func]),linkCurvature:ie.oneOfType([ie.number,ie.string,ie.func]),linkDirectionalArrowLength:ie.oneOfType([ie.number,ie.string,ie.func]),linkDirectionalArrowColor:ie.oneOfType([ie.string,ie.func]),linkDirectionalArrowRelPos:ie.oneOfType([ie.number,ie.string,ie.func]),linkDirectionalParticles:ie.oneOfType([ie.number,ie.string,ie.func]),linkDirectionalParticleSpeed:ie.oneOfType([ie.number,ie.string,ie.func]),linkDirectionalParticleWidth:ie.oneOfType([ie.number,ie.string,ie.func]),linkDirectionalParticleColor:ie.oneOfType([ie.string,ie.func]),onLinkHover:ie.func,onLinkClick:ie.func,dagMode:ie.oneOf(["td","bu","lr","rl","zin","zout","radialin","radialout"]),dagLevelDistance:ie.number,dagNodeFilter:ie.func,onDagError:ie.func,d3AlphaMin:ie.number,d3AlphaDecay:ie.number,d3VelocityDecay:ie.number,warmupTicks:ie.number,cooldownTicks:ie.number,cooldownTime:ie.number,onEngineTick:ie.func,onEngineStop:ie.func,getGraphBbox:ie.func},yte={zoomToFit:ie.func,onNodeRightClick:ie.func,onNodeDrag:ie.func,onNodeDragEnd:ie.func,onLinkRightClick:ie.func,linkHoverPrecision:ie.number,onBackgroundClick:ie.func,onBackgroundRightClick:ie.func,enablePointerInteraction:ie.bool,enableNodeDrag:ie.bool},fB={showNavInfo:ie.bool,nodeOpacity:ie.number,nodeResolution:ie.number,nodeThreeObject:ie.oneOfType([ie.object,ie.string,ie.func]),nodeThreeObjectExtend:ie.oneOfType([ie.bool,ie.string,ie.func]),linkOpacity:ie.number,linkResolution:ie.number,linkCurveRotation:ie.oneOfType([ie.number,ie.string,ie.func]),linkMaterial:ie.oneOfType([ie.object,ie.string,ie.func]),linkThreeObject:ie.oneOfType([ie.object,ie.string,ie.func]),linkThreeObjectExtend:ie.oneOfType([ie.bool,ie.string,ie.func]),linkPositionUpdate:ie.func,linkDirectionalArrowResolution:ie.number,linkDirectionalParticleResolution:ie.number,forceEngine:ie.oneOf(["d3","ngraph"]),ngraphPhysics:ie.object,numDimensions:ie.oneOf([1,2,3])},qje=Object.assign({},kA,yte,{linkLineDash:ie.oneOfType([ie.arrayOf(ie.number),ie.string,ie.func]),nodeCanvasObjectMode:ie.oneOfType([ie.string,ie.func]),nodeCanvasObject:ie.func,nodePointerAreaPaint:ie.func,linkCanvasObjectMode:ie.oneOfType([ie.string,ie.func]),linkCanvasObject:ie.func,linkPointerAreaPaint:ie.func,autoPauseRedraw:ie.bool,minZoom:ie.number,maxZoom:ie.number,enableZoomInteraction:ie.oneOfType([ie.bool,ie.func]),enablePanInteraction:ie.oneOfType([ie.bool,ie.func]),onZoom:ie.func,onZoomEnd:ie.func,onRenderFramePre:ie.func,onRenderFramePost:ie.func}),Xje=Object.assign({},kA,yte,fB,{enableNavigationControls:ie.bool,controlType:ie.oneOf(["trackball","orbit","fly"]),rendererConfig:ie.object,extraRenderers:ie.arrayOf(ie.shape({render:ie.func.isRequired}))}),Kje=Object.assign({},kA,fB,{nodeDesc:ie.oneOfType([ie.string,ie.func]),linkDesc:ie.oneOfType([ie.string,ie.func])}),Yje=Object.assign({},kA,fB,{markerAttrs:ie.object,yOffset:ie.number,glScale:ie.number});const vte=FM(OPe,{methodNames:["getGraphBbox","emitParticle","d3Force","d3ReheatSimulation","refresh"]});vte.displayName="ForceGraphVR";vte.propTypes=Kje;const xte=FM(WPe,{methodNames:["getGraphBbox","emitParticle","d3Force","d3ReheatSimulation","refresh"],initPropNames:["markerAttrs"]});xte.displayName="ForceGraphAR";xte.propTypes=Yje;const bte=FM(Sze,{methodNames:["emitParticle","d3Force","d3ReheatSimulation","stopAnimation","pauseAnimation","resumeAnimation","cameraPosition","zoomToFit","getGraphBbox","screen2GraphCoords","graph2ScreenCoords","postProcessingComposer","lights","scene","camera","renderer","controls","refresh"],initPropNames:["controlType","rendererConfig","extraRenderers"]});bte.displayName="ForceGraph3D";bte.propTypes=Xje;const dB=FM(Wje,{methodNames:["emitParticle","d3Force","d3ReheatSimulation","stopAnimation","pauseAnimation","resumeAnimation","centerAt","zoom","zoomToFit","getGraphBbox","screen2GraphCoords","graph2ScreenCoords"]});dB.displayName="ForceGraph2D";dB.propTypes=qje;const Zje=({model:r})=>{const e=te.useMemo(()=>{const s={nodes:[],links:[]};return s.nodes.push({id:"sharedValues",name:"Shared Values",group:"Shared Values",value:r.sharedValues.alignmentScore*10,description:`Alignment Score: ${r.sharedValues.alignmentScore.toFixed(2)}`}),s.nodes.push({id:"strategy",name:"Strategy",group:"Strategy",value:r.strategy.alignmentScore*10,description:`Corporate: ${r.strategy.corporateLevel}
Business: ${r.strategy.businessLevel}
Alignment Score: ${r.strategy.alignmentScore.toFixed(2)}`}),s.nodes.push({id:"structure",name:"Structure",group:"Structure",value:r.structure.alignmentScore*10,description:`Type: ${r.structure.type}
Alignment Score: ${r.structure.alignmentScore.toFixed(2)}`}),s.nodes.push({id:"systems",name:"Systems",group:"Systems",value:r.systems.alignmentScore*10,description:`Alignment Score: ${r.systems.alignmentScore.toFixed(2)}`}),s.nodes.push({id:"skills",name:"Skills",group:"Skills",value:r.skills.alignmentScore*10,description:`Core Competencies: ${r.skills.coreCompetencies.join(", ")}
Alignment Score: ${r.skills.alignmentScore.toFixed(2)}`}),s.nodes.push({id:"style",name:"Style",group:"Style",value:r.style.alignmentScore*10,description:`Leadership Style: ${r.style.leadershipStyle}
Alignment Score: ${r.style.alignmentScore.toFixed(2)}`}),s.nodes.push({id:"staff",name:"Staff",group:"Staff",value:r.staff.alignmentScore*10,description:`Change Readiness: ${r.staff.changeReadiness*100}%
Alignment Score: ${r.staff.alignmentScore.toFixed(2)}`}),["strategy","structure","systems","skills","style","staff"].forEach(a=>{s.links.push({source:"sharedValues",target:a,value:3})}),s.links.push({source:"strategy",target:"structure",value:2}),s.links.push({source:"strategy",target:"systems",value:2}),s.links.push({source:"structure",target:"systems",value:2}),s.links.push({source:"staff",target:"skills",value:2}),s.links.push({source:"staff",target:"style",value:2}),s.links.push({source:"skills",target:"style",value:2}),s.links.push({source:"strategy",target:"skills",value:1}),s.links.push({source:"structure",target:"staff",value:1}),s.links.push({source:"systems",target:"style",value:1}),s},[r]),n=te.useCallback((s,o,a)=>{const l=s.name,c=12/a,u=Math.sqrt(s.value)*3;o.beginPath(),o.arc(s.x||0,s.y||0,u,0,2*Math.PI),o.fillStyle=Zf(s.group),o.fill(),o.font=`${c}px Sans-Serif`,o.textAlign="center",o.textBaseline="middle",o.fillStyle="white",o.fillText(l,s.x||0,s.y||0)},[]),i=te.useCallback(s=>s.value===3?"rgba(139, 92, 246, 0.6)":s.value===2?"rgba(14, 165, 233, 0.6)":"rgba(156, 163, 175, 0.4)",[]);return N.jsxs(jr,{className:"h-[600px]",children:[N.jsx(Vr,{className:"pb-0",children:N.jsx(Gr,{children:"7S Model Visualization"})}),N.jsx(Hr,{className:"h-[550px]",children:N.jsx(dB,{graphData:e,nodeCanvasObject:n,linkColor:i,linkWidth:s=>s.value*.5,nodeRelSize:8,linkDirectionalParticles:2,linkDirectionalParticleSpeed:s=>s.value*.01,cooldownTicks:100,onNodeHover:s=>{document.body.style.cursor=s?"pointer":"default"},nodeLabel:s=>s.description||s.name})})]})},Qje=({strategy:r,onUpdate:e})=>{const[n,i]=te.useState(r.corporateLevel),[s,o]=te.useState(r.businessLevel),[a,l]=te.useState(r.functionalLevel),[c,u]=te.useState(""),h=()=>{e({...r,corporateLevel:n,businessLevel:s,functionalLevel:a})},f=["Market Penetration","Product Development","Market Development","Related Diversification","Unrelated Diversification","Forward Integration","Backward Integration","Horizontal Integration","Joint Venture","Strategic Alliance","Merger & Acquisition","Turnaround","Divestiture","Liquidation","Harvesting","Stability"],d=["Cost Leadership","Differentiation","Focus - Cost","Focus - Differentiation"],p=["Dynamic Capabilities","Knowledge Management","Innovation","Operational Excellence","Customer Intimacy","Product Leadership"];return N.jsxs(jr,{children:[N.jsx(Vr,{children:N.jsx(Gr,{children:"Strategic Direction"})}),N.jsxs(Hr,{className:"space-y-4",children:[N.jsxs("div",{children:[N.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Corporate Level Strategy"}),N.jsx(Ii,{value:n,onChange:m=>i(m.target.value),children:f.map(m=>N.jsx("option",{value:m,children:m},m))}),N.jsx("p",{className:"mt-1 text-sm text-gray-500 dark:text-gray-400",children:HN(n)})]}),N.jsxs("div",{children:[N.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Business Level Strategy"}),N.jsx(Ii,{value:s,onChange:m=>o(m.target.value),children:d.map(m=>N.jsx("option",{value:m,children:m},m))}),N.jsx("p",{className:"mt-1 text-sm text-gray-500 dark:text-gray-400",children:HN(s)})]}),N.jsxs("div",{children:[N.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Functional Level Strategy"}),N.jsx(Ii,{value:a,onChange:m=>l(m.target.value),children:p.map(m=>N.jsx("option",{value:m,children:m},m))}),N.jsx("p",{className:"mt-1 text-sm text-gray-500 dark:text-gray-400",children:HN(a)})]}),N.jsxs("div",{children:[N.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Strategy Rationale"}),N.jsx(R0,{value:c,onChange:m=>u(m.target.value),placeholder:"Explain why these strategies align with your organizational goals..."})]}),N.jsxs("div",{className:"bg-blue-50 dark:bg-blue-900/30 p-4 rounded-md",children:[N.jsx("h4",{className:"font-medium text-blue-800 dark:text-blue-300 mb-2",children:"Strategy Impact Analysis"}),N.jsx("p",{className:"text-sm text-blue-700 dark:text-blue-400",children:Jje(n,s,a)})]})]}),N.jsx(a_,{children:N.jsx(hr,{onClick:h,children:"Update Strategy"})})]})};function HN(r,e){return{"Market Penetration":"Increasing market share with existing products in existing markets.","Product Development":"Introducing new products to existing markets.","Market Development":"Entering new markets with existing products.","Related Diversification":"Expanding into related industries or product lines.","Unrelated Diversification":"Expanding into unrelated industries or product lines.","Forward Integration":"Acquiring or controlling distributors or retailers.","Backward Integration":"Acquiring or controlling suppliers.","Horizontal Integration":"Acquiring or controlling competitors.","Joint Venture":"Partnering with another company for a specific project or market.","Strategic Alliance":"Forming a partnership without creating a new entity.","Merger & Acquisition":"Combining with or acquiring another company.",Turnaround:"Reversing declining performance through cost reduction and restructuring.",Divestiture:"Selling a business unit or division.",Liquidation:"Selling all assets and closing the business.",Harvesting:"Minimizing investment to maximize short-term cash flow.",Stability:"Maintaining current position without significant changes.","Cost Leadership":"Offering the lowest prices in the market through efficient operations.",Differentiation:"Creating unique products or services that competitors cannot easily imitate.","Focus - Cost":"Offering the lowest prices to a specific market segment.","Focus - Differentiation":"Creating unique products for a specific market segment.","Dynamic Capabilities":"Developing the ability to quickly reconfigure resources for changing environments.","Knowledge Management":"Creating, sharing, and effectively using organizational knowledge.",Innovation:"Developing new products, services, or processes.","Operational Excellence":"Focusing on efficient operations and processes.","Customer Intimacy":"Building deep customer relationships and delivering custom solutions.","Product Leadership":"Focusing on product innovation and quality."}[r]||"No description available."}function Jje(r,e,n){return r==="Market Penetration"&&e==="Cost Leadership"?"This combination suggests an aggressive pricing strategy to capture market share. It may require significant operational efficiency improvements and could impact staff morale if cost-cutting measures are implemented.":r.includes("Diversification")&&e==="Differentiation"?"This approach focuses on creating unique offerings in new markets. It will require significant innovation capabilities, an adaptive organizational structure, and strong leadership to manage the complexity.":r==="Turnaround"?"Turnaround strategies often create tension between short-term cost-cutting and long-term capability building. Leadership style will need to be directive initially, while systems must support quick decision-making.":n==="Innovation"?"Focusing on innovation requires an organic structure, collaborative culture, and skills development. This may conflict with certain cost leadership approaches at the business level.":"This strategic combination will require alignment across all 7S elements. Consider how your structure, systems, and staff capabilities will need to evolve to support these strategic choices."}const eVe=({structure:r,onUpdate:e})=>{const[n,i]=te.useState(r.type),[s,o]=te.useState(r.centralization),[a,l]=te.useState(r.formalization),[c,u]=te.useState(r.complexity),h=()=>{e({...r,type:n,centralization:s,formalization:a,complexity:c})};return N.jsxs(jr,{children:[N.jsx(Vr,{children:N.jsx(Gr,{children:"Organizational Structure"})}),N.jsxs(Hr,{className:"space-y-6",children:[N.jsxs("div",{children:[N.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Structure Type"}),N.jsxs(Ii,{value:n,onChange:f=>i(f.target.value),children:[N.jsx("option",{value:"Organic",children:"Organic"}),N.jsx("option",{value:"Mechanistic",children:"Mechanistic"}),N.jsx("option",{value:"Hybrid",children:"Hybrid"})]}),N.jsx("p",{className:"mt-1 text-sm text-gray-500 dark:text-gray-400",children:n==="Organic"?"Flexible, adaptable structure with decentralized authority":n==="Mechanistic"?"Rigid, hierarchical structure with centralized authority":"Combines elements of both organic and mechanistic structures"})]}),N.jsxs("div",{children:[N.jsxs("label",{className:"flex justify-between text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:[N.jsx("span",{children:"Centralization"}),N.jsxs("span",{children:[Math.round(s*100),"%"]})]}),N.jsx("input",{type:"range",min:"0",max:"1",step:"0.01",value:s,onChange:f=>o(parseFloat(f.target.value)),className:"w-full"}),N.jsxs("div",{className:"flex justify-between text-xs text-gray-500 mt-1",children:[N.jsx("span",{children:"Decentralized"}),N.jsx("span",{children:"Centralized"})]})]}),N.jsxs("div",{children:[N.jsxs("label",{className:"flex justify-between text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:[N.jsx("span",{children:"Formalization"}),N.jsxs("span",{children:[Math.round(a*100),"%"]})]}),N.jsx("input",{type:"range",min:"0",max:"1",step:"0.01",value:a,onChange:f=>l(parseFloat(f.target.value)),className:"w-full"}),N.jsxs("div",{className:"flex justify-between text-xs text-gray-500 mt-1",children:[N.jsx("span",{children:"Informal"}),N.jsx("span",{children:"Formal"})]})]}),N.jsxs("div",{children:[N.jsxs("label",{className:"flex justify-between text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:[N.jsx("span",{children:"Complexity"}),N.jsxs("span",{children:[Math.round(c*100),"%"]})]}),N.jsx("input",{type:"range",min:"0",max:"1",step:"0.01",value:c,onChange:f=>u(parseFloat(f.target.value)),className:"w-full"}),N.jsxs("div",{className:"flex justify-between text-xs text-gray-500 mt-1",children:[N.jsx("span",{children:"Simple"}),N.jsx("span",{children:"Complex"})]})]}),N.jsxs("div",{className:"bg-blue-50 dark:bg-blue-900/30 p-4 rounded-md",children:[N.jsx("h4",{className:"font-medium text-blue-800 dark:text-blue-300 mb-2",children:"Structure Impact Analysis"}),N.jsx("p",{className:"text-sm text-blue-700 dark:text-blue-400",children:tVe(n,s,a,c)})]})]}),N.jsx(a_,{children:N.jsx(hr,{onClick:h,children:"Update Structure"})})]})};function tVe(r,e,n,i){let s="";return r==="Organic"?(s+="Organic structures are adaptable and work well for innovation-focused strategies. ",e>.6&&(s+="However, your high centralization may limit the benefits of an organic structure. ")):r==="Mechanistic"?(s+="Mechanistic structures provide efficiency and clear control, supporting operational excellence. ",e<.4&&(s+="Your low centralization seems at odds with a mechanistic structure. ")):s+="Hybrid structures can be versatile but may create internal tensions if not carefully managed. ",n>.7?s+="High formalization works well for stable environments but may hinder adaptation to change. ":n<.3&&(s+="Low formalization enables flexibility but may create consistency challenges. "),i>.7?s+="Complex structures require sophisticated management systems and clear communication channels. ":i<.3&&(s+="Simple structures enable quick decision-making but may limit specialization. "),s}const nVe=({systems:r,onUpdate:e})=>{const[n,i]=te.useState(r.financial),[s,o]=te.useState(r.operational),[a,l]=te.useState(r.information),[c,u]=te.useState(r.hr),h=()=>{e({...r,financial:n,operational:s,information:a,hr:c})},f=["Traditional budgeting and reporting","Zero-based budgeting","Activity-based costing","Beyond budgeting","Rolling forecasts","Balanced scorecard"],d=["Standard operating procedures","Total quality management","Six sigma","Lean operations","Agile methodologies","Business process reengineering"],p=["Legacy systems with some modern tools","Cloud-based enterprise systems","Integrated ERP systems","Data-driven decision making","AI-augmented analytics","Decentralized information systems"],m={talentAcquisition:["Traditional recruitment","Employer branding focus","AI-powered talent acquisition","Internal talent marketplace","Gig economy integration"],trainingDevelopment:["Basic training programs","Continuous learning culture","Personalized development paths","Peer learning networks","External partnerships"],performanceManagement:["Annual performance reviews","Continuous feedback","OKRs (Objectives & Key Results)","Multi-source feedback","Performance coaching"],compensationBenefits:["Market-based compensation","Pay-for-performance","Total rewards approach","Flexible benefits","Equity-based compensation"]};return N.jsxs(jr,{children:[N.jsx(Vr,{children:N.jsx(Gr,{children:"Organizational Systems"})}),N.jsxs(Hr,{className:"space-y-6",children:[N.jsxs("div",{children:[N.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Financial Systems"}),N.jsx(Ii,{value:n,onChange:g=>i(g.target.value),children:f.map(g=>N.jsx("option",{value:g,children:g},g))})]}),N.jsxs("div",{children:[N.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Operational Processes"}),N.jsx(Ii,{value:s,onChange:g=>o(g.target.value),children:d.map(g=>N.jsx("option",{value:g,children:g},g))})]}),N.jsxs("div",{children:[N.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Information Systems"}),N.jsx(Ii,{value:a,onChange:g=>l(g.target.value),children:p.map(g=>N.jsx("option",{value:g,children:g},g))})]}),N.jsxs("div",{className:"border-t border-gray-200 dark:border-gray-700 pt-4",children:[N.jsx("h4",{className:"font-medium text-gray-900 dark:text-white mb-4",children:"HR Systems"}),N.jsxs("div",{className:"space-y-4",children:[N.jsxs("div",{children:[N.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Talent Acquisition"}),N.jsx(Ii,{value:c.talentAcquisition,onChange:g=>u({...c,talentAcquisition:g.target.value}),children:m.talentAcquisition.map(g=>N.jsx("option",{value:g,children:g},g))})]}),N.jsxs("div",{children:[N.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Training & Development"}),N.jsx(Ii,{value:c.trainingDevelopment,onChange:g=>u({...c,trainingDevelopment:g.target.value}),children:m.trainingDevelopment.map(g=>N.jsx("option",{value:g,children:g},g))})]}),N.jsxs("div",{children:[N.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Performance Management"}),N.jsx(Ii,{value:c.performanceManagement,onChange:g=>u({...c,performanceManagement:g.target.value}),children:m.performanceManagement.map(g=>N.jsx("option",{value:g,children:g},g))})]}),N.jsxs("div",{children:[N.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Compensation & Benefits"}),N.jsx(Ii,{value:c.compensationBenefits,onChange:g=>u({...c,compensationBenefits:g.target.value}),children:m.compensationBenefits.map(g=>N.jsx("option",{value:g,children:g},g))})]})]})]}),N.jsxs("div",{className:"bg-blue-50 dark:bg-blue-900/30 p-4 rounded-md",children:[N.jsx("h4",{className:"font-medium text-blue-800 dark:text-blue-300 mb-2",children:"Systems Impact Analysis"}),N.jsx("p",{className:"text-sm text-blue-700 dark:text-blue-400",children:rVe(n,s,a,c)})]})]}),N.jsx(a_,{children:N.jsx(hr,{onClick:h,children:"Update Systems"})})]})};function rVe(r,e,n,i){let s="";return r.includes("Traditional")?s+="Traditional financial systems provide stability but may limit agility. ":r.includes("Zero-based")?s+="Zero-based budgeting supports cost control but requires significant management attention. ":r.includes("Beyond")&&(s+="Beyond budgeting enables adaptability but requires a mature culture of trust. "),e.includes("Agile")?s+="Agile methodologies support flexibility and innovation but may create friction with traditional systems. ":e.includes("Lean")?s+="Lean operations drive efficiency but require cultural commitment to continuous improvement. ":e.includes("Six sigma")&&(s+="Six sigma reduces variation but may stifle innovation if applied too rigidly. "),i.talentAcquisition.includes("AI")||i.trainingDevelopment.includes("Personalized")||i.performanceManagement.includes("OKRs")||i.compensationBenefits.includes("Equity")?s+="Your advanced HR systems should support a high-performance culture and talent development. ":s+="Consider evolving your HR systems to better support your strategic objectives. ",s}const iVe=()=>{const r=oy(),{simulation:e,updateSevenSElement:n,addTension:i,addDecision:s}=ly(),[o,a]=te.useState("visualization");if(!e.company||!e.sevenSModel)return r("/profile"),null;const l=()=>{c(),u(),r("/decisions")},c=()=>{const{sevenSModel:h}=e;h&&(h.strategy.corporateLevel==="Product Development"&&h.structure.type==="Mechanistic"&&i({elements:["Strategy","Structure"],description:"Your product development strategy requires innovation and flexibility, but your mechanistic structure may hinder creativity and rapid iteration.",severity:7,resolutionOptions:[{id:ys(),description:"Create cross-functional innovation teams that operate with different rules than the rest of the organization",impacts:[{element:"Structure",value:.1,description:"Slightly more organic structure"},{element:"Strategy",value:.2,description:"Better alignment with product development goals"}]},{id:ys(),description:"Shift to a hybrid structure with mechanistic elements for operations and organic elements for innovation",impacts:[{element:"Structure",value:.3,description:"More balanced structure"},{element:"Systems",value:-.1,description:"More complex systems to manage"}]},{id:ys(),description:"Modify strategy to focus more on incremental improvements rather than disruptive innovation",impacts:[{element:"Strategy",value:-.2,description:"Less ambitious strategy"},{element:"Structure",value:.1,description:"Better fit with current structure"}]}],resolved:!1}),h.systems.hr.performanceManagement==="Annual performance reviews"&&h.staff.changeReadiness>.7&&i({elements:["Systems","Staff"],description:"Your staff has high change readiness, but your annual performance review system doesn't provide frequent enough feedback for continuous improvement.",severity:5,resolutionOptions:[{id:ys(),description:"Implement a continuous feedback system with regular check-ins",impacts:[{element:"Systems",value:.2,description:"More responsive performance management"},{element:"Staff",value:.1,description:"Increased engagement"}]},{id:ys(),description:"Add quarterly pulse surveys while maintaining annual reviews",impacts:[{element:"Systems",value:.1,description:"Somewhat more responsive"},{element:"Staff",value:.05,description:"Slightly increased engagement"}]}],resolved:!1}))},u=()=>{const{company:h,sevenSModel:f,scenarioId:d}=e;!h||!f||(s({scenarioId:d,element:"Strategy",description:`${h.name} has an opportunity to enter a new geographical market. How should you proceed?`,options:[{id:ys(),description:"Rapid expansion with significant investment"},{id:ys(),description:"Phased approach with measured investment"},{id:ys(),description:"Partnership with local established player"}],impact:[{element:"Strategy",value:.2,description:"Rapid expansion with significant investment - Higher growth potential"},{element:"Structure",value:-.1,description:"Rapid expansion with significant investment - Organizational strain"},{element:"Systems",value:-.15,description:"Rapid expansion with significant investment - Systems overload"},{element:"Strategy",value:.1,description:"Phased approach with measured investment - Controlled growth"},{element:"Structure",value:.05,description:"Phased approach with measured investment - Manageable adaptation"},{element:"Systems",value:.05,description:"Phased approach with measured investment - Gradual systems scaling"},{element:"Strategy",value:.15,description:"Partnership with local established player - Faster market access"},{element:"Skills",value:.1,description:"Partnership with local established player - Knowledge acquisition"},{element:"Shared Values",value:-.05,description:"Partnership with local established player - Potential culture clash"}]}),s({scenarioId:d,element:"Staff",description:`The board is asking for a leadership development initiative. Which approach should ${h.name} take?`,options:[{id:ys(),description:"Executive coaching for top management only"},{id:ys(),description:"Comprehensive program for all management levels"},{id:ys(),description:"Focus on identifying and developing high-potential employees"}],impact:[{element:"Staff",value:.05,description:"Executive coaching for top management only - Limited leadership improvement"},{element:"Style",value:.1,description:"Executive coaching for top management only - More effective senior leadership"},{element:"Staff",value:.2,description:"Comprehensive program for all management levels - Broad leadership improvement"},{element:"Systems",value:.1,description:"Comprehensive program for all management levels - Better management systems"},{element:"Skills",value:.15,description:"Comprehensive program for all management levels - Enhanced management skills"},{element:"Staff",value:.1,description:"Focus on high-potential employees - Targeted improvement"},{element:"Shared Values",value:-.05,description:"Focus on high-potential employees - Potential perception of favoritism"}]}))};return N.jsx(s_,{children:N.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[N.jsxs("div",{className:"mb-8",children:[N.jsx("h1",{className:"text-3xl font-bold text-gray-900 dark:text-white",children:"7S Model Simulation"}),N.jsx("p",{className:"mt-2 text-lg text-gray-600 dark:text-gray-300",children:"Visualize and adjust your organization's 7S elements to optimize alignment."})]}),N.jsx("div",{className:"mb-6 border-b border-gray-200 dark:border-gray-700",children:N.jsxs("nav",{className:"-mb-px flex space-x-8",children:[N.jsx(QS,{active:o==="visualization",onClick:()=>a("visualization"),children:"Visualization"}),N.jsx(QS,{active:o==="strategy",onClick:()=>a("strategy"),children:"Strategy"}),N.jsx(QS,{active:o==="structure",onClick:()=>a("structure"),children:"Structure"}),N.jsx(QS,{active:o==="systems",onClick:()=>a("systems"),children:"Systems"})]})}),N.jsxs("div",{className:"space-y-6",children:[o==="visualization"&&N.jsxs(N.Fragment,{children:[N.jsxs(jr,{className:"mb-6",children:[N.jsx(Vr,{children:N.jsx(Gr,{children:"Organizational Alignment"})}),N.jsxs(Hr,{children:[N.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[N.jsxs("div",{className:"bg-blue-50 dark:bg-blue-900/20 p-4 rounded-md text-center",children:[N.jsx("div",{className:"text-sm text-blue-800 dark:text-blue-300 mb-1",children:"Strategy"}),N.jsxs("div",{className:"font-medium text-2xl text-blue-600 dark:text-blue-400",children:[(e.sevenSModel.strategy.alignmentScore*100).toFixed(0),"%"]})]}),N.jsxs("div",{className:"bg-green-50 dark:bg-green-900/20 p-4 rounded-md text-center",children:[N.jsx("div",{className:"text-sm text-green-800 dark:text-green-300 mb-1",children:"Structure"}),N.jsxs("div",{className:"font-medium text-2xl text-green-600 dark:text-green-400",children:[(e.sevenSModel.structure.alignmentScore*100).toFixed(0),"%"]})]}),N.jsxs("div",{className:"bg-amber-50 dark:bg-amber-900/20 p-4 rounded-md text-center",children:[N.jsx("div",{className:"text-sm text-amber-800 dark:text-amber-300 mb-1",children:"Systems"}),N.jsxs("div",{className:"font-medium text-2xl text-amber-600 dark:text-amber-400",children:[(e.sevenSModel.systems.alignmentScore*100).toFixed(0),"%"]})]}),N.jsxs("div",{className:"bg-purple-50 dark:bg-purple-900/20 p-4 rounded-md text-center",children:[N.jsx("div",{className:"text-sm text-purple-800 dark:text-purple-300 mb-1",children:"Shared Values"}),N.jsxs("div",{className:"font-medium text-2xl text-purple-600 dark:text-purple-400",children:[(e.sevenSModel.sharedValues.alignmentScore*100).toFixed(0),"%"]})]})]}),N.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mt-4",children:[N.jsxs("div",{className:"bg-pink-50 dark:bg-pink-900/20 p-4 rounded-md text-center",children:[N.jsx("div",{className:"text-sm text-pink-800 dark:text-pink-300 mb-1",children:"Skills"}),N.jsxs("div",{className:"font-medium text-2xl text-pink-600 dark:text-pink-400",children:[(e.sevenSModel.skills.alignmentScore*100).toFixed(0),"%"]})]}),N.jsxs("div",{className:"bg-red-50 dark:bg-red-900/20 p-4 rounded-md text-center",children:[N.jsx("div",{className:"text-sm text-red-800 dark:text-red-300 mb-1",children:"Style"}),N.jsxs("div",{className:"font-medium text-2xl text-red-600 dark:text-red-400",children:[(e.sevenSModel.style.alignmentScore*100).toFixed(0),"%"]})]}),N.jsxs("div",{className:"bg-indigo-50 dark:bg-indigo-900/20 p-4 rounded-md text-center",children:[N.jsx("div",{className:"text-sm text-indigo-800 dark:text-indigo-300 mb-1",children:"Staff"}),N.jsxs("div",{className:"font-medium text-2xl text-indigo-600 dark:text-indigo-400",children:[(e.sevenSModel.staff.alignmentScore*100).toFixed(0),"%"]})]})]})]})]}),N.jsx(Zje,{model:e.sevenSModel}),N.jsx("div",{className:"mt-6 flex justify-end",children:N.jsx(hr,{size:"lg",onClick:l,children:"Continue to Decisions"})})]}),o==="strategy"&&N.jsx(Qje,{strategy:e.sevenSModel.strategy,onUpdate:h=>n("Strategy",h)}),o==="structure"&&N.jsx(eVe,{structure:e.sevenSModel.structure,onUpdate:h=>n("Structure",h)}),o==="systems"&&N.jsx(nVe,{systems:e.sevenSModel.systems,onUpdate:h=>n("Systems",h)})]})]})})},QS=({active:r,onClick:e,children:n})=>N.jsx("button",{className:`whitespace-nowrap py-4 px-1 border-b-2 font-medium text-sm ${r?"border-blue-500 text-blue-600 dark:border-blue-500 dark:text-blue-400":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300 dark:text-gray-400 dark:hover:text-gray-200 dark:hover:border-gray-600"}`,onClick:e,children:n}),sVe=({decision:r,onMakeDecision:e})=>{var o;const[n,i]=te.useState(r.selectedOption||""),s=()=>{n&&e(r.id,n)};return N.jsxs(jr,{className:r.selectedOption?"border-green-500 dark:border-green-700":"",children:[N.jsxs(Vr,{children:[N.jsxs(Gr,{children:["Decision: ",r.element]}),N.jsxs(vK,{children:["Scenario #",r.scenarioId]})]}),N.jsxs(Hr,{children:[N.jsx("p",{className:"text-gray-700 dark:text-gray-300 mb-4",children:r.description}),r.selectedOption?N.jsxs("div",{className:"bg-green-50 dark:bg-green-900/20 p-4 rounded-md",children:[N.jsx("h4",{className:"font-medium text-green-800 dark:text-green-300 mb-2",children:"Decision Made"}),N.jsx("p",{className:"text-sm text-green-700 dark:text-green-400",children:(o=r.options.find(a=>a.id===r.selectedOption))==null?void 0:o.description}),N.jsxs("div",{className:"mt-4 space-y-2",children:[N.jsx("h4",{className:"font-medium text-green-800 dark:text-green-300",children:"Impacts"}),OH(r,r.selectedOption||"").map((a,l)=>N.jsxs("div",{className:"flex items-center text-sm",children:[N.jsx("span",{className:"w-2 h-2 rounded-full mr-2",style:{backgroundColor:Zf(a.element)}}),N.jsxs("span",{className:"font-medium",children:[a.element,":"]}),N.jsxs("span",{className:"ml-2 text-gray-600 dark:text-gray-400",children:[a.description," (",a.value>0?"+":"",a.value.toFixed(2),")"]})]},l))]})]}):N.jsxs("div",{className:"space-y-4",children:[N.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:"Options"}),N.jsxs(Ii,{value:n,onChange:a=>i(a.target.value),disabled:!!r.selectedOption,children:[N.jsx("option",{value:"",children:"Select an option..."}),r.options.map(a=>N.jsx("option",{value:a.id,children:a.description},a.id))]}),n&&N.jsxs("div",{className:"mt-4 space-y-2",children:[N.jsx("h4",{className:"font-medium text-gray-800 dark:text-white",children:"Potential Impacts"}),OH(r,n).map((a,l)=>N.jsxs("div",{className:"flex items-center text-sm",children:[N.jsx("span",{className:"w-2 h-2 rounded-full mr-2",style:{backgroundColor:Zf(a.element)}}),N.jsxs("span",{className:"font-medium",children:[a.element,":"]}),N.jsxs("span",{className:"ml-2 text-gray-600 dark:text-gray-400",children:[a.description," (",a.value>0?"+":"",a.value.toFixed(2),")"]})]},l))]})]})]}),!r.selectedOption&&N.jsx(a_,{children:N.jsx(hr,{onClick:s,disabled:!n||!!r.selectedOption,children:"Make Decision"})})]})};function OH(r,e){const n=r.options.find(i=>i.id===e);return n?r.impact.filter(i=>i.description.includes(n.description)):[]}const oVe=({tension:r,onResolve:e})=>{var o;const[n,i]=te.useState(""),s=()=>{n&&e(r.id,n)};return N.jsxs(jr,{className:r.resolved?"border-green-500 dark:border-green-700":"border-amber-500 dark:border-amber-700",children:[N.jsxs(Vr,{className:r.resolved?"bg-green-50 dark:bg-green-900/20":"bg-amber-50 dark:bg-amber-900/20",children:[N.jsxs(Gr,{className:"flex items-center",children:[N.jsx("span",{className:"w-3 h-3 rounded-full mr-2",style:{backgroundColor:Zf(r.elements[0])}}),r.elements[0],N.jsx("span",{className:"mx-2",children:""}),N.jsx("span",{className:"w-3 h-3 rounded-full mr-2",style:{backgroundColor:Zf(r.elements[1])}}),r.elements[1]]}),N.jsx(vK,{children:r.resolved?"Resolved Tension":`Severity: ${r.severity}/10`})]}),N.jsxs(Hr,{className:"pt-4",children:[N.jsx("p",{className:"text-gray-700 dark:text-gray-300 mb-4",children:r.description}),r.resolved?N.jsxs("div",{className:"bg-green-50 dark:bg-green-900/20 p-4 rounded-md",children:[N.jsx("h4",{className:"font-medium text-green-800 dark:text-green-300 mb-2",children:"Resolution Applied"}),N.jsx("p",{className:"text-sm text-green-700 dark:text-green-400",children:((o=r.resolutionOptions.find(a=>a.id===n))==null?void 0:o.description)||"This tension has been successfully resolved."})]}):N.jsxs("div",{className:"space-y-4",children:[N.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:"Resolution Options"}),N.jsxs(Ii,{value:n,onChange:a=>i(a.target.value),disabled:r.resolved,children:[N.jsx("option",{value:"",children:"Select an option..."}),r.resolutionOptions.map(a=>N.jsx("option",{value:a.id,children:a.description},a.id))]}),n&&N.jsxs("div",{className:"mt-4 space-y-2",children:[N.jsx("h4",{className:"font-medium text-gray-800 dark:text-white",children:"Potential Impacts"}),aVe(r.resolutionOptions,n).map((a,l)=>N.jsxs("div",{className:"flex items-center text-sm",children:[N.jsx("span",{className:"w-2 h-2 rounded-full mr-2",style:{backgroundColor:Zf(a.element)}}),N.jsxs("span",{className:"font-medium",children:[a.element,":"]}),N.jsxs("span",{className:"ml-2 text-gray-600 dark:text-gray-400",children:[a.description," (",a.value>0?"+":"",a.value.toFixed(2),")"]})]},l))]})]})]}),!r.resolved&&N.jsx(a_,{children:N.jsx(hr,{onClick:s,disabled:!n||r.resolved,children:"Apply Resolution"})})]})};function aVe(r,e){const n=r.find(i=>i.id===e);return n?n.impacts:[]}const lVe=()=>{const r=oy(),{simulation:e,makeDecision:n,resolveTension:i,updateKPI:s}=ly();if(!e.company||!e.sevenSModel)return r("/profile"),null;const o=(u,h)=>{var d;n(u,h),(((d=e.company)==null?void 0:d.kpis)||[]).forEach(p=>{var v;const m=((v=e.kpiTracker.find(y=>y.name===p.name))==null?void 0:v.history.slice(-1)[0].value)||p.current,g=(Math.random()*.2-.1)*m;s(p.name,m+g)})},a=(u,h)=>{i(u,h)},l=e.decisions.every(u=>u.selectedOption),c=e.tensions.every(u=>u.resolved);return N.jsx(s_,{children:N.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[N.jsxs("div",{className:"mb-8",children:[N.jsx("h1",{className:"text-3xl font-bold text-gray-900 dark:text-white",children:"Strategic Decisions"}),N.jsx("p",{className:"mt-2 text-lg text-gray-600 dark:text-gray-300",children:"Make strategic choices and resolve organizational tensions."})]}),e.decisions.length>0&&N.jsxs(N.Fragment,{children:[N.jsx("h2",{className:"text-xl font-semibold text-gray-800 dark:text-white mb-4",children:"Pending Decisions"}),N.jsx("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6 mb-8",children:e.decisions.map(u=>N.jsx(sVe,{decision:u,onMakeDecision:o},u.id))})]}),e.tensions.length>0&&N.jsxs(N.Fragment,{children:[N.jsx("h2",{className:"text-xl font-semibold text-gray-800 dark:text-white mb-4 mt-8",children:"Organizational Tensions"}),N.jsx("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6 mb-8",children:e.tensions.map(u=>N.jsx(oVe,{tension:u,onResolve:a},u.id))})]}),N.jsx("div",{className:"mt-8 flex justify-end",children:N.jsx(hr,{size:"lg",onClick:()=>r("/results"),disabled:!l||!c,children:"View Results"})}),(!l||!c)&&N.jsx("p",{className:"text-amber-600 dark:text-amber-400 text-sm mt-2 text-right",children:"Please address all decisions and tensions before viewing results."})]})})};var cVe=Array.isArray,co=cVe,uVe=typeof Y_=="object"&&Y_&&Y_.Object===Object&&Y_,_te=uVe,hVe=_te,fVe=typeof self=="object"&&self&&self.Object===Object&&self,dVe=hVe||fVe||Function("return this")(),ql=dVe,pVe=ql,mVe=pVe.Symbol,D_=mVe,DH=D_,wte=Object.prototype,gVe=wte.hasOwnProperty,yVe=wte.toString,Gv=DH?DH.toStringTag:void 0;function vVe(r){var e=gVe.call(r,Gv),n=r[Gv];try{r[Gv]=void 0;var i=!0}catch{}var s=yVe.call(r);return i&&(e?r[Gv]=n:delete r[Gv]),s}var xVe=vVe,bVe=Object.prototype,_Ve=bVe.toString;function wVe(r){return _Ve.call(r)}var SVe=wVe,kH=D_,TVe=xVe,EVe=SVe,MVe="[object Null]",AVe="[object Undefined]",IH=kH?kH.toStringTag:void 0;function CVe(r){return r==null?r===void 0?AVe:MVe:IH&&IH in Object(r)?TVe(r):EVe(r)}var _u=CVe;function PVe(r){return r!=null&&typeof r=="object"}var wu=PVe,RVe=_u,NVe=wu,OVe="[object Symbol]";function DVe(r){return typeof r=="symbol"||NVe(r)&&RVe(r)==OVe}var My=DVe,kVe=co,IVe=My,LVe=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,FVe=/^\w*$/;function BVe(r,e){if(kVe(r))return!1;var n=typeof r;return n=="number"||n=="symbol"||n=="boolean"||r==null||IVe(r)?!0:FVe.test(r)||!LVe.test(r)||e!=null&&r in Object(e)}var pB=BVe;function UVe(r){var e=typeof r;return r!=null&&(e=="object"||e=="function")}var Zh=UVe;const Ay=hn(Zh);var zVe=_u,$Ve=Zh,jVe="[object AsyncFunction]",VVe="[object Function]",GVe="[object GeneratorFunction]",HVe="[object Proxy]";function WVe(r){if(!$Ve(r))return!1;var e=zVe(r);return e==VVe||e==GVe||e==jVe||e==HVe}var mB=WVe;const Ut=hn(mB);var qVe=ql,XVe=qVe["__core-js_shared__"],KVe=XVe,WN=KVe,LH=function(){var r=/[^.]+$/.exec(WN&&WN.keys&&WN.keys.IE_PROTO||"");return r?"Symbol(src)_1."+r:""}();function YVe(r){return!!LH&&LH in r}var ZVe=YVe,QVe=Function.prototype,JVe=QVe.toString;function e4e(r){if(r!=null){try{return JVe.call(r)}catch{}try{return r+""}catch{}}return""}var Ste=e4e,t4e=mB,n4e=ZVe,r4e=Zh,i4e=Ste,s4e=/[\\^$.*+?()[\]{}|]/g,o4e=/^\[object .+?Constructor\]$/,a4e=Function.prototype,l4e=Object.prototype,c4e=a4e.toString,u4e=l4e.hasOwnProperty,h4e=RegExp("^"+c4e.call(u4e).replace(s4e,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function f4e(r){if(!r4e(r)||n4e(r))return!1;var e=t4e(r)?h4e:o4e;return e.test(i4e(r))}var d4e=f4e;function p4e(r,e){return r==null?void 0:r[e]}var m4e=p4e,g4e=d4e,y4e=m4e;function v4e(r,e){var n=y4e(r,e);return g4e(n)?n:void 0}var Fd=v4e,x4e=Fd,b4e=x4e(Object,"create"),IA=b4e,FH=IA;function _4e(){this.__data__=FH?FH(null):{},this.size=0}var w4e=_4e;function S4e(r){var e=this.has(r)&&delete this.__data__[r];return this.size-=e?1:0,e}var T4e=S4e,E4e=IA,M4e="__lodash_hash_undefined__",A4e=Object.prototype,C4e=A4e.hasOwnProperty;function P4e(r){var e=this.__data__;if(E4e){var n=e[r];return n===M4e?void 0:n}return C4e.call(e,r)?e[r]:void 0}var R4e=P4e,N4e=IA,O4e=Object.prototype,D4e=O4e.hasOwnProperty;function k4e(r){var e=this.__data__;return N4e?e[r]!==void 0:D4e.call(e,r)}var I4e=k4e,L4e=IA,F4e="__lodash_hash_undefined__";function B4e(r,e){var n=this.__data__;return this.size+=this.has(r)?0:1,n[r]=L4e&&e===void 0?F4e:e,this}var U4e=B4e,z4e=w4e,$4e=T4e,j4e=R4e,V4e=I4e,G4e=U4e;function Cy(r){var e=-1,n=r==null?0:r.length;for(this.clear();++e<n;){var i=r[e];this.set(i[0],i[1])}}Cy.prototype.clear=z4e;Cy.prototype.delete=$4e;Cy.prototype.get=j4e;Cy.prototype.has=V4e;Cy.prototype.set=G4e;var H4e=Cy;function W4e(){this.__data__=[],this.size=0}var q4e=W4e;function X4e(r,e){return r===e||r!==r&&e!==e}var gB=X4e,K4e=gB;function Y4e(r,e){for(var n=r.length;n--;)if(K4e(r[n][0],e))return n;return-1}var LA=Y4e,Z4e=LA,Q4e=Array.prototype,J4e=Q4e.splice;function eGe(r){var e=this.__data__,n=Z4e(e,r);if(n<0)return!1;var i=e.length-1;return n==i?e.pop():J4e.call(e,n,1),--this.size,!0}var tGe=eGe,nGe=LA;function rGe(r){var e=this.__data__,n=nGe(e,r);return n<0?void 0:e[n][1]}var iGe=rGe,sGe=LA;function oGe(r){return sGe(this.__data__,r)>-1}var aGe=oGe,lGe=LA;function cGe(r,e){var n=this.__data__,i=lGe(n,r);return i<0?(++this.size,n.push([r,e])):n[i][1]=e,this}var uGe=cGe,hGe=q4e,fGe=tGe,dGe=iGe,pGe=aGe,mGe=uGe;function Py(r){var e=-1,n=r==null?0:r.length;for(this.clear();++e<n;){var i=r[e];this.set(i[0],i[1])}}Py.prototype.clear=hGe;Py.prototype.delete=fGe;Py.prototype.get=dGe;Py.prototype.has=pGe;Py.prototype.set=mGe;var FA=Py,gGe=Fd,yGe=ql,vGe=gGe(yGe,"Map"),yB=vGe,BH=H4e,xGe=FA,bGe=yB;function _Ge(){this.size=0,this.__data__={hash:new BH,map:new(bGe||xGe),string:new BH}}var wGe=_Ge;function SGe(r){var e=typeof r;return e=="string"||e=="number"||e=="symbol"||e=="boolean"?r!=="__proto__":r===null}var TGe=SGe,EGe=TGe;function MGe(r,e){var n=r.__data__;return EGe(e)?n[typeof e=="string"?"string":"hash"]:n.map}var BA=MGe,AGe=BA;function CGe(r){var e=AGe(this,r).delete(r);return this.size-=e?1:0,e}var PGe=CGe,RGe=BA;function NGe(r){return RGe(this,r).get(r)}var OGe=NGe,DGe=BA;function kGe(r){return DGe(this,r).has(r)}var IGe=kGe,LGe=BA;function FGe(r,e){var n=LGe(this,r),i=n.size;return n.set(r,e),this.size+=n.size==i?0:1,this}var BGe=FGe,UGe=wGe,zGe=PGe,$Ge=OGe,jGe=IGe,VGe=BGe;function Ry(r){var e=-1,n=r==null?0:r.length;for(this.clear();++e<n;){var i=r[e];this.set(i[0],i[1])}}Ry.prototype.clear=UGe;Ry.prototype.delete=zGe;Ry.prototype.get=$Ge;Ry.prototype.has=jGe;Ry.prototype.set=VGe;var vB=Ry,Tte=vB,GGe="Expected a function";function xB(r,e){if(typeof r!="function"||e!=null&&typeof e!="function")throw new TypeError(GGe);var n=function(){var i=arguments,s=e?e.apply(this,i):i[0],o=n.cache;if(o.has(s))return o.get(s);var a=r.apply(this,i);return n.cache=o.set(s,a)||o,a};return n.cache=new(xB.Cache||Tte),n}xB.Cache=Tte;var Ete=xB;const HGe=hn(Ete);var WGe=Ete,qGe=500;function XGe(r){var e=WGe(r,function(i){return n.size===qGe&&n.clear(),i}),n=e.cache;return e}var KGe=XGe,YGe=KGe,ZGe=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,QGe=/\\(\\)?/g,JGe=YGe(function(r){var e=[];return r.charCodeAt(0)===46&&e.push(""),r.replace(ZGe,function(n,i,s,o){e.push(s?o.replace(QGe,"$1"):i||n)}),e}),e5e=JGe;function t5e(r,e){for(var n=-1,i=r==null?0:r.length,s=Array(i);++n<i;)s[n]=e(r[n],n,r);return s}var bB=t5e,UH=D_,n5e=bB,r5e=co,i5e=My,s5e=1/0,zH=UH?UH.prototype:void 0,$H=zH?zH.toString:void 0;function Mte(r){if(typeof r=="string")return r;if(r5e(r))return n5e(r,Mte)+"";if(i5e(r))return $H?$H.call(r):"";var e=r+"";return e=="0"&&1/r==-s5e?"-0":e}var o5e=Mte,a5e=o5e;function l5e(r){return r==null?"":a5e(r)}var Ate=l5e,c5e=co,u5e=pB,h5e=e5e,f5e=Ate;function d5e(r,e){return c5e(r)?r:u5e(r,e)?[r]:h5e(f5e(r))}var Cte=d5e,p5e=My,m5e=1/0;function g5e(r){if(typeof r=="string"||p5e(r))return r;var e=r+"";return e=="0"&&1/r==-m5e?"-0":e}var UA=g5e,y5e=Cte,v5e=UA;function x5e(r,e){e=y5e(e,r);for(var n=0,i=e.length;r!=null&&n<i;)r=r[v5e(e[n++])];return n&&n==i?r:void 0}var _B=x5e,b5e=_B;function _5e(r,e,n){var i=r==null?void 0:b5e(r,e);return i===void 0?n:i}var Pte=_5e;const ca=hn(Pte);function w5e(r){return r==null}var S5e=w5e;const nn=hn(S5e);var T5e=_u,E5e=co,M5e=wu,A5e="[object String]";function C5e(r){return typeof r=="string"||!E5e(r)&&M5e(r)&&T5e(r)==A5e}var P5e=C5e;const Sd=hn(P5e);var Rte={exports:{}},An={};/**
 * @license React
 * react-is.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var wB=Symbol.for("react.element"),SB=Symbol.for("react.portal"),zA=Symbol.for("react.fragment"),$A=Symbol.for("react.strict_mode"),jA=Symbol.for("react.profiler"),VA=Symbol.for("react.provider"),GA=Symbol.for("react.context"),R5e=Symbol.for("react.server_context"),HA=Symbol.for("react.forward_ref"),WA=Symbol.for("react.suspense"),qA=Symbol.for("react.suspense_list"),XA=Symbol.for("react.memo"),KA=Symbol.for("react.lazy"),N5e=Symbol.for("react.offscreen"),Nte;Nte=Symbol.for("react.module.reference");function ga(r){if(typeof r=="object"&&r!==null){var e=r.$$typeof;switch(e){case wB:switch(r=r.type,r){case zA:case jA:case $A:case WA:case qA:return r;default:switch(r=r&&r.$$typeof,r){case R5e:case GA:case HA:case KA:case XA:case VA:return r;default:return e}}case SB:return e}}}An.ContextConsumer=GA;An.ContextProvider=VA;An.Element=wB;An.ForwardRef=HA;An.Fragment=zA;An.Lazy=KA;An.Memo=XA;An.Portal=SB;An.Profiler=jA;An.StrictMode=$A;An.Suspense=WA;An.SuspenseList=qA;An.isAsyncMode=function(){return!1};An.isConcurrentMode=function(){return!1};An.isContextConsumer=function(r){return ga(r)===GA};An.isContextProvider=function(r){return ga(r)===VA};An.isElement=function(r){return typeof r=="object"&&r!==null&&r.$$typeof===wB};An.isForwardRef=function(r){return ga(r)===HA};An.isFragment=function(r){return ga(r)===zA};An.isLazy=function(r){return ga(r)===KA};An.isMemo=function(r){return ga(r)===XA};An.isPortal=function(r){return ga(r)===SB};An.isProfiler=function(r){return ga(r)===jA};An.isStrictMode=function(r){return ga(r)===$A};An.isSuspense=function(r){return ga(r)===WA};An.isSuspenseList=function(r){return ga(r)===qA};An.isValidElementType=function(r){return typeof r=="string"||typeof r=="function"||r===zA||r===jA||r===$A||r===WA||r===qA||r===N5e||typeof r=="object"&&r!==null&&(r.$$typeof===KA||r.$$typeof===XA||r.$$typeof===VA||r.$$typeof===GA||r.$$typeof===HA||r.$$typeof===Nte||r.getModuleId!==void 0)};An.typeOf=ga;Rte.exports=An;var O5e=Rte.exports,D5e=_u,k5e=wu,I5e="[object Number]";function L5e(r){return typeof r=="number"||k5e(r)&&D5e(r)==I5e}var Ote=L5e;const F5e=hn(Ote);var B5e=Ote;function U5e(r){return B5e(r)&&r!=+r}var z5e=U5e;const k_=hn(z5e);var Ka=function(e){return e===0?0:e>0?1:-1},qf=function(e){return Sd(e)&&e.indexOf("%")===e.length-1},We=function(e){return F5e(e)&&!k_(e)},ci=function(e){return We(e)||Sd(e)},$5e=0,I_=function(e){var n=++$5e;return"".concat(e||"").concat(n)},Ya=function(e,n){var i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,s=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;if(!We(e)&&!Sd(e))return i;var o;if(qf(e)){var a=e.indexOf("%");o=n*parseFloat(e.slice(0,a))/100}else o=+e;return k_(o)&&(o=i),s&&o>n&&(o=n),o},nh=function(e){if(!e)return null;var n=Object.keys(e);return n&&n.length?e[n[0]]:null},j5e=function(e){if(!Array.isArray(e))return!1;for(var n=e.length,i={},s=0;s<n;s++)if(!i[e[s]])i[e[s]]=!0;else return!0;return!1},Ts=function(e,n){return We(e)&&We(n)?function(i){return e+i*(n-e)}:function(){return n}};function wE(r,e,n){return!r||!r.length?null:r.find(function(i){return i&&(typeof e=="function"?e(i):ca(i,e))===n})}var V5e=function(e,n){return We(e)&&We(n)?e-n:Sd(e)&&Sd(n)?e.localeCompare(n):e instanceof Date&&n instanceof Date?e.getTime()-n.getTime():String(e).localeCompare(String(n))};function zm(r,e){for(var n in r)if({}.hasOwnProperty.call(r,n)&&(!{}.hasOwnProperty.call(e,n)||r[n]!==e[n]))return!1;for(var i in e)if({}.hasOwnProperty.call(e,i)&&!{}.hasOwnProperty.call(r,i))return!1;return!0}function HD(r){"@babel/helpers - typeof";return HD=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},HD(r)}var G5e=["viewBox","children"],H5e=["aria-activedescendant","aria-atomic","aria-autocomplete","aria-busy","aria-checked","aria-colcount","aria-colindex","aria-colspan","aria-controls","aria-current","aria-describedby","aria-details","aria-disabled","aria-errormessage","aria-expanded","aria-flowto","aria-haspopup","aria-hidden","aria-invalid","aria-keyshortcuts","aria-label","aria-labelledby","aria-level","aria-live","aria-modal","aria-multiline","aria-multiselectable","aria-orientation","aria-owns","aria-placeholder","aria-posinset","aria-pressed","aria-readonly","aria-relevant","aria-required","aria-roledescription","aria-rowcount","aria-rowindex","aria-rowspan","aria-selected","aria-setsize","aria-sort","aria-valuemax","aria-valuemin","aria-valuenow","aria-valuetext","className","color","height","id","lang","max","media","method","min","name","style","target","width","role","tabIndex","accentHeight","accumulate","additive","alignmentBaseline","allowReorder","alphabetic","amplitude","arabicForm","ascent","attributeName","attributeType","autoReverse","azimuth","baseFrequency","baselineShift","baseProfile","bbox","begin","bias","by","calcMode","capHeight","clip","clipPath","clipPathUnits","clipRule","colorInterpolation","colorInterpolationFilters","colorProfile","colorRendering","contentScriptType","contentStyleType","cursor","cx","cy","d","decelerate","descent","diffuseConstant","direction","display","divisor","dominantBaseline","dur","dx","dy","edgeMode","elevation","enableBackground","end","exponent","externalResourcesRequired","fill","fillOpacity","fillRule","filter","filterRes","filterUnits","floodColor","floodOpacity","focusable","fontFamily","fontSize","fontSizeAdjust","fontStretch","fontStyle","fontVariant","fontWeight","format","from","fx","fy","g1","g2","glyphName","glyphOrientationHorizontal","glyphOrientationVertical","glyphRef","gradientTransform","gradientUnits","hanging","horizAdvX","horizOriginX","href","ideographic","imageRendering","in2","in","intercept","k1","k2","k3","k4","k","kernelMatrix","kernelUnitLength","kerning","keyPoints","keySplines","keyTimes","lengthAdjust","letterSpacing","lightingColor","limitingConeAngle","local","markerEnd","markerHeight","markerMid","markerStart","markerUnits","markerWidth","mask","maskContentUnits","maskUnits","mathematical","mode","numOctaves","offset","opacity","operator","order","orient","orientation","origin","overflow","overlinePosition","overlineThickness","paintOrder","panose1","pathLength","patternContentUnits","patternTransform","patternUnits","pointerEvents","pointsAtX","pointsAtY","pointsAtZ","preserveAlpha","preserveAspectRatio","primitiveUnits","r","radius","refX","refY","renderingIntent","repeatCount","repeatDur","requiredExtensions","requiredFeatures","restart","result","rotate","rx","ry","seed","shapeRendering","slope","spacing","specularConstant","specularExponent","speed","spreadMethod","startOffset","stdDeviation","stemh","stemv","stitchTiles","stopColor","stopOpacity","strikethroughPosition","strikethroughThickness","string","stroke","strokeDasharray","strokeDashoffset","strokeLinecap","strokeLinejoin","strokeMiterlimit","strokeOpacity","strokeWidth","surfaceScale","systemLanguage","tableValues","targetX","targetY","textAnchor","textDecoration","textLength","textRendering","to","transform","u1","u2","underlinePosition","underlineThickness","unicode","unicodeBidi","unicodeRange","unitsPerEm","vAlphabetic","values","vectorEffect","version","vertAdvY","vertOriginX","vertOriginY","vHanging","vIdeographic","viewTarget","visibility","vMathematical","widths","wordSpacing","writingMode","x1","x2","x","xChannelSelector","xHeight","xlinkActuate","xlinkArcrole","xlinkHref","xlinkRole","xlinkShow","xlinkTitle","xlinkType","xmlBase","xmlLang","xmlns","xmlnsXlink","xmlSpace","y1","y2","y","yChannelSelector","z","zoomAndPan","ref","key","angle"],jH=["points","pathLength"],qN={svg:G5e,polygon:jH,polyline:jH},TB=["dangerouslySetInnerHTML","onCopy","onCopyCapture","onCut","onCutCapture","onPaste","onPasteCapture","onCompositionEnd","onCompositionEndCapture","onCompositionStart","onCompositionStartCapture","onCompositionUpdate","onCompositionUpdateCapture","onFocus","onFocusCapture","onBlur","onBlurCapture","onChange","onChangeCapture","onBeforeInput","onBeforeInputCapture","onInput","onInputCapture","onReset","onResetCapture","onSubmit","onSubmitCapture","onInvalid","onInvalidCapture","onLoad","onLoadCapture","onError","onErrorCapture","onKeyDown","onKeyDownCapture","onKeyPress","onKeyPressCapture","onKeyUp","onKeyUpCapture","onAbort","onAbortCapture","onCanPlay","onCanPlayCapture","onCanPlayThrough","onCanPlayThroughCapture","onDurationChange","onDurationChangeCapture","onEmptied","onEmptiedCapture","onEncrypted","onEncryptedCapture","onEnded","onEndedCapture","onLoadedData","onLoadedDataCapture","onLoadedMetadata","onLoadedMetadataCapture","onLoadStart","onLoadStartCapture","onPause","onPauseCapture","onPlay","onPlayCapture","onPlaying","onPlayingCapture","onProgress","onProgressCapture","onRateChange","onRateChangeCapture","onSeeked","onSeekedCapture","onSeeking","onSeekingCapture","onStalled","onStalledCapture","onSuspend","onSuspendCapture","onTimeUpdate","onTimeUpdateCapture","onVolumeChange","onVolumeChangeCapture","onWaiting","onWaitingCapture","onAuxClick","onAuxClickCapture","onClick","onClickCapture","onContextMenu","onContextMenuCapture","onDoubleClick","onDoubleClickCapture","onDrag","onDragCapture","onDragEnd","onDragEndCapture","onDragEnter","onDragEnterCapture","onDragExit","onDragExitCapture","onDragLeave","onDragLeaveCapture","onDragOver","onDragOverCapture","onDragStart","onDragStartCapture","onDrop","onDropCapture","onMouseDown","onMouseDownCapture","onMouseEnter","onMouseLeave","onMouseMove","onMouseMoveCapture","onMouseOut","onMouseOutCapture","onMouseOver","onMouseOverCapture","onMouseUp","onMouseUpCapture","onSelect","onSelectCapture","onTouchCancel","onTouchCancelCapture","onTouchEnd","onTouchEndCapture","onTouchMove","onTouchMoveCapture","onTouchStart","onTouchStartCapture","onPointerDown","onPointerDownCapture","onPointerMove","onPointerMoveCapture","onPointerUp","onPointerUpCapture","onPointerCancel","onPointerCancelCapture","onPointerEnter","onPointerEnterCapture","onPointerLeave","onPointerLeaveCapture","onPointerOver","onPointerOverCapture","onPointerOut","onPointerOutCapture","onGotPointerCapture","onGotPointerCaptureCapture","onLostPointerCapture","onLostPointerCaptureCapture","onScroll","onScrollCapture","onWheel","onWheelCapture","onAnimationStart","onAnimationStartCapture","onAnimationEnd","onAnimationEndCapture","onAnimationIteration","onAnimationIterationCapture","onTransitionEnd","onTransitionEndCapture"],SE=function(e,n){if(!e||typeof e=="function"||typeof e=="boolean")return null;var i=e;if(te.isValidElement(e)&&(i=e.props),!Ay(i))return null;var s={};return Object.keys(i).forEach(function(o){TB.includes(o)&&(s[o]=n||function(a){return i[o](i,a)})}),s},W5e=function(e,n,i){return function(s){return e(n,i,s),null}},Rg=function(e,n,i){if(!Ay(e)||HD(e)!=="object")return null;var s=null;return Object.keys(e).forEach(function(o){var a=e[o];TB.includes(o)&&typeof a=="function"&&(s||(s={}),s[o]=W5e(a,n,i))}),s},q5e=["children"],X5e=["children"];function VH(r,e){if(r==null)return{};var n=K5e(r,e),i,s;if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(r);for(s=0;s<o.length;s++)i=o[s],!(e.indexOf(i)>=0)&&Object.prototype.propertyIsEnumerable.call(r,i)&&(n[i]=r[i])}return n}function K5e(r,e){if(r==null)return{};var n={};for(var i in r)if(Object.prototype.hasOwnProperty.call(r,i)){if(e.indexOf(i)>=0)continue;n[i]=r[i]}return n}function WD(r){"@babel/helpers - typeof";return WD=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},WD(r)}var GH={click:"onClick",mousedown:"onMouseDown",mouseup:"onMouseUp",mouseover:"onMouseOver",mousemove:"onMouseMove",mouseout:"onMouseOut",mouseenter:"onMouseEnter",mouseleave:"onMouseLeave",touchcancel:"onTouchCancel",touchend:"onTouchEnd",touchmove:"onTouchMove",touchstart:"onTouchStart",contextmenu:"onContextMenu",dblclick:"onDoubleClick"},Yc=function(e){return typeof e=="string"?e:e?e.displayName||e.name||"Component":""},HH=null,XN=null,EB=function r(e){if(e===HH&&Array.isArray(XN))return XN;var n=[];return te.Children.forEach(e,function(i){nn(i)||(O5e.isFragment(i)?n=n.concat(r(i.props.children)):n.push(i))}),XN=n,HH=e,n};function ua(r,e){var n=[],i=[];return Array.isArray(e)?i=e.map(function(s){return Yc(s)}):i=[Yc(e)],EB(r).forEach(function(s){var o=ca(s,"type.displayName")||ca(s,"type.name");i.indexOf(o)!==-1&&n.push(s)}),n}function So(r,e){var n=ua(r,e);return n&&n[0]}var WH=function(e){if(!e||!e.props)return!1;var n=e.props,i=n.width,s=n.height;return!(!We(i)||i<=0||!We(s)||s<=0)},Y5e=["a","altGlyph","altGlyphDef","altGlyphItem","animate","animateColor","animateMotion","animateTransform","circle","clipPath","color-profile","cursor","defs","desc","ellipse","feBlend","feColormatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence","filter","font","font-face","font-face-format","font-face-name","font-face-url","foreignObject","g","glyph","glyphRef","hkern","image","line","lineGradient","marker","mask","metadata","missing-glyph","mpath","path","pattern","polygon","polyline","radialGradient","rect","script","set","stop","style","svg","switch","symbol","text","textPath","title","tref","tspan","use","view","vkern"],Z5e=function(e){return e&&e.type&&Sd(e.type)&&Y5e.indexOf(e.type)>=0},Q5e=function(e){return e&&WD(e)==="object"&&"clipDot"in e},J5e=function(e,n,i,s){var o,a=(o=qN==null?void 0:qN[s])!==null&&o!==void 0?o:[];return n.startsWith("data-")||!Ut(e)&&(s&&a.includes(n)||H5e.includes(n))||i&&TB.includes(n)},Tt=function(e,n,i){if(!e||typeof e=="function"||typeof e=="boolean")return null;var s=e;if(te.isValidElement(e)&&(s=e.props),!Ay(s))return null;var o={};return Object.keys(s).forEach(function(a){var l;J5e((l=s)===null||l===void 0?void 0:l[a],a,n,i)&&(o[a]=s[a])}),o},qD=function r(e,n){if(e===n)return!0;var i=te.Children.count(e);if(i!==te.Children.count(n))return!1;if(i===0)return!0;if(i===1)return qH(Array.isArray(e)?e[0]:e,Array.isArray(n)?n[0]:n);for(var s=0;s<i;s++){var o=e[s],a=n[s];if(Array.isArray(o)||Array.isArray(a)){if(!r(o,a))return!1}else if(!qH(o,a))return!1}return!0},qH=function(e,n){if(nn(e)&&nn(n))return!0;if(!nn(e)&&!nn(n)){var i=e.props||{},s=i.children,o=VH(i,q5e),a=n.props||{},l=a.children,c=VH(a,X5e);return s&&l?zm(o,c)&&qD(s,l):!s&&!l?zm(o,c):!1}return!1},XH=function(e,n){var i=[],s={};return EB(e).forEach(function(o,a){if(Z5e(o))i.push(o);else if(o){var l=Yc(o.type),c=n[l]||{},u=c.handler,h=c.once;if(u&&(!h||!s[l])){var f=u(o,l,a);i.push(f),s[l]=!0}}}),i},eHe=function(e){var n=e&&e.type;return n&&GH[n]?GH[n]:null},tHe=function(e,n){return EB(n).indexOf(e)},nHe=["children","width","height","viewBox","className","style","title","desc"];function XD(){return XD=Object.assign?Object.assign.bind():function(r){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(r[i]=n[i])}return r},XD.apply(this,arguments)}function rHe(r,e){if(r==null)return{};var n=iHe(r,e),i,s;if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(r);for(s=0;s<o.length;s++)i=o[s],!(e.indexOf(i)>=0)&&Object.prototype.propertyIsEnumerable.call(r,i)&&(n[i]=r[i])}return n}function iHe(r,e){if(r==null)return{};var n={};for(var i in r)if(Object.prototype.hasOwnProperty.call(r,i)){if(e.indexOf(i)>=0)continue;n[i]=r[i]}return n}function KD(r){var e=r.children,n=r.width,i=r.height,s=r.viewBox,o=r.className,a=r.style,l=r.title,c=r.desc,u=rHe(r,nHe),h=s||{width:n,height:i,x:0,y:0},f=qt("recharts-surface",o);return Z.createElement("svg",XD({},Tt(u,!0,"svg"),{className:f,width:n,height:i,style:a,viewBox:"".concat(h.x," ").concat(h.y," ").concat(h.width," ").concat(h.height)}),Z.createElement("title",null,l),Z.createElement("desc",null,c),e)}var sHe=["children","className"];function YD(){return YD=Object.assign?Object.assign.bind():function(r){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(r[i]=n[i])}return r},YD.apply(this,arguments)}function oHe(r,e){if(r==null)return{};var n=aHe(r,e),i,s;if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(r);for(s=0;s<o.length;s++)i=o[s],!(e.indexOf(i)>=0)&&Object.prototype.propertyIsEnumerable.call(r,i)&&(n[i]=r[i])}return n}function aHe(r,e){if(r==null)return{};var n={};for(var i in r)if(Object.prototype.hasOwnProperty.call(r,i)){if(e.indexOf(i)>=0)continue;n[i]=r[i]}return n}var Sn=Z.forwardRef(function(r,e){var n=r.children,i=r.className,s=oHe(r,sHe),o=qt("recharts-layer",i);return Z.createElement("g",YD({className:o},Tt(s,!0),{ref:e}),n)}),Zc=function(e,n){for(var i=arguments.length,s=new Array(i>2?i-2:0),o=2;o<i;o++)s[o-2]=arguments[o]};function lHe(r,e,n){var i=-1,s=r.length;e<0&&(e=-e>s?0:s+e),n=n>s?s:n,n<0&&(n+=s),s=e>n?0:n-e>>>0,e>>>=0;for(var o=Array(s);++i<s;)o[i]=r[i+e];return o}var cHe=lHe,uHe=cHe;function hHe(r,e,n){var i=r.length;return n=n===void 0?i:n,!e&&n>=i?r:uHe(r,e,n)}var fHe=hHe,dHe="\\ud800-\\udfff",pHe="\\u0300-\\u036f",mHe="\\ufe20-\\ufe2f",gHe="\\u20d0-\\u20ff",yHe=pHe+mHe+gHe,vHe="\\ufe0e\\ufe0f",xHe="\\u200d",bHe=RegExp("["+xHe+dHe+yHe+vHe+"]");function _He(r){return bHe.test(r)}var Dte=_He;function wHe(r){return r.split("")}var SHe=wHe,kte="\\ud800-\\udfff",THe="\\u0300-\\u036f",EHe="\\ufe20-\\ufe2f",MHe="\\u20d0-\\u20ff",AHe=THe+EHe+MHe,CHe="\\ufe0e\\ufe0f",PHe="["+kte+"]",ZD="["+AHe+"]",QD="\\ud83c[\\udffb-\\udfff]",RHe="(?:"+ZD+"|"+QD+")",Ite="[^"+kte+"]",Lte="(?:\\ud83c[\\udde6-\\uddff]){2}",Fte="[\\ud800-\\udbff][\\udc00-\\udfff]",NHe="\\u200d",Bte=RHe+"?",Ute="["+CHe+"]?",OHe="(?:"+NHe+"(?:"+[Ite,Lte,Fte].join("|")+")"+Ute+Bte+")*",DHe=Ute+Bte+OHe,kHe="(?:"+[Ite+ZD+"?",ZD,Lte,Fte,PHe].join("|")+")",IHe=RegExp(QD+"(?="+QD+")|"+kHe+DHe,"g");function LHe(r){return r.match(IHe)||[]}var FHe=LHe,BHe=SHe,UHe=Dte,zHe=FHe;function $He(r){return UHe(r)?zHe(r):BHe(r)}var jHe=$He,VHe=fHe,GHe=Dte,HHe=jHe,WHe=Ate;function qHe(r){return function(e){e=WHe(e);var n=GHe(e)?HHe(e):void 0,i=n?n[0]:e.charAt(0),s=n?VHe(n,1).join(""):e.slice(1);return i[r]()+s}}var XHe=qHe,KHe=XHe,YHe=KHe("toUpperCase"),ZHe=YHe;const YA=hn(ZHe);function Un(r){return function(){return r}}const zte=Math.cos,TE=Math.sin,ll=Math.sqrt,EE=Math.PI,ZA=2*EE,JD=Math.PI,ek=2*JD,Pf=1e-6,QHe=ek-Pf;function $te(r){this._+=r[0];for(let e=1,n=r.length;e<n;++e)this._+=arguments[e]+r[e]}function JHe(r){let e=Math.floor(r);if(!(e>=0))throw new Error(`invalid digits: ${r}`);if(e>15)return $te;const n=10**e;return function(i){this._+=i[0];for(let s=1,o=i.length;s<o;++s)this._+=Math.round(arguments[s]*n)/n+i[s]}}class e8e{constructor(e){this._x0=this._y0=this._x1=this._y1=null,this._="",this._append=e==null?$te:JHe(e)}moveTo(e,n){this._append`M${this._x0=this._x1=+e},${this._y0=this._y1=+n}`}closePath(){this._x1!==null&&(this._x1=this._x0,this._y1=this._y0,this._append`Z`)}lineTo(e,n){this._append`L${this._x1=+e},${this._y1=+n}`}quadraticCurveTo(e,n,i,s){this._append`Q${+e},${+n},${this._x1=+i},${this._y1=+s}`}bezierCurveTo(e,n,i,s,o,a){this._append`C${+e},${+n},${+i},${+s},${this._x1=+o},${this._y1=+a}`}arcTo(e,n,i,s,o){if(e=+e,n=+n,i=+i,s=+s,o=+o,o<0)throw new Error(`negative radius: ${o}`);let a=this._x1,l=this._y1,c=i-e,u=s-n,h=a-e,f=l-n,d=h*h+f*f;if(this._x1===null)this._append`M${this._x1=e},${this._y1=n}`;else if(d>Pf)if(!(Math.abs(f*c-u*h)>Pf)||!o)this._append`L${this._x1=e},${this._y1=n}`;else{let p=i-a,m=s-l,g=c*c+u*u,v=p*p+m*m,y=Math.sqrt(g),x=Math.sqrt(d),b=o*Math.tan((JD-Math.acos((g+d-v)/(2*y*x)))/2),w=b/x,_=b/y;Math.abs(w-1)>Pf&&this._append`L${e+w*h},${n+w*f}`,this._append`A${o},${o},0,0,${+(f*p>h*m)},${this._x1=e+_*c},${this._y1=n+_*u}`}}arc(e,n,i,s,o,a){if(e=+e,n=+n,i=+i,a=!!a,i<0)throw new Error(`negative radius: ${i}`);let l=i*Math.cos(s),c=i*Math.sin(s),u=e+l,h=n+c,f=1^a,d=a?s-o:o-s;this._x1===null?this._append`M${u},${h}`:(Math.abs(this._x1-u)>Pf||Math.abs(this._y1-h)>Pf)&&this._append`L${u},${h}`,i&&(d<0&&(d=d%ek+ek),d>QHe?this._append`A${i},${i},0,1,${f},${e-l},${n-c}A${i},${i},0,1,${f},${this._x1=u},${this._y1=h}`:d>Pf&&this._append`A${i},${i},0,${+(d>=JD)},${f},${this._x1=e+i*Math.cos(o)},${this._y1=n+i*Math.sin(o)}`)}rect(e,n,i,s){this._append`M${this._x0=this._x1=+e},${this._y0=this._y1=+n}h${i=+i}v${+s}h${-i}Z`}toString(){return this._}}function MB(r){let e=3;return r.digits=function(n){if(!arguments.length)return e;if(n==null)e=null;else{const i=Math.floor(n);if(!(i>=0))throw new RangeError(`invalid digits: ${n}`);e=i}return r},()=>new e8e(e)}function AB(r){return typeof r=="object"&&"length"in r?r:Array.from(r)}function jte(r){this._context=r}jte.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(r,e){switch(r=+r,e=+e,this._point){case 0:this._point=1,this._line?this._context.lineTo(r,e):this._context.moveTo(r,e);break;case 1:this._point=2;default:this._context.lineTo(r,e);break}}};function QA(r){return new jte(r)}function Vte(r){return r[0]}function Gte(r){return r[1]}function Hte(r,e){var n=Un(!0),i=null,s=QA,o=null,a=MB(l);r=typeof r=="function"?r:r===void 0?Vte:Un(r),e=typeof e=="function"?e:e===void 0?Gte:Un(e);function l(c){var u,h=(c=AB(c)).length,f,d=!1,p;for(i==null&&(o=s(p=a())),u=0;u<=h;++u)!(u<h&&n(f=c[u],u,c))===d&&((d=!d)?o.lineStart():o.lineEnd()),d&&o.point(+r(f,u,c),+e(f,u,c));if(p)return o=null,p+""||null}return l.x=function(c){return arguments.length?(r=typeof c=="function"?c:Un(+c),l):r},l.y=function(c){return arguments.length?(e=typeof c=="function"?c:Un(+c),l):e},l.defined=function(c){return arguments.length?(n=typeof c=="function"?c:Un(!!c),l):n},l.curve=function(c){return arguments.length?(s=c,i!=null&&(o=s(i)),l):s},l.context=function(c){return arguments.length?(c==null?i=o=null:o=s(i=c),l):i},l}function JS(r,e,n){var i=null,s=Un(!0),o=null,a=QA,l=null,c=MB(u);r=typeof r=="function"?r:r===void 0?Vte:Un(+r),e=typeof e=="function"?e:Un(e===void 0?0:+e),n=typeof n=="function"?n:n===void 0?Gte:Un(+n);function u(f){var d,p,m,g=(f=AB(f)).length,v,y=!1,x,b=new Array(g),w=new Array(g);for(o==null&&(l=a(x=c())),d=0;d<=g;++d){if(!(d<g&&s(v=f[d],d,f))===y)if(y=!y)p=d,l.areaStart(),l.lineStart();else{for(l.lineEnd(),l.lineStart(),m=d-1;m>=p;--m)l.point(b[m],w[m]);l.lineEnd(),l.areaEnd()}y&&(b[d]=+r(v,d,f),w[d]=+e(v,d,f),l.point(i?+i(v,d,f):b[d],n?+n(v,d,f):w[d]))}if(x)return l=null,x+""||null}function h(){return Hte().defined(s).curve(a).context(o)}return u.x=function(f){return arguments.length?(r=typeof f=="function"?f:Un(+f),i=null,u):r},u.x0=function(f){return arguments.length?(r=typeof f=="function"?f:Un(+f),u):r},u.x1=function(f){return arguments.length?(i=f==null?null:typeof f=="function"?f:Un(+f),u):i},u.y=function(f){return arguments.length?(e=typeof f=="function"?f:Un(+f),n=null,u):e},u.y0=function(f){return arguments.length?(e=typeof f=="function"?f:Un(+f),u):e},u.y1=function(f){return arguments.length?(n=f==null?null:typeof f=="function"?f:Un(+f),u):n},u.lineX0=u.lineY0=function(){return h().x(r).y(e)},u.lineY1=function(){return h().x(r).y(n)},u.lineX1=function(){return h().x(i).y(e)},u.defined=function(f){return arguments.length?(s=typeof f=="function"?f:Un(!!f),u):s},u.curve=function(f){return arguments.length?(a=f,o!=null&&(l=a(o)),u):a},u.context=function(f){return arguments.length?(f==null?o=l=null:l=a(o=f),u):o},u}class Wte{constructor(e,n){this._context=e,this._x=n}areaStart(){this._line=0}areaEnd(){this._line=NaN}lineStart(){this._point=0}lineEnd(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line}point(e,n){switch(e=+e,n=+n,this._point){case 0:{this._point=1,this._line?this._context.lineTo(e,n):this._context.moveTo(e,n);break}case 1:this._point=2;default:{this._x?this._context.bezierCurveTo(this._x0=(this._x0+e)/2,this._y0,this._x0,n,e,n):this._context.bezierCurveTo(this._x0,this._y0=(this._y0+n)/2,e,this._y0,e,n);break}}this._x0=e,this._y0=n}}function t8e(r){return new Wte(r,!0)}function n8e(r){return new Wte(r,!1)}const CB={draw(r,e){const n=ll(e/EE);r.moveTo(n,0),r.arc(0,0,n,0,ZA)}},r8e={draw(r,e){const n=ll(e/5)/2;r.moveTo(-3*n,-n),r.lineTo(-n,-n),r.lineTo(-n,-3*n),r.lineTo(n,-3*n),r.lineTo(n,-n),r.lineTo(3*n,-n),r.lineTo(3*n,n),r.lineTo(n,n),r.lineTo(n,3*n),r.lineTo(-n,3*n),r.lineTo(-n,n),r.lineTo(-3*n,n),r.closePath()}},qte=ll(1/3),i8e=qte*2,s8e={draw(r,e){const n=ll(e/i8e),i=n*qte;r.moveTo(0,-n),r.lineTo(i,0),r.lineTo(0,n),r.lineTo(-i,0),r.closePath()}},o8e={draw(r,e){const n=ll(e),i=-n/2;r.rect(i,i,n,n)}},a8e=.8908130915292852,Xte=TE(EE/10)/TE(7*EE/10),l8e=TE(ZA/10)*Xte,c8e=-zte(ZA/10)*Xte,u8e={draw(r,e){const n=ll(e*a8e),i=l8e*n,s=c8e*n;r.moveTo(0,-n),r.lineTo(i,s);for(let o=1;o<5;++o){const a=ZA*o/5,l=zte(a),c=TE(a);r.lineTo(c*n,-l*n),r.lineTo(l*i-c*s,c*i+l*s)}r.closePath()}},KN=ll(3),h8e={draw(r,e){const n=-ll(e/(KN*3));r.moveTo(0,n*2),r.lineTo(-KN*n,-n),r.lineTo(KN*n,-n),r.closePath()}},Ho=-.5,Wo=ll(3)/2,tk=1/ll(12),f8e=(tk/2+1)*3,d8e={draw(r,e){const n=ll(e/f8e),i=n/2,s=n*tk,o=i,a=n*tk+n,l=-o,c=a;r.moveTo(i,s),r.lineTo(o,a),r.lineTo(l,c),r.lineTo(Ho*i-Wo*s,Wo*i+Ho*s),r.lineTo(Ho*o-Wo*a,Wo*o+Ho*a),r.lineTo(Ho*l-Wo*c,Wo*l+Ho*c),r.lineTo(Ho*i+Wo*s,Ho*s-Wo*i),r.lineTo(Ho*o+Wo*a,Ho*a-Wo*o),r.lineTo(Ho*l+Wo*c,Ho*c-Wo*l),r.closePath()}};function p8e(r,e){let n=null,i=MB(s);r=typeof r=="function"?r:Un(r||CB),e=typeof e=="function"?e:Un(e===void 0?64:+e);function s(){let o;if(n||(n=o=i()),r.apply(this,arguments).draw(n,+e.apply(this,arguments)),o)return n=null,o+""||null}return s.type=function(o){return arguments.length?(r=typeof o=="function"?o:Un(o),s):r},s.size=function(o){return arguments.length?(e=typeof o=="function"?o:Un(+o),s):e},s.context=function(o){return arguments.length?(n=o??null,s):n},s}function ME(){}function AE(r,e,n){r._context.bezierCurveTo((2*r._x0+r._x1)/3,(2*r._y0+r._y1)/3,(r._x0+2*r._x1)/3,(r._y0+2*r._y1)/3,(r._x0+4*r._x1+e)/6,(r._y0+4*r._y1+n)/6)}function Kte(r){this._context=r}Kte.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){switch(this._point){case 3:AE(this,this._x1,this._y1);case 2:this._context.lineTo(this._x1,this._y1);break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(r,e){switch(r=+r,e=+e,this._point){case 0:this._point=1,this._line?this._context.lineTo(r,e):this._context.moveTo(r,e);break;case 1:this._point=2;break;case 2:this._point=3,this._context.lineTo((5*this._x0+this._x1)/6,(5*this._y0+this._y1)/6);default:AE(this,r,e);break}this._x0=this._x1,this._x1=r,this._y0=this._y1,this._y1=e}};function m8e(r){return new Kte(r)}function Yte(r){this._context=r}Yte.prototype={areaStart:ME,areaEnd:ME,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._y0=this._y1=this._y2=this._y3=this._y4=NaN,this._point=0},lineEnd:function(){switch(this._point){case 1:{this._context.moveTo(this._x2,this._y2),this._context.closePath();break}case 2:{this._context.moveTo((this._x2+2*this._x3)/3,(this._y2+2*this._y3)/3),this._context.lineTo((this._x3+2*this._x2)/3,(this._y3+2*this._y2)/3),this._context.closePath();break}case 3:{this.point(this._x2,this._y2),this.point(this._x3,this._y3),this.point(this._x4,this._y4);break}}},point:function(r,e){switch(r=+r,e=+e,this._point){case 0:this._point=1,this._x2=r,this._y2=e;break;case 1:this._point=2,this._x3=r,this._y3=e;break;case 2:this._point=3,this._x4=r,this._y4=e,this._context.moveTo((this._x0+4*this._x1+r)/6,(this._y0+4*this._y1+e)/6);break;default:AE(this,r,e);break}this._x0=this._x1,this._x1=r,this._y0=this._y1,this._y1=e}};function g8e(r){return new Yte(r)}function Zte(r){this._context=r}Zte.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===3)&&this._context.closePath(),this._line=1-this._line},point:function(r,e){switch(r=+r,e=+e,this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3;var n=(this._x0+4*this._x1+r)/6,i=(this._y0+4*this._y1+e)/6;this._line?this._context.lineTo(n,i):this._context.moveTo(n,i);break;case 3:this._point=4;default:AE(this,r,e);break}this._x0=this._x1,this._x1=r,this._y0=this._y1,this._y1=e}};function y8e(r){return new Zte(r)}function Qte(r){this._context=r}Qte.prototype={areaStart:ME,areaEnd:ME,lineStart:function(){this._point=0},lineEnd:function(){this._point&&this._context.closePath()},point:function(r,e){r=+r,e=+e,this._point?this._context.lineTo(r,e):(this._point=1,this._context.moveTo(r,e))}};function v8e(r){return new Qte(r)}function KH(r){return r<0?-1:1}function YH(r,e,n){var i=r._x1-r._x0,s=e-r._x1,o=(r._y1-r._y0)/(i||s<0&&-0),a=(n-r._y1)/(s||i<0&&-0),l=(o*s+a*i)/(i+s);return(KH(o)+KH(a))*Math.min(Math.abs(o),Math.abs(a),.5*Math.abs(l))||0}function ZH(r,e){var n=r._x1-r._x0;return n?(3*(r._y1-r._y0)/n-e)/2:e}function YN(r,e,n){var i=r._x0,s=r._y0,o=r._x1,a=r._y1,l=(o-i)/3;r._context.bezierCurveTo(i+l,s+l*e,o-l,a-l*n,o,a)}function CE(r){this._context=r}CE.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=this._t0=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x1,this._y1);break;case 3:YN(this,this._t0,ZH(this,this._t0));break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(r,e){var n=NaN;if(r=+r,e=+e,!(r===this._x1&&e===this._y1)){switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(r,e):this._context.moveTo(r,e);break;case 1:this._point=2;break;case 2:this._point=3,YN(this,ZH(this,n=YH(this,r,e)),n);break;default:YN(this,this._t0,n=YH(this,r,e));break}this._x0=this._x1,this._x1=r,this._y0=this._y1,this._y1=e,this._t0=n}}};function Jte(r){this._context=new ene(r)}(Jte.prototype=Object.create(CE.prototype)).point=function(r,e){CE.prototype.point.call(this,e,r)};function ene(r){this._context=r}ene.prototype={moveTo:function(r,e){this._context.moveTo(e,r)},closePath:function(){this._context.closePath()},lineTo:function(r,e){this._context.lineTo(e,r)},bezierCurveTo:function(r,e,n,i,s,o){this._context.bezierCurveTo(e,r,i,n,o,s)}};function x8e(r){return new CE(r)}function b8e(r){return new Jte(r)}function tne(r){this._context=r}tne.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=[],this._y=[]},lineEnd:function(){var r=this._x,e=this._y,n=r.length;if(n)if(this._line?this._context.lineTo(r[0],e[0]):this._context.moveTo(r[0],e[0]),n===2)this._context.lineTo(r[1],e[1]);else for(var i=QH(r),s=QH(e),o=0,a=1;a<n;++o,++a)this._context.bezierCurveTo(i[0][o],s[0][o],i[1][o],s[1][o],r[a],e[a]);(this._line||this._line!==0&&n===1)&&this._context.closePath(),this._line=1-this._line,this._x=this._y=null},point:function(r,e){this._x.push(+r),this._y.push(+e)}};function QH(r){var e,n=r.length-1,i,s=new Array(n),o=new Array(n),a=new Array(n);for(s[0]=0,o[0]=2,a[0]=r[0]+2*r[1],e=1;e<n-1;++e)s[e]=1,o[e]=4,a[e]=4*r[e]+2*r[e+1];for(s[n-1]=2,o[n-1]=7,a[n-1]=8*r[n-1]+r[n],e=1;e<n;++e)i=s[e]/o[e-1],o[e]-=i,a[e]-=i*a[e-1];for(s[n-1]=a[n-1]/o[n-1],e=n-2;e>=0;--e)s[e]=(a[e]-s[e+1])/o[e];for(o[n-1]=(r[n]+s[n-1])/2,e=0;e<n-1;++e)o[e]=2*r[e+1]-s[e+1];return[s,o]}function _8e(r){return new tne(r)}function JA(r,e){this._context=r,this._t=e}JA.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=this._y=NaN,this._point=0},lineEnd:function(){0<this._t&&this._t<1&&this._point===2&&this._context.lineTo(this._x,this._y),(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line>=0&&(this._t=1-this._t,this._line=1-this._line)},point:function(r,e){switch(r=+r,e=+e,this._point){case 0:this._point=1,this._line?this._context.lineTo(r,e):this._context.moveTo(r,e);break;case 1:this._point=2;default:{if(this._t<=0)this._context.lineTo(this._x,e),this._context.lineTo(r,e);else{var n=this._x*(1-this._t)+r*this._t;this._context.lineTo(n,this._y),this._context.lineTo(n,e)}break}}this._x=r,this._y=e}};function w8e(r){return new JA(r,.5)}function S8e(r){return new JA(r,0)}function T8e(r){return new JA(r,1)}function Ng(r,e){if((a=r.length)>1)for(var n=1,i,s,o=r[e[0]],a,l=o.length;n<a;++n)for(s=o,o=r[e[n]],i=0;i<l;++i)o[i][1]+=o[i][0]=isNaN(s[i][1])?s[i][0]:s[i][1]}function nk(r){for(var e=r.length,n=new Array(e);--e>=0;)n[e]=e;return n}function E8e(r,e){return r[e]}function M8e(r){const e=[];return e.key=r,e}function A8e(){var r=Un([]),e=nk,n=Ng,i=E8e;function s(o){var a=Array.from(r.apply(this,arguments),M8e),l,c=a.length,u=-1,h;for(const f of o)for(l=0,++u;l<c;++l)(a[l][u]=[0,+i(f,a[l].key,u,o)]).data=f;for(l=0,h=AB(e(a));l<c;++l)a[h[l]].index=l;return n(a,h),a}return s.keys=function(o){return arguments.length?(r=typeof o=="function"?o:Un(Array.from(o)),s):r},s.value=function(o){return arguments.length?(i=typeof o=="function"?o:Un(+o),s):i},s.order=function(o){return arguments.length?(e=o==null?nk:typeof o=="function"?o:Un(Array.from(o)),s):e},s.offset=function(o){return arguments.length?(n=o??Ng,s):n},s}function C8e(r,e){if((i=r.length)>0){for(var n,i,s=0,o=r[0].length,a;s<o;++s){for(a=n=0;n<i;++n)a+=r[n][s][1]||0;if(a)for(n=0;n<i;++n)r[n][s][1]/=a}Ng(r,e)}}function P8e(r,e){if((s=r.length)>0){for(var n=0,i=r[e[0]],s,o=i.length;n<o;++n){for(var a=0,l=0;a<s;++a)l+=r[a][n][1]||0;i[n][1]+=i[n][0]=-l/2}Ng(r,e)}}function R8e(r,e){if(!(!((a=r.length)>0)||!((o=(s=r[e[0]]).length)>0))){for(var n=0,i=1,s,o,a;i<o;++i){for(var l=0,c=0,u=0;l<a;++l){for(var h=r[e[l]],f=h[i][1]||0,d=h[i-1][1]||0,p=(f-d)/2,m=0;m<l;++m){var g=r[e[m]],v=g[i][1]||0,y=g[i-1][1]||0;p+=v-y}c+=f,u+=p*f}s[i-1][1]+=s[i-1][0]=n,c&&(n-=u/c)}s[i-1][1]+=s[i-1][0]=n,Ng(r,e)}}function mb(r){"@babel/helpers - typeof";return mb=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},mb(r)}var N8e=["type","size","sizeType"];function rk(){return rk=Object.assign?Object.assign.bind():function(r){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(r[i]=n[i])}return r},rk.apply(this,arguments)}function JH(r,e){var n=Object.keys(r);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(r);e&&(i=i.filter(function(s){return Object.getOwnPropertyDescriptor(r,s).enumerable})),n.push.apply(n,i)}return n}function e8(r){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?JH(Object(n),!0).forEach(function(i){O8e(r,i,n[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(n)):JH(Object(n)).forEach(function(i){Object.defineProperty(r,i,Object.getOwnPropertyDescriptor(n,i))})}return r}function O8e(r,e,n){return e=D8e(e),e in r?Object.defineProperty(r,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):r[e]=n,r}function D8e(r){var e=k8e(r,"string");return mb(e)=="symbol"?e:e+""}function k8e(r,e){if(mb(r)!="object"||!r)return r;var n=r[Symbol.toPrimitive];if(n!==void 0){var i=n.call(r,e||"default");if(mb(i)!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(r)}function I8e(r,e){if(r==null)return{};var n=L8e(r,e),i,s;if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(r);for(s=0;s<o.length;s++)i=o[s],!(e.indexOf(i)>=0)&&Object.prototype.propertyIsEnumerable.call(r,i)&&(n[i]=r[i])}return n}function L8e(r,e){if(r==null)return{};var n={};for(var i in r)if(Object.prototype.hasOwnProperty.call(r,i)){if(e.indexOf(i)>=0)continue;n[i]=r[i]}return n}var nne={symbolCircle:CB,symbolCross:r8e,symbolDiamond:s8e,symbolSquare:o8e,symbolStar:u8e,symbolTriangle:h8e,symbolWye:d8e},F8e=Math.PI/180,B8e=function(e){var n="symbol".concat(YA(e));return nne[n]||CB},U8e=function(e,n,i){if(n==="area")return e;switch(i){case"cross":return 5*e*e/9;case"diamond":return .5*e*e/Math.sqrt(3);case"square":return e*e;case"star":{var s=18*F8e;return 1.25*e*e*(Math.tan(s)-Math.tan(s*2)*Math.pow(Math.tan(s),2))}case"triangle":return Math.sqrt(3)*e*e/4;case"wye":return(21-10*Math.sqrt(3))*e*e/8;default:return Math.PI*e*e/4}},z8e=function(e,n){nne["symbol".concat(YA(e))]=n},PB=function(e){var n=e.type,i=n===void 0?"circle":n,s=e.size,o=s===void 0?64:s,a=e.sizeType,l=a===void 0?"area":a,c=I8e(e,N8e),u=e8(e8({},c),{},{type:i,size:o,sizeType:l}),h=function(){var v=B8e(i),y=p8e().type(v).size(U8e(o,l,i));return y()},f=u.className,d=u.cx,p=u.cy,m=Tt(u,!0);return d===+d&&p===+p&&o===+o?Z.createElement("path",rk({},m,{className:qt("recharts-symbols",f),transform:"translate(".concat(d,", ").concat(p,")"),d:h()})):null};PB.registerSymbol=z8e;function Og(r){"@babel/helpers - typeof";return Og=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Og(r)}function ik(){return ik=Object.assign?Object.assign.bind():function(r){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(r[i]=n[i])}return r},ik.apply(this,arguments)}function t8(r,e){var n=Object.keys(r);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(r);e&&(i=i.filter(function(s){return Object.getOwnPropertyDescriptor(r,s).enumerable})),n.push.apply(n,i)}return n}function $8e(r){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?t8(Object(n),!0).forEach(function(i){gb(r,i,n[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(n)):t8(Object(n)).forEach(function(i){Object.defineProperty(r,i,Object.getOwnPropertyDescriptor(n,i))})}return r}function j8e(r,e){if(!(r instanceof e))throw new TypeError("Cannot call a class as a function")}function V8e(r,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(r,ine(i.key),i)}}function G8e(r,e,n){return e&&V8e(r.prototype,e),Object.defineProperty(r,"prototype",{writable:!1}),r}function H8e(r,e,n){return e=PE(e),W8e(r,rne()?Reflect.construct(e,n||[],PE(r).constructor):e.apply(r,n))}function W8e(r,e){if(e&&(Og(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return q8e(r)}function q8e(r){if(r===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return r}function rne(){try{var r=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(rne=function(){return!!r})()}function PE(r){return PE=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(n){return n.__proto__||Object.getPrototypeOf(n)},PE(r)}function X8e(r,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");r.prototype=Object.create(e&&e.prototype,{constructor:{value:r,writable:!0,configurable:!0}}),Object.defineProperty(r,"prototype",{writable:!1}),e&&sk(r,e)}function sk(r,e){return sk=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(i,s){return i.__proto__=s,i},sk(r,e)}function gb(r,e,n){return e=ine(e),e in r?Object.defineProperty(r,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):r[e]=n,r}function ine(r){var e=K8e(r,"string");return Og(e)=="symbol"?e:e+""}function K8e(r,e){if(Og(r)!="object"||!r)return r;var n=r[Symbol.toPrimitive];if(n!==void 0){var i=n.call(r,e||"default");if(Og(i)!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(r)}var qo=32,RB=function(r){function e(){return j8e(this,e),H8e(this,e,arguments)}return X8e(e,r),G8e(e,[{key:"renderIcon",value:function(i){var s=this.props.inactiveColor,o=qo/2,a=qo/6,l=qo/3,c=i.inactive?s:i.color;if(i.type==="plainline")return Z.createElement("line",{strokeWidth:4,fill:"none",stroke:c,strokeDasharray:i.payload.strokeDasharray,x1:0,y1:o,x2:qo,y2:o,className:"recharts-legend-icon"});if(i.type==="line")return Z.createElement("path",{strokeWidth:4,fill:"none",stroke:c,d:"M0,".concat(o,"h").concat(l,`
            A`).concat(a,",").concat(a,",0,1,1,").concat(2*l,",").concat(o,`
            H`).concat(qo,"M").concat(2*l,",").concat(o,`
            A`).concat(a,",").concat(a,",0,1,1,").concat(l,",").concat(o),className:"recharts-legend-icon"});if(i.type==="rect")return Z.createElement("path",{stroke:"none",fill:c,d:"M0,".concat(qo/8,"h").concat(qo,"v").concat(qo*3/4,"h").concat(-qo,"z"),className:"recharts-legend-icon"});if(Z.isValidElement(i.legendIcon)){var u=$8e({},i);return delete u.legendIcon,Z.cloneElement(i.legendIcon,u)}return Z.createElement(PB,{fill:c,cx:o,cy:o,size:qo,sizeType:"diameter",type:i.type})}},{key:"renderItems",value:function(){var i=this,s=this.props,o=s.payload,a=s.iconSize,l=s.layout,c=s.formatter,u=s.inactiveColor,h={x:0,y:0,width:qo,height:qo},f={display:l==="horizontal"?"inline-block":"block",marginRight:10},d={display:"inline-block",verticalAlign:"middle",marginRight:4};return o.map(function(p,m){var g=p.formatter||c,v=qt(gb(gb({"recharts-legend-item":!0},"legend-item-".concat(m),!0),"inactive",p.inactive));if(p.type==="none")return null;var y=Ut(p.value)?null:p.value;Zc(!Ut(p.value),`The name property is also required when using a function for the dataKey of a chart's cartesian components. Ex: <Bar name="Name of my Data"/>`);var x=p.inactive?u:p.color;return Z.createElement("li",ik({className:v,style:f,key:"legend-item-".concat(m)},Rg(i.props,p,m)),Z.createElement(KD,{width:a,height:a,viewBox:h,style:d},i.renderIcon(p)),Z.createElement("span",{className:"recharts-legend-item-text",style:{color:x}},g?g(y,p,m):y))})}},{key:"render",value:function(){var i=this.props,s=i.payload,o=i.layout,a=i.align;if(!s||!s.length)return null;var l={padding:0,margin:0,textAlign:o==="horizontal"?a:"left"};return Z.createElement("ul",{className:"recharts-default-legend",style:l},this.renderItems())}}])}(te.PureComponent);gb(RB,"displayName","Legend");gb(RB,"defaultProps",{iconSize:14,layout:"horizontal",align:"center",verticalAlign:"middle",inactiveColor:"#ccc"});var Y8e=FA;function Z8e(){this.__data__=new Y8e,this.size=0}var Q8e=Z8e;function J8e(r){var e=this.__data__,n=e.delete(r);return this.size=e.size,n}var e6e=J8e;function t6e(r){return this.__data__.get(r)}var n6e=t6e;function r6e(r){return this.__data__.has(r)}var i6e=r6e,s6e=FA,o6e=yB,a6e=vB,l6e=200;function c6e(r,e){var n=this.__data__;if(n instanceof s6e){var i=n.__data__;if(!o6e||i.length<l6e-1)return i.push([r,e]),this.size=++n.size,this;n=this.__data__=new a6e(i)}return n.set(r,e),this.size=n.size,this}var u6e=c6e,h6e=FA,f6e=Q8e,d6e=e6e,p6e=n6e,m6e=i6e,g6e=u6e;function Ny(r){var e=this.__data__=new h6e(r);this.size=e.size}Ny.prototype.clear=f6e;Ny.prototype.delete=d6e;Ny.prototype.get=p6e;Ny.prototype.has=m6e;Ny.prototype.set=g6e;var sne=Ny,y6e="__lodash_hash_undefined__";function v6e(r){return this.__data__.set(r,y6e),this}var x6e=v6e;function b6e(r){return this.__data__.has(r)}var _6e=b6e,w6e=vB,S6e=x6e,T6e=_6e;function RE(r){var e=-1,n=r==null?0:r.length;for(this.__data__=new w6e;++e<n;)this.add(r[e])}RE.prototype.add=RE.prototype.push=S6e;RE.prototype.has=T6e;var one=RE;function E6e(r,e){for(var n=-1,i=r==null?0:r.length;++n<i;)if(e(r[n],n,r))return!0;return!1}var ane=E6e;function M6e(r,e){return r.has(e)}var lne=M6e,A6e=one,C6e=ane,P6e=lne,R6e=1,N6e=2;function O6e(r,e,n,i,s,o){var a=n&R6e,l=r.length,c=e.length;if(l!=c&&!(a&&c>l))return!1;var u=o.get(r),h=o.get(e);if(u&&h)return u==e&&h==r;var f=-1,d=!0,p=n&N6e?new A6e:void 0;for(o.set(r,e),o.set(e,r);++f<l;){var m=r[f],g=e[f];if(i)var v=a?i(g,m,f,e,r,o):i(m,g,f,r,e,o);if(v!==void 0){if(v)continue;d=!1;break}if(p){if(!C6e(e,function(y,x){if(!P6e(p,x)&&(m===y||s(m,y,n,i,o)))return p.push(x)})){d=!1;break}}else if(!(m===g||s(m,g,n,i,o))){d=!1;break}}return o.delete(r),o.delete(e),d}var cne=O6e,D6e=ql,k6e=D6e.Uint8Array,I6e=k6e;function L6e(r){var e=-1,n=Array(r.size);return r.forEach(function(i,s){n[++e]=[s,i]}),n}var F6e=L6e;function B6e(r){var e=-1,n=Array(r.size);return r.forEach(function(i){n[++e]=i}),n}var NB=B6e,n8=D_,r8=I6e,U6e=gB,z6e=cne,$6e=F6e,j6e=NB,V6e=1,G6e=2,H6e="[object Boolean]",W6e="[object Date]",q6e="[object Error]",X6e="[object Map]",K6e="[object Number]",Y6e="[object RegExp]",Z6e="[object Set]",Q6e="[object String]",J6e="[object Symbol]",eWe="[object ArrayBuffer]",tWe="[object DataView]",i8=n8?n8.prototype:void 0,ZN=i8?i8.valueOf:void 0;function nWe(r,e,n,i,s,o,a){switch(n){case tWe:if(r.byteLength!=e.byteLength||r.byteOffset!=e.byteOffset)return!1;r=r.buffer,e=e.buffer;case eWe:return!(r.byteLength!=e.byteLength||!o(new r8(r),new r8(e)));case H6e:case W6e:case K6e:return U6e(+r,+e);case q6e:return r.name==e.name&&r.message==e.message;case Y6e:case Q6e:return r==e+"";case X6e:var l=$6e;case Z6e:var c=i&V6e;if(l||(l=j6e),r.size!=e.size&&!c)return!1;var u=a.get(r);if(u)return u==e;i|=G6e,a.set(r,e);var h=z6e(l(r),l(e),i,s,o,a);return a.delete(r),h;case J6e:if(ZN)return ZN.call(r)==ZN.call(e)}return!1}var rWe=nWe;function iWe(r,e){for(var n=-1,i=e.length,s=r.length;++n<i;)r[s+n]=e[n];return r}var une=iWe,sWe=une,oWe=co;function aWe(r,e,n){var i=e(r);return oWe(r)?i:sWe(i,n(r))}var lWe=aWe;function cWe(r,e){for(var n=-1,i=r==null?0:r.length,s=0,o=[];++n<i;){var a=r[n];e(a,n,r)&&(o[s++]=a)}return o}var uWe=cWe;function hWe(){return[]}var fWe=hWe,dWe=uWe,pWe=fWe,mWe=Object.prototype,gWe=mWe.propertyIsEnumerable,s8=Object.getOwnPropertySymbols,yWe=s8?function(r){return r==null?[]:(r=Object(r),dWe(s8(r),function(e){return gWe.call(r,e)}))}:pWe,vWe=yWe;function xWe(r,e){for(var n=-1,i=Array(r);++n<r;)i[n]=e(n);return i}var bWe=xWe,_We=_u,wWe=wu,SWe="[object Arguments]";function TWe(r){return wWe(r)&&_We(r)==SWe}var EWe=TWe,o8=EWe,MWe=wu,hne=Object.prototype,AWe=hne.hasOwnProperty,CWe=hne.propertyIsEnumerable,PWe=o8(function(){return arguments}())?o8:function(r){return MWe(r)&&AWe.call(r,"callee")&&!CWe.call(r,"callee")},OB=PWe,NE={exports:{}};function RWe(){return!1}var NWe=RWe;NE.exports;(function(r,e){var n=ql,i=NWe,s=e&&!e.nodeType&&e,o=s&&!0&&r&&!r.nodeType&&r,a=o&&o.exports===s,l=a?n.Buffer:void 0,c=l?l.isBuffer:void 0,u=c||i;r.exports=u})(NE,NE.exports);var fne=NE.exports,OWe=9007199254740991,DWe=/^(?:0|[1-9]\d*)$/;function kWe(r,e){var n=typeof r;return e=e??OWe,!!e&&(n=="number"||n!="symbol"&&DWe.test(r))&&r>-1&&r%1==0&&r<e}var DB=kWe,IWe=9007199254740991;function LWe(r){return typeof r=="number"&&r>-1&&r%1==0&&r<=IWe}var kB=LWe,FWe=_u,BWe=kB,UWe=wu,zWe="[object Arguments]",$We="[object Array]",jWe="[object Boolean]",VWe="[object Date]",GWe="[object Error]",HWe="[object Function]",WWe="[object Map]",qWe="[object Number]",XWe="[object Object]",KWe="[object RegExp]",YWe="[object Set]",ZWe="[object String]",QWe="[object WeakMap]",JWe="[object ArrayBuffer]",e9e="[object DataView]",t9e="[object Float32Array]",n9e="[object Float64Array]",r9e="[object Int8Array]",i9e="[object Int16Array]",s9e="[object Int32Array]",o9e="[object Uint8Array]",a9e="[object Uint8ClampedArray]",l9e="[object Uint16Array]",c9e="[object Uint32Array]",Xn={};Xn[t9e]=Xn[n9e]=Xn[r9e]=Xn[i9e]=Xn[s9e]=Xn[o9e]=Xn[a9e]=Xn[l9e]=Xn[c9e]=!0;Xn[zWe]=Xn[$We]=Xn[JWe]=Xn[jWe]=Xn[e9e]=Xn[VWe]=Xn[GWe]=Xn[HWe]=Xn[WWe]=Xn[qWe]=Xn[XWe]=Xn[KWe]=Xn[YWe]=Xn[ZWe]=Xn[QWe]=!1;function u9e(r){return UWe(r)&&BWe(r.length)&&!!Xn[FWe(r)]}var h9e=u9e;function f9e(r){return function(e){return r(e)}}var dne=f9e,OE={exports:{}};OE.exports;(function(r,e){var n=_te,i=e&&!e.nodeType&&e,s=i&&!0&&r&&!r.nodeType&&r,o=s&&s.exports===i,a=o&&n.process,l=function(){try{var c=s&&s.require&&s.require("util").types;return c||a&&a.binding&&a.binding("util")}catch{}}();r.exports=l})(OE,OE.exports);var d9e=OE.exports,p9e=h9e,m9e=dne,a8=d9e,l8=a8&&a8.isTypedArray,g9e=l8?m9e(l8):p9e,pne=g9e,y9e=bWe,v9e=OB,x9e=co,b9e=fne,_9e=DB,w9e=pne,S9e=Object.prototype,T9e=S9e.hasOwnProperty;function E9e(r,e){var n=x9e(r),i=!n&&v9e(r),s=!n&&!i&&b9e(r),o=!n&&!i&&!s&&w9e(r),a=n||i||s||o,l=a?y9e(r.length,String):[],c=l.length;for(var u in r)(e||T9e.call(r,u))&&!(a&&(u=="length"||s&&(u=="offset"||u=="parent")||o&&(u=="buffer"||u=="byteLength"||u=="byteOffset")||_9e(u,c)))&&l.push(u);return l}var M9e=E9e,A9e=Object.prototype;function C9e(r){var e=r&&r.constructor,n=typeof e=="function"&&e.prototype||A9e;return r===n}var P9e=C9e;function R9e(r,e){return function(n){return r(e(n))}}var mne=R9e,N9e=mne,O9e=N9e(Object.keys,Object),D9e=O9e,k9e=P9e,I9e=D9e,L9e=Object.prototype,F9e=L9e.hasOwnProperty;function B9e(r){if(!k9e(r))return I9e(r);var e=[];for(var n in Object(r))F9e.call(r,n)&&n!="constructor"&&e.push(n);return e}var U9e=B9e,z9e=mB,$9e=kB;function j9e(r){return r!=null&&$9e(r.length)&&!z9e(r)}var L_=j9e,V9e=M9e,G9e=U9e,H9e=L_;function W9e(r){return H9e(r)?V9e(r):G9e(r)}var eC=W9e,q9e=lWe,X9e=vWe,K9e=eC;function Y9e(r){return q9e(r,K9e,X9e)}var Z9e=Y9e,c8=Z9e,Q9e=1,J9e=Object.prototype,e7e=J9e.hasOwnProperty;function t7e(r,e,n,i,s,o){var a=n&Q9e,l=c8(r),c=l.length,u=c8(e),h=u.length;if(c!=h&&!a)return!1;for(var f=c;f--;){var d=l[f];if(!(a?d in e:e7e.call(e,d)))return!1}var p=o.get(r),m=o.get(e);if(p&&m)return p==e&&m==r;var g=!0;o.set(r,e),o.set(e,r);for(var v=a;++f<c;){d=l[f];var y=r[d],x=e[d];if(i)var b=a?i(x,y,d,e,r,o):i(y,x,d,r,e,o);if(!(b===void 0?y===x||s(y,x,n,i,o):b)){g=!1;break}v||(v=d=="constructor")}if(g&&!v){var w=r.constructor,_=e.constructor;w!=_&&"constructor"in r&&"constructor"in e&&!(typeof w=="function"&&w instanceof w&&typeof _=="function"&&_ instanceof _)&&(g=!1)}return o.delete(r),o.delete(e),g}var n7e=t7e,r7e=Fd,i7e=ql,s7e=r7e(i7e,"DataView"),o7e=s7e,a7e=Fd,l7e=ql,c7e=a7e(l7e,"Promise"),u7e=c7e,h7e=Fd,f7e=ql,d7e=h7e(f7e,"Set"),gne=d7e,p7e=Fd,m7e=ql,g7e=p7e(m7e,"WeakMap"),y7e=g7e,ok=o7e,ak=yB,lk=u7e,ck=gne,uk=y7e,yne=_u,Oy=Ste,u8="[object Map]",v7e="[object Object]",h8="[object Promise]",f8="[object Set]",d8="[object WeakMap]",p8="[object DataView]",x7e=Oy(ok),b7e=Oy(ak),_7e=Oy(lk),w7e=Oy(ck),S7e=Oy(uk),Rf=yne;(ok&&Rf(new ok(new ArrayBuffer(1)))!=p8||ak&&Rf(new ak)!=u8||lk&&Rf(lk.resolve())!=h8||ck&&Rf(new ck)!=f8||uk&&Rf(new uk)!=d8)&&(Rf=function(r){var e=yne(r),n=e==v7e?r.constructor:void 0,i=n?Oy(n):"";if(i)switch(i){case x7e:return p8;case b7e:return u8;case _7e:return h8;case w7e:return f8;case S7e:return d8}return e});var T7e=Rf,QN=sne,E7e=cne,M7e=rWe,A7e=n7e,m8=T7e,g8=co,y8=fne,C7e=pne,P7e=1,v8="[object Arguments]",x8="[object Array]",e1="[object Object]",R7e=Object.prototype,b8=R7e.hasOwnProperty;function N7e(r,e,n,i,s,o){var a=g8(r),l=g8(e),c=a?x8:m8(r),u=l?x8:m8(e);c=c==v8?e1:c,u=u==v8?e1:u;var h=c==e1,f=u==e1,d=c==u;if(d&&y8(r)){if(!y8(e))return!1;a=!0,h=!1}if(d&&!h)return o||(o=new QN),a||C7e(r)?E7e(r,e,n,i,s,o):M7e(r,e,c,n,i,s,o);if(!(n&P7e)){var p=h&&b8.call(r,"__wrapped__"),m=f&&b8.call(e,"__wrapped__");if(p||m){var g=p?r.value():r,v=m?e.value():e;return o||(o=new QN),s(g,v,n,i,o)}}return d?(o||(o=new QN),A7e(r,e,n,i,s,o)):!1}var O7e=N7e,D7e=O7e,_8=wu;function vne(r,e,n,i,s){return r===e?!0:r==null||e==null||!_8(r)&&!_8(e)?r!==r&&e!==e:D7e(r,e,n,i,vne,s)}var IB=vne,k7e=sne,I7e=IB,L7e=1,F7e=2;function B7e(r,e,n,i){var s=n.length,o=s,a=!i;if(r==null)return!o;for(r=Object(r);s--;){var l=n[s];if(a&&l[2]?l[1]!==r[l[0]]:!(l[0]in r))return!1}for(;++s<o;){l=n[s];var c=l[0],u=r[c],h=l[1];if(a&&l[2]){if(u===void 0&&!(c in r))return!1}else{var f=new k7e;if(i)var d=i(u,h,c,r,e,f);if(!(d===void 0?I7e(h,u,L7e|F7e,i,f):d))return!1}}return!0}var U7e=B7e,z7e=Zh;function $7e(r){return r===r&&!z7e(r)}var xne=$7e,j7e=xne,V7e=eC;function G7e(r){for(var e=V7e(r),n=e.length;n--;){var i=e[n],s=r[i];e[n]=[i,s,j7e(s)]}return e}var H7e=G7e;function W7e(r,e){return function(n){return n==null?!1:n[r]===e&&(e!==void 0||r in Object(n))}}var bne=W7e,q7e=U7e,X7e=H7e,K7e=bne;function Y7e(r){var e=X7e(r);return e.length==1&&e[0][2]?K7e(e[0][0],e[0][1]):function(n){return n===r||q7e(n,r,e)}}var Z7e=Y7e;function Q7e(r,e){return r!=null&&e in Object(r)}var J7e=Q7e,eqe=Cte,tqe=OB,nqe=co,rqe=DB,iqe=kB,sqe=UA;function oqe(r,e,n){e=eqe(e,r);for(var i=-1,s=e.length,o=!1;++i<s;){var a=sqe(e[i]);if(!(o=r!=null&&n(r,a)))break;r=r[a]}return o||++i!=s?o:(s=r==null?0:r.length,!!s&&iqe(s)&&rqe(a,s)&&(nqe(r)||tqe(r)))}var aqe=oqe,lqe=J7e,cqe=aqe;function uqe(r,e){return r!=null&&cqe(r,e,lqe)}var hqe=uqe,fqe=IB,dqe=Pte,pqe=hqe,mqe=pB,gqe=xne,yqe=bne,vqe=UA,xqe=1,bqe=2;function _qe(r,e){return mqe(r)&&gqe(e)?yqe(vqe(r),e):function(n){var i=dqe(n,r);return i===void 0&&i===e?pqe(n,r):fqe(e,i,xqe|bqe)}}var wqe=_qe;function Sqe(r){return r}var Dy=Sqe;function Tqe(r){return function(e){return e==null?void 0:e[r]}}var Eqe=Tqe,Mqe=_B;function Aqe(r){return function(e){return Mqe(e,r)}}var Cqe=Aqe,Pqe=Eqe,Rqe=Cqe,Nqe=pB,Oqe=UA;function Dqe(r){return Nqe(r)?Pqe(Oqe(r)):Rqe(r)}var kqe=Dqe,Iqe=Z7e,Lqe=wqe,Fqe=Dy,Bqe=co,Uqe=kqe;function zqe(r){return typeof r=="function"?r:r==null?Fqe:typeof r=="object"?Bqe(r)?Lqe(r[0],r[1]):Iqe(r):Uqe(r)}var Xl=zqe;function $qe(r,e,n,i){for(var s=r.length,o=n+(i?1:-1);i?o--:++o<s;)if(e(r[o],o,r))return o;return-1}var _ne=$qe;function jqe(r){return r!==r}var Vqe=jqe;function Gqe(r,e,n){for(var i=n-1,s=r.length;++i<s;)if(r[i]===e)return i;return-1}var Hqe=Gqe,Wqe=_ne,qqe=Vqe,Xqe=Hqe;function Kqe(r,e,n){return e===e?Xqe(r,e,n):Wqe(r,qqe,n)}var Yqe=Kqe,Zqe=Yqe;function Qqe(r,e){var n=r==null?0:r.length;return!!n&&Zqe(r,e,0)>-1}var Jqe=Qqe;function eXe(r,e,n){for(var i=-1,s=r==null?0:r.length;++i<s;)if(n(e,r[i]))return!0;return!1}var tXe=eXe;function nXe(){}var rXe=nXe,JN=gne,iXe=rXe,sXe=NB,oXe=1/0,aXe=JN&&1/sXe(new JN([,-0]))[1]==oXe?function(r){return new JN(r)}:iXe,lXe=aXe,cXe=one,uXe=Jqe,hXe=tXe,fXe=lne,dXe=lXe,pXe=NB,mXe=200;function gXe(r,e,n){var i=-1,s=uXe,o=r.length,a=!0,l=[],c=l;if(n)a=!1,s=hXe;else if(o>=mXe){var u=e?null:dXe(r);if(u)return pXe(u);a=!1,s=fXe,c=new cXe}else c=e?[]:l;e:for(;++i<o;){var h=r[i],f=e?e(h):h;if(h=n||h!==0?h:0,a&&f===f){for(var d=c.length;d--;)if(c[d]===f)continue e;e&&c.push(f),l.push(h)}else s(c,f,n)||(c!==l&&c.push(f),l.push(h))}return l}var yXe=gXe,vXe=Xl,xXe=yXe;function bXe(r,e){return r&&r.length?xXe(r,vXe(e)):[]}var _Xe=bXe;const w8=hn(_Xe);function wne(r,e,n){return e===!0?w8(r,n):Ut(e)?w8(r,e):r}function Dg(r){"@babel/helpers - typeof";return Dg=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Dg(r)}var wXe=["ref"];function S8(r,e){var n=Object.keys(r);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(r);e&&(i=i.filter(function(s){return Object.getOwnPropertyDescriptor(r,s).enumerable})),n.push.apply(n,i)}return n}function vc(r){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?S8(Object(n),!0).forEach(function(i){tC(r,i,n[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(n)):S8(Object(n)).forEach(function(i){Object.defineProperty(r,i,Object.getOwnPropertyDescriptor(n,i))})}return r}function SXe(r,e){if(!(r instanceof e))throw new TypeError("Cannot call a class as a function")}function T8(r,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(r,Tne(i.key),i)}}function TXe(r,e,n){return e&&T8(r.prototype,e),n&&T8(r,n),Object.defineProperty(r,"prototype",{writable:!1}),r}function EXe(r,e,n){return e=DE(e),MXe(r,Sne()?Reflect.construct(e,n||[],DE(r).constructor):e.apply(r,n))}function MXe(r,e){if(e&&(Dg(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return AXe(r)}function AXe(r){if(r===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return r}function Sne(){try{var r=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(Sne=function(){return!!r})()}function DE(r){return DE=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(n){return n.__proto__||Object.getPrototypeOf(n)},DE(r)}function CXe(r,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");r.prototype=Object.create(e&&e.prototype,{constructor:{value:r,writable:!0,configurable:!0}}),Object.defineProperty(r,"prototype",{writable:!1}),e&&hk(r,e)}function hk(r,e){return hk=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(i,s){return i.__proto__=s,i},hk(r,e)}function tC(r,e,n){return e=Tne(e),e in r?Object.defineProperty(r,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):r[e]=n,r}function Tne(r){var e=PXe(r,"string");return Dg(e)=="symbol"?e:e+""}function PXe(r,e){if(Dg(r)!="object"||!r)return r;var n=r[Symbol.toPrimitive];if(n!==void 0){var i=n.call(r,e||"default");if(Dg(i)!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(r)}function RXe(r,e){if(r==null)return{};var n=NXe(r,e),i,s;if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(r);for(s=0;s<o.length;s++)i=o[s],!(e.indexOf(i)>=0)&&Object.prototype.propertyIsEnumerable.call(r,i)&&(n[i]=r[i])}return n}function NXe(r,e){if(r==null)return{};var n={};for(var i in r)if(Object.prototype.hasOwnProperty.call(r,i)){if(e.indexOf(i)>=0)continue;n[i]=r[i]}return n}function OXe(r){return r.value}function DXe(r,e){if(Z.isValidElement(r))return Z.cloneElement(r,e);if(typeof r=="function")return Z.createElement(r,e);e.ref;var n=RXe(e,wXe);return Z.createElement(RB,n)}var E8=1,Qc=function(r){function e(){var n;SXe(this,e);for(var i=arguments.length,s=new Array(i),o=0;o<i;o++)s[o]=arguments[o];return n=EXe(this,e,[].concat(s)),tC(n,"lastBoundingBox",{width:-1,height:-1}),n}return CXe(e,r),TXe(e,[{key:"componentDidMount",value:function(){this.updateBBox()}},{key:"componentDidUpdate",value:function(){this.updateBBox()}},{key:"getBBox",value:function(){if(this.wrapperNode&&this.wrapperNode.getBoundingClientRect){var i=this.wrapperNode.getBoundingClientRect();return i.height=this.wrapperNode.offsetHeight,i.width=this.wrapperNode.offsetWidth,i}return null}},{key:"updateBBox",value:function(){var i=this.props.onBBoxUpdate,s=this.getBBox();s?(Math.abs(s.width-this.lastBoundingBox.width)>E8||Math.abs(s.height-this.lastBoundingBox.height)>E8)&&(this.lastBoundingBox.width=s.width,this.lastBoundingBox.height=s.height,i&&i(s)):(this.lastBoundingBox.width!==-1||this.lastBoundingBox.height!==-1)&&(this.lastBoundingBox.width=-1,this.lastBoundingBox.height=-1,i&&i(null))}},{key:"getBBoxSnapshot",value:function(){return this.lastBoundingBox.width>=0&&this.lastBoundingBox.height>=0?vc({},this.lastBoundingBox):{width:0,height:0}}},{key:"getDefaultPosition",value:function(i){var s=this.props,o=s.layout,a=s.align,l=s.verticalAlign,c=s.margin,u=s.chartWidth,h=s.chartHeight,f,d;if(!i||(i.left===void 0||i.left===null)&&(i.right===void 0||i.right===null))if(a==="center"&&o==="vertical"){var p=this.getBBoxSnapshot();f={left:((u||0)-p.width)/2}}else f=a==="right"?{right:c&&c.right||0}:{left:c&&c.left||0};if(!i||(i.top===void 0||i.top===null)&&(i.bottom===void 0||i.bottom===null))if(l==="middle"){var m=this.getBBoxSnapshot();d={top:((h||0)-m.height)/2}}else d=l==="bottom"?{bottom:c&&c.bottom||0}:{top:c&&c.top||0};return vc(vc({},f),d)}},{key:"render",value:function(){var i=this,s=this.props,o=s.content,a=s.width,l=s.height,c=s.wrapperStyle,u=s.payloadUniqBy,h=s.payload,f=vc(vc({position:"absolute",width:a||"auto",height:l||"auto"},this.getDefaultPosition(c)),c);return Z.createElement("div",{className:"recharts-legend-wrapper",style:f,ref:function(p){i.wrapperNode=p}},DXe(o,vc(vc({},this.props),{},{payload:wne(h,u,OXe)})))}}],[{key:"getWithHeight",value:function(i,s){var o=vc(vc({},this.defaultProps),i.props),a=o.layout;return a==="vertical"&&We(i.props.height)?{height:i.props.height}:a==="horizontal"?{width:i.props.width||s}:null}}])}(te.PureComponent);tC(Qc,"displayName","Legend");tC(Qc,"defaultProps",{iconSize:14,layout:"horizontal",align:"center",verticalAlign:"bottom"});var M8=D_,kXe=OB,IXe=co,A8=M8?M8.isConcatSpreadable:void 0;function LXe(r){return IXe(r)||kXe(r)||!!(A8&&r&&r[A8])}var FXe=LXe,BXe=une,UXe=FXe;function Ene(r,e,n,i,s){var o=-1,a=r.length;for(n||(n=UXe),s||(s=[]);++o<a;){var l=r[o];e>0&&n(l)?e>1?Ene(l,e-1,n,i,s):BXe(s,l):i||(s[s.length]=l)}return s}var Mne=Ene;function zXe(r){return function(e,n,i){for(var s=-1,o=Object(e),a=i(e),l=a.length;l--;){var c=a[r?l:++s];if(n(o[c],c,o)===!1)break}return e}}var $Xe=zXe,jXe=$Xe,VXe=jXe(),GXe=VXe,HXe=GXe,WXe=eC;function qXe(r,e){return r&&HXe(r,e,WXe)}var Ane=qXe,XXe=L_;function KXe(r,e){return function(n,i){if(n==null)return n;if(!XXe(n))return r(n,i);for(var s=n.length,o=e?s:-1,a=Object(n);(e?o--:++o<s)&&i(a[o],o,a)!==!1;);return n}}var YXe=KXe,ZXe=Ane,QXe=YXe,JXe=QXe(ZXe),LB=JXe,eKe=LB,tKe=L_;function nKe(r,e){var n=-1,i=tKe(r)?Array(r.length):[];return eKe(r,function(s,o,a){i[++n]=e(s,o,a)}),i}var Cne=nKe;function rKe(r,e){var n=r.length;for(r.sort(e);n--;)r[n]=r[n].value;return r}var iKe=rKe,C8=My;function sKe(r,e){if(r!==e){var n=r!==void 0,i=r===null,s=r===r,o=C8(r),a=e!==void 0,l=e===null,c=e===e,u=C8(e);if(!l&&!u&&!o&&r>e||o&&a&&c&&!l&&!u||i&&a&&c||!n&&c||!s)return 1;if(!i&&!o&&!u&&r<e||u&&n&&s&&!i&&!o||l&&n&&s||!a&&s||!c)return-1}return 0}var oKe=sKe,aKe=oKe;function lKe(r,e,n){for(var i=-1,s=r.criteria,o=e.criteria,a=s.length,l=n.length;++i<a;){var c=aKe(s[i],o[i]);if(c){if(i>=l)return c;var u=n[i];return c*(u=="desc"?-1:1)}}return r.index-e.index}var cKe=lKe,e2=bB,uKe=_B,hKe=Xl,fKe=Cne,dKe=iKe,pKe=dne,mKe=cKe,gKe=Dy,yKe=co;function vKe(r,e,n){e.length?e=e2(e,function(o){return yKe(o)?function(a){return uKe(a,o.length===1?o[0]:o)}:o}):e=[gKe];var i=-1;e=e2(e,pKe(hKe));var s=fKe(r,function(o,a,l){var c=e2(e,function(u){return u(o)});return{criteria:c,index:++i,value:o}});return dKe(s,function(o,a){return mKe(o,a,n)})}var xKe=vKe;function bKe(r,e,n){switch(n.length){case 0:return r.call(e);case 1:return r.call(e,n[0]);case 2:return r.call(e,n[0],n[1]);case 3:return r.call(e,n[0],n[1],n[2])}return r.apply(e,n)}var _Ke=bKe,wKe=_Ke,P8=Math.max;function SKe(r,e,n){return e=P8(e===void 0?r.length-1:e,0),function(){for(var i=arguments,s=-1,o=P8(i.length-e,0),a=Array(o);++s<o;)a[s]=i[e+s];s=-1;for(var l=Array(e+1);++s<e;)l[s]=i[s];return l[e]=n(a),wKe(r,this,l)}}var TKe=SKe;function EKe(r){return function(){return r}}var MKe=EKe,AKe=Fd,CKe=function(){try{var r=AKe(Object,"defineProperty");return r({},"",{}),r}catch{}}(),Pne=CKe,PKe=MKe,R8=Pne,RKe=Dy,NKe=R8?function(r,e){return R8(r,"toString",{configurable:!0,enumerable:!1,value:PKe(e),writable:!0})}:RKe,OKe=NKe,DKe=800,kKe=16,IKe=Date.now;function LKe(r){var e=0,n=0;return function(){var i=IKe(),s=kKe-(i-n);if(n=i,s>0){if(++e>=DKe)return arguments[0]}else e=0;return r.apply(void 0,arguments)}}var FKe=LKe,BKe=OKe,UKe=FKe,zKe=UKe(BKe),$Ke=zKe,jKe=Dy,VKe=TKe,GKe=$Ke;function HKe(r,e){return GKe(VKe(r,e,jKe),r+"")}var WKe=HKe,qKe=gB,XKe=L_,KKe=DB,YKe=Zh;function ZKe(r,e,n){if(!YKe(n))return!1;var i=typeof e;return(i=="number"?XKe(n)&&KKe(e,n.length):i=="string"&&e in n)?qKe(n[e],r):!1}var nC=ZKe,QKe=Mne,JKe=xKe,eYe=WKe,N8=nC,tYe=eYe(function(r,e){if(r==null)return[];var n=e.length;return n>1&&N8(r,e[0],e[1])?e=[]:n>2&&N8(e[0],e[1],e[2])&&(e=[e[0]]),JKe(r,QKe(e,1),[])}),nYe=tYe;const FB=hn(nYe);function yb(r){"@babel/helpers - typeof";return yb=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},yb(r)}function fk(){return fk=Object.assign?Object.assign.bind():function(r){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(r[i]=n[i])}return r},fk.apply(this,arguments)}function rYe(r,e){return aYe(r)||oYe(r,e)||sYe(r,e)||iYe()}function iYe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function sYe(r,e){if(r){if(typeof r=="string")return O8(r,e);var n=Object.prototype.toString.call(r).slice(8,-1);if(n==="Object"&&r.constructor&&(n=r.constructor.name),n==="Map"||n==="Set")return Array.from(r);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return O8(r,e)}}function O8(r,e){(e==null||e>r.length)&&(e=r.length);for(var n=0,i=new Array(e);n<e;n++)i[n]=r[n];return i}function oYe(r,e){var n=r==null?null:typeof Symbol<"u"&&r[Symbol.iterator]||r["@@iterator"];if(n!=null){var i,s,o,a,l=[],c=!0,u=!1;try{if(o=(n=n.call(r)).next,e!==0)for(;!(c=(i=o.call(n)).done)&&(l.push(i.value),l.length!==e);c=!0);}catch(h){u=!0,s=h}finally{try{if(!c&&n.return!=null&&(a=n.return(),Object(a)!==a))return}finally{if(u)throw s}}return l}}function aYe(r){if(Array.isArray(r))return r}function D8(r,e){var n=Object.keys(r);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(r);e&&(i=i.filter(function(s){return Object.getOwnPropertyDescriptor(r,s).enumerable})),n.push.apply(n,i)}return n}function t2(r){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?D8(Object(n),!0).forEach(function(i){lYe(r,i,n[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(n)):D8(Object(n)).forEach(function(i){Object.defineProperty(r,i,Object.getOwnPropertyDescriptor(n,i))})}return r}function lYe(r,e,n){return e=cYe(e),e in r?Object.defineProperty(r,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):r[e]=n,r}function cYe(r){var e=uYe(r,"string");return yb(e)=="symbol"?e:e+""}function uYe(r,e){if(yb(r)!="object"||!r)return r;var n=r[Symbol.toPrimitive];if(n!==void 0){var i=n.call(r,e||"default");if(yb(i)!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(r)}function hYe(r){return Array.isArray(r)&&ci(r[0])&&ci(r[1])?r.join(" ~ "):r}var fYe=function(e){var n=e.separator,i=n===void 0?" : ":n,s=e.contentStyle,o=s===void 0?{}:s,a=e.itemStyle,l=a===void 0?{}:a,c=e.labelStyle,u=c===void 0?{}:c,h=e.payload,f=e.formatter,d=e.itemSorter,p=e.wrapperClassName,m=e.labelClassName,g=e.label,v=e.labelFormatter,y=e.accessibilityLayer,x=y===void 0?!1:y,b=function(){if(h&&h.length){var D={padding:0,margin:0},B=(d?FB(h,d):h).map(function(C,O){if(C.type==="none")return null;var R=t2({display:"block",paddingTop:4,paddingBottom:4,color:C.color||"#000"},l),z=C.formatter||f||hYe,U=C.value,G=C.name,H=U,Y=G;if(z&&H!=null&&Y!=null){var ee=z(U,G,C,O,h);if(Array.isArray(ee)){var he=rYe(ee,2);H=he[0],Y=he[1]}else H=ee}return Z.createElement("li",{className:"recharts-tooltip-item",key:"tooltip-item-".concat(O),style:R},ci(Y)?Z.createElement("span",{className:"recharts-tooltip-item-name"},Y):null,ci(Y)?Z.createElement("span",{className:"recharts-tooltip-item-separator"},i):null,Z.createElement("span",{className:"recharts-tooltip-item-value"},H),Z.createElement("span",{className:"recharts-tooltip-item-unit"},C.unit||""))});return Z.createElement("ul",{className:"recharts-tooltip-item-list",style:D},B)}return null},w=t2({margin:0,padding:10,backgroundColor:"#fff",border:"1px solid #ccc",whiteSpace:"nowrap"},o),_=t2({margin:0},u),S=!nn(g),T=S?g:"",E=qt("recharts-default-tooltip",p),M=qt("recharts-tooltip-label",m);S&&v&&h!==void 0&&h!==null&&(T=v(g,h));var A=x?{role:"status","aria-live":"assertive"}:{};return Z.createElement("div",fk({className:E,style:w},A),Z.createElement("p",{className:M,style:_},Z.isValidElement(T)?T:"".concat(T)),b())};function vb(r){"@babel/helpers - typeof";return vb=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},vb(r)}function t1(r,e,n){return e=dYe(e),e in r?Object.defineProperty(r,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):r[e]=n,r}function dYe(r){var e=pYe(r,"string");return vb(e)=="symbol"?e:e+""}function pYe(r,e){if(vb(r)!="object"||!r)return r;var n=r[Symbol.toPrimitive];if(n!==void 0){var i=n.call(r,e||"default");if(vb(i)!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(r)}var Hv="recharts-tooltip-wrapper",mYe={visibility:"hidden"};function gYe(r){var e=r.coordinate,n=r.translateX,i=r.translateY;return qt(Hv,t1(t1(t1(t1({},"".concat(Hv,"-right"),We(n)&&e&&We(e.x)&&n>=e.x),"".concat(Hv,"-left"),We(n)&&e&&We(e.x)&&n<e.x),"".concat(Hv,"-bottom"),We(i)&&e&&We(e.y)&&i>=e.y),"".concat(Hv,"-top"),We(i)&&e&&We(e.y)&&i<e.y))}function k8(r){var e=r.allowEscapeViewBox,n=r.coordinate,i=r.key,s=r.offsetTopLeft,o=r.position,a=r.reverseDirection,l=r.tooltipDimension,c=r.viewBox,u=r.viewBoxDimension;if(o&&We(o[i]))return o[i];var h=n[i]-l-s,f=n[i]+s;if(e[i])return a[i]?h:f;if(a[i]){var d=h,p=c[i];return d<p?Math.max(f,c[i]):Math.max(h,c[i])}var m=f+l,g=c[i]+u;return m>g?Math.max(h,c[i]):Math.max(f,c[i])}function yYe(r){var e=r.translateX,n=r.translateY,i=r.useTranslate3d;return{transform:i?"translate3d(".concat(e,"px, ").concat(n,"px, 0)"):"translate(".concat(e,"px, ").concat(n,"px)")}}function vYe(r){var e=r.allowEscapeViewBox,n=r.coordinate,i=r.offsetTopLeft,s=r.position,o=r.reverseDirection,a=r.tooltipBox,l=r.useTranslate3d,c=r.viewBox,u,h,f;return a.height>0&&a.width>0&&n?(h=k8({allowEscapeViewBox:e,coordinate:n,key:"x",offsetTopLeft:i,position:s,reverseDirection:o,tooltipDimension:a.width,viewBox:c,viewBoxDimension:c.width}),f=k8({allowEscapeViewBox:e,coordinate:n,key:"y",offsetTopLeft:i,position:s,reverseDirection:o,tooltipDimension:a.height,viewBox:c,viewBoxDimension:c.height}),u=yYe({translateX:h,translateY:f,useTranslate3d:l})):u=mYe,{cssProperties:u,cssClasses:gYe({translateX:h,translateY:f,coordinate:n})}}function kg(r){"@babel/helpers - typeof";return kg=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},kg(r)}function I8(r,e){var n=Object.keys(r);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(r);e&&(i=i.filter(function(s){return Object.getOwnPropertyDescriptor(r,s).enumerable})),n.push.apply(n,i)}return n}function L8(r){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?I8(Object(n),!0).forEach(function(i){pk(r,i,n[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(n)):I8(Object(n)).forEach(function(i){Object.defineProperty(r,i,Object.getOwnPropertyDescriptor(n,i))})}return r}function xYe(r,e){if(!(r instanceof e))throw new TypeError("Cannot call a class as a function")}function bYe(r,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(r,Nne(i.key),i)}}function _Ye(r,e,n){return e&&bYe(r.prototype,e),Object.defineProperty(r,"prototype",{writable:!1}),r}function wYe(r,e,n){return e=kE(e),SYe(r,Rne()?Reflect.construct(e,n||[],kE(r).constructor):e.apply(r,n))}function SYe(r,e){if(e&&(kg(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return TYe(r)}function TYe(r){if(r===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return r}function Rne(){try{var r=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(Rne=function(){return!!r})()}function kE(r){return kE=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(n){return n.__proto__||Object.getPrototypeOf(n)},kE(r)}function EYe(r,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");r.prototype=Object.create(e&&e.prototype,{constructor:{value:r,writable:!0,configurable:!0}}),Object.defineProperty(r,"prototype",{writable:!1}),e&&dk(r,e)}function dk(r,e){return dk=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(i,s){return i.__proto__=s,i},dk(r,e)}function pk(r,e,n){return e=Nne(e),e in r?Object.defineProperty(r,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):r[e]=n,r}function Nne(r){var e=MYe(r,"string");return kg(e)=="symbol"?e:e+""}function MYe(r,e){if(kg(r)!="object"||!r)return r;var n=r[Symbol.toPrimitive];if(n!==void 0){var i=n.call(r,e||"default");if(kg(i)!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(r)}var F8=1,AYe=function(r){function e(){var n;xYe(this,e);for(var i=arguments.length,s=new Array(i),o=0;o<i;o++)s[o]=arguments[o];return n=wYe(this,e,[].concat(s)),pk(n,"state",{dismissed:!1,dismissedAtCoordinate:{x:0,y:0},lastBoundingBox:{width:-1,height:-1}}),pk(n,"handleKeyDown",function(a){if(a.key==="Escape"){var l,c,u,h;n.setState({dismissed:!0,dismissedAtCoordinate:{x:(l=(c=n.props.coordinate)===null||c===void 0?void 0:c.x)!==null&&l!==void 0?l:0,y:(u=(h=n.props.coordinate)===null||h===void 0?void 0:h.y)!==null&&u!==void 0?u:0}})}}),n}return EYe(e,r),_Ye(e,[{key:"updateBBox",value:function(){if(this.wrapperNode&&this.wrapperNode.getBoundingClientRect){var i=this.wrapperNode.getBoundingClientRect();(Math.abs(i.width-this.state.lastBoundingBox.width)>F8||Math.abs(i.height-this.state.lastBoundingBox.height)>F8)&&this.setState({lastBoundingBox:{width:i.width,height:i.height}})}else(this.state.lastBoundingBox.width!==-1||this.state.lastBoundingBox.height!==-1)&&this.setState({lastBoundingBox:{width:-1,height:-1}})}},{key:"componentDidMount",value:function(){document.addEventListener("keydown",this.handleKeyDown),this.updateBBox()}},{key:"componentWillUnmount",value:function(){document.removeEventListener("keydown",this.handleKeyDown)}},{key:"componentDidUpdate",value:function(){var i,s;this.props.active&&this.updateBBox(),this.state.dismissed&&(((i=this.props.coordinate)===null||i===void 0?void 0:i.x)!==this.state.dismissedAtCoordinate.x||((s=this.props.coordinate)===null||s===void 0?void 0:s.y)!==this.state.dismissedAtCoordinate.y)&&(this.state.dismissed=!1)}},{key:"render",value:function(){var i=this,s=this.props,o=s.active,a=s.allowEscapeViewBox,l=s.animationDuration,c=s.animationEasing,u=s.children,h=s.coordinate,f=s.hasPayload,d=s.isAnimationActive,p=s.offset,m=s.position,g=s.reverseDirection,v=s.useTranslate3d,y=s.viewBox,x=s.wrapperStyle,b=vYe({allowEscapeViewBox:a,coordinate:h,offsetTopLeft:p,position:m,reverseDirection:g,tooltipBox:this.state.lastBoundingBox,useTranslate3d:v,viewBox:y}),w=b.cssClasses,_=b.cssProperties,S=L8(L8({transition:d&&o?"transform ".concat(l,"ms ").concat(c):void 0},_),{},{pointerEvents:"none",visibility:!this.state.dismissed&&o&&f?"visible":"hidden",position:"absolute",top:0,left:0},x);return Z.createElement("div",{tabIndex:-1,className:w,style:S,ref:function(E){i.wrapperNode=E}},u)}}])}(te.PureComponent),CYe=function(){return!(typeof window<"u"&&window.document&&window.document.createElement&&window.setTimeout)},Il={isSsr:CYe(),get:function(e){return Il[e]},set:function(e,n){if(typeof e=="string")Il[e]=n;else{var i=Object.keys(e);i&&i.length&&i.forEach(function(s){Il[s]=e[s]})}}};function Ig(r){"@babel/helpers - typeof";return Ig=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Ig(r)}function B8(r,e){var n=Object.keys(r);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(r);e&&(i=i.filter(function(s){return Object.getOwnPropertyDescriptor(r,s).enumerable})),n.push.apply(n,i)}return n}function U8(r){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?B8(Object(n),!0).forEach(function(i){BB(r,i,n[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(n)):B8(Object(n)).forEach(function(i){Object.defineProperty(r,i,Object.getOwnPropertyDescriptor(n,i))})}return r}function PYe(r,e){if(!(r instanceof e))throw new TypeError("Cannot call a class as a function")}function RYe(r,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(r,Dne(i.key),i)}}function NYe(r,e,n){return e&&RYe(r.prototype,e),Object.defineProperty(r,"prototype",{writable:!1}),r}function OYe(r,e,n){return e=IE(e),DYe(r,One()?Reflect.construct(e,n||[],IE(r).constructor):e.apply(r,n))}function DYe(r,e){if(e&&(Ig(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return kYe(r)}function kYe(r){if(r===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return r}function One(){try{var r=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(One=function(){return!!r})()}function IE(r){return IE=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(n){return n.__proto__||Object.getPrototypeOf(n)},IE(r)}function IYe(r,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");r.prototype=Object.create(e&&e.prototype,{constructor:{value:r,writable:!0,configurable:!0}}),Object.defineProperty(r,"prototype",{writable:!1}),e&&mk(r,e)}function mk(r,e){return mk=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(i,s){return i.__proto__=s,i},mk(r,e)}function BB(r,e,n){return e=Dne(e),e in r?Object.defineProperty(r,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):r[e]=n,r}function Dne(r){var e=LYe(r,"string");return Ig(e)=="symbol"?e:e+""}function LYe(r,e){if(Ig(r)!="object"||!r)return r;var n=r[Symbol.toPrimitive];if(n!==void 0){var i=n.call(r,e||"default");if(Ig(i)!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(r)}function FYe(r){return r.dataKey}function BYe(r,e){return Z.isValidElement(r)?Z.cloneElement(r,e):typeof r=="function"?Z.createElement(r,e):Z.createElement(fYe,e)}var Fa=function(r){function e(){return PYe(this,e),OYe(this,e,arguments)}return IYe(e,r),NYe(e,[{key:"render",value:function(){var i=this,s=this.props,o=s.active,a=s.allowEscapeViewBox,l=s.animationDuration,c=s.animationEasing,u=s.content,h=s.coordinate,f=s.filterNull,d=s.isAnimationActive,p=s.offset,m=s.payload,g=s.payloadUniqBy,v=s.position,y=s.reverseDirection,x=s.useTranslate3d,b=s.viewBox,w=s.wrapperStyle,_=m??[];f&&_.length&&(_=wne(m.filter(function(T){return T.value!=null&&(T.hide!==!0||i.props.includeHidden)}),g,FYe));var S=_.length>0;return Z.createElement(AYe,{allowEscapeViewBox:a,animationDuration:l,animationEasing:c,isAnimationActive:d,active:o,coordinate:h,hasPayload:S,offset:p,position:v,reverseDirection:y,useTranslate3d:x,viewBox:b,wrapperStyle:w},BYe(u,U8(U8({},this.props),{},{payload:_})))}}])}(te.PureComponent);BB(Fa,"displayName","Tooltip");BB(Fa,"defaultProps",{accessibilityLayer:!1,allowEscapeViewBox:{x:!1,y:!1},animationDuration:400,animationEasing:"ease",contentStyle:{},coordinate:{x:0,y:0},cursor:!0,cursorStyle:{},filterNull:!0,isAnimationActive:!Il.isSsr,itemStyle:{},labelStyle:{},offset:10,reverseDirection:{x:!1,y:!1},separator:" : ",trigger:"hover",useTranslate3d:!1,viewBox:{x:0,y:0,height:0,width:0},wrapperStyle:{}});var UYe=ql,zYe=function(){return UYe.Date.now()},$Ye=zYe,jYe=/\s/;function VYe(r){for(var e=r.length;e--&&jYe.test(r.charAt(e)););return e}var GYe=VYe,HYe=GYe,WYe=/^\s+/;function qYe(r){return r&&r.slice(0,HYe(r)+1).replace(WYe,"")}var XYe=qYe,KYe=XYe,z8=Zh,YYe=My,$8=NaN,ZYe=/^[-+]0x[0-9a-f]+$/i,QYe=/^0b[01]+$/i,JYe=/^0o[0-7]+$/i,eZe=parseInt;function tZe(r){if(typeof r=="number")return r;if(YYe(r))return $8;if(z8(r)){var e=typeof r.valueOf=="function"?r.valueOf():r;r=z8(e)?e+"":e}if(typeof r!="string")return r===0?r:+r;r=KYe(r);var n=QYe.test(r);return n||JYe.test(r)?eZe(r.slice(2),n?2:8):ZYe.test(r)?$8:+r}var kne=tZe,nZe=Zh,n2=$Ye,j8=kne,rZe="Expected a function",iZe=Math.max,sZe=Math.min;function oZe(r,e,n){var i,s,o,a,l,c,u=0,h=!1,f=!1,d=!0;if(typeof r!="function")throw new TypeError(rZe);e=j8(e)||0,nZe(n)&&(h=!!n.leading,f="maxWait"in n,o=f?iZe(j8(n.maxWait)||0,e):o,d="trailing"in n?!!n.trailing:d);function p(S){var T=i,E=s;return i=s=void 0,u=S,a=r.apply(E,T),a}function m(S){return u=S,l=setTimeout(y,e),h?p(S):a}function g(S){var T=S-c,E=S-u,M=e-T;return f?sZe(M,o-E):M}function v(S){var T=S-c,E=S-u;return c===void 0||T>=e||T<0||f&&E>=o}function y(){var S=n2();if(v(S))return x(S);l=setTimeout(y,g(S))}function x(S){return l=void 0,d&&i?p(S):(i=s=void 0,a)}function b(){l!==void 0&&clearTimeout(l),u=0,i=c=s=l=void 0}function w(){return l===void 0?a:x(n2())}function _(){var S=n2(),T=v(S);if(i=arguments,s=this,c=S,T){if(l===void 0)return m(c);if(f)return clearTimeout(l),l=setTimeout(y,e),p(c)}return l===void 0&&(l=setTimeout(y,e)),a}return _.cancel=b,_.flush=w,_}var aZe=oZe,lZe=aZe,cZe=Zh,uZe="Expected a function";function hZe(r,e,n){var i=!0,s=!0;if(typeof r!="function")throw new TypeError(uZe);return cZe(n)&&(i="leading"in n?!!n.leading:i,s="trailing"in n?!!n.trailing:s),lZe(r,e,{leading:i,maxWait:e,trailing:s})}var fZe=hZe;const Ine=hn(fZe);function xb(r){"@babel/helpers - typeof";return xb=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},xb(r)}function V8(r,e){var n=Object.keys(r);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(r);e&&(i=i.filter(function(s){return Object.getOwnPropertyDescriptor(r,s).enumerable})),n.push.apply(n,i)}return n}function n1(r){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?V8(Object(n),!0).forEach(function(i){dZe(r,i,n[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(n)):V8(Object(n)).forEach(function(i){Object.defineProperty(r,i,Object.getOwnPropertyDescriptor(n,i))})}return r}function dZe(r,e,n){return e=pZe(e),e in r?Object.defineProperty(r,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):r[e]=n,r}function pZe(r){var e=mZe(r,"string");return xb(e)=="symbol"?e:e+""}function mZe(r,e){if(xb(r)!="object"||!r)return r;var n=r[Symbol.toPrimitive];if(n!==void 0){var i=n.call(r,e||"default");if(xb(i)!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(r)}function gZe(r,e){return bZe(r)||xZe(r,e)||vZe(r,e)||yZe()}function yZe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function vZe(r,e){if(r){if(typeof r=="string")return G8(r,e);var n=Object.prototype.toString.call(r).slice(8,-1);if(n==="Object"&&r.constructor&&(n=r.constructor.name),n==="Map"||n==="Set")return Array.from(r);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return G8(r,e)}}function G8(r,e){(e==null||e>r.length)&&(e=r.length);for(var n=0,i=new Array(e);n<e;n++)i[n]=r[n];return i}function xZe(r,e){var n=r==null?null:typeof Symbol<"u"&&r[Symbol.iterator]||r["@@iterator"];if(n!=null){var i,s,o,a,l=[],c=!0,u=!1;try{if(o=(n=n.call(r)).next,e!==0)for(;!(c=(i=o.call(n)).done)&&(l.push(i.value),l.length!==e);c=!0);}catch(h){u=!0,s=h}finally{try{if(!c&&n.return!=null&&(a=n.return(),Object(a)!==a))return}finally{if(u)throw s}}return l}}function bZe(r){if(Array.isArray(r))return r}var r2=te.forwardRef(function(r,e){var n=r.aspect,i=r.initialDimension,s=i===void 0?{width:-1,height:-1}:i,o=r.width,a=o===void 0?"100%":o,l=r.height,c=l===void 0?"100%":l,u=r.minWidth,h=u===void 0?0:u,f=r.minHeight,d=r.maxHeight,p=r.children,m=r.debounce,g=m===void 0?0:m,v=r.id,y=r.className,x=r.onResize,b=r.style,w=b===void 0?{}:b,_=te.useRef(null),S=te.useRef();S.current=x,te.useImperativeHandle(e,function(){return Object.defineProperty(_.current,"current",{get:function(){return console.warn("The usage of ref.current.current is deprecated and will no longer be supported."),_.current},configurable:!0})});var T=te.useState({containerWidth:s.width,containerHeight:s.height}),E=gZe(T,2),M=E[0],A=E[1],P=te.useCallback(function(B,C){A(function(O){var R=Math.round(B),z=Math.round(C);return O.containerWidth===R&&O.containerHeight===z?O:{containerWidth:R,containerHeight:z}})},[]);te.useEffect(function(){var B=function(G){var H,Y=G[0].contentRect,ee=Y.width,he=Y.height;P(ee,he),(H=S.current)===null||H===void 0||H.call(S,ee,he)};g>0&&(B=Ine(B,g,{trailing:!0,leading:!1}));var C=new ResizeObserver(B),O=_.current.getBoundingClientRect(),R=O.width,z=O.height;return P(R,z),C.observe(_.current),function(){C.disconnect()}},[P,g]);var D=te.useMemo(function(){var B=M.containerWidth,C=M.containerHeight;if(B<0||C<0)return null;Zc(qf(a)||qf(c),`The width(%s) and height(%s) are both fixed numbers,
       maybe you don't need to use a ResponsiveContainer.`,a,c),Zc(!n||n>0,"The aspect(%s) must be greater than zero.",n);var O=qf(a)?B:a,R=qf(c)?C:c;n&&n>0&&(O?R=O/n:R&&(O=R*n),d&&R>d&&(R=d)),Zc(O>0||R>0,`The width(%s) and height(%s) of chart should be greater than 0,
       please check the style of container, or the props width(%s) and height(%s),
       or add a minWidth(%s) or minHeight(%s) or use aspect(%s) to control the
       height and width.`,O,R,a,c,h,f,n);var z=!Array.isArray(p)&&Yc(p.type).endsWith("Chart");return Z.Children.map(p,function(U){return Z.isValidElement(U)?te.cloneElement(U,n1({width:O,height:R},z?{style:n1({height:"100%",width:"100%",maxHeight:R,maxWidth:O},U.props.style)}:{})):U})},[n,p,c,d,f,h,M,a]);return Z.createElement("div",{id:v?"".concat(v):void 0,className:qt("recharts-responsive-container",y),style:n1(n1({},w),{},{width:a,height:c,minWidth:h,minHeight:f,maxHeight:d}),ref:_},D)}),Lne=function(e){return null};Lne.displayName="Cell";function bb(r){"@babel/helpers - typeof";return bb=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},bb(r)}function H8(r,e){var n=Object.keys(r);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(r);e&&(i=i.filter(function(s){return Object.getOwnPropertyDescriptor(r,s).enumerable})),n.push.apply(n,i)}return n}function gk(r){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?H8(Object(n),!0).forEach(function(i){_Ze(r,i,n[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(n)):H8(Object(n)).forEach(function(i){Object.defineProperty(r,i,Object.getOwnPropertyDescriptor(n,i))})}return r}function _Ze(r,e,n){return e=wZe(e),e in r?Object.defineProperty(r,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):r[e]=n,r}function wZe(r){var e=SZe(r,"string");return bb(e)=="symbol"?e:e+""}function SZe(r,e){if(bb(r)!="object"||!r)return r;var n=r[Symbol.toPrimitive];if(n!==void 0){var i=n.call(r,e||"default");if(bb(i)!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(r)}var kp={widthCache:{},cacheCount:0},TZe=2e3,EZe={position:"absolute",top:"-20000px",left:0,padding:0,margin:0,border:"none",whiteSpace:"pre"},W8="recharts_measurement_span";function MZe(r){var e=gk({},r);return Object.keys(e).forEach(function(n){e[n]||delete e[n]}),e}var X0=function(e){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(e==null||Il.isSsr)return{width:0,height:0};var i=MZe(n),s=JSON.stringify({text:e,copyStyle:i});if(kp.widthCache[s])return kp.widthCache[s];try{var o=document.getElementById(W8);o||(o=document.createElement("span"),o.setAttribute("id",W8),o.setAttribute("aria-hidden","true"),document.body.appendChild(o));var a=gk(gk({},EZe),i);Object.assign(o.style,a),o.textContent="".concat(e);var l=o.getBoundingClientRect(),c={width:l.width,height:l.height};return kp.widthCache[s]=c,++kp.cacheCount>TZe&&(kp.cacheCount=0,kp.widthCache={}),c}catch{return{width:0,height:0}}},AZe=function(e){return{top:e.top+window.scrollY-document.documentElement.clientTop,left:e.left+window.scrollX-document.documentElement.clientLeft}};function _b(r){"@babel/helpers - typeof";return _b=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},_b(r)}function LE(r,e){return NZe(r)||RZe(r,e)||PZe(r,e)||CZe()}function CZe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function PZe(r,e){if(r){if(typeof r=="string")return q8(r,e);var n=Object.prototype.toString.call(r).slice(8,-1);if(n==="Object"&&r.constructor&&(n=r.constructor.name),n==="Map"||n==="Set")return Array.from(r);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return q8(r,e)}}function q8(r,e){(e==null||e>r.length)&&(e=r.length);for(var n=0,i=new Array(e);n<e;n++)i[n]=r[n];return i}function RZe(r,e){var n=r==null?null:typeof Symbol<"u"&&r[Symbol.iterator]||r["@@iterator"];if(n!=null){var i,s,o,a,l=[],c=!0,u=!1;try{if(o=(n=n.call(r)).next,e===0){if(Object(n)!==n)return;c=!1}else for(;!(c=(i=o.call(n)).done)&&(l.push(i.value),l.length!==e);c=!0);}catch(h){u=!0,s=h}finally{try{if(!c&&n.return!=null&&(a=n.return(),Object(a)!==a))return}finally{if(u)throw s}}return l}}function NZe(r){if(Array.isArray(r))return r}function OZe(r,e){if(!(r instanceof e))throw new TypeError("Cannot call a class as a function")}function X8(r,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(r,kZe(i.key),i)}}function DZe(r,e,n){return e&&X8(r.prototype,e),n&&X8(r,n),Object.defineProperty(r,"prototype",{writable:!1}),r}function kZe(r){var e=IZe(r,"string");return _b(e)=="symbol"?e:e+""}function IZe(r,e){if(_b(r)!="object"||!r)return r;var n=r[Symbol.toPrimitive];if(n!==void 0){var i=n.call(r,e);if(_b(i)!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(r)}var K8=/(-?\d+(?:\.\d+)?[a-zA-Z%]*)([*/])(-?\d+(?:\.\d+)?[a-zA-Z%]*)/,Y8=/(-?\d+(?:\.\d+)?[a-zA-Z%]*)([+-])(-?\d+(?:\.\d+)?[a-zA-Z%]*)/,LZe=/^px|cm|vh|vw|em|rem|%|mm|in|pt|pc|ex|ch|vmin|vmax|Q$/,FZe=/(-?\d+(?:\.\d+)?)([a-zA-Z%]+)?/,Fne={cm:96/2.54,mm:96/25.4,pt:96/72,pc:96/6,in:96,Q:96/(2.54*40),px:1},BZe=Object.keys(Fne),mm="NaN";function UZe(r,e){return r*Fne[e]}var r1=function(){function r(e,n){OZe(this,r),this.num=e,this.unit=n,this.num=e,this.unit=n,Number.isNaN(e)&&(this.unit=""),n!==""&&!LZe.test(n)&&(this.num=NaN,this.unit=""),BZe.includes(n)&&(this.num=UZe(e,n),this.unit="px")}return DZe(r,[{key:"add",value:function(n){return this.unit!==n.unit?new r(NaN,""):new r(this.num+n.num,this.unit)}},{key:"subtract",value:function(n){return this.unit!==n.unit?new r(NaN,""):new r(this.num-n.num,this.unit)}},{key:"multiply",value:function(n){return this.unit!==""&&n.unit!==""&&this.unit!==n.unit?new r(NaN,""):new r(this.num*n.num,this.unit||n.unit)}},{key:"divide",value:function(n){return this.unit!==""&&n.unit!==""&&this.unit!==n.unit?new r(NaN,""):new r(this.num/n.num,this.unit||n.unit)}},{key:"toString",value:function(){return"".concat(this.num).concat(this.unit)}},{key:"isNaN",value:function(){return Number.isNaN(this.num)}}],[{key:"parse",value:function(n){var i,s=(i=FZe.exec(n))!==null&&i!==void 0?i:[],o=LE(s,3),a=o[1],l=o[2];return new r(parseFloat(a),l??"")}}])}();function Bne(r){if(r.includes(mm))return mm;for(var e=r;e.includes("*")||e.includes("/");){var n,i=(n=K8.exec(e))!==null&&n!==void 0?n:[],s=LE(i,4),o=s[1],a=s[2],l=s[3],c=r1.parse(o??""),u=r1.parse(l??""),h=a==="*"?c.multiply(u):c.divide(u);if(h.isNaN())return mm;e=e.replace(K8,h.toString())}for(;e.includes("+")||/.-\d+(?:\.\d+)?/.test(e);){var f,d=(f=Y8.exec(e))!==null&&f!==void 0?f:[],p=LE(d,4),m=p[1],g=p[2],v=p[3],y=r1.parse(m??""),x=r1.parse(v??""),b=g==="+"?y.add(x):y.subtract(x);if(b.isNaN())return mm;e=e.replace(Y8,b.toString())}return e}var Z8=/\(([^()]*)\)/;function zZe(r){for(var e=r;e.includes("(");){var n=Z8.exec(e),i=LE(n,2),s=i[1];e=e.replace(Z8,Bne(s))}return e}function $Ze(r){var e=r.replace(/\s+/g,"");return e=zZe(e),e=Bne(e),e}function jZe(r){try{return $Ze(r)}catch{return mm}}function i2(r){var e=jZe(r.slice(5,-1));return e===mm?"":e}var VZe=["x","y","lineHeight","capHeight","scaleToFit","textAnchor","verticalAnchor","fill"],GZe=["dx","dy","angle","className","breakAll"];function yk(){return yk=Object.assign?Object.assign.bind():function(r){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(r[i]=n[i])}return r},yk.apply(this,arguments)}function Q8(r,e){if(r==null)return{};var n=HZe(r,e),i,s;if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(r);for(s=0;s<o.length;s++)i=o[s],!(e.indexOf(i)>=0)&&Object.prototype.propertyIsEnumerable.call(r,i)&&(n[i]=r[i])}return n}function HZe(r,e){if(r==null)return{};var n={};for(var i in r)if(Object.prototype.hasOwnProperty.call(r,i)){if(e.indexOf(i)>=0)continue;n[i]=r[i]}return n}function J8(r,e){return KZe(r)||XZe(r,e)||qZe(r,e)||WZe()}function WZe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function qZe(r,e){if(r){if(typeof r=="string")return e6(r,e);var n=Object.prototype.toString.call(r).slice(8,-1);if(n==="Object"&&r.constructor&&(n=r.constructor.name),n==="Map"||n==="Set")return Array.from(r);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return e6(r,e)}}function e6(r,e){(e==null||e>r.length)&&(e=r.length);for(var n=0,i=new Array(e);n<e;n++)i[n]=r[n];return i}function XZe(r,e){var n=r==null?null:typeof Symbol<"u"&&r[Symbol.iterator]||r["@@iterator"];if(n!=null){var i,s,o,a,l=[],c=!0,u=!1;try{if(o=(n=n.call(r)).next,e===0){if(Object(n)!==n)return;c=!1}else for(;!(c=(i=o.call(n)).done)&&(l.push(i.value),l.length!==e);c=!0);}catch(h){u=!0,s=h}finally{try{if(!c&&n.return!=null&&(a=n.return(),Object(a)!==a))return}finally{if(u)throw s}}return l}}function KZe(r){if(Array.isArray(r))return r}var Une=/[ \f\n\r\t\v\u2028\u2029]+/,zne=function(e){var n=e.children,i=e.breakAll,s=e.style;try{var o=[];nn(n)||(i?o=n.toString().split(""):o=n.toString().split(Une));var a=o.map(function(c){return{word:c,width:X0(c,s).width}}),l=i?0:X0("",s).width;return{wordsWithComputedWidth:a,spaceWidth:l}}catch{return null}},YZe=function(e,n,i,s,o){var a=e.maxLines,l=e.children,c=e.style,u=e.breakAll,h=We(a),f=l,d=function(){var O=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return O.reduce(function(R,z){var U=z.word,G=z.width,H=R[R.length-1];if(H&&(s==null||o||H.width+G+i<Number(s)))H.words.push(U),H.width+=G+i;else{var Y={words:[U],width:G};R.push(Y)}return R},[])},p=d(n),m=function(O){return O.reduce(function(R,z){return R.width>z.width?R:z})};if(!h)return p;for(var g="",v=function(O){var R=f.slice(0,O),z=zne({breakAll:u,style:c,children:R+g}).wordsWithComputedWidth,U=d(z),G=U.length>a||m(U).width>Number(s);return[G,U]},y=0,x=f.length-1,b=0,w;y<=x&&b<=f.length-1;){var _=Math.floor((y+x)/2),S=_-1,T=v(S),E=J8(T,2),M=E[0],A=E[1],P=v(_),D=J8(P,1),B=D[0];if(!M&&!B&&(y=_+1),M&&B&&(x=_-1),!M&&B){w=A;break}b++}return w||p},t6=function(e){var n=nn(e)?[]:e.toString().split(Une);return[{words:n}]},ZZe=function(e){var n=e.width,i=e.scaleToFit,s=e.children,o=e.style,a=e.breakAll,l=e.maxLines;if((n||i)&&!Il.isSsr){var c,u,h=zne({breakAll:a,children:s,style:o});if(h){var f=h.wordsWithComputedWidth,d=h.spaceWidth;c=f,u=d}else return t6(s);return YZe({breakAll:a,children:s,maxLines:l,style:o},c,u,n,i)}return t6(s)},n6="#808080",Lg=function(e){var n=e.x,i=n===void 0?0:n,s=e.y,o=s===void 0?0:s,a=e.lineHeight,l=a===void 0?"1em":a,c=e.capHeight,u=c===void 0?"0.71em":c,h=e.scaleToFit,f=h===void 0?!1:h,d=e.textAnchor,p=d===void 0?"start":d,m=e.verticalAnchor,g=m===void 0?"end":m,v=e.fill,y=v===void 0?n6:v,x=Q8(e,VZe),b=te.useMemo(function(){return ZZe({breakAll:x.breakAll,children:x.children,maxLines:x.maxLines,scaleToFit:f,style:x.style,width:x.width})},[x.breakAll,x.children,x.maxLines,f,x.style,x.width]),w=x.dx,_=x.dy,S=x.angle,T=x.className,E=x.breakAll,M=Q8(x,GZe);if(!ci(i)||!ci(o))return null;var A=i+(We(w)?w:0),P=o+(We(_)?_:0),D;switch(g){case"start":D=i2("calc(".concat(u,")"));break;case"middle":D=i2("calc(".concat((b.length-1)/2," * -").concat(l," + (").concat(u," / 2))"));break;default:D=i2("calc(".concat(b.length-1," * -").concat(l,")"));break}var B=[];if(f){var C=b[0].width,O=x.width;B.push("scale(".concat((We(O)?O/C:1)/C,")"))}return S&&B.push("rotate(".concat(S,", ").concat(A,", ").concat(P,")")),B.length&&(M.transform=B.join(" ")),Z.createElement("text",yk({},Tt(M,!0),{x:A,y:P,className:qt("recharts-text",T),textAnchor:p,fill:y.includes("url")?n6:y}),b.map(function(R,z){var U=R.words.join(E?"":" ");return Z.createElement("tspan",{x:A,dy:z===0?D:l,key:"".concat(U,"-").concat(z)},U)}))};const r6=Object.freeze(Object.defineProperty({__proto__:null,scaleBand:Qx,scaleDiverging:aQ,scaleDivergingLog:lQ,scaleDivergingPow:w3,scaleDivergingSqrt:XAe,scaleDivergingSymlog:cQ,scaleIdentity:$Z,scaleImplicit:eD,scaleLinear:tE,scaleLog:VZ,scaleOrdinal:__,scalePoint:U0,scalePow:f3,scaleQuantile:WZ,scaleQuantize:qZ,scaleRadial:HZ,scaleSequential:rQ,scaleSequentialLog:iQ,scaleSequentialPow:_3,scaleSequentialQuantile:oQ,scaleSequentialSqrt:qAe,scaleSequentialSymlog:sQ,scaleSqrt:CMe,scaleSymlog:GZ,scaleThreshold:XZ,scaleTime:HAe,scaleUtc:WAe,tickFormat:zZ},Symbol.toStringTag,{value:"Module"}));var QZe=My;function JZe(r,e,n){for(var i=-1,s=r.length;++i<s;){var o=r[i],a=e(o);if(a!=null&&(l===void 0?a===a&&!QZe(a):n(a,l)))var l=a,c=o}return c}var rC=JZe;function eQe(r,e){return r>e}var $ne=eQe,tQe=rC,nQe=$ne,rQe=Dy;function iQe(r){return r&&r.length?tQe(r,rQe,nQe):void 0}var sQe=iQe;const iC=hn(sQe);function oQe(r,e){return r<e}var jne=oQe,aQe=rC,lQe=jne,cQe=Dy;function uQe(r){return r&&r.length?aQe(r,cQe,lQe):void 0}var hQe=uQe;const sC=hn(hQe);var fQe=bB,dQe=Xl,pQe=Cne,mQe=co;function gQe(r,e){var n=mQe(r)?fQe:pQe;return n(r,dQe(e))}var yQe=gQe,vQe=Mne,xQe=yQe;function bQe(r,e){return vQe(xQe(r,e),1)}var _Qe=bQe;const wQe=hn(_Qe);var SQe=IB;function TQe(r,e){return SQe(r,e)}var EQe=TQe;const F_=hn(EQe);var ky=1e9,MQe={precision:20,rounding:4,toExpNeg:-7,toExpPos:21,LN10:"2.302585092994045684017991454684364207601101488628772976033327900967572609677352480235997205089598298341967784042286"},zB,ar=!0,pa="[DecimalError] ",sd=pa+"Invalid argument: ",UB=pa+"Exponent out of range: ",Iy=Math.floor,Nf=Math.pow,AQe=/^(\d+(\.\d*)?|\.\d+)(e[+-]?\d+)?$/i,Mo,bi=1e7,Kn=7,Vne=9007199254740991,FE=Iy(Vne/Kn),st={};st.absoluteValue=st.abs=function(){var r=new this.constructor(this);return r.s&&(r.s=1),r};st.comparedTo=st.cmp=function(r){var e,n,i,s,o=this;if(r=new o.constructor(r),o.s!==r.s)return o.s||-r.s;if(o.e!==r.e)return o.e>r.e^o.s<0?1:-1;for(i=o.d.length,s=r.d.length,e=0,n=i<s?i:s;e<n;++e)if(o.d[e]!==r.d[e])return o.d[e]>r.d[e]^o.s<0?1:-1;return i===s?0:i>s^o.s<0?1:-1};st.decimalPlaces=st.dp=function(){var r=this,e=r.d.length-1,n=(e-r.e)*Kn;if(e=r.d[e],e)for(;e%10==0;e/=10)n--;return n<0?0:n};st.dividedBy=st.div=function(r){return Jc(this,new this.constructor(r))};st.dividedToIntegerBy=st.idiv=function(r){var e=this,n=e.constructor;return Ln(Jc(e,new n(r),0,1),n.precision)};st.equals=st.eq=function(r){return!this.cmp(r)};st.exponent=function(){return Zr(this)};st.greaterThan=st.gt=function(r){return this.cmp(r)>0};st.greaterThanOrEqualTo=st.gte=function(r){return this.cmp(r)>=0};st.isInteger=st.isint=function(){return this.e>this.d.length-2};st.isNegative=st.isneg=function(){return this.s<0};st.isPositive=st.ispos=function(){return this.s>0};st.isZero=function(){return this.s===0};st.lessThan=st.lt=function(r){return this.cmp(r)<0};st.lessThanOrEqualTo=st.lte=function(r){return this.cmp(r)<1};st.logarithm=st.log=function(r){var e,n=this,i=n.constructor,s=i.precision,o=s+5;if(r===void 0)r=new i(10);else if(r=new i(r),r.s<1||r.eq(Mo))throw Error(pa+"NaN");if(n.s<1)throw Error(pa+(n.s?"NaN":"-Infinity"));return n.eq(Mo)?new i(0):(ar=!1,e=Jc(wb(n,o),wb(r,o),o),ar=!0,Ln(e,s))};st.minus=st.sub=function(r){var e=this;return r=new e.constructor(r),e.s==r.s?Wne(e,r):Gne(e,(r.s=-r.s,r))};st.modulo=st.mod=function(r){var e,n=this,i=n.constructor,s=i.precision;if(r=new i(r),!r.s)throw Error(pa+"NaN");return n.s?(ar=!1,e=Jc(n,r,0,1).times(r),ar=!0,n.minus(e)):Ln(new i(n),s)};st.naturalExponential=st.exp=function(){return Hne(this)};st.naturalLogarithm=st.ln=function(){return wb(this)};st.negated=st.neg=function(){var r=new this.constructor(this);return r.s=-r.s||0,r};st.plus=st.add=function(r){var e=this;return r=new e.constructor(r),e.s==r.s?Gne(e,r):Wne(e,(r.s=-r.s,r))};st.precision=st.sd=function(r){var e,n,i,s=this;if(r!==void 0&&r!==!!r&&r!==1&&r!==0)throw Error(sd+r);if(e=Zr(s)+1,i=s.d.length-1,n=i*Kn+1,i=s.d[i],i){for(;i%10==0;i/=10)n--;for(i=s.d[0];i>=10;i/=10)n++}return r&&e>n?e:n};st.squareRoot=st.sqrt=function(){var r,e,n,i,s,o,a,l=this,c=l.constructor;if(l.s<1){if(!l.s)return new c(0);throw Error(pa+"NaN")}for(r=Zr(l),ar=!1,s=Math.sqrt(+l),s==0||s==1/0?(e=Al(l.d),(e.length+r)%2==0&&(e+="0"),s=Math.sqrt(e),r=Iy((r+1)/2)-(r<0||r%2),s==1/0?e="5e"+r:(e=s.toExponential(),e=e.slice(0,e.indexOf("e")+1)+r),i=new c(e)):i=new c(s.toString()),n=c.precision,s=a=n+3;;)if(o=i,i=o.plus(Jc(l,o,a+2)).times(.5),Al(o.d).slice(0,a)===(e=Al(i.d)).slice(0,a)){if(e=e.slice(a-3,a+1),s==a&&e=="4999"){if(Ln(o,n+1,0),o.times(o).eq(l)){i=o;break}}else if(e!="9999")break;a+=4}return ar=!0,Ln(i,n)};st.times=st.mul=function(r){var e,n,i,s,o,a,l,c,u,h=this,f=h.constructor,d=h.d,p=(r=new f(r)).d;if(!h.s||!r.s)return new f(0);for(r.s*=h.s,n=h.e+r.e,c=d.length,u=p.length,c<u&&(o=d,d=p,p=o,a=c,c=u,u=a),o=[],a=c+u,i=a;i--;)o.push(0);for(i=u;--i>=0;){for(e=0,s=c+i;s>i;)l=o[s]+p[i]*d[s-i-1]+e,o[s--]=l%bi|0,e=l/bi|0;o[s]=(o[s]+e)%bi|0}for(;!o[--a];)o.pop();return e?++n:o.shift(),r.d=o,r.e=n,ar?Ln(r,f.precision):r};st.toDecimalPlaces=st.todp=function(r,e){var n=this,i=n.constructor;return n=new i(n),r===void 0?n:($l(r,0,ky),e===void 0?e=i.rounding:$l(e,0,8),Ln(n,r+Zr(n)+1,e))};st.toExponential=function(r,e){var n,i=this,s=i.constructor;return r===void 0?n=Td(i,!0):($l(r,0,ky),e===void 0?e=s.rounding:$l(e,0,8),i=Ln(new s(i),r+1,e),n=Td(i,!0,r+1)),n};st.toFixed=function(r,e){var n,i,s=this,o=s.constructor;return r===void 0?Td(s):($l(r,0,ky),e===void 0?e=o.rounding:$l(e,0,8),i=Ln(new o(s),r+Zr(s)+1,e),n=Td(i.abs(),!1,r+Zr(i)+1),s.isneg()&&!s.isZero()?"-"+n:n)};st.toInteger=st.toint=function(){var r=this,e=r.constructor;return Ln(new e(r),Zr(r)+1,e.rounding)};st.toNumber=function(){return+this};st.toPower=st.pow=function(r){var e,n,i,s,o,a,l=this,c=l.constructor,u=12,h=+(r=new c(r));if(!r.s)return new c(Mo);if(l=new c(l),!l.s){if(r.s<1)throw Error(pa+"Infinity");return l}if(l.eq(Mo))return l;if(i=c.precision,r.eq(Mo))return Ln(l,i);if(e=r.e,n=r.d.length-1,a=e>=n,o=l.s,a){if((n=h<0?-h:h)<=Vne){for(s=new c(Mo),e=Math.ceil(i/Kn+4),ar=!1;n%2&&(s=s.times(l),s6(s.d,e)),n=Iy(n/2),n!==0;)l=l.times(l),s6(l.d,e);return ar=!0,r.s<0?new c(Mo).div(s):Ln(s,i)}}else if(o<0)throw Error(pa+"NaN");return o=o<0&&r.d[Math.max(e,n)]&1?-1:1,l.s=1,ar=!1,s=r.times(wb(l,i+u)),ar=!0,s=Hne(s),s.s=o,s};st.toPrecision=function(r,e){var n,i,s=this,o=s.constructor;return r===void 0?(n=Zr(s),i=Td(s,n<=o.toExpNeg||n>=o.toExpPos)):($l(r,1,ky),e===void 0?e=o.rounding:$l(e,0,8),s=Ln(new o(s),r,e),n=Zr(s),i=Td(s,r<=n||n<=o.toExpNeg,r)),i};st.toSignificantDigits=st.tosd=function(r,e){var n=this,i=n.constructor;return r===void 0?(r=i.precision,e=i.rounding):($l(r,1,ky),e===void 0?e=i.rounding:$l(e,0,8)),Ln(new i(n),r,e)};st.toString=st.valueOf=st.val=st.toJSON=st[Symbol.for("nodejs.util.inspect.custom")]=function(){var r=this,e=Zr(r),n=r.constructor;return Td(r,e<=n.toExpNeg||e>=n.toExpPos)};function Gne(r,e){var n,i,s,o,a,l,c,u,h=r.constructor,f=h.precision;if(!r.s||!e.s)return e.s||(e=new h(r)),ar?Ln(e,f):e;if(c=r.d,u=e.d,a=r.e,s=e.e,c=c.slice(),o=a-s,o){for(o<0?(i=c,o=-o,l=u.length):(i=u,s=a,l=c.length),a=Math.ceil(f/Kn),l=a>l?a+1:l+1,o>l&&(o=l,i.length=1),i.reverse();o--;)i.push(0);i.reverse()}for(l=c.length,o=u.length,l-o<0&&(o=l,i=u,u=c,c=i),n=0;o;)n=(c[--o]=c[o]+u[o]+n)/bi|0,c[o]%=bi;for(n&&(c.unshift(n),++s),l=c.length;c[--l]==0;)c.pop();return e.d=c,e.e=s,ar?Ln(e,f):e}function $l(r,e,n){if(r!==~~r||r<e||r>n)throw Error(sd+r)}function Al(r){var e,n,i,s=r.length-1,o="",a=r[0];if(s>0){for(o+=a,e=1;e<s;e++)i=r[e]+"",n=Kn-i.length,n&&(o+=Yu(n)),o+=i;a=r[e],i=a+"",n=Kn-i.length,n&&(o+=Yu(n))}else if(a===0)return"0";for(;a%10===0;)a/=10;return o+a}var Jc=function(){function r(i,s){var o,a=0,l=i.length;for(i=i.slice();l--;)o=i[l]*s+a,i[l]=o%bi|0,a=o/bi|0;return a&&i.unshift(a),i}function e(i,s,o,a){var l,c;if(o!=a)c=o>a?1:-1;else for(l=c=0;l<o;l++)if(i[l]!=s[l]){c=i[l]>s[l]?1:-1;break}return c}function n(i,s,o){for(var a=0;o--;)i[o]-=a,a=i[o]<s[o]?1:0,i[o]=a*bi+i[o]-s[o];for(;!i[0]&&i.length>1;)i.shift()}return function(i,s,o,a){var l,c,u,h,f,d,p,m,g,v,y,x,b,w,_,S,T,E,M=i.constructor,A=i.s==s.s?1:-1,P=i.d,D=s.d;if(!i.s)return new M(i);if(!s.s)throw Error(pa+"Division by zero");for(c=i.e-s.e,T=D.length,_=P.length,p=new M(A),m=p.d=[],u=0;D[u]==(P[u]||0);)++u;if(D[u]>(P[u]||0)&&--c,o==null?x=o=M.precision:a?x=o+(Zr(i)-Zr(s))+1:x=o,x<0)return new M(0);if(x=x/Kn+2|0,u=0,T==1)for(h=0,D=D[0],x++;(u<_||h)&&x--;u++)b=h*bi+(P[u]||0),m[u]=b/D|0,h=b%D|0;else{for(h=bi/(D[0]+1)|0,h>1&&(D=r(D,h),P=r(P,h),T=D.length,_=P.length),w=T,g=P.slice(0,T),v=g.length;v<T;)g[v++]=0;E=D.slice(),E.unshift(0),S=D[0],D[1]>=bi/2&&++S;do h=0,l=e(D,g,T,v),l<0?(y=g[0],T!=v&&(y=y*bi+(g[1]||0)),h=y/S|0,h>1?(h>=bi&&(h=bi-1),f=r(D,h),d=f.length,v=g.length,l=e(f,g,d,v),l==1&&(h--,n(f,T<d?E:D,d))):(h==0&&(l=h=1),f=D.slice()),d=f.length,d<v&&f.unshift(0),n(g,f,v),l==-1&&(v=g.length,l=e(D,g,T,v),l<1&&(h++,n(g,T<v?E:D,v))),v=g.length):l===0&&(h++,g=[0]),m[u++]=h,l&&g[0]?g[v++]=P[w]||0:(g=[P[w]],v=1);while((w++<_||g[0]!==void 0)&&x--)}return m[0]||m.shift(),p.e=c,Ln(p,a?o+Zr(p)+1:o)}}();function Hne(r,e){var n,i,s,o,a,l,c=0,u=0,h=r.constructor,f=h.precision;if(Zr(r)>16)throw Error(UB+Zr(r));if(!r.s)return new h(Mo);for(e==null?(ar=!1,l=f):l=e,a=new h(.03125);r.abs().gte(.1);)r=r.times(a),u+=5;for(i=Math.log(Nf(2,u))/Math.LN10*2+5|0,l+=i,n=s=o=new h(Mo),h.precision=l;;){if(s=Ln(s.times(r),l),n=n.times(++c),a=o.plus(Jc(s,n,l)),Al(a.d).slice(0,l)===Al(o.d).slice(0,l)){for(;u--;)o=Ln(o.times(o),l);return h.precision=f,e==null?(ar=!0,Ln(o,f)):o}o=a}}function Zr(r){for(var e=r.e*Kn,n=r.d[0];n>=10;n/=10)e++;return e}function s2(r,e,n){if(e>r.LN10.sd())throw ar=!0,n&&(r.precision=n),Error(pa+"LN10 precision limit exceeded");return Ln(new r(r.LN10),e)}function Yu(r){for(var e="";r--;)e+="0";return e}function wb(r,e){var n,i,s,o,a,l,c,u,h,f=1,d=10,p=r,m=p.d,g=p.constructor,v=g.precision;if(p.s<1)throw Error(pa+(p.s?"NaN":"-Infinity"));if(p.eq(Mo))return new g(0);if(e==null?(ar=!1,u=v):u=e,p.eq(10))return e==null&&(ar=!0),s2(g,u);if(u+=d,g.precision=u,n=Al(m),i=n.charAt(0),o=Zr(p),Math.abs(o)<15e14){for(;i<7&&i!=1||i==1&&n.charAt(1)>3;)p=p.times(r),n=Al(p.d),i=n.charAt(0),f++;o=Zr(p),i>1?(p=new g("0."+n),o++):p=new g(i+"."+n.slice(1))}else return c=s2(g,u+2,v).times(o+""),p=wb(new g(i+"."+n.slice(1)),u-d).plus(c),g.precision=v,e==null?(ar=!0,Ln(p,v)):p;for(l=a=p=Jc(p.minus(Mo),p.plus(Mo),u),h=Ln(p.times(p),u),s=3;;){if(a=Ln(a.times(h),u),c=l.plus(Jc(a,new g(s),u)),Al(c.d).slice(0,u)===Al(l.d).slice(0,u))return l=l.times(2),o!==0&&(l=l.plus(s2(g,u+2,v).times(o+""))),l=Jc(l,new g(f),u),g.precision=v,e==null?(ar=!0,Ln(l,v)):l;l=c,s+=2}}function i6(r,e){var n,i,s;for((n=e.indexOf("."))>-1&&(e=e.replace(".","")),(i=e.search(/e/i))>0?(n<0&&(n=i),n+=+e.slice(i+1),e=e.substring(0,i)):n<0&&(n=e.length),i=0;e.charCodeAt(i)===48;)++i;for(s=e.length;e.charCodeAt(s-1)===48;)--s;if(e=e.slice(i,s),e){if(s-=i,n=n-i-1,r.e=Iy(n/Kn),r.d=[],i=(n+1)%Kn,n<0&&(i+=Kn),i<s){for(i&&r.d.push(+e.slice(0,i)),s-=Kn;i<s;)r.d.push(+e.slice(i,i+=Kn));e=e.slice(i),i=Kn-e.length}else i-=s;for(;i--;)e+="0";if(r.d.push(+e),ar&&(r.e>FE||r.e<-FE))throw Error(UB+n)}else r.s=0,r.e=0,r.d=[0];return r}function Ln(r,e,n){var i,s,o,a,l,c,u,h,f=r.d;for(a=1,o=f[0];o>=10;o/=10)a++;if(i=e-a,i<0)i+=Kn,s=e,u=f[h=0];else{if(h=Math.ceil((i+1)/Kn),o=f.length,h>=o)return r;for(u=o=f[h],a=1;o>=10;o/=10)a++;i%=Kn,s=i-Kn+a}if(n!==void 0&&(o=Nf(10,a-s-1),l=u/o%10|0,c=e<0||f[h+1]!==void 0||u%o,c=n<4?(l||c)&&(n==0||n==(r.s<0?3:2)):l>5||l==5&&(n==4||c||n==6&&(i>0?s>0?u/Nf(10,a-s):0:f[h-1])%10&1||n==(r.s<0?8:7))),e<1||!f[0])return c?(o=Zr(r),f.length=1,e=e-o-1,f[0]=Nf(10,(Kn-e%Kn)%Kn),r.e=Iy(-e/Kn)||0):(f.length=1,f[0]=r.e=r.s=0),r;if(i==0?(f.length=h,o=1,h--):(f.length=h+1,o=Nf(10,Kn-i),f[h]=s>0?(u/Nf(10,a-s)%Nf(10,s)|0)*o:0),c)for(;;)if(h==0){(f[0]+=o)==bi&&(f[0]=1,++r.e);break}else{if(f[h]+=o,f[h]!=bi)break;f[h--]=0,o=1}for(i=f.length;f[--i]===0;)f.pop();if(ar&&(r.e>FE||r.e<-FE))throw Error(UB+Zr(r));return r}function Wne(r,e){var n,i,s,o,a,l,c,u,h,f,d=r.constructor,p=d.precision;if(!r.s||!e.s)return e.s?e.s=-e.s:e=new d(r),ar?Ln(e,p):e;if(c=r.d,f=e.d,i=e.e,u=r.e,c=c.slice(),a=u-i,a){for(h=a<0,h?(n=c,a=-a,l=f.length):(n=f,i=u,l=c.length),s=Math.max(Math.ceil(p/Kn),l)+2,a>s&&(a=s,n.length=1),n.reverse(),s=a;s--;)n.push(0);n.reverse()}else{for(s=c.length,l=f.length,h=s<l,h&&(l=s),s=0;s<l;s++)if(c[s]!=f[s]){h=c[s]<f[s];break}a=0}for(h&&(n=c,c=f,f=n,e.s=-e.s),l=c.length,s=f.length-l;s>0;--s)c[l++]=0;for(s=f.length;s>a;){if(c[--s]<f[s]){for(o=s;o&&c[--o]===0;)c[o]=bi-1;--c[o],c[s]+=bi}c[s]-=f[s]}for(;c[--l]===0;)c.pop();for(;c[0]===0;c.shift())--i;return c[0]?(e.d=c,e.e=i,ar?Ln(e,p):e):new d(0)}function Td(r,e,n){var i,s=Zr(r),o=Al(r.d),a=o.length;return e?(n&&(i=n-a)>0?o=o.charAt(0)+"."+o.slice(1)+Yu(i):a>1&&(o=o.charAt(0)+"."+o.slice(1)),o=o+(s<0?"e":"e+")+s):s<0?(o="0."+Yu(-s-1)+o,n&&(i=n-a)>0&&(o+=Yu(i))):s>=a?(o+=Yu(s+1-a),n&&(i=n-s-1)>0&&(o=o+"."+Yu(i))):((i=s+1)<a&&(o=o.slice(0,i)+"."+o.slice(i)),n&&(i=n-a)>0&&(s+1===a&&(o+="."),o+=Yu(i))),r.s<0?"-"+o:o}function s6(r,e){if(r.length>e)return r.length=e,!0}function qne(r){var e,n,i;function s(o){var a=this;if(!(a instanceof s))return new s(o);if(a.constructor=s,o instanceof s){a.s=o.s,a.e=o.e,a.d=(o=o.d)?o.slice():o;return}if(typeof o=="number"){if(o*0!==0)throw Error(sd+o);if(o>0)a.s=1;else if(o<0)o=-o,a.s=-1;else{a.s=0,a.e=0,a.d=[0];return}if(o===~~o&&o<1e7){a.e=0,a.d=[o];return}return i6(a,o.toString())}else if(typeof o!="string")throw Error(sd+o);if(o.charCodeAt(0)===45?(o=o.slice(1),a.s=-1):a.s=1,AQe.test(o))i6(a,o);else throw Error(sd+o)}if(s.prototype=st,s.ROUND_UP=0,s.ROUND_DOWN=1,s.ROUND_CEIL=2,s.ROUND_FLOOR=3,s.ROUND_HALF_UP=4,s.ROUND_HALF_DOWN=5,s.ROUND_HALF_EVEN=6,s.ROUND_HALF_CEIL=7,s.ROUND_HALF_FLOOR=8,s.clone=qne,s.config=s.set=CQe,r===void 0&&(r={}),r)for(i=["precision","rounding","toExpNeg","toExpPos","LN10"],e=0;e<i.length;)r.hasOwnProperty(n=i[e++])||(r[n]=this[n]);return s.config(r),s}function CQe(r){if(!r||typeof r!="object")throw Error(pa+"Object expected");var e,n,i,s=["precision",1,ky,"rounding",0,8,"toExpNeg",-1/0,0,"toExpPos",0,1/0];for(e=0;e<s.length;e+=3)if((i=r[n=s[e]])!==void 0)if(Iy(i)===i&&i>=s[e+1]&&i<=s[e+2])this[n]=i;else throw Error(sd+n+": "+i);if((i=r[n="LN10"])!==void 0)if(i==Math.LN10)this[n]=new this(i);else throw Error(sd+n+": "+i);return this}var zB=qne(MQe);Mo=new zB(1);const Pn=zB;function PQe(r){return DQe(r)||OQe(r)||NQe(r)||RQe()}function RQe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function NQe(r,e){if(r){if(typeof r=="string")return vk(r,e);var n=Object.prototype.toString.call(r).slice(8,-1);if(n==="Object"&&r.constructor&&(n=r.constructor.name),n==="Map"||n==="Set")return Array.from(r);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return vk(r,e)}}function OQe(r){if(typeof Symbol<"u"&&Symbol.iterator in Object(r))return Array.from(r)}function DQe(r){if(Array.isArray(r))return vk(r)}function vk(r,e){(e==null||e>r.length)&&(e=r.length);for(var n=0,i=new Array(e);n<e;n++)i[n]=r[n];return i}var kQe=function(e){return e},Xne={"@@functional/placeholder":!0},Kne=function(e){return e===Xne},o6=function(e){return function n(){return arguments.length===0||arguments.length===1&&Kne(arguments.length<=0?void 0:arguments[0])?n:e.apply(void 0,arguments)}},IQe=function r(e,n){return e===1?n:o6(function(){for(var i=arguments.length,s=new Array(i),o=0;o<i;o++)s[o]=arguments[o];var a=s.filter(function(l){return l!==Xne}).length;return a>=e?n.apply(void 0,s):r(e-a,o6(function(){for(var l=arguments.length,c=new Array(l),u=0;u<l;u++)c[u]=arguments[u];var h=s.map(function(f){return Kne(f)?c.shift():f});return n.apply(void 0,PQe(h).concat(c))}))})},oC=function(e){return IQe(e.length,e)},xk=function(e,n){for(var i=[],s=e;s<n;++s)i[s-e]=s;return i},LQe=oC(function(r,e){return Array.isArray(e)?e.map(r):Object.keys(e).map(function(n){return e[n]}).map(r)}),FQe=function(){for(var e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];if(!n.length)return kQe;var s=n.reverse(),o=s[0],a=s.slice(1);return function(){return a.reduce(function(l,c){return c(l)},o.apply(void 0,arguments))}},bk=function(e){return Array.isArray(e)?e.reverse():e.split("").reverse.join("")},Yne=function(e){var n=null,i=null;return function(){for(var s=arguments.length,o=new Array(s),a=0;a<s;a++)o[a]=arguments[a];return n&&o.every(function(l,c){return l===n[c]})||(n=o,i=e.apply(void 0,o)),i}};function BQe(r){var e;return r===0?e=1:e=Math.floor(new Pn(r).abs().log(10).toNumber())+1,e}function UQe(r,e,n){for(var i=new Pn(r),s=0,o=[];i.lt(e)&&s<1e5;)o.push(i.toNumber()),i=i.add(n),s++;return o}var zQe=oC(function(r,e,n){var i=+r,s=+e;return i+n*(s-i)}),$Qe=oC(function(r,e,n){var i=e-+r;return i=i||1/0,(n-r)/i}),jQe=oC(function(r,e,n){var i=e-+r;return i=i||1/0,Math.max(0,Math.min(1,(n-r)/i))});const aC={rangeStep:UQe,getDigitCount:BQe,interpolateNumber:zQe,uninterpolateNumber:$Qe,uninterpolateTruncation:jQe};function _k(r){return HQe(r)||GQe(r)||Zne(r)||VQe()}function VQe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function GQe(r){if(typeof Symbol<"u"&&Symbol.iterator in Object(r))return Array.from(r)}function HQe(r){if(Array.isArray(r))return wk(r)}function Sb(r,e){return XQe(r)||qQe(r,e)||Zne(r,e)||WQe()}function WQe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Zne(r,e){if(r){if(typeof r=="string")return wk(r,e);var n=Object.prototype.toString.call(r).slice(8,-1);if(n==="Object"&&r.constructor&&(n=r.constructor.name),n==="Map"||n==="Set")return Array.from(r);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return wk(r,e)}}function wk(r,e){(e==null||e>r.length)&&(e=r.length);for(var n=0,i=new Array(e);n<e;n++)i[n]=r[n];return i}function qQe(r,e){if(!(typeof Symbol>"u"||!(Symbol.iterator in Object(r)))){var n=[],i=!0,s=!1,o=void 0;try{for(var a=r[Symbol.iterator](),l;!(i=(l=a.next()).done)&&(n.push(l.value),!(e&&n.length===e));i=!0);}catch(c){s=!0,o=c}finally{try{!i&&a.return!=null&&a.return()}finally{if(s)throw o}}return n}}function XQe(r){if(Array.isArray(r))return r}function Qne(r){var e=Sb(r,2),n=e[0],i=e[1],s=n,o=i;return n>i&&(s=i,o=n),[s,o]}function Jne(r,e,n){if(r.lte(0))return new Pn(0);var i=aC.getDigitCount(r.toNumber()),s=new Pn(10).pow(i),o=r.div(s),a=i!==1?.05:.1,l=new Pn(Math.ceil(o.div(a).toNumber())).add(n).mul(a),c=l.mul(s);return e?c:new Pn(Math.ceil(c))}function KQe(r,e,n){var i=1,s=new Pn(r);if(!s.isint()&&n){var o=Math.abs(r);o<1?(i=new Pn(10).pow(aC.getDigitCount(r)-1),s=new Pn(Math.floor(s.div(i).toNumber())).mul(i)):o>1&&(s=new Pn(Math.floor(r)))}else r===0?s=new Pn(Math.floor((e-1)/2)):n||(s=new Pn(Math.floor(r)));var a=Math.floor((e-1)/2),l=FQe(LQe(function(c){return s.add(new Pn(c-a).mul(i)).toNumber()}),xk);return l(0,e)}function ere(r,e,n,i){var s=arguments.length>4&&arguments[4]!==void 0?arguments[4]:0;if(!Number.isFinite((e-r)/(n-1)))return{step:new Pn(0),tickMin:new Pn(0),tickMax:new Pn(0)};var o=Jne(new Pn(e).sub(r).div(n-1),i,s),a;r<=0&&e>=0?a=new Pn(0):(a=new Pn(r).add(e).div(2),a=a.sub(new Pn(a).mod(o)));var l=Math.ceil(a.sub(r).div(o).toNumber()),c=Math.ceil(new Pn(e).sub(a).div(o).toNumber()),u=l+c+1;return u>n?ere(r,e,n,i,s+1):(u<n&&(c=e>0?c+(n-u):c,l=e>0?l:l+(n-u)),{step:o,tickMin:a.sub(new Pn(l).mul(o)),tickMax:a.add(new Pn(c).mul(o))})}function YQe(r){var e=Sb(r,2),n=e[0],i=e[1],s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:6,o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,a=Math.max(s,2),l=Qne([n,i]),c=Sb(l,2),u=c[0],h=c[1];if(u===-1/0||h===1/0){var f=h===1/0?[u].concat(_k(xk(0,s-1).map(function(){return 1/0}))):[].concat(_k(xk(0,s-1).map(function(){return-1/0})),[h]);return n>i?bk(f):f}if(u===h)return KQe(u,s,o);var d=ere(u,h,a,o),p=d.step,m=d.tickMin,g=d.tickMax,v=aC.rangeStep(m,g.add(new Pn(.1).mul(p)),p);return n>i?bk(v):v}function ZQe(r,e){var n=Sb(r,2),i=n[0],s=n[1],o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,a=Qne([i,s]),l=Sb(a,2),c=l[0],u=l[1];if(c===-1/0||u===1/0)return[i,s];if(c===u)return[c];var h=Math.max(e,2),f=Jne(new Pn(u).sub(c).div(h-1),o,0),d=[].concat(_k(aC.rangeStep(new Pn(c),new Pn(u).sub(new Pn(.99).mul(f)),f)),[u]);return i>s?bk(d):d}var QQe=Yne(YQe),JQe=Yne(ZQe),eJe="Invariant failed";function Ed(r,e){throw new Error(eJe)}var tJe=["offset","layout","width","dataKey","data","dataPointFormatter","xAxis","yAxis"];function Fg(r){"@babel/helpers - typeof";return Fg=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Fg(r)}function BE(){return BE=Object.assign?Object.assign.bind():function(r){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(r[i]=n[i])}return r},BE.apply(this,arguments)}function nJe(r,e){return oJe(r)||sJe(r,e)||iJe(r,e)||rJe()}function rJe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function iJe(r,e){if(r){if(typeof r=="string")return a6(r,e);var n=Object.prototype.toString.call(r).slice(8,-1);if(n==="Object"&&r.constructor&&(n=r.constructor.name),n==="Map"||n==="Set")return Array.from(r);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return a6(r,e)}}function a6(r,e){(e==null||e>r.length)&&(e=r.length);for(var n=0,i=new Array(e);n<e;n++)i[n]=r[n];return i}function sJe(r,e){var n=r==null?null:typeof Symbol<"u"&&r[Symbol.iterator]||r["@@iterator"];if(n!=null){var i,s,o,a,l=[],c=!0,u=!1;try{if(o=(n=n.call(r)).next,e!==0)for(;!(c=(i=o.call(n)).done)&&(l.push(i.value),l.length!==e);c=!0);}catch(h){u=!0,s=h}finally{try{if(!c&&n.return!=null&&(a=n.return(),Object(a)!==a))return}finally{if(u)throw s}}return l}}function oJe(r){if(Array.isArray(r))return r}function aJe(r,e){if(r==null)return{};var n=lJe(r,e),i,s;if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(r);for(s=0;s<o.length;s++)i=o[s],!(e.indexOf(i)>=0)&&Object.prototype.propertyIsEnumerable.call(r,i)&&(n[i]=r[i])}return n}function lJe(r,e){if(r==null)return{};var n={};for(var i in r)if(Object.prototype.hasOwnProperty.call(r,i)){if(e.indexOf(i)>=0)continue;n[i]=r[i]}return n}function cJe(r,e){if(!(r instanceof e))throw new TypeError("Cannot call a class as a function")}function uJe(r,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(r,rre(i.key),i)}}function hJe(r,e,n){return e&&uJe(r.prototype,e),Object.defineProperty(r,"prototype",{writable:!1}),r}function fJe(r,e,n){return e=UE(e),dJe(r,tre()?Reflect.construct(e,n||[],UE(r).constructor):e.apply(r,n))}function dJe(r,e){if(e&&(Fg(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return pJe(r)}function pJe(r){if(r===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return r}function tre(){try{var r=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(tre=function(){return!!r})()}function UE(r){return UE=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(n){return n.__proto__||Object.getPrototypeOf(n)},UE(r)}function mJe(r,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");r.prototype=Object.create(e&&e.prototype,{constructor:{value:r,writable:!0,configurable:!0}}),Object.defineProperty(r,"prototype",{writable:!1}),e&&Sk(r,e)}function Sk(r,e){return Sk=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(i,s){return i.__proto__=s,i},Sk(r,e)}function nre(r,e,n){return e=rre(e),e in r?Object.defineProperty(r,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):r[e]=n,r}function rre(r){var e=gJe(r,"string");return Fg(e)=="symbol"?e:e+""}function gJe(r,e){if(Fg(r)!="object"||!r)return r;var n=r[Symbol.toPrimitive];if(n!==void 0){var i=n.call(r,e||"default");if(Fg(i)!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(r)}var B_=function(r){function e(){return cJe(this,e),fJe(this,e,arguments)}return mJe(e,r),hJe(e,[{key:"render",value:function(){var i=this.props,s=i.offset,o=i.layout,a=i.width,l=i.dataKey,c=i.data,u=i.dataPointFormatter,h=i.xAxis,f=i.yAxis,d=aJe(i,tJe),p=Tt(d,!1);this.props.direction==="x"&&h.type!=="number"&&Ed();var m=c.map(function(g){var v=u(g,l),y=v.x,x=v.y,b=v.value,w=v.errorVal;if(!w)return null;var _=[],S,T;if(Array.isArray(w)){var E=nJe(w,2);S=E[0],T=E[1]}else S=T=w;if(o==="vertical"){var M=h.scale,A=x+s,P=A+a,D=A-a,B=M(b-S),C=M(b+T);_.push({x1:C,y1:P,x2:C,y2:D}),_.push({x1:B,y1:A,x2:C,y2:A}),_.push({x1:B,y1:P,x2:B,y2:D})}else if(o==="horizontal"){var O=f.scale,R=y+s,z=R-a,U=R+a,G=O(b-S),H=O(b+T);_.push({x1:z,y1:H,x2:U,y2:H}),_.push({x1:R,y1:G,x2:R,y2:H}),_.push({x1:z,y1:G,x2:U,y2:G})}return Z.createElement(Sn,BE({className:"recharts-errorBar",key:"bar-".concat(_.map(function(Y){return"".concat(Y.x1,"-").concat(Y.x2,"-").concat(Y.y1,"-").concat(Y.y2)}))},p),_.map(function(Y){return Z.createElement("line",BE({},Y,{key:"line-".concat(Y.x1,"-").concat(Y.x2,"-").concat(Y.y1,"-").concat(Y.y2)}))}))});return Z.createElement(Sn,{className:"recharts-errorBars"},m)}}])}(Z.Component);nre(B_,"defaultProps",{stroke:"black",strokeWidth:1.5,width:5,offset:0,layout:"horizontal"});nre(B_,"displayName","ErrorBar");function Tb(r){"@babel/helpers - typeof";return Tb=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Tb(r)}function l6(r,e){var n=Object.keys(r);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(r);e&&(i=i.filter(function(s){return Object.getOwnPropertyDescriptor(r,s).enumerable})),n.push.apply(n,i)}return n}function yf(r){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?l6(Object(n),!0).forEach(function(i){yJe(r,i,n[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(n)):l6(Object(n)).forEach(function(i){Object.defineProperty(r,i,Object.getOwnPropertyDescriptor(n,i))})}return r}function yJe(r,e,n){return e=vJe(e),e in r?Object.defineProperty(r,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):r[e]=n,r}function vJe(r){var e=xJe(r,"string");return Tb(e)=="symbol"?e:e+""}function xJe(r,e){if(Tb(r)!="object"||!r)return r;var n=r[Symbol.toPrimitive];if(n!==void 0){var i=n.call(r,e||"default");if(Tb(i)!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(r)}var ire=function(e){var n=e.children,i=e.formattedGraphicalItems,s=e.legendWidth,o=e.legendContent,a=So(n,Qc);if(!a)return null;var l=Qc.defaultProps,c=l!==void 0?yf(yf({},l),a.props):{},u;return a.props&&a.props.payload?u=a.props&&a.props.payload:o==="children"?u=(i||[]).reduce(function(h,f){var d=f.item,p=f.props,m=p.sectors||p.data||[];return h.concat(m.map(function(g){return{type:a.props.iconType||d.props.legendType,value:g.name,color:g.fill,payload:g}}))},[]):u=(i||[]).map(function(h){var f=h.item,d=f.type.defaultProps,p=d!==void 0?yf(yf({},d),f.props):{},m=p.dataKey,g=p.name,v=p.legendType,y=p.hide;return{inactive:y,dataKey:m,type:c.iconType||v||"square",color:$B(f),value:g||m,payload:p}}),yf(yf(yf({},c),Qc.getWithHeight(a,s)),{},{payload:u,item:a})};function Eb(r){"@babel/helpers - typeof";return Eb=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Eb(r)}function c6(r){return SJe(r)||wJe(r)||_Je(r)||bJe()}function bJe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function _Je(r,e){if(r){if(typeof r=="string")return Tk(r,e);var n=Object.prototype.toString.call(r).slice(8,-1);if(n==="Object"&&r.constructor&&(n=r.constructor.name),n==="Map"||n==="Set")return Array.from(r);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Tk(r,e)}}function wJe(r){if(typeof Symbol<"u"&&r[Symbol.iterator]!=null||r["@@iterator"]!=null)return Array.from(r)}function SJe(r){if(Array.isArray(r))return Tk(r)}function Tk(r,e){(e==null||e>r.length)&&(e=r.length);for(var n=0,i=new Array(e);n<e;n++)i[n]=r[n];return i}function u6(r,e){var n=Object.keys(r);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(r);e&&(i=i.filter(function(s){return Object.getOwnPropertyDescriptor(r,s).enumerable})),n.push.apply(n,i)}return n}function Sr(r){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?u6(Object(n),!0).forEach(function(i){$m(r,i,n[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(n)):u6(Object(n)).forEach(function(i){Object.defineProperty(r,i,Object.getOwnPropertyDescriptor(n,i))})}return r}function $m(r,e,n){return e=TJe(e),e in r?Object.defineProperty(r,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):r[e]=n,r}function TJe(r){var e=EJe(r,"string");return Eb(e)=="symbol"?e:e+""}function EJe(r,e){if(Eb(r)!="object"||!r)return r;var n=r[Symbol.toPrimitive];if(n!==void 0){var i=n.call(r,e||"default");if(Eb(i)!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(r)}function Is(r,e,n){return nn(r)||nn(e)?n:ci(e)?ca(r,e,n):Ut(e)?e(r):n}function K0(r,e,n,i){var s=wQe(r,function(l){return Is(l,e)});if(n==="number"){var o=s.filter(function(l){return We(l)||parseFloat(l)});return o.length?[sC(o),iC(o)]:[1/0,-1/0]}var a=i?s.filter(function(l){return!nn(l)}):s;return a.map(function(l){return ci(l)||l instanceof Date?l:""})}var MJe=function(e){var n,i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],s=arguments.length>2?arguments[2]:void 0,o=arguments.length>3?arguments[3]:void 0,a=-1,l=(n=i==null?void 0:i.length)!==null&&n!==void 0?n:0;if(l<=1)return 0;if(o&&o.axisType==="angleAxis"&&Math.abs(Math.abs(o.range[1]-o.range[0])-360)<=1e-6)for(var c=o.range,u=0;u<l;u++){var h=u>0?s[u-1].coordinate:s[l-1].coordinate,f=s[u].coordinate,d=u>=l-1?s[0].coordinate:s[u+1].coordinate,p=void 0;if(Ka(f-h)!==Ka(d-f)){var m=[];if(Ka(d-f)===Ka(c[1]-c[0])){p=d;var g=f+c[1]-c[0];m[0]=Math.min(g,(g+h)/2),m[1]=Math.max(g,(g+h)/2)}else{p=h;var v=d+c[1]-c[0];m[0]=Math.min(f,(v+f)/2),m[1]=Math.max(f,(v+f)/2)}var y=[Math.min(f,(p+f)/2),Math.max(f,(p+f)/2)];if(e>y[0]&&e<=y[1]||e>=m[0]&&e<=m[1]){a=s[u].index;break}}else{var x=Math.min(h,d),b=Math.max(h,d);if(e>(x+f)/2&&e<=(b+f)/2){a=s[u].index;break}}}else for(var w=0;w<l;w++)if(w===0&&e<=(i[w].coordinate+i[w+1].coordinate)/2||w>0&&w<l-1&&e>(i[w].coordinate+i[w-1].coordinate)/2&&e<=(i[w].coordinate+i[w+1].coordinate)/2||w===l-1&&e>(i[w].coordinate+i[w-1].coordinate)/2){a=i[w].index;break}return a},$B=function(e){var n,i=e,s=i.type.displayName,o=(n=e.type)!==null&&n!==void 0&&n.defaultProps?Sr(Sr({},e.type.defaultProps),e.props):e.props,a=o.stroke,l=o.fill,c;switch(s){case"Line":c=a;break;case"Area":case"Radar":c=a&&a!=="none"?a:l;break;default:c=l;break}return c},AJe=function(e){var n=e.barSize,i=e.totalSize,s=e.stackGroups,o=s===void 0?{}:s;if(!o)return{};for(var a={},l=Object.keys(o),c=0,u=l.length;c<u;c++)for(var h=o[l[c]].stackGroups,f=Object.keys(h),d=0,p=f.length;d<p;d++){var m=h[f[d]],g=m.items,v=m.cateAxisId,y=g.filter(function(T){return Yc(T.type).indexOf("Bar")>=0});if(y&&y.length){var x=y[0].type.defaultProps,b=x!==void 0?Sr(Sr({},x),y[0].props):y[0].props,w=b.barSize,_=b[v];a[_]||(a[_]=[]);var S=nn(w)?n:w;a[_].push({item:y[0],stackList:y.slice(1),barSize:nn(S)?void 0:Ya(S,i,0)})}}return a},CJe=function(e){var n=e.barGap,i=e.barCategoryGap,s=e.bandSize,o=e.sizeList,a=o===void 0?[]:o,l=e.maxBarSize,c=a.length;if(c<1)return null;var u=Ya(n,s,0,!0),h,f=[];if(a[0].barSize===+a[0].barSize){var d=!1,p=s/c,m=a.reduce(function(w,_){return w+_.barSize||0},0);m+=(c-1)*u,m>=s&&(m-=(c-1)*u,u=0),m>=s&&p>0&&(d=!0,p*=.9,m=c*p);var g=(s-m)/2>>0,v={offset:g-u,size:0};h=a.reduce(function(w,_){var S={item:_.item,position:{offset:v.offset+v.size+u,size:d?p:_.barSize}},T=[].concat(c6(w),[S]);return v=T[T.length-1].position,_.stackList&&_.stackList.length&&_.stackList.forEach(function(E){T.push({item:E,position:v})}),T},f)}else{var y=Ya(i,s,0,!0);s-2*y-(c-1)*u<=0&&(u=0);var x=(s-2*y-(c-1)*u)/c;x>1&&(x>>=0);var b=l===+l?Math.min(x,l):x;h=a.reduce(function(w,_,S){var T=[].concat(c6(w),[{item:_.item,position:{offset:y+(x+u)*S+(x-b)/2,size:b}}]);return _.stackList&&_.stackList.length&&_.stackList.forEach(function(E){T.push({item:E,position:T[T.length-1].position})}),T},f)}return h},PJe=function(e,n,i,s){var o=i.children,a=i.width,l=i.margin,c=a-(l.left||0)-(l.right||0),u=ire({children:o,legendWidth:c});if(u){var h=s||{},f=h.width,d=h.height,p=u.align,m=u.verticalAlign,g=u.layout;if((g==="vertical"||g==="horizontal"&&m==="middle")&&p!=="center"&&We(e[p]))return Sr(Sr({},e),{},$m({},p,e[p]+(f||0)));if((g==="horizontal"||g==="vertical"&&p==="center")&&m!=="middle"&&We(e[m]))return Sr(Sr({},e),{},$m({},m,e[m]+(d||0)))}return e},RJe=function(e,n,i){return nn(n)?!0:e==="horizontal"?n==="yAxis":e==="vertical"||i==="x"?n==="xAxis":i==="y"?n==="yAxis":!0},sre=function(e,n,i,s,o){var a=n.props.children,l=ua(a,B_).filter(function(u){return RJe(s,o,u.props.direction)});if(l&&l.length){var c=l.map(function(u){return u.props.dataKey});return e.reduce(function(u,h){var f=Is(h,i);if(nn(f))return u;var d=Array.isArray(f)?[sC(f),iC(f)]:[f,f],p=c.reduce(function(m,g){var v=Is(h,g,0),y=d[0]-Math.abs(Array.isArray(v)?v[0]:v),x=d[1]+Math.abs(Array.isArray(v)?v[1]:v);return[Math.min(y,m[0]),Math.max(x,m[1])]},[1/0,-1/0]);return[Math.min(p[0],u[0]),Math.max(p[1],u[1])]},[1/0,-1/0])}return null},NJe=function(e,n,i,s,o){var a=n.map(function(l){return sre(e,l,i,o,s)}).filter(function(l){return!nn(l)});return a&&a.length?a.reduce(function(l,c){return[Math.min(l[0],c[0]),Math.max(l[1],c[1])]},[1/0,-1/0]):null},ore=function(e,n,i,s,o){var a=n.map(function(c){var u=c.props.dataKey;return i==="number"&&u&&sre(e,c,u,s)||K0(e,u,i,o)});if(i==="number")return a.reduce(function(c,u){return[Math.min(c[0],u[0]),Math.max(c[1],u[1])]},[1/0,-1/0]);var l={};return a.reduce(function(c,u){for(var h=0,f=u.length;h<f;h++)l[u[h]]||(l[u[h]]=!0,c.push(u[h]));return c},[])},are=function(e,n){return e==="horizontal"&&n==="xAxis"||e==="vertical"&&n==="yAxis"||e==="centric"&&n==="angleAxis"||e==="radial"&&n==="radiusAxis"},lre=function(e,n,i,s){if(s)return e.map(function(c){return c.coordinate});var o,a,l=e.map(function(c){return c.coordinate===n&&(o=!0),c.coordinate===i&&(a=!0),c.coordinate});return o||l.push(n),a||l.push(i),l},zc=function(e,n,i){if(!e)return null;var s=e.scale,o=e.duplicateDomain,a=e.type,l=e.range,c=e.realScaleType==="scaleBand"?s.bandwidth()/2:2,u=(n||i)&&a==="category"&&s.bandwidth?s.bandwidth()/c:0;if(u=e.axisType==="angleAxis"&&(l==null?void 0:l.length)>=2?Ka(l[0]-l[1])*2*u:u,n&&(e.ticks||e.niceTicks)){var h=(e.ticks||e.niceTicks).map(function(f){var d=o?o.indexOf(f):f;return{coordinate:s(d)+u,value:f,offset:u}});return h.filter(function(f){return!k_(f.coordinate)})}return e.isCategorical&&e.categoricalDomain?e.categoricalDomain.map(function(f,d){return{coordinate:s(f)+u,value:f,index:d,offset:u}}):s.ticks&&!i?s.ticks(e.tickCount).map(function(f){return{coordinate:s(f)+u,value:f,offset:u}}):s.domain().map(function(f,d){return{coordinate:s(f)+u,value:o?o[f]:f,index:d,offset:u}})},o2=new WeakMap,i1=function(e,n){if(typeof n!="function")return e;o2.has(e)||o2.set(e,new WeakMap);var i=o2.get(e);if(i.has(n))return i.get(n);var s=function(){e.apply(void 0,arguments),n.apply(void 0,arguments)};return i.set(n,s),s},cre=function(e,n,i){var s=e.scale,o=e.type,a=e.layout,l=e.axisType;if(s==="auto")return a==="radial"&&l==="radiusAxis"?{scale:Qx(),realScaleType:"band"}:a==="radial"&&l==="angleAxis"?{scale:tE(),realScaleType:"linear"}:o==="category"&&n&&(n.indexOf("LineChart")>=0||n.indexOf("AreaChart")>=0||n.indexOf("ComposedChart")>=0&&!i)?{scale:U0(),realScaleType:"point"}:o==="category"?{scale:Qx(),realScaleType:"band"}:{scale:tE(),realScaleType:"linear"};if(Sd(s)){var c="scale".concat(YA(s));return{scale:(r6[c]||U0)(),realScaleType:r6[c]?c:"point"}}return Ut(s)?{scale:s}:{scale:U0(),realScaleType:"point"}},h6=1e-4,ure=function(e){var n=e.domain();if(!(!n||n.length<=2)){var i=n.length,s=e.range(),o=Math.min(s[0],s[1])-h6,a=Math.max(s[0],s[1])+h6,l=e(n[0]),c=e(n[i-1]);(l<o||l>a||c<o||c>a)&&e.domain([n[0],n[i-1]])}},OJe=function(e,n){if(!e)return null;for(var i=0,s=e.length;i<s;i++)if(e[i].item===n)return e[i].position;return null},DJe=function(e,n){if(!n||n.length!==2||!We(n[0])||!We(n[1]))return e;var i=Math.min(n[0],n[1]),s=Math.max(n[0],n[1]),o=[e[0],e[1]];return(!We(e[0])||e[0]<i)&&(o[0]=i),(!We(e[1])||e[1]>s)&&(o[1]=s),o[0]>s&&(o[0]=s),o[1]<i&&(o[1]=i),o},kJe=function(e){var n=e.length;if(!(n<=0))for(var i=0,s=e[0].length;i<s;++i)for(var o=0,a=0,l=0;l<n;++l){var c=k_(e[l][i][1])?e[l][i][0]:e[l][i][1];c>=0?(e[l][i][0]=o,e[l][i][1]=o+c,o=e[l][i][1]):(e[l][i][0]=a,e[l][i][1]=a+c,a=e[l][i][1])}},IJe=function(e){var n=e.length;if(!(n<=0))for(var i=0,s=e[0].length;i<s;++i)for(var o=0,a=0;a<n;++a){var l=k_(e[a][i][1])?e[a][i][0]:e[a][i][1];l>=0?(e[a][i][0]=o,e[a][i][1]=o+l,o=e[a][i][1]):(e[a][i][0]=0,e[a][i][1]=0)}},LJe={sign:kJe,expand:C8e,none:Ng,silhouette:P8e,wiggle:R8e,positive:IJe},FJe=function(e,n,i){var s=n.map(function(l){return l.props.dataKey}),o=LJe[i],a=A8e().keys(s).value(function(l,c){return+Is(l,c,0)}).order(nk).offset(o);return a(e)},BJe=function(e,n,i,s,o,a){if(!e)return null;var l=a?n.reverse():n,c={},u=l.reduce(function(f,d){var p,m=(p=d.type)!==null&&p!==void 0&&p.defaultProps?Sr(Sr({},d.type.defaultProps),d.props):d.props,g=m.stackId,v=m.hide;if(v)return f;var y=m[i],x=f[y]||{hasStack:!1,stackGroups:{}};if(ci(g)){var b=x.stackGroups[g]||{numericAxisId:i,cateAxisId:s,items:[]};b.items.push(d),x.hasStack=!0,x.stackGroups[g]=b}else x.stackGroups[I_("_stackId_")]={numericAxisId:i,cateAxisId:s,items:[d]};return Sr(Sr({},f),{},$m({},y,x))},c),h={};return Object.keys(u).reduce(function(f,d){var p=u[d];if(p.hasStack){var m={};p.stackGroups=Object.keys(p.stackGroups).reduce(function(g,v){var y=p.stackGroups[v];return Sr(Sr({},g),{},$m({},v,{numericAxisId:i,cateAxisId:s,items:y.items,stackedData:FJe(e,y.items,o)}))},m)}return Sr(Sr({},f),{},$m({},d,p))},h)},hre=function(e,n){var i=n.realScaleType,s=n.type,o=n.tickCount,a=n.originalDomain,l=n.allowDecimals,c=i||n.scale;if(c!=="auto"&&c!=="linear")return null;if(o&&s==="number"&&a&&(a[0]==="auto"||a[1]==="auto")){var u=e.domain();if(!u.length)return null;var h=QQe(u,o,l);return e.domain([sC(h),iC(h)]),{niceTicks:h}}if(o&&s==="number"){var f=e.domain(),d=JQe(f,o,l);return{niceTicks:d}}return null};function f6(r){var e=r.axis,n=r.ticks,i=r.bandSize,s=r.entry,o=r.index,a=r.dataKey;if(e.type==="category"){if(!e.allowDuplicatedCategory&&e.dataKey&&!nn(s[e.dataKey])){var l=wE(n,"value",s[e.dataKey]);if(l)return l.coordinate+i/2}return n[o]?n[o].coordinate+i/2:null}var c=Is(s,nn(a)?e.dataKey:a);return nn(c)?null:e.scale(c)}var d6=function(e){var n=e.axis,i=e.ticks,s=e.offset,o=e.bandSize,a=e.entry,l=e.index;if(n.type==="category")return i[l]?i[l].coordinate+s:null;var c=Is(a,n.dataKey,n.domain[l]);return nn(c)?null:n.scale(c)-o/2+s},UJe=function(e){var n=e.numericAxis,i=n.scale.domain();if(n.type==="number"){var s=Math.min(i[0],i[1]),o=Math.max(i[0],i[1]);return s<=0&&o>=0?0:o<0?o:s}return i[0]},zJe=function(e,n){var i,s=(i=e.type)!==null&&i!==void 0&&i.defaultProps?Sr(Sr({},e.type.defaultProps),e.props):e.props,o=s.stackId;if(ci(o)){var a=n[o];if(a){var l=a.items.indexOf(e);return l>=0?a.stackedData[l]:null}}return null},$Je=function(e){return e.reduce(function(n,i){return[sC(i.concat([n[0]]).filter(We)),iC(i.concat([n[1]]).filter(We))]},[1/0,-1/0])},fre=function(e,n,i){return Object.keys(e).reduce(function(s,o){var a=e[o],l=a.stackedData,c=l.reduce(function(u,h){var f=$Je(h.slice(n,i+1));return[Math.min(u[0],f[0]),Math.max(u[1],f[1])]},[1/0,-1/0]);return[Math.min(c[0],s[0]),Math.max(c[1],s[1])]},[1/0,-1/0]).map(function(s){return s===1/0||s===-1/0?0:s})},p6=/^dataMin[\s]*-[\s]*([0-9]+([.]{1}[0-9]+){0,1})$/,m6=/^dataMax[\s]*\+[\s]*([0-9]+([.]{1}[0-9]+){0,1})$/,Ek=function(e,n,i){if(Ut(e))return e(n,i);if(!Array.isArray(e))return n;var s=[];if(We(e[0]))s[0]=i?e[0]:Math.min(e[0],n[0]);else if(p6.test(e[0])){var o=+p6.exec(e[0])[1];s[0]=n[0]-o}else Ut(e[0])?s[0]=e[0](n[0]):s[0]=n[0];if(We(e[1]))s[1]=i?e[1]:Math.max(e[1],n[1]);else if(m6.test(e[1])){var a=+m6.exec(e[1])[1];s[1]=n[1]+a}else Ut(e[1])?s[1]=e[1](n[1]):s[1]=n[1];return s},zE=function(e,n,i){if(e&&e.scale&&e.scale.bandwidth){var s=e.scale.bandwidth();if(!i||s>0)return s}if(e&&n&&n.length>=2){for(var o=FB(n,function(f){return f.coordinate}),a=1/0,l=1,c=o.length;l<c;l++){var u=o[l],h=o[l-1];a=Math.min((u.coordinate||0)-(h.coordinate||0),a)}return a===1/0?0:a}return i?void 0:0},g6=function(e,n,i){return!e||!e.length||F_(e,ca(i,"type.defaultProps.domain"))?n:e},dre=function(e,n){var i=e.type.defaultProps?Sr(Sr({},e.type.defaultProps),e.props):e.props,s=i.dataKey,o=i.name,a=i.unit,l=i.formatter,c=i.tooltipType,u=i.chartType,h=i.hide;return Sr(Sr({},Tt(e,!1)),{},{dataKey:s,unit:a,formatter:l,name:o||s,color:$B(e),value:Is(n,s),type:c,payload:n,chartType:u,hide:h})};function Mb(r){"@babel/helpers - typeof";return Mb=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Mb(r)}function y6(r,e){var n=Object.keys(r);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(r);e&&(i=i.filter(function(s){return Object.getOwnPropertyDescriptor(r,s).enumerable})),n.push.apply(n,i)}return n}function bc(r){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?y6(Object(n),!0).forEach(function(i){pre(r,i,n[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(n)):y6(Object(n)).forEach(function(i){Object.defineProperty(r,i,Object.getOwnPropertyDescriptor(n,i))})}return r}function pre(r,e,n){return e=jJe(e),e in r?Object.defineProperty(r,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):r[e]=n,r}function jJe(r){var e=VJe(r,"string");return Mb(e)=="symbol"?e:e+""}function VJe(r,e){if(Mb(r)!="object"||!r)return r;var n=r[Symbol.toPrimitive];if(n!==void 0){var i=n.call(r,e||"default");if(Mb(i)!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(r)}function GJe(r,e){return XJe(r)||qJe(r,e)||WJe(r,e)||HJe()}function HJe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function WJe(r,e){if(r){if(typeof r=="string")return v6(r,e);var n=Object.prototype.toString.call(r).slice(8,-1);if(n==="Object"&&r.constructor&&(n=r.constructor.name),n==="Map"||n==="Set")return Array.from(r);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return v6(r,e)}}function v6(r,e){(e==null||e>r.length)&&(e=r.length);for(var n=0,i=new Array(e);n<e;n++)i[n]=r[n];return i}function qJe(r,e){var n=r==null?null:typeof Symbol<"u"&&r[Symbol.iterator]||r["@@iterator"];if(n!=null){var i,s,o,a,l=[],c=!0,u=!1;try{if(o=(n=n.call(r)).next,e!==0)for(;!(c=(i=o.call(n)).done)&&(l.push(i.value),l.length!==e);c=!0);}catch(h){u=!0,s=h}finally{try{if(!c&&n.return!=null&&(a=n.return(),Object(a)!==a))return}finally{if(u)throw s}}return l}}function XJe(r){if(Array.isArray(r))return r}var $E=Math.PI/180,KJe=function(e){return e*180/Math.PI},Nn=function(e,n,i,s){return{x:e+Math.cos(-$E*s)*i,y:n+Math.sin(-$E*s)*i}},YJe=function(e,n){var i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{top:0,right:0,bottom:0,left:0};return Math.min(Math.abs(e-(i.left||0)-(i.right||0)),Math.abs(n-(i.top||0)-(i.bottom||0)))/2},ZJe=function(e,n,i,s,o){var a=e.width,l=e.height,c=e.startAngle,u=e.endAngle,h=Ya(e.cx,a,a/2),f=Ya(e.cy,l,l/2),d=YJe(a,l,i),p=Ya(e.innerRadius,d,0),m=Ya(e.outerRadius,d,d*.8),g=Object.keys(n);return g.reduce(function(v,y){var x=n[y],b=x.domain,w=x.reversed,_;if(nn(x.range))s==="angleAxis"?_=[c,u]:s==="radiusAxis"&&(_=[p,m]),w&&(_=[_[1],_[0]]);else{_=x.range;var S=_,T=GJe(S,2);c=T[0],u=T[1]}var E=cre(x,o),M=E.realScaleType,A=E.scale;A.domain(b).range(_),ure(A);var P=hre(A,bc(bc({},x),{},{realScaleType:M})),D=bc(bc(bc({},x),P),{},{range:_,radius:m,realScaleType:M,scale:A,cx:h,cy:f,innerRadius:p,outerRadius:m,startAngle:c,endAngle:u});return bc(bc({},v),{},pre({},y,D))},{})},QJe=function(e,n){var i=e.x,s=e.y,o=n.x,a=n.y;return Math.sqrt(Math.pow(i-o,2)+Math.pow(s-a,2))},JJe=function(e,n){var i=e.x,s=e.y,o=n.cx,a=n.cy,l=QJe({x:i,y:s},{x:o,y:a});if(l<=0)return{radius:l};var c=(i-o)/l,u=Math.acos(c);return s>a&&(u=2*Math.PI-u),{radius:l,angle:KJe(u),angleInRadian:u}},eet=function(e){var n=e.startAngle,i=e.endAngle,s=Math.floor(n/360),o=Math.floor(i/360),a=Math.min(s,o);return{startAngle:n-a*360,endAngle:i-a*360}},tet=function(e,n){var i=n.startAngle,s=n.endAngle,o=Math.floor(i/360),a=Math.floor(s/360),l=Math.min(o,a);return e+l*360},x6=function(e,n){var i=e.x,s=e.y,o=JJe({x:i,y:s},n),a=o.radius,l=o.angle,c=n.innerRadius,u=n.outerRadius;if(a<c||a>u)return!1;if(a===0)return!0;var h=eet(n),f=h.startAngle,d=h.endAngle,p=l,m;if(f<=d){for(;p>d;)p-=360;for(;p<f;)p+=360;m=p>=f&&p<=d}else{for(;p>f;)p-=360;for(;p<d;)p+=360;m=p>=d&&p<=f}return m?bc(bc({},n),{},{radius:a,angle:tet(p,n)}):null},mre=function(e){return!te.isValidElement(e)&&!Ut(e)&&typeof e!="boolean"?e.className:""};function Ab(r){"@babel/helpers - typeof";return Ab=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Ab(r)}var net=["offset"];function ret(r){return aet(r)||oet(r)||set(r)||iet()}function iet(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function set(r,e){if(r){if(typeof r=="string")return Mk(r,e);var n=Object.prototype.toString.call(r).slice(8,-1);if(n==="Object"&&r.constructor&&(n=r.constructor.name),n==="Map"||n==="Set")return Array.from(r);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Mk(r,e)}}function oet(r){if(typeof Symbol<"u"&&r[Symbol.iterator]!=null||r["@@iterator"]!=null)return Array.from(r)}function aet(r){if(Array.isArray(r))return Mk(r)}function Mk(r,e){(e==null||e>r.length)&&(e=r.length);for(var n=0,i=new Array(e);n<e;n++)i[n]=r[n];return i}function cet(r,e){if(r==null)return{};var n=uet(r,e),i,s;if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(r);for(s=0;s<o.length;s++)i=o[s],!(e.indexOf(i)>=0)&&Object.prototype.propertyIsEnumerable.call(r,i)&&(n[i]=r[i])}return n}function uet(r,e){if(r==null)return{};var n={};for(var i in r)if(Object.prototype.hasOwnProperty.call(r,i)){if(e.indexOf(i)>=0)continue;n[i]=r[i]}return n}function b6(r,e){var n=Object.keys(r);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(r);e&&(i=i.filter(function(s){return Object.getOwnPropertyDescriptor(r,s).enumerable})),n.push.apply(n,i)}return n}function ri(r){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?b6(Object(n),!0).forEach(function(i){het(r,i,n[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(n)):b6(Object(n)).forEach(function(i){Object.defineProperty(r,i,Object.getOwnPropertyDescriptor(n,i))})}return r}function het(r,e,n){return e=fet(e),e in r?Object.defineProperty(r,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):r[e]=n,r}function fet(r){var e=det(r,"string");return Ab(e)=="symbol"?e:e+""}function det(r,e){if(Ab(r)!="object"||!r)return r;var n=r[Symbol.toPrimitive];if(n!==void 0){var i=n.call(r,e||"default");if(Ab(i)!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(r)}function Cb(){return Cb=Object.assign?Object.assign.bind():function(r){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(r[i]=n[i])}return r},Cb.apply(this,arguments)}var pet=function(e){var n=e.value,i=e.formatter,s=nn(e.children)?n:e.children;return Ut(i)?i(s):s},met=function(e,n){var i=Ka(n-e),s=Math.min(Math.abs(n-e),360);return i*s},get=function(e,n,i){var s=e.position,o=e.viewBox,a=e.offset,l=e.className,c=o,u=c.cx,h=c.cy,f=c.innerRadius,d=c.outerRadius,p=c.startAngle,m=c.endAngle,g=c.clockWise,v=(f+d)/2,y=met(p,m),x=y>=0?1:-1,b,w;s==="insideStart"?(b=p+x*a,w=g):s==="insideEnd"?(b=m-x*a,w=!g):s==="end"&&(b=m+x*a,w=g),w=y<=0?w:!w;var _=Nn(u,h,v,b),S=Nn(u,h,v,b+(w?1:-1)*359),T="M".concat(_.x,",").concat(_.y,`
    A`).concat(v,",").concat(v,",0,1,").concat(w?0:1,`,
    `).concat(S.x,",").concat(S.y),E=nn(e.id)?I_("recharts-radial-line-"):e.id;return Z.createElement("text",Cb({},i,{dominantBaseline:"central",className:qt("recharts-radial-bar-label",l)}),Z.createElement("defs",null,Z.createElement("path",{id:E,d:T})),Z.createElement("textPath",{xlinkHref:"#".concat(E)},n))},yet=function(e){var n=e.viewBox,i=e.offset,s=e.position,o=n,a=o.cx,l=o.cy,c=o.innerRadius,u=o.outerRadius,h=o.startAngle,f=o.endAngle,d=(h+f)/2;if(s==="outside"){var p=Nn(a,l,u+i,d),m=p.x,g=p.y;return{x:m,y:g,textAnchor:m>=a?"start":"end",verticalAnchor:"middle"}}if(s==="center")return{x:a,y:l,textAnchor:"middle",verticalAnchor:"middle"};if(s==="centerTop")return{x:a,y:l,textAnchor:"middle",verticalAnchor:"start"};if(s==="centerBottom")return{x:a,y:l,textAnchor:"middle",verticalAnchor:"end"};var v=(c+u)/2,y=Nn(a,l,v,d),x=y.x,b=y.y;return{x,y:b,textAnchor:"middle",verticalAnchor:"middle"}},vet=function(e){var n=e.viewBox,i=e.parentViewBox,s=e.offset,o=e.position,a=n,l=a.x,c=a.y,u=a.width,h=a.height,f=h>=0?1:-1,d=f*s,p=f>0?"end":"start",m=f>0?"start":"end",g=u>=0?1:-1,v=g*s,y=g>0?"end":"start",x=g>0?"start":"end";if(o==="top"){var b={x:l+u/2,y:c-f*s,textAnchor:"middle",verticalAnchor:p};return ri(ri({},b),i?{height:Math.max(c-i.y,0),width:u}:{})}if(o==="bottom"){var w={x:l+u/2,y:c+h+d,textAnchor:"middle",verticalAnchor:m};return ri(ri({},w),i?{height:Math.max(i.y+i.height-(c+h),0),width:u}:{})}if(o==="left"){var _={x:l-v,y:c+h/2,textAnchor:y,verticalAnchor:"middle"};return ri(ri({},_),i?{width:Math.max(_.x-i.x,0),height:h}:{})}if(o==="right"){var S={x:l+u+v,y:c+h/2,textAnchor:x,verticalAnchor:"middle"};return ri(ri({},S),i?{width:Math.max(i.x+i.width-S.x,0),height:h}:{})}var T=i?{width:u,height:h}:{};return o==="insideLeft"?ri({x:l+v,y:c+h/2,textAnchor:x,verticalAnchor:"middle"},T):o==="insideRight"?ri({x:l+u-v,y:c+h/2,textAnchor:y,verticalAnchor:"middle"},T):o==="insideTop"?ri({x:l+u/2,y:c+d,textAnchor:"middle",verticalAnchor:m},T):o==="insideBottom"?ri({x:l+u/2,y:c+h-d,textAnchor:"middle",verticalAnchor:p},T):o==="insideTopLeft"?ri({x:l+v,y:c+d,textAnchor:x,verticalAnchor:m},T):o==="insideTopRight"?ri({x:l+u-v,y:c+d,textAnchor:y,verticalAnchor:m},T):o==="insideBottomLeft"?ri({x:l+v,y:c+h-d,textAnchor:x,verticalAnchor:p},T):o==="insideBottomRight"?ri({x:l+u-v,y:c+h-d,textAnchor:y,verticalAnchor:p},T):Ay(o)&&(We(o.x)||qf(o.x))&&(We(o.y)||qf(o.y))?ri({x:l+Ya(o.x,u),y:c+Ya(o.y,h),textAnchor:"end",verticalAnchor:"end"},T):ri({x:l+u/2,y:c+h/2,textAnchor:"middle",verticalAnchor:"middle"},T)},xet=function(e){return"cx"in e&&We(e.cx)};function Bi(r){var e=r.offset,n=e===void 0?5:e,i=cet(r,net),s=ri({offset:n},i),o=s.viewBox,a=s.position,l=s.value,c=s.children,u=s.content,h=s.className,f=h===void 0?"":h,d=s.textBreakAll;if(!o||nn(l)&&nn(c)&&!te.isValidElement(u)&&!Ut(u))return null;if(te.isValidElement(u))return te.cloneElement(u,s);var p;if(Ut(u)){if(p=te.createElement(u,s),te.isValidElement(p))return p}else p=pet(s);var m=xet(o),g=Tt(s,!0);if(m&&(a==="insideStart"||a==="insideEnd"||a==="end"))return get(s,p,g);var v=m?yet(s):vet(s);return Z.createElement(Lg,Cb({className:qt("recharts-label",f)},g,v,{breakAll:d}),p)}Bi.displayName="Label";var gre=function(e){var n=e.cx,i=e.cy,s=e.angle,o=e.startAngle,a=e.endAngle,l=e.r,c=e.radius,u=e.innerRadius,h=e.outerRadius,f=e.x,d=e.y,p=e.top,m=e.left,g=e.width,v=e.height,y=e.clockWise,x=e.labelViewBox;if(x)return x;if(We(g)&&We(v)){if(We(f)&&We(d))return{x:f,y:d,width:g,height:v};if(We(p)&&We(m))return{x:p,y:m,width:g,height:v}}return We(f)&&We(d)?{x:f,y:d,width:0,height:0}:We(n)&&We(i)?{cx:n,cy:i,startAngle:o||s||0,endAngle:a||s||0,innerRadius:u||0,outerRadius:h||c||l||0,clockWise:y}:e.viewBox?e.viewBox:{}},bet=function(e,n){return e?e===!0?Z.createElement(Bi,{key:"label-implicit",viewBox:n}):ci(e)?Z.createElement(Bi,{key:"label-implicit",viewBox:n,value:e}):te.isValidElement(e)?e.type===Bi?te.cloneElement(e,{key:"label-implicit",viewBox:n}):Z.createElement(Bi,{key:"label-implicit",content:e,viewBox:n}):Ut(e)?Z.createElement(Bi,{key:"label-implicit",content:e,viewBox:n}):Ay(e)?Z.createElement(Bi,Cb({viewBox:n},e,{key:"label-implicit"})):null:null},_et=function(e,n){var i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;if(!e||!e.children&&i&&!e.label)return null;var s=e.children,o=gre(e),a=ua(s,Bi).map(function(c,u){return te.cloneElement(c,{viewBox:n||o,key:"label-".concat(u)})});if(!i)return a;var l=bet(e.label,n||o);return[l].concat(ret(a))};Bi.parseViewBox=gre;Bi.renderCallByParent=_et;function wet(r){var e=r==null?0:r.length;return e?r[e-1]:void 0}var Tet=wet;const yre=hn(Tet);function Pb(r){"@babel/helpers - typeof";return Pb=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Pb(r)}var Eet=["valueAccessor"],Met=["data","dataKey","clockWise","id","textBreakAll"];function Aet(r){return Net(r)||Ret(r)||Pet(r)||Cet()}function Cet(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Pet(r,e){if(r){if(typeof r=="string")return Ak(r,e);var n=Object.prototype.toString.call(r).slice(8,-1);if(n==="Object"&&r.constructor&&(n=r.constructor.name),n==="Map"||n==="Set")return Array.from(r);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Ak(r,e)}}function Ret(r){if(typeof Symbol<"u"&&r[Symbol.iterator]!=null||r["@@iterator"]!=null)return Array.from(r)}function Net(r){if(Array.isArray(r))return Ak(r)}function Ak(r,e){(e==null||e>r.length)&&(e=r.length);for(var n=0,i=new Array(e);n<e;n++)i[n]=r[n];return i}function jE(){return jE=Object.assign?Object.assign.bind():function(r){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(r[i]=n[i])}return r},jE.apply(this,arguments)}function _6(r,e){var n=Object.keys(r);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(r);e&&(i=i.filter(function(s){return Object.getOwnPropertyDescriptor(r,s).enumerable})),n.push.apply(n,i)}return n}function w6(r){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?_6(Object(n),!0).forEach(function(i){Oet(r,i,n[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(n)):_6(Object(n)).forEach(function(i){Object.defineProperty(r,i,Object.getOwnPropertyDescriptor(n,i))})}return r}function Oet(r,e,n){return e=Det(e),e in r?Object.defineProperty(r,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):r[e]=n,r}function Det(r){var e=ket(r,"string");return Pb(e)=="symbol"?e:e+""}function ket(r,e){if(Pb(r)!="object"||!r)return r;var n=r[Symbol.toPrimitive];if(n!==void 0){var i=n.call(r,e||"default");if(Pb(i)!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(r)}function S6(r,e){if(r==null)return{};var n=Iet(r,e),i,s;if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(r);for(s=0;s<o.length;s++)i=o[s],!(e.indexOf(i)>=0)&&Object.prototype.propertyIsEnumerable.call(r,i)&&(n[i]=r[i])}return n}function Iet(r,e){if(r==null)return{};var n={};for(var i in r)if(Object.prototype.hasOwnProperty.call(r,i)){if(e.indexOf(i)>=0)continue;n[i]=r[i]}return n}var Let=function(e){return Array.isArray(e.value)?yre(e.value):e.value};function eu(r){var e=r.valueAccessor,n=e===void 0?Let:e,i=S6(r,Eet),s=i.data,o=i.dataKey,a=i.clockWise,l=i.id,c=i.textBreakAll,u=S6(i,Met);return!s||!s.length?null:Z.createElement(Sn,{className:"recharts-label-list"},s.map(function(h,f){var d=nn(o)?n(h,f):Is(h&&h.payload,o),p=nn(l)?{}:{id:"".concat(l,"-").concat(f)};return Z.createElement(Bi,jE({},Tt(h,!0),u,p,{parentViewBox:h.parentViewBox,value:d,textBreakAll:c,viewBox:Bi.parseViewBox(nn(a)?h:w6(w6({},h),{},{clockWise:a})),key:"label-".concat(f),index:f}))}))}eu.displayName="LabelList";function Fet(r,e){return r?r===!0?Z.createElement(eu,{key:"labelList-implicit",data:e}):Z.isValidElement(r)||Ut(r)?Z.createElement(eu,{key:"labelList-implicit",data:e,content:r}):Ay(r)?Z.createElement(eu,jE({data:e},r,{key:"labelList-implicit"})):null:null}function Bet(r,e){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;if(!r||!r.children&&n&&!r.label)return null;var i=r.children,s=ua(i,eu).map(function(a,l){return te.cloneElement(a,{data:e,key:"labelList-".concat(l)})});if(!n)return s;var o=Fet(r.label,e);return[o].concat(Aet(s))}eu.renderCallByParent=Bet;function Rb(r){"@babel/helpers - typeof";return Rb=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Rb(r)}function Ck(){return Ck=Object.assign?Object.assign.bind():function(r){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(r[i]=n[i])}return r},Ck.apply(this,arguments)}function T6(r,e){var n=Object.keys(r);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(r);e&&(i=i.filter(function(s){return Object.getOwnPropertyDescriptor(r,s).enumerable})),n.push.apply(n,i)}return n}function E6(r){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?T6(Object(n),!0).forEach(function(i){Uet(r,i,n[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(n)):T6(Object(n)).forEach(function(i){Object.defineProperty(r,i,Object.getOwnPropertyDescriptor(n,i))})}return r}function Uet(r,e,n){return e=zet(e),e in r?Object.defineProperty(r,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):r[e]=n,r}function zet(r){var e=$et(r,"string");return Rb(e)=="symbol"?e:e+""}function $et(r,e){if(Rb(r)!="object"||!r)return r;var n=r[Symbol.toPrimitive];if(n!==void 0){var i=n.call(r,e||"default");if(Rb(i)!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(r)}var jet=function(e,n){var i=Ka(n-e),s=Math.min(Math.abs(n-e),359.999);return i*s},s1=function(e){var n=e.cx,i=e.cy,s=e.radius,o=e.angle,a=e.sign,l=e.isExternal,c=e.cornerRadius,u=e.cornerIsExternal,h=c*(l?1:-1)+s,f=Math.asin(c/h)/$E,d=u?o:o+a*f,p=Nn(n,i,h,d),m=Nn(n,i,s,d),g=u?o-a*f:o,v=Nn(n,i,h*Math.cos(f*$E),g);return{center:p,circleTangency:m,lineTangency:v,theta:f}},vre=function(e){var n=e.cx,i=e.cy,s=e.innerRadius,o=e.outerRadius,a=e.startAngle,l=e.endAngle,c=jet(a,l),u=a+c,h=Nn(n,i,o,a),f=Nn(n,i,o,u),d="M ".concat(h.x,",").concat(h.y,`
    A `).concat(o,",").concat(o,`,0,
    `).concat(+(Math.abs(c)>180),",").concat(+(a>u),`,
    `).concat(f.x,",").concat(f.y,`
  `);if(s>0){var p=Nn(n,i,s,a),m=Nn(n,i,s,u);d+="L ".concat(m.x,",").concat(m.y,`
            A `).concat(s,",").concat(s,`,0,
            `).concat(+(Math.abs(c)>180),",").concat(+(a<=u),`,
            `).concat(p.x,",").concat(p.y," Z")}else d+="L ".concat(n,",").concat(i," Z");return d},Vet=function(e){var n=e.cx,i=e.cy,s=e.innerRadius,o=e.outerRadius,a=e.cornerRadius,l=e.forceCornerRadius,c=e.cornerIsExternal,u=e.startAngle,h=e.endAngle,f=Ka(h-u),d=s1({cx:n,cy:i,radius:o,angle:u,sign:f,cornerRadius:a,cornerIsExternal:c}),p=d.circleTangency,m=d.lineTangency,g=d.theta,v=s1({cx:n,cy:i,radius:o,angle:h,sign:-f,cornerRadius:a,cornerIsExternal:c}),y=v.circleTangency,x=v.lineTangency,b=v.theta,w=c?Math.abs(u-h):Math.abs(u-h)-g-b;if(w<0)return l?"M ".concat(m.x,",").concat(m.y,`
        a`).concat(a,",").concat(a,",0,0,1,").concat(a*2,`,0
        a`).concat(a,",").concat(a,",0,0,1,").concat(-a*2,`,0
      `):vre({cx:n,cy:i,innerRadius:s,outerRadius:o,startAngle:u,endAngle:h});var _="M ".concat(m.x,",").concat(m.y,`
    A`).concat(a,",").concat(a,",0,0,").concat(+(f<0),",").concat(p.x,",").concat(p.y,`
    A`).concat(o,",").concat(o,",0,").concat(+(w>180),",").concat(+(f<0),",").concat(y.x,",").concat(y.y,`
    A`).concat(a,",").concat(a,",0,0,").concat(+(f<0),",").concat(x.x,",").concat(x.y,`
  `);if(s>0){var S=s1({cx:n,cy:i,radius:s,angle:u,sign:f,isExternal:!0,cornerRadius:a,cornerIsExternal:c}),T=S.circleTangency,E=S.lineTangency,M=S.theta,A=s1({cx:n,cy:i,radius:s,angle:h,sign:-f,isExternal:!0,cornerRadius:a,cornerIsExternal:c}),P=A.circleTangency,D=A.lineTangency,B=A.theta,C=c?Math.abs(u-h):Math.abs(u-h)-M-B;if(C<0&&a===0)return"".concat(_,"L").concat(n,",").concat(i,"Z");_+="L".concat(D.x,",").concat(D.y,`
      A`).concat(a,",").concat(a,",0,0,").concat(+(f<0),",").concat(P.x,",").concat(P.y,`
      A`).concat(s,",").concat(s,",0,").concat(+(C>180),",").concat(+(f>0),",").concat(T.x,",").concat(T.y,`
      A`).concat(a,",").concat(a,",0,0,").concat(+(f<0),",").concat(E.x,",").concat(E.y,"Z")}else _+="L".concat(n,",").concat(i,"Z");return _},Get={cx:0,cy:0,innerRadius:0,outerRadius:0,startAngle:0,endAngle:0,cornerRadius:0,forceCornerRadius:!1,cornerIsExternal:!1},xre=function(e){var n=E6(E6({},Get),e),i=n.cx,s=n.cy,o=n.innerRadius,a=n.outerRadius,l=n.cornerRadius,c=n.forceCornerRadius,u=n.cornerIsExternal,h=n.startAngle,f=n.endAngle,d=n.className;if(a<o||h===f)return null;var p=qt("recharts-sector",d),m=a-o,g=Ya(l,m,0,!0),v;return g>0&&Math.abs(h-f)<360?v=Vet({cx:i,cy:s,innerRadius:o,outerRadius:a,cornerRadius:Math.min(g,m/2),forceCornerRadius:c,cornerIsExternal:u,startAngle:h,endAngle:f}):v=vre({cx:i,cy:s,innerRadius:o,outerRadius:a,startAngle:h,endAngle:f}),Z.createElement("path",Ck({},Tt(n,!0),{className:p,d:v,role:"img"}))};function Nb(r){"@babel/helpers - typeof";return Nb=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Nb(r)}function Pk(){return Pk=Object.assign?Object.assign.bind():function(r){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(r[i]=n[i])}return r},Pk.apply(this,arguments)}function M6(r,e){var n=Object.keys(r);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(r);e&&(i=i.filter(function(s){return Object.getOwnPropertyDescriptor(r,s).enumerable})),n.push.apply(n,i)}return n}function A6(r){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?M6(Object(n),!0).forEach(function(i){Het(r,i,n[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(n)):M6(Object(n)).forEach(function(i){Object.defineProperty(r,i,Object.getOwnPropertyDescriptor(n,i))})}return r}function Het(r,e,n){return e=Wet(e),e in r?Object.defineProperty(r,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):r[e]=n,r}function Wet(r){var e=qet(r,"string");return Nb(e)=="symbol"?e:e+""}function qet(r,e){if(Nb(r)!="object"||!r)return r;var n=r[Symbol.toPrimitive];if(n!==void 0){var i=n.call(r,e||"default");if(Nb(i)!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(r)}var C6={curveBasisClosed:g8e,curveBasisOpen:y8e,curveBasis:m8e,curveBumpX:t8e,curveBumpY:n8e,curveLinearClosed:v8e,curveLinear:QA,curveMonotoneX:x8e,curveMonotoneY:b8e,curveNatural:_8e,curveStep:w8e,curveStepAfter:T8e,curveStepBefore:S8e},o1=function(e){return e.x===+e.x&&e.y===+e.y},Wv=function(e){return e.x},qv=function(e){return e.y},Xet=function(e,n){if(Ut(e))return e;var i="curve".concat(YA(e));return(i==="curveMonotone"||i==="curveBump")&&n?C6["".concat(i).concat(n==="vertical"?"Y":"X")]:C6[i]||QA},Ket=function(e){var n=e.type,i=n===void 0?"linear":n,s=e.points,o=s===void 0?[]:s,a=e.baseLine,l=e.layout,c=e.connectNulls,u=c===void 0?!1:c,h=Xet(i,l),f=u?o.filter(function(g){return o1(g)}):o,d;if(Array.isArray(a)){var p=u?a.filter(function(g){return o1(g)}):a,m=f.map(function(g,v){return A6(A6({},g),{},{base:p[v]})});return l==="vertical"?d=JS().y(qv).x1(Wv).x0(function(g){return g.base.x}):d=JS().x(Wv).y1(qv).y0(function(g){return g.base.y}),d.defined(o1).curve(h),d(m)}return l==="vertical"&&We(a)?d=JS().y(qv).x1(Wv).x0(a):We(a)?d=JS().x(Wv).y1(qv).y0(a):d=Hte().x(Wv).y(qv),d.defined(o1).curve(h),d(f)},Rk=function(e){var n=e.className,i=e.points,s=e.path,o=e.pathRef;if((!i||!i.length)&&!s)return null;var a=i&&i.length?Ket(e):s;return Z.createElement("path",Pk({},Tt(e,!1),SE(e),{className:qt("recharts-curve",n),d:a,ref:o}))},Yet=Object.getOwnPropertyNames,Zet=Object.getOwnPropertySymbols,Qet=Object.prototype.hasOwnProperty;function P6(r,e){return function(i,s,o){return r(i,s,o)&&e(i,s,o)}}function a1(r){return function(n,i,s){if(!n||!i||typeof n!="object"||typeof i!="object")return r(n,i,s);var o=s.cache,a=o.get(n),l=o.get(i);if(a&&l)return a===i&&l===n;o.set(n,i),o.set(i,n);var c=r(n,i,s);return o.delete(n),o.delete(i),c}}function R6(r){return Yet(r).concat(Zet(r))}var Jet=Object.hasOwn||function(r,e){return Qet.call(r,e)};function Bd(r,e){return r===e||!r&&!e&&r!==r&&e!==e}var ett="__v",ttt="__o",ntt="_owner",N6=Object.getOwnPropertyDescriptor,O6=Object.keys;function rtt(r,e,n){var i=r.length;if(e.length!==i)return!1;for(;i-- >0;)if(!n.equals(r[i],e[i],i,i,r,e,n))return!1;return!0}function itt(r,e){return Bd(r.getTime(),e.getTime())}function stt(r,e){return r.name===e.name&&r.message===e.message&&r.cause===e.cause&&r.stack===e.stack}function ott(r,e){return r===e}function D6(r,e,n){var i=r.size;if(i!==e.size)return!1;if(!i)return!0;for(var s=new Array(i),o=r.entries(),a,l,c=0;(a=o.next())&&!a.done;){for(var u=e.entries(),h=!1,f=0;(l=u.next())&&!l.done;){if(s[f]){f++;continue}var d=a.value,p=l.value;if(n.equals(d[0],p[0],c,f,r,e,n)&&n.equals(d[1],p[1],d[0],p[0],r,e,n)){h=s[f]=!0;break}f++}if(!h)return!1;c++}return!0}var att=Bd;function ltt(r,e,n){var i=O6(r),s=i.length;if(O6(e).length!==s)return!1;for(;s-- >0;)if(!bre(r,e,n,i[s]))return!1;return!0}function Xv(r,e,n){var i=R6(r),s=i.length;if(R6(e).length!==s)return!1;for(var o,a,l;s-- >0;)if(o=i[s],!bre(r,e,n,o)||(a=N6(r,o),l=N6(e,o),(a||l)&&(!a||!l||a.configurable!==l.configurable||a.enumerable!==l.enumerable||a.writable!==l.writable)))return!1;return!0}function ctt(r,e){return Bd(r.valueOf(),e.valueOf())}function utt(r,e){return r.source===e.source&&r.flags===e.flags}function k6(r,e,n){var i=r.size;if(i!==e.size)return!1;if(!i)return!0;for(var s=new Array(i),o=r.values(),a,l;(a=o.next())&&!a.done;){for(var c=e.values(),u=!1,h=0;(l=c.next())&&!l.done;){if(!s[h]&&n.equals(a.value,l.value,a.value,l.value,r,e,n)){u=s[h]=!0;break}h++}if(!u)return!1}return!0}function htt(r,e){var n=r.length;if(e.length!==n)return!1;for(;n-- >0;)if(r[n]!==e[n])return!1;return!0}function ftt(r,e){return r.hostname===e.hostname&&r.pathname===e.pathname&&r.protocol===e.protocol&&r.port===e.port&&r.hash===e.hash&&r.username===e.username&&r.password===e.password}function bre(r,e,n,i){return(i===ntt||i===ttt||i===ett)&&(r.$$typeof||e.$$typeof)?!0:Jet(e,i)&&n.equals(r[i],e[i],i,i,r,e,n)}var dtt="[object Arguments]",ptt="[object Boolean]",mtt="[object Date]",gtt="[object Error]",ytt="[object Map]",vtt="[object Number]",xtt="[object Object]",btt="[object RegExp]",_tt="[object Set]",wtt="[object String]",Stt="[object URL]",Ttt=Array.isArray,I6=typeof ArrayBuffer=="function"&&ArrayBuffer.isView?ArrayBuffer.isView:null,L6=Object.assign,Ett=Object.prototype.toString.call.bind(Object.prototype.toString);function Mtt(r){var e=r.areArraysEqual,n=r.areDatesEqual,i=r.areErrorsEqual,s=r.areFunctionsEqual,o=r.areMapsEqual,a=r.areNumbersEqual,l=r.areObjectsEqual,c=r.arePrimitiveWrappersEqual,u=r.areRegExpsEqual,h=r.areSetsEqual,f=r.areTypedArraysEqual,d=r.areUrlsEqual;return function(m,g,v){if(m===g)return!0;if(m==null||g==null)return!1;var y=typeof m;if(y!==typeof g)return!1;if(y!=="object")return y==="number"?a(m,g,v):y==="function"?s(m,g,v):!1;var x=m.constructor;if(x!==g.constructor)return!1;if(x===Object)return l(m,g,v);if(Ttt(m))return e(m,g,v);if(I6!=null&&I6(m))return f(m,g,v);if(x===Date)return n(m,g,v);if(x===RegExp)return u(m,g,v);if(x===Map)return o(m,g,v);if(x===Set)return h(m,g,v);var b=Ett(m);return b===mtt?n(m,g,v):b===btt?u(m,g,v):b===ytt?o(m,g,v):b===_tt?h(m,g,v):b===xtt?typeof m.then!="function"&&typeof g.then!="function"&&l(m,g,v):b===Stt?d(m,g,v):b===gtt?i(m,g,v):b===dtt?l(m,g,v):b===ptt||b===vtt||b===wtt?c(m,g,v):!1}}function Att(r){var e=r.circular,n=r.createCustomConfig,i=r.strict,s={areArraysEqual:i?Xv:rtt,areDatesEqual:itt,areErrorsEqual:stt,areFunctionsEqual:ott,areMapsEqual:i?P6(D6,Xv):D6,areNumbersEqual:att,areObjectsEqual:i?Xv:ltt,arePrimitiveWrappersEqual:ctt,areRegExpsEqual:utt,areSetsEqual:i?P6(k6,Xv):k6,areTypedArraysEqual:i?Xv:htt,areUrlsEqual:ftt};if(n&&(s=L6({},s,n(s))),e){var o=a1(s.areArraysEqual),a=a1(s.areMapsEqual),l=a1(s.areObjectsEqual),c=a1(s.areSetsEqual);s=L6({},s,{areArraysEqual:o,areMapsEqual:a,areObjectsEqual:l,areSetsEqual:c})}return s}function Ctt(r){return function(e,n,i,s,o,a,l){return r(e,n,l)}}function Ptt(r){var e=r.circular,n=r.comparator,i=r.createState,s=r.equals,o=r.strict;if(i)return function(c,u){var h=i(),f=h.cache,d=f===void 0?e?new WeakMap:void 0:f,p=h.meta;return n(c,u,{cache:d,equals:s,meta:p,strict:o})};if(e)return function(c,u){return n(c,u,{cache:new WeakMap,equals:s,meta:void 0,strict:o})};var a={cache:void 0,equals:s,meta:void 0,strict:o};return function(c,u){return n(c,u,a)}}var Rtt=Qh();Qh({strict:!0});Qh({circular:!0});Qh({circular:!0,strict:!0});Qh({createInternalComparator:function(){return Bd}});Qh({strict:!0,createInternalComparator:function(){return Bd}});Qh({circular:!0,createInternalComparator:function(){return Bd}});Qh({circular:!0,createInternalComparator:function(){return Bd},strict:!0});function Qh(r){r===void 0&&(r={});var e=r.circular,n=e===void 0?!1:e,i=r.createInternalComparator,s=r.createState,o=r.strict,a=o===void 0?!1:o,l=Att(r),c=Mtt(l),u=i?i(c):Ctt(c);return Ptt({circular:n,comparator:c,createState:s,equals:u,strict:a})}function Ntt(r){typeof requestAnimationFrame<"u"&&requestAnimationFrame(r)}function F6(r){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,n=-1,i=function s(o){n<0&&(n=o),o-n>e?(r(o),n=-1):Ntt(s)};requestAnimationFrame(i)}function Nk(r){"@babel/helpers - typeof";return Nk=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Nk(r)}function Ott(r){return Ltt(r)||Itt(r)||ktt(r)||Dtt()}function Dtt(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function ktt(r,e){if(r){if(typeof r=="string")return B6(r,e);var n=Object.prototype.toString.call(r).slice(8,-1);if(n==="Object"&&r.constructor&&(n=r.constructor.name),n==="Map"||n==="Set")return Array.from(r);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return B6(r,e)}}function B6(r,e){(e==null||e>r.length)&&(e=r.length);for(var n=0,i=new Array(e);n<e;n++)i[n]=r[n];return i}function Itt(r){if(typeof Symbol<"u"&&r[Symbol.iterator]!=null||r["@@iterator"]!=null)return Array.from(r)}function Ltt(r){if(Array.isArray(r))return r}function Ftt(){var r={},e=function(){return null},n=!1,i=function s(o){if(!n){if(Array.isArray(o)){if(!o.length)return;var a=o,l=Ott(a),c=l[0],u=l.slice(1);if(typeof c=="number"){F6(s.bind(null,u),c);return}s(c),F6(s.bind(null,u));return}Nk(o)==="object"&&(r=o,e(r)),typeof o=="function"&&o()}};return{stop:function(){n=!0},start:function(o){n=!1,i(o)},subscribe:function(o){return e=o,function(){e=function(){return null}}}}}function Ob(r){"@babel/helpers - typeof";return Ob=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Ob(r)}function U6(r,e){var n=Object.keys(r);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(r);e&&(i=i.filter(function(s){return Object.getOwnPropertyDescriptor(r,s).enumerable})),n.push.apply(n,i)}return n}function z6(r){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?U6(Object(n),!0).forEach(function(i){_re(r,i,n[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(n)):U6(Object(n)).forEach(function(i){Object.defineProperty(r,i,Object.getOwnPropertyDescriptor(n,i))})}return r}function _re(r,e,n){return e=Btt(e),e in r?Object.defineProperty(r,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):r[e]=n,r}function Btt(r){var e=Utt(r,"string");return Ob(e)==="symbol"?e:String(e)}function Utt(r,e){if(Ob(r)!=="object"||r===null)return r;var n=r[Symbol.toPrimitive];if(n!==void 0){var i=n.call(r,e||"default");if(Ob(i)!=="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(r)}var ztt=function(e,n){return[Object.keys(e),Object.keys(n)].reduce(function(i,s){return i.filter(function(o){return s.includes(o)})})},$tt=function(e){return e},jtt=function(e){return e.replace(/([A-Z])/g,function(n){return"-".concat(n.toLowerCase())})},Y0=function(e,n){return Object.keys(n).reduce(function(i,s){return z6(z6({},i),{},_re({},s,e(s,n[s])))},{})},$6=function(e,n,i){return e.map(function(s){return"".concat(jtt(s)," ").concat(n,"ms ").concat(i)}).join(",")};function Vtt(r,e){return Wtt(r)||Htt(r,e)||wre(r,e)||Gtt()}function Gtt(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Htt(r,e){var n=r==null?null:typeof Symbol<"u"&&r[Symbol.iterator]||r["@@iterator"];if(n!=null){var i,s,o,a,l=[],c=!0,u=!1;try{if(o=(n=n.call(r)).next,e!==0)for(;!(c=(i=o.call(n)).done)&&(l.push(i.value),l.length!==e);c=!0);}catch(h){u=!0,s=h}finally{try{if(!c&&n.return!=null&&(a=n.return(),Object(a)!==a))return}finally{if(u)throw s}}return l}}function Wtt(r){if(Array.isArray(r))return r}function qtt(r){return Ytt(r)||Ktt(r)||wre(r)||Xtt()}function Xtt(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function wre(r,e){if(r){if(typeof r=="string")return Ok(r,e);var n=Object.prototype.toString.call(r).slice(8,-1);if(n==="Object"&&r.constructor&&(n=r.constructor.name),n==="Map"||n==="Set")return Array.from(r);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Ok(r,e)}}function Ktt(r){if(typeof Symbol<"u"&&r[Symbol.iterator]!=null||r["@@iterator"]!=null)return Array.from(r)}function Ytt(r){if(Array.isArray(r))return Ok(r)}function Ok(r,e){(e==null||e>r.length)&&(e=r.length);for(var n=0,i=new Array(e);n<e;n++)i[n]=r[n];return i}var VE=1e-4,Sre=function(e,n){return[0,3*e,3*n-6*e,3*e-3*n+1]},Tre=function(e,n){return e.map(function(i,s){return i*Math.pow(n,s)}).reduce(function(i,s){return i+s})},j6=function(e,n){return function(i){var s=Sre(e,n);return Tre(s,i)}},Ztt=function(e,n){return function(i){var s=Sre(e,n),o=[].concat(qtt(s.map(function(a,l){return a*l}).slice(1)),[0]);return Tre(o,i)}},V6=function(){for(var e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];var s=n[0],o=n[1],a=n[2],l=n[3];if(n.length===1)switch(n[0]){case"linear":s=0,o=0,a=1,l=1;break;case"ease":s=.25,o=.1,a=.25,l=1;break;case"ease-in":s=.42,o=0,a=1,l=1;break;case"ease-out":s=.42,o=0,a=.58,l=1;break;case"ease-in-out":s=0,o=0,a=.58,l=1;break;default:{var c=n[0].split("(");if(c[0]==="cubic-bezier"&&c[1].split(")")[0].split(",").length===4){var u=c[1].split(")")[0].split(",").map(function(v){return parseFloat(v)}),h=Vtt(u,4);s=h[0],o=h[1],a=h[2],l=h[3]}}}var f=j6(s,a),d=j6(o,l),p=Ztt(s,a),m=function(y){return y>1?1:y<0?0:y},g=function(y){for(var x=y>1?1:y,b=x,w=0;w<8;++w){var _=f(b)-x,S=p(b);if(Math.abs(_-x)<VE||S<VE)return d(b);b=m(b-_/S)}return d(b)};return g.isStepper=!1,g},Qtt=function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},n=e.stiff,i=n===void 0?100:n,s=e.damping,o=s===void 0?8:s,a=e.dt,l=a===void 0?17:a,c=function(h,f,d){var p=-(h-f)*i,m=d*o,g=d+(p-m)*l/1e3,v=d*l/1e3+h;return Math.abs(v-f)<VE&&Math.abs(g)<VE?[f,0]:[v,g]};return c.isStepper=!0,c.dt=l,c},Jtt=function(){for(var e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];var s=n[0];if(typeof s=="string")switch(s){case"ease":case"ease-in-out":case"ease-out":case"ease-in":case"linear":return V6(s);case"spring":return Qtt();default:if(s.split("(")[0]==="cubic-bezier")return V6(s)}return typeof s=="function"?s:null};function Db(r){"@babel/helpers - typeof";return Db=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Db(r)}function G6(r){return nnt(r)||tnt(r)||Ere(r)||ent()}function ent(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function tnt(r){if(typeof Symbol<"u"&&r[Symbol.iterator]!=null||r["@@iterator"]!=null)return Array.from(r)}function nnt(r){if(Array.isArray(r))return kk(r)}function H6(r,e){var n=Object.keys(r);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(r);e&&(i=i.filter(function(s){return Object.getOwnPropertyDescriptor(r,s).enumerable})),n.push.apply(n,i)}return n}function Oi(r){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?H6(Object(n),!0).forEach(function(i){Dk(r,i,n[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(n)):H6(Object(n)).forEach(function(i){Object.defineProperty(r,i,Object.getOwnPropertyDescriptor(n,i))})}return r}function Dk(r,e,n){return e=rnt(e),e in r?Object.defineProperty(r,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):r[e]=n,r}function rnt(r){var e=int(r,"string");return Db(e)==="symbol"?e:String(e)}function int(r,e){if(Db(r)!=="object"||r===null)return r;var n=r[Symbol.toPrimitive];if(n!==void 0){var i=n.call(r,e||"default");if(Db(i)!=="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(r)}function snt(r,e){return lnt(r)||ant(r,e)||Ere(r,e)||ont()}function ont(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Ere(r,e){if(r){if(typeof r=="string")return kk(r,e);var n=Object.prototype.toString.call(r).slice(8,-1);if(n==="Object"&&r.constructor&&(n=r.constructor.name),n==="Map"||n==="Set")return Array.from(r);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return kk(r,e)}}function kk(r,e){(e==null||e>r.length)&&(e=r.length);for(var n=0,i=new Array(e);n<e;n++)i[n]=r[n];return i}function ant(r,e){var n=r==null?null:typeof Symbol<"u"&&r[Symbol.iterator]||r["@@iterator"];if(n!=null){var i,s,o,a,l=[],c=!0,u=!1;try{if(o=(n=n.call(r)).next,e!==0)for(;!(c=(i=o.call(n)).done)&&(l.push(i.value),l.length!==e);c=!0);}catch(h){u=!0,s=h}finally{try{if(!c&&n.return!=null&&(a=n.return(),Object(a)!==a))return}finally{if(u)throw s}}return l}}function lnt(r){if(Array.isArray(r))return r}var GE=function(e,n,i){return e+(n-e)*i},Ik=function(e){var n=e.from,i=e.to;return n!==i},cnt=function r(e,n,i){var s=Y0(function(o,a){if(Ik(a)){var l=e(a.from,a.to,a.velocity),c=snt(l,2),u=c[0],h=c[1];return Oi(Oi({},a),{},{from:u,velocity:h})}return a},n);return i<1?Y0(function(o,a){return Ik(a)?Oi(Oi({},a),{},{velocity:GE(a.velocity,s[o].velocity,i),from:GE(a.from,s[o].from,i)}):a},n):r(e,s,i-1)};const unt=function(r,e,n,i,s){var o=ztt(r,e),a=o.reduce(function(v,y){return Oi(Oi({},v),{},Dk({},y,[r[y],e[y]]))},{}),l=o.reduce(function(v,y){return Oi(Oi({},v),{},Dk({},y,{from:r[y],velocity:0,to:e[y]}))},{}),c=-1,u,h,f=function(){return null},d=function(){return Y0(function(y,x){return x.from},l)},p=function(){return!Object.values(l).filter(Ik).length},m=function(y){u||(u=y);var x=y-u,b=x/n.dt;l=cnt(n,l,b),s(Oi(Oi(Oi({},r),e),d())),u=y,p()||(c=requestAnimationFrame(f))},g=function(y){h||(h=y);var x=(y-h)/i,b=Y0(function(_,S){return GE.apply(void 0,G6(S).concat([n(x)]))},a);if(s(Oi(Oi(Oi({},r),e),b)),x<1)c=requestAnimationFrame(f);else{var w=Y0(function(_,S){return GE.apply(void 0,G6(S).concat([n(1)]))},a);s(Oi(Oi(Oi({},r),e),w))}};return f=n.isStepper?m:g,function(){return requestAnimationFrame(f),function(){cancelAnimationFrame(c)}}};function Bg(r){"@babel/helpers - typeof";return Bg=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Bg(r)}var hnt=["children","begin","duration","attributeName","easing","isActive","steps","from","to","canBegin","onAnimationEnd","shouldReAnimate","onAnimationReStart"];function fnt(r,e){if(r==null)return{};var n=dnt(r,e),i,s;if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(r);for(s=0;s<o.length;s++)i=o[s],!(e.indexOf(i)>=0)&&Object.prototype.propertyIsEnumerable.call(r,i)&&(n[i]=r[i])}return n}function dnt(r,e){if(r==null)return{};var n={},i=Object.keys(r),s,o;for(o=0;o<i.length;o++)s=i[o],!(e.indexOf(s)>=0)&&(n[s]=r[s]);return n}function a2(r){return ynt(r)||gnt(r)||mnt(r)||pnt()}function pnt(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function mnt(r,e){if(r){if(typeof r=="string")return Lk(r,e);var n=Object.prototype.toString.call(r).slice(8,-1);if(n==="Object"&&r.constructor&&(n=r.constructor.name),n==="Map"||n==="Set")return Array.from(r);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Lk(r,e)}}function gnt(r){if(typeof Symbol<"u"&&r[Symbol.iterator]!=null||r["@@iterator"]!=null)return Array.from(r)}function ynt(r){if(Array.isArray(r))return Lk(r)}function Lk(r,e){(e==null||e>r.length)&&(e=r.length);for(var n=0,i=new Array(e);n<e;n++)i[n]=r[n];return i}function W6(r,e){var n=Object.keys(r);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(r);e&&(i=i.filter(function(s){return Object.getOwnPropertyDescriptor(r,s).enumerable})),n.push.apply(n,i)}return n}function Ca(r){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?W6(Object(n),!0).forEach(function(i){p0(r,i,n[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(n)):W6(Object(n)).forEach(function(i){Object.defineProperty(r,i,Object.getOwnPropertyDescriptor(n,i))})}return r}function p0(r,e,n){return e=Mre(e),e in r?Object.defineProperty(r,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):r[e]=n,r}function vnt(r,e){if(!(r instanceof e))throw new TypeError("Cannot call a class as a function")}function xnt(r,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(r,Mre(i.key),i)}}function bnt(r,e,n){return e&&xnt(r.prototype,e),Object.defineProperty(r,"prototype",{writable:!1}),r}function Mre(r){var e=_nt(r,"string");return Bg(e)==="symbol"?e:String(e)}function _nt(r,e){if(Bg(r)!=="object"||r===null)return r;var n=r[Symbol.toPrimitive];if(n!==void 0){var i=n.call(r,e||"default");if(Bg(i)!=="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(r)}function wnt(r,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");r.prototype=Object.create(e&&e.prototype,{constructor:{value:r,writable:!0,configurable:!0}}),Object.defineProperty(r,"prototype",{writable:!1}),e&&Fk(r,e)}function Fk(r,e){return Fk=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(i,s){return i.__proto__=s,i},Fk(r,e)}function Snt(r){var e=Tnt();return function(){var i=HE(r),s;if(e){var o=HE(this).constructor;s=Reflect.construct(i,arguments,o)}else s=i.apply(this,arguments);return Bk(this,s)}}function Bk(r,e){if(e&&(Bg(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Uk(r)}function Uk(r){if(r===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return r}function Tnt(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function HE(r){return HE=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(n){return n.__proto__||Object.getPrototypeOf(n)},HE(r)}var jl=function(r){wnt(n,r);var e=Snt(n);function n(i,s){var o;vnt(this,n),o=e.call(this,i,s);var a=o.props,l=a.isActive,c=a.attributeName,u=a.from,h=a.to,f=a.steps,d=a.children,p=a.duration;if(o.handleStyleChange=o.handleStyleChange.bind(Uk(o)),o.changeStyle=o.changeStyle.bind(Uk(o)),!l||p<=0)return o.state={style:{}},typeof d=="function"&&(o.state={style:h}),Bk(o);if(f&&f.length)o.state={style:f[0].style};else if(u){if(typeof d=="function")return o.state={style:u},Bk(o);o.state={style:c?p0({},c,u):u}}else o.state={style:{}};return o}return bnt(n,[{key:"componentDidMount",value:function(){var s=this.props,o=s.isActive,a=s.canBegin;this.mounted=!0,!(!o||!a)&&this.runAnimation(this.props)}},{key:"componentDidUpdate",value:function(s){var o=this.props,a=o.isActive,l=o.canBegin,c=o.attributeName,u=o.shouldReAnimate,h=o.to,f=o.from,d=this.state.style;if(l){if(!a){var p={style:c?p0({},c,h):h};this.state&&d&&(c&&d[c]!==h||!c&&d!==h)&&this.setState(p);return}if(!(Rtt(s.to,h)&&s.canBegin&&s.isActive)){var m=!s.canBegin||!s.isActive;this.manager&&this.manager.stop(),this.stopJSAnimation&&this.stopJSAnimation();var g=m||u?f:s.to;if(this.state&&d){var v={style:c?p0({},c,g):g};(c&&d[c]!==g||!c&&d!==g)&&this.setState(v)}this.runAnimation(Ca(Ca({},this.props),{},{from:g,begin:0}))}}}},{key:"componentWillUnmount",value:function(){this.mounted=!1;var s=this.props.onAnimationEnd;this.unSubscribe&&this.unSubscribe(),this.manager&&(this.manager.stop(),this.manager=null),this.stopJSAnimation&&this.stopJSAnimation(),s&&s()}},{key:"handleStyleChange",value:function(s){this.changeStyle(s)}},{key:"changeStyle",value:function(s){this.mounted&&this.setState({style:s})}},{key:"runJSAnimation",value:function(s){var o=this,a=s.from,l=s.to,c=s.duration,u=s.easing,h=s.begin,f=s.onAnimationEnd,d=s.onAnimationStart,p=unt(a,l,Jtt(u),c,this.changeStyle),m=function(){o.stopJSAnimation=p()};this.manager.start([d,h,m,c,f])}},{key:"runStepAnimation",value:function(s){var o=this,a=s.steps,l=s.begin,c=s.onAnimationStart,u=a[0],h=u.style,f=u.duration,d=f===void 0?0:f,p=function(g,v,y){if(y===0)return g;var x=v.duration,b=v.easing,w=b===void 0?"ease":b,_=v.style,S=v.properties,T=v.onAnimationEnd,E=y>0?a[y-1]:v,M=S||Object.keys(_);if(typeof w=="function"||w==="spring")return[].concat(a2(g),[o.runJSAnimation.bind(o,{from:E.style,to:_,duration:x,easing:w}),x]);var A=$6(M,x,w),P=Ca(Ca(Ca({},E.style),_),{},{transition:A});return[].concat(a2(g),[P,x,T]).filter($tt)};return this.manager.start([c].concat(a2(a.reduce(p,[h,Math.max(d,l)])),[s.onAnimationEnd]))}},{key:"runAnimation",value:function(s){this.manager||(this.manager=Ftt());var o=s.begin,a=s.duration,l=s.attributeName,c=s.to,u=s.easing,h=s.onAnimationStart,f=s.onAnimationEnd,d=s.steps,p=s.children,m=this.manager;if(this.unSubscribe=m.subscribe(this.handleStyleChange),typeof u=="function"||typeof p=="function"||u==="spring"){this.runJSAnimation(s);return}if(d.length>1){this.runStepAnimation(s);return}var g=l?p0({},l,c):c,v=$6(Object.keys(g),a,u);m.start([h,o,Ca(Ca({},g),{},{transition:v}),a,f])}},{key:"render",value:function(){var s=this.props,o=s.children;s.begin;var a=s.duration;s.attributeName,s.easing;var l=s.isActive;s.steps,s.from,s.to,s.canBegin,s.onAnimationEnd,s.shouldReAnimate,s.onAnimationReStart;var c=fnt(s,hnt),u=te.Children.count(o),h=this.state.style;if(typeof o=="function")return o(h);if(!l||u===0||a<=0)return o;var f=function(p){var m=p.props,g=m.style,v=g===void 0?{}:g,y=m.className,x=te.cloneElement(p,Ca(Ca({},c),{},{style:Ca(Ca({},v),h),className:y}));return x};return u===1?f(te.Children.only(o)):Z.createElement("div",null,te.Children.map(o,function(d){return f(d)}))}}]),n}(te.PureComponent);jl.displayName="Animate";jl.defaultProps={begin:0,duration:1e3,from:"",to:"",attributeName:"",easing:"ease",isActive:!0,canBegin:!0,steps:[],onAnimationEnd:function(){},onAnimationStart:function(){}};jl.propTypes={from:ie.oneOfType([ie.object,ie.string]),to:ie.oneOfType([ie.object,ie.string]),attributeName:ie.string,duration:ie.number,begin:ie.number,easing:ie.oneOfType([ie.string,ie.func]),steps:ie.arrayOf(ie.shape({duration:ie.number.isRequired,style:ie.object.isRequired,easing:ie.oneOfType([ie.oneOf(["ease","ease-in","ease-out","ease-in-out","linear"]),ie.func]),properties:ie.arrayOf("string"),onAnimationEnd:ie.func})),children:ie.oneOfType([ie.node,ie.func]),isActive:ie.bool,canBegin:ie.bool,onAnimationEnd:ie.func,shouldReAnimate:ie.bool,onAnimationStart:ie.func,onAnimationReStart:ie.func};function kb(r){"@babel/helpers - typeof";return kb=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},kb(r)}function WE(){return WE=Object.assign?Object.assign.bind():function(r){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(r[i]=n[i])}return r},WE.apply(this,arguments)}function Ent(r,e){return Pnt(r)||Cnt(r,e)||Ant(r,e)||Mnt()}function Mnt(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Ant(r,e){if(r){if(typeof r=="string")return q6(r,e);var n=Object.prototype.toString.call(r).slice(8,-1);if(n==="Object"&&r.constructor&&(n=r.constructor.name),n==="Map"||n==="Set")return Array.from(r);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return q6(r,e)}}function q6(r,e){(e==null||e>r.length)&&(e=r.length);for(var n=0,i=new Array(e);n<e;n++)i[n]=r[n];return i}function Cnt(r,e){var n=r==null?null:typeof Symbol<"u"&&r[Symbol.iterator]||r["@@iterator"];if(n!=null){var i,s,o,a,l=[],c=!0,u=!1;try{if(o=(n=n.call(r)).next,e!==0)for(;!(c=(i=o.call(n)).done)&&(l.push(i.value),l.length!==e);c=!0);}catch(h){u=!0,s=h}finally{try{if(!c&&n.return!=null&&(a=n.return(),Object(a)!==a))return}finally{if(u)throw s}}return l}}function Pnt(r){if(Array.isArray(r))return r}function X6(r,e){var n=Object.keys(r);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(r);e&&(i=i.filter(function(s){return Object.getOwnPropertyDescriptor(r,s).enumerable})),n.push.apply(n,i)}return n}function K6(r){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?X6(Object(n),!0).forEach(function(i){Rnt(r,i,n[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(n)):X6(Object(n)).forEach(function(i){Object.defineProperty(r,i,Object.getOwnPropertyDescriptor(n,i))})}return r}function Rnt(r,e,n){return e=Nnt(e),e in r?Object.defineProperty(r,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):r[e]=n,r}function Nnt(r){var e=Ont(r,"string");return kb(e)=="symbol"?e:e+""}function Ont(r,e){if(kb(r)!="object"||!r)return r;var n=r[Symbol.toPrimitive];if(n!==void 0){var i=n.call(r,e||"default");if(kb(i)!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(r)}var Y6=function(e,n,i,s,o){var a=Math.min(Math.abs(i)/2,Math.abs(s)/2),l=s>=0?1:-1,c=i>=0?1:-1,u=s>=0&&i>=0||s<0&&i<0?1:0,h;if(a>0&&o instanceof Array){for(var f=[0,0,0,0],d=0,p=4;d<p;d++)f[d]=o[d]>a?a:o[d];h="M".concat(e,",").concat(n+l*f[0]),f[0]>0&&(h+="A ".concat(f[0],",").concat(f[0],",0,0,").concat(u,",").concat(e+c*f[0],",").concat(n)),h+="L ".concat(e+i-c*f[1],",").concat(n),f[1]>0&&(h+="A ".concat(f[1],",").concat(f[1],",0,0,").concat(u,`,
        `).concat(e+i,",").concat(n+l*f[1])),h+="L ".concat(e+i,",").concat(n+s-l*f[2]),f[2]>0&&(h+="A ".concat(f[2],",").concat(f[2],",0,0,").concat(u,`,
        `).concat(e+i-c*f[2],",").concat(n+s)),h+="L ".concat(e+c*f[3],",").concat(n+s),f[3]>0&&(h+="A ".concat(f[3],",").concat(f[3],",0,0,").concat(u,`,
        `).concat(e,",").concat(n+s-l*f[3])),h+="Z"}else if(a>0&&o===+o&&o>0){var m=Math.min(a,o);h="M ".concat(e,",").concat(n+l*m,`
            A `).concat(m,",").concat(m,",0,0,").concat(u,",").concat(e+c*m,",").concat(n,`
            L `).concat(e+i-c*m,",").concat(n,`
            A `).concat(m,",").concat(m,",0,0,").concat(u,",").concat(e+i,",").concat(n+l*m,`
            L `).concat(e+i,",").concat(n+s-l*m,`
            A `).concat(m,",").concat(m,",0,0,").concat(u,",").concat(e+i-c*m,",").concat(n+s,`
            L `).concat(e+c*m,",").concat(n+s,`
            A `).concat(m,",").concat(m,",0,0,").concat(u,",").concat(e,",").concat(n+s-l*m," Z")}else h="M ".concat(e,",").concat(n," h ").concat(i," v ").concat(s," h ").concat(-i," Z");return h},Dnt=function(e,n){if(!e||!n)return!1;var i=e.x,s=e.y,o=n.x,a=n.y,l=n.width,c=n.height;if(Math.abs(l)>0&&Math.abs(c)>0){var u=Math.min(o,o+l),h=Math.max(o,o+l),f=Math.min(a,a+c),d=Math.max(a,a+c);return i>=u&&i<=h&&s>=f&&s<=d}return!1},knt={x:0,y:0,width:0,height:0,radius:0,isAnimationActive:!1,isUpdateAnimationActive:!1,animationBegin:0,animationDuration:1500,animationEasing:"ease"},jB=function(e){var n=K6(K6({},knt),e),i=te.useRef(),s=te.useState(-1),o=Ent(s,2),a=o[0],l=o[1];te.useEffect(function(){if(i.current&&i.current.getTotalLength)try{var w=i.current.getTotalLength();w&&l(w)}catch{}},[]);var c=n.x,u=n.y,h=n.width,f=n.height,d=n.radius,p=n.className,m=n.animationEasing,g=n.animationDuration,v=n.animationBegin,y=n.isAnimationActive,x=n.isUpdateAnimationActive;if(c!==+c||u!==+u||h!==+h||f!==+f||h===0||f===0)return null;var b=qt("recharts-rectangle",p);return x?Z.createElement(jl,{canBegin:a>0,from:{width:h,height:f,x:c,y:u},to:{width:h,height:f,x:c,y:u},duration:g,animationEasing:m,isActive:x},function(w){var _=w.width,S=w.height,T=w.x,E=w.y;return Z.createElement(jl,{canBegin:a>0,from:"0px ".concat(a===-1?1:a,"px"),to:"".concat(a,"px 0px"),attributeName:"strokeDasharray",begin:v,duration:g,isActive:y,easing:m},Z.createElement("path",WE({},Tt(n,!0),{className:b,d:Y6(T,E,_,S,d),ref:i})))}):Z.createElement("path",WE({},Tt(n,!0),{className:b,d:Y6(c,u,h,f,d)}))},Int=["points","className","baseLinePoints","connectNulls"];function gm(){return gm=Object.assign?Object.assign.bind():function(r){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(r[i]=n[i])}return r},gm.apply(this,arguments)}function Lnt(r,e){if(r==null)return{};var n=Fnt(r,e),i,s;if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(r);for(s=0;s<o.length;s++)i=o[s],!(e.indexOf(i)>=0)&&Object.prototype.propertyIsEnumerable.call(r,i)&&(n[i]=r[i])}return n}function Fnt(r,e){if(r==null)return{};var n={};for(var i in r)if(Object.prototype.hasOwnProperty.call(r,i)){if(e.indexOf(i)>=0)continue;n[i]=r[i]}return n}function Z6(r){return $nt(r)||znt(r)||Unt(r)||Bnt()}function Bnt(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Unt(r,e){if(r){if(typeof r=="string")return zk(r,e);var n=Object.prototype.toString.call(r).slice(8,-1);if(n==="Object"&&r.constructor&&(n=r.constructor.name),n==="Map"||n==="Set")return Array.from(r);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return zk(r,e)}}function znt(r){if(typeof Symbol<"u"&&r[Symbol.iterator]!=null||r["@@iterator"]!=null)return Array.from(r)}function $nt(r){if(Array.isArray(r))return zk(r)}function zk(r,e){(e==null||e>r.length)&&(e=r.length);for(var n=0,i=new Array(e);n<e;n++)i[n]=r[n];return i}var Q6=function(e){return e&&e.x===+e.x&&e.y===+e.y},jnt=function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],n=[[]];return e.forEach(function(i){Q6(i)?n[n.length-1].push(i):n[n.length-1].length>0&&n.push([])}),Q6(e[0])&&n[n.length-1].push(e[0]),n[n.length-1].length<=0&&(n=n.slice(0,-1)),n},Z0=function(e,n){var i=jnt(e);n&&(i=[i.reduce(function(o,a){return[].concat(Z6(o),Z6(a))},[])]);var s=i.map(function(o){return o.reduce(function(a,l,c){return"".concat(a).concat(c===0?"M":"L").concat(l.x,",").concat(l.y)},"")}).join("");return i.length===1?"".concat(s,"Z"):s},Vnt=function(e,n,i){var s=Z0(e,i);return"".concat(s.slice(-1)==="Z"?s.slice(0,-1):s,"L").concat(Z0(n.reverse(),i).slice(1))},Are=function(e){var n=e.points,i=e.className,s=e.baseLinePoints,o=e.connectNulls,a=Lnt(e,Int);if(!n||!n.length)return null;var l=qt("recharts-polygon",i);if(s&&s.length){var c=a.stroke&&a.stroke!=="none",u=Vnt(n,s,o);return Z.createElement("g",{className:l},Z.createElement("path",gm({},Tt(a,!0),{fill:u.slice(-1)==="Z"?a.fill:"none",stroke:"none",d:u})),c?Z.createElement("path",gm({},Tt(a,!0),{fill:"none",d:Z0(n,o)})):null,c?Z.createElement("path",gm({},Tt(a,!0),{fill:"none",d:Z0(s,o)})):null)}var h=Z0(n,o);return Z.createElement("path",gm({},Tt(a,!0),{fill:h.slice(-1)==="Z"?a.fill:"none",className:l,d:h}))};function $k(){return $k=Object.assign?Object.assign.bind():function(r){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(r[i]=n[i])}return r},$k.apply(this,arguments)}var U_=function(e){var n=e.cx,i=e.cy,s=e.r,o=e.className,a=qt("recharts-dot",o);return n===+n&&i===+i&&s===+s?Z.createElement("circle",$k({},Tt(e,!1),SE(e),{className:a,cx:n,cy:i,r:s})):null};function Ib(r){"@babel/helpers - typeof";return Ib=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Ib(r)}var Gnt=["x","y","top","left","width","height","className"];function jk(){return jk=Object.assign?Object.assign.bind():function(r){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(r[i]=n[i])}return r},jk.apply(this,arguments)}function J6(r,e){var n=Object.keys(r);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(r);e&&(i=i.filter(function(s){return Object.getOwnPropertyDescriptor(r,s).enumerable})),n.push.apply(n,i)}return n}function Hnt(r){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?J6(Object(n),!0).forEach(function(i){Wnt(r,i,n[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(n)):J6(Object(n)).forEach(function(i){Object.defineProperty(r,i,Object.getOwnPropertyDescriptor(n,i))})}return r}function Wnt(r,e,n){return e=qnt(e),e in r?Object.defineProperty(r,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):r[e]=n,r}function qnt(r){var e=Xnt(r,"string");return Ib(e)=="symbol"?e:e+""}function Xnt(r,e){if(Ib(r)!="object"||!r)return r;var n=r[Symbol.toPrimitive];if(n!==void 0){var i=n.call(r,e||"default");if(Ib(i)!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(r)}function Knt(r,e){if(r==null)return{};var n=Ynt(r,e),i,s;if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(r);for(s=0;s<o.length;s++)i=o[s],!(e.indexOf(i)>=0)&&Object.prototype.propertyIsEnumerable.call(r,i)&&(n[i]=r[i])}return n}function Ynt(r,e){if(r==null)return{};var n={};for(var i in r)if(Object.prototype.hasOwnProperty.call(r,i)){if(e.indexOf(i)>=0)continue;n[i]=r[i]}return n}var Znt=function(e,n,i,s,o,a){return"M".concat(e,",").concat(o,"v").concat(s,"M").concat(a,",").concat(n,"h").concat(i)},Qnt=function(e){var n=e.x,i=n===void 0?0:n,s=e.y,o=s===void 0?0:s,a=e.top,l=a===void 0?0:a,c=e.left,u=c===void 0?0:c,h=e.width,f=h===void 0?0:h,d=e.height,p=d===void 0?0:d,m=e.className,g=Knt(e,Gnt),v=Hnt({x:i,y:o,top:l,left:u,width:f,height:p},g);return!We(i)||!We(o)||!We(f)||!We(p)||!We(l)||!We(u)?null:Z.createElement("path",jk({},Tt(v,!0),{className:qt("recharts-cross",m),d:Znt(i,o,f,p,l,u)}))},Jnt=["cx","cy","innerRadius","outerRadius","gridType","radialLines"];function Lb(r){"@babel/helpers - typeof";return Lb=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Lb(r)}function ert(r,e){if(r==null)return{};var n=trt(r,e),i,s;if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(r);for(s=0;s<o.length;s++)i=o[s],!(e.indexOf(i)>=0)&&Object.prototype.propertyIsEnumerable.call(r,i)&&(n[i]=r[i])}return n}function trt(r,e){if(r==null)return{};var n={};for(var i in r)if(Object.prototype.hasOwnProperty.call(r,i)){if(e.indexOf(i)>=0)continue;n[i]=r[i]}return n}function du(){return du=Object.assign?Object.assign.bind():function(r){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(r[i]=n[i])}return r},du.apply(this,arguments)}function eW(r,e){var n=Object.keys(r);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(r);e&&(i=i.filter(function(s){return Object.getOwnPropertyDescriptor(r,s).enumerable})),n.push.apply(n,i)}return n}function Fb(r){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?eW(Object(n),!0).forEach(function(i){nrt(r,i,n[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(n)):eW(Object(n)).forEach(function(i){Object.defineProperty(r,i,Object.getOwnPropertyDescriptor(n,i))})}return r}function nrt(r,e,n){return e=rrt(e),e in r?Object.defineProperty(r,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):r[e]=n,r}function rrt(r){var e=irt(r,"string");return Lb(e)=="symbol"?e:e+""}function irt(r,e){if(Lb(r)!="object"||!r)return r;var n=r[Symbol.toPrimitive];if(n!==void 0){var i=n.call(r,e||"default");if(Lb(i)!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(r)}var srt=function(e,n,i,s){var o="";return s.forEach(function(a,l){var c=Nn(n,i,e,a);l?o+="L ".concat(c.x,",").concat(c.y):o+="M ".concat(c.x,",").concat(c.y)}),o+="Z",o},ort=function(e){var n=e.cx,i=e.cy,s=e.innerRadius,o=e.outerRadius,a=e.polarAngles,l=e.radialLines;if(!a||!a.length||!l)return null;var c=Fb({stroke:"#ccc"},Tt(e,!1));return Z.createElement("g",{className:"recharts-polar-grid-angle"},a.map(function(u){var h=Nn(n,i,s,u),f=Nn(n,i,o,u);return Z.createElement("line",du({},c,{key:"line-".concat(u),x1:h.x,y1:h.y,x2:f.x,y2:f.y}))}))},art=function(e){var n=e.cx,i=e.cy,s=e.radius,o=e.index,a=Fb(Fb({stroke:"#ccc"},Tt(e,!1)),{},{fill:"none"});return Z.createElement("circle",du({},a,{className:qt("recharts-polar-grid-concentric-circle",e.className),key:"circle-".concat(o),cx:n,cy:i,r:s}))},lrt=function(e){var n=e.radius,i=e.index,s=Fb(Fb({stroke:"#ccc"},Tt(e,!1)),{},{fill:"none"});return Z.createElement("path",du({},s,{className:qt("recharts-polar-grid-concentric-polygon",e.className),key:"path-".concat(i),d:srt(n,e.cx,e.cy,e.polarAngles)}))},crt=function(e){var n=e.polarRadius,i=e.gridType;return!n||!n.length?null:Z.createElement("g",{className:"recharts-polar-grid-concentric"},n.map(function(s,o){var a=o;return i==="circle"?Z.createElement(art,du({key:a},e,{radius:s,index:o})):Z.createElement(lrt,du({key:a},e,{radius:s,index:o}))}))},Cre=function(e){var n=e.cx,i=n===void 0?0:n,s=e.cy,o=s===void 0?0:s,a=e.innerRadius,l=a===void 0?0:a,c=e.outerRadius,u=c===void 0?0:c,h=e.gridType,f=h===void 0?"polygon":h,d=e.radialLines,p=d===void 0?!0:d,m=ert(e,Jnt);return u<=0?null:Z.createElement("g",{className:"recharts-polar-grid"},Z.createElement(ort,du({cx:i,cy:o,innerRadius:l,outerRadius:u,gridType:f,radialLines:p},m)),Z.createElement(crt,du({cx:i,cy:o,innerRadius:l,outerRadius:u,gridType:f,radialLines:p},m)))};Cre.displayName="PolarGrid";var urt=rC,hrt=$ne,frt=Xl;function drt(r,e){return r&&r.length?urt(r,frt(e),hrt):void 0}var prt=drt;const mrt=hn(prt);var grt=rC,yrt=Xl,vrt=jne;function xrt(r,e){return r&&r.length?grt(r,yrt(e),vrt):void 0}var brt=xrt;const _rt=hn(brt);var wrt=["cx","cy","angle","ticks","axisLine"],Srt=["ticks","tick","angle","tickFormatter","stroke"];function Ug(r){"@babel/helpers - typeof";return Ug=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Ug(r)}function Q0(){return Q0=Object.assign?Object.assign.bind():function(r){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(r[i]=n[i])}return r},Q0.apply(this,arguments)}function tW(r,e){var n=Object.keys(r);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(r);e&&(i=i.filter(function(s){return Object.getOwnPropertyDescriptor(r,s).enumerable})),n.push.apply(n,i)}return n}function vf(r){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?tW(Object(n),!0).forEach(function(i){lC(r,i,n[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(n)):tW(Object(n)).forEach(function(i){Object.defineProperty(r,i,Object.getOwnPropertyDescriptor(n,i))})}return r}function nW(r,e){if(r==null)return{};var n=Trt(r,e),i,s;if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(r);for(s=0;s<o.length;s++)i=o[s],!(e.indexOf(i)>=0)&&Object.prototype.propertyIsEnumerable.call(r,i)&&(n[i]=r[i])}return n}function Trt(r,e){if(r==null)return{};var n={};for(var i in r)if(Object.prototype.hasOwnProperty.call(r,i)){if(e.indexOf(i)>=0)continue;n[i]=r[i]}return n}function Ert(r,e){if(!(r instanceof e))throw new TypeError("Cannot call a class as a function")}function rW(r,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(r,Rre(i.key),i)}}function Mrt(r,e,n){return e&&rW(r.prototype,e),n&&rW(r,n),Object.defineProperty(r,"prototype",{writable:!1}),r}function Art(r,e,n){return e=qE(e),Crt(r,Pre()?Reflect.construct(e,n||[],qE(r).constructor):e.apply(r,n))}function Crt(r,e){if(e&&(Ug(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Prt(r)}function Prt(r){if(r===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return r}function Pre(){try{var r=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(Pre=function(){return!!r})()}function qE(r){return qE=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(n){return n.__proto__||Object.getPrototypeOf(n)},qE(r)}function Rrt(r,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");r.prototype=Object.create(e&&e.prototype,{constructor:{value:r,writable:!0,configurable:!0}}),Object.defineProperty(r,"prototype",{writable:!1}),e&&Vk(r,e)}function Vk(r,e){return Vk=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(i,s){return i.__proto__=s,i},Vk(r,e)}function lC(r,e,n){return e=Rre(e),e in r?Object.defineProperty(r,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):r[e]=n,r}function Rre(r){var e=Nrt(r,"string");return Ug(e)=="symbol"?e:e+""}function Nrt(r,e){if(Ug(r)!="object"||!r)return r;var n=r[Symbol.toPrimitive];if(n!==void 0){var i=n.call(r,e||"default");if(Ug(i)!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(r)}var z_=function(r){function e(){return Ert(this,e),Art(this,e,arguments)}return Rrt(e,r),Mrt(e,[{key:"getTickValueCoord",value:function(i){var s=i.coordinate,o=this.props,a=o.angle,l=o.cx,c=o.cy;return Nn(l,c,s,a)}},{key:"getTickTextAnchor",value:function(){var i=this.props.orientation,s;switch(i){case"left":s="end";break;case"right":s="start";break;default:s="middle";break}return s}},{key:"getViewBox",value:function(){var i=this.props,s=i.cx,o=i.cy,a=i.angle,l=i.ticks,c=mrt(l,function(h){return h.coordinate||0}),u=_rt(l,function(h){return h.coordinate||0});return{cx:s,cy:o,startAngle:a,endAngle:a,innerRadius:u.coordinate||0,outerRadius:c.coordinate||0}}},{key:"renderAxisLine",value:function(){var i=this.props,s=i.cx,o=i.cy,a=i.angle,l=i.ticks,c=i.axisLine,u=nW(i,wrt),h=l.reduce(function(m,g){return[Math.min(m[0],g.coordinate),Math.max(m[1],g.coordinate)]},[1/0,-1/0]),f=Nn(s,o,h[0],a),d=Nn(s,o,h[1],a),p=vf(vf(vf({},Tt(u,!1)),{},{fill:"none"},Tt(c,!1)),{},{x1:f.x,y1:f.y,x2:d.x,y2:d.y});return Z.createElement("line",Q0({className:"recharts-polar-radius-axis-line"},p))}},{key:"renderTicks",value:function(){var i=this,s=this.props,o=s.ticks,a=s.tick,l=s.angle,c=s.tickFormatter,u=s.stroke,h=nW(s,Srt),f=this.getTickTextAnchor(),d=Tt(h,!1),p=Tt(a,!1),m=o.map(function(g,v){var y=i.getTickValueCoord(g),x=vf(vf(vf(vf({textAnchor:f,transform:"rotate(".concat(90-l,", ").concat(y.x,", ").concat(y.y,")")},d),{},{stroke:"none",fill:u},p),{},{index:v},y),{},{payload:g});return Z.createElement(Sn,Q0({className:qt("recharts-polar-radius-axis-tick",mre(a)),key:"tick-".concat(g.coordinate)},Rg(i.props,g,v)),e.renderTickItem(a,x,c?c(g.value,v):g.value))});return Z.createElement(Sn,{className:"recharts-polar-radius-axis-ticks"},m)}},{key:"render",value:function(){var i=this.props,s=i.ticks,o=i.axisLine,a=i.tick;return!s||!s.length?null:Z.createElement(Sn,{className:qt("recharts-polar-radius-axis",this.props.className)},o&&this.renderAxisLine(),a&&this.renderTicks(),Bi.renderCallByParent(this.props,this.getViewBox()))}}],[{key:"renderTickItem",value:function(i,s,o){var a;return Z.isValidElement(i)?a=Z.cloneElement(i,s):Ut(i)?a=i(s):a=Z.createElement(Lg,Q0({},s,{className:"recharts-polar-radius-axis-tick-value"}),o),a}}])}(te.PureComponent);lC(z_,"displayName","PolarRadiusAxis");lC(z_,"axisType","radiusAxis");lC(z_,"defaultProps",{type:"number",radiusAxisId:0,cx:0,cy:0,angle:0,orientation:"right",stroke:"#ccc",axisLine:!0,tick:!0,tickCount:5,allowDataOverflow:!1,scale:"auto",allowDuplicatedCategory:!0});function zg(r){"@babel/helpers - typeof";return zg=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},zg(r)}function Bf(){return Bf=Object.assign?Object.assign.bind():function(r){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(r[i]=n[i])}return r},Bf.apply(this,arguments)}function iW(r,e){var n=Object.keys(r);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(r);e&&(i=i.filter(function(s){return Object.getOwnPropertyDescriptor(r,s).enumerable})),n.push.apply(n,i)}return n}function xf(r){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?iW(Object(n),!0).forEach(function(i){cC(r,i,n[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(n)):iW(Object(n)).forEach(function(i){Object.defineProperty(r,i,Object.getOwnPropertyDescriptor(n,i))})}return r}function Ort(r,e){if(!(r instanceof e))throw new TypeError("Cannot call a class as a function")}function sW(r,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(r,Ore(i.key),i)}}function Drt(r,e,n){return e&&sW(r.prototype,e),n&&sW(r,n),Object.defineProperty(r,"prototype",{writable:!1}),r}function krt(r,e,n){return e=XE(e),Irt(r,Nre()?Reflect.construct(e,n||[],XE(r).constructor):e.apply(r,n))}function Irt(r,e){if(e&&(zg(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Lrt(r)}function Lrt(r){if(r===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return r}function Nre(){try{var r=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(Nre=function(){return!!r})()}function XE(r){return XE=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(n){return n.__proto__||Object.getPrototypeOf(n)},XE(r)}function Frt(r,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");r.prototype=Object.create(e&&e.prototype,{constructor:{value:r,writable:!0,configurable:!0}}),Object.defineProperty(r,"prototype",{writable:!1}),e&&Gk(r,e)}function Gk(r,e){return Gk=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(i,s){return i.__proto__=s,i},Gk(r,e)}function cC(r,e,n){return e=Ore(e),e in r?Object.defineProperty(r,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):r[e]=n,r}function Ore(r){var e=Brt(r,"string");return zg(e)=="symbol"?e:e+""}function Brt(r,e){if(zg(r)!="object"||!r)return r;var n=r[Symbol.toPrimitive];if(n!==void 0){var i=n.call(r,e||"default");if(zg(i)!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(r)}var Urt=Math.PI/180,oW=1e-5,$_=function(r){function e(){return Ort(this,e),krt(this,e,arguments)}return Frt(e,r),Drt(e,[{key:"getTickLineCoord",value:function(i){var s=this.props,o=s.cx,a=s.cy,l=s.radius,c=s.orientation,u=s.tickSize,h=u||8,f=Nn(o,a,l,i.coordinate),d=Nn(o,a,l+(c==="inner"?-1:1)*h,i.coordinate);return{x1:f.x,y1:f.y,x2:d.x,y2:d.y}}},{key:"getTickTextAnchor",value:function(i){var s=this.props.orientation,o=Math.cos(-i.coordinate*Urt),a;return o>oW?a=s==="outer"?"start":"end":o<-oW?a=s==="outer"?"end":"start":a="middle",a}},{key:"renderAxisLine",value:function(){var i=this.props,s=i.cx,o=i.cy,a=i.radius,l=i.axisLine,c=i.axisLineType,u=xf(xf({},Tt(this.props,!1)),{},{fill:"none"},Tt(l,!1));if(c==="circle")return Z.createElement(U_,Bf({className:"recharts-polar-angle-axis-line"},u,{cx:s,cy:o,r:a}));var h=this.props.ticks,f=h.map(function(d){return Nn(s,o,a,d.coordinate)});return Z.createElement(Are,Bf({className:"recharts-polar-angle-axis-line"},u,{points:f}))}},{key:"renderTicks",value:function(){var i=this,s=this.props,o=s.ticks,a=s.tick,l=s.tickLine,c=s.tickFormatter,u=s.stroke,h=Tt(this.props,!1),f=Tt(a,!1),d=xf(xf({},h),{},{fill:"none"},Tt(l,!1)),p=o.map(function(m,g){var v=i.getTickLineCoord(m),y=i.getTickTextAnchor(m),x=xf(xf(xf({textAnchor:y},h),{},{stroke:"none",fill:u},f),{},{index:g,payload:m,x:v.x2,y:v.y2});return Z.createElement(Sn,Bf({className:qt("recharts-polar-angle-axis-tick",mre(a)),key:"tick-".concat(m.coordinate)},Rg(i.props,m,g)),l&&Z.createElement("line",Bf({className:"recharts-polar-angle-axis-tick-line"},d,v)),a&&e.renderTickItem(a,x,c?c(m.value,g):m.value))});return Z.createElement(Sn,{className:"recharts-polar-angle-axis-ticks"},p)}},{key:"render",value:function(){var i=this.props,s=i.ticks,o=i.radius,a=i.axisLine;return o<=0||!s||!s.length?null:Z.createElement(Sn,{className:qt("recharts-polar-angle-axis",this.props.className)},a&&this.renderAxisLine(),this.renderTicks())}}],[{key:"renderTickItem",value:function(i,s,o){var a;return Z.isValidElement(i)?a=Z.cloneElement(i,s):Ut(i)?a=i(s):a=Z.createElement(Lg,Bf({},s,{className:"recharts-polar-angle-axis-tick-value"}),o),a}}])}(te.PureComponent);cC($_,"displayName","PolarAngleAxis");cC($_,"axisType","angleAxis");cC($_,"defaultProps",{type:"category",angleAxisId:0,scale:"auto",cx:0,cy:0,orientation:"outer",axisLine:!0,tickLine:!0,tickSize:8,tick:!0,hide:!1,allowDuplicatedCategory:!0});var zrt=mne,$rt=zrt(Object.getPrototypeOf,Object),jrt=$rt,Vrt=_u,Grt=jrt,Hrt=wu,Wrt="[object Object]",qrt=Function.prototype,Xrt=Object.prototype,Dre=qrt.toString,Krt=Xrt.hasOwnProperty,Yrt=Dre.call(Object);function Zrt(r){if(!Hrt(r)||Vrt(r)!=Wrt)return!1;var e=Grt(r);if(e===null)return!0;var n=Krt.call(e,"constructor")&&e.constructor;return typeof n=="function"&&n instanceof n&&Dre.call(n)==Yrt}var Qrt=Zrt;const Jrt=hn(Qrt);var eit=_u,tit=wu,nit="[object Boolean]";function rit(r){return r===!0||r===!1||tit(r)&&eit(r)==nit}var iit=rit;const sit=hn(iit);function Bb(r){"@babel/helpers - typeof";return Bb=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Bb(r)}function KE(){return KE=Object.assign?Object.assign.bind():function(r){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(r[i]=n[i])}return r},KE.apply(this,arguments)}function oit(r,e){return uit(r)||cit(r,e)||lit(r,e)||ait()}function ait(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function lit(r,e){if(r){if(typeof r=="string")return aW(r,e);var n=Object.prototype.toString.call(r).slice(8,-1);if(n==="Object"&&r.constructor&&(n=r.constructor.name),n==="Map"||n==="Set")return Array.from(r);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return aW(r,e)}}function aW(r,e){(e==null||e>r.length)&&(e=r.length);for(var n=0,i=new Array(e);n<e;n++)i[n]=r[n];return i}function cit(r,e){var n=r==null?null:typeof Symbol<"u"&&r[Symbol.iterator]||r["@@iterator"];if(n!=null){var i,s,o,a,l=[],c=!0,u=!1;try{if(o=(n=n.call(r)).next,e!==0)for(;!(c=(i=o.call(n)).done)&&(l.push(i.value),l.length!==e);c=!0);}catch(h){u=!0,s=h}finally{try{if(!c&&n.return!=null&&(a=n.return(),Object(a)!==a))return}finally{if(u)throw s}}return l}}function uit(r){if(Array.isArray(r))return r}function lW(r,e){var n=Object.keys(r);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(r);e&&(i=i.filter(function(s){return Object.getOwnPropertyDescriptor(r,s).enumerable})),n.push.apply(n,i)}return n}function cW(r){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?lW(Object(n),!0).forEach(function(i){hit(r,i,n[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(n)):lW(Object(n)).forEach(function(i){Object.defineProperty(r,i,Object.getOwnPropertyDescriptor(n,i))})}return r}function hit(r,e,n){return e=fit(e),e in r?Object.defineProperty(r,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):r[e]=n,r}function fit(r){var e=dit(r,"string");return Bb(e)=="symbol"?e:e+""}function dit(r,e){if(Bb(r)!="object"||!r)return r;var n=r[Symbol.toPrimitive];if(n!==void 0){var i=n.call(r,e||"default");if(Bb(i)!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(r)}var uW=function(e,n,i,s,o){var a=i-s,l;return l="M ".concat(e,",").concat(n),l+="L ".concat(e+i,",").concat(n),l+="L ".concat(e+i-a/2,",").concat(n+o),l+="L ".concat(e+i-a/2-s,",").concat(n+o),l+="L ".concat(e,",").concat(n," Z"),l},pit={x:0,y:0,upperWidth:0,lowerWidth:0,height:0,isUpdateAnimationActive:!1,animationBegin:0,animationDuration:1500,animationEasing:"ease"},mit=function(e){var n=cW(cW({},pit),e),i=te.useRef(),s=te.useState(-1),o=oit(s,2),a=o[0],l=o[1];te.useEffect(function(){if(i.current&&i.current.getTotalLength)try{var b=i.current.getTotalLength();b&&l(b)}catch{}},[]);var c=n.x,u=n.y,h=n.upperWidth,f=n.lowerWidth,d=n.height,p=n.className,m=n.animationEasing,g=n.animationDuration,v=n.animationBegin,y=n.isUpdateAnimationActive;if(c!==+c||u!==+u||h!==+h||f!==+f||d!==+d||h===0&&f===0||d===0)return null;var x=qt("recharts-trapezoid",p);return y?Z.createElement(jl,{canBegin:a>0,from:{upperWidth:0,lowerWidth:0,height:d,x:c,y:u},to:{upperWidth:h,lowerWidth:f,height:d,x:c,y:u},duration:g,animationEasing:m,isActive:y},function(b){var w=b.upperWidth,_=b.lowerWidth,S=b.height,T=b.x,E=b.y;return Z.createElement(jl,{canBegin:a>0,from:"0px ".concat(a===-1?1:a,"px"),to:"".concat(a,"px 0px"),attributeName:"strokeDasharray",begin:v,duration:g,easing:m},Z.createElement("path",KE({},Tt(n,!0),{className:x,d:uW(T,E,w,_,S),ref:i})))}):Z.createElement("g",null,Z.createElement("path",KE({},Tt(n,!0),{className:x,d:uW(c,u,h,f,d)})))},git=["option","shapeType","propTransformer","activeClassName","isActive"];function Ub(r){"@babel/helpers - typeof";return Ub=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Ub(r)}function yit(r,e){if(r==null)return{};var n=vit(r,e),i,s;if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(r);for(s=0;s<o.length;s++)i=o[s],!(e.indexOf(i)>=0)&&Object.prototype.propertyIsEnumerable.call(r,i)&&(n[i]=r[i])}return n}function vit(r,e){if(r==null)return{};var n={};for(var i in r)if(Object.prototype.hasOwnProperty.call(r,i)){if(e.indexOf(i)>=0)continue;n[i]=r[i]}return n}function hW(r,e){var n=Object.keys(r);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(r);e&&(i=i.filter(function(s){return Object.getOwnPropertyDescriptor(r,s).enumerable})),n.push.apply(n,i)}return n}function YE(r){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?hW(Object(n),!0).forEach(function(i){xit(r,i,n[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(n)):hW(Object(n)).forEach(function(i){Object.defineProperty(r,i,Object.getOwnPropertyDescriptor(n,i))})}return r}function xit(r,e,n){return e=bit(e),e in r?Object.defineProperty(r,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):r[e]=n,r}function bit(r){var e=_it(r,"string");return Ub(e)=="symbol"?e:e+""}function _it(r,e){if(Ub(r)!="object"||!r)return r;var n=r[Symbol.toPrimitive];if(n!==void 0){var i=n.call(r,e||"default");if(Ub(i)!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(r)}function wit(r,e){return YE(YE({},e),r)}function Sit(r,e){return r==="symbols"}function fW(r){var e=r.shapeType,n=r.elementProps;switch(e){case"rectangle":return Z.createElement(jB,n);case"trapezoid":return Z.createElement(mit,n);case"sector":return Z.createElement(xre,n);case"symbols":if(Sit(e))return Z.createElement(PB,n);break;default:return null}}function Tit(r){return te.isValidElement(r)?r.props:r}function Eit(r){var e=r.option,n=r.shapeType,i=r.propTransformer,s=i===void 0?wit:i,o=r.activeClassName,a=o===void 0?"recharts-active-shape":o,l=r.isActive,c=yit(r,git),u;if(te.isValidElement(e))u=te.cloneElement(e,YE(YE({},c),Tit(e)));else if(Ut(e))u=e(c);else if(Jrt(e)&&!sit(e)){var h=s(e,c);u=Z.createElement(fW,{shapeType:n,elementProps:h})}else{var f=c;u=Z.createElement(fW,{shapeType:n,elementProps:f})}return l?Z.createElement(Sn,{className:a},u):u}function uC(r,e){return e!=null&&"trapezoids"in r.props}function hC(r,e){return e!=null&&"sectors"in r.props}function zb(r,e){return e!=null&&"points"in r.props}function Mit(r,e){var n,i,s=r.x===(e==null||(n=e.labelViewBox)===null||n===void 0?void 0:n.x)||r.x===e.x,o=r.y===(e==null||(i=e.labelViewBox)===null||i===void 0?void 0:i.y)||r.y===e.y;return s&&o}function Ait(r,e){var n=r.endAngle===e.endAngle,i=r.startAngle===e.startAngle;return n&&i}function Cit(r,e){var n=r.x===e.x,i=r.y===e.y,s=r.z===e.z;return n&&i&&s}function Pit(r,e){var n;return uC(r,e)?n=Mit:hC(r,e)?n=Ait:zb(r,e)&&(n=Cit),n}function Rit(r,e){var n;return uC(r,e)?n="trapezoids":hC(r,e)?n="sectors":zb(r,e)&&(n="points"),n}function Nit(r,e){if(uC(r,e)){var n;return(n=e.tooltipPayload)===null||n===void 0||(n=n[0])===null||n===void 0||(n=n.payload)===null||n===void 0?void 0:n.payload}if(hC(r,e)){var i;return(i=e.tooltipPayload)===null||i===void 0||(i=i[0])===null||i===void 0||(i=i.payload)===null||i===void 0?void 0:i.payload}return zb(r,e)?e.payload:{}}function Oit(r){var e=r.activeTooltipItem,n=r.graphicalItem,i=r.itemData,s=Rit(n,e),o=Nit(n,e),a=i.filter(function(c,u){var h=F_(o,c),f=n.props[s].filter(function(m){var g=Pit(n,e);return g(m,e)}),d=n.props[s].indexOf(f[f.length-1]),p=u===d;return h&&p}),l=i.indexOf(a[a.length-1]);return l}function Dit(r){return r&&r.length?r[0]:void 0}var kit=Dit,Iit=kit;const Lit=hn(Iit);var Fit=["key"];function $g(r){"@babel/helpers - typeof";return $g=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},$g(r)}function Bit(r,e){if(r==null)return{};var n=Uit(r,e),i,s;if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(r);for(s=0;s<o.length;s++)i=o[s],!(e.indexOf(i)>=0)&&Object.prototype.propertyIsEnumerable.call(r,i)&&(n[i]=r[i])}return n}function Uit(r,e){if(r==null)return{};var n={};for(var i in r)if(Object.prototype.hasOwnProperty.call(r,i)){if(e.indexOf(i)>=0)continue;n[i]=r[i]}return n}function ZE(){return ZE=Object.assign?Object.assign.bind():function(r){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(r[i]=n[i])}return r},ZE.apply(this,arguments)}function dW(r,e){var n=Object.keys(r);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(r);e&&(i=i.filter(function(s){return Object.getOwnPropertyDescriptor(r,s).enumerable})),n.push.apply(n,i)}return n}function vs(r){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?dW(Object(n),!0).forEach(function(i){Pc(r,i,n[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(n)):dW(Object(n)).forEach(function(i){Object.defineProperty(r,i,Object.getOwnPropertyDescriptor(n,i))})}return r}function zit(r,e){if(!(r instanceof e))throw new TypeError("Cannot call a class as a function")}function pW(r,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(r,Ire(i.key),i)}}function $it(r,e,n){return e&&pW(r.prototype,e),n&&pW(r,n),Object.defineProperty(r,"prototype",{writable:!1}),r}function jit(r,e,n){return e=QE(e),Vit(r,kre()?Reflect.construct(e,n||[],QE(r).constructor):e.apply(r,n))}function Vit(r,e){if(e&&($g(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Git(r)}function Git(r){if(r===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return r}function kre(){try{var r=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(kre=function(){return!!r})()}function QE(r){return QE=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(n){return n.__proto__||Object.getPrototypeOf(n)},QE(r)}function Hit(r,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");r.prototype=Object.create(e&&e.prototype,{constructor:{value:r,writable:!0,configurable:!0}}),Object.defineProperty(r,"prototype",{writable:!1}),e&&Hk(r,e)}function Hk(r,e){return Hk=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(i,s){return i.__proto__=s,i},Hk(r,e)}function Pc(r,e,n){return e=Ire(e),e in r?Object.defineProperty(r,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):r[e]=n,r}function Ire(r){var e=Wit(r,"string");return $g(e)=="symbol"?e:e+""}function Wit(r,e){if($g(r)!="object"||!r)return r;var n=r[Symbol.toPrimitive];if(n!==void 0){var i=n.call(r,e||"default");if($g(i)!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(r)}var j_=function(r){function e(){var n;zit(this,e);for(var i=arguments.length,s=new Array(i),o=0;o<i;o++)s[o]=arguments[o];return n=jit(this,e,[].concat(s)),Pc(n,"state",{isAnimationFinished:!1}),Pc(n,"handleAnimationEnd",function(){var a=n.props.onAnimationEnd;n.setState({isAnimationFinished:!0}),Ut(a)&&a()}),Pc(n,"handleAnimationStart",function(){var a=n.props.onAnimationStart;n.setState({isAnimationFinished:!1}),Ut(a)&&a()}),Pc(n,"handleMouseEnter",function(a){var l=n.props.onMouseEnter;l&&l(n.props,a)}),Pc(n,"handleMouseLeave",function(a){var l=n.props.onMouseLeave;l&&l(n.props,a)}),n}return Hit(e,r),$it(e,[{key:"renderDots",value:function(i){var s=this.props,o=s.dot,a=s.dataKey,l=Tt(this.props,!1),c=Tt(o,!0),u=i.map(function(h,f){var d=vs(vs(vs({key:"dot-".concat(f),r:3},l),c),{},{dataKey:a,cx:h.x,cy:h.y,index:f,payload:h});return e.renderDotItem(o,d)});return Z.createElement(Sn,{className:"recharts-radar-dots"},u)}},{key:"renderPolygonStatically",value:function(i){var s=this.props,o=s.shape,a=s.dot,l=s.isRange,c=s.baseLinePoints,u=s.connectNulls,h;return Z.isValidElement(o)?h=Z.cloneElement(o,vs(vs({},this.props),{},{points:i})):Ut(o)?h=o(vs(vs({},this.props),{},{points:i})):h=Z.createElement(Are,ZE({},Tt(this.props,!0),{onMouseEnter:this.handleMouseEnter,onMouseLeave:this.handleMouseLeave,points:i,baseLinePoints:l?c:null,connectNulls:u})),Z.createElement(Sn,{className:"recharts-radar-polygon"},h,a?this.renderDots(i):null)}},{key:"renderPolygonWithAnimation",value:function(){var i=this,s=this.props,o=s.points,a=s.isAnimationActive,l=s.animationBegin,c=s.animationDuration,u=s.animationEasing,h=s.animationId,f=this.state.prevPoints;return Z.createElement(jl,{begin:l,duration:c,isActive:a,easing:u,from:{t:0},to:{t:1},key:"radar-".concat(h),onAnimationEnd:this.handleAnimationEnd,onAnimationStart:this.handleAnimationStart},function(d){var p=d.t,m=f&&f.length/o.length,g=o.map(function(v,y){var x=f&&f[Math.floor(y*m)];if(x){var b=Ts(x.x,v.x),w=Ts(x.y,v.y);return vs(vs({},v),{},{x:b(p),y:w(p)})}var _=Ts(v.cx,v.x),S=Ts(v.cy,v.y);return vs(vs({},v),{},{x:_(p),y:S(p)})});return i.renderPolygonStatically(g)})}},{key:"renderPolygon",value:function(){var i=this.props,s=i.points,o=i.isAnimationActive,a=i.isRange,l=this.state.prevPoints;return o&&s&&s.length&&!a&&(!l||!F_(l,s))?this.renderPolygonWithAnimation():this.renderPolygonStatically(s)}},{key:"render",value:function(){var i=this.props,s=i.hide,o=i.className,a=i.points,l=i.isAnimationActive;if(s||!a||!a.length)return null;var c=this.state.isAnimationFinished,u=qt("recharts-radar",o);return Z.createElement(Sn,{className:u},this.renderPolygon(),(!l||c)&&eu.renderCallByParent(this.props,a))}}],[{key:"getDerivedStateFromProps",value:function(i,s){return i.animationId!==s.prevAnimationId?{prevAnimationId:i.animationId,curPoints:i.points,prevPoints:s.curPoints}:i.points!==s.curPoints?{curPoints:i.points}:null}},{key:"renderDotItem",value:function(i,s){var o;if(Z.isValidElement(i))o=Z.cloneElement(i,s);else if(Ut(i))o=i(s);else{var a=s.key,l=Bit(s,Fit);o=Z.createElement(U_,ZE({},l,{key:a,className:qt("recharts-radar-dot",typeof i!="boolean"?i.className:"")}))}return o}}])}(te.PureComponent);Pc(j_,"displayName","Radar");Pc(j_,"defaultProps",{angleAxisId:0,radiusAxisId:0,hide:!1,activeDot:!0,dot:!1,legendType:"rect",isAnimationActive:!Il.isSsr,animationBegin:0,animationDuration:1500,animationEasing:"ease"});Pc(j_,"getComposedData",function(r){var e=r.radiusAxis,n=r.angleAxis,i=r.displayedData,s=r.dataKey,o=r.bandSize,a=n.cx,l=n.cy,c=!1,u=[],h=n.type!=="number"?o??0:0;i.forEach(function(d,p){var m=Is(d,n.dataKey,p),g=Is(d,s),v=n.scale(m)+h,y=Array.isArray(g)?yre(g):g,x=nn(y)?void 0:e.scale(y);Array.isArray(g)&&g.length>=2&&(c=!0),u.push(vs(vs({},Nn(a,l,x,v)),{},{name:m,value:g,cx:a,cy:l,radius:x,angle:v,payload:d}))});var f=[];return c&&u.forEach(function(d){if(Array.isArray(d.value)){var p=Lit(d.value),m=nn(p)?void 0:e.scale(p);f.push(vs(vs({},d),{},{radius:m},Nn(a,l,m,d.angle)))}else f.push(d)}),{points:u,isRange:c,baseLinePoints:f}});var qit=Math.ceil,Xit=Math.max;function Kit(r,e,n,i){for(var s=-1,o=Xit(qit((e-r)/(n||1)),0),a=Array(o);o--;)a[i?o:++s]=r,r+=n;return a}var Yit=Kit,Zit=kne,mW=1/0,Qit=17976931348623157e292;function Jit(r){if(!r)return r===0?r:0;if(r=Zit(r),r===mW||r===-mW){var e=r<0?-1:1;return e*Qit}return r===r?r:0}var Lre=Jit,est=Yit,tst=nC,l2=Lre;function nst(r){return function(e,n,i){return i&&typeof i!="number"&&tst(e,n,i)&&(n=i=void 0),e=l2(e),n===void 0?(n=e,e=0):n=l2(n),i=i===void 0?e<n?1:-1:l2(i),est(e,n,i,r)}}var rst=nst,ist=rst,sst=ist(),ost=sst;const JE=hn(ost);function $b(r){"@babel/helpers - typeof";return $b=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},$b(r)}function gW(r,e){var n=Object.keys(r);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(r);e&&(i=i.filter(function(s){return Object.getOwnPropertyDescriptor(r,s).enumerable})),n.push.apply(n,i)}return n}function yW(r){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?gW(Object(n),!0).forEach(function(i){Fre(r,i,n[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(n)):gW(Object(n)).forEach(function(i){Object.defineProperty(r,i,Object.getOwnPropertyDescriptor(n,i))})}return r}function Fre(r,e,n){return e=ast(e),e in r?Object.defineProperty(r,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):r[e]=n,r}function ast(r){var e=lst(r,"string");return $b(e)=="symbol"?e:e+""}function lst(r,e){if($b(r)!="object"||!r)return r;var n=r[Symbol.toPrimitive];if(n!==void 0){var i=n.call(r,e||"default");if($b(i)!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(r)}var cst=["Webkit","Moz","O","ms"],ust=function(e,n){var i=e.replace(/(\w)/,function(o){return o.toUpperCase()}),s=cst.reduce(function(o,a){return yW(yW({},o),{},Fre({},a+i,n))},{});return s[e]=n,s};function jg(r){"@babel/helpers - typeof";return jg=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},jg(r)}function eM(){return eM=Object.assign?Object.assign.bind():function(r){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(r[i]=n[i])}return r},eM.apply(this,arguments)}function vW(r,e){var n=Object.keys(r);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(r);e&&(i=i.filter(function(s){return Object.getOwnPropertyDescriptor(r,s).enumerable})),n.push.apply(n,i)}return n}function c2(r){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?vW(Object(n),!0).forEach(function(i){xo(r,i,n[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(n)):vW(Object(n)).forEach(function(i){Object.defineProperty(r,i,Object.getOwnPropertyDescriptor(n,i))})}return r}function hst(r,e){if(!(r instanceof e))throw new TypeError("Cannot call a class as a function")}function xW(r,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(r,Ure(i.key),i)}}function fst(r,e,n){return e&&xW(r.prototype,e),n&&xW(r,n),Object.defineProperty(r,"prototype",{writable:!1}),r}function dst(r,e,n){return e=tM(e),pst(r,Bre()?Reflect.construct(e,n||[],tM(r).constructor):e.apply(r,n))}function pst(r,e){if(e&&(jg(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return mst(r)}function mst(r){if(r===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return r}function Bre(){try{var r=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(Bre=function(){return!!r})()}function tM(r){return tM=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(n){return n.__proto__||Object.getPrototypeOf(n)},tM(r)}function gst(r,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");r.prototype=Object.create(e&&e.prototype,{constructor:{value:r,writable:!0,configurable:!0}}),Object.defineProperty(r,"prototype",{writable:!1}),e&&Wk(r,e)}function Wk(r,e){return Wk=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(i,s){return i.__proto__=s,i},Wk(r,e)}function xo(r,e,n){return e=Ure(e),e in r?Object.defineProperty(r,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):r[e]=n,r}function Ure(r){var e=yst(r,"string");return jg(e)=="symbol"?e:e+""}function yst(r,e){if(jg(r)!="object"||!r)return r;var n=r[Symbol.toPrimitive];if(n!==void 0){var i=n.call(r,e||"default");if(jg(i)!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(r)}var vst=function(e){var n=e.data,i=e.startIndex,s=e.endIndex,o=e.x,a=e.width,l=e.travellerWidth;if(!n||!n.length)return{};var c=n.length,u=U0().domain(JE(0,c)).range([o,o+a-l]),h=u.domain().map(function(f){return u(f)});return{isTextActive:!1,isSlideMoving:!1,isTravellerMoving:!1,isTravellerFocused:!1,startX:u(i),endX:u(s),scale:u,scaleValues:h}},bW=function(e){return e.changedTouches&&!!e.changedTouches.length},Vg=function(r){function e(n){var i;return hst(this,e),i=dst(this,e,[n]),xo(i,"handleDrag",function(s){i.leaveTimer&&(clearTimeout(i.leaveTimer),i.leaveTimer=null),i.state.isTravellerMoving?i.handleTravellerMove(s):i.state.isSlideMoving&&i.handleSlideDrag(s)}),xo(i,"handleTouchMove",function(s){s.changedTouches!=null&&s.changedTouches.length>0&&i.handleDrag(s.changedTouches[0])}),xo(i,"handleDragEnd",function(){i.setState({isTravellerMoving:!1,isSlideMoving:!1},function(){var s=i.props,o=s.endIndex,a=s.onDragEnd,l=s.startIndex;a==null||a({endIndex:o,startIndex:l})}),i.detachDragEndListener()}),xo(i,"handleLeaveWrapper",function(){(i.state.isTravellerMoving||i.state.isSlideMoving)&&(i.leaveTimer=window.setTimeout(i.handleDragEnd,i.props.leaveTimeOut))}),xo(i,"handleEnterSlideOrTraveller",function(){i.setState({isTextActive:!0})}),xo(i,"handleLeaveSlideOrTraveller",function(){i.setState({isTextActive:!1})}),xo(i,"handleSlideDragStart",function(s){var o=bW(s)?s.changedTouches[0]:s;i.setState({isTravellerMoving:!1,isSlideMoving:!0,slideMoveStartX:o.pageX}),i.attachDragEndListener()}),i.travellerDragStartHandlers={startX:i.handleTravellerDragStart.bind(i,"startX"),endX:i.handleTravellerDragStart.bind(i,"endX")},i.state={},i}return gst(e,r),fst(e,[{key:"componentWillUnmount",value:function(){this.leaveTimer&&(clearTimeout(this.leaveTimer),this.leaveTimer=null),this.detachDragEndListener()}},{key:"getIndex",value:function(i){var s=i.startX,o=i.endX,a=this.state.scaleValues,l=this.props,c=l.gap,u=l.data,h=u.length-1,f=Math.min(s,o),d=Math.max(s,o),p=e.getIndexInRange(a,f),m=e.getIndexInRange(a,d);return{startIndex:p-p%c,endIndex:m===h?h:m-m%c}}},{key:"getTextOfTick",value:function(i){var s=this.props,o=s.data,a=s.tickFormatter,l=s.dataKey,c=Is(o[i],l,i);return Ut(a)?a(c,i):c}},{key:"attachDragEndListener",value:function(){window.addEventListener("mouseup",this.handleDragEnd,!0),window.addEventListener("touchend",this.handleDragEnd,!0),window.addEventListener("mousemove",this.handleDrag,!0)}},{key:"detachDragEndListener",value:function(){window.removeEventListener("mouseup",this.handleDragEnd,!0),window.removeEventListener("touchend",this.handleDragEnd,!0),window.removeEventListener("mousemove",this.handleDrag,!0)}},{key:"handleSlideDrag",value:function(i){var s=this.state,o=s.slideMoveStartX,a=s.startX,l=s.endX,c=this.props,u=c.x,h=c.width,f=c.travellerWidth,d=c.startIndex,p=c.endIndex,m=c.onChange,g=i.pageX-o;g>0?g=Math.min(g,u+h-f-l,u+h-f-a):g<0&&(g=Math.max(g,u-a,u-l));var v=this.getIndex({startX:a+g,endX:l+g});(v.startIndex!==d||v.endIndex!==p)&&m&&m(v),this.setState({startX:a+g,endX:l+g,slideMoveStartX:i.pageX})}},{key:"handleTravellerDragStart",value:function(i,s){var o=bW(s)?s.changedTouches[0]:s;this.setState({isSlideMoving:!1,isTravellerMoving:!0,movingTravellerId:i,brushMoveStartX:o.pageX}),this.attachDragEndListener()}},{key:"handleTravellerMove",value:function(i){var s=this.state,o=s.brushMoveStartX,a=s.movingTravellerId,l=s.endX,c=s.startX,u=this.state[a],h=this.props,f=h.x,d=h.width,p=h.travellerWidth,m=h.onChange,g=h.gap,v=h.data,y={startX:this.state.startX,endX:this.state.endX},x=i.pageX-o;x>0?x=Math.min(x,f+d-p-u):x<0&&(x=Math.max(x,f-u)),y[a]=u+x;var b=this.getIndex(y),w=b.startIndex,_=b.endIndex,S=function(){var E=v.length-1;return a==="startX"&&(l>c?w%g===0:_%g===0)||l<c&&_===E||a==="endX"&&(l>c?_%g===0:w%g===0)||l>c&&_===E};this.setState(xo(xo({},a,u+x),"brushMoveStartX",i.pageX),function(){m&&S()&&m(b)})}},{key:"handleTravellerMoveKeyboard",value:function(i,s){var o=this,a=this.state,l=a.scaleValues,c=a.startX,u=a.endX,h=this.state[s],f=l.indexOf(h);if(f!==-1){var d=f+i;if(!(d===-1||d>=l.length)){var p=l[d];s==="startX"&&p>=u||s==="endX"&&p<=c||this.setState(xo({},s,p),function(){o.props.onChange(o.getIndex({startX:o.state.startX,endX:o.state.endX}))})}}}},{key:"renderBackground",value:function(){var i=this.props,s=i.x,o=i.y,a=i.width,l=i.height,c=i.fill,u=i.stroke;return Z.createElement("rect",{stroke:u,fill:c,x:s,y:o,width:a,height:l})}},{key:"renderPanorama",value:function(){var i=this.props,s=i.x,o=i.y,a=i.width,l=i.height,c=i.data,u=i.children,h=i.padding,f=te.Children.only(u);return f?Z.cloneElement(f,{x:s,y:o,width:a,height:l,margin:h,compact:!0,data:c}):null}},{key:"renderTravellerLayer",value:function(i,s){var o,a,l=this,c=this.props,u=c.y,h=c.travellerWidth,f=c.height,d=c.traveller,p=c.ariaLabel,m=c.data,g=c.startIndex,v=c.endIndex,y=Math.max(i,this.props.x),x=c2(c2({},Tt(this.props,!1)),{},{x:y,y:u,width:h,height:f}),b=p||"Min value: ".concat((o=m[g])===null||o===void 0?void 0:o.name,", Max value: ").concat((a=m[v])===null||a===void 0?void 0:a.name);return Z.createElement(Sn,{tabIndex:0,role:"slider","aria-label":b,"aria-valuenow":i,className:"recharts-brush-traveller",onMouseEnter:this.handleEnterSlideOrTraveller,onMouseLeave:this.handleLeaveSlideOrTraveller,onMouseDown:this.travellerDragStartHandlers[s],onTouchStart:this.travellerDragStartHandlers[s],onKeyDown:function(_){["ArrowLeft","ArrowRight"].includes(_.key)&&(_.preventDefault(),_.stopPropagation(),l.handleTravellerMoveKeyboard(_.key==="ArrowRight"?1:-1,s))},onFocus:function(){l.setState({isTravellerFocused:!0})},onBlur:function(){l.setState({isTravellerFocused:!1})},style:{cursor:"col-resize"}},e.renderTraveller(d,x))}},{key:"renderSlide",value:function(i,s){var o=this.props,a=o.y,l=o.height,c=o.stroke,u=o.travellerWidth,h=Math.min(i,s)+u,f=Math.max(Math.abs(s-i)-u,0);return Z.createElement("rect",{className:"recharts-brush-slide",onMouseEnter:this.handleEnterSlideOrTraveller,onMouseLeave:this.handleLeaveSlideOrTraveller,onMouseDown:this.handleSlideDragStart,onTouchStart:this.handleSlideDragStart,style:{cursor:"move"},stroke:"none",fill:c,fillOpacity:.2,x:h,y:a,width:f,height:l})}},{key:"renderText",value:function(){var i=this.props,s=i.startIndex,o=i.endIndex,a=i.y,l=i.height,c=i.travellerWidth,u=i.stroke,h=this.state,f=h.startX,d=h.endX,p=5,m={pointerEvents:"none",fill:u};return Z.createElement(Sn,{className:"recharts-brush-texts"},Z.createElement(Lg,eM({textAnchor:"end",verticalAnchor:"middle",x:Math.min(f,d)-p,y:a+l/2},m),this.getTextOfTick(s)),Z.createElement(Lg,eM({textAnchor:"start",verticalAnchor:"middle",x:Math.max(f,d)+c+p,y:a+l/2},m),this.getTextOfTick(o)))}},{key:"render",value:function(){var i=this.props,s=i.data,o=i.className,a=i.children,l=i.x,c=i.y,u=i.width,h=i.height,f=i.alwaysShowText,d=this.state,p=d.startX,m=d.endX,g=d.isTextActive,v=d.isSlideMoving,y=d.isTravellerMoving,x=d.isTravellerFocused;if(!s||!s.length||!We(l)||!We(c)||!We(u)||!We(h)||u<=0||h<=0)return null;var b=qt("recharts-brush",o),w=Z.Children.count(a)===1,_=ust("userSelect","none");return Z.createElement(Sn,{className:b,onMouseLeave:this.handleLeaveWrapper,onTouchMove:this.handleTouchMove,style:_},this.renderBackground(),w&&this.renderPanorama(),this.renderSlide(p,m),this.renderTravellerLayer(p,"startX"),this.renderTravellerLayer(m,"endX"),(g||v||y||x||f)&&this.renderText())}}],[{key:"renderDefaultTraveller",value:function(i){var s=i.x,o=i.y,a=i.width,l=i.height,c=i.stroke,u=Math.floor(o+l/2)-1;return Z.createElement(Z.Fragment,null,Z.createElement("rect",{x:s,y:o,width:a,height:l,fill:c,stroke:"none"}),Z.createElement("line",{x1:s+1,y1:u,x2:s+a-1,y2:u,fill:"none",stroke:"#fff"}),Z.createElement("line",{x1:s+1,y1:u+2,x2:s+a-1,y2:u+2,fill:"none",stroke:"#fff"}))}},{key:"renderTraveller",value:function(i,s){var o;return Z.isValidElement(i)?o=Z.cloneElement(i,s):Ut(i)?o=i(s):o=e.renderDefaultTraveller(s),o}},{key:"getDerivedStateFromProps",value:function(i,s){var o=i.data,a=i.width,l=i.x,c=i.travellerWidth,u=i.updateId,h=i.startIndex,f=i.endIndex;if(o!==s.prevData||u!==s.prevUpdateId)return c2({prevData:o,prevTravellerWidth:c,prevUpdateId:u,prevX:l,prevWidth:a},o&&o.length?vst({data:o,width:a,x:l,travellerWidth:c,startIndex:h,endIndex:f}):{scale:null,scaleValues:null});if(s.scale&&(a!==s.prevWidth||l!==s.prevX||c!==s.prevTravellerWidth)){s.scale.range([l,l+a-c]);var d=s.scale.domain().map(function(p){return s.scale(p)});return{prevData:o,prevTravellerWidth:c,prevUpdateId:u,prevX:l,prevWidth:a,startX:s.scale(i.startIndex),endX:s.scale(i.endIndex),scaleValues:d}}return null}},{key:"getIndexInRange",value:function(i,s){for(var o=i.length,a=0,l=o-1;l-a>1;){var c=Math.floor((a+l)/2);i[c]>s?l=c:a=c}return s>=i[l]?l:a}}])}(te.PureComponent);xo(Vg,"displayName","Brush");xo(Vg,"defaultProps",{height:40,travellerWidth:5,gap:1,fill:"#fff",stroke:"#666",padding:{top:1,right:1,bottom:1,left:1},leaveTimeOut:1e3,alwaysShowText:!1});var xst=LB;function bst(r,e){var n;return xst(r,function(i,s,o){return n=e(i,s,o),!n}),!!n}var _st=bst,wst=ane,Sst=Xl,Tst=_st,Est=co,Mst=nC;function Ast(r,e,n){var i=Est(r)?wst:Tst;return n&&Mst(r,e,n)&&(e=void 0),i(r,Sst(e))}var Cst=Ast;const Pst=hn(Cst);var Ll=function(e,n){var i=e.alwaysShow,s=e.ifOverflow;return i&&(s="extendDomain"),s===n},_W=Pne;function Rst(r,e,n){e=="__proto__"&&_W?_W(r,e,{configurable:!0,enumerable:!0,value:n,writable:!0}):r[e]=n}var Nst=Rst,Ost=Nst,Dst=Ane,kst=Xl;function Ist(r,e){var n={};return e=kst(e),Dst(r,function(i,s,o){Ost(n,s,e(i,s,o))}),n}var Lst=Ist;const Fst=hn(Lst);function Bst(r,e){for(var n=-1,i=r==null?0:r.length;++n<i;)if(!e(r[n],n,r))return!1;return!0}var Ust=Bst,zst=LB;function $st(r,e){var n=!0;return zst(r,function(i,s,o){return n=!!e(i,s,o),n}),n}var jst=$st,Vst=Ust,Gst=jst,Hst=Xl,Wst=co,qst=nC;function Xst(r,e,n){var i=Wst(r)?Vst:Gst;return n&&qst(r,e,n)&&(e=void 0),i(r,Hst(e))}var Kst=Xst;const zre=hn(Kst);var Yst=["x","y"];function jb(r){"@babel/helpers - typeof";return jb=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},jb(r)}function qk(){return qk=Object.assign?Object.assign.bind():function(r){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(r[i]=n[i])}return r},qk.apply(this,arguments)}function wW(r,e){var n=Object.keys(r);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(r);e&&(i=i.filter(function(s){return Object.getOwnPropertyDescriptor(r,s).enumerable})),n.push.apply(n,i)}return n}function Kv(r){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?wW(Object(n),!0).forEach(function(i){Zst(r,i,n[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(n)):wW(Object(n)).forEach(function(i){Object.defineProperty(r,i,Object.getOwnPropertyDescriptor(n,i))})}return r}function Zst(r,e,n){return e=Qst(e),e in r?Object.defineProperty(r,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):r[e]=n,r}function Qst(r){var e=Jst(r,"string");return jb(e)=="symbol"?e:e+""}function Jst(r,e){if(jb(r)!="object"||!r)return r;var n=r[Symbol.toPrimitive];if(n!==void 0){var i=n.call(r,e||"default");if(jb(i)!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(r)}function eot(r,e){if(r==null)return{};var n=tot(r,e),i,s;if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(r);for(s=0;s<o.length;s++)i=o[s],!(e.indexOf(i)>=0)&&Object.prototype.propertyIsEnumerable.call(r,i)&&(n[i]=r[i])}return n}function tot(r,e){if(r==null)return{};var n={};for(var i in r)if(Object.prototype.hasOwnProperty.call(r,i)){if(e.indexOf(i)>=0)continue;n[i]=r[i]}return n}function not(r,e){var n=r.x,i=r.y,s=eot(r,Yst),o="".concat(n),a=parseInt(o,10),l="".concat(i),c=parseInt(l,10),u="".concat(e.height||s.height),h=parseInt(u,10),f="".concat(e.width||s.width),d=parseInt(f,10);return Kv(Kv(Kv(Kv(Kv({},e),s),a?{x:a}:{}),c?{y:c}:{}),{},{height:h,width:d,name:e.name,radius:e.radius})}function SW(r){return Z.createElement(Eit,qk({shapeType:"rectangle",propTransformer:not,activeClassName:"recharts-active-bar"},r))}var rot=function(e){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;return function(i,s){if(typeof e=="number")return e;var o=typeof i=="number";return o?e(i,s):(o||Ed(),n)}},iot=["value","background"],$re;function Gg(r){"@babel/helpers - typeof";return Gg=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Gg(r)}function sot(r,e){if(r==null)return{};var n=oot(r,e),i,s;if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(r);for(s=0;s<o.length;s++)i=o[s],!(e.indexOf(i)>=0)&&Object.prototype.propertyIsEnumerable.call(r,i)&&(n[i]=r[i])}return n}function oot(r,e){if(r==null)return{};var n={};for(var i in r)if(Object.prototype.hasOwnProperty.call(r,i)){if(e.indexOf(i)>=0)continue;n[i]=r[i]}return n}function nM(){return nM=Object.assign?Object.assign.bind():function(r){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(r[i]=n[i])}return r},nM.apply(this,arguments)}function TW(r,e){var n=Object.keys(r);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(r);e&&(i=i.filter(function(s){return Object.getOwnPropertyDescriptor(r,s).enumerable})),n.push.apply(n,i)}return n}function Ur(r){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?TW(Object(n),!0).forEach(function(i){ah(r,i,n[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(n)):TW(Object(n)).forEach(function(i){Object.defineProperty(r,i,Object.getOwnPropertyDescriptor(n,i))})}return r}function aot(r,e){if(!(r instanceof e))throw new TypeError("Cannot call a class as a function")}function EW(r,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(r,Vre(i.key),i)}}function lot(r,e,n){return e&&EW(r.prototype,e),n&&EW(r,n),Object.defineProperty(r,"prototype",{writable:!1}),r}function cot(r,e,n){return e=rM(e),uot(r,jre()?Reflect.construct(e,n||[],rM(r).constructor):e.apply(r,n))}function uot(r,e){if(e&&(Gg(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return hot(r)}function hot(r){if(r===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return r}function jre(){try{var r=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(jre=function(){return!!r})()}function rM(r){return rM=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(n){return n.__proto__||Object.getPrototypeOf(n)},rM(r)}function fot(r,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");r.prototype=Object.create(e&&e.prototype,{constructor:{value:r,writable:!0,configurable:!0}}),Object.defineProperty(r,"prototype",{writable:!1}),e&&Xk(r,e)}function Xk(r,e){return Xk=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(i,s){return i.__proto__=s,i},Xk(r,e)}function ah(r,e,n){return e=Vre(e),e in r?Object.defineProperty(r,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):r[e]=n,r}function Vre(r){var e=dot(r,"string");return Gg(e)=="symbol"?e:e+""}function dot(r,e){if(Gg(r)!="object"||!r)return r;var n=r[Symbol.toPrimitive];if(n!==void 0){var i=n.call(r,e||"default");if(Gg(i)!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(r)}var kh=function(r){function e(){var n;aot(this,e);for(var i=arguments.length,s=new Array(i),o=0;o<i;o++)s[o]=arguments[o];return n=cot(this,e,[].concat(s)),ah(n,"state",{isAnimationFinished:!1}),ah(n,"id",I_("recharts-bar-")),ah(n,"handleAnimationEnd",function(){var a=n.props.onAnimationEnd;n.setState({isAnimationFinished:!0}),a&&a()}),ah(n,"handleAnimationStart",function(){var a=n.props.onAnimationStart;n.setState({isAnimationFinished:!1}),a&&a()}),n}return fot(e,r),lot(e,[{key:"renderRectanglesStatically",value:function(i){var s=this,o=this.props,a=o.shape,l=o.dataKey,c=o.activeIndex,u=o.activeBar,h=Tt(this.props,!1);return i&&i.map(function(f,d){var p=d===c,m=p?u:a,g=Ur(Ur(Ur({},h),f),{},{isActive:p,option:m,index:d,dataKey:l,onAnimationStart:s.handleAnimationStart,onAnimationEnd:s.handleAnimationEnd});return Z.createElement(Sn,nM({className:"recharts-bar-rectangle"},Rg(s.props,f,d),{key:"rectangle-".concat(f==null?void 0:f.x,"-").concat(f==null?void 0:f.y,"-").concat(f==null?void 0:f.value,"-").concat(d)}),Z.createElement(SW,g))})}},{key:"renderRectanglesWithAnimation",value:function(){var i=this,s=this.props,o=s.data,a=s.layout,l=s.isAnimationActive,c=s.animationBegin,u=s.animationDuration,h=s.animationEasing,f=s.animationId,d=this.state.prevData;return Z.createElement(jl,{begin:c,duration:u,isActive:l,easing:h,from:{t:0},to:{t:1},key:"bar-".concat(f),onAnimationEnd:this.handleAnimationEnd,onAnimationStart:this.handleAnimationStart},function(p){var m=p.t,g=o.map(function(v,y){var x=d&&d[y];if(x){var b=Ts(x.x,v.x),w=Ts(x.y,v.y),_=Ts(x.width,v.width),S=Ts(x.height,v.height);return Ur(Ur({},v),{},{x:b(m),y:w(m),width:_(m),height:S(m)})}if(a==="horizontal"){var T=Ts(0,v.height),E=T(m);return Ur(Ur({},v),{},{y:v.y+v.height-E,height:E})}var M=Ts(0,v.width),A=M(m);return Ur(Ur({},v),{},{width:A})});return Z.createElement(Sn,null,i.renderRectanglesStatically(g))})}},{key:"renderRectangles",value:function(){var i=this.props,s=i.data,o=i.isAnimationActive,a=this.state.prevData;return o&&s&&s.length&&(!a||!F_(a,s))?this.renderRectanglesWithAnimation():this.renderRectanglesStatically(s)}},{key:"renderBackground",value:function(){var i=this,s=this.props,o=s.data,a=s.dataKey,l=s.activeIndex,c=Tt(this.props.background,!1);return o.map(function(u,h){u.value;var f=u.background,d=sot(u,iot);if(!f)return null;var p=Ur(Ur(Ur(Ur(Ur({},d),{},{fill:"#eee"},f),c),Rg(i.props,u,h)),{},{onAnimationStart:i.handleAnimationStart,onAnimationEnd:i.handleAnimationEnd,dataKey:a,index:h,className:"recharts-bar-background-rectangle"});return Z.createElement(SW,nM({key:"background-bar-".concat(h),option:i.props.background,isActive:h===l},p))})}},{key:"renderErrorBar",value:function(i,s){if(this.props.isAnimationActive&&!this.state.isAnimationFinished)return null;var o=this.props,a=o.data,l=o.xAxis,c=o.yAxis,u=o.layout,h=o.children,f=ua(h,B_);if(!f)return null;var d=u==="vertical"?a[0].height/2:a[0].width/2,p=function(v,y){var x=Array.isArray(v.value)?v.value[1]:v.value;return{x:v.x,y:v.y,value:x,errorVal:Is(v,y)}},m={clipPath:i?"url(#clipPath-".concat(s,")"):null};return Z.createElement(Sn,m,f.map(function(g){return Z.cloneElement(g,{key:"error-bar-".concat(s,"-").concat(g.props.dataKey),data:a,xAxis:l,yAxis:c,layout:u,offset:d,dataPointFormatter:p})}))}},{key:"render",value:function(){var i=this.props,s=i.hide,o=i.data,a=i.className,l=i.xAxis,c=i.yAxis,u=i.left,h=i.top,f=i.width,d=i.height,p=i.isAnimationActive,m=i.background,g=i.id;if(s||!o||!o.length)return null;var v=this.state.isAnimationFinished,y=qt("recharts-bar",a),x=l&&l.allowDataOverflow,b=c&&c.allowDataOverflow,w=x||b,_=nn(g)?this.id:g;return Z.createElement(Sn,{className:y},x||b?Z.createElement("defs",null,Z.createElement("clipPath",{id:"clipPath-".concat(_)},Z.createElement("rect",{x:x?u:u-f/2,y:b?h:h-d/2,width:x?f:f*2,height:b?d:d*2}))):null,Z.createElement(Sn,{className:"recharts-bar-rectangles",clipPath:w?"url(#clipPath-".concat(_,")"):null},m?this.renderBackground():null,this.renderRectangles()),this.renderErrorBar(w,_),(!p||v)&&eu.renderCallByParent(this.props,o))}}],[{key:"getDerivedStateFromProps",value:function(i,s){return i.animationId!==s.prevAnimationId?{prevAnimationId:i.animationId,curData:i.data,prevData:s.curData}:i.data!==s.curData?{curData:i.data}:null}}])}(te.PureComponent);$re=kh;ah(kh,"displayName","Bar");ah(kh,"defaultProps",{xAxisId:0,yAxisId:0,legendType:"rect",minPointSize:0,hide:!1,data:[],layout:"vertical",activeBar:!1,isAnimationActive:!Il.isSsr,animationBegin:0,animationDuration:400,animationEasing:"ease"});ah(kh,"getComposedData",function(r){var e=r.props,n=r.item,i=r.barPosition,s=r.bandSize,o=r.xAxis,a=r.yAxis,l=r.xAxisTicks,c=r.yAxisTicks,u=r.stackedData,h=r.dataStartIndex,f=r.displayedData,d=r.offset,p=OJe(i,n);if(!p)return null;var m=e.layout,g=n.type.defaultProps,v=g!==void 0?Ur(Ur({},g),n.props):n.props,y=v.dataKey,x=v.children,b=v.minPointSize,w=m==="horizontal"?a:o,_=u?w.scale.domain():null,S=UJe({numericAxis:w}),T=ua(x,Lne),E=f.map(function(M,A){var P,D,B,C,O,R;u?P=DJe(u[h+A],_):(P=Is(M,y),Array.isArray(P)||(P=[S,P]));var z=rot(b,$re.defaultProps.minPointSize)(P[1],A);if(m==="horizontal"){var U,G=[a.scale(P[0]),a.scale(P[1])],H=G[0],Y=G[1];D=d6({axis:o,ticks:l,bandSize:s,offset:p.offset,entry:M,index:A}),B=(U=Y??H)!==null&&U!==void 0?U:void 0,C=p.size;var ee=H-Y;if(O=Number.isNaN(ee)?0:ee,R={x:D,y:a.y,width:C,height:a.height},Math.abs(z)>0&&Math.abs(O)<Math.abs(z)){var he=Ka(O||z)*(Math.abs(z)-Math.abs(O));B-=he,O+=he}}else{var q=[o.scale(P[0]),o.scale(P[1])],J=q[0],se=q[1];if(D=J,B=d6({axis:a,ticks:c,bandSize:s,offset:p.offset,entry:M,index:A}),C=se-J,O=p.size,R={x:o.x,y:B,width:o.width,height:O},Math.abs(z)>0&&Math.abs(C)<Math.abs(z)){var oe=Ka(C||z)*(Math.abs(z)-Math.abs(C));C+=oe}}return Ur(Ur(Ur({},M),{},{x:D,y:B,width:C,height:O,value:u?P:P[1],payload:M,background:R},T&&T[A]&&T[A].props),{},{tooltipPayload:[dre(n,M)],tooltipPosition:{x:D+C/2,y:B+O/2}})});return Ur({data:E,layout:m},d)});function Vb(r){"@babel/helpers - typeof";return Vb=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Vb(r)}function pot(r,e){if(!(r instanceof e))throw new TypeError("Cannot call a class as a function")}function MW(r,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(r,Gre(i.key),i)}}function mot(r,e,n){return e&&MW(r.prototype,e),n&&MW(r,n),Object.defineProperty(r,"prototype",{writable:!1}),r}function AW(r,e){var n=Object.keys(r);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(r);e&&(i=i.filter(function(s){return Object.getOwnPropertyDescriptor(r,s).enumerable})),n.push.apply(n,i)}return n}function Ba(r){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?AW(Object(n),!0).forEach(function(i){fC(r,i,n[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(n)):AW(Object(n)).forEach(function(i){Object.defineProperty(r,i,Object.getOwnPropertyDescriptor(n,i))})}return r}function fC(r,e,n){return e=Gre(e),e in r?Object.defineProperty(r,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):r[e]=n,r}function Gre(r){var e=got(r,"string");return Vb(e)=="symbol"?e:e+""}function got(r,e){if(Vb(r)!="object"||!r)return r;var n=r[Symbol.toPrimitive];if(n!==void 0){var i=n.call(r,e||"default");if(Vb(i)!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(r)}var Hre=function(e,n,i,s,o){var a=e.width,l=e.height,c=e.layout,u=e.children,h=Object.keys(n),f={left:i.left,leftMirror:i.left,right:a-i.right,rightMirror:a-i.right,top:i.top,topMirror:i.top,bottom:l-i.bottom,bottomMirror:l-i.bottom},d=!!So(u,kh);return h.reduce(function(p,m){var g=n[m],v=g.orientation,y=g.domain,x=g.padding,b=x===void 0?{}:x,w=g.mirror,_=g.reversed,S="".concat(v).concat(w?"Mirror":""),T,E,M,A,P;if(g.type==="number"&&(g.padding==="gap"||g.padding==="no-gap")){var D=y[1]-y[0],B=1/0,C=g.categoricalDomain.sort(V5e);if(C.forEach(function(q,J){J>0&&(B=Math.min((q||0)-(C[J-1]||0),B))}),Number.isFinite(B)){var O=B/D,R=g.layout==="vertical"?i.height:i.width;if(g.padding==="gap"&&(T=O*R/2),g.padding==="no-gap"){var z=Ya(e.barCategoryGap,O*R),U=O*R/2;T=U-z-(U-z)/R*z}}}s==="xAxis"?E=[i.left+(b.left||0)+(T||0),i.left+i.width-(b.right||0)-(T||0)]:s==="yAxis"?E=c==="horizontal"?[i.top+i.height-(b.bottom||0),i.top+(b.top||0)]:[i.top+(b.top||0)+(T||0),i.top+i.height-(b.bottom||0)-(T||0)]:E=g.range,_&&(E=[E[1],E[0]]);var G=cre(g,o,d),H=G.scale,Y=G.realScaleType;H.domain(y).range(E),ure(H);var ee=hre(H,Ba(Ba({},g),{},{realScaleType:Y}));s==="xAxis"?(P=v==="top"&&!w||v==="bottom"&&w,M=i.left,A=f[S]-P*g.height):s==="yAxis"&&(P=v==="left"&&!w||v==="right"&&w,M=f[S]-P*g.width,A=i.top);var he=Ba(Ba(Ba({},g),ee),{},{realScaleType:Y,x:M,y:A,scale:H,width:s==="xAxis"?i.width:g.width,height:s==="yAxis"?i.height:g.height});return he.bandSize=zE(he,ee),!g.hide&&s==="xAxis"?f[S]+=(P?-1:1)*he.height:g.hide||(f[S]+=(P?-1:1)*he.width),Ba(Ba({},p),{},fC({},m,he))},{})},Wre=function(e,n){var i=e.x,s=e.y,o=n.x,a=n.y;return{x:Math.min(i,o),y:Math.min(s,a),width:Math.abs(o-i),height:Math.abs(a-s)}},yot=function(e){var n=e.x1,i=e.y1,s=e.x2,o=e.y2;return Wre({x:n,y:i},{x:s,y:o})},qre=function(){function r(e){pot(this,r),this.scale=e}return mot(r,[{key:"domain",get:function(){return this.scale.domain}},{key:"range",get:function(){return this.scale.range}},{key:"rangeMin",get:function(){return this.range()[0]}},{key:"rangeMax",get:function(){return this.range()[1]}},{key:"bandwidth",get:function(){return this.scale.bandwidth}},{key:"apply",value:function(n){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},s=i.bandAware,o=i.position;if(n!==void 0){if(o)switch(o){case"start":return this.scale(n);case"middle":{var a=this.bandwidth?this.bandwidth()/2:0;return this.scale(n)+a}case"end":{var l=this.bandwidth?this.bandwidth():0;return this.scale(n)+l}default:return this.scale(n)}if(s){var c=this.bandwidth?this.bandwidth()/2:0;return this.scale(n)+c}return this.scale(n)}}},{key:"isInRange",value:function(n){var i=this.range(),s=i[0],o=i[i.length-1];return s<=o?n>=s&&n<=o:n>=o&&n<=s}}],[{key:"create",value:function(n){return new r(n)}}])}();fC(qre,"EPS",1e-4);var VB=function(e){var n=Object.keys(e).reduce(function(i,s){return Ba(Ba({},i),{},fC({},s,qre.create(e[s])))},{});return Ba(Ba({},n),{},{apply:function(s){var o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},a=o.bandAware,l=o.position;return Fst(s,function(c,u){return n[u].apply(c,{bandAware:a,position:l})})},isInRange:function(s){return zre(s,function(o,a){return n[a].isInRange(o)})}})};function vot(r){return(r%180+180)%180}var xot=function(e){var n=e.width,i=e.height,s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,o=vot(s),a=o*Math.PI/180,l=Math.atan(i/n),c=a>l&&a<Math.PI-l?i/Math.sin(a):n/Math.cos(a);return Math.abs(c)},bot=Xl,_ot=L_,wot=eC;function Sot(r){return function(e,n,i){var s=Object(e);if(!_ot(e)){var o=bot(n);e=wot(e),n=function(l){return o(s[l],l,s)}}var a=r(e,n,i);return a>-1?s[o?e[a]:a]:void 0}}var Tot=Sot,Eot=Lre;function Mot(r){var e=Eot(r),n=e%1;return e===e?n?e-n:e:0}var Aot=Mot,Cot=_ne,Pot=Xl,Rot=Aot,Not=Math.max;function Oot(r,e,n){var i=r==null?0:r.length;if(!i)return-1;var s=n==null?0:Rot(n);return s<0&&(s=Not(i+s,0)),Cot(r,Pot(e),s)}var Dot=Oot,kot=Tot,Iot=Dot,Lot=kot(Iot),Fot=Lot;const Bot=hn(Fot);var Uot=HGe(function(r){return{x:r.left,y:r.top,width:r.width,height:r.height}},function(r){return["l",r.left,"t",r.top,"w",r.width,"h",r.height].join("")}),GB=te.createContext(void 0),HB=te.createContext(void 0),Xre=te.createContext(void 0),Kre=te.createContext({}),Yre=te.createContext(void 0),Zre=te.createContext(0),Qre=te.createContext(0),CW=function(e){var n=e.state,i=n.xAxisMap,s=n.yAxisMap,o=n.offset,a=e.clipPathId,l=e.children,c=e.width,u=e.height,h=Uot(o);return Z.createElement(GB.Provider,{value:i},Z.createElement(HB.Provider,{value:s},Z.createElement(Kre.Provider,{value:o},Z.createElement(Xre.Provider,{value:h},Z.createElement(Yre.Provider,{value:a},Z.createElement(Zre.Provider,{value:u},Z.createElement(Qre.Provider,{value:c},l)))))))},zot=function(){return te.useContext(Yre)},Jre=function(e){var n=te.useContext(GB);n==null&&Ed();var i=n[e];return i==null&&Ed(),i},$ot=function(){var e=te.useContext(GB);return nh(e)},jot=function(){var e=te.useContext(HB),n=Bot(e,function(i){return zre(i.domain,Number.isFinite)});return n||nh(e)},eie=function(e){var n=te.useContext(HB);n==null&&Ed();var i=n[e];return i==null&&Ed(),i},Vot=function(){var e=te.useContext(Xre);return e},Got=function(){return te.useContext(Kre)},WB=function(){return te.useContext(Qre)},qB=function(){return te.useContext(Zre)};function Hg(r){"@babel/helpers - typeof";return Hg=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Hg(r)}function Hot(r,e){if(!(r instanceof e))throw new TypeError("Cannot call a class as a function")}function Wot(r,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(r,nie(i.key),i)}}function qot(r,e,n){return e&&Wot(r.prototype,e),Object.defineProperty(r,"prototype",{writable:!1}),r}function Xot(r,e,n){return e=iM(e),Kot(r,tie()?Reflect.construct(e,n||[],iM(r).constructor):e.apply(r,n))}function Kot(r,e){if(e&&(Hg(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Yot(r)}function Yot(r){if(r===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return r}function tie(){try{var r=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(tie=function(){return!!r})()}function iM(r){return iM=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(n){return n.__proto__||Object.getPrototypeOf(n)},iM(r)}function Zot(r,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");r.prototype=Object.create(e&&e.prototype,{constructor:{value:r,writable:!0,configurable:!0}}),Object.defineProperty(r,"prototype",{writable:!1}),e&&Kk(r,e)}function Kk(r,e){return Kk=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(i,s){return i.__proto__=s,i},Kk(r,e)}function PW(r,e){var n=Object.keys(r);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(r);e&&(i=i.filter(function(s){return Object.getOwnPropertyDescriptor(r,s).enumerable})),n.push.apply(n,i)}return n}function RW(r){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?PW(Object(n),!0).forEach(function(i){XB(r,i,n[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(n)):PW(Object(n)).forEach(function(i){Object.defineProperty(r,i,Object.getOwnPropertyDescriptor(n,i))})}return r}function XB(r,e,n){return e=nie(e),e in r?Object.defineProperty(r,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):r[e]=n,r}function nie(r){var e=Qot(r,"string");return Hg(e)=="symbol"?e:e+""}function Qot(r,e){if(Hg(r)!="object"||!r)return r;var n=r[Symbol.toPrimitive];if(n!==void 0){var i=n.call(r,e||"default");if(Hg(i)!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(r)}function Jot(r,e){return rat(r)||nat(r,e)||tat(r,e)||eat()}function eat(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function tat(r,e){if(r){if(typeof r=="string")return NW(r,e);var n=Object.prototype.toString.call(r).slice(8,-1);if(n==="Object"&&r.constructor&&(n=r.constructor.name),n==="Map"||n==="Set")return Array.from(r);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return NW(r,e)}}function NW(r,e){(e==null||e>r.length)&&(e=r.length);for(var n=0,i=new Array(e);n<e;n++)i[n]=r[n];return i}function nat(r,e){var n=r==null?null:typeof Symbol<"u"&&r[Symbol.iterator]||r["@@iterator"];if(n!=null){var i,s,o,a,l=[],c=!0,u=!1;try{if(o=(n=n.call(r)).next,e!==0)for(;!(c=(i=o.call(n)).done)&&(l.push(i.value),l.length!==e);c=!0);}catch(h){u=!0,s=h}finally{try{if(!c&&n.return!=null&&(a=n.return(),Object(a)!==a))return}finally{if(u)throw s}}return l}}function rat(r){if(Array.isArray(r))return r}function Yk(){return Yk=Object.assign?Object.assign.bind():function(r){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(r[i]=n[i])}return r},Yk.apply(this,arguments)}var iat=function(e,n){var i;return Z.isValidElement(e)?i=Z.cloneElement(e,n):Ut(e)?i=e(n):i=Z.createElement("line",Yk({},n,{className:"recharts-reference-line-line"})),i},sat=function(e,n,i,s,o,a,l,c,u){var h=o.x,f=o.y,d=o.width,p=o.height;if(i){var m=u.y,g=e.y.apply(m,{position:a});if(Ll(u,"discard")&&!e.y.isInRange(g))return null;var v=[{x:h+d,y:g},{x:h,y:g}];return c==="left"?v.reverse():v}if(n){var y=u.x,x=e.x.apply(y,{position:a});if(Ll(u,"discard")&&!e.x.isInRange(x))return null;var b=[{x,y:f+p},{x,y:f}];return l==="top"?b.reverse():b}if(s){var w=u.segment,_=w.map(function(S){return e.apply(S,{position:a})});return Ll(u,"discard")&&Pst(_,function(S){return!e.isInRange(S)})?null:_}return null};function oat(r){var e=r.x,n=r.y,i=r.segment,s=r.xAxisId,o=r.yAxisId,a=r.shape,l=r.className,c=r.alwaysShow,u=zot(),h=Jre(s),f=eie(o),d=Vot();if(!u||!d)return null;Zc(c===void 0,'The alwaysShow prop is deprecated. Please use ifOverflow="extendDomain" instead.');var p=VB({x:h.scale,y:f.scale}),m=ci(e),g=ci(n),v=i&&i.length===2,y=sat(p,m,g,v,d,r.position,h.orientation,f.orientation,r);if(!y)return null;var x=Jot(y,2),b=x[0],w=b.x,_=b.y,S=x[1],T=S.x,E=S.y,M=Ll(r,"hidden")?"url(#".concat(u,")"):void 0,A=RW(RW({clipPath:M},Tt(r,!0)),{},{x1:w,y1:_,x2:T,y2:E});return Z.createElement(Sn,{className:qt("recharts-reference-line",l)},iat(a,A),Bi.renderCallByParent(r,yot({x1:w,y1:_,x2:T,y2:E})))}var KB=function(r){function e(){return Hot(this,e),Xot(this,e,arguments)}return Zot(e,r),qot(e,[{key:"render",value:function(){return Z.createElement(oat,this.props)}}])}(Z.Component);XB(KB,"displayName","ReferenceLine");XB(KB,"defaultProps",{isFront:!1,ifOverflow:"discard",xAxisId:0,yAxisId:0,fill:"none",stroke:"#ccc",fillOpacity:1,strokeWidth:1,position:"middle"});function Zk(){return Zk=Object.assign?Object.assign.bind():function(r){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(r[i]=n[i])}return r},Zk.apply(this,arguments)}function Wg(r){"@babel/helpers - typeof";return Wg=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Wg(r)}function OW(r,e){var n=Object.keys(r);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(r);e&&(i=i.filter(function(s){return Object.getOwnPropertyDescriptor(r,s).enumerable})),n.push.apply(n,i)}return n}function DW(r){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?OW(Object(n),!0).forEach(function(i){dC(r,i,n[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(n)):OW(Object(n)).forEach(function(i){Object.defineProperty(r,i,Object.getOwnPropertyDescriptor(n,i))})}return r}function aat(r,e){if(!(r instanceof e))throw new TypeError("Cannot call a class as a function")}function lat(r,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(r,iie(i.key),i)}}function cat(r,e,n){return e&&lat(r.prototype,e),Object.defineProperty(r,"prototype",{writable:!1}),r}function uat(r,e,n){return e=sM(e),hat(r,rie()?Reflect.construct(e,n||[],sM(r).constructor):e.apply(r,n))}function hat(r,e){if(e&&(Wg(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return fat(r)}function fat(r){if(r===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return r}function rie(){try{var r=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(rie=function(){return!!r})()}function sM(r){return sM=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(n){return n.__proto__||Object.getPrototypeOf(n)},sM(r)}function dat(r,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");r.prototype=Object.create(e&&e.prototype,{constructor:{value:r,writable:!0,configurable:!0}}),Object.defineProperty(r,"prototype",{writable:!1}),e&&Qk(r,e)}function Qk(r,e){return Qk=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(i,s){return i.__proto__=s,i},Qk(r,e)}function dC(r,e,n){return e=iie(e),e in r?Object.defineProperty(r,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):r[e]=n,r}function iie(r){var e=pat(r,"string");return Wg(e)=="symbol"?e:e+""}function pat(r,e){if(Wg(r)!="object"||!r)return r;var n=r[Symbol.toPrimitive];if(n!==void 0){var i=n.call(r,e||"default");if(Wg(i)!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(r)}var mat=function(e){var n=e.x,i=e.y,s=e.xAxis,o=e.yAxis,a=VB({x:s.scale,y:o.scale}),l=a.apply({x:n,y:i},{bandAware:!0});return Ll(e,"discard")&&!a.isInRange(l)?null:l},pC=function(r){function e(){return aat(this,e),uat(this,e,arguments)}return dat(e,r),cat(e,[{key:"render",value:function(){var i=this.props,s=i.x,o=i.y,a=i.r,l=i.alwaysShow,c=i.clipPathId,u=ci(s),h=ci(o);if(Zc(l===void 0,'The alwaysShow prop is deprecated. Please use ifOverflow="extendDomain" instead.'),!u||!h)return null;var f=mat(this.props);if(!f)return null;var d=f.x,p=f.y,m=this.props,g=m.shape,v=m.className,y=Ll(this.props,"hidden")?"url(#".concat(c,")"):void 0,x=DW(DW({clipPath:y},Tt(this.props,!0)),{},{cx:d,cy:p});return Z.createElement(Sn,{className:qt("recharts-reference-dot",v)},e.renderDot(g,x),Bi.renderCallByParent(this.props,{x:d-a,y:p-a,width:2*a,height:2*a}))}}])}(Z.Component);dC(pC,"displayName","ReferenceDot");dC(pC,"defaultProps",{isFront:!1,ifOverflow:"discard",xAxisId:0,yAxisId:0,r:10,fill:"#fff",stroke:"#ccc",fillOpacity:1,strokeWidth:1});dC(pC,"renderDot",function(r,e){var n;return Z.isValidElement(r)?n=Z.cloneElement(r,e):Ut(r)?n=r(e):n=Z.createElement(U_,Zk({},e,{cx:e.cx,cy:e.cy,className:"recharts-reference-dot-dot"})),n});function Jk(){return Jk=Object.assign?Object.assign.bind():function(r){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(r[i]=n[i])}return r},Jk.apply(this,arguments)}function qg(r){"@babel/helpers - typeof";return qg=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},qg(r)}function kW(r,e){var n=Object.keys(r);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(r);e&&(i=i.filter(function(s){return Object.getOwnPropertyDescriptor(r,s).enumerable})),n.push.apply(n,i)}return n}function IW(r){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?kW(Object(n),!0).forEach(function(i){mC(r,i,n[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(n)):kW(Object(n)).forEach(function(i){Object.defineProperty(r,i,Object.getOwnPropertyDescriptor(n,i))})}return r}function gat(r,e){if(!(r instanceof e))throw new TypeError("Cannot call a class as a function")}function yat(r,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(r,oie(i.key),i)}}function vat(r,e,n){return e&&yat(r.prototype,e),Object.defineProperty(r,"prototype",{writable:!1}),r}function xat(r,e,n){return e=oM(e),bat(r,sie()?Reflect.construct(e,n||[],oM(r).constructor):e.apply(r,n))}function bat(r,e){if(e&&(qg(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return _at(r)}function _at(r){if(r===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return r}function sie(){try{var r=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(sie=function(){return!!r})()}function oM(r){return oM=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(n){return n.__proto__||Object.getPrototypeOf(n)},oM(r)}function wat(r,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");r.prototype=Object.create(e&&e.prototype,{constructor:{value:r,writable:!0,configurable:!0}}),Object.defineProperty(r,"prototype",{writable:!1}),e&&eI(r,e)}function eI(r,e){return eI=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(i,s){return i.__proto__=s,i},eI(r,e)}function mC(r,e,n){return e=oie(e),e in r?Object.defineProperty(r,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):r[e]=n,r}function oie(r){var e=Sat(r,"string");return qg(e)=="symbol"?e:e+""}function Sat(r,e){if(qg(r)!="object"||!r)return r;var n=r[Symbol.toPrimitive];if(n!==void 0){var i=n.call(r,e||"default");if(qg(i)!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(r)}var Tat=function(e,n,i,s,o){var a=o.x1,l=o.x2,c=o.y1,u=o.y2,h=o.xAxis,f=o.yAxis;if(!h||!f)return null;var d=VB({x:h.scale,y:f.scale}),p={x:e?d.x.apply(a,{position:"start"}):d.x.rangeMin,y:i?d.y.apply(c,{position:"start"}):d.y.rangeMin},m={x:n?d.x.apply(l,{position:"end"}):d.x.rangeMax,y:s?d.y.apply(u,{position:"end"}):d.y.rangeMax};return Ll(o,"discard")&&(!d.isInRange(p)||!d.isInRange(m))?null:Wre(p,m)},gC=function(r){function e(){return gat(this,e),xat(this,e,arguments)}return wat(e,r),vat(e,[{key:"render",value:function(){var i=this.props,s=i.x1,o=i.x2,a=i.y1,l=i.y2,c=i.className,u=i.alwaysShow,h=i.clipPathId;Zc(u===void 0,'The alwaysShow prop is deprecated. Please use ifOverflow="extendDomain" instead.');var f=ci(s),d=ci(o),p=ci(a),m=ci(l),g=this.props.shape;if(!f&&!d&&!p&&!m&&!g)return null;var v=Tat(f,d,p,m,this.props);if(!v&&!g)return null;var y=Ll(this.props,"hidden")?"url(#".concat(h,")"):void 0;return Z.createElement(Sn,{className:qt("recharts-reference-area",c)},e.renderRect(g,IW(IW({clipPath:y},Tt(this.props,!0)),v)),Bi.renderCallByParent(this.props,v))}}])}(Z.Component);mC(gC,"displayName","ReferenceArea");mC(gC,"defaultProps",{isFront:!1,ifOverflow:"discard",xAxisId:0,yAxisId:0,r:10,fill:"#ccc",fillOpacity:.5,stroke:"none",strokeWidth:1});mC(gC,"renderRect",function(r,e){var n;return Z.isValidElement(r)?n=Z.cloneElement(r,e):Ut(r)?n=r(e):n=Z.createElement(jB,Jk({},e,{className:"recharts-reference-area-rect"})),n});function aie(r,e,n){if(e<1)return[];if(e===1&&n===void 0)return r;for(var i=[],s=0;s<r.length;s+=e)i.push(r[s]);return i}function Eat(r,e,n){var i={width:r.width+e.width,height:r.height+e.height};return xot(i,n)}function Mat(r,e,n){var i=n==="width",s=r.x,o=r.y,a=r.width,l=r.height;return e===1?{start:i?s:o,end:i?s+a:o+l}:{start:i?s+a:o+l,end:i?s:o}}function aM(r,e,n,i,s){if(r*e<r*i||r*e>r*s)return!1;var o=n();return r*(e-r*o/2-i)>=0&&r*(e+r*o/2-s)<=0}function Aat(r,e){return aie(r,e+1)}function Cat(r,e,n,i,s){for(var o=(i||[]).slice(),a=e.start,l=e.end,c=0,u=1,h=a,f=function(){var m=i==null?void 0:i[c];if(m===void 0)return{v:aie(i,u)};var g=c,v,y=function(){return v===void 0&&(v=n(m,g)),v},x=m.coordinate,b=c===0||aM(r,x,y,h,l);b||(c=0,h=a,u+=1),b&&(h=x+r*(y()/2+s),c+=u)},d;u<=o.length;)if(d=f(),d)return d.v;return[]}function Gb(r){"@babel/helpers - typeof";return Gb=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Gb(r)}function LW(r,e){var n=Object.keys(r);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(r);e&&(i=i.filter(function(s){return Object.getOwnPropertyDescriptor(r,s).enumerable})),n.push.apply(n,i)}return n}function ts(r){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?LW(Object(n),!0).forEach(function(i){Pat(r,i,n[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(n)):LW(Object(n)).forEach(function(i){Object.defineProperty(r,i,Object.getOwnPropertyDescriptor(n,i))})}return r}function Pat(r,e,n){return e=Rat(e),e in r?Object.defineProperty(r,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):r[e]=n,r}function Rat(r){var e=Nat(r,"string");return Gb(e)=="symbol"?e:e+""}function Nat(r,e){if(Gb(r)!="object"||!r)return r;var n=r[Symbol.toPrimitive];if(n!==void 0){var i=n.call(r,e||"default");if(Gb(i)!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(r)}function Oat(r,e,n,i,s){for(var o=(i||[]).slice(),a=o.length,l=e.start,c=e.end,u=function(d){var p=o[d],m,g=function(){return m===void 0&&(m=n(p,d)),m};if(d===a-1){var v=r*(p.coordinate+r*g()/2-c);o[d]=p=ts(ts({},p),{},{tickCoord:v>0?p.coordinate-v*r:p.coordinate})}else o[d]=p=ts(ts({},p),{},{tickCoord:p.coordinate});var y=aM(r,p.tickCoord,g,l,c);y&&(c=p.tickCoord-r*(g()/2+s),o[d]=ts(ts({},p),{},{isShow:!0}))},h=a-1;h>=0;h--)u(h);return o}function Dat(r,e,n,i,s,o){var a=(i||[]).slice(),l=a.length,c=e.start,u=e.end;if(o){var h=i[l-1],f=n(h,l-1),d=r*(h.coordinate+r*f/2-u);a[l-1]=h=ts(ts({},h),{},{tickCoord:d>0?h.coordinate-d*r:h.coordinate});var p=aM(r,h.tickCoord,function(){return f},c,u);p&&(u=h.tickCoord-r*(f/2+s),a[l-1]=ts(ts({},h),{},{isShow:!0}))}for(var m=o?l-1:l,g=function(x){var b=a[x],w,_=function(){return w===void 0&&(w=n(b,x)),w};if(x===0){var S=r*(b.coordinate-r*_()/2-c);a[x]=b=ts(ts({},b),{},{tickCoord:S<0?b.coordinate-S*r:b.coordinate})}else a[x]=b=ts(ts({},b),{},{tickCoord:b.coordinate});var T=aM(r,b.tickCoord,_,c,u);T&&(c=b.tickCoord+r*(_()/2+s),a[x]=ts(ts({},b),{},{isShow:!0}))},v=0;v<m;v++)g(v);return a}function YB(r,e,n){var i=r.tick,s=r.ticks,o=r.viewBox,a=r.minTickGap,l=r.orientation,c=r.interval,u=r.tickFormatter,h=r.unit,f=r.angle;if(!s||!s.length||!i)return[];if(We(c)||Il.isSsr)return Aat(s,typeof c=="number"&&We(c)?c:0);var d=[],p=l==="top"||l==="bottom"?"width":"height",m=h&&p==="width"?X0(h,{fontSize:e,letterSpacing:n}):{width:0,height:0},g=function(b,w){var _=Ut(u)?u(b.value,w):b.value;return p==="width"?Eat(X0(_,{fontSize:e,letterSpacing:n}),m,f):X0(_,{fontSize:e,letterSpacing:n})[p]},v=s.length>=2?Ka(s[1].coordinate-s[0].coordinate):1,y=Mat(o,v,p);return c==="equidistantPreserveStart"?Cat(v,y,g,s,a):(c==="preserveStart"||c==="preserveStartEnd"?d=Dat(v,y,g,s,a,c==="preserveStartEnd"):d=Oat(v,y,g,s,a),d.filter(function(x){return x.isShow}))}var kat=["viewBox"],Iat=["viewBox"],Lat=["ticks"];function Xg(r){"@babel/helpers - typeof";return Xg=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Xg(r)}function ym(){return ym=Object.assign?Object.assign.bind():function(r){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(r[i]=n[i])}return r},ym.apply(this,arguments)}function FW(r,e){var n=Object.keys(r);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(r);e&&(i=i.filter(function(s){return Object.getOwnPropertyDescriptor(r,s).enumerable})),n.push.apply(n,i)}return n}function fs(r){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?FW(Object(n),!0).forEach(function(i){ZB(r,i,n[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(n)):FW(Object(n)).forEach(function(i){Object.defineProperty(r,i,Object.getOwnPropertyDescriptor(n,i))})}return r}function u2(r,e){if(r==null)return{};var n=Fat(r,e),i,s;if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(r);for(s=0;s<o.length;s++)i=o[s],!(e.indexOf(i)>=0)&&Object.prototype.propertyIsEnumerable.call(r,i)&&(n[i]=r[i])}return n}function Fat(r,e){if(r==null)return{};var n={};for(var i in r)if(Object.prototype.hasOwnProperty.call(r,i)){if(e.indexOf(i)>=0)continue;n[i]=r[i]}return n}function Bat(r,e){if(!(r instanceof e))throw new TypeError("Cannot call a class as a function")}function BW(r,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(r,cie(i.key),i)}}function Uat(r,e,n){return e&&BW(r.prototype,e),n&&BW(r,n),Object.defineProperty(r,"prototype",{writable:!1}),r}function zat(r,e,n){return e=lM(e),$at(r,lie()?Reflect.construct(e,n||[],lM(r).constructor):e.apply(r,n))}function $at(r,e){if(e&&(Xg(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return jat(r)}function jat(r){if(r===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return r}function lie(){try{var r=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(lie=function(){return!!r})()}function lM(r){return lM=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(n){return n.__proto__||Object.getPrototypeOf(n)},lM(r)}function Vat(r,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");r.prototype=Object.create(e&&e.prototype,{constructor:{value:r,writable:!0,configurable:!0}}),Object.defineProperty(r,"prototype",{writable:!1}),e&&tI(r,e)}function tI(r,e){return tI=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(i,s){return i.__proto__=s,i},tI(r,e)}function ZB(r,e,n){return e=cie(e),e in r?Object.defineProperty(r,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):r[e]=n,r}function cie(r){var e=Gat(r,"string");return Xg(e)=="symbol"?e:e+""}function Gat(r,e){if(Xg(r)!="object"||!r)return r;var n=r[Symbol.toPrimitive];if(n!==void 0){var i=n.call(r,e||"default");if(Xg(i)!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(r)}var Ly=function(r){function e(n){var i;return Bat(this,e),i=zat(this,e,[n]),i.state={fontSize:"",letterSpacing:""},i}return Vat(e,r),Uat(e,[{key:"shouldComponentUpdate",value:function(i,s){var o=i.viewBox,a=u2(i,kat),l=this.props,c=l.viewBox,u=u2(l,Iat);return!zm(o,c)||!zm(a,u)||!zm(s,this.state)}},{key:"componentDidMount",value:function(){var i=this.layerReference;if(i){var s=i.getElementsByClassName("recharts-cartesian-axis-tick-value")[0];s&&this.setState({fontSize:window.getComputedStyle(s).fontSize,letterSpacing:window.getComputedStyle(s).letterSpacing})}}},{key:"getTickLineCoord",value:function(i){var s=this.props,o=s.x,a=s.y,l=s.width,c=s.height,u=s.orientation,h=s.tickSize,f=s.mirror,d=s.tickMargin,p,m,g,v,y,x,b=f?-1:1,w=i.tickSize||h,_=We(i.tickCoord)?i.tickCoord:i.coordinate;switch(u){case"top":p=m=i.coordinate,v=a+ +!f*c,g=v-b*w,x=g-b*d,y=_;break;case"left":g=v=i.coordinate,m=o+ +!f*l,p=m-b*w,y=p-b*d,x=_;break;case"right":g=v=i.coordinate,m=o+ +f*l,p=m+b*w,y=p+b*d,x=_;break;default:p=m=i.coordinate,v=a+ +f*c,g=v+b*w,x=g+b*d,y=_;break}return{line:{x1:p,y1:g,x2:m,y2:v},tick:{x:y,y:x}}}},{key:"getTickTextAnchor",value:function(){var i=this.props,s=i.orientation,o=i.mirror,a;switch(s){case"left":a=o?"start":"end";break;case"right":a=o?"end":"start";break;default:a="middle";break}return a}},{key:"getTickVerticalAnchor",value:function(){var i=this.props,s=i.orientation,o=i.mirror,a="end";switch(s){case"left":case"right":a="middle";break;case"top":a=o?"start":"end";break;default:a=o?"end":"start";break}return a}},{key:"renderAxisLine",value:function(){var i=this.props,s=i.x,o=i.y,a=i.width,l=i.height,c=i.orientation,u=i.mirror,h=i.axisLine,f=fs(fs(fs({},Tt(this.props,!1)),Tt(h,!1)),{},{fill:"none"});if(c==="top"||c==="bottom"){var d=+(c==="top"&&!u||c==="bottom"&&u);f=fs(fs({},f),{},{x1:s,y1:o+d*l,x2:s+a,y2:o+d*l})}else{var p=+(c==="left"&&!u||c==="right"&&u);f=fs(fs({},f),{},{x1:s+p*a,y1:o,x2:s+p*a,y2:o+l})}return Z.createElement("line",ym({},f,{className:qt("recharts-cartesian-axis-line",ca(h,"className"))}))}},{key:"renderTicks",value:function(i,s,o){var a=this,l=this.props,c=l.tickLine,u=l.stroke,h=l.tick,f=l.tickFormatter,d=l.unit,p=YB(fs(fs({},this.props),{},{ticks:i}),s,o),m=this.getTickTextAnchor(),g=this.getTickVerticalAnchor(),v=Tt(this.props,!1),y=Tt(h,!1),x=fs(fs({},v),{},{fill:"none"},Tt(c,!1)),b=p.map(function(w,_){var S=a.getTickLineCoord(w),T=S.line,E=S.tick,M=fs(fs(fs(fs({textAnchor:m,verticalAnchor:g},v),{},{stroke:"none",fill:u},y),E),{},{index:_,payload:w,visibleTicksCount:p.length,tickFormatter:f});return Z.createElement(Sn,ym({className:"recharts-cartesian-axis-tick",key:"tick-".concat(w.value,"-").concat(w.coordinate,"-").concat(w.tickCoord)},Rg(a.props,w,_)),c&&Z.createElement("line",ym({},x,T,{className:qt("recharts-cartesian-axis-tick-line",ca(c,"className"))})),h&&e.renderTickItem(h,M,"".concat(Ut(f)?f(w.value,_):w.value).concat(d||"")))});return Z.createElement("g",{className:"recharts-cartesian-axis-ticks"},b)}},{key:"render",value:function(){var i=this,s=this.props,o=s.axisLine,a=s.width,l=s.height,c=s.ticksGenerator,u=s.className,h=s.hide;if(h)return null;var f=this.props,d=f.ticks,p=u2(f,Lat),m=d;return Ut(c)&&(m=d&&d.length>0?c(this.props):c(p)),a<=0||l<=0||!m||!m.length?null:Z.createElement(Sn,{className:qt("recharts-cartesian-axis",u),ref:function(v){i.layerReference=v}},o&&this.renderAxisLine(),this.renderTicks(m,this.state.fontSize,this.state.letterSpacing),Bi.renderCallByParent(this.props))}}],[{key:"renderTickItem",value:function(i,s,o){var a;return Z.isValidElement(i)?a=Z.cloneElement(i,s):Ut(i)?a=i(s):a=Z.createElement(Lg,ym({},s,{className:"recharts-cartesian-axis-tick-value"}),o),a}}])}(te.Component);ZB(Ly,"displayName","CartesianAxis");ZB(Ly,"defaultProps",{x:0,y:0,width:0,height:0,viewBox:{x:0,y:0,width:0,height:0},orientation:"bottom",ticks:[],stroke:"#666",tickLine:!0,axisLine:!0,tick:!0,mirror:!1,minTickGap:5,tickSize:6,tickMargin:2,interval:"preserveEnd"});var Hat=["x1","y1","x2","y2","key"],Wat=["offset"];function Md(r){"@babel/helpers - typeof";return Md=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Md(r)}function UW(r,e){var n=Object.keys(r);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(r);e&&(i=i.filter(function(s){return Object.getOwnPropertyDescriptor(r,s).enumerable})),n.push.apply(n,i)}return n}function is(r){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?UW(Object(n),!0).forEach(function(i){qat(r,i,n[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(n)):UW(Object(n)).forEach(function(i){Object.defineProperty(r,i,Object.getOwnPropertyDescriptor(n,i))})}return r}function qat(r,e,n){return e=Xat(e),e in r?Object.defineProperty(r,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):r[e]=n,r}function Xat(r){var e=Kat(r,"string");return Md(e)=="symbol"?e:e+""}function Kat(r,e){if(Md(r)!="object"||!r)return r;var n=r[Symbol.toPrimitive];if(n!==void 0){var i=n.call(r,e||"default");if(Md(i)!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(r)}function Xf(){return Xf=Object.assign?Object.assign.bind():function(r){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(r[i]=n[i])}return r},Xf.apply(this,arguments)}function zW(r,e){if(r==null)return{};var n=Yat(r,e),i,s;if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(r);for(s=0;s<o.length;s++)i=o[s],!(e.indexOf(i)>=0)&&Object.prototype.propertyIsEnumerable.call(r,i)&&(n[i]=r[i])}return n}function Yat(r,e){if(r==null)return{};var n={};for(var i in r)if(Object.prototype.hasOwnProperty.call(r,i)){if(e.indexOf(i)>=0)continue;n[i]=r[i]}return n}var Zat=function(e){var n=e.fill;if(!n||n==="none")return null;var i=e.fillOpacity,s=e.x,o=e.y,a=e.width,l=e.height,c=e.ry;return Z.createElement("rect",{x:s,y:o,ry:c,width:a,height:l,stroke:"none",fill:n,fillOpacity:i,className:"recharts-cartesian-grid-bg"})};function uie(r,e){var n;if(Z.isValidElement(r))n=Z.cloneElement(r,e);else if(Ut(r))n=r(e);else{var i=e.x1,s=e.y1,o=e.x2,a=e.y2,l=e.key,c=zW(e,Hat),u=Tt(c,!1);u.offset;var h=zW(u,Wat);n=Z.createElement("line",Xf({},h,{x1:i,y1:s,x2:o,y2:a,fill:"none",key:l}))}return n}function Qat(r){var e=r.x,n=r.width,i=r.horizontal,s=i===void 0?!0:i,o=r.horizontalPoints;if(!s||!o||!o.length)return null;var a=o.map(function(l,c){var u=is(is({},r),{},{x1:e,y1:l,x2:e+n,y2:l,key:"line-".concat(c),index:c});return uie(s,u)});return Z.createElement("g",{className:"recharts-cartesian-grid-horizontal"},a)}function Jat(r){var e=r.y,n=r.height,i=r.vertical,s=i===void 0?!0:i,o=r.verticalPoints;if(!s||!o||!o.length)return null;var a=o.map(function(l,c){var u=is(is({},r),{},{x1:l,y1:e,x2:l,y2:e+n,key:"line-".concat(c),index:c});return uie(s,u)});return Z.createElement("g",{className:"recharts-cartesian-grid-vertical"},a)}function elt(r){var e=r.horizontalFill,n=r.fillOpacity,i=r.x,s=r.y,o=r.width,a=r.height,l=r.horizontalPoints,c=r.horizontal,u=c===void 0?!0:c;if(!u||!e||!e.length)return null;var h=l.map(function(d){return Math.round(d+s-s)}).sort(function(d,p){return d-p});s!==h[0]&&h.unshift(0);var f=h.map(function(d,p){var m=!h[p+1],g=m?s+a-d:h[p+1]-d;if(g<=0)return null;var v=p%e.length;return Z.createElement("rect",{key:"react-".concat(p),y:d,x:i,height:g,width:o,stroke:"none",fill:e[v],fillOpacity:n,className:"recharts-cartesian-grid-bg"})});return Z.createElement("g",{className:"recharts-cartesian-gridstripes-horizontal"},f)}function tlt(r){var e=r.vertical,n=e===void 0?!0:e,i=r.verticalFill,s=r.fillOpacity,o=r.x,a=r.y,l=r.width,c=r.height,u=r.verticalPoints;if(!n||!i||!i.length)return null;var h=u.map(function(d){return Math.round(d+o-o)}).sort(function(d,p){return d-p});o!==h[0]&&h.unshift(0);var f=h.map(function(d,p){var m=!h[p+1],g=m?o+l-d:h[p+1]-d;if(g<=0)return null;var v=p%i.length;return Z.createElement("rect",{key:"react-".concat(p),x:d,y:a,width:g,height:c,stroke:"none",fill:i[v],fillOpacity:s,className:"recharts-cartesian-grid-bg"})});return Z.createElement("g",{className:"recharts-cartesian-gridstripes-vertical"},f)}var nlt=function(e,n){var i=e.xAxis,s=e.width,o=e.height,a=e.offset;return lre(YB(is(is(is({},Ly.defaultProps),i),{},{ticks:zc(i,!0),viewBox:{x:0,y:0,width:s,height:o}})),a.left,a.left+a.width,n)},rlt=function(e,n){var i=e.yAxis,s=e.width,o=e.height,a=e.offset;return lre(YB(is(is(is({},Ly.defaultProps),i),{},{ticks:zc(i,!0),viewBox:{x:0,y:0,width:s,height:o}})),a.top,a.top+a.height,n)},Ip={horizontal:!0,vertical:!0,horizontalPoints:[],verticalPoints:[],stroke:"#ccc",fill:"none",verticalFill:[],horizontalFill:[]};function nI(r){var e,n,i,s,o,a,l=WB(),c=qB(),u=Got(),h=is(is({},r),{},{stroke:(e=r.stroke)!==null&&e!==void 0?e:Ip.stroke,fill:(n=r.fill)!==null&&n!==void 0?n:Ip.fill,horizontal:(i=r.horizontal)!==null&&i!==void 0?i:Ip.horizontal,horizontalFill:(s=r.horizontalFill)!==null&&s!==void 0?s:Ip.horizontalFill,vertical:(o=r.vertical)!==null&&o!==void 0?o:Ip.vertical,verticalFill:(a=r.verticalFill)!==null&&a!==void 0?a:Ip.verticalFill,x:We(r.x)?r.x:u.left,y:We(r.y)?r.y:u.top,width:We(r.width)?r.width:u.width,height:We(r.height)?r.height:u.height}),f=h.x,d=h.y,p=h.width,m=h.height,g=h.syncWithTicks,v=h.horizontalValues,y=h.verticalValues,x=$ot(),b=jot();if(!We(p)||p<=0||!We(m)||m<=0||!We(f)||f!==+f||!We(d)||d!==+d)return null;var w=h.verticalCoordinatesGenerator||nlt,_=h.horizontalCoordinatesGenerator||rlt,S=h.horizontalPoints,T=h.verticalPoints;if((!S||!S.length)&&Ut(_)){var E=v&&v.length,M=_({yAxis:b?is(is({},b),{},{ticks:E?v:b.ticks}):void 0,width:l,height:c,offset:u},E?!0:g);Zc(Array.isArray(M),"horizontalCoordinatesGenerator should return Array but instead it returned [".concat(Md(M),"]")),Array.isArray(M)&&(S=M)}if((!T||!T.length)&&Ut(w)){var A=y&&y.length,P=w({xAxis:x?is(is({},x),{},{ticks:A?y:x.ticks}):void 0,width:l,height:c,offset:u},A?!0:g);Zc(Array.isArray(P),"verticalCoordinatesGenerator should return Array but instead it returned [".concat(Md(P),"]")),Array.isArray(P)&&(T=P)}return Z.createElement("g",{className:"recharts-cartesian-grid"},Z.createElement(Zat,{fill:h.fill,fillOpacity:h.fillOpacity,x:h.x,y:h.y,width:h.width,height:h.height,ry:h.ry}),Z.createElement(Qat,Xf({},h,{offset:u,horizontalPoints:S,xAxis:x,yAxis:b})),Z.createElement(Jat,Xf({},h,{offset:u,verticalPoints:T,xAxis:x,yAxis:b})),Z.createElement(elt,Xf({},h,{horizontalPoints:S})),Z.createElement(tlt,Xf({},h,{verticalPoints:T})))}nI.displayName="CartesianGrid";var ilt=["type","layout","connectNulls","ref"],slt=["key"];function Kg(r){"@babel/helpers - typeof";return Kg=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Kg(r)}function $W(r,e){if(r==null)return{};var n=olt(r,e),i,s;if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(r);for(s=0;s<o.length;s++)i=o[s],!(e.indexOf(i)>=0)&&Object.prototype.propertyIsEnumerable.call(r,i)&&(n[i]=r[i])}return n}function olt(r,e){if(r==null)return{};var n={};for(var i in r)if(Object.prototype.hasOwnProperty.call(r,i)){if(e.indexOf(i)>=0)continue;n[i]=r[i]}return n}function J0(){return J0=Object.assign?Object.assign.bind():function(r){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(r[i]=n[i])}return r},J0.apply(this,arguments)}function jW(r,e){var n=Object.keys(r);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(r);e&&(i=i.filter(function(s){return Object.getOwnPropertyDescriptor(r,s).enumerable})),n.push.apply(n,i)}return n}function vo(r){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?jW(Object(n),!0).forEach(function(i){Ua(r,i,n[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(n)):jW(Object(n)).forEach(function(i){Object.defineProperty(r,i,Object.getOwnPropertyDescriptor(n,i))})}return r}function Lp(r){return ult(r)||clt(r)||llt(r)||alt()}function alt(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function llt(r,e){if(r){if(typeof r=="string")return rI(r,e);var n=Object.prototype.toString.call(r).slice(8,-1);if(n==="Object"&&r.constructor&&(n=r.constructor.name),n==="Map"||n==="Set")return Array.from(r);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return rI(r,e)}}function clt(r){if(typeof Symbol<"u"&&r[Symbol.iterator]!=null||r["@@iterator"]!=null)return Array.from(r)}function ult(r){if(Array.isArray(r))return rI(r)}function rI(r,e){(e==null||e>r.length)&&(e=r.length);for(var n=0,i=new Array(e);n<e;n++)i[n]=r[n];return i}function hlt(r,e){if(!(r instanceof e))throw new TypeError("Cannot call a class as a function")}function VW(r,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(r,fie(i.key),i)}}function flt(r,e,n){return e&&VW(r.prototype,e),n&&VW(r,n),Object.defineProperty(r,"prototype",{writable:!1}),r}function dlt(r,e,n){return e=cM(e),plt(r,hie()?Reflect.construct(e,n||[],cM(r).constructor):e.apply(r,n))}function plt(r,e){if(e&&(Kg(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return mlt(r)}function mlt(r){if(r===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return r}function hie(){try{var r=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(hie=function(){return!!r})()}function cM(r){return cM=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(n){return n.__proto__||Object.getPrototypeOf(n)},cM(r)}function glt(r,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");r.prototype=Object.create(e&&e.prototype,{constructor:{value:r,writable:!0,configurable:!0}}),Object.defineProperty(r,"prototype",{writable:!1}),e&&iI(r,e)}function iI(r,e){return iI=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(i,s){return i.__proto__=s,i},iI(r,e)}function Ua(r,e,n){return e=fie(e),e in r?Object.defineProperty(r,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):r[e]=n,r}function fie(r){var e=ylt(r,"string");return Kg(e)=="symbol"?e:e+""}function ylt(r,e){if(Kg(r)!="object"||!r)return r;var n=r[Symbol.toPrimitive];if(n!==void 0){var i=n.call(r,e||"default");if(Kg(i)!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(r)}var V_=function(r){function e(){var n;hlt(this,e);for(var i=arguments.length,s=new Array(i),o=0;o<i;o++)s[o]=arguments[o];return n=dlt(this,e,[].concat(s)),Ua(n,"state",{isAnimationFinished:!0,totalLength:0}),Ua(n,"generateSimpleStrokeDasharray",function(a,l){return"".concat(l,"px ").concat(a-l,"px")}),Ua(n,"getStrokeDasharray",function(a,l,c){var u=c.reduce(function(y,x){return y+x});if(!u)return n.generateSimpleStrokeDasharray(l,a);for(var h=Math.floor(a/u),f=a%u,d=l-a,p=[],m=0,g=0;m<c.length;g+=c[m],++m)if(g+c[m]>f){p=[].concat(Lp(c.slice(0,m)),[f-g]);break}var v=p.length%2===0?[0,d]:[d];return[].concat(Lp(e.repeat(c,h)),Lp(p),v).map(function(y){return"".concat(y,"px")}).join(", ")}),Ua(n,"id",I_("recharts-line-")),Ua(n,"pathRef",function(a){n.mainCurve=a}),Ua(n,"handleAnimationEnd",function(){n.setState({isAnimationFinished:!0}),n.props.onAnimationEnd&&n.props.onAnimationEnd()}),Ua(n,"handleAnimationStart",function(){n.setState({isAnimationFinished:!1}),n.props.onAnimationStart&&n.props.onAnimationStart()}),n}return glt(e,r),flt(e,[{key:"componentDidMount",value:function(){if(this.props.isAnimationActive){var i=this.getTotalLength();this.setState({totalLength:i})}}},{key:"componentDidUpdate",value:function(){if(this.props.isAnimationActive){var i=this.getTotalLength();i!==this.state.totalLength&&this.setState({totalLength:i})}}},{key:"getTotalLength",value:function(){var i=this.mainCurve;try{return i&&i.getTotalLength&&i.getTotalLength()||0}catch{return 0}}},{key:"renderErrorBar",value:function(i,s){if(this.props.isAnimationActive&&!this.state.isAnimationFinished)return null;var o=this.props,a=o.points,l=o.xAxis,c=o.yAxis,u=o.layout,h=o.children,f=ua(h,B_);if(!f)return null;var d=function(g,v){return{x:g.x,y:g.y,value:g.value,errorVal:Is(g.payload,v)}},p={clipPath:i?"url(#clipPath-".concat(s,")"):null};return Z.createElement(Sn,p,f.map(function(m){return Z.cloneElement(m,{key:"bar-".concat(m.props.dataKey),data:a,xAxis:l,yAxis:c,layout:u,dataPointFormatter:d})}))}},{key:"renderDots",value:function(i,s,o){var a=this.props.isAnimationActive;if(a&&!this.state.isAnimationFinished)return null;var l=this.props,c=l.dot,u=l.points,h=l.dataKey,f=Tt(this.props,!1),d=Tt(c,!0),p=u.map(function(g,v){var y=vo(vo(vo({key:"dot-".concat(v),r:3},f),d),{},{index:v,cx:g.x,cy:g.y,value:g.value,dataKey:h,payload:g.payload,points:u});return e.renderDotItem(c,y)}),m={clipPath:i?"url(#clipPath-".concat(s?"":"dots-").concat(o,")"):null};return Z.createElement(Sn,J0({className:"recharts-line-dots",key:"dots"},m),p)}},{key:"renderCurveStatically",value:function(i,s,o,a){var l=this.props,c=l.type,u=l.layout,h=l.connectNulls;l.ref;var f=$W(l,ilt),d=vo(vo(vo({},Tt(f,!0)),{},{fill:"none",className:"recharts-line-curve",clipPath:s?"url(#clipPath-".concat(o,")"):null,points:i},a),{},{type:c,layout:u,connectNulls:h});return Z.createElement(Rk,J0({},d,{pathRef:this.pathRef}))}},{key:"renderCurveWithAnimation",value:function(i,s){var o=this,a=this.props,l=a.points,c=a.strokeDasharray,u=a.isAnimationActive,h=a.animationBegin,f=a.animationDuration,d=a.animationEasing,p=a.animationId,m=a.animateNewValues,g=a.width,v=a.height,y=this.state,x=y.prevPoints,b=y.totalLength;return Z.createElement(jl,{begin:h,duration:f,isActive:u,easing:d,from:{t:0},to:{t:1},key:"line-".concat(p),onAnimationEnd:this.handleAnimationEnd,onAnimationStart:this.handleAnimationStart},function(w){var _=w.t;if(x){var S=x.length/l.length,T=l.map(function(D,B){var C=Math.floor(B*S);if(x[C]){var O=x[C],R=Ts(O.x,D.x),z=Ts(O.y,D.y);return vo(vo({},D),{},{x:R(_),y:z(_)})}if(m){var U=Ts(g*2,D.x),G=Ts(v/2,D.y);return vo(vo({},D),{},{x:U(_),y:G(_)})}return vo(vo({},D),{},{x:D.x,y:D.y})});return o.renderCurveStatically(T,i,s)}var E=Ts(0,b),M=E(_),A;if(c){var P="".concat(c).split(/[,\s]+/gim).map(function(D){return parseFloat(D)});A=o.getStrokeDasharray(M,b,P)}else A=o.generateSimpleStrokeDasharray(b,M);return o.renderCurveStatically(l,i,s,{strokeDasharray:A})})}},{key:"renderCurve",value:function(i,s){var o=this.props,a=o.points,l=o.isAnimationActive,c=this.state,u=c.prevPoints,h=c.totalLength;return l&&a&&a.length&&(!u&&h>0||!F_(u,a))?this.renderCurveWithAnimation(i,s):this.renderCurveStatically(a,i,s)}},{key:"render",value:function(){var i,s=this.props,o=s.hide,a=s.dot,l=s.points,c=s.className,u=s.xAxis,h=s.yAxis,f=s.top,d=s.left,p=s.width,m=s.height,g=s.isAnimationActive,v=s.id;if(o||!l||!l.length)return null;var y=this.state.isAnimationFinished,x=l.length===1,b=qt("recharts-line",c),w=u&&u.allowDataOverflow,_=h&&h.allowDataOverflow,S=w||_,T=nn(v)?this.id:v,E=(i=Tt(a,!1))!==null&&i!==void 0?i:{r:3,strokeWidth:2},M=E.r,A=M===void 0?3:M,P=E.strokeWidth,D=P===void 0?2:P,B=Q5e(a)?a:{},C=B.clipDot,O=C===void 0?!0:C,R=A*2+D;return Z.createElement(Sn,{className:b},w||_?Z.createElement("defs",null,Z.createElement("clipPath",{id:"clipPath-".concat(T)},Z.createElement("rect",{x:w?d:d-p/2,y:_?f:f-m/2,width:w?p:p*2,height:_?m:m*2})),!O&&Z.createElement("clipPath",{id:"clipPath-dots-".concat(T)},Z.createElement("rect",{x:d-R/2,y:f-R/2,width:p+R,height:m+R}))):null,!x&&this.renderCurve(S,T),this.renderErrorBar(S,T),(x||a)&&this.renderDots(S,O,T),(!g||y)&&eu.renderCallByParent(this.props,l))}}],[{key:"getDerivedStateFromProps",value:function(i,s){return i.animationId!==s.prevAnimationId?{prevAnimationId:i.animationId,curPoints:i.points,prevPoints:s.curPoints}:i.points!==s.curPoints?{curPoints:i.points}:null}},{key:"repeat",value:function(i,s){for(var o=i.length%2!==0?[].concat(Lp(i),[0]):i,a=[],l=0;l<s;++l)a=[].concat(Lp(a),Lp(o));return a}},{key:"renderDotItem",value:function(i,s){var o;if(Z.isValidElement(i))o=Z.cloneElement(i,s);else if(Ut(i))o=i(s);else{var a=s.key,l=$W(s,slt),c=qt("recharts-line-dot",typeof i!="boolean"?i.className:"");o=Z.createElement(U_,J0({key:a},l,{className:c}))}return o}}])}(te.PureComponent);Ua(V_,"displayName","Line");Ua(V_,"defaultProps",{xAxisId:0,yAxisId:0,connectNulls:!1,activeDot:!0,dot:!0,legendType:"line",stroke:"#3182bd",strokeWidth:1,fill:"#fff",points:[],isAnimationActive:!Il.isSsr,animateNewValues:!0,animationBegin:0,animationDuration:1500,animationEasing:"ease",hide:!1,label:!1});Ua(V_,"getComposedData",function(r){var e=r.props,n=r.xAxis,i=r.yAxis,s=r.xAxisTicks,o=r.yAxisTicks,a=r.dataKey,l=r.bandSize,c=r.displayedData,u=r.offset,h=e.layout,f=c.map(function(d,p){var m=Is(d,a);return h==="horizontal"?{x:f6({axis:n,ticks:s,bandSize:l,entry:d,index:p}),y:nn(m)?null:i.scale(m),value:m,payload:d}:{x:nn(m)?null:n.scale(m),y:f6({axis:i,ticks:o,bandSize:l,entry:d,index:p}),value:m,payload:d}});return vo({points:f,layout:h},u)});function Yg(r){"@babel/helpers - typeof";return Yg=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Yg(r)}function vlt(r,e){if(!(r instanceof e))throw new TypeError("Cannot call a class as a function")}function xlt(r,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(r,mie(i.key),i)}}function blt(r,e,n){return e&&xlt(r.prototype,e),Object.defineProperty(r,"prototype",{writable:!1}),r}function _lt(r,e,n){return e=uM(e),wlt(r,die()?Reflect.construct(e,n||[],uM(r).constructor):e.apply(r,n))}function wlt(r,e){if(e&&(Yg(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Slt(r)}function Slt(r){if(r===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return r}function die(){try{var r=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(die=function(){return!!r})()}function uM(r){return uM=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(n){return n.__proto__||Object.getPrototypeOf(n)},uM(r)}function Tlt(r,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");r.prototype=Object.create(e&&e.prototype,{constructor:{value:r,writable:!0,configurable:!0}}),Object.defineProperty(r,"prototype",{writable:!1}),e&&sI(r,e)}function sI(r,e){return sI=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(i,s){return i.__proto__=s,i},sI(r,e)}function pie(r,e,n){return e=mie(e),e in r?Object.defineProperty(r,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):r[e]=n,r}function mie(r){var e=Elt(r,"string");return Yg(e)=="symbol"?e:e+""}function Elt(r,e){if(Yg(r)!="object"||!r)return r;var n=r[Symbol.toPrimitive];if(n!==void 0){var i=n.call(r,e||"default");if(Yg(i)!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(r)}function oI(){return oI=Object.assign?Object.assign.bind():function(r){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(r[i]=n[i])}return r},oI.apply(this,arguments)}function Mlt(r){var e=r.xAxisId,n=WB(),i=qB(),s=Jre(e);return s==null?null:Z.createElement(Ly,oI({},s,{className:qt("recharts-".concat(s.axisType," ").concat(s.axisType),s.className),viewBox:{x:0,y:0,width:n,height:i},ticksGenerator:function(a){return zc(a,!0)}}))}var Zg=function(r){function e(){return vlt(this,e),_lt(this,e,arguments)}return Tlt(e,r),blt(e,[{key:"render",value:function(){return Z.createElement(Mlt,this.props)}}])}(Z.Component);pie(Zg,"displayName","XAxis");pie(Zg,"defaultProps",{allowDecimals:!0,hide:!1,orientation:"bottom",width:0,height:30,mirror:!1,xAxisId:0,tickCount:5,type:"category",padding:{left:0,right:0},allowDataOverflow:!1,scale:"auto",reversed:!1,allowDuplicatedCategory:!0});function Qg(r){"@babel/helpers - typeof";return Qg=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Qg(r)}function Alt(r,e){if(!(r instanceof e))throw new TypeError("Cannot call a class as a function")}function Clt(r,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(r,vie(i.key),i)}}function Plt(r,e,n){return e&&Clt(r.prototype,e),Object.defineProperty(r,"prototype",{writable:!1}),r}function Rlt(r,e,n){return e=hM(e),Nlt(r,gie()?Reflect.construct(e,n||[],hM(r).constructor):e.apply(r,n))}function Nlt(r,e){if(e&&(Qg(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Olt(r)}function Olt(r){if(r===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return r}function gie(){try{var r=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(gie=function(){return!!r})()}function hM(r){return hM=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(n){return n.__proto__||Object.getPrototypeOf(n)},hM(r)}function Dlt(r,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");r.prototype=Object.create(e&&e.prototype,{constructor:{value:r,writable:!0,configurable:!0}}),Object.defineProperty(r,"prototype",{writable:!1}),e&&aI(r,e)}function aI(r,e){return aI=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(i,s){return i.__proto__=s,i},aI(r,e)}function yie(r,e,n){return e=vie(e),e in r?Object.defineProperty(r,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):r[e]=n,r}function vie(r){var e=klt(r,"string");return Qg(e)=="symbol"?e:e+""}function klt(r,e){if(Qg(r)!="object"||!r)return r;var n=r[Symbol.toPrimitive];if(n!==void 0){var i=n.call(r,e||"default");if(Qg(i)!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(r)}function lI(){return lI=Object.assign?Object.assign.bind():function(r){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(r[i]=n[i])}return r},lI.apply(this,arguments)}var Ilt=function(e){var n=e.yAxisId,i=WB(),s=qB(),o=eie(n);return o==null?null:Z.createElement(Ly,lI({},o,{className:qt("recharts-".concat(o.axisType," ").concat(o.axisType),o.className),viewBox:{x:0,y:0,width:i,height:s},ticksGenerator:function(l){return zc(l,!0)}}))},Jg=function(r){function e(){return Alt(this,e),Rlt(this,e,arguments)}return Dlt(e,r),Plt(e,[{key:"render",value:function(){return Z.createElement(Ilt,this.props)}}])}(Z.Component);yie(Jg,"displayName","YAxis");yie(Jg,"defaultProps",{allowDuplicatedCategory:!0,allowDecimals:!0,hide:!1,orientation:"left",width:60,height:0,mirror:!1,yAxisId:0,tickCount:5,type:"number",padding:{top:0,bottom:0},allowDataOverflow:!1,scale:"auto",reversed:!1});function GW(r){return Ult(r)||Blt(r)||Flt(r)||Llt()}function Llt(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Flt(r,e){if(r){if(typeof r=="string")return cI(r,e);var n=Object.prototype.toString.call(r).slice(8,-1);if(n==="Object"&&r.constructor&&(n=r.constructor.name),n==="Map"||n==="Set")return Array.from(r);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return cI(r,e)}}function Blt(r){if(typeof Symbol<"u"&&r[Symbol.iterator]!=null||r["@@iterator"]!=null)return Array.from(r)}function Ult(r){if(Array.isArray(r))return cI(r)}function cI(r,e){(e==null||e>r.length)&&(e=r.length);for(var n=0,i=new Array(e);n<e;n++)i[n]=r[n];return i}var uI=function(e,n,i,s,o){var a=ua(e,KB),l=ua(e,pC),c=[].concat(GW(a),GW(l)),u=ua(e,gC),h="".concat(s,"Id"),f=s[0],d=n;if(c.length&&(d=c.reduce(function(g,v){if(v.props[h]===i&&Ll(v.props,"extendDomain")&&We(v.props[f])){var y=v.props[f];return[Math.min(g[0],y),Math.max(g[1],y)]}return g},d)),u.length){var p="".concat(f,"1"),m="".concat(f,"2");d=u.reduce(function(g,v){if(v.props[h]===i&&Ll(v.props,"extendDomain")&&We(v.props[p])&&We(v.props[m])){var y=v.props[p],x=v.props[m];return[Math.min(g[0],y,x),Math.max(g[1],y,x)]}return g},d)}return o&&o.length&&(d=o.reduce(function(g,v){return We(v)?[Math.min(g[0],v),Math.max(g[1],v)]:g},d)),d},xie={exports:{}};(function(r){var e=Object.prototype.hasOwnProperty,n="~";function i(){}Object.create&&(i.prototype=Object.create(null),new i().__proto__||(n=!1));function s(c,u,h){this.fn=c,this.context=u,this.once=h||!1}function o(c,u,h,f,d){if(typeof h!="function")throw new TypeError("The listener must be a function");var p=new s(h,f||c,d),m=n?n+u:u;return c._events[m]?c._events[m].fn?c._events[m]=[c._events[m],p]:c._events[m].push(p):(c._events[m]=p,c._eventsCount++),c}function a(c,u){--c._eventsCount===0?c._events=new i:delete c._events[u]}function l(){this._events=new i,this._eventsCount=0}l.prototype.eventNames=function(){var u=[],h,f;if(this._eventsCount===0)return u;for(f in h=this._events)e.call(h,f)&&u.push(n?f.slice(1):f);return Object.getOwnPropertySymbols?u.concat(Object.getOwnPropertySymbols(h)):u},l.prototype.listeners=function(u){var h=n?n+u:u,f=this._events[h];if(!f)return[];if(f.fn)return[f.fn];for(var d=0,p=f.length,m=new Array(p);d<p;d++)m[d]=f[d].fn;return m},l.prototype.listenerCount=function(u){var h=n?n+u:u,f=this._events[h];return f?f.fn?1:f.length:0},l.prototype.emit=function(u,h,f,d,p,m){var g=n?n+u:u;if(!this._events[g])return!1;var v=this._events[g],y=arguments.length,x,b;if(v.fn){switch(v.once&&this.removeListener(u,v.fn,void 0,!0),y){case 1:return v.fn.call(v.context),!0;case 2:return v.fn.call(v.context,h),!0;case 3:return v.fn.call(v.context,h,f),!0;case 4:return v.fn.call(v.context,h,f,d),!0;case 5:return v.fn.call(v.context,h,f,d,p),!0;case 6:return v.fn.call(v.context,h,f,d,p,m),!0}for(b=1,x=new Array(y-1);b<y;b++)x[b-1]=arguments[b];v.fn.apply(v.context,x)}else{var w=v.length,_;for(b=0;b<w;b++)switch(v[b].once&&this.removeListener(u,v[b].fn,void 0,!0),y){case 1:v[b].fn.call(v[b].context);break;case 2:v[b].fn.call(v[b].context,h);break;case 3:v[b].fn.call(v[b].context,h,f);break;case 4:v[b].fn.call(v[b].context,h,f,d);break;default:if(!x)for(_=1,x=new Array(y-1);_<y;_++)x[_-1]=arguments[_];v[b].fn.apply(v[b].context,x)}}return!0},l.prototype.on=function(u,h,f){return o(this,u,h,f,!1)},l.prototype.once=function(u,h,f){return o(this,u,h,f,!0)},l.prototype.removeListener=function(u,h,f,d){var p=n?n+u:u;if(!this._events[p])return this;if(!h)return a(this,p),this;var m=this._events[p];if(m.fn)m.fn===h&&(!d||m.once)&&(!f||m.context===f)&&a(this,p);else{for(var g=0,v=[],y=m.length;g<y;g++)(m[g].fn!==h||d&&!m[g].once||f&&m[g].context!==f)&&v.push(m[g]);v.length?this._events[p]=v.length===1?v[0]:v:a(this,p)}return this},l.prototype.removeAllListeners=function(u){var h;return u?(h=n?n+u:u,this._events[h]&&a(this,h)):(this._events=new i,this._eventsCount=0),this},l.prototype.off=l.prototype.removeListener,l.prototype.addListener=l.prototype.on,l.prefixed=n,l.EventEmitter=l,r.exports=l})(xie);var zlt=xie.exports;const $lt=hn(zlt);var h2=new $lt,f2="recharts.syncMouseEvents";function Hb(r){"@babel/helpers - typeof";return Hb=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Hb(r)}function jlt(r,e){if(!(r instanceof e))throw new TypeError("Cannot call a class as a function")}function Vlt(r,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(r,bie(i.key),i)}}function Glt(r,e,n){return e&&Vlt(r.prototype,e),Object.defineProperty(r,"prototype",{writable:!1}),r}function d2(r,e,n){return e=bie(e),e in r?Object.defineProperty(r,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):r[e]=n,r}function bie(r){var e=Hlt(r,"string");return Hb(e)=="symbol"?e:e+""}function Hlt(r,e){if(Hb(r)!="object"||!r)return r;var n=r[Symbol.toPrimitive];if(n!==void 0){var i=n.call(r,e);if(Hb(i)!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(r)}var Wlt=function(){function r(){jlt(this,r),d2(this,"activeIndex",0),d2(this,"coordinateList",[]),d2(this,"layout","horizontal")}return Glt(r,[{key:"setDetails",value:function(n){var i,s=n.coordinateList,o=s===void 0?null:s,a=n.container,l=a===void 0?null:a,c=n.layout,u=c===void 0?null:c,h=n.offset,f=h===void 0?null:h,d=n.mouseHandlerCallback,p=d===void 0?null:d;this.coordinateList=(i=o??this.coordinateList)!==null&&i!==void 0?i:[],this.container=l??this.container,this.layout=u??this.layout,this.offset=f??this.offset,this.mouseHandlerCallback=p??this.mouseHandlerCallback,this.activeIndex=Math.min(Math.max(this.activeIndex,0),this.coordinateList.length-1)}},{key:"focus",value:function(){this.spoofMouse()}},{key:"keyboardEvent",value:function(n){if(this.coordinateList.length!==0)switch(n.key){case"ArrowRight":{if(this.layout!=="horizontal")return;this.activeIndex=Math.min(this.activeIndex+1,this.coordinateList.length-1),this.spoofMouse();break}case"ArrowLeft":{if(this.layout!=="horizontal")return;this.activeIndex=Math.max(this.activeIndex-1,0),this.spoofMouse();break}}}},{key:"setIndex",value:function(n){this.activeIndex=n}},{key:"spoofMouse",value:function(){var n,i;if(this.layout==="horizontal"&&this.coordinateList.length!==0){var s=this.container.getBoundingClientRect(),o=s.x,a=s.y,l=s.height,c=this.coordinateList[this.activeIndex].coordinate,u=((n=window)===null||n===void 0?void 0:n.scrollX)||0,h=((i=window)===null||i===void 0?void 0:i.scrollY)||0,f=o+c+u,d=a+this.offset.top+l/2+h;this.mouseHandlerCallback({pageX:f,pageY:d})}}}])}();function qlt(r,e,n){if(n==="number"&&e===!0&&Array.isArray(r)){var i=r==null?void 0:r[0],s=r==null?void 0:r[1];if(i&&s&&We(i)&&We(s))return!0}return!1}function Xlt(r,e,n,i){var s=i/2;return{stroke:"none",fill:"#ccc",x:r==="horizontal"?e.x-s:n.left+.5,y:r==="horizontal"?n.top+.5:e.y-s,width:r==="horizontal"?i:n.width-1,height:r==="horizontal"?n.height-1:i}}function _ie(r){var e=r.cx,n=r.cy,i=r.radius,s=r.startAngle,o=r.endAngle,a=Nn(e,n,i,s),l=Nn(e,n,i,o);return{points:[a,l],cx:e,cy:n,radius:i,startAngle:s,endAngle:o}}function Klt(r,e,n){var i,s,o,a;if(r==="horizontal")i=e.x,o=i,s=n.top,a=n.top+n.height;else if(r==="vertical")s=e.y,a=s,i=n.left,o=n.left+n.width;else if(e.cx!=null&&e.cy!=null)if(r==="centric"){var l=e.cx,c=e.cy,u=e.innerRadius,h=e.outerRadius,f=e.angle,d=Nn(l,c,u,f),p=Nn(l,c,h,f);i=d.x,s=d.y,o=p.x,a=p.y}else return _ie(e);return[{x:i,y:s},{x:o,y:a}]}function Wb(r){"@babel/helpers - typeof";return Wb=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Wb(r)}function HW(r,e){var n=Object.keys(r);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(r);e&&(i=i.filter(function(s){return Object.getOwnPropertyDescriptor(r,s).enumerable})),n.push.apply(n,i)}return n}function l1(r){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?HW(Object(n),!0).forEach(function(i){Ylt(r,i,n[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(n)):HW(Object(n)).forEach(function(i){Object.defineProperty(r,i,Object.getOwnPropertyDescriptor(n,i))})}return r}function Ylt(r,e,n){return e=Zlt(e),e in r?Object.defineProperty(r,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):r[e]=n,r}function Zlt(r){var e=Qlt(r,"string");return Wb(e)=="symbol"?e:e+""}function Qlt(r,e){if(Wb(r)!="object"||!r)return r;var n=r[Symbol.toPrimitive];if(n!==void 0){var i=n.call(r,e||"default");if(Wb(i)!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(r)}function Jlt(r){var e,n,i=r.element,s=r.tooltipEventType,o=r.isActive,a=r.activeCoordinate,l=r.activePayload,c=r.offset,u=r.activeTooltipIndex,h=r.tooltipAxisBandSize,f=r.layout,d=r.chartName,p=(e=i.props.cursor)!==null&&e!==void 0?e:(n=i.type.defaultProps)===null||n===void 0?void 0:n.cursor;if(!i||!p||!o||!a||d!=="ScatterChart"&&s!=="axis")return null;var m,g=Rk;if(d==="ScatterChart")m=a,g=Qnt;else if(d==="BarChart")m=Xlt(f,a,c,h),g=jB;else if(f==="radial"){var v=_ie(a),y=v.cx,x=v.cy,b=v.radius,w=v.startAngle,_=v.endAngle;m={cx:y,cy:x,startAngle:w,endAngle:_,innerRadius:b,outerRadius:b},g=xre}else m={points:Klt(f,a,c)},g=Rk;var S=l1(l1(l1(l1({stroke:"#ccc",pointerEvents:"none"},c),m),Tt(p,!1)),{},{payload:l,payloadIndex:u,className:qt("recharts-tooltip-cursor",p.className)});return te.isValidElement(p)?te.cloneElement(p,S):te.createElement(g,S)}var ect=["item"],tct=["children","className","width","height","style","compact","title","desc"];function ey(r){"@babel/helpers - typeof";return ey=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},ey(r)}function vm(){return vm=Object.assign?Object.assign.bind():function(r){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(r[i]=n[i])}return r},vm.apply(this,arguments)}function WW(r,e){return ict(r)||rct(r,e)||Sie(r,e)||nct()}function nct(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function rct(r,e){var n=r==null?null:typeof Symbol<"u"&&r[Symbol.iterator]||r["@@iterator"];if(n!=null){var i,s,o,a,l=[],c=!0,u=!1;try{if(o=(n=n.call(r)).next,e!==0)for(;!(c=(i=o.call(n)).done)&&(l.push(i.value),l.length!==e);c=!0);}catch(h){u=!0,s=h}finally{try{if(!c&&n.return!=null&&(a=n.return(),Object(a)!==a))return}finally{if(u)throw s}}return l}}function ict(r){if(Array.isArray(r))return r}function qW(r,e){if(r==null)return{};var n=sct(r,e),i,s;if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(r);for(s=0;s<o.length;s++)i=o[s],!(e.indexOf(i)>=0)&&Object.prototype.propertyIsEnumerable.call(r,i)&&(n[i]=r[i])}return n}function sct(r,e){if(r==null)return{};var n={};for(var i in r)if(Object.prototype.hasOwnProperty.call(r,i)){if(e.indexOf(i)>=0)continue;n[i]=r[i]}return n}function oct(r,e){if(!(r instanceof e))throw new TypeError("Cannot call a class as a function")}function act(r,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(r,Tie(i.key),i)}}function lct(r,e,n){return e&&act(r.prototype,e),Object.defineProperty(r,"prototype",{writable:!1}),r}function cct(r,e,n){return e=fM(e),uct(r,wie()?Reflect.construct(e,n||[],fM(r).constructor):e.apply(r,n))}function uct(r,e){if(e&&(ey(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return hct(r)}function hct(r){if(r===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return r}function wie(){try{var r=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(wie=function(){return!!r})()}function fM(r){return fM=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(n){return n.__proto__||Object.getPrototypeOf(n)},fM(r)}function fct(r,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");r.prototype=Object.create(e&&e.prototype,{constructor:{value:r,writable:!0,configurable:!0}}),Object.defineProperty(r,"prototype",{writable:!1}),e&&hI(r,e)}function hI(r,e){return hI=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(i,s){return i.__proto__=s,i},hI(r,e)}function ty(r){return mct(r)||pct(r)||Sie(r)||dct()}function dct(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Sie(r,e){if(r){if(typeof r=="string")return fI(r,e);var n=Object.prototype.toString.call(r).slice(8,-1);if(n==="Object"&&r.constructor&&(n=r.constructor.name),n==="Map"||n==="Set")return Array.from(r);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return fI(r,e)}}function pct(r){if(typeof Symbol<"u"&&r[Symbol.iterator]!=null||r["@@iterator"]!=null)return Array.from(r)}function mct(r){if(Array.isArray(r))return fI(r)}function fI(r,e){(e==null||e>r.length)&&(e=r.length);for(var n=0,i=new Array(e);n<e;n++)i[n]=r[n];return i}function XW(r,e){var n=Object.keys(r);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(r);e&&(i=i.filter(function(s){return Object.getOwnPropertyDescriptor(r,s).enumerable})),n.push.apply(n,i)}return n}function Me(r){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?XW(Object(n),!0).forEach(function(i){Pt(r,i,n[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(n)):XW(Object(n)).forEach(function(i){Object.defineProperty(r,i,Object.getOwnPropertyDescriptor(n,i))})}return r}function Pt(r,e,n){return e=Tie(e),e in r?Object.defineProperty(r,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):r[e]=n,r}function Tie(r){var e=gct(r,"string");return ey(e)=="symbol"?e:e+""}function gct(r,e){if(ey(r)!="object"||!r)return r;var n=r[Symbol.toPrimitive];if(n!==void 0){var i=n.call(r,e||"default");if(ey(i)!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(r)}var yct={xAxis:["bottom","top"],yAxis:["left","right"]},vct={width:"100%",height:"100%"},Eie={x:0,y:0};function c1(r){return r}var xct=function(e,n){return n==="horizontal"?e.x:n==="vertical"?e.y:n==="centric"?e.angle:e.radius},bct=function(e,n,i,s){var o=n.find(function(h){return h&&h.index===i});if(o){if(e==="horizontal")return{x:o.coordinate,y:s.y};if(e==="vertical")return{x:s.x,y:o.coordinate};if(e==="centric"){var a=o.coordinate,l=s.radius;return Me(Me(Me({},s),Nn(s.cx,s.cy,l,a)),{},{angle:a,radius:l})}var c=o.coordinate,u=s.angle;return Me(Me(Me({},s),Nn(s.cx,s.cy,c,u)),{},{angle:u,radius:c})}return Eie},yC=function(e,n){var i=n.graphicalItems,s=n.dataStartIndex,o=n.dataEndIndex,a=(i??[]).reduce(function(l,c){var u=c.props.data;return u&&u.length?[].concat(ty(l),ty(u)):l},[]);return a.length>0?a:e&&e.length&&We(s)&&We(o)?e.slice(s,o+1):[]};function Mie(r){return r==="number"?[0,"auto"]:void 0}var dI=function(e,n,i,s){var o=e.graphicalItems,a=e.tooltipAxis,l=yC(n,e);return i<0||!o||!o.length||i>=l.length?null:o.reduce(function(c,u){var h,f=(h=u.props.data)!==null&&h!==void 0?h:n;f&&e.dataStartIndex+e.dataEndIndex!==0&&e.dataEndIndex-e.dataStartIndex>=i&&(f=f.slice(e.dataStartIndex,e.dataEndIndex+1));var d;if(a.dataKey&&!a.allowDuplicatedCategory){var p=f===void 0?l:f;d=wE(p,a.dataKey,s)}else d=f&&f[i]||l[i];return d?[].concat(ty(c),[dre(u,d)]):c},[])},KW=function(e,n,i,s){var o=s||{x:e.chartX,y:e.chartY},a=xct(o,i),l=e.orderedTooltipTicks,c=e.tooltipAxis,u=e.tooltipTicks,h=MJe(a,l,u,c);if(h>=0&&u){var f=u[h]&&u[h].value,d=dI(e,n,h,f),p=bct(i,l,h,o);return{activeTooltipIndex:h,activeLabel:f,activePayload:d,activeCoordinate:p}}return null},_ct=function(e,n){var i=n.axes,s=n.graphicalItems,o=n.axisType,a=n.axisIdKey,l=n.stackGroups,c=n.dataStartIndex,u=n.dataEndIndex,h=e.layout,f=e.children,d=e.stackOffset,p=are(h,o);return i.reduce(function(m,g){var v,y=g.type.defaultProps!==void 0?Me(Me({},g.type.defaultProps),g.props):g.props,x=y.type,b=y.dataKey,w=y.allowDataOverflow,_=y.allowDuplicatedCategory,S=y.scale,T=y.ticks,E=y.includeHidden,M=y[a];if(m[M])return m;var A=yC(e.data,{graphicalItems:s.filter(function(ee){var he,q=a in ee.props?ee.props[a]:(he=ee.type.defaultProps)===null||he===void 0?void 0:he[a];return q===M}),dataStartIndex:c,dataEndIndex:u}),P=A.length,D,B,C;qlt(y.domain,w,x)&&(D=Ek(y.domain,null,w),p&&(x==="number"||S!=="auto")&&(C=K0(A,b,"category")));var O=Mie(x);if(!D||D.length===0){var R,z=(R=y.domain)!==null&&R!==void 0?R:O;if(b){if(D=K0(A,b,x),x==="category"&&p){var U=j5e(D);_&&U?(B=D,D=JE(0,P)):_||(D=g6(z,D,g).reduce(function(ee,he){return ee.indexOf(he)>=0?ee:[].concat(ty(ee),[he])},[]))}else if(x==="category")_?D=D.filter(function(ee){return ee!==""&&!nn(ee)}):D=g6(z,D,g).reduce(function(ee,he){return ee.indexOf(he)>=0||he===""||nn(he)?ee:[].concat(ty(ee),[he])},[]);else if(x==="number"){var G=NJe(A,s.filter(function(ee){var he,q,J=a in ee.props?ee.props[a]:(he=ee.type.defaultProps)===null||he===void 0?void 0:he[a],se="hide"in ee.props?ee.props.hide:(q=ee.type.defaultProps)===null||q===void 0?void 0:q.hide;return J===M&&(E||!se)}),b,o,h);G&&(D=G)}p&&(x==="number"||S!=="auto")&&(C=K0(A,b,"category"))}else p?D=JE(0,P):l&&l[M]&&l[M].hasStack&&x==="number"?D=d==="expand"?[0,1]:fre(l[M].stackGroups,c,u):D=ore(A,s.filter(function(ee){var he=a in ee.props?ee.props[a]:ee.type.defaultProps[a],q="hide"in ee.props?ee.props.hide:ee.type.defaultProps.hide;return he===M&&(E||!q)}),x,h,!0);if(x==="number")D=uI(f,D,M,o,T),z&&(D=Ek(z,D,w));else if(x==="category"&&z){var H=z,Y=D.every(function(ee){return H.indexOf(ee)>=0});Y&&(D=H)}}return Me(Me({},m),{},Pt({},M,Me(Me({},y),{},{axisType:o,domain:D,categoricalDomain:C,duplicateDomain:B,originalDomain:(v=y.domain)!==null&&v!==void 0?v:O,isCategorical:p,layout:h})))},{})},wct=function(e,n){var i=n.graphicalItems,s=n.Axis,o=n.axisType,a=n.axisIdKey,l=n.stackGroups,c=n.dataStartIndex,u=n.dataEndIndex,h=e.layout,f=e.children,d=yC(e.data,{graphicalItems:i,dataStartIndex:c,dataEndIndex:u}),p=d.length,m=are(h,o),g=-1;return i.reduce(function(v,y){var x=y.type.defaultProps!==void 0?Me(Me({},y.type.defaultProps),y.props):y.props,b=x[a],w=Mie("number");if(!v[b]){g++;var _;return m?_=JE(0,p):l&&l[b]&&l[b].hasStack?(_=fre(l[b].stackGroups,c,u),_=uI(f,_,b,o)):(_=Ek(w,ore(d,i.filter(function(S){var T,E,M=a in S.props?S.props[a]:(T=S.type.defaultProps)===null||T===void 0?void 0:T[a],A="hide"in S.props?S.props.hide:(E=S.type.defaultProps)===null||E===void 0?void 0:E.hide;return M===b&&!A}),"number",h),s.defaultProps.allowDataOverflow),_=uI(f,_,b,o)),Me(Me({},v),{},Pt({},b,Me(Me({axisType:o},s.defaultProps),{},{hide:!0,orientation:ca(yct,"".concat(o,".").concat(g%2),null),domain:_,originalDomain:w,isCategorical:m,layout:h})))}return v},{})},Sct=function(e,n){var i=n.axisType,s=i===void 0?"xAxis":i,o=n.AxisComp,a=n.graphicalItems,l=n.stackGroups,c=n.dataStartIndex,u=n.dataEndIndex,h=e.children,f="".concat(s,"Id"),d=ua(h,o),p={};return d&&d.length?p=_ct(e,{axes:d,graphicalItems:a,axisType:s,axisIdKey:f,stackGroups:l,dataStartIndex:c,dataEndIndex:u}):a&&a.length&&(p=wct(e,{Axis:o,graphicalItems:a,axisType:s,axisIdKey:f,stackGroups:l,dataStartIndex:c,dataEndIndex:u})),p},Tct=function(e){var n=nh(e),i=zc(n,!1,!0);return{tooltipTicks:i,orderedTooltipTicks:FB(i,function(s){return s.coordinate}),tooltipAxis:n,tooltipAxisBandSize:zE(n,i)}},YW=function(e){var n=e.children,i=e.defaultShowTooltip,s=So(n,Vg),o=0,a=0;return e.data&&e.data.length!==0&&(a=e.data.length-1),s&&s.props&&(s.props.startIndex>=0&&(o=s.props.startIndex),s.props.endIndex>=0&&(a=s.props.endIndex)),{chartX:0,chartY:0,dataStartIndex:o,dataEndIndex:a,activeTooltipIndex:-1,isTooltipActive:!!i}},Ect=function(e){return!e||!e.length?!1:e.some(function(n){var i=Yc(n&&n.type);return i&&i.indexOf("Bar")>=0})},ZW=function(e){return e==="horizontal"?{numericAxisName:"yAxis",cateAxisName:"xAxis"}:e==="vertical"?{numericAxisName:"xAxis",cateAxisName:"yAxis"}:e==="centric"?{numericAxisName:"radiusAxis",cateAxisName:"angleAxis"}:{numericAxisName:"angleAxis",cateAxisName:"radiusAxis"}},Mct=function(e,n){var i=e.props,s=e.graphicalItems,o=e.xAxisMap,a=o===void 0?{}:o,l=e.yAxisMap,c=l===void 0?{}:l,u=i.width,h=i.height,f=i.children,d=i.margin||{},p=So(f,Vg),m=So(f,Qc),g=Object.keys(c).reduce(function(_,S){var T=c[S],E=T.orientation;return!T.mirror&&!T.hide?Me(Me({},_),{},Pt({},E,_[E]+T.width)):_},{left:d.left||0,right:d.right||0}),v=Object.keys(a).reduce(function(_,S){var T=a[S],E=T.orientation;return!T.mirror&&!T.hide?Me(Me({},_),{},Pt({},E,ca(_,"".concat(E))+T.height)):_},{top:d.top||0,bottom:d.bottom||0}),y=Me(Me({},v),g),x=y.bottom;p&&(y.bottom+=p.props.height||Vg.defaultProps.height),m&&n&&(y=PJe(y,s,i,n));var b=u-y.left-y.right,w=h-y.top-y.bottom;return Me(Me({brushBottom:x},y),{},{width:Math.max(b,0),height:Math.max(w,0)})},Act=function(e,n){if(n==="xAxis")return e[n].width;if(n==="yAxis")return e[n].height},QB=function(e){var n=e.chartName,i=e.GraphicalChild,s=e.defaultTooltipEventType,o=s===void 0?"axis":s,a=e.validateTooltipEventTypes,l=a===void 0?["axis"]:a,c=e.axisComponents,u=e.legendContent,h=e.formatAxisMap,f=e.defaultProps,d=function(y,x){var b=x.graphicalItems,w=x.stackGroups,_=x.offset,S=x.updateId,T=x.dataStartIndex,E=x.dataEndIndex,M=y.barSize,A=y.layout,P=y.barGap,D=y.barCategoryGap,B=y.maxBarSize,C=ZW(A),O=C.numericAxisName,R=C.cateAxisName,z=Ect(b),U=[];return b.forEach(function(G,H){var Y=yC(y.data,{graphicalItems:[G],dataStartIndex:T,dataEndIndex:E}),ee=G.type.defaultProps!==void 0?Me(Me({},G.type.defaultProps),G.props):G.props,he=ee.dataKey,q=ee.maxBarSize,J=ee["".concat(O,"Id")],se=ee["".concat(R,"Id")],oe={},Ee=c.reduce(function(I,k){var ne=x["".concat(k.axisType,"Map")],ae=ee["".concat(k.axisType,"Id")];ne&&ne[ae]||k.axisType==="zAxis"||Ed();var ce=ne[ae];return Me(Me({},I),{},Pt(Pt({},k.axisType,ce),"".concat(k.axisType,"Ticks"),zc(ce)))},oe),ye=Ee[R],Ce=Ee["".concat(R,"Ticks")],Ge=w&&w[J]&&w[J].hasStack&&zJe(G,w[J].stackGroups),_e=Yc(G.type).indexOf("Bar")>=0,Ke=zE(ye,Ce),Q=[],kt=z&&AJe({barSize:M,stackGroups:w,totalSize:Act(Ee,R)});if(_e){var ct,gt,ot=nn(q)?B:q,on=(ct=(gt=zE(ye,Ce,!0))!==null&&gt!==void 0?gt:ot)!==null&&ct!==void 0?ct:0;Q=CJe({barGap:P,barCategoryGap:D,bandSize:on!==Ke?on:Ke,sizeList:kt[se],maxBarSize:ot}),on!==Ke&&(Q=Q.map(function(I){return Me(Me({},I),{},{position:Me(Me({},I.position),{},{offset:I.position.offset-on/2})})}))}var X=G&&G.type&&G.type.getComposedData;X&&U.push({props:Me(Me({},X(Me(Me({},Ee),{},{displayedData:Y,props:y,dataKey:he,item:G,bandSize:Ke,barPosition:Q,offset:_,stackedData:Ge,layout:A,dataStartIndex:T,dataEndIndex:E}))),{},Pt(Pt(Pt({key:G.key||"item-".concat(H)},O,Ee[O]),R,Ee[R]),"animationId",S)),childIndex:tHe(G,y.children),item:G})}),U},p=function(y,x){var b=y.props,w=y.dataStartIndex,_=y.dataEndIndex,S=y.updateId;if(!WH({props:b}))return null;var T=b.children,E=b.layout,M=b.stackOffset,A=b.data,P=b.reverseStackOrder,D=ZW(E),B=D.numericAxisName,C=D.cateAxisName,O=ua(T,i),R=BJe(A,O,"".concat(B,"Id"),"".concat(C,"Id"),M,P),z=c.reduce(function(ee,he){var q="".concat(he.axisType,"Map");return Me(Me({},ee),{},Pt({},q,Sct(b,Me(Me({},he),{},{graphicalItems:O,stackGroups:he.axisType===B&&R,dataStartIndex:w,dataEndIndex:_}))))},{}),U=Mct(Me(Me({},z),{},{props:b,graphicalItems:O}),x==null?void 0:x.legendBBox);Object.keys(z).forEach(function(ee){z[ee]=h(b,z[ee],U,ee.replace("Map",""),n)});var G=z["".concat(C,"Map")],H=Tct(G),Y=d(b,Me(Me({},z),{},{dataStartIndex:w,dataEndIndex:_,updateId:S,graphicalItems:O,stackGroups:R,offset:U}));return Me(Me({formattedGraphicalItems:Y,graphicalItems:O,offset:U,stackGroups:R},H),z)},m=function(v){function y(x){var b,w,_;return oct(this,y),_=cct(this,y,[x]),Pt(_,"eventEmitterSymbol",Symbol("rechartsEventEmitter")),Pt(_,"accessibilityManager",new Wlt),Pt(_,"handleLegendBBoxUpdate",function(S){if(S){var T=_.state,E=T.dataStartIndex,M=T.dataEndIndex,A=T.updateId;_.setState(Me({legendBBox:S},p({props:_.props,dataStartIndex:E,dataEndIndex:M,updateId:A},Me(Me({},_.state),{},{legendBBox:S}))))}}),Pt(_,"handleReceiveSyncEvent",function(S,T,E){if(_.props.syncId===S){if(E===_.eventEmitterSymbol&&typeof _.props.syncMethod!="function")return;_.applySyncEvent(T)}}),Pt(_,"handleBrushChange",function(S){var T=S.startIndex,E=S.endIndex;if(T!==_.state.dataStartIndex||E!==_.state.dataEndIndex){var M=_.state.updateId;_.setState(function(){return Me({dataStartIndex:T,dataEndIndex:E},p({props:_.props,dataStartIndex:T,dataEndIndex:E,updateId:M},_.state))}),_.triggerSyncEvent({dataStartIndex:T,dataEndIndex:E})}}),Pt(_,"handleMouseEnter",function(S){var T=_.getMouseInfo(S);if(T){var E=Me(Me({},T),{},{isTooltipActive:!0});_.setState(E),_.triggerSyncEvent(E);var M=_.props.onMouseEnter;Ut(M)&&M(E,S)}}),Pt(_,"triggeredAfterMouseMove",function(S){var T=_.getMouseInfo(S),E=T?Me(Me({},T),{},{isTooltipActive:!0}):{isTooltipActive:!1};_.setState(E),_.triggerSyncEvent(E);var M=_.props.onMouseMove;Ut(M)&&M(E,S)}),Pt(_,"handleItemMouseEnter",function(S){_.setState(function(){return{isTooltipActive:!0,activeItem:S,activePayload:S.tooltipPayload,activeCoordinate:S.tooltipPosition||{x:S.cx,y:S.cy}}})}),Pt(_,"handleItemMouseLeave",function(){_.setState(function(){return{isTooltipActive:!1}})}),Pt(_,"handleMouseMove",function(S){S.persist(),_.throttleTriggeredAfterMouseMove(S)}),Pt(_,"handleMouseLeave",function(S){_.throttleTriggeredAfterMouseMove.cancel();var T={isTooltipActive:!1};_.setState(T),_.triggerSyncEvent(T);var E=_.props.onMouseLeave;Ut(E)&&E(T,S)}),Pt(_,"handleOuterEvent",function(S){var T=eHe(S),E=ca(_.props,"".concat(T));if(T&&Ut(E)){var M,A;/.*touch.*/i.test(T)?A=_.getMouseInfo(S.changedTouches[0]):A=_.getMouseInfo(S),E((M=A)!==null&&M!==void 0?M:{},S)}}),Pt(_,"handleClick",function(S){var T=_.getMouseInfo(S);if(T){var E=Me(Me({},T),{},{isTooltipActive:!0});_.setState(E),_.triggerSyncEvent(E);var M=_.props.onClick;Ut(M)&&M(E,S)}}),Pt(_,"handleMouseDown",function(S){var T=_.props.onMouseDown;if(Ut(T)){var E=_.getMouseInfo(S);T(E,S)}}),Pt(_,"handleMouseUp",function(S){var T=_.props.onMouseUp;if(Ut(T)){var E=_.getMouseInfo(S);T(E,S)}}),Pt(_,"handleTouchMove",function(S){S.changedTouches!=null&&S.changedTouches.length>0&&_.throttleTriggeredAfterMouseMove(S.changedTouches[0])}),Pt(_,"handleTouchStart",function(S){S.changedTouches!=null&&S.changedTouches.length>0&&_.handleMouseDown(S.changedTouches[0])}),Pt(_,"handleTouchEnd",function(S){S.changedTouches!=null&&S.changedTouches.length>0&&_.handleMouseUp(S.changedTouches[0])}),Pt(_,"handleDoubleClick",function(S){var T=_.props.onDoubleClick;if(Ut(T)){var E=_.getMouseInfo(S);T(E,S)}}),Pt(_,"handleContextMenu",function(S){var T=_.props.onContextMenu;if(Ut(T)){var E=_.getMouseInfo(S);T(E,S)}}),Pt(_,"triggerSyncEvent",function(S){_.props.syncId!==void 0&&h2.emit(f2,_.props.syncId,S,_.eventEmitterSymbol)}),Pt(_,"applySyncEvent",function(S){var T=_.props,E=T.layout,M=T.syncMethod,A=_.state.updateId,P=S.dataStartIndex,D=S.dataEndIndex;if(S.dataStartIndex!==void 0||S.dataEndIndex!==void 0)_.setState(Me({dataStartIndex:P,dataEndIndex:D},p({props:_.props,dataStartIndex:P,dataEndIndex:D,updateId:A},_.state)));else if(S.activeTooltipIndex!==void 0){var B=S.chartX,C=S.chartY,O=S.activeTooltipIndex,R=_.state,z=R.offset,U=R.tooltipTicks;if(!z)return;if(typeof M=="function")O=M(U,S);else if(M==="value"){O=-1;for(var G=0;G<U.length;G++)if(U[G].value===S.activeLabel){O=G;break}}var H=Me(Me({},z),{},{x:z.left,y:z.top}),Y=Math.min(B,H.x+H.width),ee=Math.min(C,H.y+H.height),he=U[O]&&U[O].value,q=dI(_.state,_.props.data,O),J=U[O]?{x:E==="horizontal"?U[O].coordinate:Y,y:E==="horizontal"?ee:U[O].coordinate}:Eie;_.setState(Me(Me({},S),{},{activeLabel:he,activeCoordinate:J,activePayload:q,activeTooltipIndex:O}))}else _.setState(S)}),Pt(_,"renderCursor",function(S){var T,E=_.state,M=E.isTooltipActive,A=E.activeCoordinate,P=E.activePayload,D=E.offset,B=E.activeTooltipIndex,C=E.tooltipAxisBandSize,O=_.getTooltipEventType(),R=(T=S.props.active)!==null&&T!==void 0?T:M,z=_.props.layout,U=S.key||"_recharts-cursor";return Z.createElement(Jlt,{key:U,activeCoordinate:A,activePayload:P,activeTooltipIndex:B,chartName:n,element:S,isActive:R,layout:z,offset:D,tooltipAxisBandSize:C,tooltipEventType:O})}),Pt(_,"renderPolarAxis",function(S,T,E){var M=ca(S,"type.axisType"),A=ca(_.state,"".concat(M,"Map")),P=S.type.defaultProps,D=P!==void 0?Me(Me({},P),S.props):S.props,B=A&&A[D["".concat(M,"Id")]];return te.cloneElement(S,Me(Me({},B),{},{className:qt(M,B.className),key:S.key||"".concat(T,"-").concat(E),ticks:zc(B,!0)}))}),Pt(_,"renderPolarGrid",function(S){var T=S.props,E=T.radialLines,M=T.polarAngles,A=T.polarRadius,P=_.state,D=P.radiusAxisMap,B=P.angleAxisMap,C=nh(D),O=nh(B),R=O.cx,z=O.cy,U=O.innerRadius,G=O.outerRadius;return te.cloneElement(S,{polarAngles:Array.isArray(M)?M:zc(O,!0).map(function(H){return H.coordinate}),polarRadius:Array.isArray(A)?A:zc(C,!0).map(function(H){return H.coordinate}),cx:R,cy:z,innerRadius:U,outerRadius:G,key:S.key||"polar-grid",radialLines:E})}),Pt(_,"renderLegend",function(){var S=_.state.formattedGraphicalItems,T=_.props,E=T.children,M=T.width,A=T.height,P=_.props.margin||{},D=M-(P.left||0)-(P.right||0),B=ire({children:E,formattedGraphicalItems:S,legendWidth:D,legendContent:u});if(!B)return null;var C=B.item,O=qW(B,ect);return te.cloneElement(C,Me(Me({},O),{},{chartWidth:M,chartHeight:A,margin:P,onBBoxUpdate:_.handleLegendBBoxUpdate}))}),Pt(_,"renderTooltip",function(){var S,T=_.props,E=T.children,M=T.accessibilityLayer,A=So(E,Fa);if(!A)return null;var P=_.state,D=P.isTooltipActive,B=P.activeCoordinate,C=P.activePayload,O=P.activeLabel,R=P.offset,z=(S=A.props.active)!==null&&S!==void 0?S:D;return te.cloneElement(A,{viewBox:Me(Me({},R),{},{x:R.left,y:R.top}),active:z,label:O,payload:z?C:[],coordinate:B,accessibilityLayer:M})}),Pt(_,"renderBrush",function(S){var T=_.props,E=T.margin,M=T.data,A=_.state,P=A.offset,D=A.dataStartIndex,B=A.dataEndIndex,C=A.updateId;return te.cloneElement(S,{key:S.key||"_recharts-brush",onChange:i1(_.handleBrushChange,S.props.onChange),data:M,x:We(S.props.x)?S.props.x:P.left,y:We(S.props.y)?S.props.y:P.top+P.height+P.brushBottom-(E.bottom||0),width:We(S.props.width)?S.props.width:P.width,startIndex:D,endIndex:B,updateId:"brush-".concat(C)})}),Pt(_,"renderReferenceElement",function(S,T,E){if(!S)return null;var M=_,A=M.clipPathId,P=_.state,D=P.xAxisMap,B=P.yAxisMap,C=P.offset,O=S.type.defaultProps||{},R=S.props,z=R.xAxisId,U=z===void 0?O.xAxisId:z,G=R.yAxisId,H=G===void 0?O.yAxisId:G;return te.cloneElement(S,{key:S.key||"".concat(T,"-").concat(E),xAxis:D[U],yAxis:B[H],viewBox:{x:C.left,y:C.top,width:C.width,height:C.height},clipPathId:A})}),Pt(_,"renderActivePoints",function(S){var T=S.item,E=S.activePoint,M=S.basePoint,A=S.childIndex,P=S.isRange,D=[],B=T.props.key,C=T.item.type.defaultProps!==void 0?Me(Me({},T.item.type.defaultProps),T.item.props):T.item.props,O=C.activeDot,R=C.dataKey,z=Me(Me({index:A,dataKey:R,cx:E.x,cy:E.y,r:4,fill:$B(T.item),strokeWidth:2,stroke:"#fff",payload:E.payload,value:E.value},Tt(O,!1)),SE(O));return D.push(y.renderActiveDot(O,z,"".concat(B,"-activePoint-").concat(A))),M?D.push(y.renderActiveDot(O,Me(Me({},z),{},{cx:M.x,cy:M.y}),"".concat(B,"-basePoint-").concat(A))):P&&D.push(null),D}),Pt(_,"renderGraphicChild",function(S,T,E){var M=_.filterFormatItem(S,T,E);if(!M)return null;var A=_.getTooltipEventType(),P=_.state,D=P.isTooltipActive,B=P.tooltipAxis,C=P.activeTooltipIndex,O=P.activeLabel,R=_.props.children,z=So(R,Fa),U=M.props,G=U.points,H=U.isRange,Y=U.baseLine,ee=M.item.type.defaultProps!==void 0?Me(Me({},M.item.type.defaultProps),M.item.props):M.item.props,he=ee.activeDot,q=ee.hide,J=ee.activeBar,se=ee.activeShape,oe=!!(!q&&D&&z&&(he||J||se)),Ee={};A!=="axis"&&z&&z.props.trigger==="click"?Ee={onClick:i1(_.handleItemMouseEnter,S.props.onClick)}:A!=="axis"&&(Ee={onMouseLeave:i1(_.handleItemMouseLeave,S.props.onMouseLeave),onMouseEnter:i1(_.handleItemMouseEnter,S.props.onMouseEnter)});var ye=te.cloneElement(S,Me(Me({},M.props),Ee));function Ce(k){return typeof B.dataKey=="function"?B.dataKey(k.payload):null}if(oe)if(C>=0){var Ge,_e;if(B.dataKey&&!B.allowDuplicatedCategory){var Ke=typeof B.dataKey=="function"?Ce:"payload.".concat(B.dataKey.toString());Ge=wE(G,Ke,O),_e=H&&Y&&wE(Y,Ke,O)}else Ge=G==null?void 0:G[C],_e=H&&Y&&Y[C];if(se||J){var Q=S.props.activeIndex!==void 0?S.props.activeIndex:C;return[te.cloneElement(S,Me(Me(Me({},M.props),Ee),{},{activeIndex:Q})),null,null]}if(!nn(Ge))return[ye].concat(ty(_.renderActivePoints({item:M,activePoint:Ge,basePoint:_e,childIndex:C,isRange:H})))}else{var kt,ct=(kt=_.getItemByXY(_.state.activeCoordinate))!==null&&kt!==void 0?kt:{graphicalItem:ye},gt=ct.graphicalItem,ot=gt.item,on=ot===void 0?S:ot,X=gt.childIndex,I=Me(Me(Me({},M.props),Ee),{},{activeIndex:X});return[te.cloneElement(on,I),null,null]}return H?[ye,null,null]:[ye,null]}),Pt(_,"renderCustomized",function(S,T,E){return te.cloneElement(S,Me(Me({key:"recharts-customized-".concat(E)},_.props),_.state))}),Pt(_,"renderMap",{CartesianGrid:{handler:c1,once:!0},ReferenceArea:{handler:_.renderReferenceElement},ReferenceLine:{handler:c1},ReferenceDot:{handler:_.renderReferenceElement},XAxis:{handler:c1},YAxis:{handler:c1},Brush:{handler:_.renderBrush,once:!0},Bar:{handler:_.renderGraphicChild},Line:{handler:_.renderGraphicChild},Area:{handler:_.renderGraphicChild},Radar:{handler:_.renderGraphicChild},RadialBar:{handler:_.renderGraphicChild},Scatter:{handler:_.renderGraphicChild},Pie:{handler:_.renderGraphicChild},Funnel:{handler:_.renderGraphicChild},Tooltip:{handler:_.renderCursor,once:!0},PolarGrid:{handler:_.renderPolarGrid,once:!0},PolarAngleAxis:{handler:_.renderPolarAxis},PolarRadiusAxis:{handler:_.renderPolarAxis},Customized:{handler:_.renderCustomized}}),_.clipPathId="".concat((b=x.id)!==null&&b!==void 0?b:I_("recharts"),"-clip"),_.throttleTriggeredAfterMouseMove=Ine(_.triggeredAfterMouseMove,(w=x.throttleDelay)!==null&&w!==void 0?w:1e3/60),_.state={},_}return fct(y,v),lct(y,[{key:"componentDidMount",value:function(){var b,w;this.addListener(),this.accessibilityManager.setDetails({container:this.container,offset:{left:(b=this.props.margin.left)!==null&&b!==void 0?b:0,top:(w=this.props.margin.top)!==null&&w!==void 0?w:0},coordinateList:this.state.tooltipTicks,mouseHandlerCallback:this.triggeredAfterMouseMove,layout:this.props.layout}),this.displayDefaultTooltip()}},{key:"displayDefaultTooltip",value:function(){var b=this.props,w=b.children,_=b.data,S=b.height,T=b.layout,E=So(w,Fa);if(E){var M=E.props.defaultIndex;if(!(typeof M!="number"||M<0||M>this.state.tooltipTicks.length-1)){var A=this.state.tooltipTicks[M]&&this.state.tooltipTicks[M].value,P=dI(this.state,_,M,A),D=this.state.tooltipTicks[M].coordinate,B=(this.state.offset.top+S)/2,C=T==="horizontal",O=C?{x:D,y:B}:{y:D,x:B},R=this.state.formattedGraphicalItems.find(function(U){var G=U.item;return G.type.name==="Scatter"});R&&(O=Me(Me({},O),R.props.points[M].tooltipPosition),P=R.props.points[M].tooltipPayload);var z={activeTooltipIndex:M,isTooltipActive:!0,activeLabel:A,activePayload:P,activeCoordinate:O};this.setState(z),this.renderCursor(E),this.accessibilityManager.setIndex(M)}}}},{key:"getSnapshotBeforeUpdate",value:function(b,w){if(!this.props.accessibilityLayer)return null;if(this.state.tooltipTicks!==w.tooltipTicks&&this.accessibilityManager.setDetails({coordinateList:this.state.tooltipTicks}),this.props.layout!==b.layout&&this.accessibilityManager.setDetails({layout:this.props.layout}),this.props.margin!==b.margin){var _,S;this.accessibilityManager.setDetails({offset:{left:(_=this.props.margin.left)!==null&&_!==void 0?_:0,top:(S=this.props.margin.top)!==null&&S!==void 0?S:0}})}return null}},{key:"componentDidUpdate",value:function(b){qD([So(b.children,Fa)],[So(this.props.children,Fa)])||this.displayDefaultTooltip()}},{key:"componentWillUnmount",value:function(){this.removeListener(),this.throttleTriggeredAfterMouseMove.cancel()}},{key:"getTooltipEventType",value:function(){var b=So(this.props.children,Fa);if(b&&typeof b.props.shared=="boolean"){var w=b.props.shared?"axis":"item";return l.indexOf(w)>=0?w:o}return o}},{key:"getMouseInfo",value:function(b){if(!this.container)return null;var w=this.container,_=w.getBoundingClientRect(),S=AZe(_),T={chartX:Math.round(b.pageX-S.left),chartY:Math.round(b.pageY-S.top)},E=_.width/w.offsetWidth||1,M=this.inRange(T.chartX,T.chartY,E);if(!M)return null;var A=this.state,P=A.xAxisMap,D=A.yAxisMap,B=this.getTooltipEventType(),C=KW(this.state,this.props.data,this.props.layout,M);if(B!=="axis"&&P&&D){var O=nh(P).scale,R=nh(D).scale,z=O&&O.invert?O.invert(T.chartX):null,U=R&&R.invert?R.invert(T.chartY):null;return Me(Me({},T),{},{xValue:z,yValue:U},C)}return C?Me(Me({},T),C):null}},{key:"inRange",value:function(b,w){var _=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1,S=this.props.layout,T=b/_,E=w/_;if(S==="horizontal"||S==="vertical"){var M=this.state.offset,A=T>=M.left&&T<=M.left+M.width&&E>=M.top&&E<=M.top+M.height;return A?{x:T,y:E}:null}var P=this.state,D=P.angleAxisMap,B=P.radiusAxisMap;if(D&&B){var C=nh(D);return x6({x:T,y:E},C)}return null}},{key:"parseEventsOfWrapper",value:function(){var b=this.props.children,w=this.getTooltipEventType(),_=So(b,Fa),S={};_&&w==="axis"&&(_.props.trigger==="click"?S={onClick:this.handleClick}:S={onMouseEnter:this.handleMouseEnter,onDoubleClick:this.handleDoubleClick,onMouseMove:this.handleMouseMove,onMouseLeave:this.handleMouseLeave,onTouchMove:this.handleTouchMove,onTouchStart:this.handleTouchStart,onTouchEnd:this.handleTouchEnd,onContextMenu:this.handleContextMenu});var T=SE(this.props,this.handleOuterEvent);return Me(Me({},T),S)}},{key:"addListener",value:function(){h2.on(f2,this.handleReceiveSyncEvent)}},{key:"removeListener",value:function(){h2.removeListener(f2,this.handleReceiveSyncEvent)}},{key:"filterFormatItem",value:function(b,w,_){for(var S=this.state.formattedGraphicalItems,T=0,E=S.length;T<E;T++){var M=S[T];if(M.item===b||M.props.key===b.key||w===Yc(M.item.type)&&_===M.childIndex)return M}return null}},{key:"renderClipPath",value:function(){var b=this.clipPathId,w=this.state.offset,_=w.left,S=w.top,T=w.height,E=w.width;return Z.createElement("defs",null,Z.createElement("clipPath",{id:b},Z.createElement("rect",{x:_,y:S,height:T,width:E})))}},{key:"getXScales",value:function(){var b=this.state.xAxisMap;return b?Object.entries(b).reduce(function(w,_){var S=WW(_,2),T=S[0],E=S[1];return Me(Me({},w),{},Pt({},T,E.scale))},{}):null}},{key:"getYScales",value:function(){var b=this.state.yAxisMap;return b?Object.entries(b).reduce(function(w,_){var S=WW(_,2),T=S[0],E=S[1];return Me(Me({},w),{},Pt({},T,E.scale))},{}):null}},{key:"getXScaleByAxisId",value:function(b){var w;return(w=this.state.xAxisMap)===null||w===void 0||(w=w[b])===null||w===void 0?void 0:w.scale}},{key:"getYScaleByAxisId",value:function(b){var w;return(w=this.state.yAxisMap)===null||w===void 0||(w=w[b])===null||w===void 0?void 0:w.scale}},{key:"getItemByXY",value:function(b){var w=this.state,_=w.formattedGraphicalItems,S=w.activeItem;if(_&&_.length)for(var T=0,E=_.length;T<E;T++){var M=_[T],A=M.props,P=M.item,D=P.type.defaultProps!==void 0?Me(Me({},P.type.defaultProps),P.props):P.props,B=Yc(P.type);if(B==="Bar"){var C=(A.data||[]).find(function(U){return Dnt(b,U)});if(C)return{graphicalItem:M,payload:C}}else if(B==="RadialBar"){var O=(A.data||[]).find(function(U){return x6(b,U)});if(O)return{graphicalItem:M,payload:O}}else if(uC(M,S)||hC(M,S)||zb(M,S)){var R=Oit({graphicalItem:M,activeTooltipItem:S,itemData:D.data}),z=D.activeIndex===void 0?R:D.activeIndex;return{graphicalItem:Me(Me({},M),{},{childIndex:z}),payload:zb(M,S)?D.data[R]:M.props.data[R]}}}return null}},{key:"render",value:function(){var b=this;if(!WH(this))return null;var w=this.props,_=w.children,S=w.className,T=w.width,E=w.height,M=w.style,A=w.compact,P=w.title,D=w.desc,B=qW(w,tct),C=Tt(B,!1);if(A)return Z.createElement(CW,{state:this.state,width:this.props.width,height:this.props.height,clipPathId:this.clipPathId},Z.createElement(KD,vm({},C,{width:T,height:E,title:P,desc:D}),this.renderClipPath(),XH(_,this.renderMap)));if(this.props.accessibilityLayer){var O,R;C.tabIndex=(O=this.props.tabIndex)!==null&&O!==void 0?O:0,C.role=(R=this.props.role)!==null&&R!==void 0?R:"application",C.onKeyDown=function(U){b.accessibilityManager.keyboardEvent(U)},C.onFocus=function(){b.accessibilityManager.focus()}}var z=this.parseEventsOfWrapper();return Z.createElement(CW,{state:this.state,width:this.props.width,height:this.props.height,clipPathId:this.clipPathId},Z.createElement("div",vm({className:qt("recharts-wrapper",S),style:Me({position:"relative",cursor:"default",width:T,height:E},M)},z,{ref:function(G){b.container=G}}),Z.createElement(KD,vm({},C,{width:T,height:E,title:P,desc:D,style:vct}),this.renderClipPath(),XH(_,this.renderMap)),this.renderLegend(),this.renderTooltip()))}}])}(te.Component);Pt(m,"displayName",n),Pt(m,"defaultProps",Me({layout:"horizontal",stackOffset:"none",barCategoryGap:"10%",barGap:4,margin:{top:5,right:5,bottom:5,left:5},reverseStackOrder:!1,syncMethod:"index"},f)),Pt(m,"getDerivedStateFromProps",function(v,y){var x=v.dataKey,b=v.data,w=v.children,_=v.width,S=v.height,T=v.layout,E=v.stackOffset,M=v.margin,A=y.dataStartIndex,P=y.dataEndIndex;if(y.updateId===void 0){var D=YW(v);return Me(Me(Me({},D),{},{updateId:0},p(Me(Me({props:v},D),{},{updateId:0}),y)),{},{prevDataKey:x,prevData:b,prevWidth:_,prevHeight:S,prevLayout:T,prevStackOffset:E,prevMargin:M,prevChildren:w})}if(x!==y.prevDataKey||b!==y.prevData||_!==y.prevWidth||S!==y.prevHeight||T!==y.prevLayout||E!==y.prevStackOffset||!zm(M,y.prevMargin)){var B=YW(v),C={chartX:y.chartX,chartY:y.chartY,isTooltipActive:y.isTooltipActive},O=Me(Me({},KW(y,b,T)),{},{updateId:y.updateId+1}),R=Me(Me(Me({},B),C),O);return Me(Me(Me({},R),p(Me({props:v},R),y)),{},{prevDataKey:x,prevData:b,prevWidth:_,prevHeight:S,prevLayout:T,prevStackOffset:E,prevMargin:M,prevChildren:w})}if(!qD(w,y.prevChildren)){var z,U,G,H,Y=So(w,Vg),ee=Y&&(z=(U=Y.props)===null||U===void 0?void 0:U.startIndex)!==null&&z!==void 0?z:A,he=Y&&(G=(H=Y.props)===null||H===void 0?void 0:H.endIndex)!==null&&G!==void 0?G:P,q=ee!==A||he!==P,J=!nn(b),se=J&&!q?y.updateId:y.updateId+1;return Me(Me({updateId:se},p(Me(Me({props:v},y),{},{updateId:se,dataStartIndex:ee,dataEndIndex:he}),y)),{},{prevChildren:w,dataStartIndex:ee,dataEndIndex:he})}return null}),Pt(m,"renderActiveDot",function(v,y,x){var b;return te.isValidElement(v)?b=te.cloneElement(v,y):Ut(v)?b=v(y):b=Z.createElement(U_,y),Z.createElement(Sn,{className:"recharts-active-dot",key:x},b)});var g=te.forwardRef(function(y,x){return Z.createElement(m,vm({},y,{ref:x}))});return g.displayName=m.displayName,g},Cct=QB({chartName:"LineChart",GraphicalChild:V_,axisComponents:[{axisType:"xAxis",AxisComp:Zg},{axisType:"yAxis",AxisComp:Jg}],formatAxisMap:Hre}),Pct=QB({chartName:"BarChart",GraphicalChild:kh,defaultTooltipEventType:"axis",validateTooltipEventTypes:["axis","item"],axisComponents:[{axisType:"xAxis",AxisComp:Zg},{axisType:"yAxis",AxisComp:Jg}],formatAxisMap:Hre}),Rct=QB({chartName:"RadarChart",GraphicalChild:j_,axisComponents:[{axisType:"angleAxis",AxisComp:$_},{axisType:"radiusAxis",AxisComp:z_}],formatAxisMap:ZJe,defaultProps:{layout:"centric",startAngle:90,endAngle:-270,cx:"50%",cy:"50%",innerRadius:0,outerRadius:"80%"}});const Nct=({simulation:r})=>{const{sevenSModel:e,kpiTracker:n,decisions:i,tensions:s}=r;if(!e)return N.jsx("div",{children:"No simulation data available"});const o=[{element:"Strategy",value:e.strategy.alignmentScore},{element:"Structure",value:e.structure.alignmentScore},{element:"Systems",value:e.systems.alignmentScore},{element:"Shared Values",value:e.sharedValues.alignmentScore},{element:"Skills",value:e.skills.alignmentScore},{element:"Style",value:e.style.alignmentScore},{element:"Staff",value:e.staff.alignmentScore}],a=n.map(f=>({name:f.name,data:f.history.map(d=>({date:dce(d.date),value:d.value}))})),l=i.length,c=i.filter(f=>f.selectedOption).length,u=s.length,h=s.filter(f=>f.resolved).length;return N.jsxs("div",{className:"space-y-6",children:[N.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[N.jsxs(jr,{children:[N.jsx(Vr,{children:N.jsx(Gr,{children:"Overall Alignment Score"})}),N.jsx(Hr,{children:N.jsx("div",{className:"flex items-center justify-center h-32",children:N.jsxs("div",{className:"text-center",children:[N.jsxs("div",{className:"text-5xl font-bold text-blue-600 dark:text-blue-400",children:[(e.alignmentScore*100).toFixed(0),"%"]}),N.jsx("div",{className:"text-gray-500 dark:text-gray-400 mt-2",children:"Organizational Alignment"})]})})})]}),N.jsxs(jr,{children:[N.jsx(Vr,{children:N.jsx(Gr,{children:"Simulation Progress"})}),N.jsx(Hr,{children:N.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[N.jsxs("div",{className:"text-center p-4 bg-blue-50 dark:bg-blue-900/20 rounded-lg",children:[N.jsxs("div",{className:"text-3xl font-bold text-blue-600 dark:text-blue-400",children:[c,"/",l]}),N.jsx("div",{className:"text-gray-500 dark:text-gray-400 mt-2",children:"Decisions Made"})]}),N.jsxs("div",{className:"text-center p-4 bg-green-50 dark:bg-green-900/20 rounded-lg",children:[N.jsxs("div",{className:"text-3xl font-bold text-green-600 dark:text-green-400",children:[h,"/",u]}),N.jsx("div",{className:"text-gray-500 dark:text-gray-400 mt-2",children:"Tensions Resolved"})]})]})})]})]}),N.jsxs(jr,{children:[N.jsx(Vr,{children:N.jsx(Gr,{children:"7S Element Alignment"})}),N.jsx(Hr,{children:N.jsx("div",{className:"h-[400px]",children:N.jsx(r2,{width:"100%",height:"100%",children:N.jsxs(Rct,{cx:"50%",cy:"50%",outerRadius:"80%",data:o,children:[N.jsx(Cre,{}),N.jsx($_,{dataKey:"element"}),N.jsx(z_,{domain:[0,1]}),N.jsx(j_,{name:"Alignment",dataKey:"value",stroke:"#3b82f6",fill:"#3b82f6",fillOpacity:.6}),N.jsx(Qc,{})]})})})})]}),a.length>0&&N.jsxs(jr,{children:[N.jsx(Vr,{children:N.jsx(Gr,{children:"KPI Tracking"})}),N.jsx(Hr,{children:N.jsx("div",{className:"h-[300px]",children:N.jsx(r2,{width:"100%",height:"100%",children:N.jsxs(Cct,{margin:{top:5,right:30,left:20,bottom:5},children:[N.jsx(nI,{strokeDasharray:"3 3"}),N.jsx(Zg,{dataKey:"date",allowDuplicatedCategory:!1}),N.jsx(Jg,{}),N.jsx(Fa,{}),N.jsx(Qc,{}),a.map((f,d)=>N.jsx(V_,{type:"monotone",data:f.data,name:f.name,dataKey:"value",stroke:Object.values(Zf)[d%7]||"#8884d8"},f.name))]})})})})]}),i.filter(f=>f.selectedOption).length>0&&N.jsxs(jr,{children:[N.jsx(Vr,{children:N.jsx(Gr,{children:"Decision Impact Analysis"})}),N.jsxs(Hr,{children:[N.jsx("p",{className:"text-gray-500 dark:text-gray-400 mb-4",children:"Impact of decisions on 7S elements"}),N.jsx("div",{className:"h-[300px]",children:N.jsx(r2,{width:"100%",height:"100%",children:N.jsxs(Pct,{data:Oct(i),margin:{top:5,right:30,left:20,bottom:5},children:[N.jsx(nI,{strokeDasharray:"3 3"}),N.jsx(Zg,{dataKey:"element"}),N.jsx(Jg,{}),N.jsx(Fa,{}),N.jsx(Qc,{}),N.jsx(kh,{dataKey:"positive",name:"Positive Impact",fill:"#10b981",stackId:"stack"}),N.jsx(kh,{dataKey:"negative",name:"Negative Impact",fill:"#ef4444",stackId:"stack"})]})})})]})]})]})};function Oct(r){return["Strategy","Structure","Systems","Shared Values","Skills","Style","Staff"].map(i=>{let s=0,o=0;return r.forEach(a=>{if(!a.selectedOption)return;const l=a.options.find(c=>c.id===a.selectedOption);l&&a.impact.filter(c=>c.element===i&&c.description.includes(l.description)).forEach(c=>{c.value>0?s+=c.value:o+=Math.abs(c.value)})}),{element:i,positive:parseFloat(s.toFixed(2)),negative:-parseFloat(o.toFixed(2))}})}const Dct=()=>{const r=oy(),{simulation:e,resetSimulation:n}=ly();if(!e.company||!e.sevenSModel)return r("/profile"),null;const i=()=>{n(),r("/profile")};return N.jsx(s_,{children:N.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[N.jsxs("div",{className:"mb-8 flex justify-between items-center",children:[N.jsxs("div",{children:[N.jsx("h1",{className:"text-3xl font-bold text-gray-900 dark:text-white",children:"Simulation Results"}),N.jsx("p",{className:"mt-2 text-lg text-gray-600 dark:text-gray-300",children:"Review the outcomes of your strategic decisions."})]}),N.jsx(hr,{onClick:i,children:"Start New Simulation"})]}),N.jsx(Nct,{simulation:e}),N.jsxs(jr,{className:"mt-8",children:[N.jsx(Vr,{children:N.jsx(Gr,{children:"Key Insights"})}),N.jsx(Hr,{children:N.jsx("div",{className:"space-y-4",children:kct(e).map((s,o)=>N.jsxs("div",{className:`p-4 rounded-md ${s.type==="positive"?"bg-green-50 dark:bg-green-900/20 border-l-4 border-green-500":s.type==="negative"?"bg-red-50 dark:bg-red-900/20 border-l-4 border-red-500":"bg-blue-50 dark:bg-blue-900/20 border-l-4 border-blue-500"}`,children:[N.jsx("p",{className:`font-medium ${s.type==="positive"?"text-green-800 dark:text-green-300":s.type==="negative"?"text-red-800 dark:text-red-300":"text-blue-800 dark:text-blue-300"}`,children:s.title}),N.jsx("p",{className:`mt-1 text-sm ${s.type==="positive"?"text-green-700 dark:text-green-400":s.type==="negative"?"text-red-700 dark:text-red-400":"text-blue-700 dark:text-blue-400"}`,children:s.description})]},o))})})]}),N.jsxs("div",{className:"mt-8 flex justify-between",children:[N.jsx(hr,{variant:"outline",onClick:()=>r("/decisions"),children:"Back to Decisions"}),N.jsx(hr,{onClick:i,children:"Start New Simulation"})]})]})})};function kct(r){const{sevenSModel:e,decisions:n}=r;if(!e)return[];const i=[];e.alignmentScore>.8?i.push({title:"Strong Organizational Alignment",description:"Your organization shows excellent alignment across the 7S elements, providing a solid foundation for strategic execution.",type:"positive"}):e.alignmentScore<.5?i.push({title:"Alignment Challenges",description:"Your organization has significant misalignments that may hinder strategic execution. Focus on aligning the 7S elements more effectively.",type:"negative"}):i.push({title:"Moderate Alignment",description:"Your organization has reasonable alignment with some areas that could be improved for better strategic execution.",type:"neutral"}),e.strategy.alignmentScore>.7&&e.structure.alignmentScore>.7?i.push({title:"Strategy-Structure Fit",description:"Your organizational structure supports your strategic direction well, enabling effective execution.",type:"positive"}):e.strategy.alignmentScore>.7&&e.structure.alignmentScore<.5&&i.push({title:"Strategy-Structure Mismatch",description:"Your ambitious strategy may be constrained by your current organizational structure. Consider structural adjustments.",type:"negative"}),e.systems.alignmentScore<.6&&i.push({title:"Systems Need Attention",description:"Your organizational systems may not adequately support your strategy and structure. Review and update key processes.",type:"negative"});const s=[e.staff.alignmentScore,e.skills.alignmentScore,e.style.alignmentScore],o=s.reduce((a,l)=>a+l,0)/s.length;if(o>.75?i.push({title:"Strong People Factors",description:"Your staff capabilities, skills development, and leadership style are well-aligned and support your strategic direction.",type:"positive"}):o<.5&&i.push({title:"People Factors Lagging",description:"Your human elements (staff, skills, leadership style) need attention to better support your strategic objectives.",type:"negative"}),n.length>0){const a=n.filter(u=>u.selectedOption).flatMap(u=>{const h=u.options.find(f=>f.id===u.selectedOption);return h?u.impact.filter(f=>f.description.includes(h.description)):[]}),l=a.filter(u=>u.value>.15),c=a.filter(u=>u.value<-.15);l.length>0&&i.push({title:"High-Impact Decisions",description:"Some of your strategic decisions had significant positive effects, particularly on "+l.map(u=>u.element).join(", ")+".",type:"positive"}),c.length>0&&i.push({title:"Challenging Decisions",description:"Some decisions had notable negative consequences, particularly affecting "+c.map(u=>u.element).join(", ")+". Consider mitigation strategies.",type:"negative"})}return i}function Ict(){return N.jsx(Qae,{children:N.jsxs(Hae,{children:[N.jsx(Fp,{path:"/",element:N.jsx($de,{})}),N.jsx(Fp,{path:"/profile",element:N.jsx(hpe,{})}),N.jsx(Fp,{path:"/simulation",element:N.jsx(iVe,{})}),N.jsx(Fp,{path:"/decisions",element:N.jsx(lVe,{})}),N.jsx(Fp,{path:"/results",element:N.jsx(Dct,{})})]})})}uq(document.getElementById("root")).render(N.jsx(te.StrictMode,{children:N.jsx(Ict,{})}));
